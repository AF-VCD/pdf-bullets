/*! For license information please see main.52aad488.js.LICENSE.txt */
(()=>{var __webpack_modules__={8394:function(module,__unused_webpack_exports,__webpack_require__){var factory;factory=function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"addLinkAttributes",{enumerable:!0,get:function(){return n.addLinkAttributes}}),Object.defineProperty(t,"getFilenameFromUrl",{enumerable:!0,get:function(){return n.getFilenameFromUrl}}),Object.defineProperty(t,"LinkTarget",{enumerable:!0,get:function(){return n.LinkTarget}}),Object.defineProperty(t,"loadScript",{enumerable:!0,get:function(){return n.loadScript}}),Object.defineProperty(t,"PDFDateString",{enumerable:!0,get:function(){return n.PDFDateString}}),Object.defineProperty(t,"RenderingCancelledException",{enumerable:!0,get:function(){return n.RenderingCancelledException}}),Object.defineProperty(t,"build",{enumerable:!0,get:function(){return i.build}}),Object.defineProperty(t,"getDocument",{enumerable:!0,get:function(){return i.getDocument}}),Object.defineProperty(t,"LoopbackPort",{enumerable:!0,get:function(){return i.LoopbackPort}}),Object.defineProperty(t,"PDFDataRangeTransport",{enumerable:!0,get:function(){return i.PDFDataRangeTransport}}),Object.defineProperty(t,"PDFWorker",{enumerable:!0,get:function(){return i.PDFWorker}}),Object.defineProperty(t,"version",{enumerable:!0,get:function(){return i.version}}),Object.defineProperty(t,"CMapCompressionType",{enumerable:!0,get:function(){return o.CMapCompressionType}}),Object.defineProperty(t,"createObjectURL",{enumerable:!0,get:function(){return o.createObjectURL}}),Object.defineProperty(t,"createPromiseCapability",{enumerable:!0,get:function(){return o.createPromiseCapability}}),Object.defineProperty(t,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return o.createValidAbsoluteUrl}}),Object.defineProperty(t,"InvalidPDFException",{enumerable:!0,get:function(){return o.InvalidPDFException}}),Object.defineProperty(t,"MissingPDFException",{enumerable:!0,get:function(){return o.MissingPDFException}}),Object.defineProperty(t,"OPS",{enumerable:!0,get:function(){return o.OPS}}),Object.defineProperty(t,"PasswordResponses",{enumerable:!0,get:function(){return o.PasswordResponses}}),Object.defineProperty(t,"PermissionFlag",{enumerable:!0,get:function(){return o.PermissionFlag}}),Object.defineProperty(t,"removeNullCharacters",{enumerable:!0,get:function(){return o.removeNullCharacters}}),Object.defineProperty(t,"shadow",{enumerable:!0,get:function(){return o.shadow}}),Object.defineProperty(t,"UnexpectedResponseException",{enumerable:!0,get:function(){return o.UnexpectedResponseException}}),Object.defineProperty(t,"UNSUPPORTED_FEATURES",{enumerable:!0,get:function(){return o.UNSUPPORTED_FEATURES}}),Object.defineProperty(t,"Util",{enumerable:!0,get:function(){return o.Util}}),Object.defineProperty(t,"VerbosityLevel",{enumerable:!0,get:function(){return o.VerbosityLevel}}),Object.defineProperty(t,"AnnotationLayer",{enumerable:!0,get:function(){return a.AnnotationLayer}}),Object.defineProperty(t,"apiCompatibilityParams",{enumerable:!0,get:function(){return s.apiCompatibilityParams}}),Object.defineProperty(t,"GlobalWorkerOptions",{enumerable:!0,get:function(){return l.GlobalWorkerOptions}}),Object.defineProperty(t,"renderTextLayer",{enumerable:!0,get:function(){return c.renderTextLayer}}),Object.defineProperty(t,"SVGGraphics",{enumerable:!0,get:function(){return u.SVGGraphics}});var n=r(1),i=r(5),o=r(2),a=r(19),s=r(9),l=r(12),c=r(20),u=r(21);{const{isNodeJS:e}=r(4);if(e){const e=r(22).PDFNodeStream;(0,i.setPDFNetworkStreamFactory)((t=>new e(t)))}else{const e=r(25).PDFNetworkStream;let t;(0,n.isFetchSupported)()&&(t=r(26).PDFFetchStream),(0,i.setPDFNetworkStreamFactory)((r=>t&&(0,n.isValidFetchUrl)(r.url)?new t(r):new e(r)))}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addLinkAttributes=function(e){let{url:t,target:r,rel:o,enabled:a=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,n.assert)(t&&"string"===typeof t,'addLinkAttributes: A valid "url" parameter must provided.');const s=(0,n.removeNullCharacters)(t);a?e.href=e.title=s:(e.href="",e.title=`Disabled: ${s}`,e.onclick=()=>!1);let l="";switch(r){case u.NONE:break;case u.SELF:l="_self";break;case u.BLANK:l="_blank";break;case u.PARENT:l="_parent";break;case u.TOP:l="_top"}e.target=l,e.rel="string"===typeof o?o:i},t.getFilenameFromUrl=function(e){const t=e.indexOf("#"),r=e.indexOf("?"),n=Math.min(t>0?t:e.length,r>0?r:e.length);return e.substring(e.lastIndexOf("/",n)+1,n)},t.isFetchSupported=h,t.isValidFetchUrl=d,t.loadScript=function(e){return new Promise(((t,r)=>{const n=document.createElement("script");n.src=e,n.onload=t,n.onerror=function(){r(new Error(`Cannot load script at: ${n.src}`))},(document.head||document.documentElement).appendChild(n)}))},t.deprecated=function(e){console.log("Deprecated API usage: "+e)},t.PDFDateString=t.StatTimer=t.DOMSVGFactory=t.DOMCMapReaderFactory=t.BaseCMapReaderFactory=t.DOMCanvasFactory=t.BaseCanvasFactory=t.DEFAULT_LINK_REL=t.LinkTarget=t.RenderingCancelledException=t.PageViewport=void 0;var n=r(2);const i="noopener noreferrer nofollow";t.DEFAULT_LINK_REL=i;const o="http://www.w3.org/2000/svg";class a{constructor(){this.constructor===a&&(0,n.unreachable)("Cannot initialize BaseCanvasFactory.")}create(e,t){(0,n.unreachable)("Abstract method `create` called.")}reset(e,t,r){if(!e.canvas)throw new Error("Canvas is not specified");if(t<=0||r<=0)throw new Error("Invalid canvas size");e.canvas.width=t,e.canvas.height=r}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}}t.BaseCanvasFactory=a,t.DOMCanvasFactory=class extends a{constructor(){let{ownerDocument:e=globalThis.document}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(),this._document=e}create(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");const r=this._document.createElement("canvas"),n=r.getContext("2d");return r.width=e,r.height=t,{canvas:r,context:n}}};class s{constructor(e){let{baseUrl:t=null,isCompressed:r=!1}=e;this.constructor===s&&(0,n.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=t,this.isCompressed=r}async fetch(e){let{name:t}=e;if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!t)throw new Error("CMap name must be specified.");const r=this.baseUrl+t+(this.isCompressed?".bcmap":""),i=this.isCompressed?n.CMapCompressionType.BINARY:n.CMapCompressionType.NONE;return this._fetchData(r,i).catch((e=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${r}`)}))}_fetchData(e,t){(0,n.unreachable)("Abstract method `_fetchData` called.")}}t.BaseCMapReaderFactory=s,t.DOMCMapReaderFactory=class extends s{_fetchData(e,t){return h()&&d(e,document.baseURI)?fetch(e).then((async e=>{if(!e.ok)throw new Error(e.statusText);let r;return r=this.isCompressed?new Uint8Array(await e.arrayBuffer()):(0,n.stringToBytes)(await e.text()),{cMapData:r,compressionType:t}})):new Promise(((r,i)=>{const o=new XMLHttpRequest;o.open("GET",e,!0),this.isCompressed&&(o.responseType="arraybuffer"),o.onreadystatechange=()=>{if(o.readyState===XMLHttpRequest.DONE){if(200===o.status||0===o.status){let e;if(this.isCompressed&&o.response?e=new Uint8Array(o.response):!this.isCompressed&&o.responseText&&(e=(0,n.stringToBytes)(o.responseText)),e)return void r({cMapData:e,compressionType:t})}i(new Error(o.statusText))}},o.send(null)}))}},t.DOMSVGFactory=class{create(e,t){(0,n.assert)(e>0&&t>0,"Invalid SVG dimensions");const r=document.createElementNS(o,"svg:svg");return r.setAttribute("version","1.1"),r.setAttribute("width",e+"px"),r.setAttribute("height",t+"px"),r.setAttribute("preserveAspectRatio","none"),r.setAttribute("viewBox","0 0 "+e+" "+t),r}createElement(e){return(0,n.assert)("string"===typeof e,"Invalid SVG element type"),document.createElementNS(o,e)}};class l{constructor(e){let{viewBox:t,scale:r,rotation:n,offsetX:i=0,offsetY:o=0,dontFlip:a=!1}=e;this.viewBox=t,this.scale=r,this.rotation=n,this.offsetX=i,this.offsetY=o;const s=(t[2]+t[0])/2,l=(t[3]+t[1])/2;let c,u,h,d,f,g,p,m;switch(n%=360,n=n<0?n+360:n,n){case 180:c=-1,u=0,h=0,d=1;break;case 90:c=0,u=1,h=1,d=0;break;case 270:c=0,u=-1,h=-1,d=0;break;case 0:c=1,u=0,h=0,d=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}a&&(h=-h,d=-d),0===c?(f=Math.abs(l-t[1])*r+i,g=Math.abs(s-t[0])*r+o,p=Math.abs(t[3]-t[1])*r,m=Math.abs(t[2]-t[0])*r):(f=Math.abs(s-t[0])*r+i,g=Math.abs(l-t[1])*r+o,p=Math.abs(t[2]-t[0])*r,m=Math.abs(t[3]-t[1])*r),this.transform=[c*r,u*r,h*r,d*r,f-c*r*s-h*r*l,g-u*r*s-d*r*l],this.width=p,this.height=m}clone(){let{scale:e=this.scale,rotation:t=this.rotation,offsetX:r=this.offsetX,offsetY:n=this.offsetY,dontFlip:i=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new l({viewBox:this.viewBox.slice(),scale:e,rotation:t,offsetX:r,offsetY:n,dontFlip:i})}convertToViewportPoint(e,t){return n.Util.applyTransform([e,t],this.transform)}convertToViewportRectangle(e){const t=n.Util.applyTransform([e[0],e[1]],this.transform),r=n.Util.applyTransform([e[2],e[3]],this.transform);return[t[0],t[1],r[0],r[1]]}convertToPdfPoint(e,t){return n.Util.applyInverseTransform([e,t],this.transform)}}t.PageViewport=l;class c extends n.BaseException{constructor(e,t){super(e),this.type=t}}t.RenderingCancelledException=c;const u={NONE:0,SELF:1,BLANK:2,PARENT:3,TOP:4};function h(){return"undefined"!==typeof fetch&&"undefined"!==typeof Response&&"body"in Response.prototype&&"undefined"!==typeof ReadableStream}function d(e,t){try{const{protocol:r}=t?new URL(e,t):new URL(e);return"http:"===r||"https:"===r}catch(r){return!1}}let f;t.LinkTarget=u,t.StatTimer=class{constructor(){this.started=Object.create(null),this.times=[]}time(e){e in this.started&&(0,n.warn)(`Timer is already running for ${e}`),this.started[e]=Date.now()}timeEnd(e){e in this.started||(0,n.warn)(`Timer has not been started for ${e}`),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){const e=[];let t=0;for(const r of this.times){const e=r.name;e.length>t&&(t=e.length)}for(const r of this.times){const n=r.end-r.start;e.push(`${r.name.padEnd(t)} ${n}ms\n`)}return e.join("")}},t.PDFDateString=class{static toDateObject(e){if(!e||!(0,n.isString)(e))return null;f||(f=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const t=f.exec(e);if(!t)return null;const r=parseInt(t[1],10);let i=parseInt(t[2],10);i=i>=1&&i<=12?i-1:0;let o=parseInt(t[3],10);o=o>=1&&o<=31?o:1;let a=parseInt(t[4],10);a=a>=0&&a<=23?a:0;let s=parseInt(t[5],10);s=s>=0&&s<=59?s:0;let l=parseInt(t[6],10);l=l>=0&&l<=59?l:0;const c=t[7]||"Z";let u=parseInt(t[8],10);u=u>=0&&u<=23?u:0;let h=parseInt(t[9],10)||0;return h=h>=0&&h<=59?h:0,"-"===c?(a+=u,s+=h):"+"===c&&(a-=u,s-=h),new Date(Date.UTC(r,i,o,a,s,l))}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.arrayByteLength=d,t.arraysToBytes=function(e){const t=e.length;if(1===t&&e[0]instanceof Uint8Array)return e[0];let r=0;for(let o=0;o<t;o++)r+=d(e[o]);let n=0;const i=new Uint8Array(r);for(let o=0;o<t;o++){let t=e[o];t instanceof Uint8Array||(t="string"===typeof t?h(t):new Uint8Array(t));const r=t.byteLength;i.set(t,n),n+=r}return i},t.assert=s,t.bytesToString=function(e){s(null!==e&&"object"===typeof e&&void 0!==e.length,"Invalid argument for bytesToString");const t=e.length,r=8192;if(t<r)return String.fromCharCode.apply(null,e);const n=[];for(let i=0;i<t;i+=r){const o=Math.min(i+r,t),a=e.subarray(i,o);n.push(String.fromCharCode.apply(null,a))}return n.join("")},t.createPromiseCapability=function(){const e=Object.create(null);let t=!1;return Object.defineProperty(e,"settled",{get:()=>t}),e.promise=new Promise((function(r,n){e.resolve=function(e){t=!0,r(e)},e.reject=function(e){t=!0,n(e)}})),e},t.escapeString=function(e){return e.replace(/([\(\)\\])/g,"\\$1")},t.encodeToXmlString=function(e){const t=[];let r=0;for(let n=0,i=e.length;n<i;n++){const i=e.codePointAt(n);if(32<=i&&i<=126){const o=y[i];o&&(r<n&&t.push(e.substring(r,n)),t.push(o),r=n+1)}else r<n&&t.push(e.substring(r,n)),t.push(`&#x${i.toString(16).toUpperCase()};`),i>55295&&(i<57344||i>65533)&&n++,r=n+1}return 0===t.length?e:(r<e.length&&t.push(e.substring(r,e.length)),t.join(""))},t.getModificationDate=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Date;return[e.getUTCFullYear().toString(),(e.getUTCMonth()+1).toString().padStart(2,"0"),e.getUTCDate().toString().padStart(2,"0"),e.getUTCHours().toString().padStart(2,"0"),e.getUTCMinutes().toString().padStart(2,"0"),e.getUTCSeconds().toString().padStart(2,"0")].join("")},t.getVerbosityLevel=function(){return i},t.info=function(e){i>=n.INFOS&&console.log(`Info: ${e}`)},t.isArrayBuffer=function(e){return"object"===typeof e&&null!==e&&void 0!==e.byteLength},t.isArrayEqual=function(e,t){return e.length===t.length&&e.every((function(e,r){return e===t[r]}))},t.isBool=function(e){return"boolean"===typeof e},t.isNum=function(e){return"number"===typeof e},t.isString=function(e){return"string"===typeof e},t.isSameOrigin=function(e,t){let r;try{if(r=new URL(e),!r.origin||"null"===r.origin)return!1}catch(i){return!1}const n=new URL(t,r);return r.origin===n.origin},t.createValidAbsoluteUrl=function(e,t){if(!e)return null;try{const r=t?new URL(e,t):new URL(e);if(function(e){if(!e)return!1;switch(e.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}(r))return r}catch(r){}return null},t.removeNullCharacters=function(e){return"string"!==typeof e?(o("The argument for removeNullCharacters must be a string."),e):e.replace(u,"")},t.setVerbosityLevel=function(e){Number.isInteger(e)&&(i=e)},t.shadow=l,t.string32=function(e){return String.fromCharCode(e>>24&255,e>>16&255,e>>8&255,255&e)},t.stringToBytes=h,t.stringToPDFString=function(e){const t=e.length,r=[];if("\xfe"===e[0]&&"\xff"===e[1])for(let n=2;n<t;n+=2)r.push(String.fromCharCode(e.charCodeAt(n)<<8|e.charCodeAt(n+1)));else if("\xff"===e[0]&&"\xfe"===e[1])for(let n=2;n<t;n+=2)r.push(String.fromCharCode(e.charCodeAt(n+1)<<8|e.charCodeAt(n)));else for(let n=0;n<t;++n){const t=v[e.charCodeAt(n)];r.push(t?String.fromCharCode(t):e.charAt(n))}return r.join("")},t.stringToUTF8String=function(e){return decodeURIComponent(escape(e))},t.utf8StringToString=function(e){return unescape(encodeURIComponent(e))},t.warn=o,t.unreachable=a,t.IsEvalSupportedCached=t.IsLittleEndianCached=t.createObjectURL=t.FormatError=t.Util=t.UnknownErrorException=t.UnexpectedResponseException=t.TextRenderingMode=t.StreamType=t.PermissionFlag=t.PasswordResponses=t.PasswordException=t.MissingPDFException=t.InvalidPDFException=t.AbortException=t.CMapCompressionType=t.ImageKind=t.FontType=t.AnnotationType=t.AnnotationStateModelType=t.AnnotationReviewState=t.AnnotationReplyType=t.AnnotationMarkedState=t.AnnotationFlag=t.AnnotationFieldFlag=t.AnnotationBorderStyleType=t.UNSUPPORTED_FEATURES=t.VerbosityLevel=t.OPS=t.IDENTITY_MATRIX=t.FONT_IDENTITY_MATRIX=t.BaseException=void 0,r(3),t.IDENTITY_MATRIX=[1,0,0,1,0,0],t.FONT_IDENTITY_MATRIX=[.001,0,0,.001,0,0],t.PermissionFlag={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},t.TextRenderingMode={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},t.ImageKind={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},t.AnnotationType={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},t.AnnotationStateModelType={MARKED:"Marked",REVIEW:"Review"},t.AnnotationMarkedState={MARKED:"Marked",UNMARKED:"Unmarked"},t.AnnotationReviewState={ACCEPTED:"Accepted",REJECTED:"Rejected",CANCELLED:"Cancelled",COMPLETED:"Completed",NONE:"None"},t.AnnotationReplyType={GROUP:"Group",REPLY:"R"},t.AnnotationFlag={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512},t.AnnotationFieldFlag={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864},t.AnnotationBorderStyleType={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},t.StreamType={UNKNOWN:"UNKNOWN",FLATE:"FLATE",LZW:"LZW",DCT:"DCT",JPX:"JPX",JBIG:"JBIG",A85:"A85",AHX:"AHX",CCF:"CCF",RLX:"RLX"},t.FontType={UNKNOWN:"UNKNOWN",TYPE1:"TYPE1",TYPE1C:"TYPE1C",CIDFONTTYPE0:"CIDFONTTYPE0",CIDFONTTYPE0C:"CIDFONTTYPE0C",TRUETYPE:"TRUETYPE",CIDFONTTYPE2:"CIDFONTTYPE2",TYPE3:"TYPE3",OPENTYPE:"OPENTYPE",TYPE0:"TYPE0",MMTYPE1:"MMTYPE1"};const n={ERRORS:0,WARNINGS:1,INFOS:5};t.VerbosityLevel=n,t.CMapCompressionType={NONE:0,BINARY:1,STREAM:2},t.OPS={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotations:78,endAnnotations:79,beginAnnotation:80,endAnnotation:81,paintJpegXObject:82,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91},t.UNSUPPORTED_FEATURES={unknown:"unknown",forms:"forms",javaScript:"javaScript",smask:"smask",shadingPattern:"shadingPattern",font:"font",errorTilingPattern:"errorTilingPattern",errorExtGState:"errorExtGState",errorXObject:"errorXObject",errorFontLoadType3:"errorFontLoadType3",errorFontState:"errorFontState",errorFontMissing:"errorFontMissing",errorFontTranslate:"errorFontTranslate",errorColorSpace:"errorColorSpace",errorOperatorList:"errorOperatorList",errorFontToUnicode:"errorFontToUnicode",errorFontLoadNative:"errorFontLoadNative",errorFontGetPath:"errorFontGetPath",errorMarkedContent:"errorMarkedContent"},t.PasswordResponses={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let i=n.WARNINGS;function o(e){i>=n.WARNINGS&&console.log(`Warning: ${e}`)}function a(e){throw new Error(e)}function s(e,t){e||a(t)}function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!1}),r}const c=function(){function e(t){this.constructor===e&&a("Cannot initialize BaseException."),this.message=t,this.name=this.constructor.name}return e.prototype=new Error,e.constructor=e,e}();t.BaseException=c,t.PasswordException=class extends c{constructor(e,t){super(e),this.code=t}},t.UnknownErrorException=class extends c{constructor(e,t){super(e),this.details=t}},t.InvalidPDFException=class extends c{},t.MissingPDFException=class extends c{},t.UnexpectedResponseException=class extends c{constructor(e,t){super(e),this.status=t}},t.FormatError=class extends c{},t.AbortException=class extends c{};const u=/\x00/g;function h(e){s("string"===typeof e,"Invalid argument for stringToBytes");const t=e.length,r=new Uint8Array(t);for(let n=0;n<t;++n)r[n]=255&e.charCodeAt(n);return r}function d(e){return void 0!==e.length?e.length:(s(void 0!==e.byteLength,"arrayByteLength - invalid argument."),e.byteLength)}const f={get value(){return l(this,"value",function(){const e=new Uint8Array(4);return e[0]=1,1===new Uint32Array(e.buffer,0,1)[0]}())}};t.IsLittleEndianCached=f;const g={get value(){return l(this,"value",function(){try{return new Function(""),!0}catch(e){return!1}}())}};t.IsEvalSupportedCached=g;const p=["rgb(",0,",",0,",",0,")"];class m{static makeCssRgb(e,t,r){return p[1]=e,p[3]=t,p[5]=r,p.join("")}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static applyTransform(e,t){return[e[0]*t[0]+e[1]*t[2]+t[4],e[0]*t[1]+e[1]*t[3]+t[5]]}static applyInverseTransform(e,t){const r=t[0]*t[3]-t[1]*t[2];return[(e[0]*t[3]-e[1]*t[2]+t[2]*t[5]-t[4]*t[3])/r,(-e[0]*t[1]+e[1]*t[0]+t[4]*t[1]-t[5]*t[0])/r]}static getAxialAlignedBoundingBox(e,t){const r=m.applyTransform(e,t),n=m.applyTransform(e.slice(2,4),t),i=m.applyTransform([e[0],e[3]],t),o=m.applyTransform([e[2],e[1]],t);return[Math.min(r[0],n[0],i[0],o[0]),Math.min(r[1],n[1],i[1],o[1]),Math.max(r[0],n[0],i[0],o[0]),Math.max(r[1],n[1],i[1],o[1])]}static inverseTransform(e){const t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static apply3dTransform(e,t){return[e[0]*t[0]+e[1]*t[1]+e[2]*t[2],e[3]*t[0]+e[4]*t[1]+e[5]*t[2],e[6]*t[0]+e[7]*t[1]+e[8]*t[2]]}static singularValueDecompose2dScale(e){const t=[e[0],e[2],e[1],e[3]],r=e[0]*t[0]+e[1]*t[2],n=e[0]*t[1]+e[1]*t[3],i=e[2]*t[0]+e[3]*t[2],o=e[2]*t[1]+e[3]*t[3],a=(r+o)/2,s=Math.sqrt((r+o)*(r+o)-4*(r*o-i*n))/2,l=a+s||1,c=a-s||1;return[Math.sqrt(l),Math.sqrt(c)]}static normalizeRect(e){const t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){function r(e,t){return e-t}const n=[e[0],e[2],t[0],t[2]].sort(r),i=[e[1],e[3],t[1],t[3]].sort(r),o=[];return e=m.normalizeRect(e),t=m.normalizeRect(t),n[0]===e[0]&&n[1]===t[0]||n[0]===t[0]&&n[1]===e[0]?(o[0]=n[1],o[2]=n[2],i[0]===e[1]&&i[1]===t[1]||i[0]===t[1]&&i[1]===e[1]?(o[1]=i[1],o[3]=i[2],o):null):null}}t.Util=m;const v=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364],b=function(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";return function(t,r){if(!(arguments.length>2&&void 0!==arguments[2]&&arguments[2])&&URL.createObjectURL){const e=new Blob([t],{type:r});return URL.createObjectURL(e)}let n=`data:${r};base64,`;for(let i=0,o=t.length;i<o;i+=3){const r=255&t[i],a=255&t[i+1],s=255&t[i+2];n+=e[r>>2]+e[(3&r)<<4|a>>4]+e[i+1<o?(15&a)<<2|s>>6:64]+e[i+2<o?63&s:64]}return n}}();t.createObjectURL=b;const y={60:"&lt;",62:"&gt;",38:"&amp;",34:"&quot;",39:"&apos;"}},function(e,t,r){"use strict";r(4)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isNodeJS=void 0;const n="object"===typeof process&&process+""==="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&"browser"!==process.type);t.isNodeJS=n},function(module,exports,__w_pdfjs_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getDocument=getDocument,exports.setPDFNetworkStreamFactory=setPDFNetworkStreamFactory,exports.build=exports.version=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFWorker=exports.PDFDataRangeTransport=exports.LoopbackPort=void 0;var _util=__w_pdfjs_require__(2),_display_utils=__w_pdfjs_require__(1),_font_loader=__w_pdfjs_require__(6),_node_utils=__w_pdfjs_require__(7),_annotation_storage=__w_pdfjs_require__(8),_api_compatibility=__w_pdfjs_require__(9),_canvas=__w_pdfjs_require__(10),_worker_options=__w_pdfjs_require__(12),_is_node=__w_pdfjs_require__(4),_message_handler=__w_pdfjs_require__(13),_metadata=__w_pdfjs_require__(14),_optional_content_config=__w_pdfjs_require__(16),_transport_stream=__w_pdfjs_require__(17),_webgl=__w_pdfjs_require__(18);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100,DefaultCanvasFactory=_is_node.isNodeJS?_node_utils.NodeCanvasFactory:_display_utils.DOMCanvasFactory,DefaultCMapReaderFactory=_is_node.isNodeJS?_node_utils.NodeCMapReaderFactory:_display_utils.DOMCMapReaderFactory;let createPDFNetworkStream;function setPDFNetworkStreamFactory(e){createPDFNetworkStream=e}function getDocument(e){const t=new PDFDocumentLoadingTask;let r;if("string"===typeof e)r={url:e};else if((0,_util.isArrayBuffer)(e))r={data:e};else if(e instanceof PDFDataRangeTransport)r={range:e};else{if("object"!==typeof e)throw new Error("Invalid parameter in getDocument, need either Uint8Array, string or a parameter object");if(!e.url&&!e.data&&!e.range)throw new Error("Invalid parameter object: need either .data, .range or .url");r=e}const n=Object.create(null);let i=null,o=null;for(const s in r)if("url"!==s||"undefined"===typeof window)if("range"!==s)if("worker"!==s)if("data"!==s||r[s]instanceof Uint8Array)n[s]=r[s];else{const e=r[s];if("string"===typeof e)n[s]=(0,_util.stringToBytes)(e);else if("object"!==typeof e||null===e||isNaN(e.length)){if(!(0,_util.isArrayBuffer)(e))throw new Error("Invalid PDF binary data: either typed array, string or array-like object is expected in the data property.");n[s]=new Uint8Array(e)}else n[s]=new Uint8Array(e)}else o=r[s];else i=r[s];else n[s]=new URL(r[s],window.location).href;if(n.rangeChunkSize=n.rangeChunkSize||DEFAULT_RANGE_CHUNK_SIZE,n.CMapReaderFactory=n.CMapReaderFactory||DefaultCMapReaderFactory,n.ignoreErrors=!0!==n.stopAtErrors,n.fontExtraProperties=!0===n.fontExtraProperties,n.pdfBug=!0===n.pdfBug,Number.isInteger(n.maxImageSize)||(n.maxImageSize=-1),"boolean"!==typeof n.isEvalSupported&&(n.isEvalSupported=!0),"boolean"!==typeof n.disableFontFace&&(n.disableFontFace=_api_compatibility.apiCompatibilityParams.disableFontFace||!1),"undefined"===typeof n.ownerDocument&&(n.ownerDocument=globalThis.document),"boolean"!==typeof n.disableRange&&(n.disableRange=!1),"boolean"!==typeof n.disableStream&&(n.disableStream=!1),"boolean"!==typeof n.disableAutoFetch&&(n.disableAutoFetch=!1),(0,_util.setVerbosityLevel)(n.verbosity),!o){const e={verbosity:n.verbosity,port:_worker_options.GlobalWorkerOptions.workerPort};o=e.port?PDFWorker.fromPort(e):new PDFWorker(e),t._worker=o}const a=t.docId;return o.promise.then((function(){if(t.destroyed)throw new Error("Loading aborted");const e=_fetchDocument(o,n,i,a),r=new Promise((function(e){let t;i?t=new _transport_stream.PDFDataTransportStream({length:n.length,initialData:n.initialData,progressiveDone:n.progressiveDone,disableRange:n.disableRange,disableStream:n.disableStream},i):n.data||(t=createPDFNetworkStream({url:n.url,length:n.length,httpHeaders:n.httpHeaders,withCredentials:n.withCredentials,rangeChunkSize:n.rangeChunkSize,disableRange:n.disableRange,disableStream:n.disableStream})),e(t)}));return Promise.all([e,r]).then((function(e){let[r,i]=e;if(t.destroyed)throw new Error("Loading aborted");const s=new _message_handler.MessageHandler(a,r,o.port);s.postMessageTransfers=o.postMessageTransfers;const l=new WorkerTransport(s,t,i,n);t._transport=l,s.send("Ready",null)}))})).catch(t._capability.reject),t}function _fetchDocument(e,t,r,n){return e.destroyed?Promise.reject(new Error("Worker was destroyed")):(r&&(t.length=r.length,t.initialData=r.initialData,t.progressiveDone=r.progressiveDone),e.messageHandler.sendWithPromise("GetDocRequest",{docId:n,apiVersion:"2.7.39",source:{data:t.data,url:t.url,password:t.password,disableAutoFetch:t.disableAutoFetch,rangeChunkSize:t.rangeChunkSize,length:t.length},maxImageSize:t.maxImageSize,disableFontFace:t.disableFontFace,postMessageTransfers:e.postMessageTransfers,docBaseUrl:t.docBaseUrl,ignoreErrors:t.ignoreErrors,isEvalSupported:t.isEvalSupported,fontExtraProperties:t.fontExtraProperties}).then((function(t){if(e.destroyed)throw new Error("Worker was destroyed");return t})))}const PDFDocumentLoadingTask=function(){let e=0;return class{constructor(){this._capability=(0,_util.createPromiseCapability)(),this._transport=null,this._worker=null,this.docId="d"+e++,this.destroyed=!1,this.onPassword=null,this.onProgress=null,this.onUnsupportedFeature=null}get promise(){return this._capability.promise}destroy(){return this.destroyed=!0,(this._transport?this._transport.destroy():Promise.resolve()).then((()=>{this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}))}}}();class PDFDataRangeTransport{constructor(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.length=e,this.initialData=t,this.progressiveDone=r,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=(0,_util.createPromiseCapability)()}addRangeListener(e){this._rangeListeners.push(e)}addProgressListener(e){this._progressListeners.push(e)}addProgressiveReadListener(e){this._progressiveReadListeners.push(e)}addProgressiveDoneListener(e){this._progressiveDoneListeners.push(e)}onDataRange(e,t){for(const r of this._rangeListeners)r(e,t)}onDataProgress(e,t){this._readyCapability.promise.then((()=>{for(const r of this._progressListeners)r(e,t)}))}onDataProgressiveRead(e){this._readyCapability.promise.then((()=>{for(const t of this._progressiveReadListeners)t(e)}))}onDataProgressiveDone(){this._readyCapability.promise.then((()=>{for(const e of this._progressiveDoneListeners)e()}))}transportReady(){this._readyCapability.resolve()}requestDataRange(e,t){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(e,t){this._pdfInfo=e,this._transport=t}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}get numPages(){return this._pdfInfo.numPages}get fingerprint(){return this._pdfInfo.fingerprint}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJavaScript(){return this._transport.getJavaScript()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getData(){return this._transport.getData()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}getStats(){return this._transport.getStats()}getXFA(){return this._transport.getXFA()}cleanup(){return this._transport.startCleanup()}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}saveDocument(e){return this._transport.saveDocument(e)}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{constructor(e,t,r,n){let i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this._pageIndex=e,this._pageInfo=t,this._ownerDocument=n,this._transport=r,this._stats=i?new _display_utils.StatTimer:null,this._pdfBug=i,this.commonObjs=r.commonObjs,this.objs=new PDFObjects,this.cleanupAfterRender=!1,this.pendingCleanup=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport(){let{scale:e,rotation:t=this.rotate,offsetX:r=0,offsetY:n=0,dontFlip:i=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new _display_utils.PageViewport({viewBox:this.view,scale:e,rotation:t,offsetX:r,offsetY:n,dontFlip:i})}getAnnotations(){let{intent:e=null}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.annotationsPromise&&this.annotationsIntent===e||(this.annotationsPromise=this._transport.getAnnotations(this._pageIndex,e),this.annotationsIntent=e),this.annotationsPromise}render(e){let{canvasContext:t,viewport:r,intent:n="display",enableWebGL:i=!1,renderInteractiveForms:o=!1,transform:a=null,imageLayer:s=null,canvasFactory:l=null,background:c=null,annotationStorage:u=null,optionalContentConfigPromise:h=null}=e;this._stats&&this._stats.time("Overall");const d="print"===n?"print":"display";this.pendingCleanup=!1,h||(h=this._transport.getOptionalContentConfig());let f=this._intentStates.get(d);f||(f=Object.create(null),this._intentStates.set(d,f)),f.streamReaderCancelTimeout&&(clearTimeout(f.streamReaderCancelTimeout),f.streamReaderCancelTimeout=null);const g=l||new DefaultCanvasFactory({ownerDocument:this._ownerDocument}),p=new _webgl.WebGLContext({enable:i});f.displayReadyCapability||(f.displayReadyCapability=(0,_util.createPromiseCapability)(),f.operatorList={fnArray:[],argsArray:[],lastChunk:!1},this._stats&&this._stats.time("Page Request"),this._pumpOperatorList({pageIndex:this._pageIndex,intent:d,renderInteractiveForms:!0===o,annotationStorage:u&&u.getAll()||null}));const m=e=>{const t=f.renderTasks.indexOf(v);t>=0&&f.renderTasks.splice(t,1),(this.cleanupAfterRender||"print"===d)&&(this.pendingCleanup=!0),this._tryCleanup(),e?(v.capability.reject(e),this._abortOperatorList({intentState:f,reason:e})):v.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"))},v=new InternalRenderTask({callback:m,params:{canvasContext:t,viewport:r,transform:a,imageLayer:s,background:c},objs:this.objs,commonObjs:this.commonObjs,operatorList:f.operatorList,pageIndex:this._pageIndex,canvasFactory:g,webGLContext:p,useRequestAnimationFrame:"print"!==d,pdfBug:this._pdfBug});f.renderTasks||(f.renderTasks=[]),f.renderTasks.push(v);const b=v.task;return Promise.all([f.displayReadyCapability.promise,h]).then((e=>{let[t,r]=e;this.pendingCleanup?m():(this._stats&&this._stats.time("Rendering"),v.initializeGraphics({transparency:t,optionalContentConfig:r}),v.operatorListChanged())})).catch(m),b}getOperatorList(){const e="oplist";let t,r=this._intentStates.get(e);return r||(r=Object.create(null),this._intentStates.set(e,r)),r.opListReadCapability||(t=Object.create(null),t.operatorListChanged=function(){if(r.operatorList.lastChunk){r.opListReadCapability.resolve(r.operatorList);const e=r.renderTasks.indexOf(t);e>=0&&r.renderTasks.splice(e,1)}},r.opListReadCapability=(0,_util.createPromiseCapability)(),r.renderTasks=[],r.renderTasks.push(t),r.operatorList={fnArray:[],argsArray:[],lastChunk:!1},this._stats&&this._stats.time("Page Request"),this._pumpOperatorList({pageIndex:this._pageIndex,intent:e})),r.opListReadCapability.promise}streamTextContent(){let{normalizeWhitespace:e=!1,disableCombineTextItems:t=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,normalizeWhitespace:!0===e,combineTextItems:!0!==t},{highWaterMark:100,size:e=>e.items.length})}getTextContent(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=this.streamTextContent(e);return new Promise((function(e,r){const n=t.getReader(),i={items:[],styles:Object.create(null)};!function t(){n.read().then((function(r){let{value:n,done:o}=r;o?e(i):(Object.assign(i.styles,n.styles),i.items.push(...n.items),t())}),r)}()}))}_destroy(){this.destroyed=!0,this._transport.pageCache[this._pageIndex]=null;const e=[];for(const[t,r]of this._intentStates)if(this._abortOperatorList({intentState:r,reason:new Error("Page was destroyed."),force:!0}),"oplist"!==t)for(const n of r.renderTasks)e.push(n.completed),n.cancel();return this.objs.clear(),this.annotationsPromise=null,this.pendingCleanup=!1,Promise.all(e)}cleanup(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.pendingCleanup=!0,this._tryCleanup(e)}_tryCleanup(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.pendingCleanup)return!1;for(const{renderTasks:t,operatorList:r}of this._intentStates.values())if(0!==t.length||!r.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.annotationsPromise=null,e&&this._stats&&(this._stats=new _display_utils.StatTimer),this.pendingCleanup=!1,!0}_startRenderPage(e,t){const r=this._intentStates.get(t);r&&(this._stats&&this._stats.timeEnd("Page Request"),r.displayReadyCapability&&r.displayReadyCapability.resolve(e))}_renderPageChunk(e,t){for(let r=0,n=e.length;r<n;r++)t.operatorList.fnArray.push(e.fnArray[r]),t.operatorList.argsArray.push(e.argsArray[r]);t.operatorList.lastChunk=e.lastChunk;for(let r=0;r<t.renderTasks.length;r++)t.renderTasks[r].operatorListChanged();e.lastChunk&&this._tryCleanup()}_pumpOperatorList(e){(0,_util.assert)(e.intent,'PDFPageProxy._pumpOperatorList: Expected "intent" argument.');const t=this._transport.messageHandler.sendWithStream("GetOperatorList",e).getReader(),r=this._intentStates.get(e.intent);r.streamReader=t;const n=()=>{t.read().then((e=>{let{value:t,done:i}=e;i?r.streamReader=null:this._transport.destroyed||(this._renderPageChunk(t,r),n())}),(e=>{if(r.streamReader=null,!this._transport.destroyed){if(r.operatorList){r.operatorList.lastChunk=!0;for(let e=0;e<r.renderTasks.length;e++)r.renderTasks[e].operatorListChanged();this._tryCleanup()}if(r.displayReadyCapability)r.displayReadyCapability.reject(e);else{if(!r.opListReadCapability)throw e;r.opListReadCapability.reject(e)}}}))};n()}_abortOperatorList(e){let{intentState:t,reason:r,force:n=!1}=e;if((0,_util.assert)(r instanceof Error||"object"===typeof r&&null!==r,'PDFPageProxy._abortOperatorList: Expected "reason" argument.'),t.streamReader){if(!n){if(0!==t.renderTasks.length)return;if(r instanceof _display_utils.RenderingCancelledException)return void(t.streamReaderCancelTimeout=setTimeout((()=>{this._abortOperatorList({intentState:t,reason:r,force:!0}),t.streamReaderCancelTimeout=null}),RENDERING_CANCELLED_TIMEOUT))}if(t.streamReader.cancel(new _util.AbortException(r&&r.message)),t.streamReader=null,!this._transport.destroyed){for(const[e,r]of this._intentStates)if(r===t){this._intentStates.delete(e);break}this.cleanup()}}}get stats(){return this._stats}}exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{constructor(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._listeners=[],this._defer=e,this._deferred=Promise.resolve(void 0)}postMessage(e,t){if(!this._defer)return void this._listeners.forEach((t=>{t.call(this,{data:e})}));const r=new WeakMap,n={data:function e(n){if("object"!==typeof n||null===n)return n;if(r.has(n))return r.get(n);let i,o;if((i=n.buffer)&&(0,_util.isArrayBuffer)(i))return o=t&&t.includes(i)?new n.constructor(i,n.byteOffset,n.byteLength):new n.constructor(n),r.set(n,o),o;o=Array.isArray(n)?[]:{},r.set(n,o);for(const t in n){let r,i=n;for(;!(r=Object.getOwnPropertyDescriptor(i,t));)i=Object.getPrototypeOf(i);if("undefined"!==typeof r.value)if("function"!==typeof r.value)o[t]=e(r.value);else if(n.hasOwnProperty&&n.hasOwnProperty(t))throw new Error(`LoopbackPort.postMessage - cannot clone: ${n[t]}`)}return o}(e)};this._deferred.then((()=>{this._listeners.forEach((e=>{e.call(this,n)}))}))}addEventListener(e,t){this._listeners.push(t)}removeEventListener(e,t){const r=this._listeners.indexOf(t);this._listeners.splice(r,1)}terminate(){this._listeners.length=0}}exports.LoopbackPort=LoopbackPort;const PDFWorker=function PDFWorkerClosure(){const pdfWorkerPorts=new WeakMap;let isWorkerDisabled=!1,fallbackWorkerSrc,nextFakeWorkerId=0,fakeWorkerCapability;if(_is_node.isNodeJS)isWorkerDisabled=!0,fallbackWorkerSrc="./pdf.worker.js";else if("object"===typeof document&&"currentScript"in document){const e=document.currentScript&&document.currentScript.src;e&&(fallbackWorkerSrc=e.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}function getWorkerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if("undefined"!==typeof fallbackWorkerSrc)return _is_node.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}function getMainThreadWorkerMessageHandler(){let e;try{e=globalThis.pdfjsWorker&&globalThis.pdfjsWorker.WorkerMessageHandler}catch(t){}return e||null}function setupFakeWorkerGlobal(){if(fakeWorkerCapability)return fakeWorkerCapability.promise;fakeWorkerCapability=(0,_util.createPromiseCapability)();const loader=async function(){const mainWorkerMessageHandler=getMainThreadWorkerMessageHandler();if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_is_node.isNodeJS){const worker=eval("require")(getWorkerSrc());return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(getWorkerSrc()),window.pdfjsWorker.WorkerMessageHandler};return loader().then(fakeWorkerCapability.resolve,fakeWorkerCapability.reject),fakeWorkerCapability.promise}function createCDNWrapper(e){const t="importScripts('"+e+"');";return URL.createObjectURL(new Blob([t]))}class PDFWorker{constructor(){let{name:e=null,port:t=null,verbosity:r=(0,_util.getVerbosityLevel)()}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(t&&pdfWorkerPorts.has(t))throw new Error("Cannot use more than one PDFWorker per port");if(this.name=e,this.destroyed=!1,this.postMessageTransfers=!0,this.verbosity=r,this._readyCapability=(0,_util.createPromiseCapability)(),this._port=null,this._webWorker=null,this._messageHandler=null,t)return pdfWorkerPorts.set(t,this),void this._initializeFromPort(t);this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(e){this._port=e,this._messageHandler=new _message_handler.MessageHandler("main","worker",e),this._messageHandler.on("ready",(function(){})),this._readyCapability.resolve()}_initialize(){if("undefined"!==typeof Worker&&!isWorkerDisabled&&!getMainThreadWorkerMessageHandler()){let t=getWorkerSrc();try{(0,_util.isSameOrigin)(window.location.href,t)||(t=createCDNWrapper(new URL(t,window.location).href));const e=new Worker(t),r=new _message_handler.MessageHandler("main","worker",e),n=()=>{e.removeEventListener("error",i),r.destroy(),e.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},i=()=>{this._webWorker||n()};e.addEventListener("error",i),r.on("test",(t=>{e.removeEventListener("error",i),this.destroyed?n():t?(this._messageHandler=r,this._port=e,this._webWorker=e,t.supportTransfers||(this.postMessageTransfers=!1),this._readyCapability.resolve(),r.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),r.destroy(),e.terminate())})),r.on("ready",(t=>{if(e.removeEventListener("error",i),this.destroyed)n();else try{o()}catch(r){this._setupFakeWorker()}}));const o=()=>{const e=new Uint8Array([this.postMessageTransfers?255:0]);try{r.send("test",e,[e.buffer])}catch(t){(0,_util.warn)("Cannot use postMessage transfers."),e[0]=0,r.send("test",e)}};return void o()}catch(e){(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),isWorkerDisabled=!0),setupFakeWorkerGlobal().then((e=>{if(this.destroyed)return void this._readyCapability.reject(new Error("Worker was destroyed"));const t=new LoopbackPort;this._port=t;const r="fake"+nextFakeWorkerId++,n=new _message_handler.MessageHandler(r+"_worker",r,t);e.setup(n,t);const i=new _message_handler.MessageHandler(r,r+"_worker",t);this._messageHandler=i,this._readyCapability.resolve(),i.send("configure",{verbosity:this.verbosity})})).catch((e=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${e.message}".`))}))}destroy(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),pdfWorkerPorts.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(e){if(!e||!e.port)throw new Error("PDFWorker.fromPort - invalid method signature.");return pdfWorkerPorts.has(e.port)?pdfWorkerPorts.get(e.port):new PDFWorker(e)}static getWorkerSrc(){return getWorkerSrc()}}return PDFWorker}();exports.PDFWorker=PDFWorker;class WorkerTransport{constructor(e,t,r,n){this.messageHandler=e,this.loadingTask=t,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({docId:t.docId,onUnsupportedFeature:this._onUnsupportedFeature.bind(this),ownerDocument:n.ownerDocument}),this._params=n,this.CMapReaderFactory=new n.CMapReaderFactory({baseUrl:n.cMapUrl,isCompressed:n.cMapPacked}),this.destroyed=!1,this.destroyCapability=null,this._passwordCapability=null,this._networkStream=r,this._fullReader=null,this._lastProgress=null,this.pageCache=[],this.pagePromises=[],this.downloadInfoCapability=(0,_util.createPromiseCapability)(),this.setupMessageHandler()}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=(0,_util.createPromiseCapability)(),this._passwordCapability&&this._passwordCapability.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];this.pageCache.forEach((function(t){t&&e.push(t._destroy())})),this.pageCache.length=0,this.pagePromises.length=0;const t=this.messageHandler.sendWithPromise("Terminate",null);return e.push(t),Promise.all(e).then((()=>{this.fontLoader.clear(),this._networkStream&&this._networkStream.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()}),this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:t}=this;e.on("GetReader",((e,t)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=e=>{this._lastProgress={loaded:e.loaded,total:e.total}},t.onPull=()=>{this._fullReader.read().then((function(e){let{value:r,done:n}=e;n?t.close():((0,_util.assert)((0,_util.isArrayBuffer)(r),"GetReader - expected an ArrayBuffer."),t.enqueue(new Uint8Array(r),1,[r]))})).catch((e=>{t.error(e)}))},t.onCancel=e=>{this._fullReader.cancel(e),t.ready.catch((e=>{if(!this.destroyed)throw e}))}})),e.on("ReaderHeadersReady",(e=>{const r=(0,_util.createPromiseCapability)(),n=this._fullReader;return n.headersReady.then((()=>{n.isStreamingSupported&&n.isRangeSupported||(this._lastProgress&&t.onProgress&&t.onProgress(this._lastProgress),n.onProgress=e=>{t.onProgress&&t.onProgress({loaded:e.loaded,total:e.total})}),r.resolve({isStreamingSupported:n.isStreamingSupported,isRangeSupported:n.isRangeSupported,contentLength:n.contentLength})}),r.reject),r.promise})),e.on("GetRangeReader",((e,t)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const r=this._networkStream.getRangeReader(e.begin,e.end);r?(t.onPull=()=>{r.read().then((function(e){let{value:r,done:n}=e;n?t.close():((0,_util.assert)((0,_util.isArrayBuffer)(r),"GetRangeReader - expected an ArrayBuffer."),t.enqueue(new Uint8Array(r),1,[r]))})).catch((e=>{t.error(e)}))},t.onCancel=e=>{r.cancel(e),t.ready.catch((e=>{if(!this.destroyed)throw e}))}):t.close()})),e.on("GetDoc",(e=>{let{pdfInfo:r}=e;this._numPages=r.numPages,t._capability.resolve(new PDFDocumentProxy(r,this))})),e.on("DocException",(function(e){let r;switch(e.name){case"PasswordException":r=new _util.PasswordException(e.message,e.code);break;case"InvalidPDFException":r=new _util.InvalidPDFException(e.message);break;case"MissingPDFException":r=new _util.MissingPDFException(e.message);break;case"UnexpectedResponseException":r=new _util.UnexpectedResponseException(e.message,e.status);break;case"UnknownErrorException":r=new _util.UnknownErrorException(e.message,e.details)}if(!(r instanceof Error)){const e="DocException - expected a valid Error.";(0,_util.warn)(e)}t._capability.reject(r)})),e.on("PasswordRequest",(e=>{if(this._passwordCapability=(0,_util.createPromiseCapability)(),t.onPassword){const n=e=>{this._passwordCapability.resolve({password:e})};try{t.onPassword(n,e.code)}catch(r){this._passwordCapability.reject(r)}}else this._passwordCapability.reject(new _util.PasswordException(e.message,e.code));return this._passwordCapability.promise})),e.on("DataLoaded",(e=>{t.onProgress&&t.onProgress({loaded:e.length,total:e.length}),this.downloadInfoCapability.resolve(e)})),e.on("StartRenderPage",(e=>{this.destroyed||this.pageCache[e.pageIndex]._startRenderPage(e.transparency,e.intent)})),e.on("commonobj",(t=>{if(this.destroyed)return;const[r,n,i]=t;if(!this.commonObjs.has(r))switch(n){case"Font":const t=this._params;if("error"in i){const e=i.error;(0,_util.warn)(`Error during font loading: ${e}`),this.commonObjs.resolve(r,e);break}let o=null;t.pdfBug&&globalThis.FontInspector&&globalThis.FontInspector.enabled&&(o={registerFont(e,t){globalThis.FontInspector.fontAdded(e,t)}});const a=new _font_loader.FontFaceObject(i,{isEvalSupported:t.isEvalSupported,disableFontFace:t.disableFontFace,ignoreErrors:t.ignoreErrors,onUnsupportedFeature:this._onUnsupportedFeature.bind(this),fontRegistry:o});this.fontLoader.bind(a).catch((t=>e.sendWithPromise("FontFallback",{id:r}))).finally((()=>{!t.fontExtraProperties&&a.data&&(a.data=null),this.commonObjs.resolve(r,a)}));break;case"FontPath":case"Image":this.commonObjs.resolve(r,i);break;default:throw new Error(`Got unknown common object type ${n}`)}})),e.on("obj",(e=>{if(this.destroyed)return;const[t,r,n,i]=e,o=this.pageCache[r];if(!o.objs.has(t)){if("Image"!==n)throw new Error(`Got unknown object type ${n}`);{o.objs.resolve(t,i);const e=8e6;i&&"data"in i&&i.data.length>e&&(o.cleanupAfterRender=!0)}}})),e.on("DocProgress",(e=>{this.destroyed||t.onProgress&&t.onProgress({loaded:e.loaded,total:e.total})})),e.on("UnsupportedFeature",this._onUnsupportedFeature.bind(this)),e.on("FetchBuiltInCMap",((e,t)=>{if(this.destroyed)return void t.error(new Error("Worker was destroyed"));let r=!1;t.onPull=()=>{r?t.close():(r=!0,this.CMapReaderFactory.fetch(e).then((function(e){t.enqueue(e,1,[e.cMapData.buffer])})).catch((function(e){t.error(e)})))}}))}_onUnsupportedFeature(e){let{featureId:t}=e;this.destroyed||this.loadingTask.onUnsupportedFeature&&this.loadingTask.onUnsupportedFeature(t)}getData(){return this.messageHandler.sendWithPromise("GetData",null)}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request"));const t=e-1;if(t in this.pagePromises)return this.pagePromises[t];const r=this.messageHandler.sendWithPromise("GetPage",{pageIndex:t}).then((e=>{if(this.destroyed)throw new Error("Transport destroyed");const r=new PDFPageProxy(t,e,this,this._params.ownerDocument,this._params.pdfBug);return this.pageCache[t]=r,r}));return this.pagePromises[t]=r,r}getPageIndex(e){return this.messageHandler.sendWithPromise("GetPageIndex",{ref:e}).catch((function(e){return Promise.reject(new Error(e))}))}getAnnotations(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:t})}saveDocument(e){return this.messageHandler.sendWithPromise("SaveDocument",{numPages:this._numPages,annotationStorage:e&&e.getAll()||null,filename:this._fullReader?this._fullReader.filename:null}).finally((()=>{e&&e.resetModified()}))}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return"string"!==typeof e?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getJavaScript(){return this.messageHandler.sendWithPromise("GetJavaScript",null)}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then((e=>new _optional_content_config.OptionalContentConfig(e)))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){return this.messageHandler.sendWithPromise("GetMetadata",null).then((e=>({info:e[0],metadata:e[1]?new _metadata.Metadata(e[1]):null,contentDispositionFilename:this._fullReader?this._fullReader.filename:null})))}getStats(){return this.messageHandler.sendWithPromise("GetStats",null)}getXFA(){return this.messageHandler.sendWithPromise("GetXFA",null)}startCleanup(){return this.messageHandler.sendWithPromise("Cleanup",null).then((()=>{for(let e=0,t=this.pageCache.length;e<t;e++){const t=this.pageCache[e];if(t&&!t.cleanup())throw new Error(`startCleanup: Page ${e+1} is currently rendering.`)}this.commonObjs.clear(),this.fontLoader.clear()}))}get loadingParams(){const e=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:e.disableAutoFetch,disableFontFace:e.disableFontFace})}}class PDFObjects{constructor(){this._objs=Object.create(null)}_ensureObj(e){return this._objs[e]?this._objs[e]:this._objs[e]={capability:(0,_util.createPromiseCapability)(),data:null,resolved:!1}}get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(t)return this._ensureObj(e).capability.promise.then(t),null;const r=this._objs[e];if(!r||!r.resolved)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return r.data}has(e){const t=this._objs[e];return!!t&&t.resolved}resolve(e,t){const r=this._ensureObj(e);r.resolved=!0,r.data=t,r.capability.resolve(t)}clear(){this._objs=Object.create(null)}}class RenderTask{constructor(e){this._internalRenderTask=e,this.onContinue=null}get promise(){return this._internalRenderTask.capability.promise}cancel(){this._internalRenderTask.cancel()}}const InternalRenderTask=function(){const e=new WeakSet;return class{constructor(e){let{callback:t,params:r,objs:n,commonObjs:i,operatorList:o,pageIndex:a,canvasFactory:s,webGLContext:l,useRequestAnimationFrame:c=!1,pdfBug:u=!1}=e;this.callback=t,this.params=r,this.objs=n,this.commonObjs=i,this.operatorListIdx=null,this.operatorList=o,this._pageIndex=a,this.canvasFactory=s,this.webGLContext=l,this._pdfBug=u,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=!0===c&&"undefined"!==typeof window,this.cancelled=!1,this.capability=(0,_util.createPromiseCapability)(),this.task=new RenderTask(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=r.canvasContext.canvas}get completed(){return this.capability.promise.catch((function(){}))}initializeGraphics(t){let{transparency:r=!1,optionalContentConfig:n}=t;if(this.cancelled)return;if(this._canvas){if(e.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");e.add(this._canvas)}this._pdfBug&&globalThis.StepperManager&&globalThis.StepperManager.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:i,viewport:o,transform:a,imageLayer:s,background:l}=this.params;this.gfx=new _canvas.CanvasGraphics(i,this.commonObjs,this.objs,this.canvasFactory,this.webGLContext,s,n),this.gfx.beginDrawing({transform:a,viewport:o,transparency:r,background:l}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback&&this.graphicsReadyCallback()}cancel(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.running=!1,this.cancelled=!0,this.gfx&&this.gfx.endDrawing(),this._canvas&&e.delete(this._canvas),this.callback(t||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,"canvas"))}operatorListChanged(){this.graphicsReady?(this.stepper&&this.stepper.updateOperatorList(this.operatorList),this.running||this._continue()):this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound)}_continue(){this.running=!0,this.cancelled||(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame((()=>{this._nextBound().catch(this.cancel.bind(this))})):Promise.resolve().then(this._nextBound).catch(this.cancel.bind(this))}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),this._canvas&&e.delete(this._canvas),this.callback())))}}}(),version="2.7.39";exports.version=version;const build="dcead9a25";exports.build=build},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FontLoader=t.FontFaceObject=void 0;var n=r(2);class i{constructor(e){let{docId:t,onUnsupportedFeature:r,ownerDocument:o=globalThis.document}=e;this.constructor===i&&(0,n.unreachable)("Cannot initialize BaseFontLoader."),this.docId=t,this._onUnsupportedFeature=r,this._document=o,this.nativeFontFaces=[],this.styleElement=null}addNativeFontFace(e){this.nativeFontFaces.push(e),this._document.fonts.add(e)}insertRule(e){let t=this.styleElement;t||(t=this.styleElement=this._document.createElement("style"),t.id=`PDFJS_FONT_STYLE_TAG_${this.docId}`,this._document.documentElement.getElementsByTagName("head")[0].appendChild(t));const r=t.sheet;r.insertRule(e,r.cssRules.length)}clear(){this.nativeFontFaces.forEach((e=>{this._document.fonts.delete(e)})),this.nativeFontFaces.length=0,this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async bind(e){if(e.attached||e.missingFile)return;if(e.attached=!0,this.isFontLoadingAPISupported){const t=e.createNativeFontFace();if(t){this.addNativeFontFace(t);try{await t.loaded}catch(r){throw this._onUnsupportedFeature({featureId:n.UNSUPPORTED_FEATURES.errorFontLoadNative}),(0,n.warn)(`Failed to load font '${t.family}': '${r}'.`),e.disableFontFace=!0,r}}return}const t=e.createFontFaceRule();if(t){if(this.insertRule(t),this.isSyncFontLoadingSupported)return;await new Promise((r=>{const n=this._queueLoadingCallback(r);this._prepareFontLoadEvent([t],[e],n)}))}}_queueLoadingCallback(e){(0,n.unreachable)("Abstract method `_queueLoadingCallback`.")}get isFontLoadingAPISupported(){const e="undefined"!==typeof this._document&&!!this._document.fonts;return(0,n.shadow)(this,"isFontLoadingAPISupported",e)}get isSyncFontLoadingSupported(){(0,n.unreachable)("Abstract method `isSyncFontLoadingSupported`.")}get _loadTestFont(){(0,n.unreachable)("Abstract method `_loadTestFont`.")}_prepareFontLoadEvent(e,t,r){(0,n.unreachable)("Abstract method `_prepareFontLoadEvent`.")}}let o;t.FontLoader=o,t.FontLoader=o=class extends i{constructor(e){super(e),this.loadingContext={requests:[],nextRequestId:0},this.loadTestFontId=0}get isSyncFontLoadingSupported(){let e=!1;if("undefined"===typeof navigator)e=!0;else{const t=/Mozilla\/5.0.*?rv:(\d+).*? Gecko/.exec(navigator.userAgent);t&&t[1]>=14&&(e=!0)}return(0,n.shadow)(this,"isSyncFontLoadingSupported",e)}_queueLoadingCallback(e){const t=this.loadingContext,r={id:"pdfjs-font-loading-"+t.nextRequestId++,done:!1,complete:function(){for((0,n.assert)(!r.done,"completeRequest() cannot be called twice."),r.done=!0;t.requests.length>0&&t.requests[0].done;){const e=t.requests.shift();setTimeout(e.callback,0)}},callback:e};return t.requests.push(r),r}get _loadTestFont(){return(0,n.shadow)(this,"_loadTestFont",atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA=="))}_prepareFontLoadEvent(e,t,r){function i(e,t){return e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|255&e.charCodeAt(t+3)}function o(e,t,r,n){return e.substring(0,t)+n+e.substring(t+r)}let a,s;const l=this._document.createElement("canvas");l.width=1,l.height=1;const c=l.getContext("2d");let u=0;const h=`lt${Date.now()}${this.loadTestFontId++}`;let d=this._loadTestFont;d=o(d,976,h.length,h);const f=1482184792;let g=i(d,16);for(a=0,s=h.length-3;a<s;a+=4)g=g-f+i(h,a)|0;a<h.length&&(g=g-f+i(h+"XXX",a)|0),d=o(d,16,4,(0,n.string32)(g));const p=`@font-face {font-family:"${h}";src:url(data:font/opentype;base64,${btoa(d)});}`;this.insertRule(p);const m=[];for(a=0,s=t.length;a<s;a++)m.push(t[a].loadedName);m.push(h);const v=this._document.createElement("div");for(v.style.visibility="hidden",v.style.width=v.style.height="10px",v.style.position="absolute",v.style.top=v.style.left="0px",a=0,s=m.length;a<s;++a){const e=this._document.createElement("span");e.textContent="Hi",e.style.fontFamily=m[a],v.appendChild(e)}this._document.body.appendChild(v),function e(t,r){if(u++,u>30)return(0,n.warn)("Load test font never loaded."),void r();c.font="30px "+t,c.fillText(".",0,20),c.getImageData(0,0,1,1).data[3]>0?r():setTimeout(e.bind(null,t,r))}(h,(()=>{this._document.body.removeChild(v),r.complete()}))}},t.FontFaceObject=class{constructor(e,t){let{isEvalSupported:r=!0,disableFontFace:n=!1,ignoreErrors:i=!1,onUnsupportedFeature:o=null,fontRegistry:a=null}=t;this.compiledGlyphs=Object.create(null);for(const s in e)this[s]=e[s];this.isEvalSupported=!1!==r,this.disableFontFace=!0===n,this.ignoreErrors=!0===i,this._onUnsupportedFeature=o,this.fontRegistry=a}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;const e=new FontFace(this.loadedName,this.data,{});return this.fontRegistry&&this.fontRegistry.registerFont(this),e}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const e=(0,n.bytesToString)(new Uint8Array(this.data)),t=`url(data:${this.mimetype};base64,${btoa(e)});`,r=`@font-face {font-family:"${this.loadedName}";src:${t}}`;return this.fontRegistry&&this.fontRegistry.registerFont(this,t),r}getPathGenerator(e,t){if(void 0!==this.compiledGlyphs[t])return this.compiledGlyphs[t];let r,i;try{r=e.get(this.loadedName+"_path_"+t)}catch(o){if(!this.ignoreErrors)throw o;return this._onUnsupportedFeature&&this._onUnsupportedFeature({featureId:n.UNSUPPORTED_FEATURES.errorFontGetPath}),(0,n.warn)(`getPathGenerator - ignoring character: "${o}".`),this.compiledGlyphs[t]=function(e,t){}}if(this.isEvalSupported&&n.IsEvalSupportedCached.value){let e,n="";for(let t=0,o=r.length;t<o;t++)i=r[t],e=void 0!==i.args?i.args.join(","):"",n+="c."+i.cmd+"("+e+");\n";return this.compiledGlyphs[t]=new Function("c","size",n)}return this.compiledGlyphs[t]=function(e,t){for(let n=0,o=r.length;n<o;n++)i=r[n],"scale"===i.cmd&&(i.args=[t,-t]),e[i.cmd].apply(e,i.args)}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NodeCMapReaderFactory=t.NodeCanvasFactory=void 0;var n=r(1),i=r(4),o=r(2);let a=class{constructor(){(0,o.unreachable)("Not implemented: NodeCanvasFactory")}};t.NodeCanvasFactory=a;let s=class{constructor(){(0,o.unreachable)("Not implemented: NodeCMapReaderFactory")}};t.NodeCMapReaderFactory=s,i.isNodeJS&&(t.NodeCanvasFactory=a=class extends n.BaseCanvasFactory{create(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");const r=__webpack_require__(6457).createCanvas(e,t);return{canvas:r,context:r.getContext("2d")}}},t.NodeCMapReaderFactory=s=class extends n.BaseCMapReaderFactory{_fetchData(e,t){return new Promise(((r,n)=>{__webpack_require__(5536).readFile(e,((e,i)=>{!e&&i?r({cMapData:new Uint8Array(i),compressionType:t}):n(new Error(e))}))}))}})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AnnotationStorage=void 0,t.AnnotationStorage=class{constructor(){this._storage=new Map,this._modified=!1,this.onSetModified=null,this.onResetModified=null}getOrCreateValue(e,t){return this._storage.has(e)?this._storage.get(e):(this._storage.set(e,t),t)}setValue(e,t){this._storage.get(e)!==t&&this._setModified(),this._storage.set(e,t)}getAll(){return 0===this._storage.size?null:Object.fromEntries(this._storage)}get size(){return this._storage.size}_setModified(){this._modified||(this._modified=!0,"function"===typeof this.onSetModified&&this.onSetModified())}resetModified(){this._modified&&(this._modified=!1,"function"===typeof this.onResetModified&&this.onResetModified())}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.apiCompatibilityParams=void 0;var n=r(4);const i=Object.create(null);n.isNodeJS&&(i.disableFontFace=!0);const o=Object.freeze(i);t.apiCompatibilityParams=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CanvasGraphics=void 0;var n=r(2),i=r(11),o=4096,a=.65,s=16;function l(e){e.mozCurrentTransform||(e._originalSave=e.save,e._originalRestore=e.restore,e._originalRotate=e.rotate,e._originalScale=e.scale,e._originalTranslate=e.translate,e._originalTransform=e.transform,e._originalSetTransform=e.setTransform,e._transformMatrix=e._transformMatrix||[1,0,0,1,0,0],e._transformStack=[],Object.defineProperty(e,"mozCurrentTransform",{get:function(){return this._transformMatrix}}),Object.defineProperty(e,"mozCurrentTransformInverse",{get:function(){var e=this._transformMatrix,t=e[0],r=e[1],n=e[2],i=e[3],o=e[4],a=e[5],s=t*i-r*n,l=r*n-t*i;return[i/s,r/l,n/l,t/s,(i*o-n*a)/l,(r*o-t*a)/s]}}),e.save=function(){var e=this._transformMatrix;this._transformStack.push(e),this._transformMatrix=e.slice(0,6),this._originalSave()},e.restore=function(){var e=this._transformStack.pop();e&&(this._transformMatrix=e,this._originalRestore())},e.translate=function(e,t){var r=this._transformMatrix;r[4]=r[0]*e+r[2]*t+r[4],r[5]=r[1]*e+r[3]*t+r[5],this._originalTranslate(e,t)},e.scale=function(e,t){var r=this._transformMatrix;r[0]=r[0]*e,r[1]=r[1]*e,r[2]=r[2]*t,r[3]=r[3]*t,this._originalScale(e,t)},e.transform=function(t,r,n,i,o,a){var s=this._transformMatrix;this._transformMatrix=[s[0]*t+s[2]*r,s[1]*t+s[3]*r,s[0]*n+s[2]*i,s[1]*n+s[3]*i,s[0]*o+s[2]*a+s[4],s[1]*o+s[3]*a+s[5]],e._originalTransform(t,r,n,i,o,a)},e.setTransform=function(t,r,n,i,o,a){this._transformMatrix=[t,r,n,i,o,a],e._originalSetTransform(t,r,n,i,o,a)},e.rotate=function(e){var t=Math.cos(e),r=Math.sin(e),n=this._transformMatrix;this._transformMatrix=[n[0]*t+n[2]*r,n[1]*t+n[3]*r,n[0]*-r+n[2]*t,n[1]*-r+n[3]*t,n[4],n[5]],this._originalRotate(e)})}var c=function(){function e(e){this.canvasFactory=e,this.cache=Object.create(null)}return e.prototype={getCanvas:function(e,t,r,n){var i;return void 0!==this.cache[e]?(i=this.cache[e],this.canvasFactory.reset(i,t,r),i.context.setTransform(1,0,0,1,0,0)):(i=this.canvasFactory.create(t,r),this.cache[e]=i),n&&l(i.context),i},clear(){for(var e in this.cache){var t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}},e}(),u=function(){function e(){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=n.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=n.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=n.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.resumeSMaskCtx=null,this.transferMaps=null}return e.prototype={clone:function(){return Object.create(this)},setCurrentPoint:function(e,t){this.x=e,this.y=t}},e}(),h=function(){function e(e,t,r,n,i,o,a){this.ctx=e,this.current=new u,this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=r,this.canvasFactory=n,this.webGLContext=i,this.imageLayer=o,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.contentVisible=!0,this.markedContentStack=[],this.optionalContentConfig=a,this.cachedCanvases=new c(this.canvasFactory),e&&l(e),this._cachedGetSinglePixelWidth=null}function t(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if("undefined"!==typeof ImageData&&t instanceof ImageData)return void e.putImageData(t,0,0);var i,o,a,l,c,u=t.height,h=t.width,d=u%s,f=(u-d)/s,g=0===d?f:f+1,p=e.createImageData(h,s),m=0,v=t.data,b=p.data;let y,w,S,C;if(r)switch(r.length){case 1:y=r[0],w=r[0],S=r[0],C=r[0];break;case 4:y=r[0],w=r[1],S=r[2],C=r[3]}if(t.kind===n.ImageKind.GRAYSCALE_1BPP){var k=v.byteLength,x=new Uint32Array(b.buffer,0,b.byteLength>>2),E=x.length,T=h+7>>3,_=4294967295,A=n.IsLittleEndianCached.value?4278190080:255;for(C&&255===C[0]&&0===C[255]&&([_,A]=[A,_]),o=0;o<g;o++){for(l=o<f?s:d,i=0,a=0;a<l;a++){var R=k-m;let e=0;for(var O=R>T?h:8*R-7,M=-8&O,I=0,P=0;e<M;e+=8)P=v[m++],x[i++]=128&P?_:A,x[i++]=64&P?_:A,x[i++]=32&P?_:A,x[i++]=16&P?_:A,x[i++]=8&P?_:A,x[i++]=4&P?_:A,x[i++]=2&P?_:A,x[i++]=1&P?_:A;for(;e<O;e++)0===I&&(P=v[m++],I=128),x[i++]=P&I?_:A,I>>=1}for(;i<E;)x[i++]=0;e.putImageData(p,0,o*s)}}else if(t.kind===n.ImageKind.RGBA_32BPP){const t=!!(y||w||S);for(a=0,c=h*s*4,o=0;o<f;o++){if(b.set(v.subarray(m,m+c)),m+=c,t)for(let e=0;e<c;e+=4)y&&(b[e+0]=y[b[e+0]]),w&&(b[e+1]=w[b[e+1]]),S&&(b[e+2]=S[b[e+2]]);e.putImageData(p,0,a),a+=s}if(o<g){if(c=h*d*4,b.set(v.subarray(m,m+c)),t)for(let e=0;e<c;e+=4)y&&(b[e+0]=y[b[e+0]]),w&&(b[e+1]=w[b[e+1]]),S&&(b[e+2]=S[b[e+2]]);e.putImageData(p,0,a)}}else{if(t.kind!==n.ImageKind.RGB_24BPP)throw new Error(`bad image kind: ${t.kind}`);{const t=!!(y||w||S);for(c=h*(l=s),o=0;o<g;o++){for(o>=f&&(c=h*(l=d)),i=0,a=c;a--;)b[i++]=v[m++],b[i++]=v[m++],b[i++]=v[m++],b[i++]=255;if(t)for(let e=0;e<i;e+=4)y&&(b[e+0]=y[b[e+0]]),w&&(b[e+1]=w[b[e+1]]),S&&(b[e+2]=S[b[e+2]]);e.putImageData(p,0,o*s)}}}}function r(e,t){for(var r=t.height,n=t.width,i=r%s,o=(r-i)/s,a=0===i?o:o+1,l=e.createImageData(n,s),c=0,u=t.data,h=l.data,d=0;d<a;d++){for(var f=d<o?s:i,g=3,p=0;p<f;p++)for(var m=0,v=0;v<n;v++){if(!m){var b=u[c++];m=128}h[g]=b&m?0:255,g+=4,m>>=1}e.putImageData(l,0,d*s)}}function h(e,t){for(var r=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font"],n=0,i=r.length;n<i;n++){var o=r[n];void 0!==e[o]&&(t[o]=e[o])}void 0!==e.setLineDash&&(t.setLineDash(e.getLineDash()),t.lineDashOffset=e.lineDashOffset)}function d(e){e.strokeStyle="#000000",e.fillStyle="#000000",e.fillRule="nonzero",e.globalAlpha=1,e.lineWidth=1,e.lineCap="butt",e.lineJoin="miter",e.miterLimit=10,e.globalCompositeOperation="source-over",e.font="10px sans-serif",void 0!==e.setLineDash&&(e.setLineDash([]),e.lineDashOffset=0)}function f(e,t,r,n){for(var i=e.length,o=3;o<i;o+=4){var a=e[o];if(0===a)e[o-3]=t,e[o-2]=r,e[o-1]=n;else if(a<255){var s=255-a;e[o-3]=e[o-3]*a+t*s>>8,e[o-2]=e[o-2]*a+r*s>>8,e[o-1]=e[o-1]*a+n*s>>8}}}function g(e,t,r){for(var n=e.length,i=1/255,o=3;o<n;o+=4){var a=r?r[e[o]]:e[o];t[o]=t[o]*a*i|0}}function p(e,t,r){for(var n=e.length,i=3;i<n;i+=4){var o=77*e[i-3]+152*e[i-2]+28*e[i-1];t[i]=r?t[i]*r[o>>8]>>8:t[i]*o>>16}}function m(e,t,r,n){var i=t.canvas,o=t.context;e.setTransform(t.scaleX,0,0,t.scaleY,t.offsetX,t.offsetY);var a=t.backdrop||null;if(!t.transferMap&&n.isEnabled){const o=n.composeSMask({layer:r.canvas,mask:i,properties:{subtype:t.subtype,backdrop:a}});return e.setTransform(1,0,0,1,0,0),void e.drawImage(o,t.offsetX,t.offsetY)}!function(e,t,r,n,i,o,a){var s,l=!!o,c=l?o[0]:0,u=l?o[1]:0,h=l?o[2]:0;s="Luminosity"===i?p:g;for(var d=Math.min(n,Math.ceil(1048576/r)),m=0;m<n;m+=d){var v=Math.min(d,n-m),b=e.getImageData(0,m,r,v),y=t.getImageData(0,m,r,v);l&&f(b.data,c,u,h),s(b.data,y.data,a),e.putImageData(y,0,m)}}(o,r,i.width,i.height,t.subtype,a,t.transferMap),e.drawImage(i,0,0)}var v=["butt","round","square"],b=["miter","round","bevel"],y={},w={};for(var S in e.prototype={beginDrawing(e){let{transform:t,viewport:r,transparency:n=!1,background:i=null}=e;var o=this.ctx.canvas.width,a=this.ctx.canvas.height;if(this.ctx.save(),this.ctx.fillStyle=i||"rgb(255, 255, 255)",this.ctx.fillRect(0,0,o,a),this.ctx.restore(),n){var s=this.cachedCanvases.getCanvas("transparent",o,a,!0);this.compositeCtx=this.ctx,this.transparentCanvas=s.canvas,this.ctx=s.context,this.ctx.save(),this.ctx.transform.apply(this.ctx,this.compositeCtx.mozCurrentTransform)}this.ctx.save(),d(this.ctx),t&&this.ctx.transform.apply(this.ctx,t),this.ctx.transform.apply(this.ctx,r.transform),this.baseTransform=this.ctx.mozCurrentTransform.slice(),this.imageLayer&&this.imageLayer.beginLayout()},executeOperatorList:function(e,t,r,i){var o=e.argsArray,a=e.fnArray,s=t||0,l=o.length;if(l===s)return s;for(var c,u=l-s>10&&"function"===typeof r,h=u?Date.now()+15:0,d=0,f=this.commonObjs,g=this.objs;;){if(void 0!==i&&s===i.nextBreakPoint)return i.breakIt(s,r),s;if((c=a[s])!==n.OPS.dependency)this[c].apply(this,o[s]);else for(const e of o[s]){const t=e.startsWith("g_")?f:g;if(!t.has(e))return t.get(e,r),s}if(++s===l)return s;if(u&&++d>10){if(Date.now()>h)return r(),s;d=0}}},endDrawing:function(){null!==this.current.activeSMask&&this.endSMaskGroup(),this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null),this.cachedCanvases.clear(),this.webGLContext.clear(),this.imageLayer&&this.imageLayer.endLayout()},setLineWidth:function(e){this.current.lineWidth=e,this.ctx.lineWidth=e},setLineCap:function(e){this.ctx.lineCap=v[e]},setLineJoin:function(e){this.ctx.lineJoin=b[e]},setMiterLimit:function(e){this.ctx.miterLimit=e},setDash:function(e,t){var r=this.ctx;void 0!==r.setLineDash&&(r.setLineDash(e),r.lineDashOffset=t)},setRenderingIntent(e){},setFlatness(e){},setGState:function(e){for(var t=0,r=e.length;t<r;t++){var n=e[t],i=n[0],o=n[1];switch(i){case"LW":this.setLineWidth(o);break;case"LC":this.setLineCap(o);break;case"LJ":this.setLineJoin(o);break;case"ML":this.setMiterLimit(o);break;case"D":this.setDash(o[0],o[1]);break;case"RI":this.setRenderingIntent(o);break;case"FL":this.setFlatness(o);break;case"Font":this.setFont(o[0],o[1]);break;case"CA":this.current.strokeAlpha=n[1];break;case"ca":this.current.fillAlpha=n[1],this.ctx.globalAlpha=n[1];break;case"BM":this.ctx.globalCompositeOperation=o;break;case"SMask":this.current.activeSMask&&(this.stateStack.length>0&&this.stateStack[this.stateStack.length-1].activeSMask===this.current.activeSMask?this.suspendSMaskGroup():this.endSMaskGroup()),this.current.activeSMask=o?this.tempSMask:null,this.current.activeSMask&&this.beginSMaskGroup(),this.tempSMask=null;break;case"TR":this.current.transferMaps=o}}},beginSMaskGroup:function(){var e=this.current.activeSMask,t=e.canvas.width,r=e.canvas.height,n="smaskGroupAt"+this.groupLevel,i=this.cachedCanvases.getCanvas(n,t,r,!0),o=this.ctx,a=o.mozCurrentTransform;this.ctx.save();var s=i.context;s.scale(1/e.scaleX,1/e.scaleY),s.translate(-e.offsetX,-e.offsetY),s.transform.apply(s,a),e.startTransformInverse=s.mozCurrentTransformInverse,h(o,s),this.ctx=s,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(o),this.groupLevel++},suspendSMaskGroup:function(){var e=this.ctx;this.groupLevel--,this.ctx=this.groupStack.pop(),m(this.ctx,this.current.activeSMask,e,this.webGLContext),this.ctx.restore(),this.ctx.save(),h(e,this.ctx),this.current.resumeSMaskCtx=e;var t=n.Util.transform(this.current.activeSMask.startTransformInverse,e.mozCurrentTransform);this.ctx.transform.apply(this.ctx,t),e.save(),e.setTransform(1,0,0,1,0,0),e.clearRect(0,0,e.canvas.width,e.canvas.height),e.restore()},resumeSMaskGroup:function(){var e=this.current.resumeSMaskCtx,t=this.ctx;this.ctx=e,this.groupStack.push(t),this.groupLevel++},endSMaskGroup:function(){var e=this.ctx;this.groupLevel--,this.ctx=this.groupStack.pop(),m(this.ctx,this.current.activeSMask,e,this.webGLContext),this.ctx.restore(),h(e,this.ctx);var t=n.Util.transform(this.current.activeSMask.startTransformInverse,e.mozCurrentTransform);this.ctx.transform.apply(this.ctx,t)},save:function(){this.ctx.save();var e=this.current;this.stateStack.push(e),this.current=e.clone(),this.current.resumeSMaskCtx=null},restore:function(){this.current.resumeSMaskCtx&&this.resumeSMaskGroup(),null===this.current.activeSMask||0!==this.stateStack.length&&this.stateStack[this.stateStack.length-1].activeSMask===this.current.activeSMask||this.endSMaskGroup(),0!==this.stateStack.length&&(this.current=this.stateStack.pop(),this.ctx.restore(),this.pendingClip=null,this._cachedGetSinglePixelWidth=null)},transform:function(e,t,r,n,i,o){this.ctx.transform(e,t,r,n,i,o),this._cachedGetSinglePixelWidth=null},constructPath:function(e,t){for(var r=this.ctx,i=this.current,o=i.x,a=i.y,s=0,l=0,c=e.length;s<c;s++)switch(0|e[s]){case n.OPS.rectangle:o=t[l++],a=t[l++];var u=t[l++],h=t[l++];0===u&&r.lineWidth<this.getSinglePixelWidth()&&(u=this.getSinglePixelWidth()),0===h&&r.lineWidth<this.getSinglePixelWidth()&&(h=this.getSinglePixelWidth());var d=o+u,f=a+h;r.moveTo(o,a),r.lineTo(d,a),r.lineTo(d,f),r.lineTo(o,f),r.lineTo(o,a),r.closePath();break;case n.OPS.moveTo:o=t[l++],a=t[l++],r.moveTo(o,a);break;case n.OPS.lineTo:o=t[l++],a=t[l++],r.lineTo(o,a);break;case n.OPS.curveTo:o=t[l+4],a=t[l+5],r.bezierCurveTo(t[l],t[l+1],t[l+2],t[l+3],o,a),l+=6;break;case n.OPS.curveTo2:r.bezierCurveTo(o,a,t[l],t[l+1],t[l+2],t[l+3]),o=t[l+2],a=t[l+3],l+=4;break;case n.OPS.curveTo3:o=t[l+2],a=t[l+3],r.bezierCurveTo(t[l],t[l+1],o,a,o,a),l+=4;break;case n.OPS.closePath:r.closePath()}i.setCurrentPoint(o,a)},closePath:function(){this.ctx.closePath()},stroke:function(e){e="undefined"===typeof e||e;var t=this.ctx,r=this.current.strokeColor;if(t.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(r&&r.hasOwnProperty("type")&&"Pattern"===r.type){t.save();const e=t.mozCurrentTransform,i=n.Util.singularValueDecompose2dScale(e)[0];t.strokeStyle=r.getPattern(t,this),t.lineWidth=Math.max(this.getSinglePixelWidth()*a,this.current.lineWidth*i),t.stroke(),t.restore()}else t.lineWidth=Math.max(this.getSinglePixelWidth()*a,this.current.lineWidth),t.stroke();e&&this.consumePath(),t.globalAlpha=this.current.fillAlpha},closeStroke:function(){this.closePath(),this.stroke()},fill:function(e){e="undefined"===typeof e||e;var t=this.ctx,r=this.current.fillColor,n=!1;this.current.patternFill&&(t.save(),this.baseTransform&&t.setTransform.apply(t,this.baseTransform),t.fillStyle=r.getPattern(t,this),n=!0),this.contentVisible&&(this.pendingEOFill?(t.fill("evenodd"),this.pendingEOFill=!1):t.fill()),n&&t.restore(),e&&this.consumePath()},eoFill:function(){this.pendingEOFill=!0,this.fill()},fillStroke:function(){this.fill(!1),this.stroke(!1),this.consumePath()},eoFillStroke:function(){this.pendingEOFill=!0,this.fillStroke()},closeFillStroke:function(){this.closePath(),this.fillStroke()},closeEOFillStroke:function(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()},endPath:function(){this.consumePath()},clip:function(){this.pendingClip=y},eoClip:function(){this.pendingClip=w},beginText:function(){this.current.textMatrix=n.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0},endText:function(){var e=this.pendingTextPaths,t=this.ctx;if(void 0!==e){t.save(),t.beginPath();for(var r=0;r<e.length;r++){var n=e[r];t.setTransform.apply(t,n.transform),t.translate(n.x,n.y),n.addToPath(t,n.fontSize)}t.restore(),t.clip(),t.beginPath(),delete this.pendingTextPaths}else t.beginPath()},setCharSpacing:function(e){this.current.charSpacing=e},setWordSpacing:function(e){this.current.wordSpacing=e},setHScale:function(e){this.current.textHScale=e/100},setLeading:function(e){this.current.leading=-e},setFont:function(e,t){var r=this.commonObjs.get(e),i=this.current;if(!r)throw new Error(`Can't find font for ${e}`);if(i.fontMatrix=r.fontMatrix?r.fontMatrix:n.FONT_IDENTITY_MATRIX,0!==i.fontMatrix[0]&&0!==i.fontMatrix[3]||(0,n.warn)("Invalid font matrix for font "+e),t<0?(t=-t,i.fontDirection=-1):i.fontDirection=1,this.current.font=r,this.current.fontSize=t,r.isType3Font)return;var o=r.loadedName||"sans-serif";let a="normal";r.black?a="900":r.bold&&(a="bold");var s=r.italic?"italic":"normal",l=`"${o}", ${r.fallbackName}`;let c=t;t<16?c=16:t>100&&(c=100),this.current.fontSizeScale=t/c,this.ctx.font=`${s} ${a} ${c}px ${l}`},setTextRenderingMode:function(e){this.current.textRenderingMode=e},setTextRise:function(e){this.current.textRise=e},moveText:function(e,t){this.current.x=this.current.lineX+=e,this.current.y=this.current.lineY+=t},setLeadingMoveText:function(e,t){this.setLeading(-t),this.moveText(e,t)},setTextMatrix:function(e,t,r,n,i,o){this.current.textMatrix=[e,t,r,n,i,o],this.current.textMatrixScale=Math.sqrt(e*e+t*t),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0},nextLine:function(){this.moveText(0,this.current.leading)},paintChar(e,t,r,i){var o=this.ctx,a=this.current,s=a.font,l=a.textRenderingMode,c=a.fontSize/a.fontSizeScale,u=l&n.TextRenderingMode.FILL_STROKE_MASK,h=!!(l&n.TextRenderingMode.ADD_TO_PATH_FLAG);const d=a.patternFill&&!s.missingFile;var f;(s.disableFontFace||h||d)&&(f=s.getPathGenerator(this.commonObjs,e)),s.disableFontFace||d?(o.save(),o.translate(t,r),o.beginPath(),f(o,c),i&&o.setTransform.apply(o,i),u!==n.TextRenderingMode.FILL&&u!==n.TextRenderingMode.FILL_STROKE||o.fill(),u!==n.TextRenderingMode.STROKE&&u!==n.TextRenderingMode.FILL_STROKE||o.stroke(),o.restore()):(u!==n.TextRenderingMode.FILL&&u!==n.TextRenderingMode.FILL_STROKE||o.fillText(e,t,r),u!==n.TextRenderingMode.STROKE&&u!==n.TextRenderingMode.FILL_STROKE||o.strokeText(e,t,r)),h&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:o.mozCurrentTransform,x:t,y:r,fontSize:c,addToPath:f})},get isFontSubpixelAAEnabled(){const{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);for(var t=e.getImageData(0,0,10,10).data,r=!1,i=3;i<t.length;i+=4)if(t[i]>0&&t[i]<255){r=!0;break}return(0,n.shadow)(this,"isFontSubpixelAAEnabled",r)},showText:function(e){var t=this.current,r=t.font;if(r.isType3Font)return this.showType3Text(e);var i=t.fontSize;if(0===i)return;var o=this.ctx,s=t.fontSizeScale,l=t.charSpacing,c=t.wordSpacing,u=t.fontDirection,h=t.textHScale*u,d=e.length,f=r.vertical,g=f?1:-1,p=r.defaultVMetrics,m=i*t.fontMatrix[0],v=t.textRenderingMode===n.TextRenderingMode.FILL&&!r.disableFontFace&&!t.patternFill;let b;if(o.save(),t.patternFill){o.save();const e=t.fillColor.getPattern(o,this);b=o.mozCurrentTransform,o.restore(),o.fillStyle=e}o.transform.apply(o,t.textMatrix),o.translate(t.x,t.y+t.textRise),u>0?o.scale(h,-1):o.scale(h,1);var y=t.lineWidth,w=t.textMatrixScale;if(0===w||0===y){var S=t.textRenderingMode&n.TextRenderingMode.FILL_STROKE_MASK;S!==n.TextRenderingMode.STROKE&&S!==n.TextRenderingMode.FILL_STROKE||(this._cachedGetSinglePixelWidth=null,y=this.getSinglePixelWidth()*a)}else y/=w;1!==s&&(o.scale(s,s),y/=s),o.lineWidth=y;var C,k=0;for(C=0;C<d;++C){var x=e[C];if((0,n.isNum)(x))k+=g*x*i/1e3;else{var E,T,_,A,R,O,M,I=!1,P=(x.isSpace?c:0)+l,N=x.fontChar,D=x.accent,F=x.width;if(f?(R=x.vmetric||p,O=-(O=x.vmetric?R[1]:.5*F)*m,M=R[2]*m,F=R?-R[0]:F,E=O/s,T=(k+M)/s):(E=k/s,T=0),r.remeasure&&F>0){var L=1e3*o.measureText(N).width/i*s;if(F<L&&this.isFontSubpixelAAEnabled){var H=F/L;I=!0,o.save(),o.scale(H,1),E/=H}else F!==L&&(E+=(F-L)/2e3*i/s)}this.contentVisible&&(x.isInFont||r.missingFile)&&(v&&!D?o.fillText(N,E,T):(this.paintChar(N,E,T,b),D&&(_=E+i*D.offset.x/s,A=T-i*D.offset.y/s,this.paintChar(D.fontChar,_,A,b)))),k+=f?F*m-P*u:F*m+P*u,I&&o.restore()}}f?t.y-=k:t.x+=k*h,o.restore()},showType3Text:function(e){var t,r,i,o,a=this.ctx,s=this.current,l=s.font,c=s.fontSize,u=s.fontDirection,h=l.vertical?1:-1,d=s.charSpacing,f=s.wordSpacing,g=s.textHScale*u,p=s.fontMatrix||n.FONT_IDENTITY_MATRIX,m=e.length;if(s.textRenderingMode!==n.TextRenderingMode.INVISIBLE&&0!==c){for(this._cachedGetSinglePixelWidth=null,a.save(),a.transform.apply(a,s.textMatrix),a.translate(s.x,s.y),a.scale(g,u),t=0;t<m;++t)if(r=e[t],(0,n.isNum)(r))o=h*r*c/1e3,this.ctx.translate(o,0),s.x+=o*g;else{var v=(r.isSpace?f:0)+d,b=l.charProcOperatorList[r.operatorListId];b?(this.contentVisible&&(this.processingType3=r,this.save(),a.scale(c,c),a.transform.apply(a,p),this.executeOperatorList(b),this.restore()),i=n.Util.applyTransform([r.width,0],p)[0]*c+v,a.translate(i,0),s.x+=i*g):(0,n.warn)(`Type3 character "${r.operatorListId}" is not available.`)}a.restore(),this.processingType3=null}},setCharWidth:function(e,t){},setCharWidthAndBounds:function(e,t,r,n,i,o){this.ctx.rect(r,n,i-r,o-n),this.clip(),this.endPath()},getColorN_Pattern:function(t){var r;if("TilingPattern"===t[0]){var n=t[1],o=this.baseTransform||this.ctx.mozCurrentTransform.slice(),a={createCanvasGraphics:t=>new e(t,this.commonObjs,this.objs,this.canvasFactory,this.webGLContext)};r=new i.TilingPattern(t,n,this.ctx,a,o)}else r=(0,i.getShadingPatternFromIR)(t);return r},setStrokeColorN:function(){this.current.strokeColor=this.getColorN_Pattern(arguments)},setFillColorN:function(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0},setStrokeRGBColor:function(e,t,r){var i=n.Util.makeCssRgb(e,t,r);this.ctx.strokeStyle=i,this.current.strokeColor=i},setFillRGBColor:function(e,t,r){var i=n.Util.makeCssRgb(e,t,r);this.ctx.fillStyle=i,this.current.fillColor=i,this.current.patternFill=!1},shadingFill:function(e){if(this.contentVisible){var t=this.ctx;this.save();var r=(0,i.getShadingPatternFromIR)(e);t.fillStyle=r.getPattern(t,this,!0);var o=t.mozCurrentTransformInverse;if(o){var a=t.canvas,s=a.width,l=a.height,c=n.Util.applyTransform([0,0],o),u=n.Util.applyTransform([0,l],o),h=n.Util.applyTransform([s,0],o),d=n.Util.applyTransform([s,l],o),f=Math.min(c[0],u[0],h[0],d[0]),g=Math.min(c[1],u[1],h[1],d[1]),p=Math.max(c[0],u[0],h[0],d[0]),m=Math.max(c[1],u[1],h[1],d[1]);this.ctx.fillRect(f,g,p-f,m-g)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.restore()}},beginInlineImage:function(){(0,n.unreachable)("Should not call beginInlineImage")},beginImageData:function(){(0,n.unreachable)("Should not call beginImageData")},paintFormXObjectBegin:function(e,t){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(e)&&6===e.length&&this.transform.apply(this,e),this.baseTransform=this.ctx.mozCurrentTransform,t)){var r=t[2]-t[0],n=t[3]-t[1];this.ctx.rect(t[0],t[1],r,n),this.clip(),this.endPath()}},paintFormXObjectEnd:function(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())},beginGroup:function(e){if(this.contentVisible){this.save();var t=this.ctx;e.isolated||(0,n.info)("TODO: Support non-isolated groups."),e.knockout&&(0,n.warn)("Knockout groups not supported.");var r=t.mozCurrentTransform;if(e.matrix&&t.transform.apply(t,e.matrix),!e.bbox)throw new Error("Bounding box is required.");var i=n.Util.getAxialAlignedBoundingBox(e.bbox,t.mozCurrentTransform),a=[0,0,t.canvas.width,t.canvas.height];i=n.Util.intersect(i,a)||[0,0,0,0];var s=Math.floor(i[0]),l=Math.floor(i[1]),c=Math.max(Math.ceil(i[2])-s,1),u=Math.max(Math.ceil(i[3])-l,1),d=1,f=1;c>o&&(d=c/o,c=o),u>o&&(f=u/o,u=o);var g="groupAt"+this.groupLevel;e.smask&&(g+="_smask_"+this.smaskCounter++%2);var p=this.cachedCanvases.getCanvas(g,c,u,!0),m=p.context;m.scale(1/d,1/f),m.translate(-s,-l),m.transform.apply(m,r),e.smask?this.smaskStack.push({canvas:p.canvas,context:m,offsetX:s,offsetY:l,scaleX:d,scaleY:f,subtype:e.smask.subtype,backdrop:e.smask.backdrop,transferMap:e.smask.transferMap||null,startTransformInverse:null}):(t.setTransform(1,0,0,1,0,0),t.translate(s,l),t.scale(d,f)),h(t,m),this.ctx=m,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(t),this.groupLevel++,this.current.activeSMask=null}},endGroup:function(e){if(this.contentVisible){this.groupLevel--;var t=this.ctx;this.ctx=this.groupStack.pop(),void 0!==this.ctx.imageSmoothingEnabled?this.ctx.imageSmoothingEnabled=!1:this.ctx.mozImageSmoothingEnabled=!1,e.smask?this.tempSMask=this.smaskStack.pop():this.ctx.drawImage(t.canvas,0,0),this.restore()}},beginAnnotations:function(){this.save(),this.baseTransform&&this.ctx.setTransform.apply(this.ctx,this.baseTransform)},endAnnotations:function(){this.restore()},beginAnnotation:function(e,t,r){if(this.save(),d(this.ctx),this.current=new u,Array.isArray(e)&&4===e.length){var n=e[2]-e[0],i=e[3]-e[1];this.ctx.rect(e[0],e[1],n,i),this.clip(),this.endPath()}this.transform.apply(this,t),this.transform.apply(this,r)},endAnnotation:function(){this.restore()},paintImageMaskXObject:function(e){if(this.contentVisible){var t=this.ctx,n=e.width,i=e.height,o=this.current.fillColor,a=this.current.patternFill,s=this.processingType3;if(s&&void 0===s.compiled&&(s.compiled=n<=1e3&&i<=1e3?function(e){var t,r,n,i,o=e.width,a=e.height,s=o+1,l=new Uint8Array(s*(a+1)),c=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),u=o+7&-8,h=e.data,d=new Uint8Array(u*a),f=0;for(t=0,i=h.length;t<i;t++)for(var g=128,p=h[t];g>0;)d[f++]=p&g?0:255,g>>=1;var m=0;for(0!==d[f=0]&&(l[0]=1,++m),r=1;r<o;r++)d[f]!==d[f+1]&&(l[r]=d[f]?2:1,++m),f++;for(0!==d[f]&&(l[r]=2,++m),t=1;t<a;t++){n=t*s,d[(f=t*u)-u]!==d[f]&&(l[n]=d[f]?1:8,++m);var v=(d[f]?4:0)+(d[f-u]?8:0);for(r=1;r<o;r++)c[v=(v>>2)+(d[f+1]?4:0)+(d[f-u+1]?8:0)]&&(l[n+r]=c[v],++m),f++;if(d[f-u]!==d[f]&&(l[n+r]=d[f]?2:4,++m),m>1e3)return null}for(n=t*s,0!==d[f=u*(a-1)]&&(l[n]=8,++m),r=1;r<o;r++)d[f]!==d[f+1]&&(l[n+r]=d[f]?4:8,++m),f++;if(0!==d[f]&&(l[n+r]=4,++m),m>1e3)return null;var b=new Int32Array([0,s,-1,0,-s,0,0,0,1]),y=[];for(t=0;m&&t<=a;t++){for(var w=t*s,S=w+o;w<S&&!l[w];)w++;if(w!==S){var C,k=[w%s,t],x=l[w],E=w;do{var T=b[x];do{w+=T}while(!l[w]);5!==(C=l[w])&&10!==C?(x=C,l[w]=0):(x=C&51*x>>4,l[w]&=x>>2|x<<2),k.push(w%s),k.push(w/s|0),l[w]||--m}while(E!==w);y.push(k),--t}}return function(e){e.save(),e.scale(1/o,-1/a),e.translate(0,-a),e.beginPath();for(let r=0,n=y.length;r<n;r++){var t=y[r];e.moveTo(t[0],t[1]);for(let r=2,n=t.length;r<n;r+=2)e.lineTo(t[r],t[r+1])}e.fill(),e.beginPath(),e.restore()}}({data:e.data,width:n,height:i}):null),s&&s.compiled)s.compiled(t);else{var l=this.cachedCanvases.getCanvas("maskCanvas",n,i),c=l.context;c.save(),r(c,e),c.globalCompositeOperation="source-in",c.fillStyle=a?o.getPattern(c,this):o,c.fillRect(0,0,n,i),c.restore(),this.paintInlineImageXObject(l.canvas)}}},paintImageMaskXObjectRepeat(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=arguments.length>4?arguments[4]:void 0,a=arguments.length>5?arguments[5]:void 0;if(this.contentVisible){var s=e.width,l=e.height,c=this.current.fillColor,u=this.current.patternFill,h=this.cachedCanvases.getCanvas("maskCanvas",s,l),d=h.context;d.save(),r(d,e),d.globalCompositeOperation="source-in",d.fillStyle=u?c.getPattern(d,this):c,d.fillRect(0,0,s,l),d.restore();for(var f=this.ctx,g=0,p=a.length;g<p;g+=2)f.save(),f.transform(t,n,i,o,a[g],a[g+1]),f.scale(1,-1),f.drawImage(h.canvas,0,0,s,l,0,-1,1,1),f.restore()}},paintImageMaskXObjectGroup:function(e){if(this.contentVisible)for(var t=this.ctx,n=this.current.fillColor,i=this.current.patternFill,o=0,a=e.length;o<a;o++){var s=e[o],l=s.width,c=s.height,u=this.cachedCanvases.getCanvas("maskCanvas",l,c),h=u.context;h.save(),r(h,s),h.globalCompositeOperation="source-in",h.fillStyle=i?n.getPattern(h,this):n,h.fillRect(0,0,l,c),h.restore(),t.save(),t.transform.apply(t,s.transform),t.scale(1,-1),t.drawImage(u.canvas,0,0,l,c,0,-1,1,1),t.restore()}},paintImageXObject:function(e){if(!this.contentVisible)return;const t=e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e);t?this.paintInlineImageXObject(t):(0,n.warn)("Dependent image isn't ready yet")},paintImageXObjectRepeat:function(e,t,r,i){if(!this.contentVisible)return;const o=e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e);if(o){for(var a=o.width,s=o.height,l=[],c=0,u=i.length;c<u;c+=2)l.push({transform:[t,0,0,r,i[c],i[c+1]],x:0,y:0,w:a,h:s});this.paintInlineImageXObjectGroup(o,l)}else(0,n.warn)("Dependent image isn't ready yet")},paintInlineImageXObject:function(e){if(this.contentVisible){var r=e.width,n=e.height,i=this.ctx;this.save(),i.scale(1/r,-1/n);var o,a,s=i.mozCurrentTransformInverse,l=s[0],c=s[1],u=Math.max(Math.sqrt(l*l+c*c),1),h=s[2],d=s[3],f=Math.max(Math.sqrt(h*h+d*d),1);if("function"===typeof HTMLElement&&e instanceof HTMLElement||!e.data)o=e;else{var g=(a=this.cachedCanvases.getCanvas("inlineImage",r,n)).context;t(g,e,this.current.transferMaps),o=a.canvas}for(var p=r,m=n,v="prescale1";u>2&&p>1||f>2&&m>1;){var b=p,y=m;u>2&&p>1&&(u/=p/(b=Math.ceil(p/2))),f>2&&m>1&&(f/=m/(y=Math.ceil(m/2))),(g=(a=this.cachedCanvases.getCanvas(v,b,y)).context).clearRect(0,0,b,y),g.drawImage(o,0,0,p,m,0,0,b,y),o=a.canvas,p=b,m=y,v="prescale1"===v?"prescale2":"prescale1"}if(i.drawImage(o,0,0,p,m,0,-n,r,n),this.imageLayer){var w=this.getCanvasPosition(0,-n);this.imageLayer.appendImage({imgData:e,left:w[0],top:w[1],width:r/s[0],height:n/s[3]})}this.restore()}},paintInlineImageXObjectGroup:function(e,r){if(this.contentVisible){var n=this.ctx,i=e.width,o=e.height,a=this.cachedCanvases.getCanvas("inlineImage",i,o);t(a.context,e,this.current.transferMaps);for(var s=0,l=r.length;s<l;s++){var c=r[s];if(n.save(),n.transform.apply(n,c.transform),n.scale(1,-1),n.drawImage(a.canvas,c.x,c.y,c.w,c.h,0,-1,1,1),this.imageLayer){var u=this.getCanvasPosition(c.x,c.y);this.imageLayer.appendImage({imgData:e,left:u[0],top:u[1],width:i,height:o})}n.restore()}}},paintSolidColorImageMask:function(){this.contentVisible&&this.ctx.fillRect(0,0,1,1)},markPoint:function(e){},markPointProps:function(e,t){},beginMarkedContent:function(e){this.markedContentStack.push({visible:!0})},beginMarkedContentProps:function(e,t){"OC"===e?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(t)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()},endMarkedContent:function(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()},beginCompat:function(){},endCompat:function(){},consumePath:function(){var e=this.ctx;this.pendingClip&&(this.pendingClip===w?e.clip("evenodd"):e.clip(),this.pendingClip=null),e.beginPath()},getSinglePixelWidth(e){if(null===this._cachedGetSinglePixelWidth){const e=this.ctx.mozCurrentTransformInverse;this._cachedGetSinglePixelWidth=Math.sqrt(Math.max(e[0]*e[0]+e[1]*e[1],e[2]*e[2]+e[3]*e[3]))}return this._cachedGetSinglePixelWidth},getCanvasPosition:function(e,t){var r=this.ctx.mozCurrentTransform;return[r[0]*e+r[2]*t+r[4],r[1]*e+r[3]*t+r[5]]},isContentVisible:function(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}},n.OPS)e.prototype[n.OPS[S]]=e.prototype[S];return e}();t.CanvasGraphics=h},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getShadingPatternFromIR=function(e){var t=i[e[0]];if(!t)throw new Error(`Unknown IR type: ${e[0]}`);return t.fromIR(e)},t.TilingPattern=void 0;var n=r(2),i={};function o(e,t){if(!t||"undefined"===typeof Path2D)return;const r=t[2]-t[0],n=t[3]-t[1],i=new Path2D;i.rect(t[0],t[1],r,n),e.clip(i)}i.RadialAxial={fromIR:function(e){var t=e[1],r=e[2],n=e[3],i=e[4],a=e[5],s=e[6],l=e[7];return{type:"Pattern",getPattern:function(e){var c;o(e,r),"axial"===t?c=e.createLinearGradient(i[0],i[1],a[0],a[1]):"radial"===t&&(c=e.createRadialGradient(i[0],i[1],s,a[0],a[1],l));for(var u=0,h=n.length;u<h;++u){var d=n[u];c.addColorStop(d[0],d[1])}return c}}}};var a=function(){function e(e,t,r,n,i,o,a,s){var l,c=t.coords,u=t.colors,h=e.data,d=4*e.width;c[r+1]>c[n+1]&&(l=r,r=n,n=l,l=o,o=a,a=l),c[n+1]>c[i+1]&&(l=n,n=i,i=l,l=a,a=s,s=l),c[r+1]>c[n+1]&&(l=r,r=n,n=l,l=o,o=a,a=l);var f=(c[r]+t.offsetX)*t.scaleX,g=(c[r+1]+t.offsetY)*t.scaleY,p=(c[n]+t.offsetX)*t.scaleX,m=(c[n+1]+t.offsetY)*t.scaleY,v=(c[i]+t.offsetX)*t.scaleX,b=(c[i+1]+t.offsetY)*t.scaleY;if(!(g>=b))for(var y,w,S,C,k,x,E,T,_=u[o],A=u[o+1],R=u[o+2],O=u[a],M=u[a+1],I=u[a+2],P=u[s],N=u[s+1],D=u[s+2],F=Math.round(g),L=Math.round(b),H=F;H<=L;H++){if(H<m){let e;e=H<g?0:g===m?1:(g-H)/(g-m),y=f-(f-p)*e,w=_-(_-O)*e,S=A-(A-M)*e,C=R-(R-I)*e}else{let e;e=H>b?1:m===b?0:(m-H)/(m-b),y=p-(p-v)*e,w=O-(O-P)*e,S=M-(M-N)*e,C=I-(I-D)*e}let e;e=H<g?0:H>b?1:(g-H)/(g-b),k=f-(f-v)*e,x=_-(_-P)*e,E=A-(A-N)*e,T=R-(R-D)*e;for(var B=Math.round(Math.min(y,k)),U=Math.round(Math.max(y,k)),j=d*H+4*B,W=B;W<=U;W++)e=(y-W)/(y-k),e<0?e=0:e>1&&(e=1),h[j++]=w-(w-x)*e|0,h[j++]=S-(S-E)*e|0,h[j++]=C-(C-T)*e|0,h[j++]=255}}function t(t,r,n){var i,o,a=r.coords,s=r.colors;switch(r.type){case"lattice":var l=r.verticesPerRow,c=Math.floor(a.length/l)-1,u=l-1;for(i=0;i<c;i++)for(var h=i*l,d=0;d<u;d++,h++)e(t,n,a[h],a[h+1],a[h+l],s[h],s[h+1],s[h+l]),e(t,n,a[h+l+1],a[h+1],a[h+l],s[h+l+1],s[h+1],s[h+l]);break;case"triangles":for(i=0,o=a.length;i<o;i+=3)e(t,n,a[i],a[i+1],a[i+2],s[i],s[i+1],s[i+2]);break;default:throw new Error("illegal figure")}}return function(e,r,n,i,o,a,s,l){var c,u,h,d,f=Math.floor(e[0]),g=Math.floor(e[1]),p=Math.ceil(e[2])-f,m=Math.ceil(e[3])-g,v=Math.min(Math.ceil(Math.abs(p*r[0]*1.1)),3e3),b=Math.min(Math.ceil(Math.abs(m*r[1]*1.1)),3e3),y=p/v,w=m/b,S={coords:n,colors:i,offsetX:-f,offsetY:-g,scaleX:1/y,scaleY:1/w},C=v+4,k=b+4;if(l.isEnabled)c=l.drawFigures({width:v,height:b,backgroundColor:a,figures:o,context:S}),(u=s.getCanvas("mesh",C,k,!1)).context.drawImage(c,2,2),c=u.canvas;else{var x=(u=s.getCanvas("mesh",C,k,!1)).context,E=x.createImageData(v,b);if(a){var T=E.data;for(h=0,d=T.length;h<d;h+=4)T[h]=a[0],T[h+1]=a[1],T[h+2]=a[2],T[h+3]=255}for(h=0;h<o.length;h++)t(E,o[h],S);x.putImageData(E,2,2),c=u.canvas}return{canvas:c,offsetX:f-2*y,offsetY:g-2*w,scaleX:y,scaleY:w}}}();i.Mesh={fromIR:function(e){var t=e[2],r=e[3],i=e[4],s=e[5],l=e[6],c=e[7],u=e[8];return{type:"Pattern",getPattern:function(e,h,d){var f;if(o(e,c),d)f=n.Util.singularValueDecompose2dScale(e.mozCurrentTransform);else if(f=n.Util.singularValueDecompose2dScale(h.baseTransform),l){var g=n.Util.singularValueDecompose2dScale(l);f=[f[0]*g[0],f[1]*g[1]]}var p=a(s,f,t,r,i,d?null:u,h.cachedCanvases,h.webGLContext);return d||(e.setTransform.apply(e,h.baseTransform),l&&e.transform.apply(e,l)),e.translate(p.offsetX,p.offsetY),e.scale(p.scaleX,p.scaleY),e.createPattern(p.canvas,"no-repeat")}}}},i.Dummy={fromIR:function(){return{type:"Pattern",getPattern:function(){return"hotpink"}}}};var s=function(){var e=1,t=2;function r(e,t,r,n,i){this.operatorList=e[2],this.matrix=e[3]||[1,0,0,1,0,0],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.color=t,this.canvasGraphicsFactory=n,this.baseTransform=i,this.type="Pattern",this.ctx=r}return r.prototype={createPatternCanvas:function(e){var t=this.operatorList,r=this.bbox,i=this.xstep,o=this.ystep,a=this.paintType,s=this.tilingType,l=this.color,c=this.canvasGraphicsFactory;(0,n.info)("TilingType: "+s);var u=r[0],h=r[1],d=r[2],f=r[3],g=n.Util.singularValueDecompose2dScale(this.matrix),p=n.Util.singularValueDecompose2dScale(this.baseTransform),m=[g[0]*p[0],g[1]*p[1]],v=this.getSizeAndScale(i,this.ctx.canvas.width,m[0]),b=this.getSizeAndScale(o,this.ctx.canvas.height,m[1]),y=e.cachedCanvases.getCanvas("pattern",v.size,b.size,!0),w=y.context,S=c.createCanvasGraphics(w);return S.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext(S,a,l),S.transform(v.scale,0,0,b.scale,0,0),S.transform(1,0,0,1,-u,-h),this.clipBbox(S,r,u,h,d,f),S.executeOperatorList(t),this.ctx.transform(1,0,0,1,u,h),this.ctx.scale(1/v.scale,1/b.scale),y.canvas},getSizeAndScale:function(e,t,r){e=Math.abs(e);var n=Math.max(3e3,t),i=Math.ceil(e*r);return i>=n?i=n:r=i/e,{scale:r,size:i}},clipBbox:function(e,t,r,n,i,o){if(Array.isArray(t)&&4===t.length){var a=i-r,s=o-n;e.ctx.rect(r,n,a,s),e.clip(),e.endPath()}},setFillAndStrokeStyleToContext:function(r,i,o){const a=r.ctx,s=r.current;switch(i){case e:var l=this.ctx;a.fillStyle=l.fillStyle,a.strokeStyle=l.strokeStyle,s.fillColor=l.fillStyle,s.strokeColor=l.strokeStyle;break;case t:var c=n.Util.makeCssRgb(o[0],o[1],o[2]);a.fillStyle=c,a.strokeStyle=c,s.fillColor=c,s.strokeColor=c;break;default:throw new n.FormatError(`Unsupported paint type: ${i}`)}},getPattern:function(e,t){(e=this.ctx).setTransform.apply(e,this.baseTransform),e.transform.apply(e,this.matrix);var r=this.createPatternCanvas(t);return e.createPattern(r,"repeat")}},r}();t.TilingPattern=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GlobalWorkerOptions=void 0;const n=Object.create(null);t.GlobalWorkerOptions=n,n.workerPort=void 0===n.workerPort?null:n.workerPort,n.workerSrc=void 0===n.workerSrc?"":n.workerSrc},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MessageHandler=void 0;var n=r(2);const i=1,o=2,a=1,s=2,l=3,c=4,u=5,h=6,d=7,f=8;function g(e){if("object"!==typeof e||null===e)return e;switch(e.name){case"AbortException":return new n.AbortException(e.message);case"MissingPDFException":return new n.MissingPDFException(e.message);case"UnexpectedResponseException":return new n.UnexpectedResponseException(e.message,e.status);case"UnknownErrorException":return new n.UnknownErrorException(e.message,e.details);default:return new n.UnknownErrorException(e.message,e.toString())}}t.MessageHandler=class{constructor(e,t,r){this.sourceName=e,this.targetName=t,this.comObj=r,this.callbackId=1,this.streamId=1,this.postMessageTransfers=!0,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=e=>{const t=e.data;if(t.targetName!==this.sourceName)return;if(t.stream)return void this._processStreamMessage(t);if(t.callback){const e=t.callbackId,r=this.callbackCapabilities[e];if(!r)throw new Error(`Cannot resolve callback ${e}`);if(delete this.callbackCapabilities[e],t.callback===i)r.resolve(t.data);else{if(t.callback!==o)throw new Error("Unexpected callback case");r.reject(g(t.reason))}return}const n=this.actionHandler[t.action];if(!n)throw new Error(`Unknown action from worker: ${t.action}`);if(t.callbackId){const e=this.sourceName,a=t.sourceName;new Promise((function(e){e(n(t.data))})).then((function(n){r.postMessage({sourceName:e,targetName:a,callback:i,callbackId:t.callbackId,data:n})}),(function(n){r.postMessage({sourceName:e,targetName:a,callback:o,callbackId:t.callbackId,reason:g(n)})}))}else t.streamId?this._createStreamSink(t):n(t.data)},r.addEventListener("message",this._onComObjOnMessage)}on(e,t){const r=this.actionHandler;if(r[e])throw new Error(`There is already an actionName called "${e}"`);r[e]=t}send(e,t,r){this._postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},r)}sendWithPromise(e,t,r){const i=this.callbackId++,o=(0,n.createPromiseCapability)();this.callbackCapabilities[i]=o;try{this._postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:i,data:t},r)}catch(a){o.reject(a)}return o.promise}sendWithStream(e,t,r,i){const o=this.streamId++,s=this.sourceName,l=this.targetName,c=this.comObj;return new ReadableStream({start:r=>{const a=(0,n.createPromiseCapability)();return this.streamControllers[o]={controller:r,startCall:a,pullCall:null,cancelCall:null,isClosed:!1},this._postMessage({sourceName:s,targetName:l,action:e,streamId:o,data:t,desiredSize:r.desiredSize},i),a.promise},pull:e=>{const t=(0,n.createPromiseCapability)();return this.streamControllers[o].pullCall=t,c.postMessage({sourceName:s,targetName:l,stream:h,streamId:o,desiredSize:e.desiredSize}),t.promise},cancel:e=>{(0,n.assert)(e instanceof Error,"cancel must have a valid reason");const t=(0,n.createPromiseCapability)();return this.streamControllers[o].cancelCall=t,this.streamControllers[o].isClosed=!0,c.postMessage({sourceName:s,targetName:l,stream:a,streamId:o,reason:g(e)}),t.promise}},r)}_createStreamSink(e){const t=this,r=this.actionHandler[e.action],i=e.streamId,o=this.sourceName,a=e.sourceName,s=this.comObj,h={enqueue(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,s=arguments.length>2?arguments[2]:void 0;if(this.isCancelled)return;const l=this.desiredSize;this.desiredSize-=r,l>0&&this.desiredSize<=0&&(this.sinkCapability=(0,n.createPromiseCapability)(),this.ready=this.sinkCapability.promise),t._postMessage({sourceName:o,targetName:a,stream:c,streamId:i,chunk:e},s)},close(){this.isCancelled||(this.isCancelled=!0,s.postMessage({sourceName:o,targetName:a,stream:l,streamId:i}),delete t.streamSinks[i])},error(e){(0,n.assert)(e instanceof Error,"error must have a valid reason"),this.isCancelled||(this.isCancelled=!0,s.postMessage({sourceName:o,targetName:a,stream:u,streamId:i,reason:g(e)}))},sinkCapability:(0,n.createPromiseCapability)(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};h.sinkCapability.resolve(),h.ready=h.sinkCapability.promise,this.streamSinks[i]=h,new Promise((function(t){t(r(e.data,h))})).then((function(){s.postMessage({sourceName:o,targetName:a,stream:f,streamId:i,success:!0})}),(function(e){s.postMessage({sourceName:o,targetName:a,stream:f,streamId:i,reason:g(e)})}))}_processStreamMessage(e){const t=e.streamId,r=this.sourceName,i=e.sourceName,o=this.comObj;switch(e.stream){case f:e.success?this.streamControllers[t].startCall.resolve():this.streamControllers[t].startCall.reject(g(e.reason));break;case d:e.success?this.streamControllers[t].pullCall.resolve():this.streamControllers[t].pullCall.reject(g(e.reason));break;case h:if(!this.streamSinks[t]){o.postMessage({sourceName:r,targetName:i,stream:d,streamId:t,success:!0});break}this.streamSinks[t].desiredSize<=0&&e.desiredSize>0&&this.streamSinks[t].sinkCapability.resolve(),this.streamSinks[t].desiredSize=e.desiredSize;const{onPull:p}=this.streamSinks[e.streamId];new Promise((function(e){e(p&&p())})).then((function(){o.postMessage({sourceName:r,targetName:i,stream:d,streamId:t,success:!0})}),(function(e){o.postMessage({sourceName:r,targetName:i,stream:d,streamId:t,reason:g(e)})}));break;case c:if((0,n.assert)(this.streamControllers[t],"enqueue should have stream controller"),this.streamControllers[t].isClosed)break;this.streamControllers[t].controller.enqueue(e.chunk);break;case l:if((0,n.assert)(this.streamControllers[t],"close should have stream controller"),this.streamControllers[t].isClosed)break;this.streamControllers[t].isClosed=!0,this.streamControllers[t].controller.close(),this._deleteStreamController(t);break;case u:(0,n.assert)(this.streamControllers[t],"error should have stream controller"),this.streamControllers[t].controller.error(g(e.reason)),this._deleteStreamController(t);break;case s:e.success?this.streamControllers[t].cancelCall.resolve():this.streamControllers[t].cancelCall.reject(g(e.reason)),this._deleteStreamController(t);break;case a:if(!this.streamSinks[t])break;const{onCancel:m}=this.streamSinks[e.streamId];new Promise((function(t){t(m&&m(g(e.reason)))})).then((function(){o.postMessage({sourceName:r,targetName:i,stream:s,streamId:t,success:!0})}),(function(e){o.postMessage({sourceName:r,targetName:i,stream:s,streamId:t,reason:g(e)})})),this.streamSinks[t].sinkCapability.reject(g(e.reason)),this.streamSinks[t].isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}}async _deleteStreamController(e){await Promise.allSettled([this.streamControllers[e].startCall,this.streamControllers[e].pullCall,this.streamControllers[e].cancelCall].map((function(e){return e&&e.promise}))),delete this.streamControllers[e]}_postMessage(e,t){t&&this.postMessageTransfers?this.comObj.postMessage(e,t):this.comObj.postMessage(e)}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Metadata=void 0;var n=r(2),i=r(15);t.Metadata=class{constructor(e){(0,n.assert)("string"===typeof e,"Metadata: input is not a string"),e=this._repair(e);const t=(new i.SimpleXMLParser).parseFromString(e);this._metadataMap=new Map,t&&this._parse(t)}_repair(e){return e.replace(/^[^<]+/,"").replace(/>\\376\\377([^<]+)/g,(function(e,t){const r=t.replace(/\\([0-3])([0-7])([0-7])/g,(function(e,t,r,n){return String.fromCharCode(64*t+8*r+1*n)})).replace(/&(amp|apos|gt|lt|quot);/g,(function(e,t){switch(t){case"amp":return"&";case"apos":return"'";case"gt":return">";case"lt":return"<";case"quot":return'"'}throw new Error(`_repair: ${t} isn't defined.`)}));let n="";for(let i=0,o=r.length;i<o;i+=2){const e=256*r.charCodeAt(i)+r.charCodeAt(i+1);n+=e>=32&&e<127&&60!==e&&62!==e&&38!==e?String.fromCharCode(e):"&#x"+(65536+e).toString(16).substring(1)+";"}return">"+n}))}_parse(e){let t=e.documentElement;if("rdf:rdf"!==t.nodeName.toLowerCase())for(t=t.firstChild;t&&"rdf:rdf"!==t.nodeName.toLowerCase();)t=t.nextSibling;const r=t?t.nodeName.toLowerCase():null;if(!t||"rdf:rdf"!==r||!t.hasChildNodes())return;const n=t.childNodes;for(let i=0,o=n.length;i<o;i++){const e=n[i];if("rdf:description"===e.nodeName.toLowerCase())for(let t=0,r=e.childNodes.length;t<r;t++)if("#text"!==e.childNodes[t].nodeName.toLowerCase()){const r=e.childNodes[t],n=r.nodeName.toLowerCase();this._metadataMap.set(n,r.textContent.trim())}}}get(e){return this._metadataMap.has(e)?this._metadataMap.get(e):null}getAll(){return Object.fromEntries(this._metadataMap)}has(e){return this._metadataMap.has(e)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SimpleXMLParser=t.SimpleDOMNode=void 0;var n=r(2);const i=0,o=-2,a=-3,s=-4,l=-5,c=-6,u=-9;function h(e,t){const r=e[t];return" "===r||"\n"===r||"\r"===r||"\t"===r}class d{_resolveEntities(e){return e.replace(/&([^;]+);/g,((e,t)=>{if("#x"===t.substring(0,2))return String.fromCodePoint(parseInt(t.substring(2),16));if("#"===t.substring(0,1))return String.fromCodePoint(parseInt(t.substring(1),10));switch(t){case"lt":return"<";case"gt":return">";case"amp":return"&";case"quot":return'"'}return this.onResolveEntity(t)}))}_parseContent(e,t){const r=[];let n=t;function i(){for(;n<e.length&&h(e,n);)++n}for(;n<e.length&&!h(e,n)&&">"!==e[n]&&"/"!==e[n];)++n;const o=e.substring(t,n);for(i();n<e.length&&">"!==e[n]&&"/"!==e[n]&&"?"!==e[n];){i();let t="",o="";for(;n<e.length&&!h(e,n)&&"="!==e[n];)t+=e[n],++n;if(i(),"="!==e[n])return null;++n,i();const a=e[n];if('"'!==a&&"'"!==a)return null;const s=e.indexOf(a,++n);if(s<0)return null;o=e.substring(n,s),r.push({name:t,value:this._resolveEntities(o)}),n=s+1,i()}return{name:o,attributes:r,parsed:n-t}}_parseProcessingInstruction(e,t){let r=t;for(;r<e.length&&!h(e,r)&&">"!==e[r]&&"/"!==e[r];)++r;const n=e.substring(t,r);!function(){for(;r<e.length&&h(e,r);)++r}();const i=r;for(;r<e.length&&("?"!==e[r]||">"!==e[r+1]);)++r;return{name:n,value:e.substring(i,r),parsed:r-t}}parseXml(e){let t=0;for(;t<e.length;){let r=t;if("<"===e[t]){let t;switch(++r,e[r]){case"/":if(++r,t=e.indexOf(">",r),t<0)return void this.onError(u);this.onEndElement(e.substring(r,t)),r=t+1;break;case"?":++r;const n=this._parseProcessingInstruction(e,r);if("?>"!==e.substring(r+n.parsed,r+n.parsed+2))return void this.onError(a);this.onPi(n.name,n.value),r+=n.parsed+2;break;case"!":if("--"===e.substring(r+1,r+3)){if(t=e.indexOf("--\x3e",r+3),t<0)return void this.onError(l);this.onComment(e.substring(r+3,t)),r=t+3}else if("[CDATA["===e.substring(r+1,r+8)){if(t=e.indexOf("]]>",r+8),t<0)return void this.onError(o);this.onCdata(e.substring(r+8,t)),r=t+3}else{if("DOCTYPE"!==e.substring(r+1,r+8))return void this.onError(c);{const n=e.indexOf("[",r+8);let i=!1;if(t=e.indexOf(">",r+8),t<0)return void this.onError(s);if(n>0&&t>n){if(t=e.indexOf("]>",r+8),t<0)return void this.onError(s);i=!0}const o=e.substring(r+8,t+(i?1:0));this.onDoctype(o),r=t+(i?2:1)}}break;default:const i=this._parseContent(e,r);if(null===i)return void this.onError(c);let h=!1;if("/>"===e.substring(r+i.parsed,r+i.parsed+2))h=!0;else if(">"!==e.substring(r+i.parsed,r+i.parsed+1))return void this.onError(u);this.onBeginElement(i.name,i.attributes,h),r+=i.parsed+(h?2:1)}}else{for(;r<e.length&&"<"!==e[r];)r++;const n=e.substring(t,r);this.onText(this._resolveEntities(n))}t=r}}onResolveEntity(e){return`&${e};`}onPi(e,t){}onComment(e){}onCdata(e){}onDoctype(e){}onText(e){}onBeginElement(e,t,r){}onEndElement(e){}onError(e){}}class f{constructor(e,t){this.nodeName=e,this.nodeValue=t,Object.defineProperty(this,"parentNode",{value:null,writable:!0})}get firstChild(){return this.childNodes&&this.childNodes[0]}get nextSibling(){const e=this.parentNode.childNodes;if(!e)return;const t=e.indexOf(this);return-1!==t?e[t+1]:void 0}get textContent(){return this.childNodes?this.childNodes.map((function(e){return e.textContent})).join(""):this.nodeValue||""}hasChildNodes(){return this.childNodes&&this.childNodes.length>0}searchNode(e,t){if(t>=e.length)return this;const r=e[t],n=[];let i=this;for(;;){if(r.name===i.nodeName){if(0!==r.pos){if(0===n.length)return null;{const[o]=n.pop();let a=0;for(const n of o.childNodes)if(r.name===n.nodeName){if(a===r.pos)return n.searchNode(e,t+1);a++}return i.searchNode(e,t+1)}}{const r=i.searchNode(e,t+1);if(null!==r)return r}}if(i.childNodes&&0!==i.childNodes.length)n.push([i,0]),i=i.childNodes[0];else{if(0===n.length)return null;for(;0!==n.length;){const[e,t]=n.pop(),r=t+1;if(r<e.childNodes.length){n.push([e,r]),i=e.childNodes[r];break}}if(0===n.length)return null}}}dump(e){if("#text"!==this.nodeName){if(e.push(`<${this.nodeName}`),this.attributes)for(const t of this.attributes)e.push(` ${t.name}="${(0,n.encodeToXmlString)(t.value)}"`);if(this.hasChildNodes()){e.push(">");for(const t of this.childNodes)t.dump(e);e.push(`</${this.nodeName}>`)}else this.nodeValue?e.push(`>${(0,n.encodeToXmlString)(this.nodeValue)}</${this.nodeName}>`):e.push("/>")}else e.push((0,n.encodeToXmlString)(this.nodeValue))}}t.SimpleDOMNode=f,t.SimpleXMLParser=class extends d{constructor(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];super(),this._currentFragment=null,this._stack=null,this._errorCode=i,this._hasAttributes=e}parseFromString(e){if(this._currentFragment=[],this._stack=[],this._errorCode=i,this.parseXml(e),this._errorCode!==i)return;const[t]=this._currentFragment;return t?{documentElement:t}:void 0}onResolveEntity(e){return"apos"===e?"'":super.onResolveEntity(e)}onText(e){if(function(e){for(let t=0,r=e.length;t<r;t++)if(!h(e,t))return!1;return!0}(e))return;const t=new f("#text",e);this._currentFragment.push(t)}onCdata(e){const t=new f("#text",e);this._currentFragment.push(t)}onBeginElement(e,t,r){const n=new f(e);n.childNodes=[],this._hasAttributes&&(n.attributes=t),this._currentFragment.push(n),r||(this._stack.push(this._currentFragment),this._currentFragment=n.childNodes)}onEndElement(e){this._currentFragment=this._stack.pop()||[];const t=this._currentFragment[this._currentFragment.length-1];if(t)for(let r=0,n=t.childNodes.length;r<n;r++)t.childNodes[r].parentNode=t}onError(e){this._errorCode=e}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OptionalContentConfig=void 0;var n=r(2);class i{constructor(e,t){this.visible=!0,this.name=e,this.intent=t}}t.OptionalContentConfig=class{constructor(e){if(this.name=null,this.creator=null,this._order=null,this._groups=new Map,null!==e){this.name=e.name,this.creator=e.creator,this._order=e.order;for(const t of e.groups)this._groups.set(t.id,new i(t.name,t.intent));if("OFF"===e.baseState)for(const e of this._groups)e.visible=!1;for(const t of e.on)this._groups.get(t).visible=!0;for(const t of e.off)this._groups.get(t).visible=!1}}isVisible(e){if("OCG"===e.type)return this._groups.has(e.id)?this._groups.get(e.id).visible:((0,n.warn)(`Optional content group not found: ${e.id}`),!0);if("OCMD"===e.type){if(e.expression&&(0,n.warn)("Visibility expression not supported yet."),!e.policy||"AnyOn"===e.policy){for(const t of e.ids){if(!this._groups.has(t))return(0,n.warn)(`Optional content group not found: ${t}`),!0;if(this._groups.get(t).visible)return!0}return!1}if("AllOn"===e.policy){for(const t of e.ids){if(!this._groups.has(t))return(0,n.warn)(`Optional content group not found: ${t}`),!0;if(!this._groups.get(t).visible)return!1}return!0}if("AnyOff"===e.policy){for(const t of e.ids){if(!this._groups.has(t))return(0,n.warn)(`Optional content group not found: ${t}`),!0;if(!this._groups.get(t).visible)return!0}return!1}if("AllOff"===e.policy){for(const t of e.ids){if(!this._groups.has(t))return(0,n.warn)(`Optional content group not found: ${t}`),!0;if(this._groups.get(t).visible)return!1}return!0}return(0,n.warn)(`Unknown optional content policy ${e.policy}.`),!0}return(0,n.warn)(`Unknown group type ${e.type}.`),!0}setVisibility(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this._groups.has(e)?this._groups.get(e).visible=!!t:(0,n.warn)(`Optional content group not found: ${e}`)}getOrder(){return this._groups.size?this._order?this._order.slice():Array.from(this._groups.keys()):null}getGroups(){return this._groups.size?Object.fromEntries(this._groups):null}getGroup(e){return this._groups.get(e)||null}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PDFDataTransportStream=void 0;var n=r(2);t.PDFDataTransportStream=class{constructor(e,t){(0,n.assert)(t,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=e.progressiveDone||!1;const r=e.initialData;if(r&&r.length>0){const e=new Uint8Array(r).buffer;this._queuedChunks.push(e)}this._pdfDataRangeTransport=t,this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange,this._contentLength=e.length,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener(((e,t)=>{this._onReceiveData({begin:e,chunk:t})})),this._pdfDataRangeTransport.addProgressListener(((e,t)=>{this._onProgress({loaded:e,total:t})})),this._pdfDataRangeTransport.addProgressiveReadListener((e=>{this._onReceiveData({chunk:e})})),this._pdfDataRangeTransport.addProgressiveDoneListener((()=>{this._onProgressiveDone()})),this._pdfDataRangeTransport.transportReady()}_onReceiveData(e){const t=new Uint8Array(e.chunk).buffer;if(void 0===e.begin)this._fullRequestReader?this._fullRequestReader._enqueue(t):this._queuedChunks.push(t);else{const r=this._rangeReaders.some((function(r){return r._begin===e.begin&&(r._enqueue(t),!0)}));(0,n.assert)(r,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?this._fullRequestReader._loaded:0}_onProgress(e){if(void 0===e.total){const t=this._rangeReaders[0];t&&t.onProgress&&t.onProgress({loaded:e.loaded})}else{const t=this._fullRequestReader;t&&t.onProgress&&t.onProgress({loaded:e.loaded,total:e.total})}}_onProgressiveDone(){this._fullRequestReader&&this._fullRequestReader.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(e){const t=this._rangeReaders.indexOf(e);t>=0&&this._rangeReaders.splice(t,1)}getFullReader(){(0,n.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const e=this._queuedChunks;return this._queuedChunks=null,new i(this,e,this._progressiveDone)}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const r=new o(this,e,t);return this._pdfDataRangeTransport.requestDataRange(e,t),this._rangeReaders.push(r),r}cancelAllRequests(e){this._fullRequestReader&&this._fullRequestReader.cancel(e),this._rangeReaders.slice(0).forEach((function(t){t.cancel(e)})),this._pdfDataRangeTransport.abort()}};class i{constructor(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this._stream=e,this._done=r||!1,this._filename=null,this._queuedChunks=t||[],this._loaded=0;for(const n of this._queuedChunks)this._loaded+=n.byteLength;this._requests=[],this._headersReady=Promise.resolve(),e._fullRequestReader=this,this.onProgress=null}_enqueue(e){this._done||(this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunks.push(e),this._loaded+=e.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=(0,n.createPromiseCapability)();return this._requests.push(e),e.promise}cancel(e){this._done=!0,this._requests.forEach((function(e){e.resolve({value:void 0,done:!0})})),this._requests=[]}progressiveDone(){this._done||(this._done=!0)}}class o{constructor(e,t,r){this._stream=e,this._begin=t,this._end=r,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(e){this._done||(0===this._requests.length?this._queuedChunk=e:(this._requests.shift().resolve({value:e,done:!1}),this._requests.forEach((function(e){e.resolve({value:void 0,done:!0})})),this._requests=[]),this._done=!0,this._stream._removeRangeReader(this))}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const e=(0,n.createPromiseCapability)();return this._requests.push(e),e.promise}cancel(e){this._done=!0,this._requests.forEach((function(e){e.resolve({value:void 0,done:!0})})),this._requests=[],this._stream._removeRangeReader(this)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WebGLContext=void 0;var n=r(2);t.WebGLContext=class{constructor(e){let{enable:t=!1}=e;this._enabled=!0===t}get isEnabled(){let e=this._enabled;return e&&(e=i.tryInitGL()),(0,n.shadow)(this,"isEnabled",e)}composeSMask(e){let{layer:t,mask:r,properties:n}=e;return i.composeSMask(t,r,n)}drawFigures(e){let{width:t,height:r,backgroundColor:n,figures:o,context:a}=e;return i.drawFigures(t,r,n,o,a)}clear(){i.cleanup()}};var i=function(){function e(e,t,r){var n=e.createShader(r);if(e.shaderSource(n,t),e.compileShader(n),!e.getShaderParameter(n,e.COMPILE_STATUS)){var i=e.getShaderInfoLog(n);throw new Error("Error during shader compilation: "+i)}return n}function t(t,r){return e(t,r,t.VERTEX_SHADER)}function r(t,r){return e(t,r,t.FRAGMENT_SHADER)}function n(e,t){for(var r=e.createProgram(),n=0,i=t.length;n<i;++n)e.attachShader(r,t[n]);if(e.linkProgram(r),!e.getProgramParameter(r,e.LINK_STATUS)){var o=e.getProgramInfoLog(r);throw new Error("Error during program linking: "+o)}return r}function i(e,t,r){e.activeTexture(r);var n=e.createTexture();return e.bindTexture(e.TEXTURE_2D,n),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t),n}var o,a;function s(){o||(a=document.createElement("canvas"),o=a.getContext("webgl",{premultipliedalpha:!1}))}var l="  attribute vec2 a_position;                                      attribute vec2 a_texCoord;                                                                                                      uniform vec2 u_resolution;                                                                                                      varying vec2 v_texCoord;                                                                                                        void main() {                                                     vec2 clipSpace = (a_position / u_resolution) * 2.0 - 1.0;       gl_Position = vec4(clipSpace * vec2(1, -1), 0, 1);                                                                              v_texCoord = a_texCoord;                                      }                                                             ",c="  precision mediump float;                                                                                                        uniform vec4 u_backdrop;                                        uniform int u_subtype;                                          uniform sampler2D u_image;                                      uniform sampler2D u_mask;                                                                                                       varying vec2 v_texCoord;                                                                                                        void main() {                                                     vec4 imageColor = texture2D(u_image, v_texCoord);               vec4 maskColor = texture2D(u_mask, v_texCoord);                 if (u_backdrop.a > 0.0) {                                         maskColor.rgb = maskColor.rgb * maskColor.a +                                   u_backdrop.rgb * (1.0 - maskColor.a);         }                                                               float lum;                                                      if (u_subtype == 0) {                                             lum = maskColor.a;                                            } else {                                                          lum = maskColor.r * 0.3 + maskColor.g * 0.59 +                        maskColor.b * 0.11;                                     }                                                               imageColor.a *= lum;                                            imageColor.rgb *= imageColor.a;                                 gl_FragColor = imageColor;                                    }                                                             ",u=null,h="  attribute vec2 a_position;                                      attribute vec3 a_color;                                                                                                         uniform vec2 u_resolution;                                      uniform vec2 u_scale;                                           uniform vec2 u_offset;                                                                                                          varying vec4 v_color;                                                                                                           void main() {                                                     vec2 position = (a_position + u_offset) * u_scale;              vec2 clipSpace = (position / u_resolution) * 2.0 - 1.0;         gl_Position = vec4(clipSpace * vec2(1, -1), 0, 1);                                                                              v_color = vec4(a_color / 255.0, 1.0);                         }                                                             ",d="  precision mediump float;                                                                                                        varying vec4 v_color;                                                                                                           void main() {                                                     gl_FragColor = v_color;                                       }                                                             ",f=null;return{tryInitGL(){try{return s(),!!o}catch(e){}return!1},composeSMask:function(e,h,d){var f=e.width,g=e.height;u||function(){var e,i;s(),e=a,a=null,i=o,o=null;var h=n(i,[t(i,l),r(i,c)]);i.useProgram(h);var d={};d.gl=i,d.canvas=e,d.resolutionLocation=i.getUniformLocation(h,"u_resolution"),d.positionLocation=i.getAttribLocation(h,"a_position"),d.backdropLocation=i.getUniformLocation(h,"u_backdrop"),d.subtypeLocation=i.getUniformLocation(h,"u_subtype");var f=i.getAttribLocation(h,"a_texCoord"),g=i.getUniformLocation(h,"u_image"),p=i.getUniformLocation(h,"u_mask"),m=i.createBuffer();i.bindBuffer(i.ARRAY_BUFFER,m),i.bufferData(i.ARRAY_BUFFER,new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1]),i.STATIC_DRAW),i.enableVertexAttribArray(f),i.vertexAttribPointer(f,2,i.FLOAT,!1,0,0),i.uniform1i(g,0),i.uniform1i(p,1),u=d}();var p=u,m=p.canvas,v=p.gl;m.width=f,m.height=g,v.viewport(0,0,v.drawingBufferWidth,v.drawingBufferHeight),v.uniform2f(p.resolutionLocation,f,g),d.backdrop?v.uniform4f(p.resolutionLocation,d.backdrop[0],d.backdrop[1],d.backdrop[2],1):v.uniform4f(p.resolutionLocation,0,0,0,0),v.uniform1i(p.subtypeLocation,"Luminosity"===d.subtype?1:0);var b=i(v,e,v.TEXTURE0),y=i(v,h,v.TEXTURE1),w=v.createBuffer();return v.bindBuffer(v.ARRAY_BUFFER,w),v.bufferData(v.ARRAY_BUFFER,new Float32Array([0,0,f,0,0,g,0,g,f,0,f,g]),v.STATIC_DRAW),v.enableVertexAttribArray(p.positionLocation),v.vertexAttribPointer(p.positionLocation,2,v.FLOAT,!1,0,0),v.clearColor(0,0,0,0),v.enable(v.BLEND),v.blendFunc(v.ONE,v.ONE_MINUS_SRC_ALPHA),v.clear(v.COLOR_BUFFER_BIT),v.drawArrays(v.TRIANGLES,0,6),v.flush(),v.deleteTexture(b),v.deleteTexture(y),v.deleteBuffer(w),m},drawFigures:function(e,i,l,c,u){f||function(){var e,i;s(),e=a,a=null,i=o,o=null;var l=n(i,[t(i,h),r(i,d)]);i.useProgram(l);var c={};c.gl=i,c.canvas=e,c.resolutionLocation=i.getUniformLocation(l,"u_resolution"),c.scaleLocation=i.getUniformLocation(l,"u_scale"),c.offsetLocation=i.getUniformLocation(l,"u_offset"),c.positionLocation=i.getAttribLocation(l,"a_position"),c.colorLocation=i.getAttribLocation(l,"a_color"),f=c}();var g=f,p=g.canvas,m=g.gl;p.width=e,p.height=i,m.viewport(0,0,m.drawingBufferWidth,m.drawingBufferHeight),m.uniform2f(g.resolutionLocation,e,i);var v,b,y,w=0;for(v=0,b=c.length;v<b;v++)switch(c[v].type){case"lattice":w+=((y=c[v].coords.length/c[v].verticesPerRow|0)-1)*(c[v].verticesPerRow-1)*6;break;case"triangles":w+=c[v].coords.length}var S=new Float32Array(2*w),C=new Uint8Array(3*w),k=u.coords,x=u.colors,E=0,T=0;for(v=0,b=c.length;v<b;v++){var _=c[v],A=_.coords,R=_.colors;switch(_.type){case"lattice":var O=_.verticesPerRow;y=A.length/O|0;for(var M=1;M<y;M++)for(var I=M*O+1,P=1;P<O;P++,I++)S[E]=k[A[I-O-1]],S[E+1]=k[A[I-O-1]+1],S[E+2]=k[A[I-O]],S[E+3]=k[A[I-O]+1],S[E+4]=k[A[I-1]],S[E+5]=k[A[I-1]+1],C[T]=x[R[I-O-1]],C[T+1]=x[R[I-O-1]+1],C[T+2]=x[R[I-O-1]+2],C[T+3]=x[R[I-O]],C[T+4]=x[R[I-O]+1],C[T+5]=x[R[I-O]+2],C[T+6]=x[R[I-1]],C[T+7]=x[R[I-1]+1],C[T+8]=x[R[I-1]+2],S[E+6]=S[E+2],S[E+7]=S[E+3],S[E+8]=S[E+4],S[E+9]=S[E+5],S[E+10]=k[A[I]],S[E+11]=k[A[I]+1],C[T+9]=C[T+3],C[T+10]=C[T+4],C[T+11]=C[T+5],C[T+12]=C[T+6],C[T+13]=C[T+7],C[T+14]=C[T+8],C[T+15]=x[R[I]],C[T+16]=x[R[I]+1],C[T+17]=x[R[I]+2],E+=12,T+=18;break;case"triangles":for(var N=0,D=A.length;N<D;N++)S[E]=k[A[N]],S[E+1]=k[A[N]+1],C[T]=x[R[N]],C[T+1]=x[R[N]+1],C[T+2]=x[R[N]+2],E+=2,T+=3}}l?m.clearColor(l[0]/255,l[1]/255,l[2]/255,1):m.clearColor(0,0,0,0),m.clear(m.COLOR_BUFFER_BIT);var F=m.createBuffer();m.bindBuffer(m.ARRAY_BUFFER,F),m.bufferData(m.ARRAY_BUFFER,S,m.STATIC_DRAW),m.enableVertexAttribArray(g.positionLocation),m.vertexAttribPointer(g.positionLocation,2,m.FLOAT,!1,0,0);var L=m.createBuffer();return m.bindBuffer(m.ARRAY_BUFFER,L),m.bufferData(m.ARRAY_BUFFER,C,m.STATIC_DRAW),m.enableVertexAttribArray(g.colorLocation),m.vertexAttribPointer(g.colorLocation,3,m.UNSIGNED_BYTE,!1,0,0),m.uniform2f(g.scaleLocation,u.scaleX,u.scaleY),m.uniform2f(g.offsetLocation,u.offsetX,u.offsetY),m.drawArrays(m.TRIANGLES,0,w),m.flush(),m.deleteBuffer(F),m.deleteBuffer(L),p},cleanup(){u&&u.canvas&&(u.canvas.width=0,u.canvas.height=0),f&&f.canvas&&(f.canvas.width=0,f.canvas.height=0),u=null,f=null}}}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AnnotationLayer=void 0;var n=r(1),i=r(2),o=r(8);class a{static create(e){switch(e.data.annotationType){case i.AnnotationType.LINK:return new l(e);case i.AnnotationType.TEXT:return new c(e);case i.AnnotationType.WIDGET:switch(e.data.fieldType){case"Tx":return new h(e);case"Btn":return e.data.radioButton?new f(e):e.data.checkBox?new d(e):new g(e);case"Ch":return new p(e)}return new u(e);case i.AnnotationType.POPUP:return new m(e);case i.AnnotationType.FREETEXT:return new b(e);case i.AnnotationType.LINE:return new y(e);case i.AnnotationType.SQUARE:return new w(e);case i.AnnotationType.CIRCLE:return new S(e);case i.AnnotationType.POLYLINE:return new C(e);case i.AnnotationType.CARET:return new x(e);case i.AnnotationType.INK:return new E(e);case i.AnnotationType.POLYGON:return new k(e);case i.AnnotationType.HIGHLIGHT:return new T(e);case i.AnnotationType.UNDERLINE:return new _(e);case i.AnnotationType.SQUIGGLY:return new A(e);case i.AnnotationType.STRIKEOUT:return new R(e);case i.AnnotationType.STAMP:return new O(e);case i.AnnotationType.FILEATTACHMENT:return new M(e);default:return new s(e)}}}class s{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.isRenderable=t,this.data=e.data,this.layer=e.layer,this.page=e.page,this.viewport=e.viewport,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderInteractiveForms=e.renderInteractiveForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,t&&(this.container=this._createContainer(r))}_createContainer(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=this.data,r=this.page,n=this.viewport,o=document.createElement("section");let a=t.rect[2]-t.rect[0],s=t.rect[3]-t.rect[1];o.setAttribute("data-annotation-id",t.id);const l=i.Util.normalizeRect([t.rect[0],r.view[3]-t.rect[1]+r.view[1],t.rect[2],r.view[3]-t.rect[3]+r.view[1]]);if(o.style.transform=`matrix(${n.transform.join(",")})`,o.style.transformOrigin=`-${l[0]}px -${l[1]}px`,!e&&t.borderStyle.width>0){o.style.borderWidth=`${t.borderStyle.width}px`,t.borderStyle.style!==i.AnnotationBorderStyleType.UNDERLINE&&(a-=2*t.borderStyle.width,s-=2*t.borderStyle.width);const e=t.borderStyle.horizontalCornerRadius,r=t.borderStyle.verticalCornerRadius;if(e>0||r>0){const t=`${e}px / ${r}px`;o.style.borderRadius=t}switch(t.borderStyle.style){case i.AnnotationBorderStyleType.SOLID:o.style.borderStyle="solid";break;case i.AnnotationBorderStyleType.DASHED:o.style.borderStyle="dashed";break;case i.AnnotationBorderStyleType.BEVELED:(0,i.warn)("Unimplemented border style: beveled");break;case i.AnnotationBorderStyleType.INSET:(0,i.warn)("Unimplemented border style: inset");break;case i.AnnotationBorderStyleType.UNDERLINE:o.style.borderBottomStyle="solid"}t.color?o.style.borderColor=i.Util.makeCssRgb(0|t.color[0],0|t.color[1],0|t.color[2]):o.style.borderWidth=0}return o.style.left=`${l[0]}px`,o.style.top=`${l[1]}px`,o.style.width=`${a}px`,o.style.height=`${s}px`,o}_createPopup(e,t,r){t||((t=document.createElement("div")).style.height=e.style.height,t.style.width=e.style.width,e.appendChild(t));const n=new v({container:e,trigger:t,color:r.color,title:r.title,modificationDate:r.modificationDate,contents:r.contents,hideWrapper:!0}).render();n.style.left=e.style.width,e.appendChild(n)}render(){(0,i.unreachable)("Abstract method `AnnotationElement.render` called")}}class l extends s{constructor(e){super(e,!!(e.data.url||e.data.dest||e.data.action))}render(){this.container.className="linkAnnotation";const{data:e,linkService:t}=this,r=document.createElement("a");return e.url?(0,n.addLinkAttributes)(r,{url:e.url,target:e.newWindow?n.LinkTarget.BLANK:t.externalLinkTarget,rel:t.externalLinkRel,enabled:t.externalLinkEnabled}):e.action?this._bindNamedAction(r,e.action):this._bindLink(r,e.dest),this.container.appendChild(r),this.container}_bindLink(e,t){e.href=this.linkService.getDestinationHash(t),e.onclick=()=>(t&&this.linkService.navigateTo(t),!1),t&&(e.className="internalLink")}_bindNamedAction(e,t){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeNamedAction(t),!1),e.className="internalLink"}}class c extends s{constructor(e){super(e,!!(e.data.hasPopup||e.data.title||e.data.contents))}render(){this.container.className="textAnnotation";const e=document.createElement("img");return e.style.height=this.container.style.height,e.style.width=this.container.style.width,e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.alt="[{{type}} Annotation]",e.dataset.l10nId="text_annotation_type",e.dataset.l10nArgs=JSON.stringify({type:this.data.name}),this.data.hasPopup||this._createPopup(this.container,e,this.data),this.container.appendChild(e),this.container}}class u extends s{render(){return this.container}}class h extends u{constructor(e){super(e,e.renderInteractiveForms||!e.data.hasAppearance&&!!e.data.fieldValue)}render(){const e=["left","center","right"],t=this.annotationStorage,r=this.data.id;this.container.className="textWidgetAnnotation";let n=null;if(this.renderInteractiveForms){const e=t.getOrCreateValue(r,this.data.fieldValue);if(this.data.multiLine?(n=document.createElement("textarea"),n.textContent=e):(n=document.createElement("input"),n.type="text",n.setAttribute("value",e)),n.addEventListener("input",(function(e){t.setValue(r,e.target.value)})),n.disabled=this.data.readOnly,n.name=this.data.fieldName,null!==this.data.maxLen&&(n.maxLength=this.data.maxLen),this.data.comb){const e=(this.data.rect[2]-this.data.rect[0])/this.data.maxLen;n.classList.add("comb"),n.style.letterSpacing=`calc(${e}px - 1ch)`}}else{n=document.createElement("div"),n.textContent=this.data.fieldValue,n.style.verticalAlign="middle",n.style.display="table-cell";let e=null;this.data.fontRefName&&this.page.commonObjs.has(this.data.fontRefName)&&(e=this.page.commonObjs.get(this.data.fontRefName)),this._setTextStyle(n,e)}return null!==this.data.textAlignment&&(n.style.textAlign=e[this.data.textAlignment]),this.container.appendChild(n),this.container}_setTextStyle(e,t){const r=e.style;if(r.fontSize=`${this.data.fontSize}px`,r.direction=this.data.fontDirection<0?"rtl":"ltr",!t)return;let n="normal";t.black?n="900":t.bold&&(n="bold"),r.fontWeight=n,r.fontStyle=t.italic?"italic":"normal";const i=t.loadedName?`"${t.loadedName}", `:"",o=t.fallbackName||"Helvetica, sans-serif";r.fontFamily=i+o}}class d extends u{constructor(e){super(e,e.renderInteractiveForms)}render(){const e=this.annotationStorage,t=this.data,r=t.id,n=e.getOrCreateValue(r,t.fieldValue&&"Off"!==t.fieldValue);this.container.className="buttonWidgetAnnotation checkBox";const i=document.createElement("input");return i.disabled=t.readOnly,i.type="checkbox",i.name=this.data.fieldName,n&&i.setAttribute("checked",!0),i.addEventListener("change",(function(t){e.setValue(r,t.target.checked)})),this.container.appendChild(i),this.container}}class f extends u{constructor(e){super(e,e.renderInteractiveForms)}render(){this.container.className="buttonWidgetAnnotation radioButton";const e=this.annotationStorage,t=this.data,r=t.id,n=e.getOrCreateValue(r,t.fieldValue===t.buttonValue),i=document.createElement("input");return i.disabled=t.readOnly,i.type="radio",i.name=t.fieldName,n&&i.setAttribute("checked",!0),i.addEventListener("change",(function(t){const n=t.target.name;for(const r of document.getElementsByName(n))r!==t.target&&e.setValue(r.parentNode.getAttribute("data-annotation-id"),!1);e.setValue(r,t.target.checked)})),this.container.appendChild(i),this.container}}class g extends l{render(){const e=super.render();return e.className="buttonWidgetAnnotation pushButton",e}}class p extends u{constructor(e){super(e,e.renderInteractiveForms)}render(){this.container.className="choiceWidgetAnnotation";const e=this.annotationStorage,t=this.data.id;e.getOrCreateValue(t,this.data.fieldValue.length>0?this.data.fieldValue[0]:null);const r=document.createElement("select");r.disabled=this.data.readOnly,r.name=this.data.fieldName,this.data.combo||(r.size=this.data.options.length,this.data.multiSelect&&(r.multiple=!0));for(const n of this.data.options){const e=document.createElement("option");e.textContent=n.displayValue,e.value=n.exportValue,this.data.fieldValue.includes(n.exportValue)&&e.setAttribute("selected",!0),r.appendChild(e)}return r.addEventListener("input",(function(r){const n=r.target.options,i=n[n.selectedIndex].value;e.setValue(t,i)})),this.container.appendChild(r),this.container}}class m extends s{constructor(e){super(e,!(!e.data.title&&!e.data.contents))}render(){if(this.container.className="popupAnnotation",["Line","Square","Circle","PolyLine","Polygon","Ink"].includes(this.data.parentType))return this.container;const e=`[data-annotation-id="${this.data.parentId}"]`,t=this.layer.querySelector(e);if(!t)return this.container;const r=new v({container:this.container,trigger:t,color:this.data.color,title:this.data.title,modificationDate:this.data.modificationDate,contents:this.data.contents}),n=parseFloat(t.style.left),i=parseFloat(t.style.width);return this.container.style.transformOrigin=`-${n+i}px -${t.style.top}`,this.container.style.left=`${n+i}px`,this.container.appendChild(r.render()),this.container}}class v{constructor(e){this.container=e.container,this.trigger=e.trigger,this.color=e.color,this.title=e.title,this.modificationDate=e.modificationDate,this.contents=e.contents,this.hideWrapper=e.hideWrapper||!1,this.pinned=!1}render(){const e=document.createElement("div");e.className="popupWrapper",this.hideElement=this.hideWrapper?e:this.container,this.hideElement.setAttribute("hidden",!0);const t=document.createElement("div");t.className="popup";const r=this.color;if(r){const e=.7*(255-r[0])+r[0],n=.7*(255-r[1])+r[1],o=.7*(255-r[2])+r[2];t.style.backgroundColor=i.Util.makeCssRgb(0|e,0|n,0|o)}const o=document.createElement("h1");o.textContent=this.title,t.appendChild(o);const a=n.PDFDateString.toDateObject(this.modificationDate);if(a){const e=document.createElement("span");e.textContent="{{date}}, {{time}}",e.dataset.l10nId="annotation_date_string",e.dataset.l10nArgs=JSON.stringify({date:a.toLocaleDateString(),time:a.toLocaleTimeString()}),t.appendChild(e)}const s=this._formatContents(this.contents);return t.appendChild(s),this.trigger.addEventListener("click",this._toggle.bind(this)),this.trigger.addEventListener("mouseover",this._show.bind(this,!1)),this.trigger.addEventListener("mouseout",this._hide.bind(this,!1)),t.addEventListener("click",this._hide.bind(this,!0)),e.appendChild(t),e}_formatContents(e){const t=document.createElement("p"),r=e.split(/(?:\r\n?|\n)/);for(let n=0,i=r.length;n<i;++n){const e=r[n];t.appendChild(document.createTextNode(e)),n<i-1&&t.appendChild(document.createElement("br"))}return t}_toggle(){this.pinned?this._hide(!0):this._show(!0)}_show(){arguments.length>0&&void 0!==arguments[0]&&arguments[0]&&(this.pinned=!0),this.hideElement.hasAttribute("hidden")&&(this.hideElement.removeAttribute("hidden"),this.container.style.zIndex+=1)}_hide(){(!(arguments.length>0&&void 0!==arguments[0])||arguments[0])&&(this.pinned=!1),this.hideElement.hasAttribute("hidden")||this.pinned||(this.hideElement.setAttribute("hidden",!0),this.container.style.zIndex-=1)}}class b extends s{constructor(e){super(e,!!(e.data.hasPopup||e.data.title||e.data.contents),!0)}render(){return this.container.className="freeTextAnnotation",this.data.hasPopup||this._createPopup(this.container,null,this.data),this.container}}class y extends s{constructor(e){super(e,!!(e.data.hasPopup||e.data.title||e.data.contents),!0)}render(){this.container.className="lineAnnotation";const e=this.data,t=e.rect[2]-e.rect[0],r=e.rect[3]-e.rect[1],n=this.svgFactory.create(t,r),i=this.svgFactory.createElement("svg:line");return i.setAttribute("x1",e.rect[2]-e.lineCoordinates[0]),i.setAttribute("y1",e.rect[3]-e.lineCoordinates[1]),i.setAttribute("x2",e.rect[2]-e.lineCoordinates[2]),i.setAttribute("y2",e.rect[3]-e.lineCoordinates[3]),i.setAttribute("stroke-width",e.borderStyle.width||1),i.setAttribute("stroke","transparent"),n.appendChild(i),this.container.append(n),this._createPopup(this.container,i,e),this.container}}class w extends s{constructor(e){super(e,!!(e.data.hasPopup||e.data.title||e.data.contents),!0)}render(){this.container.className="squareAnnotation";const e=this.data,t=e.rect[2]-e.rect[0],r=e.rect[3]-e.rect[1],n=this.svgFactory.create(t,r),i=e.borderStyle.width,o=this.svgFactory.createElement("svg:rect");return o.setAttribute("x",i/2),o.setAttribute("y",i/2),o.setAttribute("width",t-i),o.setAttribute("height",r-i),o.setAttribute("stroke-width",i||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","none"),n.appendChild(o),this.container.append(n),this._createPopup(this.container,o,e),this.container}}class S extends s{constructor(e){super(e,!!(e.data.hasPopup||e.data.title||e.data.contents),!0)}render(){this.container.className="circleAnnotation";const e=this.data,t=e.rect[2]-e.rect[0],r=e.rect[3]-e.rect[1],n=this.svgFactory.create(t,r),i=e.borderStyle.width,o=this.svgFactory.createElement("svg:ellipse");return o.setAttribute("cx",t/2),o.setAttribute("cy",r/2),o.setAttribute("rx",t/2-i/2),o.setAttribute("ry",r/2-i/2),o.setAttribute("stroke-width",i||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","none"),n.appendChild(o),this.container.append(n),this._createPopup(this.container,o,e),this.container}}class C extends s{constructor(e){super(e,!!(e.data.hasPopup||e.data.title||e.data.contents),!0),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.className=this.containerClassName;const e=this.data,t=e.rect[2]-e.rect[0],r=e.rect[3]-e.rect[1],n=this.svgFactory.create(t,r);let i=[];for(const a of e.vertices){const t=a.x-e.rect[0],r=e.rect[3]-a.y;i.push(t+","+r)}i=i.join(" ");const o=this.svgFactory.createElement(this.svgElementName);return o.setAttribute("points",i),o.setAttribute("stroke-width",e.borderStyle.width||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","none"),n.appendChild(o),this.container.append(n),this._createPopup(this.container,o,e),this.container}}class k extends C{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class x extends s{constructor(e){super(e,!!(e.data.hasPopup||e.data.title||e.data.contents),!0)}render(){return this.container.className="caretAnnotation",this.data.hasPopup||this._createPopup(this.container,null,this.data),this.container}}class E extends s{constructor(e){super(e,!!(e.data.hasPopup||e.data.title||e.data.contents),!0),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline"}render(){this.container.className=this.containerClassName;const e=this.data,t=e.rect[2]-e.rect[0],r=e.rect[3]-e.rect[1],n=this.svgFactory.create(t,r);for(const i of e.inkLists){let t=[];for(const n of i){const r=n.x-e.rect[0],i=e.rect[3]-n.y;t.push(`${r},${i}`)}t=t.join(" ");const r=this.svgFactory.createElement(this.svgElementName);r.setAttribute("points",t),r.setAttribute("stroke-width",e.borderStyle.width||1),r.setAttribute("stroke","transparent"),r.setAttribute("fill","none"),this._createPopup(this.container,r,e),n.appendChild(r)}return this.container.append(n),this.container}}class T extends s{constructor(e){super(e,!!(e.data.hasPopup||e.data.title||e.data.contents),!0)}render(){return this.container.className="highlightAnnotation",this.data.hasPopup||this._createPopup(this.container,null,this.data),this.container}}class _ extends s{constructor(e){super(e,!!(e.data.hasPopup||e.data.title||e.data.contents),!0)}render(){return this.container.className="underlineAnnotation",this.data.hasPopup||this._createPopup(this.container,null,this.data),this.container}}class A extends s{constructor(e){super(e,!!(e.data.hasPopup||e.data.title||e.data.contents),!0)}render(){return this.container.className="squigglyAnnotation",this.data.hasPopup||this._createPopup(this.container,null,this.data),this.container}}class R extends s{constructor(e){super(e,!!(e.data.hasPopup||e.data.title||e.data.contents),!0)}render(){return this.container.className="strikeoutAnnotation",this.data.hasPopup||this._createPopup(this.container,null,this.data),this.container}}class O extends s{constructor(e){super(e,!!(e.data.hasPopup||e.data.title||e.data.contents),!0)}render(){return this.container.className="stampAnnotation",this.data.hasPopup||this._createPopup(this.container,null,this.data),this.container}}class M extends s{constructor(e){super(e,!0);const{filename:t,content:r}=this.data.file;this.filename=(0,n.getFilenameFromUrl)(t),this.content=r,this.linkService.eventBus&&this.linkService.eventBus.dispatch("fileattachmentannotation",{source:this,id:(0,i.stringToPDFString)(t),filename:t,content:r})}render(){this.container.className="fileAttachmentAnnotation";const e=document.createElement("div");return e.style.height=this.container.style.height,e.style.width=this.container.style.width,e.addEventListener("dblclick",this._download.bind(this)),this.data.hasPopup||!this.data.title&&!this.data.contents||this._createPopup(this.container,e,this.data),this.container.appendChild(e),this.container}_download(){this.downloadManager?this.downloadManager.downloadData(this.content,this.filename,""):(0,i.warn)("Download cannot be started due to unavailable download manager")}}t.AnnotationLayer=class{static render(e){const t=[],r=[];for(const n of e.annotations)n&&(n.annotationType!==i.AnnotationType.POPUP?t.push(n):r.push(n));r.length&&t.push(...r);for(const i of t){const t=a.create({data:i,layer:e.div,page:e.page,viewport:e.viewport,linkService:e.linkService,downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderInteractiveForms:"boolean"!==typeof e.renderInteractiveForms||e.renderInteractiveForms,svgFactory:new n.DOMSVGFactory,annotationStorage:e.annotationStorage||new o.AnnotationStorage});t.isRenderable&&e.div.appendChild(t.render())}}static update(e){for(const t of e.annotations){const r=e.div.querySelector(`[data-annotation-id="${t.id}"]`);r&&(r.style.transform=`matrix(${e.viewport.transform.join(",")})`)}e.div.removeAttribute("hidden")}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.renderTextLayer=void 0;var n=r(2),i=function(){var e=/\S/;function t(t,r,i){var o,a=document.createElement("span"),s={angle:0,canvasWidth:0,isWhitespace:!1,originalTransform:null,paddingBottom:0,paddingLeft:0,paddingRight:0,paddingTop:0,scale:1};if(t._textDivs.push(a),o=r.str,!e.test(o))return s.isWhitespace=!0,void t._textDivProperties.set(a,s);var l=n.Util.transform(t._viewport.transform,r.transform),c=Math.atan2(l[1],l[0]),u=i[r.fontName];u.vertical&&(c+=Math.PI/2);var h=Math.sqrt(l[2]*l[2]+l[3]*l[3]),d=h;let f,g;u.ascent?d=u.ascent*d:u.descent&&(d=(1+u.descent)*d),0===c?(f=l[4],g=l[5]-d):(f=l[4]+d*Math.sin(c),g=l[5]-d*Math.cos(c)),a.style.left=`${f}px`,a.style.top=`${g}px`,a.style.fontSize=`${h}px`,a.style.fontFamily=u.fontFamily,a.textContent=r.str,t._fontInspectorEnabled&&(a.dataset.fontName=r.fontName),0!==c&&(s.angle=c*(180/Math.PI));let p=!1;if(r.str.length>1)p=!0;else if(r.transform[0]!==r.transform[3]){const e=Math.abs(r.transform[0]),t=Math.abs(r.transform[3]);e!==t&&Math.max(e,t)/Math.min(e,t)>1.5&&(p=!0)}if(p&&(u.vertical?s.canvasWidth=r.height*t._viewport.scale:s.canvasWidth=r.width*t._viewport.scale),t._textDivProperties.set(a,s),t._textContentStream&&t._layoutText(a),t._enhanceTextSelection){var m=1,v=0;0!==c&&(m=Math.cos(c),v=Math.sin(c));var b,y,w=(u.vertical?r.height:r.width)*t._viewport.scale,S=h;0!==c?(b=[m,v,-v,m,f,g],y=n.Util.getAxialAlignedBoundingBox([0,0,w,S],b)):y=[f,g,f+w,g+S],t._bounds.push({left:y[0],top:y[1],right:y[2],bottom:y[3],div:a,size:[w,S],m:b})}}function r(e){if(!e._canceled){var t=e._textDivs,r=e._capability,n=t.length;if(n>1e5)return e._renderingDone=!0,void r.resolve();if(!e._textContentStream)for(var i=0;i<n;i++)e._layoutText(t[i]);e._renderingDone=!0,r.resolve()}}function i(e,t,r){let n=0;for(let i=0;i<r;i++){const r=e[t++];r>0&&(n=n?Math.min(r,n):r)}return n}function o(e){for(var t=e._bounds,r=e._viewport,o=function(e,t,r){var n=r.map((function(e,t){return{x1:e.left,y1:e.top,x2:e.right,y2:e.bottom,index:t,x1New:void 0,x2New:void 0}}));a(e,n);var i=new Array(r.length);return n.forEach((function(e){var t=e.index;i[t]={left:e.x1New,top:0,right:e.x2New,bottom:0}})),r.map((function(t,r){var o=i[r],a=n[r];a.x1=t.top,a.y1=e-o.right,a.x2=t.bottom,a.y2=e-o.left,a.index=r,a.x1New=void 0,a.x2New=void 0})),a(t,n),n.forEach((function(e){var t=e.index;i[t].top=e.x1New,i[t].bottom=e.x2New})),i}(r.width,r.height,t),s=0;s<o.length;s++){var l=t[s].div,c=e._textDivProperties.get(l);if(0!==c.angle){var u=o[s],h=t[s],d=h.m,f=d[0],g=d[1],p=[[0,0],[0,h.size[1]],[h.size[0],0],h.size],m=new Float64Array(64);p.forEach((function(e,t){var r=n.Util.applyTransform(e,d);m[t+0]=f&&(u.left-r[0])/f,m[t+4]=g&&(u.top-r[1])/g,m[t+8]=f&&(u.right-r[0])/f,m[t+12]=g&&(u.bottom-r[1])/g,m[t+16]=g&&(u.left-r[0])/-g,m[t+20]=f&&(u.top-r[1])/f,m[t+24]=g&&(u.right-r[0])/-g,m[t+28]=f&&(u.bottom-r[1])/f,m[t+32]=f&&(u.left-r[0])/-f,m[t+36]=g&&(u.top-r[1])/-g,m[t+40]=f&&(u.right-r[0])/-f,m[t+44]=g&&(u.bottom-r[1])/-g,m[t+48]=g&&(u.left-r[0])/g,m[t+52]=f&&(u.top-r[1])/-f,m[t+56]=g&&(u.right-r[0])/g,m[t+60]=f&&(u.bottom-r[1])/-f}));var v=1+Math.min(Math.abs(f),Math.abs(g));c.paddingLeft=i(m,32,16)/v,c.paddingTop=i(m,48,16)/v,c.paddingRight=i(m,0,16)/v,c.paddingBottom=i(m,16,16)/v,e._textDivProperties.set(l,c)}else c.paddingLeft=t[s].left-o[s].left,c.paddingTop=t[s].top-o[s].top,c.paddingRight=o[s].right-t[s].right,c.paddingBottom=o[s].bottom-t[s].bottom,e._textDivProperties.set(l,c)}}function a(e,t){t.sort((function(e,t){return e.x1-t.x1||e.index-t.index}));var r=[{start:-1/0,end:1/0,boundary:{x1:-1/0,y1:-1/0,x2:0,y2:1/0,index:-1,x1New:0,x2New:0}}];t.forEach((function(e){for(var t=0;t<r.length&&r[t].end<=e.y1;)t++;for(var n,i,o=r.length-1;o>=0&&r[o].start>=e.y2;)o--;var a,s,l=-1/0;for(a=t;a<=o;a++){var c;(c=(i=(n=r[a]).boundary).x2>e.x1?i.index>e.index?i.x1New:e.x1:void 0===i.x2New?(i.x2+e.x1)/2:i.x2New)>l&&(l=c)}for(e.x1New=l,a=t;a<=o;a++)void 0===(i=(n=r[a]).boundary).x2New?i.x2>e.x1?i.index>e.index&&(i.x2New=i.x2):i.x2New=l:i.x2New>l&&(i.x2New=Math.max(l,i.x2));var u=[],h=null;for(a=t;a<=o;a++){var d=(i=(n=r[a]).boundary).x2>e.x2?i:e;h===d?u[u.length-1].end=n.end:(u.push({start:n.start,end:n.end,boundary:d}),h=d)}for(r[t].start<e.y1&&(u[0].start=e.y1,u.unshift({start:r[t].start,end:e.y1,boundary:r[t].boundary})),e.y2<r[o].end&&(u[u.length-1].end=e.y2,u.push({start:e.y2,end:r[o].end,boundary:r[o].boundary})),a=t;a<=o;a++)if(void 0===(i=(n=r[a]).boundary).x2New){var f=!1;for(s=t-1;!f&&s>=0&&r[s].start>=i.y1;s--)f=r[s].boundary===i;for(s=o+1;!f&&s<r.length&&r[s].end<=i.y2;s++)f=r[s].boundary===i;for(s=0;!f&&s<u.length;s++)f=u[s].boundary===i;f||(i.x2New=l)}Array.prototype.splice.apply(r,[t,o-t+1].concat(u))})),r.forEach((function(t){var r=t.boundary;void 0===r.x2New&&(r.x2New=Math.max(e,r.x2))}))}function s(e){let{textContent:t,textContentStream:r,container:i,viewport:o,textDivs:a,textContentItemsStr:s,enhanceTextSelection:l}=e;this._textContent=t,this._textContentStream=r,this._container=i,this._document=i.ownerDocument,this._viewport=o,this._textDivs=a||[],this._textContentItemsStr=s||[],this._enhanceTextSelection=!!l,this._fontInspectorEnabled=!(!globalThis.FontInspector||!globalThis.FontInspector.enabled),this._reader=null,this._layoutTextLastFontSize=null,this._layoutTextLastFontFamily=null,this._layoutTextCtx=null,this._textDivProperties=new WeakMap,this._renderingDone=!1,this._canceled=!1,this._capability=(0,n.createPromiseCapability)(),this._renderTimer=null,this._bounds=[],this._capability.promise.finally((()=>{this._layoutTextCtx&&(this._layoutTextCtx.canvas.width=0,this._layoutTextCtx.canvas.height=0,this._layoutTextCtx=null)})).catch((()=>{}))}return s.prototype={get promise(){return this._capability.promise},cancel:function(){this._canceled=!0,this._reader&&(this._reader.cancel(new n.AbortException("TextLayer task cancelled.")),this._reader=null),null!==this._renderTimer&&(clearTimeout(this._renderTimer),this._renderTimer=null),this._capability.reject(new Error("TextLayer task cancelled."))},_processItems(e,r){for(let n=0,i=e.length;n<i;n++)this._textContentItemsStr.push(e[n].str),t(this,e[n],r)},_layoutText(e){const t=this._textDivProperties.get(e);if(t.isWhitespace)return;let r="";if(0!==t.canvasWidth){const{fontSize:n,fontFamily:i}=e.style;n===this._layoutTextLastFontSize&&i===this._layoutTextLastFontFamily||(this._layoutTextCtx.font=`${n} ${i}`,this._layoutTextLastFontSize=n,this._layoutTextLastFontFamily=i);const{width:o}=this._layoutTextCtx.measureText(e.textContent);o>0&&(t.scale=t.canvasWidth/o,r=`scaleX(${t.scale})`)}0!==t.angle&&(r=`rotate(${t.angle}deg) ${r}`),r.length>0&&(this._enhanceTextSelection&&(t.originalTransform=r),e.style.transform=r),this._textDivProperties.set(e,t),this._container.appendChild(e)},_render:function(e){const t=(0,n.createPromiseCapability)();let i=Object.create(null);const o=this._document.createElement("canvas");if(o.mozOpaque=!0,this._layoutTextCtx=o.getContext("2d",{alpha:!1}),this._textContent){const e=this._textContent.items,r=this._textContent.styles;this._processItems(e,r),t.resolve()}else{if(!this._textContentStream)throw new Error('Neither "textContent" nor "textContentStream" parameters specified.');{const e=()=>{this._reader.read().then((r=>{let{value:n,done:o}=r;o?t.resolve():(Object.assign(i,n.styles),this._processItems(n.items,i),e())}),t.reject)};this._reader=this._textContentStream.getReader(),e()}}t.promise.then((()=>{i=null,e?this._renderTimer=setTimeout((()=>{r(this),this._renderTimer=null}),e):r(this)}),this._capability.reject)},expandTextDivs:function(e){if(!this._enhanceTextSelection||!this._renderingDone)return;null!==this._bounds&&(o(this),this._bounds=null);const t=[],r=[];for(var n=0,i=this._textDivs.length;n<i;n++){const i=this._textDivs[n],o=this._textDivProperties.get(i);o.isWhitespace||(e?(t.length=0,r.length=0,o.originalTransform&&t.push(o.originalTransform),o.paddingTop>0?(r.push(`${o.paddingTop}px`),t.push(`translateY(${-o.paddingTop}px)`)):r.push(0),o.paddingRight>0?r.push(o.paddingRight/o.scale+"px"):r.push(0),o.paddingBottom>0?r.push(`${o.paddingBottom}px`):r.push(0),o.paddingLeft>0?(r.push(o.paddingLeft/o.scale+"px"),t.push(`translateX(${-o.paddingLeft/o.scale}px)`)):r.push(0),i.style.padding=r.join(" "),t.length&&(i.style.transform=t.join(" "))):(i.style.padding=null,i.style.transform=o.originalTransform))}}},function(e){var t=new s({textContent:e.textContent,textContentStream:e.textContentStream,container:e.container,viewport:e.viewport,textDivs:e.textDivs,textContentItemsStr:e.textContentItemsStr,enhanceTextSelection:e.enhanceTextSelection});return t._render(e.timeout),t}}();t.renderTextLayer=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SVGGraphics=void 0;var n=r(2),i=r(1),o=r(4);let a=function(){throw new Error("Not implemented: SVGGraphics")};t.SVGGraphics=a;{const s={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},l="http://www.w3.org/XML/1998/namespace",c="http://www.w3.org/1999/xlink",u=["butt","round","square"],h=["miter","round","bevel"],d=function(){const e=new Uint8Array([137,80,78,71,13,10,26,10]),t=new Int32Array(256);for(let n=0;n<256;n++){let e=n;for(let t=0;t<8;t++)e=1&e?3988292384^e>>1&2147483647:e>>1&2147483647;t[n]=e}function r(e,r,n,i){let o=i;const a=r.length;n[o]=a>>24&255,n[o+1]=a>>16&255,n[o+2]=a>>8&255,n[o+3]=255&a,o+=4,n[o]=255&e.charCodeAt(0),n[o+1]=255&e.charCodeAt(1),n[o+2]=255&e.charCodeAt(2),n[o+3]=255&e.charCodeAt(3),o+=4,n.set(r,o),o+=r.length;const s=function(e,r,n){let i=-1;for(let o=r;o<n;o++){const r=255&(i^e[o]);i=i>>>8^t[r]}return~i}(n,i+4,o);n[o]=s>>24&255,n[o+1]=s>>16&255,n[o+2]=s>>8&255,n[o+3]=255&s}function i(e){let t=e.length;const r=65535,n=Math.ceil(t/r),i=new Uint8Array(2+t+5*n+4);let o=0;i[o++]=120,i[o++]=156;let a=0;for(;t>r;)i[o++]=0,i[o++]=255,i[o++]=255,i[o++]=0,i[o++]=0,i.set(e.subarray(a,a+r),o),o+=r,a+=r,t-=r;i[o++]=1,i[o++]=255&t,i[o++]=t>>8&255,i[o++]=255&~t,i[o++]=(65535&~t)>>8&255,i.set(e.subarray(a),o),o+=e.length-a;const s=function(e,t,r){let n=1,i=0;for(let o=t;o<r;++o)n=(n+(255&e[o]))%65521,i=(i+n)%65521;return i<<16|n}(e,0,e.length);return i[o++]=s>>24&255,i[o++]=s>>16&255,i[o++]=s>>8&255,i[o++]=255&s,i}function a(t,a,s,l){const c=t.width,u=t.height;let h,d,f;const g=t.data;switch(a){case n.ImageKind.GRAYSCALE_1BPP:d=0,h=1,f=c+7>>3;break;case n.ImageKind.RGB_24BPP:d=2,h=8,f=3*c;break;case n.ImageKind.RGBA_32BPP:d=6,h=8,f=4*c;break;default:throw new Error("invalid format")}const p=new Uint8Array((1+f)*u);let m=0,v=0;for(let e=0;e<u;++e)p[m++]=0,p.set(g.subarray(v,v+f),m),v+=f,m+=f;if(a===n.ImageKind.GRAYSCALE_1BPP&&l){m=0;for(let e=0;e<u;e++){m++;for(let e=0;e<f;e++)p[m++]^=255}}const b=new Uint8Array([c>>24&255,c>>16&255,c>>8&255,255&c,u>>24&255,u>>16&255,u>>8&255,255&u,h,d,0,0,0]),y=function(e){if(!o.isNodeJS)return i(e);try{let t;t=parseInt(process.versions.node)>=8?e:Buffer.from(e);const r=__webpack_require__(6282).deflateSync(t,{level:9});return r instanceof Uint8Array?r:new Uint8Array(r)}catch(t){(0,n.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+t)}return i(e)}(p),w=e.length+36+b.length+y.length,S=new Uint8Array(w);let C=0;return S.set(e,C),C+=e.length,r("IHDR",b,S,C),C+=12+b.length,r("IDATA",y,S,C),C+=12+y.length,r("IEND",new Uint8Array(0),S,C),(0,n.createObjectURL)(S,"image/png",s)}return function(e,t,r){return a(e,void 0===e.kind?n.ImageKind.GRAYSCALE_1BPP:e.kind,t,r)}}();class f{constructor(){this.fontSizeScale=1,this.fontWeight=s.fontWeight,this.fontSize=0,this.textMatrix=n.IDENTITY_MATRIX,this.fontMatrix=n.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=n.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=s.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(e,t){this.x=e,this.y=t}}function g(e){let t=[];const r=[];for(const n of e)"save"!==n.fn?"restore"===n.fn?t=r.pop():t.push(n):(t.push({fnId:92,fn:"group",items:[]}),r.push(t),t=t[t.length-1].items);return t}function p(e){if(Number.isInteger(e))return e.toString();const t=e.toFixed(10);let r=t.length-1;if("0"!==t[r])return t;do{r--}while("0"===t[r]);return t.substring(0,"."===t[r]?r:r+1)}function m(e){if(0===e[4]&&0===e[5]){if(0===e[1]&&0===e[2])return 1===e[0]&&1===e[3]?"":`scale(${p(e[0])} ${p(e[3])})`;if(e[0]===e[3]&&e[1]===-e[2])return`rotate(${p(180*Math.acos(e[0])/Math.PI)})`}else if(1===e[0]&&0===e[1]&&0===e[2]&&1===e[3])return`translate(${p(e[4])} ${p(e[5])})`;return`matrix(${p(e[0])} ${p(e[1])} ${p(e[2])} ${p(e[3])} ${p(e[4])} ${p(e[5])})`}let v=0,b=0,y=0;t.SVGGraphics=a=class{constructor(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.svgFactory=new i.DOMSVGFactory,this.current=new f,this.transformMatrix=n.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=e,this.objs=t,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!r,this._operatorIdMapping=[];for(const i in n.OPS)this._operatorIdMapping[n.OPS[i]]=i}save(){this.transformStack.push(this.transformMatrix);const e=this.current;this.extraStack.push(e),this.current=e.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(e){this.save(),this.executeOpTree(e),this.restore()}loadDependencies(e){const t=e.fnArray,r=e.argsArray;for(let i=0,o=t.length;i<o;i++)if(t[i]===n.OPS.dependency)for(const e of r[i]){const t=e.startsWith("g_")?this.commonObjs:this.objs,r=new Promise((r=>{t.get(e,r)}));this.current.dependencies.push(r)}return Promise.all(this.current.dependencies)}transform(e,t,r,i,o,a){const s=[e,t,r,i,o,a];this.transformMatrix=n.Util.transform(this.transformMatrix,s),this.tgrp=null}getSVG(e,t){this.viewport=t;const r=this._initialize(t);return this.loadDependencies(e).then((()=>(this.transformMatrix=n.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(e)),r)))}convertOpList(e){const t=this._operatorIdMapping,r=e.argsArray,n=e.fnArray,i=[];for(let o=0,a=n.length;o<a;o++){const e=n[o];i.push({fnId:e,fn:t[e],args:r[o]})}return g(i)}executeOpTree(e){for(const t of e){const e=t.fn,r=t.fnId,i=t.args;switch(0|r){case n.OPS.beginText:this.beginText();break;case n.OPS.dependency:break;case n.OPS.setLeading:this.setLeading(i);break;case n.OPS.setLeadingMoveText:this.setLeadingMoveText(i[0],i[1]);break;case n.OPS.setFont:this.setFont(i);break;case n.OPS.showText:case n.OPS.showSpacedText:this.showText(i[0]);break;case n.OPS.endText:this.endText();break;case n.OPS.moveText:this.moveText(i[0],i[1]);break;case n.OPS.setCharSpacing:this.setCharSpacing(i[0]);break;case n.OPS.setWordSpacing:this.setWordSpacing(i[0]);break;case n.OPS.setHScale:this.setHScale(i[0]);break;case n.OPS.setTextMatrix:this.setTextMatrix(i[0],i[1],i[2],i[3],i[4],i[5]);break;case n.OPS.setTextRise:this.setTextRise(i[0]);break;case n.OPS.setTextRenderingMode:this.setTextRenderingMode(i[0]);break;case n.OPS.setLineWidth:this.setLineWidth(i[0]);break;case n.OPS.setLineJoin:this.setLineJoin(i[0]);break;case n.OPS.setLineCap:this.setLineCap(i[0]);break;case n.OPS.setMiterLimit:this.setMiterLimit(i[0]);break;case n.OPS.setFillRGBColor:this.setFillRGBColor(i[0],i[1],i[2]);break;case n.OPS.setStrokeRGBColor:this.setStrokeRGBColor(i[0],i[1],i[2]);break;case n.OPS.setStrokeColorN:this.setStrokeColorN(i);break;case n.OPS.setFillColorN:this.setFillColorN(i);break;case n.OPS.shadingFill:this.shadingFill(i[0]);break;case n.OPS.setDash:this.setDash(i[0],i[1]);break;case n.OPS.setRenderingIntent:this.setRenderingIntent(i[0]);break;case n.OPS.setFlatness:this.setFlatness(i[0]);break;case n.OPS.setGState:this.setGState(i[0]);break;case n.OPS.fill:this.fill();break;case n.OPS.eoFill:this.eoFill();break;case n.OPS.stroke:this.stroke();break;case n.OPS.fillStroke:this.fillStroke();break;case n.OPS.eoFillStroke:this.eoFillStroke();break;case n.OPS.clip:this.clip("nonzero");break;case n.OPS.eoClip:this.clip("evenodd");break;case n.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case n.OPS.paintImageXObject:this.paintImageXObject(i[0]);break;case n.OPS.paintInlineImageXObject:this.paintInlineImageXObject(i[0]);break;case n.OPS.paintImageMaskXObject:this.paintImageMaskXObject(i[0]);break;case n.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(i[0],i[1]);break;case n.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case n.OPS.closePath:this.closePath();break;case n.OPS.closeStroke:this.closeStroke();break;case n.OPS.closeFillStroke:this.closeFillStroke();break;case n.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case n.OPS.nextLine:this.nextLine();break;case n.OPS.transform:this.transform(i[0],i[1],i[2],i[3],i[4],i[5]);break;case n.OPS.constructPath:this.constructPath(i[0],i[1]);break;case n.OPS.endPath:this.endPath();break;case 92:this.group(t.items);break;default:(0,n.warn)(`Unimplemented operator ${e}`)}}}setWordSpacing(e){this.current.wordSpacing=e}setCharSpacing(e){this.current.charSpacing=e}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(e,t,r,n,i,o){const a=this.current;a.textMatrix=a.lineMatrix=[e,t,r,n,i,o],a.textMatrixScale=Math.sqrt(e*e+t*t),a.x=a.lineX=0,a.y=a.lineY=0,a.xcoords=[],a.ycoords=[],a.tspan=this.svgFactory.createElement("svg:tspan"),a.tspan.setAttributeNS(null,"font-family",a.fontFamily),a.tspan.setAttributeNS(null,"font-size",`${p(a.fontSize)}px`),a.tspan.setAttributeNS(null,"y",p(-a.y)),a.txtElement=this.svgFactory.createElement("svg:text"),a.txtElement.appendChild(a.tspan)}beginText(){const e=this.current;e.x=e.lineX=0,e.y=e.lineY=0,e.textMatrix=n.IDENTITY_MATRIX,e.lineMatrix=n.IDENTITY_MATRIX,e.textMatrixScale=1,e.tspan=this.svgFactory.createElement("svg:tspan"),e.txtElement=this.svgFactory.createElement("svg:text"),e.txtgrp=this.svgFactory.createElement("svg:g"),e.xcoords=[],e.ycoords=[]}moveText(e,t){const r=this.current;r.x=r.lineX+=e,r.y=r.lineY+=t,r.xcoords=[],r.ycoords=[],r.tspan=this.svgFactory.createElement("svg:tspan"),r.tspan.setAttributeNS(null,"font-family",r.fontFamily),r.tspan.setAttributeNS(null,"font-size",`${p(r.fontSize)}px`),r.tspan.setAttributeNS(null,"y",p(-r.y))}showText(e){const t=this.current,r=t.font,i=t.fontSize;if(0===i)return;const o=t.fontSizeScale,a=t.charSpacing,c=t.wordSpacing,u=t.fontDirection,h=t.textHScale*u,d=r.vertical,f=d?1:-1,g=r.defaultVMetrics,v=i*t.fontMatrix[0];let b=0;for(const s of e){if(null===s){b+=u*c;continue}if((0,n.isNum)(s)){b+=f*s*i/1e3;continue}const e=(s.isSpace?c:0)+a,l=s.fontChar;let h,p,m,y=s.width;if(d){let e;const t=s.vmetric||g;e=s.vmetric?t[1]:.5*y,e=-e*v;const r=t[2]*v;y=t?-t[0]:y,h=e/o,p=(b+r)/o}else h=b/o,p=0;(s.isInFont||r.missingFile)&&(t.xcoords.push(t.x+h),d&&t.ycoords.push(-t.y+p),t.tspan.textContent+=l),m=d?y*v-e*u:y*v+e*u,b+=m}t.tspan.setAttributeNS(null,"x",t.xcoords.map(p).join(" ")),d?t.tspan.setAttributeNS(null,"y",t.ycoords.map(p).join(" ")):t.tspan.setAttributeNS(null,"y",p(-t.y)),d?t.y-=b:t.x+=b*h,t.tspan.setAttributeNS(null,"font-family",t.fontFamily),t.tspan.setAttributeNS(null,"font-size",`${p(t.fontSize)}px`),t.fontStyle!==s.fontStyle&&t.tspan.setAttributeNS(null,"font-style",t.fontStyle),t.fontWeight!==s.fontWeight&&t.tspan.setAttributeNS(null,"font-weight",t.fontWeight);const y=t.textRenderingMode&n.TextRenderingMode.FILL_STROKE_MASK;if(y===n.TextRenderingMode.FILL||y===n.TextRenderingMode.FILL_STROKE?(t.fillColor!==s.fillColor&&t.tspan.setAttributeNS(null,"fill",t.fillColor),t.fillAlpha<1&&t.tspan.setAttributeNS(null,"fill-opacity",t.fillAlpha)):t.textRenderingMode===n.TextRenderingMode.ADD_TO_PATH?t.tspan.setAttributeNS(null,"fill","transparent"):t.tspan.setAttributeNS(null,"fill","none"),y===n.TextRenderingMode.STROKE||y===n.TextRenderingMode.FILL_STROKE){const e=1/(t.textMatrixScale||1);this._setStrokeAttributes(t.tspan,e)}let w=t.textMatrix;0!==t.textRise&&(w=w.slice(),w[5]+=t.textRise),t.txtElement.setAttributeNS(null,"transform",`${m(w)} scale(${p(h)}, -1)`),t.txtElement.setAttributeNS(l,"xml:space","preserve"),t.txtElement.appendChild(t.tspan),t.txtgrp.appendChild(t.txtElement),this._ensureTransformGroup().appendChild(t.txtElement)}setLeadingMoveText(e,t){this.setLeading(-t),this.moveText(e,t)}addFontStyle(e){if(!e.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.appendChild(this.cssStyle));const t=(0,n.createObjectURL)(e.data,e.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${e.loadedName}"; src: url(${t}); }\n`}setFont(e){const t=this.current,r=this.commonObjs.get(e[0]);let i=e[1];t.font=r,!this.embedFonts||r.missingFile||this.embeddedFonts[r.loadedName]||(this.addFontStyle(r),this.embeddedFonts[r.loadedName]=r),t.fontMatrix=r.fontMatrix?r.fontMatrix:n.FONT_IDENTITY_MATRIX;let o="normal";r.black?o="900":r.bold&&(o="bold");const a=r.italic?"italic":"normal";i<0?(i=-i,t.fontDirection=-1):t.fontDirection=1,t.fontSize=i,t.fontFamily=r.loadedName,t.fontWeight=o,t.fontStyle=a,t.tspan=this.svgFactory.createElement("svg:tspan"),t.tspan.setAttributeNS(null,"y",p(-t.y)),t.xcoords=[],t.ycoords=[]}endText(){const e=this.current;e.textRenderingMode&n.TextRenderingMode.ADD_TO_PATH_FLAG&&e.txtElement&&e.txtElement.hasChildNodes()&&(e.element=e.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(e){e>0&&(this.current.lineWidth=e)}setLineCap(e){this.current.lineCap=u[e]}setLineJoin(e){this.current.lineJoin=h[e]}setMiterLimit(e){this.current.miterLimit=e}setStrokeAlpha(e){this.current.strokeAlpha=e}setStrokeRGBColor(e,t,r){this.current.strokeColor=n.Util.makeCssRgb(e,t,r)}setFillAlpha(e){this.current.fillAlpha=e}setFillRGBColor(e,t,r){this.current.fillColor=n.Util.makeCssRgb(e,t,r),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(e){this.current.strokeColor=this._makeColorN_Pattern(e)}setFillColorN(e){this.current.fillColor=this._makeColorN_Pattern(e)}shadingFill(e){const t=this.viewport.width,r=this.viewport.height,i=n.Util.inverseTransform(this.transformMatrix),o=n.Util.applyTransform([0,0],i),a=n.Util.applyTransform([0,r],i),s=n.Util.applyTransform([t,0],i),l=n.Util.applyTransform([t,r],i),c=Math.min(o[0],a[0],s[0],l[0]),u=Math.min(o[1],a[1],s[1],l[1]),h=Math.max(o[0],a[0],s[0],l[0]),d=Math.max(o[1],a[1],s[1],l[1]),f=this.svgFactory.createElement("svg:rect");f.setAttributeNS(null,"x",c),f.setAttributeNS(null,"y",u),f.setAttributeNS(null,"width",h-c),f.setAttributeNS(null,"height",d-u),f.setAttributeNS(null,"fill",this._makeShadingPattern(e)),this.current.fillAlpha<1&&f.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().appendChild(f)}_makeColorN_Pattern(e){return"TilingPattern"===e[0]?this._makeTilingPattern(e):this._makeShadingPattern(e)}_makeTilingPattern(e){const t=e[1],r=e[2],i=e[3]||n.IDENTITY_MATRIX,[o,a,s,l]=e[4],c=e[5],u=e[6],h=e[7],d="shading"+y++,[f,g]=n.Util.applyTransform([o,a],i),[p,m]=n.Util.applyTransform([s,l],i),[v,b]=n.Util.singularValueDecompose2dScale(i),w=c*v,S=u*b,C=this.svgFactory.createElement("svg:pattern");C.setAttributeNS(null,"id",d),C.setAttributeNS(null,"patternUnits","userSpaceOnUse"),C.setAttributeNS(null,"width",w),C.setAttributeNS(null,"height",S),C.setAttributeNS(null,"x",`${f}`),C.setAttributeNS(null,"y",`${g}`);const k=this.svg,x=this.transformMatrix,E=this.current.fillColor,T=this.current.strokeColor,_=this.svgFactory.create(p-f,m-g);if(this.svg=_,this.transformMatrix=i,2===h){const e=n.Util.makeCssRgb(...t);this.current.fillColor=e,this.current.strokeColor=e}return this.executeOpTree(this.convertOpList(r)),this.svg=k,this.transformMatrix=x,this.current.fillColor=E,this.current.strokeColor=T,C.appendChild(_.childNodes[0]),this.defs.appendChild(C),`url(#${d})`}_makeShadingPattern(e){switch(e[0]){case"RadialAxial":const t="shading"+y++,r=e[3];let i;switch(e[1]){case"axial":const r=e[4],n=e[5];i=this.svgFactory.createElement("svg:linearGradient"),i.setAttributeNS(null,"id",t),i.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),i.setAttributeNS(null,"x1",r[0]),i.setAttributeNS(null,"y1",r[1]),i.setAttributeNS(null,"x2",n[0]),i.setAttributeNS(null,"y2",n[1]);break;case"radial":const o=e[4],a=e[5],s=e[6],l=e[7];i=this.svgFactory.createElement("svg:radialGradient"),i.setAttributeNS(null,"id",t),i.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),i.setAttributeNS(null,"cx",a[0]),i.setAttributeNS(null,"cy",a[1]),i.setAttributeNS(null,"r",l),i.setAttributeNS(null,"fx",o[0]),i.setAttributeNS(null,"fy",o[1]),i.setAttributeNS(null,"fr",s);break;default:throw new Error(`Unknown RadialAxial type: ${e[1]}`)}for(const e of r){const t=this.svgFactory.createElement("svg:stop");t.setAttributeNS(null,"offset",e[0]),t.setAttributeNS(null,"stop-color",e[1]),i.appendChild(t)}return this.defs.appendChild(i),`url(#${t})`;case"Mesh":return(0,n.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${e[0]}`)}}setDash(e,t){this.current.dashArray=e,this.current.dashPhase=t}constructPath(e,t){const r=this.current;let i=r.x,o=r.y,a=[],s=0;for(const l of e)switch(0|l){case n.OPS.rectangle:i=t[s++],o=t[s++];const e=i+t[s++],r=o+t[s++];a.push("M",p(i),p(o),"L",p(e),p(o),"L",p(e),p(r),"L",p(i),p(r),"Z");break;case n.OPS.moveTo:i=t[s++],o=t[s++],a.push("M",p(i),p(o));break;case n.OPS.lineTo:i=t[s++],o=t[s++],a.push("L",p(i),p(o));break;case n.OPS.curveTo:i=t[s+4],o=t[s+5],a.push("C",p(t[s]),p(t[s+1]),p(t[s+2]),p(t[s+3]),p(i),p(o)),s+=6;break;case n.OPS.curveTo2:a.push("C",p(i),p(o),p(t[s]),p(t[s+1]),p(t[s+2]),p(t[s+3])),i=t[s+2],o=t[s+3],s+=4;break;case n.OPS.curveTo3:i=t[s+2],o=t[s+3],a.push("C",p(t[s]),p(t[s+1]),p(i),p(o),p(i),p(o)),s+=4;break;case n.OPS.closePath:a.push("Z")}a=a.join(" "),r.path&&e.length>0&&e[0]!==n.OPS.rectangle&&e[0]!==n.OPS.moveTo?a=r.path.getAttributeNS(null,"d")+a:(r.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().appendChild(r.path)),r.path.setAttributeNS(null,"d",a),r.path.setAttributeNS(null,"fill","none"),r.element=r.path,r.setCurrentPoint(i,o)}endPath(){const e=this.current;if(e.path=null,!this.pendingClip)return;if(!e.element)return void(this.pendingClip=null);const t="clippath"+v++,r=this.svgFactory.createElement("svg:clipPath");r.setAttributeNS(null,"id",t),r.setAttributeNS(null,"transform",m(this.transformMatrix));const n=e.element.cloneNode(!0);"evenodd"===this.pendingClip?n.setAttributeNS(null,"clip-rule","evenodd"):n.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,r.appendChild(n),this.defs.appendChild(r),e.activeClipUrl&&(e.clipGroup=null,this.extraStack.forEach((function(e){e.clipGroup=null})),r.setAttributeNS(null,"clip-path",e.activeClipUrl)),e.activeClipUrl=`url(#${t})`,this.tgrp=null}clip(e){this.pendingClip=e}closePath(){const e=this.current;if(e.path){const t=`${e.path.getAttributeNS(null,"d")}Z`;e.path.setAttributeNS(null,"d",t)}}setLeading(e){this.current.leading=-e}setTextRise(e){this.current.textRise=e}setTextRenderingMode(e){this.current.textRenderingMode=e}setHScale(e){this.current.textHScale=e/100}setRenderingIntent(e){}setFlatness(e){}setGState(e){for(const[t,r]of e)switch(t){case"LW":this.setLineWidth(r);break;case"LC":this.setLineCap(r);break;case"LJ":this.setLineJoin(r);break;case"ML":this.setMiterLimit(r);break;case"D":this.setDash(r[0],r[1]);break;case"RI":this.setRenderingIntent(r);break;case"FL":this.setFlatness(r);break;case"Font":this.setFont(r);break;case"CA":this.setStrokeAlpha(r);break;case"ca":this.setFillAlpha(r);break;default:(0,n.warn)(`Unimplemented graphic state operator ${t}`)}}fill(){const e=this.current;e.element&&(e.element.setAttributeNS(null,"fill",e.fillColor),e.element.setAttributeNS(null,"fill-opacity",e.fillAlpha),this.endPath())}stroke(){const e=this.current;e.element&&(this._setStrokeAttributes(e.element),e.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;const r=this.current;let n=r.dashArray;1!==t&&n.length>0&&(n=n.map((function(e){return t*e}))),e.setAttributeNS(null,"stroke",r.strokeColor),e.setAttributeNS(null,"stroke-opacity",r.strokeAlpha),e.setAttributeNS(null,"stroke-miterlimit",p(r.miterLimit)),e.setAttributeNS(null,"stroke-linecap",r.lineCap),e.setAttributeNS(null,"stroke-linejoin",r.lineJoin),e.setAttributeNS(null,"stroke-width",p(t*r.lineWidth)+"px"),e.setAttributeNS(null,"stroke-dasharray",n.map(p).join(" ")),e.setAttributeNS(null,"stroke-dashoffset",p(t*r.dashPhase)+"px")}eoFill(){this.current.element&&this.current.element.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){this.current.element&&this.current.element.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const e=this.svgFactory.createElement("svg:rect");e.setAttributeNS(null,"x","0"),e.setAttributeNS(null,"y","0"),e.setAttributeNS(null,"width","1px"),e.setAttributeNS(null,"height","1px"),e.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().appendChild(e)}paintImageXObject(e){const t=e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e);t?this.paintInlineImageXObject(t):(0,n.warn)(`Dependent image with object ID ${e} is not ready yet`)}paintInlineImageXObject(e,t){const r=e.width,n=e.height,i=d(e,this.forceDataSchema,!!t),o=this.svgFactory.createElement("svg:rect");o.setAttributeNS(null,"x","0"),o.setAttributeNS(null,"y","0"),o.setAttributeNS(null,"width",p(r)),o.setAttributeNS(null,"height",p(n)),this.current.element=o,this.clip("nonzero");const a=this.svgFactory.createElement("svg:image");a.setAttributeNS(c,"xlink:href",i),a.setAttributeNS(null,"x","0"),a.setAttributeNS(null,"y",p(-n)),a.setAttributeNS(null,"width",p(r)+"px"),a.setAttributeNS(null,"height",p(n)+"px"),a.setAttributeNS(null,"transform",`scale(${p(1/r)} ${p(-1/n)})`),t?t.appendChild(a):this._ensureTransformGroup().appendChild(a)}paintImageMaskXObject(e){const t=this.current,r=e.width,n=e.height,i=t.fillColor;t.maskId="mask"+b++;const o=this.svgFactory.createElement("svg:mask");o.setAttributeNS(null,"id",t.maskId);const a=this.svgFactory.createElement("svg:rect");a.setAttributeNS(null,"x","0"),a.setAttributeNS(null,"y","0"),a.setAttributeNS(null,"width",p(r)),a.setAttributeNS(null,"height",p(n)),a.setAttributeNS(null,"fill",i),a.setAttributeNS(null,"mask",`url(#${t.maskId})`),this.defs.appendChild(o),this._ensureTransformGroup().appendChild(a),this.paintInlineImageXObject(e,o)}paintFormXObjectBegin(e,t){if(Array.isArray(e)&&6===e.length&&this.transform(e[0],e[1],e[2],e[3],e[4],e[5]),t){const e=t[2]-t[0],r=t[3]-t[1],n=this.svgFactory.createElement("svg:rect");n.setAttributeNS(null,"x",t[0]),n.setAttributeNS(null,"y",t[1]),n.setAttributeNS(null,"width",p(e)),n.setAttributeNS(null,"height",p(r)),this.current.element=n,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(e){const t=this.svgFactory.create(e.width,e.height),r=this.svgFactory.createElement("svg:defs");t.appendChild(r),this.defs=r;const n=this.svgFactory.createElement("svg:g");return n.setAttributeNS(null,"transform",m(e.transform)),t.appendChild(n),this.svg=n,t}_ensureClipGroup(){if(!this.current.clipGroup){const e=this.svgFactory.createElement("svg:g");e.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.appendChild(e),this.current.clipGroup=e}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",m(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().appendChild(this.tgrp):this.svg.appendChild(this.tgrp)),this.tgrp}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PDFNodeStream=void 0;var n=r(2),i=r(23);const o=__webpack_require__(5536),a=__webpack_require__(1061),s=__webpack_require__(9988),l=__webpack_require__(1760),c=/^file:\/\/\/[a-zA-Z]:\//;t.PDFNodeStream=class{constructor(e){this.source=e,this.url=function(e){const t=l.parse(e);return"file:"===t.protocol||t.host?t:/^[a-z]:[/\\]/i.test(e)?l.parse(`file:///${e}`):(t.host||(t.protocol="file:"),t)}(e.url),this.isHttp="http:"===this.url.protocol||"https:"===this.url.protocol,this.isFsUrl="file:"===this.url.protocol,this.httpHeaders=this.isHttp&&e.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?this._fullRequestReader._loaded:0}getFullReader(){return(0,n.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new p(this):new f(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const r=this.isFsUrl?new m(this,e,t):new g(this,e,t);return this._rangeRequestReaders.push(r),r}cancelAllRequests(e){this._fullRequestReader&&this._fullRequestReader.cancel(e),this._rangeRequestReaders.slice(0).forEach((function(t){t.cancel(e)}))}};class u{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null;const t=e.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=(0,n.createPromiseCapability)(),this._headersCapability=(0,n.createPromiseCapability)()}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return null===e?(this._readCapability=(0,n.createPromiseCapability)(),this.read()):(this._loaded+=e.length,this.onProgress&&this.onProgress({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){this._readableStream?this._readableStream.destroy(e):this._error(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",(()=>{this._readCapability.resolve()})),e.on("end",(()=>{e.destroy(),this._done=!0,this._readCapability.resolve()})),e.on("error",(e=>{this._error(e)})),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new n.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class h{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=(0,n.createPromiseCapability)();const t=e.source;this._isStreamingSupported=!t.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return null===e?(this._readCapability=(0,n.createPromiseCapability)(),this.read()):(this._loaded+=e.length,this.onProgress&&this.onProgress({loaded:this._loaded}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){this._readableStream?this._readableStream.destroy(e):this._error(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",(()=>{this._readCapability.resolve()})),e.on("end",(()=>{e.destroy(),this._done=!0,this._readCapability.resolve()})),e.on("error",(e=>{this._error(e)})),this._storedError&&this._readableStream.destroy(this._storedError)}}function d(e,t){return{protocol:e.protocol,auth:e.auth,host:e.hostname,port:e.port,path:e.path,method:"GET",headers:t}}class f extends u{constructor(e){super(e);const t=t=>{if(404===t.statusCode){const e=new n.MissingPDFException(`Missing PDF "${this._url}".`);return this._storedError=e,void this._headersCapability.reject(e)}this._headersCapability.resolve(),this._setReadableStream(t);const r=e=>this._readableStream.headers[e.toLowerCase()],{allowRangeRequests:o,suggestedLength:a}=(0,i.validateRangeRequestCapabilities)({getResponseHeader:r,isHttp:e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=o,this._contentLength=a||this._contentLength,this._filename=(0,i.extractFilenameFromHeader)(r)};this._request=null,"http:"===this._url.protocol?this._request=a.request(d(this._url,e.httpHeaders),t):this._request=s.request(d(this._url,e.httpHeaders),t),this._request.on("error",(e=>{this._storedError=e,this._headersCapability.reject(e)})),this._request.end()}}class g extends h{constructor(e,t,r){super(e),this._httpHeaders={};for(const n in e.httpHeaders){const t=e.httpHeaders[n];"undefined"!==typeof t&&(this._httpHeaders[n]=t)}this._httpHeaders.Range=`bytes=${t}-${r-1}`;const i=e=>{if(404!==e.statusCode)this._setReadableStream(e);else{const e=new n.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=e}};this._request=null,"http:"===this._url.protocol?this._request=a.request(d(this._url,this._httpHeaders),i):this._request=s.request(d(this._url,this._httpHeaders),i),this._request.on("error",(e=>{this._storedError=e})),this._request.end()}}class p extends u{constructor(e){super(e);let t=decodeURIComponent(this._url.path);c.test(this._url.href)&&(t=t.replace(/^\//,"")),o.lstat(t,((e,r)=>{if(e)return"ENOENT"===e.code&&(e=new n.MissingPDFException(`Missing PDF "${t}".`)),this._storedError=e,void this._headersCapability.reject(e);this._contentLength=r.size,this._setReadableStream(o.createReadStream(t)),this._headersCapability.resolve()}))}}class m extends h{constructor(e,t,r){super(e);let n=decodeURIComponent(this._url.path);c.test(this._url.href)&&(n=n.replace(/^\//,"")),this._setReadableStream(o.createReadStream(n,{start:t,end:r-1}))}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createResponseStatusError=function(e,t){return 404===e||0===e&&t.startsWith("file:")?new n.MissingPDFException('Missing PDF "'+t+'".'):new n.UnexpectedResponseException("Unexpected server response ("+e+') while retrieving PDF "'+t+'".',e)},t.extractFilenameFromHeader=function(e){const t=e("Content-Disposition");if(t){let e=(0,i.getFilenameFromContentDispositionHeader)(t);if(e.includes("%"))try{e=decodeURIComponent(e)}catch(r){}if(/\.pdf$/i.test(e))return e}return null},t.validateRangeRequestCapabilities=function(e){let{getResponseHeader:t,isHttp:r,rangeChunkSize:i,disableRange:o}=e;(0,n.assert)(i>0,"Range chunk size must be larger than zero");const a={allowRangeRequests:!1,suggestedLength:void 0},s=parseInt(t("Content-Length"),10);return Number.isInteger(s)?(a.suggestedLength=s,s<=2*i||o||!r||"bytes"!==t("Accept-Ranges")||"identity"!==(t("Content-Encoding")||"identity")||(a.allowRangeRequests=!0),a):a},t.validateResponseStatus=function(e){return 200===e||206===e};var n=r(2),i=r(24)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getFilenameFromContentDispositionHeader=function(e){let t=!0,r=n("filename\\*","i").exec(e);if(r){r=r[1];let e=a(r);return e=unescape(e),e=s(e),e=l(e),o(e)}if(r=function(e){const t=[];let r;const i=n("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;null!==(r=i.exec(e));){let[,e,n,i]=r;if(e=parseInt(e,10),e in t){if(0===e)break}else t[e]=[n,i]}const o=[];for(let n=0;n<t.length&&n in t;++n){let[e,r]=t[n];r=a(r),e&&(r=unescape(r),0===n&&(r=s(r))),o.push(r)}return o.join("")}(e),r)return o(l(r));if(r=n("filename","i").exec(e),r){r=r[1];let e=a(r);return e=l(e),o(e)}function n(e,t){return new RegExp("(?:^|;)\\s*"+e+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',t)}function i(e,r){if(e){if(!/^[\x00-\xFF]+$/.test(r))return r;try{const n=new TextDecoder(e,{fatal:!0}),i=Array.from(r,(function(e){return 255&e.charCodeAt(0)}));r=n.decode(new Uint8Array(i)),t=!1}catch(n){if(/^utf-?8$/i.test(e))try{r=decodeURIComponent(escape(r)),t=!1}catch(i){}}}return r}function o(e){return t&&/[\x80-\xff]/.test(e)&&(e=i("utf-8",e),t&&(e=i("iso-8859-1",e))),e}function a(e){if(e.startsWith('"')){const t=e.slice(1).split('\\"');for(let e=0;e<t.length;++e){const r=t[e].indexOf('"');-1!==r&&(t[e]=t[e].slice(0,r),t.length=e+1),t[e]=t[e].replace(/\\(.)/g,"$1")}e=t.join('"')}return e}function s(e){const t=e.indexOf("'");return-1===t?e:i(e.slice(0,t),e.slice(t+1).replace(/^[^']*'/,""))}function l(e){return!e.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(e)?e:e.replace(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,(function(e,t,r,n){if("q"===r||"Q"===r)return i(t,n=(n=n.replace(/_/g," ")).replace(/=([0-9a-fA-F]{2})/g,(function(e,t){return String.fromCharCode(parseInt(t,16))})));try{n=atob(n)}catch(o){}return i(t,n)}))}return""}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PDFNetworkStream=void 0;var n=r(2),i=r(23);class o{constructor(e,t){this.url=e,t=t||{},this.isHttp=/^https?:/i.test(e),this.httpHeaders=this.isHttp&&t.httpHeaders||{},this.withCredentials=t.withCredentials||!1,this.getXhr=t.getXhr||function(){return new XMLHttpRequest},this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(e,t,r){const n={begin:e,end:t};for(const i in r)n[i]=r[i];return this.request(n)}requestFull(e){return this.request(e)}request(e){const t=this.getXhr(),r=this.currXhrId++,n=this.pendingRequests[r]={xhr:t};t.open("GET",this.url),t.withCredentials=this.withCredentials;for(const i in this.httpHeaders){const e=this.httpHeaders[i];"undefined"!==typeof e&&t.setRequestHeader(i,e)}return this.isHttp&&"begin"in e&&"end"in e?(t.setRequestHeader("Range",`bytes=${e.begin}-${e.end-1}`),n.expectedStatus=206):n.expectedStatus=200,t.responseType="arraybuffer",e.onError&&(t.onerror=function(r){e.onError(t.status)}),t.onreadystatechange=this.onStateChange.bind(this,r),t.onprogress=this.onProgress.bind(this,r),n.onHeadersReceived=e.onHeadersReceived,n.onDone=e.onDone,n.onError=e.onError,n.onProgress=e.onProgress,t.send(null),r}onProgress(e,t){const r=this.pendingRequests[e];r&&r.onProgress&&r.onProgress(t)}onStateChange(e,t){const r=this.pendingRequests[e];if(!r)return;const i=r.xhr;if(i.readyState>=2&&r.onHeadersReceived&&(r.onHeadersReceived(),delete r.onHeadersReceived),4!==i.readyState)return;if(!(e in this.pendingRequests))return;if(delete this.pendingRequests[e],0===i.status&&this.isHttp)return void(r.onError&&r.onError(i.status));const o=i.status||200;if((200!==o||206!==r.expectedStatus)&&o!==r.expectedStatus)return void(r.onError&&r.onError(i.status));const a=function(e){const t=e.response;return"string"!==typeof t?t:(0,n.stringToBytes)(t).buffer}(i);if(206===o){const e=i.getResponseHeader("Content-Range"),t=/bytes (\d+)-(\d+)\/(\d+)/.exec(e);r.onDone({begin:parseInt(t[1],10),chunk:a})}else a?r.onDone({begin:0,chunk:a}):r.onError&&r.onError(i.status)}getRequestXhr(e){return this.pendingRequests[e].xhr}isPendingRequest(e){return e in this.pendingRequests}abortRequest(e){const t=this.pendingRequests[e].xhr;delete this.pendingRequests[e],t.abort()}}t.PDFNetworkStream=class{constructor(e){this._source=e,this._manager=new o(e.url,{httpHeaders:e.httpHeaders,withCredentials:e.withCredentials}),this._rangeChunkSize=e.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(e){const t=this._rangeRequestReaders.indexOf(e);t>=0&&this._rangeRequestReaders.splice(t,1)}getFullReader(){return(0,n.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new a(this._manager,this._source),this._fullRequestReader}getRangeReader(e,t){const r=new s(this._manager,e,t);return r.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(r),r}cancelAllRequests(e){this._fullRequestReader&&this._fullRequestReader.cancel(e),this._rangeRequestReaders.slice(0).forEach((function(t){t.cancel(e)}))}};class a{constructor(e,t){this._manager=e;const r={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=t.url,this._fullRequestId=e.requestFull(r),this._headersReceivedCapability=(0,n.createPromiseCapability)(),this._disableRange=t.disableRange||!1,this._contentLength=t.length,this._rangeChunkSize=t.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const e=this._fullRequestId,t=this._manager.getRequestXhr(e),r=e=>t.getResponseHeader(e),{allowRangeRequests:n,suggestedLength:o}=(0,i.validateRangeRequestCapabilities)({getResponseHeader:r,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});n&&(this._isRangeSupported=!0),this._contentLength=o||this._contentLength,this._filename=(0,i.extractFilenameFromHeader)(r),this._isRangeSupported&&this._manager.abortRequest(e),this._headersReceivedCapability.resolve()}_onDone(e){e&&(this._requests.length>0?this._requests.shift().resolve({value:e.chunk,done:!1}):this._cachedChunks.push(e.chunk)),this._done=!0,this._cachedChunks.length>0||(this._requests.forEach((function(e){e.resolve({value:void 0,done:!0})})),this._requests=[])}_onError(e){const t=this._url,r=(0,i.createResponseStatusError)(e,t);this._storedError=r,this._headersReceivedCapability.reject(r),this._requests.forEach((function(e){e.reject(r)})),this._requests=[],this._cachedChunks=[]}_onProgress(e){this.onProgress&&this.onProgress({loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=(0,n.createPromiseCapability)();return this._requests.push(e),e.promise}cancel(e){this._done=!0,this._headersReceivedCapability.reject(e),this._requests.forEach((function(e){e.resolve({value:void 0,done:!0})})),this._requests=[],this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class s{constructor(e,t,r){this._manager=e;const n={onDone:this._onDone.bind(this),onProgress:this._onProgress.bind(this)};this._requestId=e.requestRange(t,r,n),this._requests=[],this._queuedChunk=null,this._done=!1,this.onProgress=null,this.onClosed=null}_close(){this.onClosed&&this.onClosed(this)}_onDone(e){const t=e.chunk;this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0,this._requests.forEach((function(e){e.resolve({value:void 0,done:!0})})),this._requests=[],this._close()}_onProgress(e){!this.isStreamingSupported&&this.onProgress&&this.onProgress({loaded:e.loaded})}get isStreamingSupported(){return!1}async read(){if(null!==this._queuedChunk){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const e=(0,n.createPromiseCapability)();return this._requests.push(e),e.promise}cancel(e){this._done=!0,this._requests.forEach((function(e){e.resolve({value:void 0,done:!0})})),this._requests=[],this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PDFFetchStream=void 0;var n=r(2),i=r(23);function o(e,t,r){return{method:"GET",headers:e,signal:r&&r.signal,mode:"cors",credentials:t?"include":"same-origin",redirect:"follow"}}function a(e){const t=new Headers;for(const r in e){const n=e[r];"undefined"!==typeof n&&t.append(r,n)}return t}t.PDFFetchStream=class{constructor(e){this.source=e,this.isHttp=/^https?:/i.test(e.url),this.httpHeaders=this.isHttp&&e.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?this._fullRequestReader._loaded:0}getFullReader(){return(0,n.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new s(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const r=new l(this,e,t);return this._rangeRequestReaders.push(r),r}cancelAllRequests(e){this._fullRequestReader&&this._fullRequestReader.cancel(e),this._rangeRequestReaders.slice(0).forEach((function(t){t.cancel(e)}))}};class s{constructor(e){this._stream=e,this._reader=null,this._loaded=0,this._filename=null;const t=e.source;this._withCredentials=t.withCredentials||!1,this._contentLength=t.length,this._headersCapability=(0,n.createPromiseCapability)(),this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),"undefined"!==typeof AbortController&&(this._abortController=new AbortController),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._headers=a(this._stream.httpHeaders);const r=t.url;fetch(r,o(this._headers,this._withCredentials,this._abortController)).then((e=>{if(!(0,i.validateResponseStatus)(e.status))throw(0,i.createResponseStatusError)(e.status,r);this._reader=e.body.getReader(),this._headersCapability.resolve();const t=t=>e.headers.get(t),{allowRangeRequests:o,suggestedLength:a}=(0,i.validateRangeRequestCapabilities)({getResponseHeader:t,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=o,this._contentLength=a||this._contentLength,this._filename=(0,i.extractFilenameFromHeader)(t),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new n.AbortException("Streaming is disabled."))})).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,this.onProgress&&this.onProgress({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){this._reader&&this._reader.cancel(e),this._abortController&&this._abortController.abort()}}class l{constructor(e,t,r){this._stream=e,this._reader=null,this._loaded=0;const s=e.source;this._withCredentials=s.withCredentials||!1,this._readCapability=(0,n.createPromiseCapability)(),this._isStreamingSupported=!s.disableStream,"undefined"!==typeof AbortController&&(this._abortController=new AbortController),this._headers=a(this._stream.httpHeaders),this._headers.append("Range",`bytes=${t}-${r-1}`);const l=s.url;fetch(l,o(this._headers,this._withCredentials,this._abortController)).then((e=>{if(!(0,i.validateResponseStatus)(e.status))throw(0,i.createResponseStatusError)(e.status,l);this._readCapability.resolve(),this._reader=e.body.getReader()})).catch((e=>{if(!e||"AbortError"!==e.name)throw e})),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,this.onProgress&&this.onProgress({loaded:this._loaded}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){this._reader&&this._reader.cancel(e),this._abortController&&this._abortController.abort()}}}])},module.exports=factory()},1542:(e,t,r)=>{("undefined"!==typeof window?window:{}).pdfjsWorker=r(7188)},7188:function(e){var t;t=function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"WorkerMessageHandler",{enumerable:!0,get:function(){return n.WorkerMessageHandler}});var n=r(1)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WorkerMessageHandler=t.WorkerTask=void 0;var n,i=r(2),o=r(5),a=r(6),s=r(27),l=r(4),c=r(47),u=r(48),h=r(8);class d{constructor(e){this.name=e,this.terminated=!1,this._capability=(0,i.createPromiseCapability)()}get finished(){return this._capability.promise}finish(){this._capability.resolve()}terminate(){this.terminated=!0}ensureNotTerminated(){if(this.terminated)throw new Error("Worker task was terminated")}}t.WorkerTask=d;class f{static setup(e,t){var r=!1;e.on("test",(function(t){if(r)return;if(r=!0,!(t instanceof Uint8Array))return void e.send("test",null);const n=255===t[0];e.postMessageTransfers=n,e.send("test",{supportTransfers:n})})),e.on("configure",(function(e){(0,i.setVerbosityLevel)(e.verbosity)})),e.on("GetDocRequest",(function(e){return f.createDocumentHandler(e,t)}))}static createDocumentHandler(e,t){var r,n=!1,l=null,f=[];const g=(0,i.getVerbosityLevel)(),p=e.apiVersion,m="2.7.39";if(p!==m)throw new Error(`The API version "${p}" does not match the Worker version "${m}".`);const v=[];for(const i in[])v.push(i);if(v.length)throw new Error("The `Array.prototype` contains unexpected enumerable properties: "+v.join(", ")+"; thus breaking e.g. `for...in` iteration of `Array`s.");if("undefined"===typeof ReadableStream||"undefined"===typeof Promise.allSettled)throw new Error("The browser/environment lacks native support for critical functionality used by the PDF.js library (e.g. `ReadableStream` and/or `Promise.allSettled`); please use an ES5-compatible build instead.");var b=e.docId,y=e.docBaseUrl,w=e.docId+"_worker",S=new c.MessageHandler(w,b,t);function C(){if(n)throw new Error("Worker was terminated")}function k(e){f.push(e)}function x(e){e.finish();var t=f.indexOf(e);f.splice(t,1)}async function E(e){await r.ensureDoc("checkHeader"),await r.ensureDoc("parseStartXRef"),await r.ensureDoc("parse",[e]),e||await r.ensureDoc("checkFirstPage");const[t,n]=await Promise.all([r.ensureDoc("numPages"),r.ensureDoc("fingerprint")]);return{numPages:t,fingerprint:n}}function T(e,t){var r=(0,i.createPromiseCapability)();let n;var o=e.source;if(o.data){try{n=new a.LocalPdfManager(b,o.data,o.password,t,y),r.resolve(n)}catch(f){r.reject(f)}return r.promise}var s,c=[];try{s=new u.PDFWorkerStream(S)}catch(f){return r.reject(f),r.promise}var h=s.getFullReader();h.headersReady.then((function(){if(h.isRangeSupported){var e=o.disableAutoFetch||h.isStreamingSupported;n=new a.NetworkPdfManager(b,s,{msgHandler:S,password:o.password,length:h.contentLength,disableAutoFetch:e,rangeChunkSize:o.rangeChunkSize},t,y);for(let e=0;e<c.length;e++)n.sendProgressiveData(c[e]);c=[],r.resolve(n),l=null}})).catch((function(e){r.reject(e),l=null}));var d=0;return new Promise((function(e,s){var u=function(e){let{value:g,done:p}=e;try{if(C(),p)return n||function(){var e=(0,i.arraysToBytes)(c);o.length&&e.length!==o.length&&(0,i.warn)("reported HTTP length is different from actual");try{n=new a.LocalPdfManager(b,e,o.password,t,y),r.resolve(n)}catch(f){r.reject(f)}c=[]}(),void(l=null);d+=(0,i.arrayByteLength)(g),h.isStreamingSupported||S.send("DocProgress",{loaded:d,total:Math.max(d,h.contentLength||0)}),n?n.sendProgressiveData(g):c.push(g),h.read().then(u,s)}catch(m){s(m)}};h.read().then(u,s)})).catch((function(e){r.reject(e),l=null})),l=function(e){s.cancelAllRequests(e)},r.promise}return S.postMessageTransfers=e.postMessageTransfers,S.on("GetPage",(function(e){return r.getPage(e.pageIndex).then((function(e){return Promise.all([r.ensure(e,"rotate"),r.ensure(e,"ref"),r.ensure(e,"userUnit"),r.ensure(e,"view")]).then((function(e){let[t,r,n,i]=e;return{rotate:t,ref:r,userUnit:n,view:i}}))}))})),S.on("GetPageIndex",(function(e){let{ref:t}=e;const n=o.Ref.get(t.num,t.gen);return r.ensureCatalog("getPageIndex",[n])})),S.on("GetDestinations",(function(e){return r.ensureCatalog("destinations")})),S.on("GetDestination",(function(e){return r.ensureCatalog("getDestination",[e.id])})),S.on("GetPageLabels",(function(e){return r.ensureCatalog("pageLabels")})),S.on("GetPageLayout",(function(e){return r.ensureCatalog("pageLayout")})),S.on("GetPageMode",(function(e){return r.ensureCatalog("pageMode")})),S.on("GetViewerPreferences",(function(e){return r.ensureCatalog("viewerPreferences")})),S.on("GetOpenAction",(function(e){return r.ensureCatalog("openAction")})),S.on("GetAttachments",(function(e){return r.ensureCatalog("attachments")})),S.on("GetJavaScript",(function(e){return r.ensureCatalog("javaScript")})),S.on("GetOutline",(function(e){return r.ensureCatalog("documentOutline")})),S.on("GetOptionalContentConfig",(function(e){return r.ensureCatalog("optionalContentConfig")})),S.on("GetPermissions",(function(e){return r.ensureCatalog("permissions")})),S.on("GetMetadata",(function(e){return Promise.all([r.ensureDoc("documentInfo"),r.ensureCatalog("metadata")])})),S.on("GetData",(function(e){return r.requestLoadedStream(),r.onLoadedStream().then((function(e){return e.bytes}))})),S.on("GetStats",(function(e){return r.ensureXRef("stats")})),S.on("GetXFA",(function(e){const t=r.pdfDocument.xref;return r.ensureCatalog("acroForm").then((function(e){let r=e.get("XFA"),n=[];for(let i=0;i<r.length;i++)if(i%2==0){const e=t.fetch(r[i+1]).getBytes();n[r[i]]=(new TextDecoder).decode(e)}return n}))})),S.on("GetAnnotations",(function(e){let{pageIndex:t,intent:n}=e;return r.getPage(t).then((function(e){return e.getAnnotationsData(n)}))})),S.on("SaveDocument",(function(e){let{numPages:t,annotationStorage:n,filename:a}=e;r.requestLoadedStream();const l=[r.onLoadedStream(),r.ensureCatalog("acroForm")],c=r.pdfDocument;for(let i=0;i<t;i++)l.push(r.getPage(i).then((function(e){const t=new d(`Save: page ${i}`);return e.save(S,t,n)})));return Promise.all(l).then((e=>{let[t,r,...n]=e,l=[];for(const i of n)l=i.filter((e=>null!==e)).reduce(((e,t)=>e.concat(t)),l);if(0===l.length)return t.bytes;r=(0,o.isDict)(r)?r:o.Dict.empty;const u=r.get("XFA")||[];let h=null;if(Array.isArray(u))for(let i=0,o=u.length;i<o;i+=2)"datasets"===u[i]&&(h=u[i+1]);else(0,i.warn)("Unsupported XFA type.");const d=c.xref;let f=Object.create(null);if(d.trailer){const e=Object.create(null),t=d.trailer.get("Info")||null;t&&t.forEach(((t,r)=>{(0,i.isString)(t)&&(0,i.isString)(r)&&(e[t]=(0,i.stringToPDFString)(r))})),f={rootRef:d.trailer.getRaw("Root")||null,encrypt:d.trailer.getRaw("Encrypt")||null,newRef:d.getNewRef(),infoRef:d.trailer.getRaw("Info")||null,info:e,fileIds:d.trailer.getRaw("ID")||null,startXRef:c.startXRef,filename:a}}return d.resetNewRef(),(0,s.incrementalUpdate)({originalData:t.bytes,xrefInfo:f,newRefs:l,xref:d,datasetsRef:h})}))})),S.on("GetOperatorList",(function(e,t){var n=e.pageIndex;r.getPage(n).then((function(r){var o=new d(`GetOperatorList: page ${n}`);k(o);const a=g>=i.VerbosityLevel.INFOS?Date.now():0;r.getOperatorList({handler:S,sink:t,task:o,intent:e.intent,renderInteractiveForms:e.renderInteractiveForms,annotationStorage:e.annotationStorage}).then((function(e){x(o),a&&(0,i.info)(`page=${n+1} - getOperatorList: time=${Date.now()-a}ms, len=${e.length}`),t.close()}),(function(e){x(o),o.terminated||(S.send("UnsupportedFeature",{featureId:i.UNSUPPORTED_FEATURES.errorOperatorList}),t.error(e))}))}))}),this),S.on("GetTextContent",(function(e,t){var n=e.pageIndex;t.onPull=function(e){},t.onCancel=function(e){},r.getPage(n).then((function(r){var o=new d("GetTextContent: page "+n);k(o);const a=g>=i.VerbosityLevel.INFOS?Date.now():0;r.extractTextContent({handler:S,task:o,sink:t,normalizeWhitespace:e.normalizeWhitespace,combineTextItems:e.combineTextItems}).then((function(){x(o),a&&(0,i.info)(`page=${n+1} - getTextContent: time=`+(Date.now()-a)+"ms"),t.close()}),(function(e){x(o),o.terminated||t.error(e)}))}))})),S.on("FontFallback",(function(e){return r.fontFallback(e.id,S)})),S.on("Cleanup",(function(e){return r.cleanup(!0)})),S.on("Terminate",(function(e){n=!0;const t=[];if(r){r.terminate(new i.AbortException("Worker was terminated."));const e=r.cleanup();t.push(e),r=null}else(0,o.clearPrimitiveCaches)();return l&&l(new i.AbortException("Worker was terminated.")),f.forEach((function(e){t.push(e.finished),e.terminate()})),Promise.all(t).then((function(){S.destroy(),S=null}))})),S.on("Ready",(function(t){!function(e){function t(e){C(),S.send("GetDoc",{pdfInfo:e})}function o(e){if(C(),e instanceof i.PasswordException){var t=new d(`PasswordException: response ${e.code}`);k(t),S.sendWithPromise("PasswordRequest",e).then((function(e){let{password:n}=e;x(t),r.updatePassword(n),a()})).catch((function(){x(t),S.send("DocException",e)}))}else e instanceof i.InvalidPDFException||e instanceof i.MissingPDFException||e instanceof i.UnexpectedResponseException||e instanceof i.UnknownErrorException?S.send("DocException",e):S.send("DocException",new i.UnknownErrorException(e.message,e.toString()))}function a(){C(),E(!1).then(t,(function(e){C(),e instanceof h.XRefParseException?(r.requestLoadedStream(),r.onLoadedStream().then((function(){C(),E(!0).then(t,o)}))):o(e)}))}C(),T(e,{maxImageSize:e.maxImageSize,disableFontFace:e.disableFontFace,ignoreErrors:e.ignoreErrors,isEvalSupported:e.isEvalSupported,fontExtraProperties:e.fontExtraProperties}).then((function(e){if(n)throw e.terminate(new i.AbortException("Worker was terminated.")),new Error("Worker was terminated");(r=e).onLoadedStream().then((function(e){S.send("DataLoaded",{length:e.bytes.byteLength})}))})).then(a,o)}(e),e=null})),w}static initializeFromPort(e){var t=new c.MessageHandler("worker","main",e);f.setup(t,e),t.send("ready",null)}}t.WorkerMessageHandler=f,"undefined"===typeof window&&!l.isNodeJS&&"undefined"!==typeof self&&"function"===typeof(n=self).postMessage&&"onmessage"in n&&f.initializeFromPort(self)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.arrayByteLength=d,t.arraysToBytes=function(e){const t=e.length;if(1===t&&e[0]instanceof Uint8Array)return e[0];let r=0;for(let o=0;o<t;o++)r+=d(e[o]);let n=0;const i=new Uint8Array(r);for(let o=0;o<t;o++){let t=e[o];t instanceof Uint8Array||(t="string"===typeof t?h(t):new Uint8Array(t));const r=t.byteLength;i.set(t,n),n+=r}return i},t.assert=s,t.bytesToString=function(e){s(null!==e&&"object"===typeof e&&void 0!==e.length,"Invalid argument for bytesToString");const t=e.length,r=8192;if(t<r)return String.fromCharCode.apply(null,e);const n=[];for(let i=0;i<t;i+=r){const o=Math.min(i+r,t),a=e.subarray(i,o);n.push(String.fromCharCode.apply(null,a))}return n.join("")},t.createPromiseCapability=function(){const e=Object.create(null);let t=!1;return Object.defineProperty(e,"settled",{get:()=>t}),e.promise=new Promise((function(r,n){e.resolve=function(e){t=!0,r(e)},e.reject=function(e){t=!0,n(e)}})),e},t.escapeString=function(e){return e.replace(/([\(\)\\])/g,"\\$1")},t.encodeToXmlString=function(e){const t=[];let r=0;for(let n=0,i=e.length;n<i;n++){const i=e.codePointAt(n);if(32<=i&&i<=126){const o=y[i];o&&(r<n&&t.push(e.substring(r,n)),t.push(o),r=n+1)}else r<n&&t.push(e.substring(r,n)),t.push(`&#x${i.toString(16).toUpperCase()};`),i>55295&&(i<57344||i>65533)&&n++,r=n+1}return 0===t.length?e:(r<e.length&&t.push(e.substring(r,e.length)),t.join(""))},t.getModificationDate=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Date;return[e.getUTCFullYear().toString(),(e.getUTCMonth()+1).toString().padStart(2,"0"),e.getUTCDate().toString().padStart(2,"0"),e.getUTCHours().toString().padStart(2,"0"),e.getUTCMinutes().toString().padStart(2,"0"),e.getUTCSeconds().toString().padStart(2,"0")].join("")},t.getVerbosityLevel=function(){return i},t.info=function(e){i>=n.INFOS&&console.log(`Info: ${e}`)},t.isArrayBuffer=function(e){return"object"===typeof e&&null!==e&&void 0!==e.byteLength},t.isArrayEqual=function(e,t){return e.length===t.length&&e.every((function(e,r){return e===t[r]}))},t.isBool=function(e){return"boolean"===typeof e},t.isNum=function(e){return"number"===typeof e},t.isString=function(e){return"string"===typeof e},t.isSameOrigin=function(e,t){let r;try{if(r=new URL(e),!r.origin||"null"===r.origin)return!1}catch(i){return!1}const n=new URL(t,r);return r.origin===n.origin},t.createValidAbsoluteUrl=function(e,t){if(!e)return null;try{const r=t?new URL(e,t):new URL(e);if(function(e){if(!e)return!1;switch(e.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}(r))return r}catch(r){}return null},t.removeNullCharacters=function(e){return"string"!==typeof e?(o("The argument for removeNullCharacters must be a string."),e):e.replace(u,"")},t.setVerbosityLevel=function(e){Number.isInteger(e)&&(i=e)},t.shadow=l,t.string32=function(e){return String.fromCharCode(e>>24&255,e>>16&255,e>>8&255,255&e)},t.stringToBytes=h,t.stringToPDFString=function(e){const t=e.length,r=[];if("\xfe"===e[0]&&"\xff"===e[1])for(let n=2;n<t;n+=2)r.push(String.fromCharCode(e.charCodeAt(n)<<8|e.charCodeAt(n+1)));else if("\xff"===e[0]&&"\xfe"===e[1])for(let n=2;n<t;n+=2)r.push(String.fromCharCode(e.charCodeAt(n+1)<<8|e.charCodeAt(n)));else for(let n=0;n<t;++n){const t=v[e.charCodeAt(n)];r.push(t?String.fromCharCode(t):e.charAt(n))}return r.join("")},t.stringToUTF8String=function(e){return decodeURIComponent(escape(e))},t.utf8StringToString=function(e){return unescape(encodeURIComponent(e))},t.warn=o,t.unreachable=a,t.IsEvalSupportedCached=t.IsLittleEndianCached=t.createObjectURL=t.FormatError=t.Util=t.UnknownErrorException=t.UnexpectedResponseException=t.TextRenderingMode=t.StreamType=t.PermissionFlag=t.PasswordResponses=t.PasswordException=t.MissingPDFException=t.InvalidPDFException=t.AbortException=t.CMapCompressionType=t.ImageKind=t.FontType=t.AnnotationType=t.AnnotationStateModelType=t.AnnotationReviewState=t.AnnotationReplyType=t.AnnotationMarkedState=t.AnnotationFlag=t.AnnotationFieldFlag=t.AnnotationBorderStyleType=t.UNSUPPORTED_FEATURES=t.VerbosityLevel=t.OPS=t.IDENTITY_MATRIX=t.FONT_IDENTITY_MATRIX=t.BaseException=void 0,r(3),t.IDENTITY_MATRIX=[1,0,0,1,0,0],t.FONT_IDENTITY_MATRIX=[.001,0,0,.001,0,0],t.PermissionFlag={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},t.TextRenderingMode={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},t.ImageKind={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},t.AnnotationType={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},t.AnnotationStateModelType={MARKED:"Marked",REVIEW:"Review"},t.AnnotationMarkedState={MARKED:"Marked",UNMARKED:"Unmarked"},t.AnnotationReviewState={ACCEPTED:"Accepted",REJECTED:"Rejected",CANCELLED:"Cancelled",COMPLETED:"Completed",NONE:"None"},t.AnnotationReplyType={GROUP:"Group",REPLY:"R"},t.AnnotationFlag={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512},t.AnnotationFieldFlag={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864},t.AnnotationBorderStyleType={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},t.StreamType={UNKNOWN:"UNKNOWN",FLATE:"FLATE",LZW:"LZW",DCT:"DCT",JPX:"JPX",JBIG:"JBIG",A85:"A85",AHX:"AHX",CCF:"CCF",RLX:"RLX"},t.FontType={UNKNOWN:"UNKNOWN",TYPE1:"TYPE1",TYPE1C:"TYPE1C",CIDFONTTYPE0:"CIDFONTTYPE0",CIDFONTTYPE0C:"CIDFONTTYPE0C",TRUETYPE:"TRUETYPE",CIDFONTTYPE2:"CIDFONTTYPE2",TYPE3:"TYPE3",OPENTYPE:"OPENTYPE",TYPE0:"TYPE0",MMTYPE1:"MMTYPE1"};const n={ERRORS:0,WARNINGS:1,INFOS:5};t.VerbosityLevel=n,t.CMapCompressionType={NONE:0,BINARY:1,STREAM:2},t.OPS={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotations:78,endAnnotations:79,beginAnnotation:80,endAnnotation:81,paintJpegXObject:82,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91},t.UNSUPPORTED_FEATURES={unknown:"unknown",forms:"forms",javaScript:"javaScript",smask:"smask",shadingPattern:"shadingPattern",font:"font",errorTilingPattern:"errorTilingPattern",errorExtGState:"errorExtGState",errorXObject:"errorXObject",errorFontLoadType3:"errorFontLoadType3",errorFontState:"errorFontState",errorFontMissing:"errorFontMissing",errorFontTranslate:"errorFontTranslate",errorColorSpace:"errorColorSpace",errorOperatorList:"errorOperatorList",errorFontToUnicode:"errorFontToUnicode",errorFontLoadNative:"errorFontLoadNative",errorFontGetPath:"errorFontGetPath",errorMarkedContent:"errorMarkedContent"},t.PasswordResponses={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let i=n.WARNINGS;function o(e){i>=n.WARNINGS&&console.log(`Warning: ${e}`)}function a(e){throw new Error(e)}function s(e,t){e||a(t)}function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!1}),r}const c=function(){function e(t){this.constructor===e&&a("Cannot initialize BaseException."),this.message=t,this.name=this.constructor.name}return e.prototype=new Error,e.constructor=e,e}();t.BaseException=c,t.PasswordException=class extends c{constructor(e,t){super(e),this.code=t}},t.UnknownErrorException=class extends c{constructor(e,t){super(e),this.details=t}},t.InvalidPDFException=class extends c{},t.MissingPDFException=class extends c{},t.UnexpectedResponseException=class extends c{constructor(e,t){super(e),this.status=t}},t.FormatError=class extends c{},t.AbortException=class extends c{};const u=/\x00/g;function h(e){s("string"===typeof e,"Invalid argument for stringToBytes");const t=e.length,r=new Uint8Array(t);for(let n=0;n<t;++n)r[n]=255&e.charCodeAt(n);return r}function d(e){return void 0!==e.length?e.length:(s(void 0!==e.byteLength,"arrayByteLength - invalid argument."),e.byteLength)}const f={get value(){return l(this,"value",function(){const e=new Uint8Array(4);return e[0]=1,1===new Uint32Array(e.buffer,0,1)[0]}())}};t.IsLittleEndianCached=f;const g={get value(){return l(this,"value",function(){try{return new Function(""),!0}catch(e){return!1}}())}};t.IsEvalSupportedCached=g;const p=["rgb(",0,",",0,",",0,")"];class m{static makeCssRgb(e,t,r){return p[1]=e,p[3]=t,p[5]=r,p.join("")}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static applyTransform(e,t){return[e[0]*t[0]+e[1]*t[2]+t[4],e[0]*t[1]+e[1]*t[3]+t[5]]}static applyInverseTransform(e,t){const r=t[0]*t[3]-t[1]*t[2];return[(e[0]*t[3]-e[1]*t[2]+t[2]*t[5]-t[4]*t[3])/r,(-e[0]*t[1]+e[1]*t[0]+t[4]*t[1]-t[5]*t[0])/r]}static getAxialAlignedBoundingBox(e,t){const r=m.applyTransform(e,t),n=m.applyTransform(e.slice(2,4),t),i=m.applyTransform([e[0],e[3]],t),o=m.applyTransform([e[2],e[1]],t);return[Math.min(r[0],n[0],i[0],o[0]),Math.min(r[1],n[1],i[1],o[1]),Math.max(r[0],n[0],i[0],o[0]),Math.max(r[1],n[1],i[1],o[1])]}static inverseTransform(e){const t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static apply3dTransform(e,t){return[e[0]*t[0]+e[1]*t[1]+e[2]*t[2],e[3]*t[0]+e[4]*t[1]+e[5]*t[2],e[6]*t[0]+e[7]*t[1]+e[8]*t[2]]}static singularValueDecompose2dScale(e){const t=[e[0],e[2],e[1],e[3]],r=e[0]*t[0]+e[1]*t[2],n=e[0]*t[1]+e[1]*t[3],i=e[2]*t[0]+e[3]*t[2],o=e[2]*t[1]+e[3]*t[3],a=(r+o)/2,s=Math.sqrt((r+o)*(r+o)-4*(r*o-i*n))/2,l=a+s||1,c=a-s||1;return[Math.sqrt(l),Math.sqrt(c)]}static normalizeRect(e){const t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){function r(e,t){return e-t}const n=[e[0],e[2],t[0],t[2]].sort(r),i=[e[1],e[3],t[1],t[3]].sort(r),o=[];return e=m.normalizeRect(e),t=m.normalizeRect(t),n[0]===e[0]&&n[1]===t[0]||n[0]===t[0]&&n[1]===e[0]?(o[0]=n[1],o[2]=n[2],i[0]===e[1]&&i[1]===t[1]||i[0]===t[1]&&i[1]===e[1]?(o[1]=i[1],o[3]=i[2],o):null):null}}t.Util=m;const v=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364],b=function(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";return function(t,r){if(!(arguments.length>2&&void 0!==arguments[2]&&arguments[2])&&URL.createObjectURL){const e=new Blob([t],{type:r});return URL.createObjectURL(e)}let n=`data:${r};base64,`;for(let i=0,o=t.length;i<o;i+=3){const r=255&t[i],a=255&t[i+1],s=255&t[i+2];n+=e[r>>2]+e[(3&r)<<4|a>>4]+e[i+1<o?(15&a)<<2|s>>6:64]+e[i+2<o?63&s:64]}return n}}();t.createObjectURL=b;const y={60:"&lt;",62:"&gt;",38:"&amp;",34:"&quot;",39:"&apos;"}},function(e,t,r){"use strict";r(4)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isNodeJS=void 0;const n="object"===typeof process&&process+""==="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&"browser"!==process.type);t.isNodeJS=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.clearPrimitiveCaches=function(){o._clearCache(),i._clearCache(),s._clearCache()},t.isEOF=function(e){return e===n},t.isCmd=function(e,t){return e instanceof o&&(void 0===t||e.cmd===t)},t.isDict=function(e,t){return e instanceof a&&(void 0===t||l(e.get("Type"),t))},t.isName=l,t.isRef=function(e){return e instanceof s},t.isRefsEqual=function(e,t){return e.num===t.num&&e.gen===t.gen},t.isStream=function(e){return"object"===typeof e&&null!==e&&void 0!==e.getBytes},t.RefSetCache=t.RefSet=t.Ref=t.Name=t.Dict=t.Cmd=t.EOF=void 0,r(2);var n={};t.EOF=n;var i=function(){let e=Object.create(null);function t(e){this.name=e}return t.prototype={},t.get=function(r){var n=e[r];return n||(e[r]=new t(r))},t._clearCache=function(){e=Object.create(null)},t}();t.Name=i;var o=function(){let e=Object.create(null);function t(e){this.cmd=e}return t.prototype={},t.get=function(r){var n=e[r];return n||(e[r]=new t(r))},t._clearCache=function(){e=Object.create(null)},t}();t.Cmd=o;var a=function(){var e=function(){return e};function t(t){this._map=Object.create(null),this.xref=t,this.objId=null,this.suppressEncryption=!1,this.__nonSerializable__=e}return t.prototype={assignXref:function(e){this.xref=e},get size(){return Object.keys(this._map).length},get(e,t,r){let n=this._map[e];return void 0===n&&void 0!==t&&(n=this._map[t],void 0===n&&void 0!==r&&(n=this._map[r])),n instanceof s&&this.xref?this.xref.fetch(n,this.suppressEncryption):n},async getAsync(e,t,r){let n=this._map[e];return void 0===n&&void 0!==t&&(n=this._map[t],void 0===n&&void 0!==r&&(n=this._map[r])),n instanceof s&&this.xref?this.xref.fetchAsync(n,this.suppressEncryption):n},getArray(e,t,r){let n=this.get(e,t,r);if(!Array.isArray(n)||!this.xref)return n;n=n.slice();for(let i=0,o=n.length;i<o;i++)n[i]instanceof s&&(n[i]=this.xref.fetch(n[i],this.suppressEncryption));return n},getRaw:function(e){return this._map[e]},getKeys:function(){return Object.keys(this._map)},getRawValues:function(){return Object.values(this._map)},set:function(e,t){this._map[e]=t},has:function(e){return void 0!==this._map[e]},forEach:function(e){for(var t in this._map)e(t,this.get(t))}},t.empty=new t(null),t.merge=function(e){let{xref:r,dictArray:n,mergeSubDicts:i=!1}=e;const o=new t(r);if(!i){for(const e of n)if(e instanceof t)for(const[t,r]of Object.entries(e._map))void 0===o._map[t]&&(o._map[t]=r);return o.size>0?o:t.empty}const a=new Map;for(const s of n)if(s instanceof t)for(const[e,t]of Object.entries(s._map)){let r=a.get(e);void 0===r&&(r=[],a.set(e,r)),r.push(t)}for(const[s,l]of a){if(1===l.length||!(l[0]instanceof t)){o._map[s]=l[0];continue}const e=new t(r);for(const r of l)if(r instanceof t)for(const[t,n]of Object.entries(r._map))void 0===e._map[t]&&(e._map[t]=n);e.size>0&&(o._map[s]=e)}return a.clear(),o.size>0?o:t.empty},t}();t.Dict=a;var s=function(){let e=Object.create(null);function t(e,t){this.num=e,this.gen=t}return t.prototype={toString:function(){return 0===this.gen?`${this.num}R`:`${this.num}R${this.gen}`}},t.get=function(r,n){const i=0===n?`${r}R`:`${r}R${n}`,o=e[i];return o||(e[i]=new t(r,n))},t._clearCache=function(){e=Object.create(null)},t}();function l(e,t){return e instanceof i&&(void 0===t||e.name===t)}t.Ref=s,t.RefSet=class{constructor(){this._set=new Set}has(e){return this._set.has(e.toString())}put(e){this._set.add(e.toString())}remove(e){this._set.delete(e.toString())}},t.RefSetCache=class{constructor(){this._map=new Map}get size(){return this._map.size}get(e){return this._map.get(e.toString())}has(e){return this._map.has(e.toString())}put(e,t){this._map.set(e.toString(),t)}putAlias(e,t){this._map.set(e.toString(),this.get(t))}forEach(e){for(const t of this._map.values())e(t)}clear(){this._map.clear()}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NetworkPdfManager=t.LocalPdfManager=void 0;var n=r(2),i=r(7),o=r(8),a=r(9),s=r(12);class l{constructor(){this.constructor===l&&(0,n.unreachable)("Cannot initialize BasePdfManager.")}get docId(){return this._docId}get password(){return this._password}get docBaseUrl(){let e=null;if(this._docBaseUrl){const t=(0,n.createValidAbsoluteUrl)(this._docBaseUrl);t?e=t.href:(0,n.warn)(`Invalid absolute docBaseUrl: "${this._docBaseUrl}".`)}return(0,n.shadow)(this,"docBaseUrl",e)}onLoadedStream(){(0,n.unreachable)("Abstract method `onLoadedStream` called")}ensureDoc(e,t){return this.ensure(this.pdfDocument,e,t)}ensureXRef(e,t){return this.ensure(this.pdfDocument.xref,e,t)}ensureCatalog(e,t){return this.ensure(this.pdfDocument.catalog,e,t)}getPage(e){return this.pdfDocument.getPage(e)}fontFallback(e,t){return this.pdfDocument.fontFallback(e,t)}cleanup(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.pdfDocument.cleanup(e)}async ensure(e,t,r){(0,n.unreachable)("Abstract method `ensure` called")}requestRange(e,t){(0,n.unreachable)("Abstract method `requestRange` called")}requestLoadedStream(){(0,n.unreachable)("Abstract method `requestLoadedStream` called")}sendProgressiveData(e){(0,n.unreachable)("Abstract method `sendProgressiveData` called")}updatePassword(e){this._password=e}terminate(e){(0,n.unreachable)("Abstract method `terminate` called")}}t.LocalPdfManager=class extends l{constructor(e,t,r,n,i){super(),this._docId=e,this._password=r,this._docBaseUrl=i,this.evaluatorOptions=n;const o=new s.Stream(t);this.pdfDocument=new a.PDFDocument(this,o),this._loadedStreamPromise=Promise.resolve(o)}async ensure(e,t,r){const n=e[t];return"function"===typeof n?n.apply(e,r):n}requestRange(e,t){return Promise.resolve()}requestLoadedStream(){}onLoadedStream(){return this._loadedStreamPromise}terminate(e){}},t.NetworkPdfManager=class extends l{constructor(e,t,r,n,o){super(),this._docId=e,this._password=r.password,this._docBaseUrl=o,this.msgHandler=r.msgHandler,this.evaluatorOptions=n,this.streamManager=new i.ChunkedStreamManager(t,{msgHandler:r.msgHandler,length:r.length,disableAutoFetch:r.disableAutoFetch,rangeChunkSize:r.rangeChunkSize}),this.pdfDocument=new a.PDFDocument(this,this.streamManager.getStream())}async ensure(e,t,r){try{const n=e[t];return"function"===typeof n?n.apply(e,r):n}catch(n){if(!(n instanceof o.MissingDataException))throw n;return await this.requestRange(n.begin,n.end),this.ensure(e,t,r)}}requestRange(e,t){return this.streamManager.requestRange(e,t)}requestLoadedStream(){this.streamManager.requestAllChunks()}sendProgressiveData(e){this.streamManager.onReceiveData({chunk:e})}onLoadedStream(){return this.streamManager.onLoadedStream()}terminate(e){this.streamManager.abort(e)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ChunkedStreamManager=t.ChunkedStream=void 0;var n=r(2),i=r(8);class o{constructor(e,t,r){this.bytes=new Uint8Array(e),this.start=0,this.pos=0,this.end=e,this.chunkSize=t,this._loadedChunks=new Set,this.numChunks=Math.ceil(e/t),this.manager=r,this.progressiveDataLength=0,this.lastSuccessfulEnsureByteChunk=-1}getMissingChunks(){const e=[];for(let t=0,r=this.numChunks;t<r;++t)this._loadedChunks.has(t)||e.push(t);return e}getBaseStreams(){return[this]}get numChunksLoaded(){return this._loadedChunks.size}allChunksLoaded(){return this.numChunksLoaded===this.numChunks}onReceiveData(e,t){const r=this.chunkSize;if(e%r!==0)throw new Error(`Bad begin offset: ${e}`);const n=e+t.byteLength;if(n%r!==0&&n!==this.bytes.length)throw new Error(`Bad end offset: ${n}`);this.bytes.set(new Uint8Array(t),e);const i=Math.floor(e/r),o=Math.floor((n-1)/r)+1;for(let a=i;a<o;++a)this._loadedChunks.add(a)}onReceiveProgressiveData(e){let t=this.progressiveDataLength;const r=Math.floor(t/this.chunkSize);this.bytes.set(new Uint8Array(e),t),t+=e.byteLength,this.progressiveDataLength=t;const n=t>=this.end?this.numChunks:Math.floor(t/this.chunkSize);for(let i=r;i<n;++i)this._loadedChunks.add(i)}ensureByte(e){if(e<this.progressiveDataLength)return;const t=Math.floor(e/this.chunkSize);if(t!==this.lastSuccessfulEnsureByteChunk){if(!this._loadedChunks.has(t))throw new i.MissingDataException(e,e+1);this.lastSuccessfulEnsureByteChunk=t}}ensureRange(e,t){if(e>=t)return;if(t<=this.progressiveDataLength)return;const r=this.chunkSize,n=Math.floor(e/r),o=Math.floor((t-1)/r)+1;for(let a=n;a<o;++a)if(!this._loadedChunks.has(a))throw new i.MissingDataException(e,t)}nextEmptyChunk(e){const t=this.numChunks;for(let r=0;r<t;++r){const n=(e+r)%t;if(!this._loadedChunks.has(n))return n}return null}hasChunk(e){return this._loadedChunks.has(e)}get length(){return this.end-this.start}get isEmpty(){return 0===this.length}getByte(){const e=this.pos;return e>=this.end?-1:(e>=this.progressiveDataLength&&this.ensureByte(e),this.bytes[this.pos++])}getUint16(){const e=this.getByte(),t=this.getByte();return-1===e||-1===t?-1:(e<<8)+t}getInt32(){return(this.getByte()<<24)+(this.getByte()<<16)+(this.getByte()<<8)+this.getByte()}getBytes(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const r=this.bytes,n=this.pos,i=this.end;if(!e){i>this.progressiveDataLength&&this.ensureRange(n,i);const e=r.subarray(n,i);return t?new Uint8ClampedArray(e):e}let o=n+e;o>i&&(o=i),o>this.progressiveDataLength&&this.ensureRange(n,o),this.pos=o;const a=r.subarray(n,o);return t?new Uint8ClampedArray(a):a}peekByte(){const e=this.getByte();return-1!==e&&this.pos--,e}peekBytes(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const r=this.getBytes(e,t);return this.pos-=r.length,r}getByteRange(e,t){return e<0&&(e=0),t>this.end&&(t=this.end),t>this.progressiveDataLength&&this.ensureRange(e,t),this.bytes.subarray(e,t)}skip(e){e||(e=1),this.pos+=e}reset(){this.pos=this.start}moveStart(){this.start=this.pos}makeSubStream(e,t,r){function n(){}t?e+t>this.progressiveDataLength&&this.ensureRange(e,e+t):e>=this.progressiveDataLength&&this.ensureByte(e),n.prototype=Object.create(this),n.prototype.getMissingChunks=function(){const e=this.chunkSize,t=Math.floor(this.start/e),r=Math.floor((this.end-1)/e)+1,n=[];for(let i=t;i<r;++i)this._loadedChunks.has(i)||n.push(i);return n},n.prototype.allChunksLoaded=function(){return this.numChunksLoaded===this.numChunks||0===this.getMissingChunks().length};const i=new n;return i.pos=i.start=e,i.end=e+t||this.end,i.dict=r,i}}t.ChunkedStream=o,t.ChunkedStreamManager=class{constructor(e,t){this.length=t.length,this.chunkSize=t.rangeChunkSize,this.stream=new o(this.length,this.chunkSize,this),this.pdfNetworkStream=e,this.disableAutoFetch=t.disableAutoFetch,this.msgHandler=t.msgHandler,this.currRequestId=0,this._chunksNeededByRequest=new Map,this._requestsByChunk=new Map,this._promisesByRequest=new Map,this.progressiveDataLength=0,this.aborted=!1,this._loadedStreamCapability=(0,n.createPromiseCapability)()}onLoadedStream(){return this._loadedStreamCapability.promise}sendRequest(e,t){const r=this.pdfNetworkStream.getRangeReader(e,t);r.isStreamingSupported||(r.onProgress=this.onProgress.bind(this));let i=[],o=0;new Promise(((e,t)=>{const a=s=>{try{if(!s.done){const e=s.value;return i.push(e),o+=(0,n.arrayByteLength)(e),r.isStreamingSupported&&this.onProgress({loaded:o}),void r.read().then(a,t)}const l=(0,n.arraysToBytes)(i);i=null,e(l)}catch(l){t(l)}};r.read().then(a,t)})).then((t=>{this.aborted||this.onReceiveData({chunk:t,begin:e})}))}requestAllChunks(){const e=this.stream.getMissingChunks();return this._requestChunks(e),this._loadedStreamCapability.promise}_requestChunks(e){const t=this.currRequestId++,r=new Set;this._chunksNeededByRequest.set(t,r);for(const n of e)this.stream.hasChunk(n)||r.add(n);if(0===r.size)return Promise.resolve();const i=(0,n.createPromiseCapability)();this._promisesByRequest.set(t,i);const o=[];for(const n of r){let e=this._requestsByChunk.get(n);e||(e=[],this._requestsByChunk.set(n,e),o.push(n)),e.push(t)}if(o.length>0){const e=this.groupChunks(o);for(const t of e){const e=t.beginChunk*this.chunkSize,r=Math.min(t.endChunk*this.chunkSize,this.length);this.sendRequest(e,r)}}return i.promise.catch((e=>{if(!this.aborted)throw e}))}getStream(){return this.stream}requestRange(e,t){t=Math.min(t,this.length);const r=this.getBeginChunk(e),n=this.getEndChunk(t),i=[];for(let o=r;o<n;++o)i.push(o);return this._requestChunks(i)}requestRanges(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const t=[];for(const r of e){const e=this.getBeginChunk(r.begin),n=this.getEndChunk(r.end);for(let r=e;r<n;++r)t.includes(r)||t.push(r)}return t.sort((function(e,t){return e-t})),this._requestChunks(t)}groupChunks(e){const t=[];let r=-1,n=-1;for(let i=0,o=e.length;i<o;++i){const o=e[i];r<0&&(r=o),n>=0&&n+1!==o&&(t.push({beginChunk:r,endChunk:n+1}),r=o),i+1===e.length&&t.push({beginChunk:r,endChunk:o+1}),n=o}return t}onProgress(e){this.msgHandler.send("DocProgress",{loaded:this.stream.numChunksLoaded*this.chunkSize+e.loaded,total:this.length})}onReceiveData(e){const t=e.chunk,r=void 0===e.begin,n=r?this.progressiveDataLength:e.begin,i=n+t.byteLength,o=Math.floor(n/this.chunkSize),a=i<this.length?Math.floor(i/this.chunkSize):Math.ceil(i/this.chunkSize);r?(this.stream.onReceiveProgressiveData(t),this.progressiveDataLength=i):this.stream.onReceiveData(n,t),this.stream.allChunksLoaded()&&this._loadedStreamCapability.resolve(this.stream);const s=[];for(let l=o;l<a;++l){const e=this._requestsByChunk.get(l);if(e){this._requestsByChunk.delete(l);for(const t of e){const e=this._chunksNeededByRequest.get(t);e.has(l)&&e.delete(l),e.size>0||s.push(t)}}}if(!this.disableAutoFetch&&0===this._requestsByChunk.size){let e;if(1===this.stream.numChunksLoaded){const t=this.stream.numChunks-1;this.stream.hasChunk(t)||(e=t)}else e=this.stream.nextEmptyChunk(a);Number.isInteger(e)&&this._requestChunks([e])}for(const l of s){const e=this._promisesByRequest.get(l);this._promisesByRequest.delete(l),e.resolve()}this.msgHandler.send("DocProgress",{loaded:this.stream.numChunksLoaded*this.chunkSize,total:this.length})}onError(e){this._loadedStreamCapability.reject(e)}getBeginChunk(e){return Math.floor(e/this.chunkSize)}getEndChunk(e){return Math.floor((e-1)/this.chunkSize)+1}abort(e){this.aborted=!0,this.pdfNetworkStream&&this.pdfNetworkStream.cancelAllRequests(e);for(const t of this._promisesByRequest.values())t.reject(e)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getLookupTableFactory=function(e){let t;return function(){return e&&(t=Object.create(null),e(t),e=null),t}},t.getInheritableProperty=function(e){let t,{dict:r,key:i,getArray:o=!1,stopWhenFound:a=!0}=e,s=0;for(;r;){const e=o?r.getArray(i):r.get(i);if(void 0!==e){if(a)return e;t||(t=[]),t.push(e)}if(++s>100){(0,n.warn)(`getInheritableProperty: maximum loop count exceeded for "${i}"`);break}r=r.get("Parent")}return t},t.toRomanNumerals=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];(0,n.assert)(Number.isInteger(e)&&e>0,"The number should be a positive integer.");const r=[];let i;for(;e>=1e3;)e-=1e3,r.push("M");i=e/100|0,e%=100,r.push(s[i]),i=e/10|0,e%=10,r.push(s[10+i]),r.push(s[20+e]);const o=r.join("");return t?o.toLowerCase():o},t.log2=function(e){return e<=0?0:Math.ceil(Math.log2(e))},t.parseXFAPath=function(e){const t=/(.+)\[([0-9]+)\]$/;return e.split(".").map((e=>{const r=e.match(t);return r?{name:r[1],pos:parseInt(r[2],10)}:{name:e,pos:0}}))},t.readInt8=function(e,t){return e[t]<<24>>24},t.readUint16=function(e,t){return e[t]<<8|e[t+1]},t.readUint32=function(e,t){return(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0},t.isWhiteSpace=function(e){return 32===e||9===e||13===e||10===e},t.XRefParseException=t.XRefEntryException=t.MissingDataException=void 0;var n=r(2);class i extends n.BaseException{constructor(e,t){super(`Missing data [${e}, ${t})`),this.begin=e,this.end=t}}t.MissingDataException=i;class o extends n.BaseException{}t.XRefEntryException=o;class a extends n.BaseException{}t.XRefParseException=a;const s=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"]},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PDFDocument=t.Page=void 0;var n=r(2),i=r(10),o=r(5),a=r(8),s=r(12),l=r(25),c=r(22),u=r(11),h=r(26),d=r(29);const f=[0,0,612,792];function g(e,t){return"display"===t&&e.viewable||"print"===t&&e.printable}class p{constructor(e){let{pdfManager:t,xref:r,pageIndex:n,pageDict:i,ref:o,globalIdFactory:a,fontCache:s,builtInCMapCache:l,globalImageCache:c}=e;this.pdfManager=t,this.pageIndex=n,this.pageDict=i,this.xref=r,this.ref=o,this.fontCache=s,this.builtInCMapCache=l,this.globalImageCache=c,this.evaluatorOptions=t.evaluatorOptions,this.resourcesPromise=null;const u={obj:0};this._localIdFactory=class extends a{static createObjId(){return`p${n}_${++u.obj}`}}}_getInheritableProperty(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const r=(0,a.getInheritableProperty)({dict:this.pageDict,key:e,getArray:t,stopWhenFound:!1});return Array.isArray(r)?1!==r.length&&(0,o.isDict)(r[0])?o.Dict.merge({xref:this.xref,dictArray:r}):r[0]:r}get content(){return this.pageDict.get("Contents")}get resources(){return(0,n.shadow)(this,"resources",this._getInheritableProperty("Resources")||o.Dict.empty)}_getBoundingBox(e){const t=this._getInheritableProperty(e,!0);if(Array.isArray(t)&&4===t.length){if(t[2]-t[0]!==0&&t[3]-t[1]!==0)return t;(0,n.warn)(`Empty /${e} entry.`)}return null}get mediaBox(){return(0,n.shadow)(this,"mediaBox",this._getBoundingBox("MediaBox")||f)}get cropBox(){return(0,n.shadow)(this,"cropBox",this._getBoundingBox("CropBox")||this.mediaBox)}get userUnit(){let e=this.pageDict.get("UserUnit");return(!(0,n.isNum)(e)||e<=0)&&(e=1),(0,n.shadow)(this,"userUnit",e)}get view(){const{cropBox:e,mediaBox:t}=this;let r;if(e===t||(0,n.isArrayEqual)(e,t))r=t;else{const i=n.Util.intersect(e,t);i&&i[2]-i[0]!==0&&i[3]-i[1]!==0?r=i:(0,n.warn)("Empty /CropBox and /MediaBox intersection.")}return(0,n.shadow)(this,"view",r||t)}get rotate(){let e=this._getInheritableProperty("Rotate")||0;return e%90!==0?e=0:e>=360?e%=360:e<0&&(e=(e%360+360)%360),(0,n.shadow)(this,"rotate",e)}getContentStream(){const e=this.content;let t;if(Array.isArray(e)){const r=this.xref,n=[];for(const t of e)n.push(r.fetchIfRef(t));t=new s.StreamsSequenceStream(n)}else t=(0,o.isStream)(e)?e:new s.NullStream;return t}save(e,t,r){const i=new d.PartialEvaluator({xref:this.xref,handler:e,pageIndex:this.pageIndex,idFactory:this._localIdFactory,fontCache:this.fontCache,builtInCMapCache:this.builtInCMapCache,globalImageCache:this.globalImageCache,options:this.evaluatorOptions});return this._parsedAnnotations.then((function(e){const o=[];for(const a of e)g(a,"print")&&o.push(a.save(i,t,r).catch((function(e){return(0,n.warn)(`save - ignoring annotation data during "${t.name}" task: "${e}".`),null})));return Promise.all(o)}))}loadResources(e){return this.resourcesPromise||(this.resourcesPromise=this.pdfManager.ensure(this,"resources")),this.resourcesPromise.then((()=>new i.ObjectLoader(this.resources,e,this.xref).load()))}getOperatorList(e){let{handler:t,sink:r,task:i,intent:o,renderInteractiveForms:a,annotationStorage:s}=e;const l=this.pdfManager.ensure(this,"getContentStream"),c=this.loadResources(["ExtGState","ColorSpace","Pattern","Shading","XObject","Font"]),u=new d.PartialEvaluator({xref:this.xref,handler:t,pageIndex:this.pageIndex,idFactory:this._localIdFactory,fontCache:this.fontCache,builtInCMapCache:this.builtInCMapCache,globalImageCache:this.globalImageCache,options:this.evaluatorOptions}),f=Promise.all([l,c]).then((e=>{let[n]=e;const a=new h.OperatorList(o,r);return t.send("StartRenderPage",{transparency:u.hasBlendModes(this.resources),pageIndex:this.pageIndex,intent:o}),u.getOperatorList({stream:n,task:i,resources:this.resources,operatorList:a}).then((function(){return a}))}));return Promise.all([f,this._parsedAnnotations]).then((function(e){let[t,r]=e;if(0===r.length)return t.flush(!0),{length:t.totalLength};const l=[];for(const c of r)g(c,o)&&l.push(c.getOperatorList(u,i,a,s).catch((function(e){return(0,n.warn)(`getOperatorList - ignoring annotation data during "${i.name}" task: "${e}".`),null})));return Promise.all(l).then((function(e){t.addOp(n.OPS.beginAnnotations,[]);for(const r of e)t.addOpList(r);return t.addOp(n.OPS.endAnnotations,[]),t.flush(!0),{length:t.totalLength}}))}))}extractTextContent(e){let{handler:t,task:r,normalizeWhitespace:n,sink:i,combineTextItems:o}=e;const a=this.pdfManager.ensure(this,"getContentStream"),s=this.loadResources(["ExtGState","XObject","Font"]);return Promise.all([a,s]).then((e=>{let[a]=e;return new d.PartialEvaluator({xref:this.xref,handler:t,pageIndex:this.pageIndex,idFactory:this._localIdFactory,fontCache:this.fontCache,builtInCMapCache:this.builtInCMapCache,globalImageCache:this.globalImageCache,options:this.evaluatorOptions}).getTextContent({stream:a,task:r,resources:this.resources,normalizeWhitespace:n,combineTextItems:o,sink:i})}))}getAnnotationsData(e){return this._parsedAnnotations.then((function(t){const r=[];for(let n=0,i=t.length;n<i;n++)e&&!g(t[n],e)||r.push(t[n].data);return r}))}get annotations(){return(0,n.shadow)(this,"annotations",this._getInheritableProperty("Annots")||[])}get _parsedAnnotations(){const e=this.pdfManager.ensure(this,"annotations").then((()=>{const e=[];for(const t of this.annotations)e.push(l.AnnotationFactory.create(this.xref,t,this.pdfManager,this._localIdFactory).catch((function(e){return(0,n.warn)(`_parsedAnnotations: "${e}".`),null})));return Promise.all(e).then((function(e){return e.filter((e=>!!e))}))}));return(0,n.shadow)(this,"_parsedAnnotations",e)}}t.Page=p;const m=new Uint8Array([37,80,68,70,45]),v=new Uint8Array([115,116,97,114,116,120,114,101,102]),b=new Uint8Array([101,110,100,111,98,106]),y=/^[1-9]\.[0-9]$/;function w(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1024,n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i=t.length,o=e.peekBytes(r),a=o.length-i;if(a<=0)return!1;if(n){const r=i-1;let n=o.length-1;for(;n>=r;){let a=0;for(;a<i&&o[n-a]===t[r-a];)a++;if(a>=i)return e.pos+=n-r,!0;n--}}else{let r=0;for(;r<=a;){let n=0;for(;n<i&&o[r+n]===t[n];)n++;if(n>=i)return e.pos+=r,!0;r++}}return!1}t.PDFDocument=class{constructor(e,t){let r;if((0,o.isStream)(t))r=t;else{if(!(0,n.isArrayBuffer)(t))throw new Error("PDFDocument: Unknown argument type");r=new s.Stream(t)}if(r.length<=0)throw new n.InvalidPDFException("The PDF file is empty, i.e. its size is zero bytes.");this.pdfManager=e,this.stream=r,this.xref=new i.XRef(r,e),this._pagePromises=[],this._version=null;const a={font:0};this._globalIdFactory=class{static getDocId(){return`g_${e.docId}`}static createFontId(){return"f"+ ++a.font}static createObjId(){(0,n.unreachable)("Abstract method `createObjId` called.")}}}parse(e){this.xref.parse(e),this.catalog=new i.Catalog(this.pdfManager,this.xref),this.catalog.version&&(this._version=this.catalog.version)}get linearization(){let e=null;try{e=u.Linearization.create(this.stream)}catch(t){if(t instanceof a.MissingDataException)throw t;(0,n.info)(t)}return(0,n.shadow)(this,"linearization",e)}get startXRef(){const e=this.stream;let t=0;if(this.linearization)e.reset(),w(e,b)&&(t=e.pos+6-e.start);else{const r=1024,n=v.length;let i=!1,o=e.end;for(;!i&&o>0;)o-=r-n,o<0&&(o=0),e.pos=o,i=w(e,v,r,!0);if(i){let r;e.skip(9);do{r=e.getByte()}while((0,a.isWhiteSpace)(r));let n="";for(;r>=32&&r<=57;)n+=String.fromCharCode(r),r=e.getByte();t=parseInt(n,10),isNaN(t)&&(t=0)}}return(0,n.shadow)(this,"startXRef",t)}checkHeader(){const e=this.stream;if(e.reset(),!w(e,m))return;e.moveStart();let t,r="";for(;(t=e.getByte())>32&&!(r.length>=12);)r+=String.fromCharCode(t);this._version||(this._version=r.substring(5))}parseStartXRef(){this.xref.setStartXRef(this.startXRef)}get numPages(){const e=this.linearization,t=e?e.numPages:this.catalog.numPages;return(0,n.shadow)(this,"numPages",t)}_hasOnlyDocumentSignatures(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e.every((e=>{if((e=this.xref.fetchIfRef(e)).has("Kids"))return++t>10?((0,n.warn)("_hasOnlyDocumentSignatures: maximum recursion depth reached"),!1):this._hasOnlyDocumentSignatures(e.get("Kids"),t);const r=(0,o.isName)(e.get("FT"),"Sig"),i=e.get("Rect"),a=Array.isArray(i)&&i.every((e=>0===e));return r&&a}))}get formInfo(){const e={hasAcroForm:!1,hasXfa:!1},t=this.catalog.acroForm;if(!t)return(0,n.shadow)(this,"formInfo",e);try{const r=t.get("XFA"),n=Array.isArray(r)&&r.length>0||(0,o.isStream)(r)&&!r.isEmpty;e.hasXfa=n;const i=t.get("Fields"),a=Array.isArray(i)&&i.length>0,s=!!(1&t.get("SigFlags"))&&this._hasOnlyDocumentSignatures(i);e.hasAcroForm=a&&!s}catch(r){if(r instanceof a.MissingDataException)throw r;(0,n.info)("Cannot fetch form information.")}return(0,n.shadow)(this,"formInfo",e)}get documentInfo(){const e={Title:n.isString,Author:n.isString,Subject:n.isString,Keywords:n.isString,Creator:n.isString,Producer:n.isString,CreationDate:n.isString,ModDate:n.isString,Trapped:o.isName};let t=this._version;"string"===typeof t&&y.test(t)||((0,n.warn)(`Invalid PDF header version number: ${t}`),t=null);const r={PDFFormatVersion:t,IsLinearized:!!this.linearization,IsAcroFormPresent:this.formInfo.hasAcroForm,IsXFAPresent:this.formInfo.hasXfa,IsCollectionPresent:!!this.catalog.collection};let i;try{i=this.xref.trailer.get("Info")}catch(s){if(s instanceof a.MissingDataException)throw s;(0,n.info)("The document information dictionary is invalid.")}if((0,o.isDict)(i))for(const a of i.getKeys()){const t=i.get(a);if(e[a])e[a](t)?r[a]="string"!==typeof t?t:(0,n.stringToPDFString)(t):(0,n.info)(`Bad value in document info for "${a}".`);else if("string"===typeof a){let e;if((0,n.isString)(t))e=(0,n.stringToPDFString)(t);else{if(!((0,o.isName)(t)||(0,n.isNum)(t)||(0,n.isBool)(t))){(0,n.info)(`Unsupported value in document info for (custom) "${a}".`);continue}e=t}r.Custom||(r.Custom=Object.create(null)),r.Custom[a]=e}}return(0,n.shadow)(this,"documentInfo",r)}get fingerprint(){let e;const t=this.xref.trailer.get("ID");e=Array.isArray(t)&&t[0]&&(0,n.isString)(t[0])&&"\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0"!==t[0]?(0,n.stringToBytes)(t[0]):(0,c.calculateMD5)(this.stream.getByteRange(0,1024),0,1024);const r=[];for(let n=0,i=e.length;n<i;n++){const t=e[n].toString(16);r.push(t.padStart(2,"0"))}return(0,n.shadow)(this,"fingerprint",r.join(""))}_getLinearizationPage(e){const{catalog:t,linearization:r}=this,i=o.Ref.get(r.objectNumberFirst,0);return this.xref.fetchAsync(i).then((e=>{if((0,o.isDict)(e,"Page")||(0,o.isDict)(e)&&!e.has("Type")&&e.has("Contents"))return i&&!t.pageKidsCountCache.has(i)&&t.pageKidsCountCache.put(i,1),[e,i];throw new n.FormatError("The Linearization dictionary doesn't point to a valid Page dictionary.")})).catch((r=>((0,n.info)(r),t.getPageDict(e))))}getPage(e){if(void 0!==this._pagePromises[e])return this._pagePromises[e];const{catalog:t,linearization:r}=this,n=r&&r.pageFirst===e?this._getLinearizationPage(e):t.getPageDict(e);return this._pagePromises[e]=n.then((r=>{let[n,i]=r;return new p({pdfManager:this.pdfManager,xref:this.xref,pageIndex:e,pageDict:n,ref:i,globalIdFactory:this._globalIdFactory,fontCache:t.fontCache,builtInCMapCache:t.builtInCMapCache,globalImageCache:t.globalImageCache})}))}checkFirstPage(){return this.getPage(0).catch((async e=>{if(e instanceof a.XRefEntryException)throw this._pagePromises.length=0,await this.cleanup(),new a.XRefParseException}))}fontFallback(e,t){return this.catalog.fontFallback(e,t)}async cleanup(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.catalog?this.catalog.cleanup(e):(0,o.clearPrimitiveCaches)()}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FileSpec=t.XRef=t.ObjectLoader=t.Catalog=void 0;var n=r(2),i=r(5),o=r(11),a=r(8),s=r(22),l=r(23),c=r(24);function u(e){return(0,i.isDict)(e)?e.get("D"):e}class h{constructor(e,t){if(this.pdfManager=e,this.xref=t,this._catDict=t.getCatalogObj(),!(0,i.isDict)(this._catDict))throw new n.FormatError("Catalog object is not a dictionary.");this.fontCache=new i.RefSetCache,this.builtInCMapCache=new Map,this.globalImageCache=new c.GlobalImageCache,this.pageKidsCountCache=new i.RefSetCache}get version(){const e=this._catDict.get("Version");return(0,i.isName)(e)?(0,n.shadow)(this,"version",e.name):(0,n.shadow)(this,"version",null)}get collection(){let e=null;try{const t=this._catDict.get("Collection");(0,i.isDict)(t)&&t.size>0&&(e=t)}catch(t){if(t instanceof a.MissingDataException)throw t;(0,n.info)("Cannot fetch Collection entry; assuming no collection is present.")}return(0,n.shadow)(this,"collection",e)}get acroForm(){let e=null;try{const t=this._catDict.get("AcroForm");(0,i.isDict)(t)&&t.size>0&&(e=t)}catch(t){if(t instanceof a.MissingDataException)throw t;(0,n.info)("Cannot fetch AcroForm entry; assuming no forms are present.")}return(0,n.shadow)(this,"acroForm",e)}get metadata(){const e=this._catDict.getRaw("Metadata");if(!(0,i.isRef)(e))return(0,n.shadow)(this,"metadata",null);const t=!(this.xref.encrypt&&this.xref.encrypt.encryptMetadata),r=this.xref.fetch(e,t);let o;if(r&&(0,i.isDict)(r.dict)){const e=r.dict.get("Type"),t=r.dict.get("Subtype");if((0,i.isName)(e,"Metadata")&&(0,i.isName)(t,"XML"))try{o=(0,n.stringToUTF8String)((0,n.bytesToString)(r.getBytes()))}catch(s){if(s instanceof a.MissingDataException)throw s;(0,n.info)("Skipping invalid metadata.")}}return(0,n.shadow)(this,"metadata",o)}get toplevelPagesDict(){const e=this._catDict.get("Pages");if(!(0,i.isDict)(e))throw new n.FormatError("Invalid top-level pages dictionary.");return(0,n.shadow)(this,"toplevelPagesDict",e)}get documentOutline(){let e=null;try{e=this._readDocumentOutline()}catch(t){if(t instanceof a.MissingDataException)throw t;(0,n.warn)("Unable to read document outline.")}return(0,n.shadow)(this,"documentOutline",e)}_readDocumentOutline(){let e=this._catDict.get("Outlines");if(!(0,i.isDict)(e))return null;if(e=e.getRaw("First"),!(0,i.isRef)(e))return null;const t={items:[]},r=[{obj:e,parent:t}],o=new i.RefSet;o.put(e);const a=this.xref,s=new Uint8ClampedArray(3);for(;r.length>0;){const t=r.shift(),c=a.fetchIfRef(t.obj);if(null===c)continue;if(!c.has("Title"))throw new n.FormatError("Invalid outline item encountered.");const u={url:null,dest:null};h.parseDestDictionary({destDict:c,resultObj:u,docBaseUrl:this.pdfManager.docBaseUrl});const d=c.get("Title"),f=c.get("F")||0,g=c.getArray("C"),p=c.get("Count");let m=s;!Array.isArray(g)||3!==g.length||0===g[0]&&0===g[1]&&0===g[2]||(m=l.ColorSpace.singletons.rgb.getRgb(g,0));const v={dest:u.dest,url:u.url,unsafeUrl:u.unsafeUrl,newWindow:u.newWindow,title:(0,n.stringToPDFString)(d),color:m,count:Number.isInteger(p)?p:void 0,bold:!!(2&f),italic:!!(1&f),items:[]};t.parent.items.push(v),e=c.getRaw("First"),(0,i.isRef)(e)&&!o.has(e)&&(r.push({obj:e,parent:v}),o.put(e)),e=c.getRaw("Next"),(0,i.isRef)(e)&&!o.has(e)&&(r.push({obj:e,parent:t.parent}),o.put(e))}return t.items.length>0?t.items:null}get permissions(){let e=null;try{e=this._readPermissions()}catch(t){if(t instanceof a.MissingDataException)throw t;(0,n.warn)("Unable to read permissions.")}return(0,n.shadow)(this,"permissions",e)}_readPermissions(){const e=this.xref.trailer.get("Encrypt");if(!(0,i.isDict)(e))return null;let t=e.get("P");if(!(0,n.isNum)(t))return null;t+=2**32;const r=[];for(const i in n.PermissionFlag){const e=n.PermissionFlag[i];t&e&&r.push(e)}return r}get optionalContentConfig(){let e=null;try{const t=this._catDict.get("OCProperties");if(!t)return(0,n.shadow)(this,"optionalContentConfig",null);const r=t.get("D");if(!r)return(0,n.shadow)(this,"optionalContentConfig",null);const o=t.get("OCGs");if(!Array.isArray(o))return(0,n.shadow)(this,"optionalContentConfig",null);const a=[],s=[];for(const e of o){if(!(0,i.isRef)(e))continue;s.push(e);const t=this.xref.fetchIfRef(e);a.push({id:e.toString(),name:(0,n.isString)(t.get("Name"))?(0,n.stringToPDFString)(t.get("Name")):null,intent:(0,n.isString)(t.get("Intent"))?(0,n.stringToPDFString)(t.get("Intent")):null})}e=this._readOptionalContentConfig(r,s),e.groups=a}catch(t){if(t instanceof a.MissingDataException)throw t;(0,n.warn)(`Unable to read optional content config: ${t}`)}return(0,n.shadow)(this,"optionalContentConfig",e)}_readOptionalContentConfig(e,t){function r(e){const r=[];if(Array.isArray(e))for(const n of e)(0,i.isRef)(n)&&t.includes(n)&&r.push(n.toString());return r}function o(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!Array.isArray(e))return null;const n=[];for(const s of e){if((0,i.isRef)(s)&&t.includes(s)){l.put(s),n.push(s.toString());continue}const e=a(s,r);e&&n.push(e)}if(r>0)return n;const o=[];for(const i of t)l.has(i)||o.push(i.toString());return o.length&&n.push({name:null,order:o}),n}function a(e,t){if(++t>c)return(0,n.warn)("parseNestedOrder - reached MAX_NESTED_LEVELS."),null;const r=s.fetchIfRef(e);if(!Array.isArray(r))return null;const i=s.fetchIfRef(r[0]);if("string"!==typeof i)return null;const a=o(r.slice(1),t);return a&&a.length?{name:(0,n.stringToPDFString)(i),order:a}:null}const s=this.xref,l=new i.RefSet,c=10;return{name:(0,n.isString)(e.get("Name"))?(0,n.stringToPDFString)(e.get("Name")):null,creator:(0,n.isString)(e.get("Creator"))?(0,n.stringToPDFString)(e.get("Creator")):null,baseState:(0,i.isName)(e.get("BaseState"))?e.get("BaseState").name:null,on:r(e.get("ON")),off:r(e.get("OFF")),order:o(e.get("Order")),groups:null}}get numPages(){const e=this.toplevelPagesDict.get("Count");if(!Number.isInteger(e))throw new n.FormatError("Page count in top-level pages dictionary is not an integer.");return(0,n.shadow)(this,"numPages",e)}get destinations(){const e=this._readDests(),t=Object.create(null);if(e instanceof g){const r=e.getAll();for(const e in r)t[e]=u(r[e])}else e instanceof i.Dict&&e.forEach((function(e,r){r&&(t[e]=u(r))}));return(0,n.shadow)(this,"destinations",t)}getDestination(e){const t=this._readDests();return t instanceof g||t instanceof i.Dict?u(t.get(e)||null):null}_readDests(){const e=this._catDict.get("Names");return e&&e.has("Dests")?new g(e.getRaw("Dests"),this.xref):this._catDict.has("Dests")?this._catDict.get("Dests"):void 0}get pageLabels(){let e=null;try{e=this._readPageLabels()}catch(t){if(t instanceof a.MissingDataException)throw t;(0,n.warn)("Unable to read page labels.")}return(0,n.shadow)(this,"pageLabels",e)}_readPageLabels(){const e=this._catDict.getRaw("PageLabels");if(!e)return null;const t=new Array(this.numPages);let r=null,o="";const s=new p(e,this.xref).getAll();let l="",c=1;for(let u=0,h=this.numPages;u<h;u++){if(u in s){const e=s[u];if(!(0,i.isDict)(e))throw new n.FormatError("PageLabel is not a dictionary.");if(e.has("Type")&&!(0,i.isName)(e.get("Type"),"PageLabel"))throw new n.FormatError("Invalid type in PageLabel dictionary.");if(e.has("S")){const t=e.get("S");if(!(0,i.isName)(t))throw new n.FormatError("Invalid style in PageLabel dictionary.");r=t.name}else r=null;if(e.has("P")){const t=e.get("P");if(!(0,n.isString)(t))throw new n.FormatError("Invalid prefix in PageLabel dictionary.");o=(0,n.stringToPDFString)(t)}else o="";if(e.has("St")){const t=e.get("St");if(!(Number.isInteger(t)&&t>=1))throw new n.FormatError("Invalid start in PageLabel dictionary.");c=t}else c=1}switch(r){case"D":l=c;break;case"R":case"r":l=(0,a.toRomanNumerals)(c,"r"===r);break;case"A":case"a":const e=26,t="a"===r?97:65,i=c-1,o=String.fromCharCode(t+i%e),s=[];for(let r=0,n=i/e|0;r<=n;r++)s.push(o);l=s.join("");break;default:if(r)throw new n.FormatError(`Invalid style "${r}" in PageLabel dictionary.`);l=""}t[u]=o+l,c++}return t}get pageLayout(){const e=this._catDict.get("PageLayout");let t="";if((0,i.isName)(e))switch(e.name){case"SinglePage":case"OneColumn":case"TwoColumnLeft":case"TwoColumnRight":case"TwoPageLeft":case"TwoPageRight":t=e.name}return(0,n.shadow)(this,"pageLayout",t)}get pageMode(){const e=this._catDict.get("PageMode");let t="UseNone";if((0,i.isName)(e))switch(e.name){case"UseNone":case"UseOutlines":case"UseThumbs":case"FullScreen":case"UseOC":case"UseAttachments":t=e.name}return(0,n.shadow)(this,"pageMode",t)}get viewerPreferences(){const e={HideToolbar:n.isBool,HideMenubar:n.isBool,HideWindowUI:n.isBool,FitWindow:n.isBool,CenterWindow:n.isBool,DisplayDocTitle:n.isBool,NonFullScreenPageMode:i.isName,Direction:i.isName,ViewArea:i.isName,ViewClip:i.isName,PrintArea:i.isName,PrintClip:i.isName,PrintScaling:i.isName,Duplex:i.isName,PickTrayByPDFSize:n.isBool,PrintPageRange:Array.isArray,NumCopies:Number.isInteger},t=this._catDict.get("ViewerPreferences");let r=null;if((0,i.isDict)(t))for(const i in e){if(!t.has(i))continue;const o=t.get(i);if(!e[i](o)){(0,n.info)(`Bad value in ViewerPreferences for "${i}".`);continue}let a;switch(i){case"NonFullScreenPageMode":switch(o.name){case"UseNone":case"UseOutlines":case"UseThumbs":case"UseOC":a=o.name;break;default:a="UseNone"}break;case"Direction":switch(o.name){case"L2R":case"R2L":a=o.name;break;default:a="L2R"}break;case"ViewArea":case"ViewClip":case"PrintArea":case"PrintClip":switch(o.name){case"MediaBox":case"CropBox":case"BleedBox":case"TrimBox":case"ArtBox":a=o.name;break;default:a="CropBox"}break;case"PrintScaling":switch(o.name){case"None":case"AppDefault":a=o.name;break;default:a="AppDefault"}break;case"Duplex":switch(o.name){case"Simplex":case"DuplexFlipShortEdge":case"DuplexFlipLongEdge":a=o.name;break;default:a="None"}break;case"PrintPageRange":if(o.length%2!==0)break;o.every(((e,t,r)=>Number.isInteger(e)&&e>0&&(0===t||e>=r[t-1])&&e<=this.numPages))&&(a=o);break;case"NumCopies":o>0&&(a=o);break;default:if("boolean"!==typeof o)throw new n.FormatError(`viewerPreferences - expected a boolean value for: ${i}`);a=o}void 0!==a?(r||(r=Object.create(null)),r[i]=a):(0,n.info)(`Bad value in ViewerPreferences for "${i}".`)}return(0,n.shadow)(this,"viewerPreferences",r)}get openAction(){const e=this._catDict.get("OpenAction");let t=null;if((0,i.isDict)(e)){const r=new i.Dict(this.xref);r.set("A",e);const n={url:null,dest:null,action:null};h.parseDestDictionary({destDict:r,resultObj:n}),Array.isArray(n.dest)?(t||(t=Object.create(null)),t.dest=n.dest):n.action&&(t||(t=Object.create(null)),t.action=n.action)}else Array.isArray(e)&&(t||(t=Object.create(null)),t.dest=e);return(0,n.shadow)(this,"openAction",t)}get attachments(){const e=this._catDict.get("Names");let t=null;if(e&&e.has("EmbeddedFiles")){const r=new g(e.getRaw("EmbeddedFiles"),this.xref).getAll();for(const e in r){const i=new m(r[e],this.xref);t||(t=Object.create(null)),t[(0,n.stringToPDFString)(e)]=i.serializable}}return(0,n.shadow)(this,"attachments",t)}get javaScript(){const e=this._catDict.get("Names");let t=null;function r(e){const r=e.get("S");if(!(0,i.isName)(r,"JavaScript"))return;let o=e.get("JS");if((0,i.isStream)(o))o=(0,n.bytesToString)(o.getBytes());else if(!(0,n.isString)(o))return;t||(t=[]),t.push((0,n.stringToPDFString)(o))}if(e&&e.has("JavaScript")){const t=new g(e.getRaw("JavaScript"),this.xref).getAll();for(const e in t){const n=t[e];(0,i.isDict)(n)&&r(n)}}const o=this._catDict.get("OpenAction");return(0,i.isDict)(o)&&(0,i.isName)(o.get("S"),"JavaScript")&&r(o),(0,n.shadow)(this,"javaScript",t)}fontFallback(e,t){const r=[];return this.fontCache.forEach((function(e){r.push(e)})),Promise.all(r).then((r=>{for(const n of r)if(n.loadedName===e)return void n.fallback(t)}))}cleanup(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];(0,i.clearPrimitiveCaches)(),this.globalImageCache.clear(e),this.pageKidsCountCache.clear();const t=[];return this.fontCache.forEach((function(e){t.push(e)})),Promise.all(t).then((e=>{for(const{dict:t}of e)delete t.translated;this.fontCache.clear(),this.builtInCMapCache.clear()}))}getPageDict(e){const t=(0,n.createPromiseCapability)(),r=[this._catDict.getRaw("Pages")],o=new i.RefSet,a=this.xref,s=this.pageKidsCountCache;let l,c=0;return function u(){for(;r.length;){const h=r.pop();if((0,i.isRef)(h)){if(l=s.get(h),l>0&&c+l<e){c+=l;continue}return o.has(h)?void t.reject(new n.FormatError("Pages tree contains circular reference.")):(o.put(h),void a.fetchAsync(h).then((function(n){(0,i.isDict)(n,"Page")||(0,i.isDict)(n)&&!n.has("Kids")?e===c?(h&&!s.has(h)&&s.put(h,1),t.resolve([n,h])):(c++,u()):(r.push(n),u())}),t.reject))}if(!(0,i.isDict)(h))return void t.reject(new n.FormatError("Page dictionary kid reference points to wrong type of object."));if(l=h.get("Count"),Number.isInteger(l)&&l>=0){const t=h.objId;if(t&&!s.has(t)&&s.put(t,l),c+l<=e){c+=l;continue}}const d=h.get("Kids");if(!Array.isArray(d)){if((0,i.isName)(h.get("Type"),"Page")||!h.has("Type")&&h.has("Contents")){if(c===e)return void t.resolve([h,null]);c++;continue}return void t.reject(new n.FormatError("Page dictionary kids object is not an array."))}for(let e=d.length-1;e>=0;e--)r.push(d[e])}t.reject(new Error(`Page index ${e} not found.`))}(),t.promise}getPageIndex(e){const t=this.xref;let r=0;return function o(a){return function(r){let o,a=0;return t.fetchAsync(r).then((function(t){if((0,i.isRefsEqual)(r,e)&&!(0,i.isDict)(t,"Page")&&(!(0,i.isDict)(t)||t.has("Type")||!t.has("Contents")))throw new n.FormatError("The reference does not point to a /Page dictionary.");if(!t)return null;if(!(0,i.isDict)(t))throw new n.FormatError("Node must be a dictionary.");return o=t.getRaw("Parent"),t.getAsync("Parent")})).then((function(e){if(!e)return null;if(!(0,i.isDict)(e))throw new n.FormatError("Parent must be a dictionary.");return e.getAsync("Kids")})).then((function(e){if(!e)return null;const s=[];let l=!1;for(let o=0,c=e.length;o<c;o++){const c=e[o];if(!(0,i.isRef)(c))throw new n.FormatError("Kid must be a reference.");if((0,i.isRefsEqual)(c,r)){l=!0;break}s.push(t.fetchAsync(c).then((function(e){if(!(0,i.isDict)(e))throw new n.FormatError("Kid node must be a dictionary.");e.has("Count")?a+=e.get("Count"):a++})))}if(!l)throw new n.FormatError("Kid reference not found in parent's kids.");return Promise.all(s).then((function(){return[a,o]}))}))}(a).then((function(e){if(!e)return r;const[t,n]=e;return r+=t,o(n)}))}(e)}static parseDestDictionary(e){const t=e.destDict;if(!(0,i.isDict)(t))return void(0,n.warn)("parseDestDictionary: `destDict` must be a dictionary.");const r=e.resultObj;if("object"!==typeof r)return void(0,n.warn)("parseDestDictionary: `resultObj` must be an object.");const o=e.docBaseUrl||null;let a,s,l=t.get("A");if(!(0,i.isDict)(l)&&t.has("Dest")&&(l=t.get("Dest")),(0,i.isDict)(l)){const e=l.get("S");if(!(0,i.isName)(e))return void(0,n.warn)("parseDestDictionary: Invalid type in Action dictionary.");const t=e.name;switch(t){case"URI":a=l.get("URI"),(0,i.isName)(a)?a="/"+a.name:(0,n.isString)(a)&&(a=function(e){return e.startsWith("www.")?`http://${e}`:e}(a));break;case"GoTo":s=l.get("D");break;case"Launch":case"GoToR":const e=l.get("F");(0,i.isDict)(e)?a=e.get("F")||null:(0,n.isString)(e)&&(a=e);let o=l.get("D");if(o&&((0,i.isName)(o)&&(o=o.name),(0,n.isString)(a))){const e=a.split("#")[0];(0,n.isString)(o)?a=e+"#"+o:Array.isArray(o)&&(a=e+"#"+JSON.stringify(o))}const c=l.get("NewWindow");(0,n.isBool)(c)&&(r.newWindow=c);break;case"Named":const u=l.get("N");(0,i.isName)(u)&&(r.action=u.name);break;case"JavaScript":const h=l.get("JS");let d;if((0,i.isStream)(h)?d=(0,n.bytesToString)(h.getBytes()):(0,n.isString)(h)&&(d=h),d){const e=new RegExp("^\\s*("+["app.launchURL","window.open"].join("|").split(".").join("\\.")+")\\((?:'|\")([^'\"]*)(?:'|\")(?:,\\s*(\\w+)\\)|\\))","i").exec((0,n.stringToPDFString)(d));if(e&&e[2]){a=e[2],"true"===e[3]&&"app.launchURL"===e[1]&&(r.newWindow=!0);break}}default:(0,n.warn)(`parseDestDictionary: unsupported action type "${t}".`)}}else t.has("Dest")&&(s=t.get("Dest"));if((0,n.isString)(a)){a=function(e){try{return(0,n.stringToUTF8String)(e)}catch(t){return e}}(a);const e=(0,n.createValidAbsoluteUrl)(a,o);e&&(r.url=e.href),r.unsafeUrl=a}s&&((0,i.isName)(s)&&(s=s.name),((0,n.isString)(s)||Array.isArray(s))&&(r.dest=s))}}t.Catalog=h;var d=function(){function e(e,t){this.stream=e,this.pdfManager=t,this.entries=[],this.xrefstms=Object.create(null),this._cacheMap=new Map,this.stats={streamTypes:Object.create(null),fontTypes:Object.create(null)},this._newRefNum=null}return e.prototype={getNewRef:function(){return null===this._newRefNum&&(this._newRefNum=this.entries.length),i.Ref.get(this._newRefNum++,0)},resetNewRef:function(){this._newRefNum=null},setStartXRef:function(e){this.startXRefQueue=[e]},parse:function(e){var t;let r,o;e?((0,n.warn)("Indexing all PDF objects"),t=this.indexObjects()):t=this.readXRef(),t.assignXref(this),this.trailer=t;try{r=t.get("Encrypt")}catch(u){if(u instanceof a.MissingDataException)throw u;(0,n.warn)(`XRef.parse - Invalid "Encrypt" reference: "${u}".`)}if((0,i.isDict)(r)){var l=t.get("ID"),c=l&&l.length?l[0]:"";r.suppressEncryption=!0,this.encrypt=new s.CipherTransformFactory(r,c,this.pdfManager.password)}try{o=t.get("Root")}catch(u){if(u instanceof a.MissingDataException)throw u;(0,n.warn)(`XRef.parse - Invalid "Root" reference: "${u}".`)}if(!(0,i.isDict)(o)||!o.has("Pages")){if(!e)throw new a.XRefParseException;throw new n.FormatError("Invalid root reference")}this.root=o},processXRefTable:function(e){"tableState"in this||(this.tableState={entryNum:0,streamPos:e.lexer.stream.pos,parserBuf1:e.buf1,parserBuf2:e.buf2});var t=this.readXRefTable(e);if(!(0,i.isCmd)(t,"trailer"))throw new n.FormatError("Invalid XRef table: could not find trailer dictionary");var r=e.getObj();if(!(0,i.isDict)(r)&&r.dict&&(r=r.dict),!(0,i.isDict)(r))throw new n.FormatError("Invalid XRef table: could not parse trailer dictionary");return delete this.tableState,r},readXRefTable:function(e){var t,r=e.lexer.stream,o=this.tableState;for(r.pos=o.streamPos,e.buf1=o.parserBuf1,e.buf2=o.parserBuf2;;){if(!("firstEntryNum"in o)||!("entryCount"in o)){if((0,i.isCmd)(t=e.getObj(),"trailer"))break;o.firstEntryNum=t,o.entryCount=e.getObj()}var a=o.firstEntryNum,s=o.entryCount;if(!Number.isInteger(a)||!Number.isInteger(s))throw new n.FormatError("Invalid XRef table: wrong types in subsection header");for(var l=o.entryNum;l<s;l++){o.streamPos=r.pos,o.entryNum=l,o.parserBuf1=e.buf1,o.parserBuf2=e.buf2;var c={};c.offset=e.getObj(),c.gen=e.getObj();var u=e.getObj();if(u instanceof i.Cmd)switch(u.cmd){case"f":c.free=!0;break;case"n":c.uncompressed=!0}if(!Number.isInteger(c.offset)||!Number.isInteger(c.gen)||!c.free&&!c.uncompressed)throw new n.FormatError(`Invalid entry in XRef subsection: ${a}, ${s}`);0===l&&c.free&&1===a&&(a=0),this.entries[l+a]||(this.entries[l+a]=c)}o.entryNum=0,o.streamPos=r.pos,o.parserBuf1=e.buf1,o.parserBuf2=e.buf2,delete o.firstEntryNum,delete o.entryCount}if(this.entries[0]&&!this.entries[0].free)throw new n.FormatError("Invalid XRef table: unexpected first object");return t},processXRefStream:function(e){if(!("streamState"in this)){var t=e.dict,r=t.get("W"),n=t.get("Index");n||(n=[0,t.get("Size")]),this.streamState={entryRanges:n,byteWidths:r,entryNum:0,streamPos:e.pos}}return this.readXRefStream(e),delete this.streamState,e.dict},readXRefStream:function(e){var t,r,i=this.streamState;e.pos=i.streamPos;for(var o=i.byteWidths,a=o[0],s=o[1],l=o[2],c=i.entryRanges;c.length>0;){var u=c[0],h=c[1];if(!Number.isInteger(u)||!Number.isInteger(h))throw new n.FormatError(`Invalid XRef range fields: ${u}, ${h}`);if(!Number.isInteger(a)||!Number.isInteger(s)||!Number.isInteger(l))throw new n.FormatError(`Invalid XRef entry fields length: ${u}, ${h}`);for(t=i.entryNum;t<h;++t){i.entryNum=t,i.streamPos=e.pos;var d=0,f=0,g=0;for(r=0;r<a;++r)d=d<<8|e.getByte();for(0===a&&(d=1),r=0;r<s;++r)f=f<<8|e.getByte();for(r=0;r<l;++r)g=g<<8|e.getByte();var p={};switch(p.offset=f,p.gen=g,d){case 0:p.free=!0;break;case 1:p.uncompressed=!0;break;case 2:break;default:throw new n.FormatError(`Invalid XRef entry type: ${d}`)}this.entries[u+t]||(this.entries[u+t]=p)}i.entryNum=0,i.streamPos=e.pos,c.splice(0,2)}},indexObjects:function(){function e(e,t){for(var r="",n=e[t];10!==n&&13!==n&&60!==n&&!(++t>=e.length);)r+=String.fromCharCode(n),n=e[t];return r}function t(e,t,r){for(var n=r.length,i=e.length,o=0;t<i;){for(var a=0;a<n&&e[t+a]===r[a];)++a;if(a>=n)break;t++,o++}return o}var r=/^(\d+)\s+(\d+)\s+obj\b/;const s=/\bendobj[\b\s]$/,l=/\s+(\d+\s+\d+\s+obj[\b\s<])$/;var c=new Uint8Array([116,114,97,105,108,101,114]),u=new Uint8Array([115,116,97,114,116,120,114,101,102]);const h=new Uint8Array([111,98,106]);var d=new Uint8Array([47,88,82,101,102]);this.entries.length=0;var f=this.stream;f.pos=0;for(var g,p,m=f.getBytes(),v=f.start,b=m.length,y=[],w=[];v<b;){var S=m[v];if(9!==S&&10!==S&&13!==S&&32!==S)if(37!==S){var C,k=e(m,v);if(k.startsWith("xref")&&(4===k.length||/\s/.test(k[4])))v+=t(m,v,c),y.push(v),v+=t(m,v,u);else if(C=r.exec(k)){const e=0|C[1],r=0|C[2];this.entries[e]&&this.entries[e].gen!==r||(this.entries[e]={offset:v-f.start,gen:r,uncompressed:!0});let i,o=v+k.length;for(;o<m.length;){const e=o+t(m,o,h)+4;i=e-v;const r=Math.max(e-25,o),a=(0,n.bytesToString)(m.subarray(r,e));if(s.test(a))break;{const e=l.exec(a);if(e&&e[1]){(0,n.warn)('indexObjects: Found new "obj" inside of another "obj", caused by missing "endobj" -- trying to recover.'),i-=e[1].length;break}}o=e}const a=m.subarray(v,v+i);var x=t(a,0,d);x<i&&a[x+5]<64&&(w.push(v-f.start),this.xrefstms[v-f.start]=1),v+=i}else k.startsWith("trailer")&&(7===k.length||/\s/.test(k[7]))?(y.push(v),v+=t(m,v,u)):v+=k.length+1}else do{if(++v>=b)break;S=m[v]}while(10!==S&&13!==S);else++v}for(g=0,p=w.length;g<p;++g)this.startXRefQueue.push(w[g]),this.readXRef(!0);let E;for(g=0,p=y.length;g<p;++g){f.pos=y[g];const e=new o.Parser({lexer:new o.Lexer(f),xref:this,allowStreams:!0,recoveryMode:!0});var T=e.getObj();if(!(0,i.isCmd)(T,"trailer"))continue;const t=e.getObj();if(!(0,i.isDict)(t))continue;let r;try{r=t.get("Root")}catch(_){if(_ instanceof a.MissingDataException)throw _;continue}if((0,i.isDict)(r)&&r.has("Pages")){if(t.has("ID"))return t;E=t}}if(E)return E;throw new n.InvalidPDFException("Invalid PDF structure.")},readXRef:function(e){var t=this.stream;const r=Object.create(null);try{for(;this.startXRefQueue.length;){var s=this.startXRefQueue[0];if(r[s]){(0,n.warn)("readXRef - skipping XRef table since it was already parsed."),this.startXRefQueue.shift();continue}r[s]=!0,t.pos=s+t.start;const e=new o.Parser({lexer:new o.Lexer(t),xref:this,allowStreams:!0});var l,c=e.getObj();if((0,i.isCmd)(c,"xref")){if(l=this.processXRefTable(e),this.topDict||(this.topDict=l),c=l.get("XRefStm"),Number.isInteger(c)){var u=c;u in this.xrefstms||(this.xrefstms[u]=1,this.startXRefQueue.push(u))}}else{if(!Number.isInteger(c))throw new n.FormatError("Invalid XRef stream header");if(!Number.isInteger(e.getObj())||!(0,i.isCmd)(e.getObj(),"obj")||!(0,i.isStream)(c=e.getObj()))throw new n.FormatError("Invalid XRef stream");if(l=this.processXRefStream(c),this.topDict||(this.topDict=l),!l)throw new n.FormatError("Failed to read XRef stream")}c=l.get("Prev"),Number.isInteger(c)?this.startXRefQueue.push(c):(0,i.isRef)(c)&&this.startXRefQueue.push(c.num),this.startXRefQueue.shift()}return this.topDict}catch(h){if(h instanceof a.MissingDataException)throw h;(0,n.info)("(while reading XRef): "+h)}if(!e)throw new a.XRefParseException},getEntry:function(e){var t=this.entries[e];return t&&!t.free&&t.offset?t:null},fetchIfRef:function(e,t){return e instanceof i.Ref?this.fetch(e,t):e},fetch:function(e,t){if(!(e instanceof i.Ref))throw new Error("ref object is not a reference");const r=e.num,n=this._cacheMap.get(r);if(void 0!==n)return n instanceof i.Dict&&!n.objId&&(n.objId=e.toString()),n;let o=this.getEntry(r);return null===o?(this._cacheMap.set(r,o),o):(o=o.uncompressed?this.fetchUncompressed(e,o,t):this.fetchCompressed(e,o,t),(0,i.isDict)(o)?o.objId=e.toString():(0,i.isStream)(o)&&(o.dict.objId=e.toString()),o)},fetchUncompressed(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];var n=e.gen,s=e.num;if(t.gen!==n)throw new a.XRefEntryException(`Inconsistent generation in XRef: ${e}`);var l=this.stream.makeSubStream(t.offset+this.stream.start);const c=new o.Parser({lexer:new o.Lexer(l),xref:this,allowStreams:!0});var u=c.getObj(),h=c.getObj(),d=c.getObj();if(u!==s||h!==n||!(d instanceof i.Cmd))throw new a.XRefEntryException(`Bad (uncompressed) XRef entry: ${e}`);if("obj"!==d.cmd){if(d.cmd.startsWith("obj")&&(s=parseInt(d.cmd.substring(3),10),!Number.isNaN(s)))return s;throw new a.XRefEntryException(`Bad (uncompressed) XRef entry: ${e}`)}return t=this.encrypt&&!r?c.getObj(this.encrypt.createCipherTransform(s,n)):c.getObj(),(0,i.isStream)(t)||this._cacheMap.set(s,t),t},fetchCompressed(e,t){const r=t.offset,s=this.fetch(i.Ref.get(r,0));if(!(0,i.isStream)(s))throw new n.FormatError("bad ObjStm stream");const l=s.dict.get("First"),c=s.dict.get("N");if(!Number.isInteger(l)||!Number.isInteger(c))throw new n.FormatError("invalid first and n parameters for ObjStm stream");const u=new o.Parser({lexer:new o.Lexer(s),xref:this,allowStreams:!0}),h=new Array(c);for(let i=0;i<c;++i){const e=u.getObj();if(!Number.isInteger(e))throw new n.FormatError(`invalid object number in the ObjStm stream: ${e}`);const t=u.getObj();if(!Number.isInteger(t))throw new n.FormatError(`invalid object offset in the ObjStm stream: ${t}`);h[i]=e}const d=new Array(c);for(let n=0;n<c;++n){const e=u.getObj();if(d[n]=e,u.buf1 instanceof i.Cmd&&"endobj"===u.buf1.cmd&&u.shift(),(0,i.isStream)(e))continue;const t=h[n],o=this.entries[t];o&&o.offset===r&&o.gen===n&&this._cacheMap.set(t,e)}if(void 0===(t=d[t.gen]))throw new a.XRefEntryException(`Bad (compressed) XRef entry: ${e}`);return t},async fetchIfRefAsync(e,t){return e instanceof i.Ref?this.fetchAsync(e,t):e},async fetchAsync(e,t){try{return this.fetch(e,t)}catch(r){if(!(r instanceof a.MissingDataException))throw r;return await this.pdfManager.requestRange(r.begin,r.end),this.fetchAsync(e,t)}},getCatalogObj:function(){return this.root}},e}();t.XRef=d;class f{constructor(e,t,r){this.constructor===f&&(0,n.unreachable)("Cannot initialize NameOrNumberTree."),this.root=e,this.xref=t,this._type=r}getAll(){const e=Object.create(null);if(!this.root)return e;const t=this.xref,r=new i.RefSet;r.put(this.root);const o=[this.root];for(;o.length>0;){const a=t.fetchIfRef(o.shift());if(!(0,i.isDict)(a))continue;if(a.has("Kids")){const e=a.get("Kids");for(let t=0,i=e.length;t<i;t++){const i=e[t];if(r.has(i))throw new n.FormatError(`Duplicate entry in "${this._type}" tree.`);o.push(i),r.put(i)}continue}const s=a.get(this._type);if(Array.isArray(s))for(let r=0,n=s.length;r<n;r+=2)e[t.fetchIfRef(s[r])]=t.fetchIfRef(s[r+1])}return e}get(e){if(!this.root)return null;const t=this.xref;let r=t.fetchIfRef(this.root),i=0;for(;r.has("Kids");){if(++i>10)return(0,n.warn)(`Search depth limit reached for "${this._type}" tree.`),null;const o=r.get("Kids");if(!Array.isArray(o))return null;let a=0,s=o.length-1;for(;a<=s;){const n=a+s>>1,i=t.fetchIfRef(o[n]).get("Limits");if(e<t.fetchIfRef(i[0]))s=n-1;else{if(!(e>t.fetchIfRef(i[1]))){r=t.fetchIfRef(o[n]);break}a=n+1}}if(a>s)return null}const o=r.get(this._type);if(Array.isArray(o)){let r=0,i=o.length-2;for(;r<=i;){const n=r+i>>1,a=n+(1&n),s=t.fetchIfRef(o[a]);if(e<s)i=a-2;else{if(!(e>s))return t.fetchIfRef(o[a+1]);r=a+2}}(0,n.info)(`Falling back to an exhaustive search, for key "${e}", in "${this._type}" tree.`);for(let a=0,s=o.length;a<s;a+=2)if(t.fetchIfRef(o[a])===e)return(0,n.warn)(`The "${e}" key was found at an incorrect, i.e. out-of-order, position in "${this._type}" tree.`),t.fetchIfRef(o[a+1])}return null}}class g extends f{constructor(e,t){super(e,t,"Names")}}class p extends f{constructor(e,t){super(e,t,"Nums")}}var m=function(){function e(e,t){e&&(0,i.isDict)(e)&&(this.xref=t,this.root=e,e.has("FS")&&(this.fs=e.get("FS")),this.description=e.has("Desc")?(0,n.stringToPDFString)(e.get("Desc")):"",e.has("RF")&&(0,n.warn)("Related file specifications are not supported"),this.contentAvailable=!0,e.has("EF")||(this.contentAvailable=!1,(0,n.warn)("Non-embedded file specifications are not supported")))}function t(e){return e.has("UF")?e.get("UF"):e.has("F")?e.get("F"):e.has("Unix")?e.get("Unix"):e.has("Mac")?e.get("Mac"):e.has("DOS")?e.get("DOS"):null}return e.prototype={get filename(){if(!this._filename&&this.root){var e=t(this.root)||"unnamed";this._filename=(0,n.stringToPDFString)(e).replace(/\\\\/g,"\\").replace(/\\\//g,"/").replace(/\\/g,"/")}return this._filename},get content(){if(!this.contentAvailable)return null;!this.contentRef&&this.root&&(this.contentRef=t(this.root.get("EF")));var e=null;if(this.contentRef){var r=this.xref.fetchIfRef(this.contentRef);r&&(0,i.isStream)(r)?e=r.getBytes():(0,n.warn)("Embedded file specification points to non-existing/invalid content")}else(0,n.warn)("Embedded file specification does not have a content");return e},get serializable(){return{filename:this.filename,content:this.content}}},e}();t.FileSpec=m;const v=function(){function e(e,t){if(e instanceof i.Dict)e=e.getRawValues();else if((0,i.isStream)(e))e=e.dict.getRawValues();else if(!Array.isArray(e))return;for(const n of e)((r=n)instanceof i.Ref||r instanceof i.Dict||Array.isArray(r)||(0,i.isStream)(r))&&t.push(n);var r}function t(e,t,r){this.dict=e,this.keys=t,this.xref=r,this.refSet=null}return t.prototype={async load(){if(!this.xref.stream.allChunksLoaded||this.xref.stream.allChunksLoaded())return;const{keys:e,dict:t}=this;this.refSet=new i.RefSet;const r=[];for(let n=0,i=e.length;n<i;n++){const i=t.getRaw(e[n]);void 0!==i&&r.push(i)}return this._walk(r)},async _walk(t){const r=[],n=[];for(;t.length;){let s=t.pop();if(s instanceof i.Ref){if(this.refSet.has(s))continue;try{this.refSet.put(s),s=this.xref.fetch(s)}catch(o){if(!(o instanceof a.MissingDataException))throw o;r.push(s),n.push({begin:o.begin,end:o.end})}}if(s&&s.getBaseStreams){const e=s.getBaseStreams();let t=!1;for(let r=0,i=e.length;r<i;r++){const i=e[r];i.allChunksLoaded&&!i.allChunksLoaded()&&(t=!0,n.push({begin:i.start,end:i.end}))}t&&r.push(s)}e(s,t)}if(n.length){await this.xref.stream.manager.requestRanges(n);for(let e=0,t=r.length;e<t;e++){const t=r[e];t instanceof i.Ref&&this.refSet.remove(t)}return this._walk(r)}this.refSet=null}},t}();t.ObjectLoader=v},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Parser=t.Linearization=t.Lexer=void 0;var n=r(12),i=r(2),o=r(5),a=r(8),s=r(13),l=r(15),c=r(18),u=r(20);function h(e){const t=e.length;let r=1,n=0;for(let i=0;i<t;++i)r+=255&e[i],n+=r;return n%65521<<16|r%65521}class d{constructor(e){let{lexer:t,xref:r,allowStreams:n=!1,recoveryMode:i=!1}=e;this.lexer=t,this.xref=r,this.allowStreams=n,this.recoveryMode=i,this.imageCache=Object.create(null),this.refill()}refill(){this.buf1=this.lexer.getObj(),this.buf2=this.lexer.getObj()}shift(){this.buf2 instanceof o.Cmd&&"ID"===this.buf2.cmd?(this.buf1=this.buf2,this.buf2=null):(this.buf1=this.buf2,this.buf2=this.lexer.getObj())}tryShift(){try{return this.shift(),!0}catch(e){if(e instanceof a.MissingDataException)throw e;return!1}}getObj(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;const t=this.buf1;if(this.shift(),t instanceof o.Cmd)switch(t.cmd){case"BI":return this.makeInlineImage(e);case"[":const r=[];for(;!(0,o.isCmd)(this.buf1,"]")&&!(0,o.isEOF)(this.buf1);)r.push(this.getObj(e));if((0,o.isEOF)(this.buf1)){if(!this.recoveryMode)throw new i.FormatError("End of file inside array");return r}return this.shift(),r;case"<<":const n=new o.Dict(this.xref);for(;!(0,o.isCmd)(this.buf1,">>")&&!(0,o.isEOF)(this.buf1);){if(!(0,o.isName)(this.buf1)){(0,i.info)("Malformed dictionary: key must be a name object"),this.shift();continue}const t=this.buf1.name;if(this.shift(),(0,o.isEOF)(this.buf1))break;n.set(t,this.getObj(e))}if((0,o.isEOF)(this.buf1)){if(!this.recoveryMode)throw new i.FormatError("End of file inside dictionary");return n}return(0,o.isCmd)(this.buf2,"stream")?this.allowStreams?this.makeStream(n,e):n:(this.shift(),n);default:return t}if(Number.isInteger(t)){if(Number.isInteger(this.buf1)&&(0,o.isCmd)(this.buf2,"R")){const e=o.Ref.get(t,this.buf1);return this.shift(),this.shift(),e}return t}return"string"===typeof t&&e?e.decryptString(t):t}findDefaultInlineStreamEnd(e){const t=this.lexer,r=e.pos;let n,s,l=0;for(;-1!==(n=e.getByte());)if(0===l)l=69===n?1:0;else if(1===l)l=73===n?2:0;else if((0,i.assert)(2===l,"findDefaultInlineStreamEnd - invalid state."),32===n||10===n||13===n){s=e.pos;const r=e.peekBytes(10);for(let e=0,t=r.length;e<t;e++)if(n=r[e],(0!==n||0===r[e+1])&&10!==n&&13!==n&&(n<32||n>127)){l=0;break}if(2!==l)continue;if(t.knownCommands){const e=t.peekObj();e instanceof o.Cmd&&!t.knownCommands[e.cmd]&&(l=0)}else(0,i.warn)("findDefaultInlineStreamEnd - `lexer.knownCommands` is undefined.");if(2===l)break}else l=0;-1===n&&((0,i.warn)("findDefaultInlineStreamEnd: Reached the end of the stream without finding a valid EI marker"),s&&((0,i.warn)('... trying to recover by using the last "EI" occurrence.'),e.skip(-(e.pos-s))));let c=4;return e.skip(-c),n=e.peekByte(),e.skip(c),(0,a.isWhiteSpace)(n)||c--,e.pos-c-r}findDCTDecodeInlineStreamEnd(e){const t=e.pos;let r,n,o=!1;for(;-1!==(r=e.getByte());)if(255===r){switch(e.getByte()){case 0:break;case 255:e.skip(-1);break;case 217:o=!0;break;case 192:case 193:case 194:case 195:case 197:case 198:case 199:case 201:case 202:case 203:case 205:case 206:case 207:case 196:case 204:case 218:case 219:case 220:case 221:case 222:case 223:case 224:case 225:case 226:case 227:case 228:case 229:case 230:case 231:case 232:case 233:case 234:case 235:case 236:case 237:case 238:case 239:case 254:n=e.getUint16(),n>2?e.skip(n-2):e.skip(-2)}if(o)break}const a=e.pos-t;return-1===r?((0,i.warn)("Inline DCTDecode image stream: EOI marker not found, searching for /EI/ instead."),e.skip(-a),this.findDefaultInlineStreamEnd(e)):(this.inlineStreamSkipEI(e),a)}findASCII85DecodeInlineStreamEnd(e){const t=e.pos;let r;for(;-1!==(r=e.getByte());)if(126===r){const t=e.pos;for(r=e.peekByte();(0,a.isWhiteSpace)(r);)e.skip(),r=e.peekByte();if(62===r){e.skip();break}if(e.pos>t){const t=e.peekBytes(2);if(69===t[0]&&73===t[1])break}}const n=e.pos-t;return-1===r?((0,i.warn)("Inline ASCII85Decode image stream: EOD marker not found, searching for /EI/ instead."),e.skip(-n),this.findDefaultInlineStreamEnd(e)):(this.inlineStreamSkipEI(e),n)}findASCIIHexDecodeInlineStreamEnd(e){const t=e.pos;let r;for(;-1!==(r=e.getByte())&&62!==r;);const n=e.pos-t;return-1===r?((0,i.warn)("Inline ASCIIHexDecode image stream: EOD marker not found, searching for /EI/ instead."),e.skip(-n),this.findDefaultInlineStreamEnd(e)):(this.inlineStreamSkipEI(e),n)}inlineStreamSkipEI(e){let t,r=0;for(;-1!==(t=e.getByte());)if(0===r)r=69===t?1:0;else if(1===r)r=73===t?2:0;else if(2===r)break}makeInlineImage(e){const t=this.lexer,r=t.stream,n=new o.Dict(this.xref);let a;for(;!(0,o.isCmd)(this.buf1,"ID")&&!(0,o.isEOF)(this.buf1);){if(!(0,o.isName)(this.buf1))throw new i.FormatError("Dictionary key must be a name object");const t=this.buf1.name;if(this.shift(),(0,o.isEOF)(this.buf1))break;n.set(t,this.getObj(e))}-1!==t.beginInlineImagePos&&(a=r.pos-t.beginInlineImagePos);const s=n.get("Filter","F");let l;if((0,o.isName)(s))l=s.name;else if(Array.isArray(s)){const e=this.xref.fetchIfRef(s[0]);(0,o.isName)(e)&&(l=e.name)}const c=r.pos;let u;u="DCTDecode"===l||"DCT"===l?this.findDCTDecodeInlineStreamEnd(r):"ASCII85Decode"===l||"A85"===l?this.findASCII85DecodeInlineStreamEnd(r):"ASCIIHexDecode"===l||"AHx"===l?this.findASCIIHexDecodeInlineStreamEnd(r):this.findDefaultInlineStreamEnd(r);let d,f=r.makeSubStream(c,u,n);if(u<1e3&&a<5552){const e=f.getBytes();f.reset();const n=r.pos;r.pos=t.beginInlineImagePos;const i=r.getBytes(a);r.pos=n,d=h(e)+"_"+h(i);const s=this.imageCache[d];if(void 0!==s)return this.buf2=o.Cmd.get("EI"),this.shift(),s.reset(),s}return e&&(f=e.createStream(f,u)),f=this.filter(f,n,u),f.dict=n,void 0!==d&&(f.cacheKey=`inline_${u}_${d}`,this.imageCache[d]=f),this.buf2=o.Cmd.get("EI"),this.shift(),f}_findStreamLength(e,t){const{stream:r}=this.lexer;r.pos=e;const n=t.length;for(;r.pos<r.end;){const i=r.peekBytes(2048),o=i.length-n;if(o<=0)break;let a=0;for(;a<o;){let o=0;for(;o<n&&i[a+o]===t[o];)o++;if(o>=n)return r.pos+=a,r.pos-e;a++}r.pos+=o}return-1}makeStream(e,t){const r=this.lexer;let n=r.stream;r.skipToNextLine();const s=n.pos-1;let l=e.get("Length");if(Number.isInteger(l)||((0,i.info)(`Bad length "${l}" in stream`),l=0),n.pos=s+l,r.nextChar(),this.tryShift()&&(0,o.isCmd)(this.buf2,"endstream"))this.shift();else{const e=new Uint8Array([101,110,100,115,116,114,101,97,109]);let t=this._findStreamLength(s,e);if(t<0){const r=1;for(let o=1;o<=r;o++){const r=e.length-o,l=e.slice(0,r),c=this._findStreamLength(s,l);if(c>=0){const e=n.peekBytes(r+1)[r];if(!(0,a.isWhiteSpace)(e))break;(0,i.info)(`Found "${(0,i.bytesToString)(l)}" when searching for endstream command.`),t=c;break}}if(t<0)throw new i.FormatError("Missing endstream command.")}l=t,r.nextChar(),this.shift(),this.shift()}return this.shift(),n=n.makeSubStream(s,l,e),t&&(n=t.createStream(n,l)),n=this.filter(n,e,l),n.dict=e,n}filter(e,t,r){let n=t.get("Filter","F"),a=t.get("DecodeParms","DP");if((0,o.isName)(n))return Array.isArray(a)&&(0,i.warn)("/DecodeParms should not contain an Array, when /Filter contains a Name."),this.makeFilter(e,n.name,r,a);let s=r;if(Array.isArray(n)){const t=n,r=a;for(let l=0,c=t.length;l<c;++l){if(n=this.xref.fetchIfRef(t[l]),!(0,o.isName)(n))throw new i.FormatError(`Bad filter name "${n}"`);a=null,Array.isArray(r)&&l in r&&(a=this.xref.fetchIfRef(r[l])),e=this.makeFilter(e,n.name,s,a),s=null}}return e}makeFilter(e,t,r,o){if(0===r)return(0,i.warn)(`Empty "${t}" stream.`),new n.NullStream;try{const a=this.xref.stats.streamTypes;if("FlateDecode"===t||"Fl"===t)return a[i.StreamType.FLATE]=!0,o?new n.PredictorStream(new n.FlateStream(e,r),r,o):new n.FlateStream(e,r);if("LZWDecode"===t||"LZW"===t){a[i.StreamType.LZW]=!0;let t=1;return o?(o.has("EarlyChange")&&(t=o.get("EarlyChange")),new n.PredictorStream(new n.LZWStream(e,r,t),r,o)):new n.LZWStream(e,r,t)}return"DCTDecode"===t||"DCT"===t?(a[i.StreamType.DCT]=!0,new c.JpegStream(e,r,e.dict,o)):"JPXDecode"===t||"JPX"===t?(a[i.StreamType.JPX]=!0,new u.JpxStream(e,r,e.dict,o)):"ASCII85Decode"===t||"A85"===t?(a[i.StreamType.A85]=!0,new n.Ascii85Stream(e,r)):"ASCIIHexDecode"===t||"AHx"===t?(a[i.StreamType.AHX]=!0,new n.AsciiHexStream(e,r)):"CCITTFaxDecode"===t||"CCF"===t?(a[i.StreamType.CCF]=!0,new s.CCITTFaxStream(e,r,o)):"RunLengthDecode"===t||"RL"===t?(a[i.StreamType.RLX]=!0,new n.RunLengthStream(e,r)):"JBIG2Decode"===t?(a[i.StreamType.JBIG]=!0,new l.Jbig2Stream(e,r,e.dict,o)):((0,i.warn)(`Filter "${t}" is not supported.`),e)}catch(h){if(h instanceof a.MissingDataException)throw h;return(0,i.warn)(`Invalid stream: "${h}"`),new n.NullStream}}}t.Parser=d;const f=[1,0,0,0,0,0,0,0,0,1,1,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,2,0,0,2,2,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,2,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];function g(e){return e>=48&&e<=57?15&e:e>=65&&e<=70||e>=97&&e<=102?9+(15&e):-1}class p{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.stream=e,this.nextChar(),this.strBuf=[],this.knownCommands=t,this._hexStringNumWarn=0,this.beginInlineImagePos=-1}nextChar(){return this.currentChar=this.stream.getByte()}peekChar(){return this.stream.peekByte()}getNumber(){let e=this.currentChar,t=!1,r=0,n=0;if(45===e?(n=-1,e=this.nextChar(),45===e&&(e=this.nextChar())):43===e&&(n=1,e=this.nextChar()),10===e||13===e)do{e=this.nextChar()}while(10===e||13===e);if(46===e&&(r=10,e=this.nextChar()),e<48||e>57){if(10===r&&0===n&&((0,a.isWhiteSpace)(e)||-1===e))return(0,i.warn)("Lexer.getNumber - treating a single decimal point as zero."),0;throw new i.FormatError(`Invalid number: ${String.fromCharCode(e)} (charCode ${e})`)}n=n||1;let o=e-48,s=0,l=1;for(;(e=this.nextChar())>=0;)if(e>=48&&e<=57){const n=e-48;t?s=10*s+n:(0!==r&&(r*=10),o=10*o+n)}else if(46===e){if(0!==r)break;r=1}else if(45===e)(0,i.warn)("Badly formatted number: minus sign in the middle");else{if(69!==e&&101!==e)break;if(e=this.peekChar(),43===e||45===e)l=45===e?-1:1,this.nextChar();else if(e<48||e>57)break;t=!0}return 0!==r&&(o/=r),t&&(o*=10**(l*s)),n*o}getString(){let e=1,t=!1;const r=this.strBuf;r.length=0;let n=this.nextChar();for(;;){let o=!1;switch(0|n){case-1:(0,i.warn)("Unterminated string"),t=!0;break;case 40:++e,r.push("(");break;case 41:0===--e?(this.nextChar(),t=!0):r.push(")");break;case 92:switch(n=this.nextChar(),n){case-1:(0,i.warn)("Unterminated string"),t=!0;break;case 110:r.push("\n");break;case 114:r.push("\r");break;case 116:r.push("\t");break;case 98:r.push("\b");break;case 102:r.push("\f");break;case 92:case 40:case 41:r.push(String.fromCharCode(n));break;case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:let e=15&n;n=this.nextChar(),o=!0,n>=48&&n<=55&&(e=(e<<3)+(15&n),n=this.nextChar(),n>=48&&n<=55&&(o=!1,e=(e<<3)+(15&n))),r.push(String.fromCharCode(e));break;case 13:10===this.peekChar()&&this.nextChar();break;case 10:break;default:r.push(String.fromCharCode(n))}break;default:r.push(String.fromCharCode(n))}if(t)break;o||(n=this.nextChar())}return r.join("")}getName(){let e,t;const r=this.strBuf;for(r.length=0;(e=this.nextChar())>=0&&!f[e];)if(35===e){if(e=this.nextChar(),f[e]){(0,i.warn)("Lexer_getName: NUMBER SIGN (#) should be followed by a hexadecimal number."),r.push("#");break}const n=g(e);if(-1!==n){t=e,e=this.nextChar();const o=g(e);if(-1===o){if((0,i.warn)(`Lexer_getName: Illegal digit (${String.fromCharCode(e)}) in hexadecimal number.`),r.push("#",String.fromCharCode(t)),f[e])break;r.push(String.fromCharCode(e));continue}r.push(String.fromCharCode(n<<4|o))}else r.push("#",String.fromCharCode(e))}else r.push(String.fromCharCode(e));return r.length>127&&(0,i.warn)(`Name token is longer than allowed by the spec: ${r.length}`),o.Name.get(r.join(""))}_hexStringWarn(e){5!==this._hexStringNumWarn++?this._hexStringNumWarn>5||(0,i.warn)(`getHexString - ignoring invalid character: ${e}`):(0,i.warn)("getHexString - ignoring additional invalid characters.")}getHexString(){const e=this.strBuf;e.length=0;let t,r,n=this.currentChar,o=!0;for(this._hexStringNumWarn=0;;){if(n<0){(0,i.warn)("Unterminated hex string");break}if(62===n){this.nextChar();break}if(1!==f[n]){if(o){if(t=g(n),-1===t){this._hexStringWarn(n),n=this.nextChar();continue}}else{if(r=g(n),-1===r){this._hexStringWarn(n),n=this.nextChar();continue}e.push(String.fromCharCode(t<<4|r))}o=!o,n=this.nextChar()}else n=this.nextChar()}return e.join("")}getObj(){let e=!1,t=this.currentChar;for(;;){if(t<0)return o.EOF;if(e)10!==t&&13!==t||(e=!1);else if(37===t)e=!0;else if(1!==f[t])break;t=this.nextChar()}switch(0|t){case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:case 43:case 45:case 46:return this.getNumber();case 40:return this.getString();case 47:return this.getName();case 91:return this.nextChar(),o.Cmd.get("[");case 93:return this.nextChar(),o.Cmd.get("]");case 60:return t=this.nextChar(),60===t?(this.nextChar(),o.Cmd.get("<<")):this.getHexString();case 62:return t=this.nextChar(),62===t?(this.nextChar(),o.Cmd.get(">>")):o.Cmd.get(">");case 123:return this.nextChar(),o.Cmd.get("{");case 125:return this.nextChar(),o.Cmd.get("}");case 41:throw this.nextChar(),new i.FormatError(`Illegal character: ${t}`)}let r=String.fromCharCode(t);const n=this.knownCommands;let a=n&&void 0!==n[r];for(;(t=this.nextChar())>=0&&!f[t];){const e=r+String.fromCharCode(t);if(a&&void 0===n[e])break;if(128===r.length)throw new i.FormatError(`Command token too long: ${r.length}`);r=e,a=n&&void 0!==n[r]}return"true"===r||"false"!==r&&("null"===r?null:("BI"===r&&(this.beginInlineImagePos=this.stream.pos),o.Cmd.get(r)))}peekObj(){const e=this.stream.pos,t=this.currentChar,r=this.beginInlineImagePos;let n;try{n=this.getObj()}catch(o){if(o instanceof a.MissingDataException)throw o;(0,i.warn)(`peekObj: ${o}`)}return this.stream.pos=e,this.currentChar=t,this.beginInlineImagePos=r,n}skipToNextLine(){let e=this.currentChar;for(;e>=0;){if(13===e){e=this.nextChar(),10===e&&this.nextChar();break}if(10===e){this.nextChar();break}e=this.nextChar()}}}t.Lexer=p,t.Linearization=class{static create(e){function t(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n=e.get(t);if(Number.isInteger(n)&&(r?n>=0:n>0))return n;throw new Error(`The "${t}" parameter in the linearization dictionary is invalid.`)}const r=new d({lexer:new p(e),xref:null}),n=r.getObj(),a=r.getObj(),s=r.getObj(),l=r.getObj();let c,u;if(!(Number.isInteger(n)&&Number.isInteger(a)&&(0,o.isCmd)(s,"obj")&&(0,o.isDict)(l)&&(0,i.isNum)(c=l.get("Linearized"))&&c>0))return null;if((u=t(l,"L"))!==e.length)throw new Error('The "L" parameter in the linearization dictionary does not equal the stream length.');return{length:u,hints:function(e){const t=e.get("H");let r;if(Array.isArray(t)&&(2===(r=t.length)||4===r)){for(let e=0;e<r;e++){const r=t[e];if(!(Number.isInteger(r)&&r>0))throw new Error(`Hint (${e}) in the linearization dictionary is invalid.`)}return t}throw new Error("Hint array in the linearization dictionary is invalid.")}(l),objectNumberFirst:t(l,"O"),endFirst:t(l,"E"),numPages:t(l,"N"),mainXRefEntriesOffset:t(l,"T"),pageFirst:l.has("P")?t(l,"P",!0):0}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LZWStream=t.StringStream=t.StreamsSequenceStream=t.Stream=t.RunLengthStream=t.PredictorStream=t.NullStream=t.FlateStream=t.DecodeStream=t.DecryptStream=t.AsciiHexStream=t.Ascii85Stream=void 0;var n=r(2),i=r(5),o=r(8),a=function(){function e(e,t,r,n){this.bytes=e instanceof Uint8Array?e:new Uint8Array(e),this.start=t||0,this.pos=this.start,this.end=t+r||this.bytes.length,this.dict=n}return e.prototype={get length(){return this.end-this.start},get isEmpty(){return 0===this.length},getByte:function(){return this.pos>=this.end?-1:this.bytes[this.pos++]},getUint16:function(){var e=this.getByte(),t=this.getByte();return-1===e||-1===t?-1:(e<<8)+t},getInt32:function(){return(this.getByte()<<24)+(this.getByte()<<16)+(this.getByte()<<8)+this.getByte()},getBytes(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];var r=this.bytes,n=this.pos,i=this.end;if(!e){const e=r.subarray(n,i);return t?new Uint8ClampedArray(e):e}var o=n+e;o>i&&(o=i),this.pos=o;const a=r.subarray(n,o);return t?new Uint8ClampedArray(a):a},peekByte:function(){var e=this.getByte();return-1!==e&&this.pos--,e},peekBytes(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];var r=this.getBytes(e,t);return this.pos-=r.length,r},getByteRange(e,t){return e<0&&(e=0),t>this.end&&(t=this.end),this.bytes.subarray(e,t)},skip:function(e){e||(e=1),this.pos+=e},reset:function(){this.pos=this.start},moveStart:function(){this.start=this.pos},makeSubStream:function(t,r,n){return new e(this.bytes.buffer,t,r,n)}},e}();t.Stream=a;var s=function(){function e(e){const t=(0,n.stringToBytes)(e);a.call(this,t)}return e.prototype=a.prototype,e}();t.StringStream=s;var l=function(){var e=new Uint8Array(0);function t(t){if(this._rawMinBufferLength=t||0,this.pos=0,this.bufferLength=0,this.eof=!1,this.buffer=e,this.minBufferLength=512,t)for(;this.minBufferLength<t;)this.minBufferLength*=2}return t.prototype={get isEmpty(){for(;!this.eof&&0===this.bufferLength;)this.readBlock();return 0===this.bufferLength},ensureBuffer:function(e){var t=this.buffer;if(e<=t.byteLength)return t;for(var r=this.minBufferLength;r<e;)r*=2;var n=new Uint8Array(r);return n.set(t),this.buffer=n},getByte:function(){for(var e=this.pos;this.bufferLength<=e;){if(this.eof)return-1;this.readBlock()}return this.buffer[this.pos++]},getUint16:function(){var e=this.getByte(),t=this.getByte();return-1===e||-1===t?-1:(e<<8)+t},getInt32:function(){return(this.getByte()<<24)+(this.getByte()<<16)+(this.getByte()<<8)+this.getByte()},getBytes(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];var r,n=this.pos;if(e){for(this.ensureBuffer(n+e),r=n+e;!this.eof&&this.bufferLength<r;)this.readBlock();var i=this.bufferLength;r>i&&(r=i)}else{for(;!this.eof;)this.readBlock();r=this.bufferLength}this.pos=r;const o=this.buffer.subarray(n,r);return!t||o instanceof Uint8ClampedArray?o:new Uint8ClampedArray(o)},peekByte:function(){var e=this.getByte();return-1!==e&&this.pos--,e},peekBytes(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];var r=this.getBytes(e,t);return this.pos-=r.length,r},makeSubStream:function(e,t,r){for(var n=e+t;this.bufferLength<=n&&!this.eof;)this.readBlock();return new a(this.buffer,e,t,r)},getByteRange(e,t){(0,n.unreachable)("Should not call DecodeStream.getByteRange")},skip:function(e){e||(e=1),this.pos+=e},reset:function(){this.pos=0},getBaseStreams:function(){return this.str&&this.str.getBaseStreams?this.str.getBaseStreams():[]}},t}();t.DecodeStream=l;var c=function(){function e(e){this.streams=e;let t=0;for(let r=0,n=e.length;r<n;r++){const n=e[r];t+=n instanceof l?n._rawMinBufferLength:n.length}l.call(this,t)}return e.prototype=Object.create(l.prototype),e.prototype.readBlock=function(){var e=this.streams;if(0!==e.length){var t=e.shift().getBytes(),r=this.bufferLength,n=r+t.length;this.ensureBuffer(n).set(t,r),this.bufferLength=n}else this.eof=!0},e.prototype.getBaseStreams=function(){for(var e=[],t=0,r=this.streams.length;t<r;t++){var n=this.streams[t];n.getBaseStreams&&e.push(...n.getBaseStreams())}return e},e}();t.StreamsSequenceStream=c;var u=function(){var e=new Int32Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),t=new Int32Array([3,4,5,6,7,8,9,10,65547,65549,65551,65553,131091,131095,131099,131103,196643,196651,196659,196667,262211,262227,262243,262259,327811,327843,327875,327907,258,258,258]),r=new Int32Array([1,2,3,4,65541,65543,131081,131085,196625,196633,262177,262193,327745,327777,393345,393409,459009,459137,524801,525057,590849,591361,657409,658433,724993,727041,794625,798721,868353,876545]),i=[new Int32Array([459008,524368,524304,524568,459024,524400,524336,590016,459016,524384,524320,589984,524288,524416,524352,590048,459012,524376,524312,589968,459028,524408,524344,590032,459020,524392,524328,59e4,524296,524424,524360,590064,459010,524372,524308,524572,459026,524404,524340,590024,459018,524388,524324,589992,524292,524420,524356,590056,459014,524380,524316,589976,459030,524412,524348,590040,459022,524396,524332,590008,524300,524428,524364,590072,459009,524370,524306,524570,459025,524402,524338,590020,459017,524386,524322,589988,524290,524418,524354,590052,459013,524378,524314,589972,459029,524410,524346,590036,459021,524394,524330,590004,524298,524426,524362,590068,459011,524374,524310,524574,459027,524406,524342,590028,459019,524390,524326,589996,524294,524422,524358,590060,459015,524382,524318,589980,459031,524414,524350,590044,459023,524398,524334,590012,524302,524430,524366,590076,459008,524369,524305,524569,459024,524401,524337,590018,459016,524385,524321,589986,524289,524417,524353,590050,459012,524377,524313,589970,459028,524409,524345,590034,459020,524393,524329,590002,524297,524425,524361,590066,459010,524373,524309,524573,459026,524405,524341,590026,459018,524389,524325,589994,524293,524421,524357,590058,459014,524381,524317,589978,459030,524413,524349,590042,459022,524397,524333,590010,524301,524429,524365,590074,459009,524371,524307,524571,459025,524403,524339,590022,459017,524387,524323,589990,524291,524419,524355,590054,459013,524379,524315,589974,459029,524411,524347,590038,459021,524395,524331,590006,524299,524427,524363,590070,459011,524375,524311,524575,459027,524407,524343,590030,459019,524391,524327,589998,524295,524423,524359,590062,459015,524383,524319,589982,459031,524415,524351,590046,459023,524399,524335,590014,524303,524431,524367,590078,459008,524368,524304,524568,459024,524400,524336,590017,459016,524384,524320,589985,524288,524416,524352,590049,459012,524376,524312,589969,459028,524408,524344,590033,459020,524392,524328,590001,524296,524424,524360,590065,459010,524372,524308,524572,459026,524404,524340,590025,459018,524388,524324,589993,524292,524420,524356,590057,459014,524380,524316,589977,459030,524412,524348,590041,459022,524396,524332,590009,524300,524428,524364,590073,459009,524370,524306,524570,459025,524402,524338,590021,459017,524386,524322,589989,524290,524418,524354,590053,459013,524378,524314,589973,459029,524410,524346,590037,459021,524394,524330,590005,524298,524426,524362,590069,459011,524374,524310,524574,459027,524406,524342,590029,459019,524390,524326,589997,524294,524422,524358,590061,459015,524382,524318,589981,459031,524414,524350,590045,459023,524398,524334,590013,524302,524430,524366,590077,459008,524369,524305,524569,459024,524401,524337,590019,459016,524385,524321,589987,524289,524417,524353,590051,459012,524377,524313,589971,459028,524409,524345,590035,459020,524393,524329,590003,524297,524425,524361,590067,459010,524373,524309,524573,459026,524405,524341,590027,459018,524389,524325,589995,524293,524421,524357,590059,459014,524381,524317,589979,459030,524413,524349,590043,459022,524397,524333,590011,524301,524429,524365,590075,459009,524371,524307,524571,459025,524403,524339,590023,459017,524387,524323,589991,524291,524419,524355,590055,459013,524379,524315,589975,459029,524411,524347,590039,459021,524395,524331,590007,524299,524427,524363,590071,459011,524375,524311,524575,459027,524407,524343,590031,459019,524391,524327,589999,524295,524423,524359,590063,459015,524383,524319,589983,459031,524415,524351,590047,459023,524399,524335,590015,524303,524431,524367,590079]),9],o=[new Int32Array([327680,327696,327688,327704,327684,327700,327692,327708,327682,327698,327690,327706,327686,327702,327694,0,327681,327697,327689,327705,327685,327701,327693,327709,327683,327699,327691,327707,327687,327703,327695,0]),5];function a(e,t){this.str=e,this.dict=e.dict;var r=e.getByte(),i=e.getByte();if(-1===r||-1===i)throw new n.FormatError(`Invalid header in flate stream: ${r}, ${i}`);if(8!==(15&r))throw new n.FormatError(`Unknown compression method in flate stream: ${r}, ${i}`);if(((r<<8)+i)%31!==0)throw new n.FormatError(`Bad FCHECK in flate stream: ${r}, ${i}`);if(32&i)throw new n.FormatError(`FDICT bit set in flate stream: ${r}, ${i}`);this.codeSize=0,this.codeBuf=0,l.call(this,t)}return a.prototype=Object.create(l.prototype),a.prototype.getBits=function(e){for(var t,r=this.str,i=this.codeSize,o=this.codeBuf;i<e;){if(-1===(t=r.getByte()))throw new n.FormatError("Bad encoding in flate stream");o|=t<<i,i+=8}return t=o&(1<<e)-1,this.codeBuf=o>>e,this.codeSize=i-=e,t},a.prototype.getCode=function(e){for(var t,r=this.str,i=e[0],o=e[1],a=this.codeSize,s=this.codeBuf;a<o&&-1!==(t=r.getByte());)s|=t<<a,a+=8;var l=i[s&(1<<o)-1],c=l>>16,u=65535&l;if(c<1||a<c)throw new n.FormatError("Bad encoding in flate stream");return this.codeBuf=s>>c,this.codeSize=a-c,u},a.prototype.generateHuffmanTable=function(e){var t,r=e.length,n=0;for(t=0;t<r;++t)e[t]>n&&(n=e[t]);for(var i=1<<n,o=new Int32Array(i),a=1,s=0,l=2;a<=n;++a,s<<=1,l<<=1)for(var c=0;c<r;++c)if(e[c]===a){var u=0,h=s;for(t=0;t<a;++t)u=u<<1|1&h,h>>=1;for(t=u;t<i;t+=l)o[t]=a<<16|c;++s}return[o,n]},a.prototype.readBlock=function(){var a,s,l=this.str,c=this.getBits(3);if(1&c&&(this.eof=!0),0!==(c>>=1)){var u,h;if(1===c)u=i,h=o;else{if(2!==c)throw new n.FormatError("Unknown block type in flate stream");var d,f=this.getBits(5)+257,g=this.getBits(5)+1,p=this.getBits(4)+4,m=new Uint8Array(e.length);for(d=0;d<p;++d)m[e[d]]=this.getBits(3);var v=this.generateHuffmanTable(m);s=0,d=0;for(var b,y,w,S=f+g,C=new Uint8Array(S);d<S;){var k=this.getCode(v);if(16===k)b=2,y=3,w=s;else if(17===k)b=3,y=3,w=s=0;else{if(18!==k){C[d++]=s=k;continue}b=7,y=11,w=s=0}for(var x=this.getBits(b)+y;x-- >0;)C[d++]=w}u=this.generateHuffmanTable(C.subarray(0,f)),h=this.generateHuffmanTable(C.subarray(f,S))}for(var E=(a=this.buffer)?a.length:0,T=this.bufferLength;;){var _=this.getCode(u);if(_<256)T+1>=E&&(E=(a=this.ensureBuffer(T+1)).length),a[T++]=_;else{if(256===_)return void(this.bufferLength=T);var A=(_=t[_-=257])>>16;A>0&&(A=this.getBits(A)),s=(65535&_)+A,_=this.getCode(h),(A=(_=r[_])>>16)>0&&(A=this.getBits(A));var R=(65535&_)+A;T+s>=E&&(E=(a=this.ensureBuffer(T+s)).length);for(var O=0;O<s;++O,++T)a[T]=a[T-R]}}}else{var M;if(-1===(M=l.getByte()))throw new n.FormatError("Bad block header in flate stream");var I=M;if(-1===(M=l.getByte()))throw new n.FormatError("Bad block header in flate stream");if(I|=M<<8,-1===(M=l.getByte()))throw new n.FormatError("Bad block header in flate stream");var P=M;if(-1===(M=l.getByte()))throw new n.FormatError("Bad block header in flate stream");if((P|=M<<8)!==(65535&~I)&&(0!==I||0!==P))throw new n.FormatError("Bad uncompressed block length in flate stream");this.codeBuf=0,this.codeSize=0;const e=this.bufferLength,t=e+I;if(a=this.ensureBuffer(t),this.bufferLength=t,0===I)-1===l.peekByte()&&(this.eof=!0);else{const t=l.getBytes(I);a.set(t,e),t.length<I&&(this.eof=!0)}}},a}();t.FlateStream=u;var h=function(){function e(e,t,r){if(!(0,i.isDict)(r))return e;var o=this.predictor=r.get("Predictor")||1;if(o<=1)return e;if(2!==o&&(o<10||o>15))throw new n.FormatError(`Unsupported predictor: ${o}`);this.readBlock=2===o?this.readBlockTiff:this.readBlockPng,this.str=e,this.dict=e.dict;var a=this.colors=r.get("Colors")||1,s=this.bits=r.get("BitsPerComponent")||8,c=this.columns=r.get("Columns")||1;return this.pixBytes=a*s+7>>3,this.rowBytes=c*a*s+7>>3,l.call(this,t),this}return e.prototype=Object.create(l.prototype),e.prototype.readBlockTiff=function(){var e=this.rowBytes,t=this.bufferLength,r=this.ensureBuffer(t+e),n=this.bits,i=this.colors,o=this.str.getBytes(e);if(this.eof=!o.length,!this.eof){var a,s=0,l=0,c=0,u=0,h=t;if(1===n&&1===i)for(a=0;a<e;++a){var d=o[a]^s;d^=d>>1,d^=d>>2,s=(1&(d^=d>>4))<<7,r[h++]=d}else if(8===n){for(a=0;a<i;++a)r[h++]=o[a];for(;a<e;++a)r[h]=r[h-i]+o[a],h++}else if(16===n){var f=2*i;for(a=0;a<f;++a)r[h++]=o[a];for(;a<e;a+=2){var g=((255&o[a])<<8)+(255&o[a+1])+((255&r[h-f])<<8)+(255&r[h-f+1]);r[h++]=g>>8&255,r[h++]=255&g}}else{var p=new Uint8Array(i+1),m=(1<<n)-1,v=0,b=t,y=this.columns;for(a=0;a<y;++a)for(var w=0;w<i;++w)c<n&&(s=s<<8|255&o[v++],c+=8),p[w]=p[w]+(s>>c-n)&m,c-=n,l=l<<n|p[w],(u+=n)>=8&&(r[b++]=l>>u-8&255,u-=8);u>0&&(r[b++]=(l<<8-u)+(s&(1<<8-u)-1))}this.bufferLength+=e}},e.prototype.readBlockPng=function(){var e=this.rowBytes,t=this.pixBytes,r=this.str.getByte(),i=this.str.getBytes(e);if(this.eof=!i.length,!this.eof){var o=this.bufferLength,a=this.ensureBuffer(o+e),s=a.subarray(o-e,o);0===s.length&&(s=new Uint8Array(e));var l,c,u,h=o;switch(r){case 0:for(l=0;l<e;++l)a[h++]=i[l];break;case 1:for(l=0;l<t;++l)a[h++]=i[l];for(;l<e;++l)a[h]=a[h-t]+i[l]&255,h++;break;case 2:for(l=0;l<e;++l)a[h++]=s[l]+i[l]&255;break;case 3:for(l=0;l<t;++l)a[h++]=(s[l]>>1)+i[l];for(;l<e;++l)a[h]=(s[l]+a[h-t]>>1)+i[l]&255,h++;break;case 4:for(l=0;l<t;++l)c=s[l],u=i[l],a[h++]=c+u;for(;l<e;++l){c=s[l];var d=s[l-t],f=a[h-t],g=f+c-d,p=g-f;p<0&&(p=-p);var m=g-c;m<0&&(m=-m);var v=g-d;v<0&&(v=-v),u=i[l],a[h++]=p<=m&&p<=v?f+u:m<=v?c+u:d+u}break;default:throw new n.FormatError(`Unsupported predictor: ${r}`)}this.bufferLength+=e}},e}();t.PredictorStream=h;var d=function(){function e(e,t,r){this.str=e,this.dict=e.dict,this.decrypt=r,this.nextChunk=null,this.initialized=!1,l.call(this,t)}return e.prototype=Object.create(l.prototype),e.prototype.readBlock=function(){var e;if(this.initialized?e=this.nextChunk:(e=this.str.getBytes(512),this.initialized=!0),e&&0!==e.length){this.nextChunk=this.str.getBytes(512);var t=this.nextChunk&&this.nextChunk.length>0;e=(0,this.decrypt)(e,!t);var r,n=this.bufferLength,i=e.length,o=this.ensureBuffer(n+i);for(r=0;r<i;r++)o[n++]=e[r];this.bufferLength=n}else this.eof=!0},e}();t.DecryptStream=d;var f=function(){function e(e,t){this.str=e,this.dict=e.dict,this.input=new Uint8Array(5),t&&(t*=.8),l.call(this,t)}return e.prototype=Object.create(l.prototype),e.prototype.readBlock=function(){for(var e=this.str,t=e.getByte();(0,o.isWhiteSpace)(t);)t=e.getByte();if(-1!==t&&126!==t){var r,n,i=this.bufferLength;if(122===t){for(r=this.ensureBuffer(i+4),n=0;n<4;++n)r[i+n]=0;this.bufferLength+=4}else{var a=this.input;for(a[0]=t,n=1;n<5;++n){for(t=e.getByte();(0,o.isWhiteSpace)(t);)t=e.getByte();if(a[n]=t,-1===t||126===t)break}if(r=this.ensureBuffer(i+n-1),this.bufferLength+=n-1,n<5){for(;n<5;++n)a[n]=117;this.eof=!0}var s=0;for(n=0;n<5;++n)s=85*s+(a[n]-33);for(n=3;n>=0;--n)r[i+n]=255&s,s>>=8}}else this.eof=!0},e}();t.Ascii85Stream=f;var g=function(){function e(e,t){this.str=e,this.dict=e.dict,this.firstDigit=-1,t&&(t*=.5),l.call(this,t)}return e.prototype=Object.create(l.prototype),e.prototype.readBlock=function(){var e=this.str.getBytes(8e3);if(e.length){for(var t=e.length+1>>1,r=this.ensureBuffer(this.bufferLength+t),n=this.bufferLength,i=this.firstDigit,o=0,a=e.length;o<a;o++){var s,l=e[o];if(l>=48&&l<=57)s=15&l;else{if(!(l>=65&&l<=70||l>=97&&l<=102)){if(62===l){this.eof=!0;break}continue}s=9+(15&l)}i<0?i=s:(r[n++]=i<<4|s,i=-1)}i>=0&&this.eof&&(r[n++]=i<<4,i=-1),this.firstDigit=i,this.bufferLength=n}else this.eof=!0},e}();t.AsciiHexStream=g;var p=function(){function e(e,t){this.str=e,this.dict=e.dict,l.call(this,t)}return e.prototype=Object.create(l.prototype),e.prototype.readBlock=function(){var e=this.str.getBytes(2);if(!e||e.length<2||128===e[0])this.eof=!0;else{var t,r=this.bufferLength,n=e[0];if(n<128){if((t=this.ensureBuffer(r+n+1))[r++]=e[1],n>0){var i=this.str.getBytes(n);t.set(i,r),r+=n}}else{n=257-n;var o=e[1];t=this.ensureBuffer(r+n+1);for(var a=0;a<n;a++)t[r++]=o}this.bufferLength=r}},e}();t.RunLengthStream=p;var m=function(){function e(e,t,r){this.str=e,this.dict=e.dict,this.cachedData=0,this.bitsCached=0;for(var n=4096,i={earlyChange:r,codeLength:9,nextCode:258,dictionaryValues:new Uint8Array(n),dictionaryLengths:new Uint16Array(n),dictionaryPrevCodes:new Uint16Array(n),currentSequence:new Uint8Array(n),currentSequenceLength:0},o=0;o<256;++o)i.dictionaryValues[o]=o,i.dictionaryLengths[o]=1;this.lzwState=i,l.call(this,t)}return e.prototype=Object.create(l.prototype),e.prototype.readBits=function(e){for(var t=this.bitsCached,r=this.cachedData;t<e;){var n=this.str.getByte();if(-1===n)return this.eof=!0,null;r=r<<8|n,t+=8}return this.bitsCached=t-=e,this.cachedData=r,this.lastCode=null,r>>>t&(1<<e)-1},e.prototype.readBlock=function(){var e,t,r,n=1024,i=this.lzwState;if(i){var o=i.earlyChange,a=i.nextCode,s=i.dictionaryValues,l=i.dictionaryLengths,c=i.dictionaryPrevCodes,u=i.codeLength,h=i.prevCode,d=i.currentSequence,f=i.currentSequenceLength,g=0,p=this.bufferLength,m=this.ensureBuffer(this.bufferLength+n);for(e=0;e<512;e++){var v=this.readBits(u),b=f>0;if(v<256)d[0]=v,f=1;else{if(!(v>=258)){if(256===v){u=9,a=258,f=0;continue}this.eof=!0,delete this.lzwState;break}if(v<a)for(t=(f=l[v])-1,r=v;t>=0;t--)d[t]=s[r],r=c[r];else d[f++]=d[0]}if(b&&(c[a]=h,l[a]=l[h]+1,s[a]=d[0],u=++a+o&a+o-1?u:0|Math.min(Math.log(a+o)/.6931471805599453+1,12)),h=v,n<(g+=f)){do{n+=512}while(n<g);m=this.ensureBuffer(this.bufferLength+n)}for(t=0;t<f;t++)m[p++]=d[t]}i.nextCode=a,i.codeLength=u,i.prevCode=h,i.currentSequenceLength=f,this.bufferLength=p}},e}();t.LZWStream=m;var v=function(){function e(){a.call(this,new Uint8Array(0))}return e.prototype=a.prototype,e}();t.NullStream=v},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CCITTFaxStream=void 0;var n=r(5),i=r(14),o=r(12),a=function(){function e(e,t,r){this.str=e,this.dict=e.dict,(0,n.isDict)(r)||(r=n.Dict.empty);const a={next:()=>e.getByte()};this.ccittFaxDecoder=new i.CCITTFaxDecoder(a,{K:r.get("K"),EndOfLine:r.get("EndOfLine"),EncodedByteAlign:r.get("EncodedByteAlign"),Columns:r.get("Columns"),Rows:r.get("Rows"),EndOfBlock:r.get("EndOfBlock"),BlackIs1:r.get("BlackIs1")}),o.DecodeStream.call(this,t)}return e.prototype=Object.create(o.DecodeStream.prototype),e.prototype.readBlock=function(){for(;!this.eof;){const e=this.ccittFaxDecoder.readNextChar();if(-1===e)return void(this.eof=!0);this.ensureBuffer(this.bufferLength+1),this.buffer[this.bufferLength++]=e}},e}();t.CCITTFaxStream=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CCITTFaxDecoder=void 0;var n=r(2);const i=function(){const e=-1,t=[[-1,-1],[-1,-1],[7,8],[7,7],[6,6],[6,6],[6,5],[6,5],[4,0],[4,0],[4,0],[4,0],[4,0],[4,0],[4,0],[4,0],[3,1],[3,1],[3,1],[3,1],[3,1],[3,1],[3,1],[3,1],[3,1],[3,1],[3,1],[3,1],[3,1],[3,1],[3,1],[3,1],[3,4],[3,4],[3,4],[3,4],[3,4],[3,4],[3,4],[3,4],[3,4],[3,4],[3,4],[3,4],[3,4],[3,4],[3,4],[3,4],[3,3],[3,3],[3,3],[3,3],[3,3],[3,3],[3,3],[3,3],[3,3],[3,3],[3,3],[3,3],[3,3],[3,3],[3,3],[3,3],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2],[1,2]],r=[[-1,-1],[12,-2],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[11,1792],[11,1792],[12,1984],[12,2048],[12,2112],[12,2176],[12,2240],[12,2304],[11,1856],[11,1856],[11,1920],[11,1920],[12,2368],[12,2432],[12,2496],[12,2560]],i=[[-1,-1],[-1,-1],[-1,-1],[-1,-1],[8,29],[8,29],[8,30],[8,30],[8,45],[8,45],[8,46],[8,46],[7,22],[7,22],[7,22],[7,22],[7,23],[7,23],[7,23],[7,23],[8,47],[8,47],[8,48],[8,48],[6,13],[6,13],[6,13],[6,13],[6,13],[6,13],[6,13],[6,13],[7,20],[7,20],[7,20],[7,20],[8,33],[8,33],[8,34],[8,34],[8,35],[8,35],[8,36],[8,36],[8,37],[8,37],[8,38],[8,38],[7,19],[7,19],[7,19],[7,19],[8,31],[8,31],[8,32],[8,32],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,12],[6,12],[6,12],[6,12],[6,12],[6,12],[6,12],[6,12],[8,53],[8,53],[8,54],[8,54],[7,26],[7,26],[7,26],[7,26],[8,39],[8,39],[8,40],[8,40],[8,41],[8,41],[8,42],[8,42],[8,43],[8,43],[8,44],[8,44],[7,21],[7,21],[7,21],[7,21],[7,28],[7,28],[7,28],[7,28],[8,61],[8,61],[8,62],[8,62],[8,63],[8,63],[8,0],[8,0],[8,320],[8,320],[8,384],[8,384],[5,10],[5,10],[5,10],[5,10],[5,10],[5,10],[5,10],[5,10],[5,10],[5,10],[5,10],[5,10],[5,10],[5,10],[5,10],[5,10],[5,11],[5,11],[5,11],[5,11],[5,11],[5,11],[5,11],[5,11],[5,11],[5,11],[5,11],[5,11],[5,11],[5,11],[5,11],[5,11],[7,27],[7,27],[7,27],[7,27],[8,59],[8,59],[8,60],[8,60],[9,1472],[9,1536],[9,1600],[9,1728],[7,18],[7,18],[7,18],[7,18],[7,24],[7,24],[7,24],[7,24],[8,49],[8,49],[8,50],[8,50],[8,51],[8,51],[8,52],[8,52],[7,25],[7,25],[7,25],[7,25],[8,55],[8,55],[8,56],[8,56],[8,57],[8,57],[8,58],[8,58],[6,192],[6,192],[6,192],[6,192],[6,192],[6,192],[6,192],[6,192],[6,1664],[6,1664],[6,1664],[6,1664],[6,1664],[6,1664],[6,1664],[6,1664],[8,448],[8,448],[8,512],[8,512],[9,704],[9,768],[8,640],[8,640],[8,576],[8,576],[9,832],[9,896],[9,960],[9,1024],[9,1088],[9,1152],[9,1216],[9,1280],[9,1344],[9,1408],[7,256],[7,256],[7,256],[7,256],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,2],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[4,3],[5,128],[5,128],[5,128],[5,128],[5,128],[5,128],[5,128],[5,128],[5,128],[5,128],[5,128],[5,128],[5,128],[5,128],[5,128],[5,128],[5,8],[5,8],[5,8],[5,8],[5,8],[5,8],[5,8],[5,8],[5,8],[5,8],[5,8],[5,8],[5,8],[5,8],[5,8],[5,8],[5,9],[5,9],[5,9],[5,9],[5,9],[5,9],[5,9],[5,9],[5,9],[5,9],[5,9],[5,9],[5,9],[5,9],[5,9],[5,9],[6,16],[6,16],[6,16],[6,16],[6,16],[6,16],[6,16],[6,16],[6,17],[6,17],[6,17],[6,17],[6,17],[6,17],[6,17],[6,17],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,4],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[4,5],[6,14],[6,14],[6,14],[6,14],[6,14],[6,14],[6,14],[6,14],[6,15],[6,15],[6,15],[6,15],[6,15],[6,15],[6,15],[6,15],[5,64],[5,64],[5,64],[5,64],[5,64],[5,64],[5,64],[5,64],[5,64],[5,64],[5,64],[5,64],[5,64],[5,64],[5,64],[5,64],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,6],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7],[4,7]],o=[[-1,-1],[-1,-1],[12,-2],[12,-2],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[-1,-1],[11,1792],[11,1792],[11,1792],[11,1792],[12,1984],[12,1984],[12,2048],[12,2048],[12,2112],[12,2112],[12,2176],[12,2176],[12,2240],[12,2240],[12,2304],[12,2304],[11,1856],[11,1856],[11,1856],[11,1856],[11,1920],[11,1920],[11,1920],[11,1920],[12,2368],[12,2368],[12,2432],[12,2432],[12,2496],[12,2496],[12,2560],[12,2560],[10,18],[10,18],[10,18],[10,18],[10,18],[10,18],[10,18],[10,18],[12,52],[12,52],[13,640],[13,704],[13,768],[13,832],[12,55],[12,55],[12,56],[12,56],[13,1280],[13,1344],[13,1408],[13,1472],[12,59],[12,59],[12,60],[12,60],[13,1536],[13,1600],[11,24],[11,24],[11,24],[11,24],[11,25],[11,25],[11,25],[11,25],[13,1664],[13,1728],[12,320],[12,320],[12,384],[12,384],[12,448],[12,448],[13,512],[13,576],[12,53],[12,53],[12,54],[12,54],[13,896],[13,960],[13,1024],[13,1088],[13,1152],[13,1216],[10,64],[10,64],[10,64],[10,64],[10,64],[10,64],[10,64],[10,64]],a=[[8,13],[8,13],[8,13],[8,13],[8,13],[8,13],[8,13],[8,13],[8,13],[8,13],[8,13],[8,13],[8,13],[8,13],[8,13],[8,13],[11,23],[11,23],[12,50],[12,51],[12,44],[12,45],[12,46],[12,47],[12,57],[12,58],[12,61],[12,256],[10,16],[10,16],[10,16],[10,16],[10,17],[10,17],[10,17],[10,17],[12,48],[12,49],[12,62],[12,63],[12,30],[12,31],[12,32],[12,33],[12,40],[12,41],[11,22],[11,22],[8,14],[8,14],[8,14],[8,14],[8,14],[8,14],[8,14],[8,14],[8,14],[8,14],[8,14],[8,14],[8,14],[8,14],[8,14],[8,14],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,10],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[7,11],[9,15],[9,15],[9,15],[9,15],[9,15],[9,15],[9,15],[9,15],[12,128],[12,192],[12,26],[12,27],[12,28],[12,29],[11,19],[11,19],[11,20],[11,20],[12,34],[12,35],[12,36],[12,37],[12,38],[12,39],[11,21],[11,21],[12,42],[12,43],[10,0],[10,0],[10,0],[10,0],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12],[7,12]],s=[[-1,-1],[-1,-1],[-1,-1],[-1,-1],[6,9],[6,8],[5,7],[5,7],[4,6],[4,6],[4,6],[4,6],[4,5],[4,5],[4,5],[4,5],[3,1],[3,1],[3,1],[3,1],[3,1],[3,1],[3,1],[3,1],[3,4],[3,4],[3,4],[3,4],[3,4],[3,4],[3,4],[3,4],[2,3],[2,3],[2,3],[2,3],[2,3],[2,3],[2,3],[2,3],[2,3],[2,3],[2,3],[2,3],[2,3],[2,3],[2,3],[2,3],[2,2],[2,2],[2,2],[2,2],[2,2],[2,2],[2,2],[2,2],[2,2],[2,2],[2,2],[2,2],[2,2],[2,2],[2,2],[2,2]];function l(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e||"function"!==typeof e.next)throw new Error('CCITTFaxDecoder - invalid "source" parameter.');this.source=e,this.eof=!1,this.encoding=t.K||0,this.eoline=t.EndOfLine||!1,this.byteAlign=t.EncodedByteAlign||!1,this.columns=t.Columns||1728,this.rows=t.Rows||0;let r,n=t.EndOfBlock;for(null!==n&&void 0!==n||(n=!0),this.eoblock=n,this.black=t.BlackIs1||!1,this.codingLine=new Uint32Array(this.columns+1),this.refLine=new Uint32Array(this.columns+2),this.codingLine[0]=this.columns,this.codingPos=0,this.row=0,this.nextLine2D=this.encoding<0,this.inputBits=0,this.inputBuf=0,this.outputBits=0,this.rowsDone=!1;0===(r=this._lookBits(12));)this._eatBits(1);1===r&&this._eatBits(12),this.encoding>0&&(this.nextLine2D=!this._lookBits(1),this._eatBits(1))}return l.prototype={readNextChar(){if(this.eof)return-1;const t=this.refLine,r=this.codingLine,i=this.columns;let o,a,s,l,c;if(0===this.outputBits){if(this.rowsDone&&(this.eof=!0),this.eof)return-1;let s,c,u;if(this.err=!1,this.nextLine2D){for(l=0;r[l]<i;++l)t[l]=r[l];for(t[l++]=i,t[l]=i,r[0]=0,this.codingPos=0,o=0,a=0;r[this.codingPos]<i;)switch(s=this._getTwoDimCode(),s){case 0:this._addPixels(t[o+1],a),t[o+1]<i&&(o+=2);break;case 1:if(s=c=0,a){do{s+=u=this._getBlackCode()}while(u>=64);do{c+=u=this._getWhiteCode()}while(u>=64)}else{do{s+=u=this._getWhiteCode()}while(u>=64);do{c+=u=this._getBlackCode()}while(u>=64)}for(this._addPixels(r[this.codingPos]+s,a),r[this.codingPos]<i&&this._addPixels(r[this.codingPos]+c,1^a);t[o]<=r[this.codingPos]&&t[o]<i;)o+=2;break;case 7:if(this._addPixels(t[o]+3,a),a^=1,r[this.codingPos]<i)for(++o;t[o]<=r[this.codingPos]&&t[o]<i;)o+=2;break;case 5:if(this._addPixels(t[o]+2,a),a^=1,r[this.codingPos]<i)for(++o;t[o]<=r[this.codingPos]&&t[o]<i;)o+=2;break;case 3:if(this._addPixels(t[o]+1,a),a^=1,r[this.codingPos]<i)for(++o;t[o]<=r[this.codingPos]&&t[o]<i;)o+=2;break;case 2:if(this._addPixels(t[o],a),a^=1,r[this.codingPos]<i)for(++o;t[o]<=r[this.codingPos]&&t[o]<i;)o+=2;break;case 8:if(this._addPixelsNeg(t[o]-3,a),a^=1,r[this.codingPos]<i)for(o>0?--o:++o;t[o]<=r[this.codingPos]&&t[o]<i;)o+=2;break;case 6:if(this._addPixelsNeg(t[o]-2,a),a^=1,r[this.codingPos]<i)for(o>0?--o:++o;t[o]<=r[this.codingPos]&&t[o]<i;)o+=2;break;case 4:if(this._addPixelsNeg(t[o]-1,a),a^=1,r[this.codingPos]<i)for(o>0?--o:++o;t[o]<=r[this.codingPos]&&t[o]<i;)o+=2;break;case e:this._addPixels(i,0),this.eof=!0;break;default:(0,n.info)("bad 2d code"),this._addPixels(i,0),this.err=!0}}else for(r[0]=0,this.codingPos=0,a=0;r[this.codingPos]<i;){if(s=0,a)do{s+=u=this._getBlackCode()}while(u>=64);else do{s+=u=this._getWhiteCode()}while(u>=64);this._addPixels(r[this.codingPos]+s,a),a^=1}let h=!1;if(this.byteAlign&&(this.inputBits&=-8),this.eoblock||this.row!==this.rows-1){if(s=this._lookBits(12),this.eoline)for(;s!==e&&1!==s;)this._eatBits(1),s=this._lookBits(12);else for(;0===s;)this._eatBits(1),s=this._lookBits(12);1===s?(this._eatBits(12),h=!0):s===e&&(this.eof=!0)}else this.rowsDone=!0;if(!this.eof&&this.encoding>0&&!this.rowsDone&&(this.nextLine2D=!this._lookBits(1),this._eatBits(1)),this.eoblock&&h&&this.byteAlign){if(s=this._lookBits(12),1===s){if(this._eatBits(12),this.encoding>0&&(this._lookBits(1),this._eatBits(1)),this.encoding>=0)for(l=0;l<4;++l)s=this._lookBits(12),1!==s&&(0,n.info)("bad rtc code: "+s),this._eatBits(12),this.encoding>0&&(this._lookBits(1),this._eatBits(1));this.eof=!0}}else if(this.err&&this.eoline){for(;;){if(s=this._lookBits(13),s===e)return this.eof=!0,-1;if(s>>1===1)break;this._eatBits(1)}this._eatBits(12),this.encoding>0&&(this._eatBits(1),this.nextLine2D=!(1&s))}r[0]>0?this.outputBits=r[this.codingPos=0]:this.outputBits=r[this.codingPos=1],this.row++}if(this.outputBits>=8)c=1&this.codingPos?0:255,this.outputBits-=8,0===this.outputBits&&r[this.codingPos]<i&&(this.codingPos++,this.outputBits=r[this.codingPos]-r[this.codingPos-1]);else{s=8,c=0;do{this.outputBits>s?(c<<=s,1&this.codingPos||(c|=255>>8-s),this.outputBits-=s,s=0):(c<<=this.outputBits,1&this.codingPos||(c|=255>>8-this.outputBits),s-=this.outputBits,this.outputBits=0,r[this.codingPos]<i?(this.codingPos++,this.outputBits=r[this.codingPos]-r[this.codingPos-1]):s>0&&(c<<=s,s=0))}while(s)}return this.black&&(c^=255),c},_addPixels(e,t){const r=this.codingLine;let i=this.codingPos;e>r[i]&&(e>this.columns&&((0,n.info)("row is wrong length"),this.err=!0,e=this.columns),1&i^t&&++i,r[i]=e),this.codingPos=i},_addPixelsNeg(e,t){const r=this.codingLine;let i=this.codingPos;if(e>r[i])e>this.columns&&((0,n.info)("row is wrong length"),this.err=!0,e=this.columns),1&i^t&&++i,r[i]=e;else if(e<r[i]){for(e<0&&((0,n.info)("invalid code"),this.err=!0,e=0);i>0&&e<r[i-1];)--i;r[i]=e}this.codingPos=i},_findTableCode(t,r,n,i){const o=i||0;for(let a=t;a<=r;++a){let t=this._lookBits(a);if(t===e)return[!0,1,!1];if(a<r&&(t<<=r-a),!o||t>=o){const e=n[t-o];if(e[0]===a)return this._eatBits(a),[!0,e[1],!0]}}return[!1,0,!1]},_getTwoDimCode(){let r,i=0;if(this.eoblock){if(i=this._lookBits(7),r=t[i],r&&r[0]>0)return this._eatBits(r[0]),r[1]}else{const e=this._findTableCode(1,7,t);if(e[0]&&e[2])return e[1]}return(0,n.info)("Bad two dim code"),e},_getWhiteCode(){let t,o=0;if(this.eoblock){if(o=this._lookBits(12),o===e)return 1;if(t=o>>5===0?r[o]:i[o>>3],t[0]>0)return this._eatBits(t[0]),t[1]}else{let e=this._findTableCode(1,9,i);if(e[0])return e[1];if(e=this._findTableCode(11,12,r),e[0])return e[1]}return(0,n.info)("bad white code"),this._eatBits(1),1},_getBlackCode(){let t,r;if(this.eoblock){if(t=this._lookBits(13),t===e)return 1;if(r=t>>7===0?o[t]:t>>9===0&&t>>7!==0?a[(t>>1)-64]:s[t>>7],r[0]>0)return this._eatBits(r[0]),r[1]}else{let e=this._findTableCode(2,6,s);if(e[0])return e[1];if(e=this._findTableCode(7,12,a,64),e[0])return e[1];if(e=this._findTableCode(10,13,o),e[0])return e[1]}return(0,n.info)("bad black code"),this._eatBits(1),1},_lookBits(t){let r;for(;this.inputBits<t;){if(-1===(r=this.source.next()))return 0===this.inputBits?e:this.inputBuf<<t-this.inputBits&65535>>16-t;this.inputBuf=this.inputBuf<<8|r,this.inputBits+=8}return this.inputBuf>>this.inputBits-t&65535>>16-t},_eatBits(e){(this.inputBits-=e)<0&&(this.inputBits=0)}},l}();t.CCITTFaxDecoder=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Jbig2Stream=void 0;var n=r(5),i=r(12),o=r(16),a=r(2);const s=function(){function e(e,t,r,n){this.stream=e,this.maybeLength=t,this.dict=r,this.params=n,i.DecodeStream.call(this,t)}return e.prototype=Object.create(i.DecodeStream.prototype),Object.defineProperty(e.prototype,"bytes",{get(){return(0,a.shadow)(this,"bytes",this.stream.getBytes(this.maybeLength))},configurable:!0}),e.prototype.ensureBuffer=function(e){},e.prototype.readBlock=function(){if(this.eof)return;const e=new o.Jbig2Image,t=[];if((0,n.isDict)(this.params)){const e=this.params.get("JBIG2Globals");if((0,n.isStream)(e)){const r=e.getBytes();t.push({data:r,start:0,end:r.length})}}t.push({data:this.bytes,start:0,end:this.bytes.length});const r=e.parseChunks(t),i=r.length;for(let n=0;n<i;n++)r[n]^=255;this.buffer=r,this.bufferLength=i,this.eof=!0},e}();t.Jbig2Stream=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Jbig2Image=void 0;var n=r(2),i=r(8),o=r(17),a=r(14);class s extends n.BaseException{constructor(e){super(`JBIG2 error: ${e}`)}}var l=function(){function e(){}function t(e,t,r){this.data=e,this.start=t,this.end=r}function r(e,t,r){var n=e.getContexts(t),i=1;function o(e){for(var t=0,o=0;o<e;o++){var a=r.readBit(n,i);i=i<256?i<<1|a:511&(i<<1|a)|256,t=t<<1|a}return t>>>0}var a=o(1),s=o(1)?o(1)?o(1)?o(1)?o(1)?o(32)+4436:o(12)+340:o(8)+84:o(6)+20:o(4)+4:o(2);return 0===a?s:s>0?-s:null}function l(e,t,r){for(var n=e.getContexts("IAID"),i=1,o=0;o<r;o++)i=i<<1|t.readBit(n,i);return r<31?i&(1<<r)-1:2147483647&i}e.prototype={getContexts(e){return e in this?this[e]:this[e]=new Int8Array(65536)}},t.prototype={get decoder(){var e=new o.ArithmeticDecoder(this.data,this.start,this.end);return(0,n.shadow)(this,"decoder",e)},get contextCache(){var t=new e;return(0,n.shadow)(this,"contextCache",t)}};var c=["SymbolDictionary",null,null,null,"IntermediateTextRegion",null,"ImmediateTextRegion","ImmediateLosslessTextRegion",null,null,null,null,null,null,null,null,"PatternDictionary",null,null,null,"IntermediateHalftoneRegion",null,"ImmediateHalftoneRegion","ImmediateLosslessHalftoneRegion",null,null,null,null,null,null,null,null,null,null,null,null,"IntermediateGenericRegion",null,"ImmediateGenericRegion","ImmediateLosslessGenericRegion","IntermediateGenericRefinementRegion",null,"ImmediateGenericRefinementRegion","ImmediateLosslessGenericRefinementRegion",null,null,null,null,"PageInformation","EndOfPage","EndOfStripe","EndOfFile","Profiles","Tables",null,null,null,null,null,null,null,null,"Extension"],u=[[{x:-1,y:-2},{x:0,y:-2},{x:1,y:-2},{x:-2,y:-1},{x:-1,y:-1},{x:0,y:-1},{x:1,y:-1},{x:2,y:-1},{x:-4,y:0},{x:-3,y:0},{x:-2,y:0},{x:-1,y:0}],[{x:-1,y:-2},{x:0,y:-2},{x:1,y:-2},{x:2,y:-2},{x:-2,y:-1},{x:-1,y:-1},{x:0,y:-1},{x:1,y:-1},{x:2,y:-1},{x:-3,y:0},{x:-2,y:0},{x:-1,y:0}],[{x:-1,y:-2},{x:0,y:-2},{x:1,y:-2},{x:-2,y:-1},{x:-1,y:-1},{x:0,y:-1},{x:1,y:-1},{x:-2,y:0},{x:-1,y:0}],[{x:-3,y:-1},{x:-2,y:-1},{x:-1,y:-1},{x:0,y:-1},{x:1,y:-1},{x:-4,y:0},{x:-3,y:0},{x:-2,y:0},{x:-1,y:0}]],h=[{coding:[{x:0,y:-1},{x:1,y:-1},{x:-1,y:0}],reference:[{x:0,y:-1},{x:1,y:-1},{x:-1,y:0},{x:0,y:0},{x:1,y:0},{x:-1,y:1},{x:0,y:1},{x:1,y:1}]},{coding:[{x:-1,y:-1},{x:0,y:-1},{x:1,y:-1},{x:-1,y:0}],reference:[{x:0,y:-1},{x:-1,y:0},{x:0,y:0},{x:1,y:0},{x:0,y:1},{x:1,y:1}]}],d=[39717,1941,229,405],f=[32,8];function g(e,t,r,n,i,o,a,s){if(e)return I(new R(s.data,s.start,s.end),t,r,!1);if(0===n&&!o&&!i&&4===a.length&&3===a[0].x&&-1===a[0].y&&-3===a[1].x&&-1===a[1].y&&2===a[2].x&&-2===a[2].y&&-2===a[3].x&&-2===a[3].y)return function(e,t,r){var n,i,o,a,s,l,c,u=r.decoder,h=r.contextCache.getContexts("GB"),d=[];for(i=0;i<t;i++)for(s=d[i]=new Uint8Array(e),l=i<1?s:d[i-1],n=(c=i<2?s:d[i-2])[0]<<13|c[1]<<12|c[2]<<11|l[0]<<7|l[1]<<6|l[2]<<5|l[3]<<4,o=0;o<e;o++)s[o]=a=u.readBit(h,n),n=(31735&n)<<1|(o+3<e?c[o+3]<<11:0)|(o+4<e?l[o+4]<<4:0)|a;return d}(t,r,s);var l=!!o,c=u[n].concat(a);c.sort((function(e,t){return e.y-t.y||e.x-t.x}));var h,f,g=c.length,p=new Int8Array(g),m=new Int8Array(g),v=[],b=0,y=0,w=0,S=0;for(f=0;f<g;f++)p[f]=c[f].x,m[f]=c[f].y,y=Math.min(y,c[f].x),w=Math.max(w,c[f].x),S=Math.min(S,c[f].y),f<g-1&&c[f].y===c[f+1].y&&c[f].x===c[f+1].x-1?b|=1<<g-1-f:v.push(f);var C=v.length,k=new Int8Array(C),x=new Int8Array(C),E=new Uint16Array(C);for(h=0;h<C;h++)f=v[h],k[h]=c[f].x,x[h]=c[f].y,E[h]=1<<g-1-f;for(var T,_,A,O,M,P=-y,N=-S,D=t-w,F=d[n],L=new Uint8Array(t),H=[],B=s.decoder,U=s.contextCache.getContexts("GB"),j=0,W=0,V=0;V<r;V++)if(i&&(j^=B.readBit(U,F)))H.push(L);else for(L=new Uint8Array(L),H.push(L),T=0;T<t;T++)if(l&&o[V][T])L[T]=0;else{if(T>=P&&T<D&&V>=N)for(W=W<<1&b,f=0;f<C;f++)_=V+x[f],A=T+k[f],(O=H[_][A])&&(W|=O=E[f]);else for(W=0,M=g-1,f=0;f<g;f++,M--)(A=T+p[f])>=0&&A<t&&(_=V+m[f])>=0&&(O=H[_][A])&&(W|=O<<M);var z=B.readBit(U,W);L[T]=z}return H}function p(e,t,r,n,i,o,a,l,c){var u=h[r].coding;0===r&&(u=u.concat([l[0]]));var d,g=u.length,p=new Int32Array(g),m=new Int32Array(g);for(d=0;d<g;d++)p[d]=u[d].x,m[d]=u[d].y;var v=h[r].reference;0===r&&(v=v.concat([l[1]]));var b=v.length,y=new Int32Array(b),w=new Int32Array(b);for(d=0;d<b;d++)y[d]=v[d].x,w[d]=v[d].y;for(var S=n[0].length,C=n.length,k=f[r],x=[],E=c.decoder,T=c.contextCache.getContexts("GR"),_=0,A=0;A<t;A++){if(a&&(_^=E.readBit(T,k)))throw new s("prediction is not supported");var R=new Uint8Array(e);x.push(R);for(var O=0;O<e;O++){var M,I,P=0;for(d=0;d<g;d++)M=A+m[d],I=O+p[d],M<0||I<0||I>=e?P<<=1:P=P<<1|x[M][I];for(d=0;d<b;d++)M=A+w[d]-o,I=O+y[d]-i,M<0||M>=C||I<0||I>=S?P<<=1:P=P<<1|n[M][I];var N=E.readBit(T,P);R[O]=N}}return x}function m(e,t,n,i,o,a,c,u,h,d,f,g,m,v,b,y,w,S,C){if(e&&t)throw new s("refinement with Huffman is not supported");var k,x,E=[];for(k=0;k<i;k++){if(x=new Uint8Array(n),o)for(var T=0;T<n;T++)x[T]=o;E.push(x)}var _=w.decoder,A=w.contextCache,R=e?-v.tableDeltaT.decode(C):-r(A,"IADT",_),O=0;for(k=0;k<a;){R+=e?v.tableDeltaT.decode(C):r(A,"IADT",_);for(var M=O+=e?v.tableFirstS.decode(C):r(A,"IAFS",_);;){let i=0;c>1&&(i=e?C.readBits(S):r(A,"IAIT",_));var I=c*R+i,P=e?v.symbolIDTable.decode(C):l(A,_,h),N=t&&(e?C.readBit():r(A,"IARI",_)),D=u[P],F=D[0].length,L=D.length;if(N){var H=r(A,"IARDW",_),B=r(A,"IARDH",_);D=p(F+=H,L+=B,b,D,(H>>1)+r(A,"IARDX",_),(B>>1)+r(A,"IARDY",_),!1,y,w)}var U,j,W,V=I-(1&g?0:L-1),z=M-(2&g?F-1:0);if(d){for(U=0;U<L;U++)if(x=E[z+U]){W=D[U];var q=Math.min(n-V,F);switch(m){case 0:for(j=0;j<q;j++)x[V+j]|=W[j];break;case 2:for(j=0;j<q;j++)x[V+j]^=W[j];break;default:throw new s(`operator ${m} is not supported`)}}M+=L-1}else{for(j=0;j<L;j++)if(x=E[V+j])switch(W=D[j],m){case 0:for(U=0;U<F;U++)x[z+U]|=W[U];break;case 2:for(U=0;U<F;U++)x[z+U]^=W[U];break;default:throw new s(`operator ${m} is not supported`)}M+=F-1}k++;var G=e?v.tableDeltaS.decode(C):r(A,"IADS",_);if(null===G)break;M+=G+f}}return E}function v(e,t){var r={};r.number=(0,i.readUint32)(e,t);var n=e[t+4],o=63&n;if(!c[o])throw new s("invalid segment type: "+o);r.type=o,r.typeName=c[o],r.deferredNonRetain=!!(128&n);var a=!!(64&n),l=e[t+5],u=l>>5&7,h=[31&l],d=t+6;if(7===l){u=536870911&(0,i.readUint32)(e,d-1),d+=3;var f=u+7>>3;for(h[0]=e[d++];--f>0;)h.push(e[d++])}else if(5===l||6===l)throw new s("invalid referred-to flags");r.retainBits=h;let g=4;r.number<=256?g=1:r.number<=65536&&(g=2);var p,m,v=[];for(p=0;p<u;p++){let t;t=1===g?e[d]:2===g?(0,i.readUint16)(e,d):(0,i.readUint32)(e,d),v.push(t),d+=g}if(r.referredTo=v,a?(r.pageAssociation=(0,i.readUint32)(e,d),d+=4):r.pageAssociation=e[d++],r.length=(0,i.readUint32)(e,d),d+=4,4294967295===r.length){if(38!==o)throw new s("invalid unknown segment length");var b=y(e,d),S=!!(1&e[d+w]),C=new Uint8Array(6);for(S||(C[0]=255,C[1]=172),C[2]=b.height>>>24&255,C[3]=b.height>>16&255,C[4]=b.height>>8&255,C[5]=255&b.height,p=d,m=e.length;p<m;p++){for(var k=0;k<6&&C[k]===e[p+k];)k++;if(6===k){r.length=p+6;break}}if(4294967295===r.length)throw new s("segment end was not found")}return r.headerEnd=d,r}function b(e,t,r,n){for(var i=[],o=r;o<n;){var a=v(t,o);o=a.headerEnd;var s={header:a,data:t};if(e.randomAccess||(s.start=o,o+=a.length,s.end=o),i.push(s),51===a.type)break}if(e.randomAccess)for(var l=0,c=i.length;l<c;l++)i[l].start=o,o+=i[l].header.length,i[l].end=o;return i}function y(e,t){return{width:(0,i.readUint32)(e,t),height:(0,i.readUint32)(e,t+4),x:(0,i.readUint32)(e,t+8),y:(0,i.readUint32)(e,t+12),combinationOperator:7&e[t+16]}}var w=17;function S(e,t){var r,n,o,a,l=e.header,c=e.data,u=e.start,h=e.end;switch(l.type){case 0:var d={},f=(0,i.readUint16)(c,u);if(d.huffman=!!(1&f),d.refinement=!!(2&f),d.huffmanDHSelector=f>>2&3,d.huffmanDWSelector=f>>4&3,d.bitmapSizeSelector=f>>6&1,d.aggregationInstancesSelector=f>>7&1,d.bitmapCodingContextUsed=!!(256&f),d.bitmapCodingContextRetained=!!(512&f),d.template=f>>10&3,d.refinementTemplate=f>>12&1,u+=2,!d.huffman){for(a=0===d.template?4:1,n=[],o=0;o<a;o++)n.push({x:(0,i.readInt8)(c,u),y:(0,i.readInt8)(c,u+1)}),u+=2;d.at=n}if(d.refinement&&!d.refinementTemplate){for(n=[],o=0;o<2;o++)n.push({x:(0,i.readInt8)(c,u),y:(0,i.readInt8)(c,u+1)}),u+=2;d.refinementAt=n}d.numberOfExportedSymbols=(0,i.readUint32)(c,u),u+=4,d.numberOfNewSymbols=(0,i.readUint32)(c,u),u+=4,r=[d,l.number,l.referredTo,c,u,h];break;case 6:case 7:var g={};g.info=y(c,u),u+=w;var p=(0,i.readUint16)(c,u);if(u+=2,g.huffman=!!(1&p),g.refinement=!!(2&p),g.logStripSize=p>>2&3,g.stripSize=1<<g.logStripSize,g.referenceCorner=p>>4&3,g.transposed=!!(64&p),g.combinationOperator=p>>7&3,g.defaultPixelValue=p>>9&1,g.dsOffset=p<<17>>27,g.refinementTemplate=p>>15&1,g.huffman){var m=(0,i.readUint16)(c,u);u+=2,g.huffmanFS=3&m,g.huffmanDS=m>>2&3,g.huffmanDT=m>>4&3,g.huffmanRefinementDW=m>>6&3,g.huffmanRefinementDH=m>>8&3,g.huffmanRefinementDX=m>>10&3,g.huffmanRefinementDY=m>>12&3,g.huffmanRefinementSizeSelector=!!(16384&m)}if(g.refinement&&!g.refinementTemplate){for(n=[],o=0;o<2;o++)n.push({x:(0,i.readInt8)(c,u),y:(0,i.readInt8)(c,u+1)}),u+=2;g.refinementAt=n}g.numberOfSymbolInstances=(0,i.readUint32)(c,u),u+=4,r=[g,l.referredTo,c,u,h];break;case 16:const e={},t=c[u++];e.mmr=!!(1&t),e.template=t>>1&3,e.patternWidth=c[u++],e.patternHeight=c[u++],e.maxPatternIndex=(0,i.readUint32)(c,u),u+=4,r=[e,l.number,c,u,h];break;case 22:case 23:const k={};k.info=y(c,u),u+=w;const x=c[u++];k.mmr=!!(1&x),k.template=x>>1&3,k.enableSkip=!!(8&x),k.combinationOperator=x>>4&7,k.defaultPixelValue=x>>7&1,k.gridWidth=(0,i.readUint32)(c,u),u+=4,k.gridHeight=(0,i.readUint32)(c,u),u+=4,k.gridOffsetX=4294967295&(0,i.readUint32)(c,u),u+=4,k.gridOffsetY=4294967295&(0,i.readUint32)(c,u),u+=4,k.gridVectorX=(0,i.readUint16)(c,u),u+=2,k.gridVectorY=(0,i.readUint16)(c,u),u+=2,r=[k,l.referredTo,c,u,h];break;case 38:case 39:var v={};v.info=y(c,u),u+=w;var b=c[u++];if(v.mmr=!!(1&b),v.template=b>>1&3,v.prediction=!!(8&b),!v.mmr){for(a=0===v.template?4:1,n=[],o=0;o<a;o++)n.push({x:(0,i.readInt8)(c,u),y:(0,i.readInt8)(c,u+1)}),u+=2;v.at=n}r=[v,c,u,h];break;case 48:var S={width:(0,i.readUint32)(c,u),height:(0,i.readUint32)(c,u+4),resolutionX:(0,i.readUint32)(c,u+8),resolutionY:(0,i.readUint32)(c,u+12)};4294967295===S.height&&delete S.height;var C=c[u+16];(0,i.readUint16)(c,u+17),S.lossless=!!(1&C),S.refinement=!!(2&C),S.defaultPixelValue=C>>2&1,S.combinationOperator=C>>3&3,S.requiresBuffer=!!(32&C),S.combinationOperatorOverride=!!(64&C),r=[S];break;case 49:case 50:case 51:case 62:break;case 53:r=[l.number,c,u,h];break;default:throw new s(`segment type ${l.typeName}(${l.type}) is not implemented`)}var k="on"+l.typeName;k in t&&t[k].apply(t,r)}function C(e,t){for(var r=0,n=e.length;r<n;r++)S(e[r],t)}function k(){}function x(e){2===e.length?(this.isOOB=!0,this.rangeLow=0,this.prefixLength=e[0],this.rangeLength=0,this.prefixCode=e[1],this.isLowerRange=!1):(this.isOOB=!1,this.rangeLow=e[0],this.prefixLength=e[1],this.rangeLength=e[2],this.prefixCode=e[3],this.isLowerRange="lower"===e[4])}function E(e){this.children=[],e?(this.isLeaf=!0,this.rangeLength=e.rangeLength,this.rangeLow=e.rangeLow,this.isLowerRange=e.isLowerRange,this.isOOB=e.isOOB):this.isLeaf=!1}function T(e,t){t||this.assignPrefixCodes(e),this.rootNode=new E(null);for(let r=0,n=e.length;r<n;r++){const t=e[r];t.prefixLength>0&&this.rootNode.buildTree(t,t.prefixLength-1)}}k.prototype={onPageInformation:function(e){this.currentPageInfo=e;var t=e.width+7>>3,r=new Uint8ClampedArray(t*e.height);if(e.defaultPixelValue)for(var n=0,i=r.length;n<i;n++)r[n]=255;this.buffer=r},drawBitmap:function(e,t){var r,n,i,o,a=this.currentPageInfo,l=e.width,c=e.height,u=a.width+7>>3,h=a.combinationOperatorOverride?e.combinationOperator:a.combinationOperator,d=this.buffer,f=128>>(7&e.x),g=e.y*u+(e.x>>3);switch(h){case 0:for(r=0;r<c;r++){for(i=f,o=g,n=0;n<l;n++)t[r][n]&&(d[o]|=i),(i>>=1)||(i=128,o++);g+=u}break;case 2:for(r=0;r<c;r++){for(i=f,o=g,n=0;n<l;n++)t[r][n]&&(d[o]^=i),(i>>=1)||(i=128,o++);g+=u}break;default:throw new s(`operator ${h} is not supported`)}},onImmediateGenericRegion:function(e,r,n,i){var o=e.info,a=new t(r,n,i),s=g(e.mmr,o.width,o.height,e.template,e.prediction,null,e.at,a);this.drawBitmap(o,s)},onImmediateLosslessGenericRegion:function(){this.onImmediateGenericRegion.apply(this,arguments)},onSymbolDictionary:function(e,n,o,a,c,u){let h,d;e.huffman&&(h=function(e,t,r){let n,i,o,a,l=0;switch(e.huffmanDHSelector){case 0:case 1:n=A(e.huffmanDHSelector+4);break;case 3:n=O(l,t,r),l++;break;default:throw new s("invalid Huffman DH selector")}switch(e.huffmanDWSelector){case 0:case 1:i=A(e.huffmanDWSelector+2);break;case 3:i=O(l,t,r),l++;break;default:throw new s("invalid Huffman DW selector")}return e.bitmapSizeSelector?(o=O(l,t,r),l++):o=A(1),a=e.aggregationInstancesSelector?O(l,t,r):A(1),{tableDeltaHeight:n,tableDeltaWidth:i,tableBitmapSize:o,tableAggregateInstances:a}}(e,o,this.customTables),d=new R(a,c,u));var f=this.symbols;f||(this.symbols=f={});for(var v=[],b=0,y=o.length;b<y;b++){const e=f[o[b]];e&&(v=v.concat(e))}var w=new t(a,c,u);f[n]=function(e,t,n,o,a,c,u,h,d,f,v,b){if(e&&t)throw new s("symbol refinement with Huffman is not supported");var y=[],w=0,S=(0,i.log2)(n.length+o),C=v.decoder,k=v.contextCache;let x,E;for(e&&(x=A(1),E=[],S=Math.max(S,1));y.length<o;){w+=e?c.tableDeltaHeight.decode(b):r(k,"IADH",C);let i=0,o=0;const a=e?E.length:0;for(;;){var T,_=e?c.tableDeltaWidth.decode(b):r(k,"IADW",C);if(null===_)break;if(i+=_,o+=i,t){var R=r(k,"IAAI",C);if(R>1)T=m(e,t,i,w,0,R,1,n.concat(y),S,0,0,1,0,c,d,f,v,0,b);else{var O=l(k,C,S),P=r(k,"IARDX",C),N=r(k,"IARDY",C);T=p(i,w,d,O<n.length?n[O]:y[O-n.length],P,N,!1,f,v)}y.push(T)}else e?E.push(i):(T=g(!1,i,w,u,!1,null,h,v),y.push(T))}if(e&&!t){const e=c.tableBitmapSize.decode(b);let t;if(b.byteAlign(),0===e)t=M(b,o,w);else{const r=b.end,n=b.position+e;b.end=n,t=I(b,o,w,!1),b.end=r,b.position=n}const r=E.length;if(a===r-1)y.push(t);else{let e,n,i,o,s,l=0;for(e=a;e<r;e++){for(o=E[e],i=l+o,s=[],n=0;n<w;n++)s.push(t[n].subarray(l,i));y.push(s),l=i}}}}for(var D=[],F=[],L=!1,H=n.length+o;F.length<H;){for(var B=e?x.decode(b):r(k,"IAEX",C);B--;)F.push(L);L=!L}for(var U=0,j=n.length;U<j;U++)F[U]&&D.push(n[U]);for(var W=0;W<o;U++,W++)F[U]&&D.push(y[W]);return D}(e.huffman,e.refinement,v,e.numberOfNewSymbols,e.numberOfExportedSymbols,h,e.template,e.at,e.refinementTemplate,e.refinementAt,w,d)},onImmediateTextRegion:function(e,r,n,o,a){var l=e.info;let c,u;for(var h=this.symbols,d=[],f=0,g=r.length;f<g;f++){const e=h[r[f]];e&&(d=d.concat(e))}var p=(0,i.log2)(d.length);e.huffman&&(u=new R(n,o,a),c=function(e,t,r,n,i){const o=[];for(let s=0;s<=34;s++){const e=i.readBits(4);o.push(new x([s,e,0,0]))}const a=new T(o,!1);o.length=0;for(let f=0;f<n;){const e=a.decode(i);if(e>=32){let t,r,n;switch(e){case 32:if(0===f)throw new s("no previous value in symbol ID table");r=i.readBits(2)+3,t=o[f-1].prefixLength;break;case 33:r=i.readBits(3)+3,t=0;break;case 34:r=i.readBits(7)+11,t=0;break;default:throw new s("invalid code length in symbol ID table")}for(n=0;n<r;n++)o.push(new x([f,t,0,0])),f++}else o.push(new x([f,e,0,0])),f++}i.byteAlign();const l=new T(o,!1);let c,u,h,d=0;switch(e.huffmanFS){case 0:case 1:c=A(e.huffmanFS+6);break;case 3:c=O(d,t,r),d++;break;default:throw new s("invalid Huffman FS selector")}switch(e.huffmanDS){case 0:case 1:case 2:u=A(e.huffmanDS+8);break;case 3:u=O(d,t,r),d++;break;default:throw new s("invalid Huffman DS selector")}switch(e.huffmanDT){case 0:case 1:case 2:h=A(e.huffmanDT+11);break;case 3:h=O(d,t,r),d++;break;default:throw new s("invalid Huffman DT selector")}if(e.refinement)throw new s("refinement with Huffman is not supported");return{symbolIDTable:l,tableFirstS:c,tableDeltaS:u,tableDeltaT:h}}(e,r,this.customTables,d.length,u));var v=new t(n,o,a),b=m(e.huffman,e.refinement,l.width,l.height,e.defaultPixelValue,e.numberOfSymbolInstances,e.stripSize,d,p,e.transposed,e.dsOffset,e.referenceCorner,e.combinationOperator,c,e.refinementTemplate,e.refinementAt,v,e.logStripSize,u);this.drawBitmap(l,b)},onImmediateLosslessTextRegion:function(){this.onImmediateTextRegion.apply(this,arguments)},onPatternDictionary(e,r,n,i,o){let a=this.patterns;a||(this.patterns=a={});const s=new t(n,i,o);a[r]=function(e,t,r,n,i,o){const a=[];e||(a.push({x:-t,y:0}),0===i&&(a.push({x:-3,y:-1}),a.push({x:2,y:-2}),a.push({x:-2,y:-2})));const s=g(e,(n+1)*t,r,i,!1,null,a,o),l=[];for(let c=0;c<=n;c++){const e=[],n=t*c,i=n+t;for(let t=0;t<r;t++)e.push(s[t].subarray(n,i));l.push(e)}return l}(e.mmr,e.patternWidth,e.patternHeight,e.maxPatternIndex,e.template,s)},onImmediateHalftoneRegion(e,r,n,o,a){const l=this.patterns[r[0]],c=e.info,u=new t(n,o,a),h=function(e,t,r,n,o,a,l,c,u,h,d,f,p,m,v){if(l)throw new s("skip is not supported");if(0!==c)throw new s("operator "+c+" is not supported in halftone region");const b=[];let y,w,S;for(y=0;y<o;y++){if(S=new Uint8Array(n),a)for(w=0;w<n;w++)S[w]=a;b.push(S)}const C=t.length,k=t[0],x=k[0].length,E=k.length,T=(0,i.log2)(C),_=[];e||(_.push({x:r<=1?3:2,y:-1}),0===r&&(_.push({x:-3,y:-1}),_.push({x:2,y:-2}),_.push({x:-2,y:-2})));const A=[];let O,M,P,N,D,F,L,H,B,U,j;for(e&&(O=new R(v.data,v.start,v.end)),y=T-1;y>=0;y--)M=e?I(O,u,h,!0):g(!1,u,h,r,!1,null,_,v),A[y]=M;for(P=0;P<h;P++)for(N=0;N<u;N++){for(D=0,F=0,w=T-1;w>=0;w--)D=A[w][P][N]^D,F|=D<<w;if(L=t[F],H=d+P*m+N*p>>8,B=f+P*p-N*m>>8,H>=0&&H+x<=n&&B>=0&&B+E<=o)for(y=0;y<E;y++)for(j=b[B+y],U=L[y],w=0;w<x;w++)j[H+w]|=U[w];else{let e,t;for(y=0;y<E;y++)if(t=B+y,!(t<0||t>=o))for(j=b[t],U=L[y],w=0;w<x;w++)e=H+w,e>=0&&e<n&&(j[e]|=U[w])}}return b}(e.mmr,l,e.template,c.width,c.height,e.defaultPixelValue,e.enableSkip,e.combinationOperator,e.gridWidth,e.gridHeight,e.gridOffsetX,e.gridOffsetY,e.gridVectorX,e.gridVectorY,u);this.drawBitmap(c,h)},onImmediateLosslessHalftoneRegion(){this.onImmediateHalftoneRegion.apply(this,arguments)},onTables(e,t,r,n){let o=this.customTables;o||(this.customTables=o={}),o[e]=function(e,t,r){const n=e[t],o=4294967295&(0,i.readUint32)(e,t+1),a=4294967295&(0,i.readUint32)(e,t+5),s=new R(e,t+9,r),l=1+(n>>1&7),c=1+(n>>4&7),u=[];let h,d,f=o;do{h=s.readBits(l),d=s.readBits(c),u.push(new x([f,h,d,0])),f+=1<<d}while(f<a);return h=s.readBits(l),u.push(new x([o-1,h,32,0,"lower"])),h=s.readBits(l),u.push(new x([a,h,32,0])),1&n&&(h=s.readBits(l),u.push(new x([h,0]))),new T(u,!1)}(t,r,n)}},E.prototype={buildTree(e,t){const r=e.prefixCode>>t&1;if(t<=0)this.children[r]=new E(e);else{let n=this.children[r];n||(this.children[r]=n=new E(null)),n.buildTree(e,t-1)}},decodeNode(e){if(this.isLeaf){if(this.isOOB)return null;const t=e.readBits(this.rangeLength);return this.rangeLow+(this.isLowerRange?-t:t)}const t=this.children[e.readBit()];if(!t)throw new s("invalid Huffman data");return t.decodeNode(e)}},T.prototype={decode(e){return this.rootNode.decodeNode(e)},assignPrefixCodes(e){const t=e.length;let r=0;for(let c=0;c<t;c++)r=Math.max(r,e[c].prefixLength);const n=new Uint32Array(r+1);for(let c=0;c<t;c++)n[e[c].prefixLength]++;let i,o,a,s=1,l=0;for(n[0]=0;s<=r;){for(l=l+n[s-1]<<1,i=l,o=0;o<t;)a=e[o],a.prefixLength===s&&(a.prefixCode=i,i++),o++;s++}}};const _={};function A(e){let t,r=_[e];if(r)return r;switch(e){case 1:t=[[0,1,4,0],[16,2,8,2],[272,3,16,6],[65808,3,32,7]];break;case 2:t=[[0,1,0,0],[1,2,0,2],[2,3,0,6],[3,4,3,14],[11,5,6,30],[75,6,32,62],[6,63]];break;case 3:t=[[-256,8,8,254],[0,1,0,0],[1,2,0,2],[2,3,0,6],[3,4,3,14],[11,5,6,30],[-257,8,32,255,"lower"],[75,7,32,126],[6,62]];break;case 4:t=[[1,1,0,0],[2,2,0,2],[3,3,0,6],[4,4,3,14],[12,5,6,30],[76,5,32,31]];break;case 5:t=[[-255,7,8,126],[1,1,0,0],[2,2,0,2],[3,3,0,6],[4,4,3,14],[12,5,6,30],[-256,7,32,127,"lower"],[76,6,32,62]];break;case 6:t=[[-2048,5,10,28],[-1024,4,9,8],[-512,4,8,9],[-256,4,7,10],[-128,5,6,29],[-64,5,5,30],[-32,4,5,11],[0,2,7,0],[128,3,7,2],[256,3,8,3],[512,4,9,12],[1024,4,10,13],[-2049,6,32,62,"lower"],[2048,6,32,63]];break;case 7:t=[[-1024,4,9,8],[-512,3,8,0],[-256,4,7,9],[-128,5,6,26],[-64,5,5,27],[-32,4,5,10],[0,4,5,11],[32,5,5,28],[64,5,6,29],[128,4,7,12],[256,3,8,1],[512,3,9,2],[1024,3,10,3],[-1025,5,32,30,"lower"],[2048,5,32,31]];break;case 8:t=[[-15,8,3,252],[-7,9,1,508],[-5,8,1,253],[-3,9,0,509],[-2,7,0,124],[-1,4,0,10],[0,2,1,0],[2,5,0,26],[3,6,0,58],[4,3,4,4],[20,6,1,59],[22,4,4,11],[38,4,5,12],[70,5,6,27],[134,5,7,28],[262,6,7,60],[390,7,8,125],[646,6,10,61],[-16,9,32,510,"lower"],[1670,9,32,511],[2,1]];break;case 9:t=[[-31,8,4,252],[-15,9,2,508],[-11,8,2,253],[-7,9,1,509],[-5,7,1,124],[-3,4,1,10],[-1,3,1,2],[1,3,1,3],[3,5,1,26],[5,6,1,58],[7,3,5,4],[39,6,2,59],[43,4,5,11],[75,4,6,12],[139,5,7,27],[267,5,8,28],[523,6,8,60],[779,7,9,125],[1291,6,11,61],[-32,9,32,510,"lower"],[3339,9,32,511],[2,0]];break;case 10:t=[[-21,7,4,122],[-5,8,0,252],[-4,7,0,123],[-3,5,0,24],[-2,2,2,0],[2,5,0,25],[3,6,0,54],[4,7,0,124],[5,8,0,253],[6,2,6,1],[70,5,5,26],[102,6,5,55],[134,6,6,56],[198,6,7,57],[326,6,8,58],[582,6,9,59],[1094,6,10,60],[2118,7,11,125],[-22,8,32,254,"lower"],[4166,8,32,255],[2,2]];break;case 11:t=[[1,1,0,0],[2,2,1,2],[4,4,0,12],[5,4,1,13],[7,5,1,28],[9,5,2,29],[13,6,2,60],[17,7,2,122],[21,7,3,123],[29,7,4,124],[45,7,5,125],[77,7,6,126],[141,7,32,127]];break;case 12:t=[[1,1,0,0],[2,2,0,2],[3,3,1,6],[5,5,0,28],[6,5,1,29],[8,6,1,60],[10,7,0,122],[11,7,1,123],[13,7,2,124],[17,7,3,125],[25,7,4,126],[41,8,5,254],[73,8,32,255]];break;case 13:t=[[1,1,0,0],[2,3,0,4],[3,4,0,12],[4,5,0,28],[5,4,1,13],[7,3,3,5],[15,6,1,58],[17,6,2,59],[21,6,3,60],[29,6,4,61],[45,6,5,62],[77,7,6,126],[141,7,32,127]];break;case 14:t=[[-2,3,0,4],[-1,3,0,5],[0,1,0,0],[1,3,0,6],[2,3,0,7]];break;case 15:t=[[-24,7,4,124],[-8,6,2,60],[-4,5,1,28],[-2,4,0,12],[-1,3,0,4],[0,1,0,0],[1,3,0,5],[2,4,0,13],[3,5,1,29],[5,6,2,61],[9,7,4,125],[-25,7,32,126,"lower"],[25,7,32,127]];break;default:throw new s(`standard table B.${e} does not exist`)}for(let n=0,i=t.length;n<i;n++)t[n]=new x(t[n]);return r=new T(t,!0),_[e]=r,r}function R(e,t,r){this.data=e,this.start=t,this.end=r,this.position=t,this.shift=-1,this.currentByte=0}function O(e,t,r){let n=0;for(let i=0,o=t.length;i<o;i++){const o=r[t[i]];if(o){if(e===n)return o;n++}}throw new s("can't find custom Huffman table")}function M(e,t,r){const n=[];for(let i=0;i<r;i++){const r=new Uint8Array(t);n.push(r);for(let n=0;n<t;n++)r[n]=e.readBit();e.byteAlign()}return n}function I(e,t,r,n){const i={K:-1,Columns:t,Rows:r,BlackIs1:!0,EndOfBlock:n},o=new a.CCITTFaxDecoder(e,i),s=[];let l,c=!1;for(let a=0;a<r;a++){const e=new Uint8Array(t);s.push(e);let r=-1;for(let n=0;n<t;n++)r<0&&(l=o.readNextChar(),-1===l&&(l=0,c=!0),r=7),e[n]=l>>r&1,r--}if(n&&!c){const e=5;for(let t=0;t<e&&-1!==o.readNextChar();t++);}return s}function P(){}return R.prototype={readBit(){if(this.shift<0){if(this.position>=this.end)throw new s("end of data while reading bit");this.currentByte=this.data[this.position++],this.shift=7}const e=this.currentByte>>this.shift&1;return this.shift--,e},readBits(e){let t,r=0;for(t=e-1;t>=0;t--)r|=this.readBit()<<t;return r},byteAlign(){this.shift=-1},next(){return this.position>=this.end?-1:this.data[this.position++]}},P.prototype={parseChunks:e=>function(e){for(var t=new k,r=0,n=e.length;r<n;r++){var i=e[r];C(b({},i.data,i.start,i.end),t)}return t.buffer}(e),parse(e){const{imgData:t,width:r,height:n}=function(e){const t=e.length;let r=0;if(151!==e[r]||74!==e[r+1]||66!==e[r+2]||50!==e[r+3]||13!==e[r+4]||10!==e[r+5]||26!==e[r+6]||10!==e[r+7])throw new s("parseJbig2 - invalid header.");const n=Object.create(null);r+=8;const o=e[r++];n.randomAccess=!(1&o),2&o||(n.numberOfPages=(0,i.readUint32)(e,r),r+=4);const a=b(n,e,r,t),l=new k;C(a,l);const{width:c,height:u}=l.currentPageInfo,h=l.buffer,d=new Uint8ClampedArray(c*u);let f=0,g=0;for(let i=0;i<u;i++){let e,t=0;for(let r=0;r<c;r++)t||(t=128,e=h[g++]),d[f++]=e&t?0:255,t>>=1}return{imgData:d,width:c,height:u}}(e);return this.width=r,this.height=n,t}},P}();t.Jbig2Image=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ArithmeticDecoder=void 0;const n=[{qe:22017,nmps:1,nlps:1,switchFlag:1},{qe:13313,nmps:2,nlps:6,switchFlag:0},{qe:6145,nmps:3,nlps:9,switchFlag:0},{qe:2753,nmps:4,nlps:12,switchFlag:0},{qe:1313,nmps:5,nlps:29,switchFlag:0},{qe:545,nmps:38,nlps:33,switchFlag:0},{qe:22017,nmps:7,nlps:6,switchFlag:1},{qe:21505,nmps:8,nlps:14,switchFlag:0},{qe:18433,nmps:9,nlps:14,switchFlag:0},{qe:14337,nmps:10,nlps:14,switchFlag:0},{qe:12289,nmps:11,nlps:17,switchFlag:0},{qe:9217,nmps:12,nlps:18,switchFlag:0},{qe:7169,nmps:13,nlps:20,switchFlag:0},{qe:5633,nmps:29,nlps:21,switchFlag:0},{qe:22017,nmps:15,nlps:14,switchFlag:1},{qe:21505,nmps:16,nlps:14,switchFlag:0},{qe:20737,nmps:17,nlps:15,switchFlag:0},{qe:18433,nmps:18,nlps:16,switchFlag:0},{qe:14337,nmps:19,nlps:17,switchFlag:0},{qe:13313,nmps:20,nlps:18,switchFlag:0},{qe:12289,nmps:21,nlps:19,switchFlag:0},{qe:10241,nmps:22,nlps:19,switchFlag:0},{qe:9217,nmps:23,nlps:20,switchFlag:0},{qe:8705,nmps:24,nlps:21,switchFlag:0},{qe:7169,nmps:25,nlps:22,switchFlag:0},{qe:6145,nmps:26,nlps:23,switchFlag:0},{qe:5633,nmps:27,nlps:24,switchFlag:0},{qe:5121,nmps:28,nlps:25,switchFlag:0},{qe:4609,nmps:29,nlps:26,switchFlag:0},{qe:4353,nmps:30,nlps:27,switchFlag:0},{qe:2753,nmps:31,nlps:28,switchFlag:0},{qe:2497,nmps:32,nlps:29,switchFlag:0},{qe:2209,nmps:33,nlps:30,switchFlag:0},{qe:1313,nmps:34,nlps:31,switchFlag:0},{qe:1089,nmps:35,nlps:32,switchFlag:0},{qe:673,nmps:36,nlps:33,switchFlag:0},{qe:545,nmps:37,nlps:34,switchFlag:0},{qe:321,nmps:38,nlps:35,switchFlag:0},{qe:273,nmps:39,nlps:36,switchFlag:0},{qe:133,nmps:40,nlps:37,switchFlag:0},{qe:73,nmps:41,nlps:38,switchFlag:0},{qe:37,nmps:42,nlps:39,switchFlag:0},{qe:21,nmps:43,nlps:40,switchFlag:0},{qe:9,nmps:44,nlps:41,switchFlag:0},{qe:5,nmps:45,nlps:42,switchFlag:0},{qe:1,nmps:45,nlps:43,switchFlag:0},{qe:22017,nmps:46,nlps:46,switchFlag:0}];t.ArithmeticDecoder=class{constructor(e,t,r){this.data=e,this.bp=t,this.dataEnd=r,this.chigh=e[t],this.clow=0,this.byteIn(),this.chigh=this.chigh<<7&65535|this.clow>>9&127,this.clow=this.clow<<7&65535,this.ct-=7,this.a=32768}byteIn(){const e=this.data;let t=this.bp;255===e[t]?e[t+1]>143?(this.clow+=65280,this.ct=8):(t++,this.clow+=e[t]<<9,this.ct=7,this.bp=t):(t++,this.clow+=t<this.dataEnd?e[t]<<8:65280,this.ct=8,this.bp=t),this.clow>65535&&(this.chigh+=this.clow>>16,this.clow&=65535)}readBit(e,t){let r=e[t]>>1,i=1&e[t];const o=n[r],a=o.qe;let s,l=this.a-a;if(this.chigh<a)l<a?(l=a,s=i,r=o.nmps):(l=a,s=1^i,1===o.switchFlag&&(i=s),r=o.nlps);else{if(this.chigh-=a,0!==(32768&l))return this.a=l,i;l<a?(s=1^i,1===o.switchFlag&&(i=s),r=o.nlps):(s=i,r=o.nmps)}do{0===this.ct&&this.byteIn(),l<<=1,this.chigh=this.chigh<<1&65535|this.clow>>15&1,this.clow=this.clow<<1&65535,this.ct--}while(0===(32768&l));return this.a=l,e[t]=r<<1|i,s}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.JpegStream=void 0;var n=r(12),i=r(5),o=r(19),a=r(2);const s=function(){function e(e,t,r,i){let o;for(;-1!==(o=e.getByte());)if(255===o){e.skip(-1);break}this.stream=e,this.maybeLength=t,this.dict=r,this.params=i,n.DecodeStream.call(this,t)}return e.prototype=Object.create(n.DecodeStream.prototype),Object.defineProperty(e.prototype,"bytes",{get:function(){return(0,a.shadow)(this,"bytes",this.stream.getBytes(this.maybeLength))},configurable:!0}),e.prototype.ensureBuffer=function(e){},e.prototype.readBlock=function(){if(this.eof)return;const e={decodeTransform:void 0,colorTransform:void 0},t=this.dict.getArray("Decode","D");if(this.forceRGB&&Array.isArray(t)){const r=this.dict.get("BitsPerComponent")||8,n=t.length,i=new Int32Array(n);let o=!1;const a=(1<<r)-1;for(let e=0;e<n;e+=2)i[e]=256*(t[e+1]-t[e])|0,i[e+1]=t[e]*a|0,256===i[e]&&0===i[e+1]||(o=!0);o&&(e.decodeTransform=i)}if((0,i.isDict)(this.params)){const t=this.params.get("ColorTransform");Number.isInteger(t)&&(e.colorTransform=t)}const r=new o.JpegImage(e);r.parse(this.bytes);const n=r.getData({width:this.drawWidth,height:this.drawHeight,forceRGB:this.forceRGB,isSourcePDF:!0});this.buffer=n,this.bufferLength=n.length,this.eof=!0},e}();t.JpegStream=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.JpegImage=void 0;var n=r(2),i=r(8);class o extends n.BaseException{constructor(e){super(`JPEG error: ${e}`)}}class a extends n.BaseException{constructor(e,t){super(e),this.scanLines=t}}class s extends n.BaseException{}var l=function(){var e=new Uint8Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]),t=4017,r=799,l=3406,c=2276,u=1567,h=3784,d=5793,f=2896;function g(){let{decodeTransform:e=null,colorTransform:t=-1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._decodeTransform=e,this._colorTransform=t}function p(e,t){for(var r,n,i=0,o=[],a=16;a>0&&!e[a-1];)a--;o.push({children:[],index:0});var s,l=o[0];for(r=0;r<a;r++){for(n=0;n<e[r];n++){for((l=o.pop()).children[l.index]=t[i];l.index>0;)l=o.pop();for(l.index++,o.push(l);o.length<=r;)o.push(s={children:[],index:0}),l.children[l.index]=s.children,l=s;i++}r+1<a&&(o.push(s={children:[],index:0}),l.children[l.index]=s.children,l=s)}return o[0].children}function m(e,t,r){return 64*((e.blocksPerLine+1)*t+r)}function v(t,r,l,c,u,h,d,f,g){let p=arguments.length>9&&void 0!==arguments[9]&&arguments[9];var v=l.mcusPerLine,b=l.progressive;const y=r;let S=0,C=0;function k(){if(C>0)return C--,S>>C&1;if(S=t[r++],255===S){var e=t[r++];if(e){if(220===e&&p){r+=2;const e=(0,i.readUint16)(t,r);if(r+=2,e>0&&e!==l.scanLines)throw new a("Found DNL marker (0xFFDC) while parsing scan data",e)}else if(217===e){if(p){const e=O*(8===l.precision?8:0);if(e>0&&Math.round(l.scanLines/e)>=10)throw new a("Found EOI marker (0xFFD9) while parsing scan data, possibly caused by incorrect `scanLines` parameter",e)}throw new s("Found EOI marker (0xFFD9) while parsing scan data")}throw new o(`unexpected marker ${(S<<8|e).toString(16)}`)}}return C=7,S>>>7}function x(e){for(var t=e;;){switch(typeof(t=t[k()])){case"number":return t;case"object":continue}throw new o("invalid huffman sequence")}}function E(e){for(var t=0;e>0;)t=t<<1|k(),e--;return t}function T(e){if(1===e)return 1===k()?1:-1;var t=E(e);return t>=1<<e-1?t:t+(-1<<e)+1}var _,A=0,R=0;let O=0;function M(e,t,r,n,i){var o=r%v;O=(r/v|0)*e.v+n;var a=o*e.h+i;t(e,m(e,O,a))}function I(e,t,r){O=r/e.blocksPerLine|0;var n=r%e.blocksPerLine;t(e,m(e,O,n))}var P,N,D,F,L,H,B=c.length;H=b?0===h?0===f?function(e,t){var r=x(e.huffmanTableDC),n=0===r?0:T(r)<<g;e.blockData[t]=e.pred+=n}:function(e,t){e.blockData[t]|=k()<<g}:0===f?function(t,r){if(A>0)A--;else for(var n=h,i=d;n<=i;){var o=x(t.huffmanTableAC),a=15&o,s=o>>4;if(0!==a){var l=e[n+=s];t.blockData[r+l]=T(a)*(1<<g),n++}else{if(s<15){A=E(s)+(1<<s)-1;break}n+=16}}}:function(t,r){for(var n,i,a=h,s=d,l=0;a<=s;){const s=r+e[a],c=t.blockData[s]<0?-1:1;switch(R){case 0:if(l=(i=x(t.huffmanTableAC))>>4,0===(n=15&i))l<15?(A=E(l)+(1<<l),R=4):(l=16,R=1);else{if(1!==n)throw new o("invalid ACn encoding");_=T(n),R=l?2:3}continue;case 1:case 2:t.blockData[s]?t.blockData[s]+=c*(k()<<g):0===--l&&(R=2===R?3:0);break;case 3:t.blockData[s]?t.blockData[s]+=c*(k()<<g):(t.blockData[s]=_<<g,R=0);break;case 4:t.blockData[s]&&(t.blockData[s]+=c*(k()<<g))}a++}4===R&&0===--A&&(R=0)}:function(t,r){var n=x(t.huffmanTableDC),i=0===n?0:T(n);t.blockData[r]=t.pred+=i;for(var o=1;o<64;){var a=x(t.huffmanTableAC),s=15&a,l=a>>4;if(0!==s){var c=e[o+=l];t.blockData[r+c]=T(s),o++}else{if(l<15)break;o+=16}}};var U,j,W,V,z=0;for(j=1===B?c[0].blocksPerLine*c[0].blocksPerColumn:v*l.mcusPerColumn;z<=j;){var q=u?Math.min(j-z,u):j;if(q>0){for(N=0;N<B;N++)c[N].pred=0;if(A=0,1===B)for(P=c[0],L=0;L<q;L++)I(P,H,z),z++;else for(L=0;L<q;L++){for(N=0;N<B;N++)for(W=(P=c[N]).h,V=P.v,D=0;D<V;D++)for(F=0;F<W;F++)M(P,H,z,D,F);z++}}if(C=0,!(U=w(t,r)))break;if(U.invalid){const e=q>0?"unexpected":"excessive";(0,n.warn)(`decodeScan - ${e} MCU data, current marker is: ${U.invalid}`),r=U.offset}if(!(U.marker>=65488&&U.marker<=65495))break;r+=2}return r-y}function b(e,n,i){var a,s,g,p,m,v,b,y,w,S,C,k,x,E,T,_,A,R=e.quantizationTable,O=e.blockData;if(!R)throw new o("missing required Quantization Table.");for(var M=0;M<64;M+=8)w=O[n+M],S=O[n+M+1],C=O[n+M+2],k=O[n+M+3],x=O[n+M+4],E=O[n+M+5],T=O[n+M+6],_=O[n+M+7],w*=R[M],0!==(S|C|k|x|E|T|_)?(S*=R[M+1],C*=R[M+2],k*=R[M+3],x*=R[M+4],E*=R[M+5],T*=R[M+6],_*=R[M+7],s=(a=(a=d*w+128>>8)+(s=d*x+128>>8)+1>>1)-s,A=(g=C)*h+(p=T)*u+128>>8,g=g*u-p*h+128>>8,b=(m=(m=f*(S-_)+128>>8)+(b=E<<4)+1>>1)-b,v=(y=(y=f*(S+_)+128>>8)+(v=k<<4)+1>>1)-v,p=(a=a+(p=A)+1>>1)-p,g=(s=s+g+1>>1)-g,A=m*c+y*l+2048>>12,m=m*l-y*c+2048>>12,y=A,A=v*r+b*t+2048>>12,v=v*t-b*r+2048>>12,b=A,i[M]=a+y,i[M+7]=a-y,i[M+1]=s+b,i[M+6]=s-b,i[M+2]=g+v,i[M+5]=g-v,i[M+3]=p+m,i[M+4]=p-m):(A=d*w+512>>10,i[M]=A,i[M+1]=A,i[M+2]=A,i[M+3]=A,i[M+4]=A,i[M+5]=A,i[M+6]=A,i[M+7]=A);for(var I=0;I<8;++I)w=i[I],0!==((S=i[I+8])|(C=i[I+16])|(k=i[I+24])|(x=i[I+32])|(E=i[I+40])|(T=i[I+48])|(_=i[I+56]))?(s=(a=4112+((a=d*w+2048>>12)+(s=d*x+2048>>12)+1>>1))-s,A=(g=C)*h+(p=T)*u+2048>>12,g=g*u-p*h+2048>>12,p=A,b=(m=(m=f*(S-_)+2048>>12)+(b=E)+1>>1)-b,v=(y=(y=f*(S+_)+2048>>12)+(v=k)+1>>1)-v,A=m*c+y*l+2048>>12,m=m*l-y*c+2048>>12,y=A,A=v*r+b*t+2048>>12,v=v*t-b*r+2048>>12,(w=(a=a+p+1>>1)+y)<16?w=0:w>=4080?w=255:w>>=4,(S=(s=s+g+1>>1)+(b=A))<16?S=0:S>=4080?S=255:S>>=4,(C=(g=s-g)+v)<16?C=0:C>=4080?C=255:C>>=4,(k=(p=a-p)+m)<16?k=0:k>=4080?k=255:k>>=4,(x=p-m)<16?x=0:x>=4080?x=255:x>>=4,(E=g-v)<16?E=0:E>=4080?E=255:E>>=4,(T=s-b)<16?T=0:T>=4080?T=255:T>>=4,(_=a-y)<16?_=0:_>=4080?_=255:_>>=4,O[n+I]=w,O[n+I+8]=S,O[n+I+16]=C,O[n+I+24]=k,O[n+I+32]=x,O[n+I+40]=E,O[n+I+48]=T,O[n+I+56]=_):(A=(A=d*w+8192>>14)<-2040?0:A>=2024?255:A+2056>>4,O[n+I]=A,O[n+I+8]=A,O[n+I+16]=A,O[n+I+24]=A,O[n+I+32]=A,O[n+I+40]=A,O[n+I+48]=A,O[n+I+56]=A)}function y(e,t){for(var r=t.blocksPerLine,n=t.blocksPerColumn,i=new Int16Array(64),o=0;o<n;o++)for(var a=0;a<r;a++)b(t,m(t,o,a),i);return t.blockData}function w(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t;const n=e.length-1;var o=r<t?r:t;if(t>=n)return null;var a=(0,i.readUint16)(e,t);if(a>=65472&&a<=65534)return{invalid:null,marker:a,offset:t};for(var s=(0,i.readUint16)(e,o);!(s>=65472&&s<=65534);){if(++o>=n)return null;s=(0,i.readUint16)(e,o)}return{invalid:a.toString(16),marker:s,offset:o}}return g.prototype={parse(t){let{dnlScanLines:r=null}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};function l(){const e=(0,i.readUint16)(t,d);let r=(d+=2)+e-2;var o=w(t,r,d);o&&o.invalid&&((0,n.warn)("readDataBlock - incorrect length, current marker is: "+o.invalid),r=o.offset);var a=t.subarray(d,r);return d+=a.length,a}function c(e){for(var t=Math.ceil(e.samplesPerLine/8/e.maxH),r=Math.ceil(e.scanLines/8/e.maxV),n=0;n<e.components.length;n++){W=e.components[n];var i=Math.ceil(Math.ceil(e.samplesPerLine/8)*W.h/e.maxH),o=Math.ceil(Math.ceil(e.scanLines/8)*W.v/e.maxV),a=t*W.h,s=r*W.v*64*(a+1);W.blockData=new Int16Array(s),W.blocksPerLine=i,W.blocksPerColumn=o}e.mcusPerLine=t,e.mcusPerColumn=r}var u,h,d=0,f=null,g=null;let m=0;var b=[],S=[],C=[];let k=(0,i.readUint16)(t,d);if(d+=2,65496!==k)throw new o("SOI not found");k=(0,i.readUint16)(t,d),d+=2;e:for(;65497!==k;){var x,E,T;switch(k){case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:var _=l();65504===k&&74===_[0]&&70===_[1]&&73===_[2]&&70===_[3]&&0===_[4]&&(f={version:{major:_[5],minor:_[6]},densityUnits:_[7],xDensity:_[8]<<8|_[9],yDensity:_[10]<<8|_[11],thumbWidth:_[12],thumbHeight:_[13],thumbData:_.subarray(14,14+3*_[12]*_[13])}),65518===k&&65===_[0]&&100===_[1]&&111===_[2]&&98===_[3]&&101===_[4]&&(g={version:_[5]<<8|_[6],flags0:_[7]<<8|_[8],flags1:_[9]<<8|_[10],transformCode:_[11]});break;case 65499:for(var A=(0,i.readUint16)(t,d)+(d+=2)-2;d<A;){var R=t[d++],O=new Uint16Array(64);if(R>>4===0)for(E=0;E<64;E++)O[e[E]]=t[d++];else{if(R>>4!==1)throw new o("DQT - invalid table spec");for(E=0;E<64;E++)O[e[E]]=(0,i.readUint16)(t,d),d+=2}b[15&R]=O}break;case 65472:case 65473:case 65474:if(u)throw new o("Only single frame JPEGs supported");d+=2,(u={}).extended=65473===k,u.progressive=65474===k,u.precision=t[d++];const y=(0,i.readUint16)(t,d);d+=2,u.scanLines=r||y,u.samplesPerLine=(0,i.readUint16)(t,d),d+=2,u.components=[],u.componentIds={};var M,I=t[d++],P=0,N=0;for(x=0;x<I;x++){M=t[d];var D=t[d+1]>>4,F=15&t[d+1];P<D&&(P=D),N<F&&(N=F);var L=t[d+2];T=u.components.push({h:D,v:F,quantizationId:L,quantizationTable:null}),u.componentIds[M]=T-1,d+=3}u.maxH=P,u.maxV=N,c(u);break;case 65476:const J=(0,i.readUint16)(t,d);for(d+=2,x=2;x<J;){var H=t[d++],B=new Uint8Array(16),U=0;for(E=0;E<16;E++,d++)U+=B[E]=t[d];var j=new Uint8Array(U);for(E=0;E<U;E++,d++)j[E]=t[d];x+=17+U,(H>>4===0?C:S)[15&H]=p(B,j)}break;case 65501:d+=2,h=(0,i.readUint16)(t,d),d+=2;break;case 65498:const Q=1===++m&&!r;d+=2;var W,V=t[d++],z=[];for(x=0;x<V;x++){const e=t[d++];var q=u.componentIds[e];(W=u.components[q]).index=e;var G=t[d++];W.huffmanTableDC=C[G>>4],W.huffmanTableAC=S[15&G],z.push(W)}var $=t[d++],K=t[d++],Y=t[d++];try{var X=v(t,d,u,z,h,$,K,Y>>4,15&Y,Q);d+=X}catch(Z){if(Z instanceof a)return(0,n.warn)(`${Z.message} -- attempting to re-parse the JPEG image.`),this.parse(t,{dnlScanLines:Z.scanLines});if(Z instanceof s){(0,n.warn)(`${Z.message} -- ignoring the rest of the image data.`);break e}throw Z}break;case 65500:d+=4;break;case 65535:255!==t[d]&&d--;break;default:const ee=w(t,d-2,d-3);if(ee&&ee.invalid){(0,n.warn)("JpegImage.parse - unexpected data, current marker is: "+ee.invalid),d=ee.offset;break}if(d>=t.length-1){(0,n.warn)("JpegImage.parse - reached the end of the image data without finding an EOI marker (0xFFD9).");break e}throw new o("JpegImage.parse - unknown marker: "+k.toString(16))}k=(0,i.readUint16)(t,d),d+=2}for(this.width=u.samplesPerLine,this.height=u.scanLines,this.jfif=f,this.adobe=g,this.components=[],x=0;x<u.components.length;x++){var J=b[(W=u.components[x]).quantizationId];J&&(W.quantizationTable=J),this.components.push({index:W.index,output:y(0,W),scaleX:W.h/u.maxH,scaleY:W.v/u.maxV,blocksPerLine:W.blocksPerLine,blocksPerColumn:W.blocksPerColumn})}this.numComponents=this.components.length},_getLinearizedBlockData(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];var n,i,o,a,s,l,c,u,h,d,f,g=this.width/e,p=this.height/t,m=0,v=this.components.length,b=e*t*v,y=new Uint8ClampedArray(b),w=new Uint32Array(e),S=4294967288;let C;for(c=0;c<v;c++){if(i=(n=this.components[c]).scaleX*g,o=n.scaleY*p,m=c,f=n.output,a=n.blocksPerLine+1<<3,i!==C){for(s=0;s<e;s++)u=0|s*i,w[s]=(u&S)<<3|7&u;C=i}for(l=0;l<t;l++)for(d=a*((u=0|l*o)&S)|(7&u)<<3,s=0;s<e;s++)y[m]=f[d+w[s]],m+=v}let k=this._decodeTransform;if(r||4!==v||k||(k=new Int32Array([-256,255,-256,255,-256,255,-256,255])),k)for(c=0;c<b;)for(u=0,h=0;u<v;u++,c++,h+=2)y[c]=(y[c]*k[h]>>8)+k[h+1];return y},get _isColorConversionNeeded(){return this.adobe?!!this.adobe.transformCode:3===this.numComponents?0!==this._colorTransform&&(82!==this.components[0].index||71!==this.components[1].index||66!==this.components[2].index):1===this._colorTransform},_convertYccToRgb:function(e){for(var t,r,n,i=0,o=e.length;i<o;i+=3)t=e[i],r=e[i+1],n=e[i+2],e[i]=t-179.456+1.402*n,e[i+1]=t+135.459-.344*r-.714*n,e[i+2]=t-226.816+1.772*r;return e},_convertYcckToRgb:function(e){for(var t,r,n,i,o=0,a=0,s=e.length;a<s;a+=4)t=e[a],r=e[a+1],n=e[a+2],i=e[a+3],e[o++]=r*(-660635669420364e-19*r+.000437130475926232*n-54080610064599e-18*t+.00048449797120281*i-.154362151871126)-122.67195406894+n*(-.000957964378445773*n+.000817076911346625*t-.00477271405408747*i+1.53380253221734)+t*(.000961250184130688*t-.00266257332283933*i+.48357088451265)+i*(-.000336197177618394*i+.484791561490776),e[o++]=107.268039397724+r*(219927104525741e-19*r-.000640992018297945*n+.000659397001245577*t+.000426105652938837*i-.176491792462875)+n*(-.000778269941513683*n+.00130872261408275*t+.000770482631801132*i-.151051492775562)+t*(.00126935368114843*t-.00265090189010898*i+.25802910206845)+i*(-.000318913117588328*i-.213742400323665),e[o++]=r*(-.000570115196973677*r-263409051004589e-19*n+.0020741088115012*t-.00288260236853442*i+.814272968359295)-20.810012546947+n*(-153496057440975e-19*n-.000132689043961446*t+.000560833691242812*i-.195152027534049)+t*(.00174418132927582*t-.00255243321439347*i+.116935020465145)+i*(-.000343531996510555*i+.24165260232407);return e.subarray(0,o)},_convertYcckToCmyk:function(e){for(var t,r,n,i=0,o=e.length;i<o;i+=4)t=e[i],r=e[i+1],n=e[i+2],e[i]=434.456-t-1.402*n,e[i+1]=119.541-t+.344*r+.714*n,e[i+2]=481.816-t-1.772*r;return e},_convertCmykToRgb:function(e){for(var t,r,n,i,o=0,a=0,s=e.length;a<s;a+=4)t=e[a],r=e[a+1],n=e[a+2],i=e[a+3],e[o++]=255+t*(-6747147073602441e-20*t+.0008379262121013727*r+.0002894718188643294*n+.003264231057537806*i-1.1185611867203937)+r*(26374107616089405e-21*r-8626949158638572e-20*n-.0002748769067499491*i-.02155688794978967)+n*(-3878099212869363e-20*n-.0003267808279485286*i+.0686742238595345)-i*(.0003361971776183937*i+.7430659151342254),e[o++]=255+t*(.00013596372813588848*t+.000924537132573585*r+.00010567359618683593*n+.0004791864687436512*i-.3109689587515875)+r*(-.00023545346108370344*r+.0002702845253534714*n+.0020200308977307156*i-.7488052167015494)+n*(6834815998235662e-20*n+.00015168452363460973*i-.09751927774728933)-i*(.0003189131175883281*i+.7364883807733168),e[o++]=255+t*(13598650411385307e-21*t+.00012423956175490851*r+.0004751985097583589*n-36729317476630422e-22*i-.05562186980264034)+r*(.00016141380598724676*r+.0009692239130725186*n+.0007782692450036253*i-.44015232367526463)+n*(5.068882914068769e-7*n+.0017778369011375071*i-.7591454649749609)-i*(.0003435319965105553*i+.7063770186160144);return e.subarray(0,o)},getData(e){let{width:t,height:r,forceRGB:n=!1,isSourcePDF:i=!1}=e;if(this.numComponents>4)throw new o("Unsupported color mode");var a=this._getLinearizedBlockData(t,r,i);if(1===this.numComponents&&n){for(var s=a.length,l=new Uint8ClampedArray(3*s),c=0,u=0;u<s;u++){var h=a[u];l[c++]=h,l[c++]=h,l[c++]=h}return l}if(3===this.numComponents&&this._isColorConversionNeeded)return this._convertYccToRgb(a);if(4===this.numComponents){if(this._isColorConversionNeeded)return n?this._convertYcckToRgb(a):this._convertYcckToCmyk(a);if(n)return this._convertCmykToRgb(a)}return a}},g}();t.JpegImage=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.JpxStream=void 0;var n=r(12),i=r(21),o=r(2);const a=function(){function e(e,t,r,i){this.stream=e,this.maybeLength=t,this.dict=r,this.params=i,n.DecodeStream.call(this,t)}return e.prototype=Object.create(n.DecodeStream.prototype),Object.defineProperty(e.prototype,"bytes",{get:function(){return(0,o.shadow)(this,"bytes",this.stream.getBytes(this.maybeLength))},configurable:!0}),e.prototype.ensureBuffer=function(e){},e.prototype.readBlock=function(){if(this.eof)return;const e=new i.JpxImage;e.parse(this.bytes);const t=e.width,r=e.height,n=e.componentsCount,o=e.tiles.length;if(1===o)this.buffer=e.tiles[0].items;else{const i=new Uint8ClampedArray(t*r*n);for(let r=0;r<o;r++){const o=e.tiles[r],a=o.width,s=o.height,l=o.left,c=o.top,u=o.items;let h=0,d=(t*c+l)*n;const f=t*n,g=a*n;for(let e=0;e<s;e++){const e=u.subarray(h,h+g);i.set(e,d),h+=g,d+=f}}this.buffer=i}this.bufferLength=this.buffer.length,this.eof=!0},e}();t.JpxStream=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.JpxImage=void 0;var n=r(2),i=r(8),o=r(17);class a extends n.BaseException{constructor(e){super(`JPX error: ${e}`)}}var s=function(){var e={LL:0,LH:1,HL:1,HH:2};function t(){this.failOnCorruptedImage=!1}function r(e,t){e.x0=Math.ceil(t.XOsiz/e.XRsiz),e.x1=Math.ceil(t.Xsiz/e.XRsiz),e.y0=Math.ceil(t.YOsiz/e.YRsiz),e.y1=Math.ceil(t.Ysiz/e.YRsiz),e.width=e.x1-e.x0,e.height=e.y1-e.y0}function s(e,t){for(var r,n=e.SIZ,i=[],o=Math.ceil((n.Xsiz-n.XTOsiz)/n.XTsiz),a=Math.ceil((n.Ysiz-n.YTOsiz)/n.YTsiz),s=0;s<a;s++)for(var l=0;l<o;l++)(r={}).tx0=Math.max(n.XTOsiz+l*n.XTsiz,n.XOsiz),r.ty0=Math.max(n.YTOsiz+s*n.YTsiz,n.YOsiz),r.tx1=Math.min(n.XTOsiz+(l+1)*n.XTsiz,n.Xsiz),r.ty1=Math.min(n.YTOsiz+(s+1)*n.YTsiz,n.Ysiz),r.width=r.tx1-r.tx0,r.height=r.ty1-r.ty0,r.components=[],i.push(r);e.tiles=i;for(var c=0,u=n.Csiz;c<u;c++)for(var h=t[c],d=0,f=i.length;d<f;d++){var g={};r=i[d],g.tcx0=Math.ceil(r.tx0/h.XRsiz),g.tcy0=Math.ceil(r.ty0/h.YRsiz),g.tcx1=Math.ceil(r.tx1/h.XRsiz),g.tcy1=Math.ceil(r.ty1/h.YRsiz),g.width=g.tcx1-g.tcx0,g.height=g.tcy1-g.tcy0,r.components[c]=g}}function l(e,t,r){var n=t.codingStyleParameters,i={};return n.entropyCoderWithCustomPrecincts?(i.PPx=n.precinctsSizes[r].PPx,i.PPy=n.precinctsSizes[r].PPy):(i.PPx=15,i.PPy=15),i.xcb_=r>0?Math.min(n.xcb,i.PPx-1):Math.min(n.xcb,i.PPx),i.ycb_=r>0?Math.min(n.ycb,i.PPy-1):Math.min(n.ycb,i.PPy),i}function c(e,t,r){var n=1<<r.PPx,i=1<<r.PPy,o=0===t.resLevel,a=1<<r.PPx+(o?0:-1),s=1<<r.PPy+(o?0:-1),l=t.trx1>t.trx0?Math.ceil(t.trx1/n)-Math.floor(t.trx0/n):0,c=t.try1>t.try0?Math.ceil(t.try1/i)-Math.floor(t.try0/i):0,u=l*c;t.precinctParameters={precinctWidth:n,precinctHeight:i,numprecinctswide:l,numprecinctshigh:c,numprecincts:u,precinctWidthInSubband:a,precinctHeightInSubband:s}}function u(e,t,r){var n,i,o,a,s=r.xcb_,l=r.ycb_,c=1<<s,u=1<<l,h=t.tbx0>>s,d=t.tby0>>l,f=t.tbx1+c-1>>s,g=t.tby1+u-1>>l,p=t.resolution.precinctParameters,m=[],v=[];for(i=d;i<g;i++)for(n=h;n<f;n++)if((o={cbx:n,cby:i,tbx0:c*n,tby0:u*i,tbx1:c*(n+1),tby1:u*(i+1)}).tbx0_=Math.max(t.tbx0,o.tbx0),o.tby0_=Math.max(t.tby0,o.tby0),o.tbx1_=Math.min(t.tbx1,o.tbx1),o.tby1_=Math.min(t.tby1,o.tby1),a=Math.floor((o.tbx0_-t.tbx0)/p.precinctWidthInSubband)+Math.floor((o.tby0_-t.tby0)/p.precinctHeightInSubband)*p.numprecinctswide,o.precinctNumber=a,o.subbandType=t.type,o.Lblock=3,!(o.tbx1_<=o.tbx0_||o.tby1_<=o.tby0_)){m.push(o);var b=v[a];void 0!==b?(n<b.cbxMin?b.cbxMin=n:n>b.cbxMax&&(b.cbxMax=n),i<b.cbyMin?b.cbxMin=i:i>b.cbyMax&&(b.cbyMax=i)):v[a]=b={cbxMin:n,cbyMin:i,cbxMax:n,cbyMax:i},o.precinct=b}t.codeblockParameters={codeblockWidth:s,codeblockHeight:l,numcodeblockwide:f-h+1,numcodeblockhigh:g-d+1},t.codeblocks=m,t.precincts=v}function h(e,t,r){for(var n=[],i=e.subbands,o=0,a=i.length;o<a;o++)for(var s=i[o].codeblocks,l=0,c=s.length;l<c;l++){var u=s[l];u.precinctNumber===t&&n.push(u)}return{layerNumber:r,codeblocks:n}}function d(e){for(var t=e.SIZ,r=e.currentTile.index,n=e.tiles[r],i=n.codingStyleDefaultParameters.layersCount,o=t.Csiz,s=0,l=0;l<o;l++)s=Math.max(s,n.components[l].codingStyleParameters.decompositionLevelsCount);var c=0,u=0,d=0,f=0;this.nextPacket=function(){for(;c<i;c++){for(;u<=s;u++){for(;d<o;d++){var e=n.components[d];if(!(u>e.codingStyleParameters.decompositionLevelsCount)){for(var t=e.resolutions[u],r=t.precinctParameters.numprecincts;f<r;){var l=h(t,f,c);return f++,l}f=0}}d=0}u=0}throw new a("Out of packets")}}function f(e){for(var t=e.SIZ,r=e.currentTile.index,n=e.tiles[r],i=n.codingStyleDefaultParameters.layersCount,o=t.Csiz,s=0,l=0;l<o;l++)s=Math.max(s,n.components[l].codingStyleParameters.decompositionLevelsCount);var c=0,u=0,d=0,f=0;this.nextPacket=function(){for(;c<=s;c++){for(;u<i;u++){for(;d<o;d++){var e=n.components[d];if(!(c>e.codingStyleParameters.decompositionLevelsCount)){for(var t=e.resolutions[c],r=t.precinctParameters.numprecincts;f<r;){var l=h(t,f,u);return f++,l}f=0}}d=0}u=0}throw new a("Out of packets")}}function g(e){var t,r,n,i,o=e.SIZ,s=e.currentTile.index,l=e.tiles[s],c=l.codingStyleDefaultParameters.layersCount,u=o.Csiz,d=0;for(n=0;n<u;n++){const e=l.components[n];d=Math.max(d,e.codingStyleParameters.decompositionLevelsCount)}var f=new Int32Array(d+1);for(r=0;r<=d;++r){var g=0;for(n=0;n<u;++n){var p=l.components[n].resolutions;r<p.length&&(g=Math.max(g,p[r].precinctParameters.numprecincts))}f[r]=g}t=0,r=0,n=0,i=0,this.nextPacket=function(){for(;r<=d;r++){for(;i<f[r];i++){for(;n<u;n++){const a=l.components[n];if(!(r>a.codingStyleParameters.decompositionLevelsCount)){var e=a.resolutions[r],o=e.precinctParameters.numprecincts;if(!(i>=o)){for(;t<c;){var s=h(e,i,t);return t++,s}t=0}}}n=0}i=0}throw new a("Out of packets")}}function p(e){var t=e.SIZ,r=e.currentTile.index,n=e.tiles[r],i=n.codingStyleDefaultParameters.layersCount,o=t.Csiz,s=b(n),l=s,c=0,u=0,d=0,f=0,g=0;this.nextPacket=function(){for(;g<l.maxNumHigh;g++){for(;f<l.maxNumWide;f++){for(;d<o;d++){for(var e=n.components[d],t=e.codingStyleParameters.decompositionLevelsCount;u<=t;u++){var r=e.resolutions[u],p=s.components[d].resolutions[u],m=v(f,g,p,l,r);if(null!==m){for(;c<i;){var b=h(r,m,c);return c++,b}c=0}}u=0}d=0}f=0}throw new a("Out of packets")}}function m(e){var t=e.SIZ,r=e.currentTile.index,n=e.tiles[r],i=n.codingStyleDefaultParameters.layersCount,o=t.Csiz,s=b(n),l=0,c=0,u=0,d=0,f=0;this.nextPacket=function(){for(;u<o;++u){for(var e=n.components[u],t=s.components[u],r=e.codingStyleParameters.decompositionLevelsCount;f<t.maxNumHigh;f++){for(;d<t.maxNumWide;d++){for(;c<=r;c++){var g=e.resolutions[c],p=t.resolutions[c],m=v(d,f,p,t,g);if(null!==m){for(;l<i;){var b=h(g,m,l);return l++,b}l=0}}c=0}d=0}f=0}throw new a("Out of packets")}}function v(e,t,r,n,i){var o=e*n.minWidth,a=t*n.minHeight;if(o%r.width!==0||a%r.height!==0)return null;var s=a/r.width*i.precinctParameters.numprecinctswide;return o/r.height+s}function b(e){for(var t=e.components.length,r=Number.MAX_VALUE,n=Number.MAX_VALUE,i=0,o=0,a=new Array(t),s=0;s<t;s++){for(var l=e.components[s],c=l.codingStyleParameters.decompositionLevelsCount,u=new Array(c+1),h=Number.MAX_VALUE,d=Number.MAX_VALUE,f=0,g=0,p=1,m=c;m>=0;--m){var v=l.resolutions[m],b=p*v.precinctParameters.precinctWidth,y=p*v.precinctParameters.precinctHeight;h=Math.min(h,b),d=Math.min(d,y),f=Math.max(f,v.precinctParameters.numprecinctswide),g=Math.max(g,v.precinctParameters.numprecinctshigh),u[m]={width:b,height:y},p<<=1}r=Math.min(r,h),n=Math.min(n,d),i=Math.max(i,f),o=Math.max(o,g),a[s]={resolutions:u,minWidth:h,minHeight:d,maxNumWide:f,maxNumHigh:g}}return{components:a,minWidth:r,minHeight:n,maxNumWide:i,maxNumHigh:o}}function y(e){for(var t=e.SIZ,r=e.currentTile.index,n=e.tiles[r],i=t.Csiz,o=0;o<i;o++){for(var s=n.components[o],h=s.codingStyleParameters.decompositionLevelsCount,v=[],b=[],y=0;y<=h;y++){var w,S=l(0,s,y),C={},k=1<<h-y;if(C.trx0=Math.ceil(s.tcx0/k),C.try0=Math.ceil(s.tcy0/k),C.trx1=Math.ceil(s.tcx1/k),C.try1=Math.ceil(s.tcy1/k),C.resLevel=y,c(0,C,S),v.push(C),0===y)(w={}).type="LL",w.tbx0=Math.ceil(s.tcx0/k),w.tby0=Math.ceil(s.tcy0/k),w.tbx1=Math.ceil(s.tcx1/k),w.tby1=Math.ceil(s.tcy1/k),w.resolution=C,u(0,w,S),b.push(w),C.subbands=[w];else{var x=1<<h-y+1,E=[];(w={}).type="HL",w.tbx0=Math.ceil(s.tcx0/x-.5),w.tby0=Math.ceil(s.tcy0/x),w.tbx1=Math.ceil(s.tcx1/x-.5),w.tby1=Math.ceil(s.tcy1/x),w.resolution=C,u(0,w,S),b.push(w),E.push(w),(w={}).type="LH",w.tbx0=Math.ceil(s.tcx0/x),w.tby0=Math.ceil(s.tcy0/x-.5),w.tbx1=Math.ceil(s.tcx1/x),w.tby1=Math.ceil(s.tcy1/x-.5),w.resolution=C,u(0,w,S),b.push(w),E.push(w),(w={}).type="HH",w.tbx0=Math.ceil(s.tcx0/x-.5),w.tby0=Math.ceil(s.tcy0/x-.5),w.tbx1=Math.ceil(s.tcx1/x-.5),w.tby1=Math.ceil(s.tcy1/x-.5),w.resolution=C,u(0,w,S),b.push(w),E.push(w),C.subbands=E}}s.resolutions=v,s.subbands=b}var T=n.codingStyleDefaultParameters.progressionOrder;switch(T){case 0:n.packetsIterator=new d(e);break;case 1:n.packetsIterator=new f(e);break;case 2:n.packetsIterator=new g(e);break;case 3:n.packetsIterator=new p(e);break;case 4:n.packetsIterator=new m(e);break;default:throw new a(`Unsupported progression order ${T}`)}}function w(e,t,r,n){var o,a=0,s=0,l=!1;function c(e){for(;s<e;){var n=t[r+a];a++,l?(o=o<<7|n,s+=7,l=!1):(o=o<<8|n,s+=8),255===n&&(l=!0)}return o>>>(s-=e)&(1<<e)-1}function u(e){return 255===t[r+a-1]&&t[r+a]===e?(h(1),!0):255===t[r+a]&&t[r+a+1]===e&&(h(2),!0)}function h(e){a+=e}function d(){s=0,l&&(a++,l=!1)}function f(){if(0===c(1))return 1;if(0===c(1))return 2;var e=c(2);return e<3?e+3:(e=c(5))<31?e+6:(e=c(7))+37}for(var g=e.currentTile.index,p=e.tiles[g],m=e.COD.sopMarkerUsed,v=e.COD.ephMarkerUsed,b=p.packetsIterator;a<n;){d(),m&&u(145)&&h(4);var y=b.nextPacket();if(c(1)){for(var w,S=y.layerNumber,C=[],k=0,T=y.codeblocks.length;k<T;k++){var _=(w=y.codeblocks[k]).precinct,A=w.cbx-_.cbxMin,R=w.cby-_.cbyMin,O=!1,M=!1;if(void 0!==w.included)O=!!c(1);else{var I,P;if(void 0!==(_=w.precinct).inclusionTree)I=_.inclusionTree;else{var N=_.cbxMax-_.cbxMin+1,D=_.cbyMax-_.cbyMin+1;I=new E(N,D,S),P=new x(N,D),_.inclusionTree=I,_.zeroBitPlanesTree=P}if(I.reset(A,R,S))for(;;){if(!c(1)){I.incrementValue(S);break}if(!I.nextLevel()){w.included=!0,O=M=!0;break}}}if(O){if(M){for((P=_.zeroBitPlanesTree).reset(A,R);;)if(c(1)){if(!P.nextLevel())break}else P.incrementValue();w.zeroBitPlanes=P.value}for(var F=f();c(1);)w.Lblock++;var L=(0,i.log2)(F),H=c((F<1<<L?L-1:L)+w.Lblock);C.push({codeblock:w,codingpasses:F,dataLength:H})}}for(d(),v&&u(146);C.length>0;){var B=C.shift();void 0===(w=B.codeblock).data&&(w.data=[]),w.data.push({data:t,start:r+a,end:r+a+B.dataLength,codingpasses:B.codingpasses}),a+=B.dataLength}}}return a}function S(e,t,r,n,i,a,s,l){for(var c=n.tbx0,u=n.tby0,h=n.tbx1-n.tbx0,d=n.codeblocks,f="H"===n.type.charAt(0)?1:0,g="H"===n.type.charAt(1)?t:0,p=0,m=d.length;p<m;++p){var v=d[p],b=v.tbx1_-v.tbx0_,y=v.tby1_-v.tby0_;if(0!==b&&0!==y&&void 0!==v.data){var w,S;w=new T(b,y,v.subbandType,v.zeroBitPlanes,a),S=2;var C,k,x,E=v.data,_=0,A=0;for(C=0,k=E.length;C<k;C++)_+=(x=E[C]).end-x.start,A+=x.codingpasses;var R=new Uint8Array(_),O=0;for(C=0,k=E.length;C<k;C++){var M=(x=E[C]).data.subarray(x.start,x.end);R.set(M,O),O+=M.length}var I=new o.ArithmeticDecoder(R,0,_);for(w.setDecoder(I),C=0;C<A;C++){switch(S){case 0:w.runSignificancePropagationPass();break;case 1:w.runMagnitudeRefinementPass();break;case 2:w.runCleanupPass(),l&&w.checkSegmentationSymbol()}S=(S+1)%3}var P,N,D,F=v.tbx0_-c+(v.tby0_-u)*h,L=w.coefficentsSign,H=w.coefficentsMagnitude,B=w.bitsDecoded,U=s?0:.5;O=0;var j="LL"!==n.type;for(C=0;C<y;C++){var W=2*(F/h|0)*(t-h)+f+g;for(P=0;P<b;P++){if(0!==(N=H[O])){N=(N+U)*i,0!==L[O]&&(N=-N),D=B[O];var V=j?W+(F<<1):F;e[V]=s&&D>=a?N:N*(1<<a-D)}F++,O++}F+=h-b}}}}function C(t,r,n){for(var i=r.components[n],o=i.codingStyleParameters,a=i.quantizationParameters,s=o.decompositionLevelsCount,l=a.SPqcds,c=a.scalarExpounded,u=a.guardBits,h=o.segmentationSymbolUsed,d=t.components[n].precision,f=o.reversibleTransformation,g=f?new R:new A,p=[],m=0,v=0;v<=s;v++){for(var b=i.resolutions[v],y=b.trx1-b.trx0,w=b.try1-b.try0,C=new Float32Array(y*w),k=0,x=b.subbands.length;k<x;k++){var E,T;c?(E=l[m].mu,T=l[m].epsilon,m++):(E=l[0].mu,T=l[0].epsilon+(v>0?1-v:0));var _=b.subbands[k],O=e[_.type];S(C,y,0,_,f?1:2**(d+O-T)*(1+E/2048),u+T-1,f,h)}p.push({width:y,height:w,items:C})}var M=g.calculate(p,i.tcx0,i.tcy0);return{left:i.tcx0,top:i.tcy0,width:M.width,height:M.height,items:M.items}}function k(e,t){for(var r=e.SIZ.Csiz,n=e.tiles[t],i=0;i<r;i++){var o=n.components[i],a=void 0!==e.currentTile.QCC[i]?e.currentTile.QCC[i]:e.currentTile.QCD;o.quantizationParameters=a;var s=void 0!==e.currentTile.COC[i]?e.currentTile.COC[i]:e.currentTile.COD;o.codingStyleParameters=s}n.codingStyleDefaultParameters=e.currentTile.COD}t.prototype={parse:function(e){if(65359!==(0,i.readUint16)(e,0))for(var t=0,r=e.length;t<r;){var o=8,s=(0,i.readUint32)(e,t),l=(0,i.readUint32)(e,t+4);if(t+=o,1===s&&(s=4294967296*(0,i.readUint32)(e,t)+(0,i.readUint32)(e,t+4),t+=8,o+=8),0===s&&(s=r-t+o),s<o)throw new a("Invalid box field size");var c=s-o,u=!0;switch(l){case 1785737832:u=!1;break;case 1668246642:var h=e[t];if(1===h){var d=(0,i.readUint32)(e,t+3);switch(d){case 16:case 17:case 18:break;default:(0,n.warn)("Unknown colorspace "+d)}}else 2===h&&(0,n.info)("ICC profile not supported");break;case 1785737827:this.parseCodestream(e,t,t+c);break;case 1783636e3:218793738!==(0,i.readUint32)(e,t)&&(0,n.warn)("Invalid JP2 signature");break;case 1783634458:case 1718909296:case 1920099697:case 1919251232:case 1768449138:break;default:var f=String.fromCharCode(l>>24&255,l>>16&255,l>>8&255,255&l);(0,n.warn)("Unsupported header type "+l+" ("+f+")")}u&&(t+=c)}else this.parseCodestream(e,0,e.length)},parseImageProperties:function(e){for(var t=e.getByte();t>=0;)if(65361===(t<<8|(t=e.getByte()))){e.skip(4);var r=e.getInt32()>>>0,n=e.getInt32()>>>0,i=e.getInt32()>>>0,o=e.getInt32()>>>0;e.skip(16);var s=e.getUint16();return this.width=r-i,this.height=n-o,this.componentsCount=s,void(this.bitsPerComponent=8)}throw new a("No size marker found in JPX stream")},parseCodestream:function(e,t,o){var l={},c=!1;try{for(var u=t;u+1<o;){var h=(0,i.readUint16)(e,u);u+=2;var d,f,g,p,m,v,b=0;switch(h){case 65359:l.mainHeader=!0;break;case 65497:break;case 65361:b=(0,i.readUint16)(e,u);var S={};S.Xsiz=(0,i.readUint32)(e,u+4),S.Ysiz=(0,i.readUint32)(e,u+8),S.XOsiz=(0,i.readUint32)(e,u+12),S.YOsiz=(0,i.readUint32)(e,u+16),S.XTsiz=(0,i.readUint32)(e,u+20),S.YTsiz=(0,i.readUint32)(e,u+24),S.XTOsiz=(0,i.readUint32)(e,u+28),S.YTOsiz=(0,i.readUint32)(e,u+32);var x=(0,i.readUint16)(e,u+36);S.Csiz=x;var E=[];d=u+38;for(var T=0;T<x;T++){var _={precision:1+(127&e[d]),isSigned:!!(128&e[d]),XRsiz:e[d+1],YRsiz:e[d+2]};d+=3,r(_,S),E.push(_)}l.SIZ=S,l.components=E,s(l,E),l.QCC=[],l.COC=[];break;case 65372:b=(0,i.readUint16)(e,u);var A={};switch(d=u+2,31&(f=e[d++])){case 0:p=8,m=!0;break;case 1:p=16,m=!1;break;case 2:p=16,m=!0;break;default:throw new Error("Invalid SQcd value "+f)}for(A.noQuantization=8===p,A.scalarExpounded=m,A.guardBits=f>>5,g=[];d<b+u;){var R={};8===p?(R.epsilon=e[d++]>>3,R.mu=0):(R.epsilon=e[d]>>3,R.mu=(7&e[d])<<8|e[d+1],d+=2),g.push(R)}A.SPqcds=g,l.mainHeader?l.QCD=A:(l.currentTile.QCD=A,l.currentTile.QCC=[]);break;case 65373:b=(0,i.readUint16)(e,u);var O,M={};switch(d=u+2,l.SIZ.Csiz<257?O=e[d++]:(O=(0,i.readUint16)(e,d),d+=2),31&(f=e[d++])){case 0:p=8,m=!0;break;case 1:p=16,m=!1;break;case 2:p=16,m=!0;break;default:throw new Error("Invalid SQcd value "+f)}for(M.noQuantization=8===p,M.scalarExpounded=m,M.guardBits=f>>5,g=[];d<b+u;)R={},8===p?(R.epsilon=e[d++]>>3,R.mu=0):(R.epsilon=e[d]>>3,R.mu=(7&e[d])<<8|e[d+1],d+=2),g.push(R);M.SPqcds=g,l.mainHeader?l.QCC[O]=M:l.currentTile.QCC[O]=M;break;case 65362:b=(0,i.readUint16)(e,u);var I={};d=u+2;var P=e[d++];I.entropyCoderWithCustomPrecincts=!!(1&P),I.sopMarkerUsed=!!(2&P),I.ephMarkerUsed=!!(4&P),I.progressionOrder=e[d++],I.layersCount=(0,i.readUint16)(e,d),d+=2,I.multipleComponentTransform=e[d++],I.decompositionLevelsCount=e[d++],I.xcb=2+(15&e[d++]),I.ycb=2+(15&e[d++]);var N=e[d++];if(I.selectiveArithmeticCodingBypass=!!(1&N),I.resetContextProbabilities=!!(2&N),I.terminationOnEachCodingPass=!!(4&N),I.verticallyStripe=!!(8&N),I.predictableTermination=!!(16&N),I.segmentationSymbolUsed=!!(32&N),I.reversibleTransformation=e[d++],I.entropyCoderWithCustomPrecincts){for(var D=[];d<b+u;){var F=e[d++];D.push({PPx:15&F,PPy:F>>4})}I.precinctsSizes=D}var L=[];if(I.selectiveArithmeticCodingBypass&&L.push("selectiveArithmeticCodingBypass"),I.resetContextProbabilities&&L.push("resetContextProbabilities"),I.terminationOnEachCodingPass&&L.push("terminationOnEachCodingPass"),I.verticallyStripe&&L.push("verticallyStripe"),I.predictableTermination&&L.push("predictableTermination"),L.length>0)throw c=!0,new Error("Unsupported COD options ("+L.join(", ")+")");l.mainHeader?l.COD=I:(l.currentTile.COD=I,l.currentTile.COC=[]);break;case 65424:b=(0,i.readUint16)(e,u),(v={}).index=(0,i.readUint16)(e,u+2),v.length=(0,i.readUint32)(e,u+4),v.dataEnd=v.length+u-2,v.partIndex=e[u+8],v.partsCount=e[u+9],l.mainHeader=!1,0===v.partIndex&&(v.COD=l.COD,v.COC=l.COC.slice(0),v.QCD=l.QCD,v.QCC=l.QCC.slice(0)),l.currentTile=v;break;case 65427:0===(v=l.currentTile).partIndex&&(k(l,v.index),y(l)),w(l,e,u,b=v.dataEnd-u);break;case 65365:case 65367:case 65368:case 65380:b=(0,i.readUint16)(e,u);break;case 65363:throw new Error("Codestream code 0xFF53 (COC) is not implemented");default:throw new Error("Unknown codestream code: "+h.toString(16))}u+=b}}catch(H){if(c||this.failOnCorruptedImage)throw new a(H.message);(0,n.warn)("JPX: Trying to recover from: "+H.message)}this.tiles=function(e){for(var t=e.SIZ,r=e.components,n=t.Csiz,i=[],o=0,a=e.tiles.length;o<a;o++){var s,l=e.tiles[o],c=[];for(s=0;s<n;s++)c[s]=C(e,l,s);var u,h,d,f,g,p,m,v=c[0],b=new Uint8ClampedArray(v.items.length*n),y={left:v.left,top:v.top,width:v.width,height:v.height,items:b},w=0;if(l.codingStyleDefaultParameters.multipleComponentTransform){var S=4===n,k=c[0].items,x=c[1].items,E=c[2].items,T=S?c[3].items:null;h=.5+(128<<(u=r[0].precision-8));var _=l.components[0],A=n-3;if(f=k.length,_.codingStyleParameters.reversibleTransformation)for(d=0;d<f;d++,w+=A){g=k[d]+h,p=x[d];const e=g-((m=E[d])+p>>2);b[w++]=e+m>>u,b[w++]=e>>u,b[w++]=e+p>>u}else for(d=0;d<f;d++,w+=A)g=k[d]+h,p=x[d],m=E[d],b[w++]=g+1.402*m>>u,b[w++]=g-.34413*p-.71414*m>>u,b[w++]=g+1.772*p>>u;if(S)for(d=0,w=3;d<f;d++,w+=4)b[w]=T[d]+h>>u}else for(s=0;s<n;s++){var R=c[s].items;for(h=.5+(128<<(u=r[s].precision-8)),w=s,d=0,f=R.length;d<f;d++)b[w]=R[d]+h>>u,w+=n}i.push(y)}return i}(l),this.width=l.SIZ.Xsiz-l.SIZ.XOsiz,this.height=l.SIZ.Ysiz-l.SIZ.YOsiz,this.componentsCount=l.SIZ.Csiz}};var x=function(){function e(e,t){var r=(0,i.log2)(Math.max(e,t))+1;this.levels=[];for(var n=0;n<r;n++){var o={width:e,height:t,items:[]};this.levels.push(o),e=Math.ceil(e/2),t=Math.ceil(t/2)}}return e.prototype={reset:function(e,t){for(var r,n=0,i=0;n<this.levels.length;){var o=e+t*(r=this.levels[n]).width;if(void 0!==r.items[o]){i=r.items[o];break}r.index=o,e>>=1,t>>=1,n++}n--,(r=this.levels[n]).items[r.index]=i,this.currentLevel=n,delete this.value},incrementValue:function(){var e=this.levels[this.currentLevel];e.items[e.index]++},nextLevel:function(){var e=this.currentLevel,t=this.levels[e],r=t.items[t.index];return--e<0?(this.value=r,!1):(this.currentLevel=e,(t=this.levels[e]).items[t.index]=r,!0)}},e}(),E=function(){function e(e,t,r){var n=(0,i.log2)(Math.max(e,t))+1;this.levels=[];for(var o=0;o<n;o++){for(var a=new Uint8Array(e*t),s=0,l=a.length;s<l;s++)a[s]=r;var c={width:e,height:t,items:a};this.levels.push(c),e=Math.ceil(e/2),t=Math.ceil(t/2)}}return e.prototype={reset:function(e,t,r){for(var n=0;n<this.levels.length;){var i=this.levels[n],o=e+t*i.width;i.index=o;var a=i.items[o];if(255===a)break;if(a>r)return this.currentLevel=n,this.propagateValues(),!1;e>>=1,t>>=1,n++}return this.currentLevel=n-1,!0},incrementValue:function(e){var t=this.levels[this.currentLevel];t.items[t.index]=e+1,this.propagateValues()},propagateValues:function(){for(var e=this.currentLevel,t=this.levels[e],r=t.items[t.index];--e>=0;)(t=this.levels[e]).items[t.index]=r},nextLevel:function(){var e=this.currentLevel,t=this.levels[e],r=t.items[t.index];return t.items[t.index]=255,!(--e<0)&&(this.currentLevel=e,(t=this.levels[e]).items[t.index]=r,!0)}},e}(),T=function(){var e=17,t=new Uint8Array([0,5,8,0,3,7,8,0,4,7,8,0,0,0,0,0,1,6,8,0,3,7,8,0,4,7,8,0,0,0,0,0,2,6,8,0,3,7,8,0,4,7,8,0,0,0,0,0,2,6,8,0,3,7,8,0,4,7,8,0,0,0,0,0,2,6,8,0,3,7,8,0,4,7,8]),r=new Uint8Array([0,3,4,0,5,7,7,0,8,8,8,0,0,0,0,0,1,3,4,0,6,7,7,0,8,8,8,0,0,0,0,0,2,3,4,0,6,7,7,0,8,8,8,0,0,0,0,0,2,3,4,0,6,7,7,0,8,8,8,0,0,0,0,0,2,3,4,0,6,7,7,0,8,8,8]),n=new Uint8Array([0,1,2,0,1,2,2,0,2,2,2,0,0,0,0,0,3,4,5,0,4,5,5,0,5,5,5,0,0,0,0,0,6,7,7,0,7,7,7,0,7,7,7,0,0,0,0,0,8,8,8,0,8,8,8,0,8,8,8,0,0,0,0,0,8,8,8,0,8,8,8,0,8,8,8]);function i(e,i,o,a,s){let l;this.width=e,this.height=i,l="HH"===o?n:"HL"===o?r:t,this.contextLabelTable=l;var c=e*i;let u;this.neighborsSignificance=new Uint8Array(c),this.coefficentsSign=new Uint8Array(c),u=s>14?new Uint32Array(c):s>6?new Uint16Array(c):new Uint8Array(c),this.coefficentsMagnitude=u,this.processingFlags=new Uint8Array(c);var h=new Uint8Array(c);if(0!==a)for(var d=0;d<c;d++)h[d]=a;this.bitsDecoded=h,this.reset()}return i.prototype={setDecoder:function(e){this.decoder=e},reset:function(){this.contexts=new Int8Array(19),this.contexts[0]=8,this.contexts[17]=92,this.contexts[18]=6},setNeighborsSignificance:function(e,t,r){var n,i=this.neighborsSignificance,o=this.width,a=this.height,s=t>0,l=t+1<o;e>0&&(n=r-o,s&&(i[n-1]+=16),l&&(i[n+1]+=16),i[n]+=4),e+1<a&&(n=r+o,s&&(i[n-1]+=16),l&&(i[n+1]+=16),i[n]+=4),s&&(i[r-1]+=1),l&&(i[r+1]+=1),i[r]|=128},runSignificancePropagationPass:function(){for(var e=this.decoder,t=this.width,r=this.height,n=this.coefficentsMagnitude,i=this.coefficentsSign,o=this.neighborsSignificance,a=this.processingFlags,s=this.contexts,l=this.contextLabelTable,c=this.bitsDecoded,u=0;u<r;u+=4)for(var h=0;h<t;h++)for(var d=u*t+h,f=0;f<4;f++,d+=t){var g=u+f;if(g>=r)break;if(a[d]&=-2,!n[d]&&o[d]){var p=l[o[d]];if(e.readBit(s,p)){var m=this.decodeSignBit(g,h,d);i[d]=m,n[d]=1,this.setNeighborsSignificance(g,h,d),a[d]|=2}c[d]++,a[d]|=1}}},decodeSignBit:function(e,t,r){var n,i,o,a,s,l,c=this.width,u=this.height,h=this.coefficentsMagnitude,d=this.coefficentsSign;a=t>0&&0!==h[r-1],t+1<c&&0!==h[r+1]?(o=d[r+1],n=a?1-o-(i=d[r-1]):1-o-o):n=a?1-(i=d[r-1])-i:0;var f=3*n;return a=e>0&&0!==h[r-c],e+1<u&&0!==h[r+c]?(o=d[r+c],n=a?1-o-(i=d[r-c])+f:1-o-o+f):n=a?1-(i=d[r-c])-i+f:f,n>=0?(s=9+n,l=this.decoder.readBit(this.contexts,s)):(s=9-n,l=1^this.decoder.readBit(this.contexts,s)),l},runMagnitudeRefinementPass:function(){for(var e,t=this.decoder,r=this.width,n=this.height,i=this.coefficentsMagnitude,o=this.neighborsSignificance,a=this.contexts,s=this.bitsDecoded,l=this.processingFlags,c=r*n,u=4*r,h=0;h<c;h=e){e=Math.min(c,h+u);for(var d=0;d<r;d++)for(var f=h+d;f<e;f+=r)if(i[f]&&0===(1&l[f])){var g=16;0!==(2&l[f])&&(l[f]^=2,g=0===(127&o[f])?15:14);var p=t.readBit(a,g);i[f]=i[f]<<1|p,s[f]++,l[f]|=1}}},runCleanupPass:function(){for(var t,r=this.decoder,n=this.width,i=this.height,o=this.neighborsSignificance,a=this.coefficentsMagnitude,s=this.coefficentsSign,l=this.contexts,c=this.contextLabelTable,u=this.bitsDecoded,h=this.processingFlags,d=n,f=2*n,g=3*n,p=0;p<i;p=t){t=Math.min(p+4,i);for(var m=p*n,v=p+3<i,b=0;b<n;b++){var y,w=m+b,S=0,C=w,k=p;if(v&&0===h[w]&&0===h[w+d]&&0===h[w+f]&&0===h[w+g]&&0===o[w]&&0===o[w+d]&&0===o[w+f]&&0===o[w+g]){if(!r.readBit(l,18)){u[w]++,u[w+d]++,u[w+f]++,u[w+g]++;continue}0!==(S=r.readBit(l,e)<<1|r.readBit(l,e))&&(k=p+S,C+=S*n),y=this.decodeSignBit(k,b,C),s[C]=y,a[C]=1,this.setNeighborsSignificance(k,b,C),h[C]|=2,C=w;for(var x=p;x<=k;x++,C+=n)u[C]++;S++}for(k=p+S;k<t;k++,C+=n)if(!a[C]&&0===(1&h[C])){var E=c[o[C]];1===r.readBit(l,E)&&(y=this.decodeSignBit(k,b,C),s[C]=y,a[C]=1,this.setNeighborsSignificance(k,b,C),h[C]|=2),u[C]++}}}},checkSegmentationSymbol:function(){var t=this.decoder,r=this.contexts;if(10!==(t.readBit(r,e)<<3|t.readBit(r,e)<<2|t.readBit(r,e)<<1|t.readBit(r,e)))throw new a("Invalid segmentation symbol")}},i}(),_=function(){function e(){}return e.prototype.calculate=function(e,t,r){for(var n=e[0],i=1,o=e.length;i<o;i++)n=this.iterate(n,e[i],t,r);return n},e.prototype.extend=function(e,t,r){var n=t-1,i=t+1,o=t+r-2,a=t+r;e[n--]=e[i++],e[a++]=e[o--],e[n--]=e[i++],e[a++]=e[o--],e[n--]=e[i++],e[a++]=e[o--],e[n]=e[i],e[a]=e[o]},e.prototype.iterate=function(e,t,r,n){var i,o,a,s,l,c,u=e.width,h=e.height,d=e.items,f=t.width,g=t.height,p=t.items;for(a=0,i=0;i<h;i++)for(s=2*i*f,o=0;o<u;o++,a++,s+=2)p[s]=d[a];d=e.items=null;var m=new Float32Array(f+8);if(1===f){if(0!==(1&r))for(c=0,a=0;c<g;c++,a+=f)p[a]*=.5}else for(c=0,a=0;c<g;c++,a+=f)m.set(p.subarray(a,a+f),4),this.extend(m,4,f),this.filter(m,4,f),p.set(m.subarray(4,4+f),a);var v=16,b=[];for(i=0;i<v;i++)b.push(new Float32Array(g+8));var y,w=0;if(e=4+g,1===g){if(0!==(1&n))for(l=0;l<f;l++)p[l]*=.5}else for(l=0;l<f;l++){if(0===w){for(v=Math.min(f-l,v),a=l,s=4;s<e;a+=f,s++)for(y=0;y<v;y++)b[y][s]=p[a+y];w=v}var S=b[--w];if(this.extend(S,4,g),this.filter(S,4,g),0===w)for(a=l-v+1,s=4;s<e;a+=f,s++)for(y=0;y<v;y++)p[a+y]=b[y][s]}return{width:f,height:g,items:p}},e}(),A=function(){function e(){_.call(this)}return e.prototype=Object.create(_.prototype),e.prototype.filter=function(e,t,r){var n,i,o,a,s=r>>1,l=-1.586134342059924,c=-.052980118572961,u=.882911075530934,h=.443506852043971,d=1.230174104914001,f=1/d;for(n=(t|=0)-3,i=s+4;i--;n+=2)e[n]*=f;for(o=h*e[(n=t-2)-1],i=s+3;i--&&(a=h*e[n+1],e[n]=d*e[n]-o-a,i--);n+=2)o=h*e[(n+=2)+1],e[n]=d*e[n]-o-a;for(o=u*e[(n=t-1)-1],i=s+2;i--&&(a=u*e[n+1],e[n]-=o+a,i--);n+=2)o=u*e[(n+=2)+1],e[n]-=o+a;for(o=c*e[(n=t)-1],i=s+1;i--&&(a=c*e[n+1],e[n]-=o+a,i--);n+=2)o=c*e[(n+=2)+1],e[n]-=o+a;if(0!==s)for(o=l*e[(n=t+1)-1],i=s;i--&&(a=l*e[n+1],e[n]-=o+a,i--);n+=2)o=l*e[(n+=2)+1],e[n]-=o+a},e}(),R=function(){function e(){_.call(this)}return e.prototype=Object.create(_.prototype),e.prototype.filter=function(e,t,r){var n,i,o=r>>1;for(n=t|=0,i=o+1;i--;n+=2)e[n]-=e[n-1]+e[n+1]+2>>2;for(n=t+1,i=o;i--;n+=2)e[n]+=e[n-1]+e[n+1]>>1},e}();return t}();t.JpxImage=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.calculateSHA512=t.calculateSHA384=t.calculateSHA256=t.calculateMD5=t.PDF20=t.PDF17=t.CipherTransformFactory=t.ARCFourCipher=t.AES256Cipher=t.AES128Cipher=void 0;var n=r(2),i=r(5),o=r(12),a=function(){function e(e){this.a=0,this.b=0;var t,r,n=new Uint8Array(256),i=0,o=e.length;for(t=0;t<256;++t)n[t]=t;for(t=0;t<256;++t)i=i+(r=n[t])+e[t%o]&255,n[t]=n[i],n[i]=r;this.s=n}return e.prototype={encryptBlock:function(e){var t,r,n,i=e.length,o=this.a,a=this.b,s=this.s,l=new Uint8Array(i);for(t=0;t<i;++t)n=s[a=a+(r=s[o=o+1&255])&255],s[o]=n,s[a]=r,l[t]=e[t]^s[r+n&255];return this.a=o,this.b=a,l}},e.prototype.decryptBlock=e.prototype.encryptBlock,e.prototype.encrypt=e.prototype.encryptBlock,e}();t.ARCFourCipher=a;var s=function(){var e=new Uint8Array([7,12,17,22,7,12,17,22,7,12,17,22,7,12,17,22,5,9,14,20,5,9,14,20,5,9,14,20,5,9,14,20,4,11,16,23,4,11,16,23,4,11,16,23,4,11,16,23,6,10,15,21,6,10,15,21,6,10,15,21,6,10,15,21]),t=new Int32Array([-680876936,-389564586,606105819,-1044525330,-176418897,1200080426,-1473231341,-45705983,1770035416,-1958414417,-42063,-1990404162,1804603682,-40341101,-1502002290,1236535329,-165796510,-1069501632,643717713,-373897302,-701558691,38016083,-660478335,-405537848,568446438,-1019803690,-187363961,1163531501,-1444681467,-51403784,1735328473,-1926607734,-378558,-2022574463,1839030562,-35309556,-1530992060,1272893353,-155497632,-1094730640,681279174,-358537222,-722521979,76029189,-640364487,-421815835,530742520,-995338651,-198630844,1126891415,-1416354905,-57434055,1700485571,-1894986606,-1051523,-2054922799,1873313359,-30611744,-1560198380,1309151649,-145523070,-1120210379,718787259,-343485551]);return function(r,n,i){var o,a,s,l=1732584193,c=-271733879,u=-1732584194,h=271733878,d=i+72&-64,f=new Uint8Array(d);for(o=0;o<i;++o)f[o]=r[n++];for(f[o++]=128,s=d-8;o<s;)f[o++]=0;f[o++]=i<<3&255,f[o++]=i>>5&255,f[o++]=i>>13&255,f[o++]=i>>21&255,f[o++]=i>>>29&255,f[o++]=0,f[o++]=0,f[o++]=0;var g=new Int32Array(16);for(o=0;o<d;){for(a=0;a<16;++a,o+=4)g[a]=f[o]|f[o+1]<<8|f[o+2]<<16|f[o+3]<<24;var p,m,v=l,b=c,y=u,w=h;for(a=0;a<64;++a){a<16?(p=b&y|~b&w,m=a):a<32?(p=w&b|~w&y,m=5*a+1&15):a<48?(p=b^y^w,m=3*a+5&15):(p=y^(b|~w),m=7*a&15);var S=w,C=v+p+t[a]+g[m]|0,k=e[a];w=y,y=b,b=b+(C<<k|C>>>32-k)|0,v=S}l=l+v|0,c=c+b|0,u=u+y|0,h=h+w|0}return new Uint8Array([255&l,l>>8&255,l>>16&255,l>>>24&255,255&c,c>>8&255,c>>16&255,c>>>24&255,255&u,u>>8&255,u>>16&255,u>>>24&255,255&h,h>>8&255,h>>16&255,h>>>24&255])}}();t.calculateMD5=s;var l=function(){function e(e,t){this.high=0|e,this.low=0|t}return e.prototype={and:function(e){this.high&=e.high,this.low&=e.low},xor:function(e){this.high^=e.high,this.low^=e.low},or:function(e){this.high|=e.high,this.low|=e.low},shiftRight:function(e){e>=32?(this.low=this.high>>>e-32|0,this.high=0):(this.low=this.low>>>e|this.high<<32-e,this.high=this.high>>>e|0)},shiftLeft:function(e){e>=32?(this.high=this.low<<e-32,this.low=0):(this.high=this.high<<e|this.low>>>32-e,this.low=this.low<<e)},rotateRight:function(e){var t,r;32&e?(r=this.low,t=this.high):(t=this.low,r=this.high),e&=31,this.low=t>>>e|r<<32-e,this.high=r>>>e|t<<32-e},not:function(){this.high=~this.high,this.low=~this.low},add:function(e){var t=(this.low>>>0)+(e.low>>>0),r=(this.high>>>0)+(e.high>>>0);t>4294967295&&(r+=1),this.low=0|t,this.high=0|r},copyTo:function(e,t){e[t]=this.high>>>24&255,e[t+1]=this.high>>16&255,e[t+2]=this.high>>8&255,e[t+3]=255&this.high,e[t+4]=this.low>>>24&255,e[t+5]=this.low>>16&255,e[t+6]=this.low>>8&255,e[t+7]=255&this.low},assign:function(e){this.high=e.high,this.low=e.low}},e}(),c=function(){function e(e,t){return e>>>t|e<<32-t}function t(e,t,r){return e&t^~e&r}function r(e,t,r){return e&t^e&r^t&r}function n(t){return e(t,2)^e(t,13)^e(t,22)}function i(t){return e(t,6)^e(t,11)^e(t,25)}function o(t){return e(t,7)^e(t,18)^t>>>3}var a=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];return function(s,l,c){var u,h,d,f=1779033703,g=3144134277,p=1013904242,m=2773480762,v=1359893119,b=2600822924,y=528734635,w=1541459225,S=64*Math.ceil((c+9)/64),C=new Uint8Array(S);for(u=0;u<c;++u)C[u]=s[l++];for(C[u++]=128,d=S-8;u<d;)C[u++]=0;C[u++]=0,C[u++]=0,C[u++]=0,C[u++]=c>>>29&255,C[u++]=c>>21&255,C[u++]=c>>13&255,C[u++]=c>>5&255,C[u++]=c<<3&255;var k,x=new Uint32Array(64);for(u=0;u<S;){for(h=0;h<16;++h)x[h]=C[u]<<24|C[u+1]<<16|C[u+2]<<8|C[u+3],u+=4;for(h=16;h<64;++h)x[h]=0|(e(k=x[h-2],17)^e(k,19)^k>>>10)+x[h-7]+o(x[h-15])+x[h-16];var E,T,_=f,A=g,R=p,O=m,M=v,I=b,P=y,N=w;for(h=0;h<64;++h)E=N+i(M)+t(M,I,P)+a[h]+x[h],T=n(_)+r(_,A,R),N=P,P=I,I=M,M=O+E|0,O=R,R=A,A=_,_=E+T|0;f=f+_|0,g=g+A|0,p=p+R|0,m=m+O|0,v=v+M|0,b=b+I|0,y=y+P|0,w=w+N|0}return new Uint8Array([f>>24&255,f>>16&255,f>>8&255,255&f,g>>24&255,g>>16&255,g>>8&255,255&g,p>>24&255,p>>16&255,p>>8&255,255&p,m>>24&255,m>>16&255,m>>8&255,255&m,v>>24&255,v>>16&255,v>>8&255,255&v,b>>24&255,b>>16&255,b>>8&255,255&b,y>>24&255,y>>16&255,y>>8&255,255&y,w>>24&255,w>>16&255,w>>8&255,255&w])}}();t.calculateSHA256=c;var u=function(){function e(e,t,r,n,i){e.assign(t),e.and(r),i.assign(t),i.not(),i.and(n),e.xor(i)}function t(e,t,r,n,i){e.assign(t),e.and(r),i.assign(t),i.and(n),e.xor(i),i.assign(r),i.and(n),e.xor(i)}function r(e,t,r){e.assign(t),e.rotateRight(28),r.assign(t),r.rotateRight(34),e.xor(r),r.assign(t),r.rotateRight(39),e.xor(r)}function n(e,t,r){e.assign(t),e.rotateRight(14),r.assign(t),r.rotateRight(18),e.xor(r),r.assign(t),r.rotateRight(41),e.xor(r)}function i(e,t,r){e.assign(t),e.rotateRight(1),r.assign(t),r.rotateRight(8),e.xor(r),r.assign(t),r.shiftRight(7),e.xor(r)}function o(e,t,r){e.assign(t),e.rotateRight(19),r.assign(t),r.rotateRight(61),e.xor(r),r.assign(t),r.shiftRight(6),e.xor(r)}var a=[new l(1116352408,3609767458),new l(1899447441,602891725),new l(3049323471,3964484399),new l(3921009573,2173295548),new l(961987163,4081628472),new l(1508970993,3053834265),new l(2453635748,2937671579),new l(2870763221,3664609560),new l(3624381080,2734883394),new l(310598401,1164996542),new l(607225278,1323610764),new l(1426881987,3590304994),new l(1925078388,4068182383),new l(2162078206,991336113),new l(2614888103,633803317),new l(3248222580,3479774868),new l(3835390401,2666613458),new l(4022224774,944711139),new l(264347078,2341262773),new l(604807628,2007800933),new l(770255983,1495990901),new l(1249150122,1856431235),new l(1555081692,3175218132),new l(1996064986,2198950837),new l(2554220882,3999719339),new l(2821834349,766784016),new l(2952996808,2566594879),new l(3210313671,3203337956),new l(3336571891,1034457026),new l(3584528711,2466948901),new l(113926993,3758326383),new l(338241895,168717936),new l(666307205,1188179964),new l(773529912,1546045734),new l(1294757372,1522805485),new l(1396182291,2643833823),new l(1695183700,2343527390),new l(1986661051,1014477480),new l(2177026350,1206759142),new l(2456956037,344077627),new l(2730485921,1290863460),new l(2820302411,3158454273),new l(3259730800,3505952657),new l(3345764771,106217008),new l(3516065817,3606008344),new l(3600352804,1432725776),new l(4094571909,1467031594),new l(275423344,851169720),new l(430227734,3100823752),new l(506948616,1363258195),new l(659060556,3750685593),new l(883997877,3785050280),new l(958139571,3318307427),new l(1322822218,3812723403),new l(1537002063,2003034995),new l(1747873779,3602036899),new l(1955562222,1575990012),new l(2024104815,1125592928),new l(2227730452,2716904306),new l(2361852424,442776044),new l(2428436474,593698344),new l(2756734187,3733110249),new l(3204031479,2999351573),new l(3329325298,3815920427),new l(3391569614,3928383900),new l(3515267271,566280711),new l(3940187606,3454069534),new l(4118630271,4000239992),new l(116418474,1914138554),new l(174292421,2731055270),new l(289380356,3203993006),new l(460393269,320620315),new l(685471733,587496836),new l(852142971,1086792851),new l(1017036298,365543100),new l(1126000580,2618297676),new l(1288033470,3409855158),new l(1501505948,4234509866),new l(1607167915,987167468),new l(1816402316,1246189591)];return function(s,c,u,h){var d,f,g,p,m,v,b,y;(h=!!h)?(d=new l(3418070365,3238371032),f=new l(1654270250,914150663),g=new l(2438529370,812702999),p=new l(355462360,4144912697),m=new l(1731405415,4290775857),v=new l(2394180231,1750603025),b=new l(3675008525,1694076839),y=new l(1203062813,3204075428)):(d=new l(1779033703,4089235720),f=new l(3144134277,2227873595),g=new l(1013904242,4271175723),p=new l(2773480762,1595750129),m=new l(1359893119,2917565137),v=new l(2600822924,725511199),b=new l(528734635,4215389547),y=new l(1541459225,327033209));var w,S,C,k=128*Math.ceil((u+17)/128),x=new Uint8Array(k);for(w=0;w<u;++w)x[w]=s[c++];for(x[w++]=128,C=k-16;w<C;)x[w++]=0;x[w++]=0,x[w++]=0,x[w++]=0,x[w++]=0,x[w++]=0,x[w++]=0,x[w++]=0,x[w++]=0,x[w++]=0,x[w++]=0,x[w++]=0,x[w++]=u>>>29&255,x[w++]=u>>21&255,x[w++]=u>>13&255,x[w++]=u>>5&255,x[w++]=u<<3&255;var E=new Array(80);for(w=0;w<80;w++)E[w]=new l(0,0);var T,_,A=new l(0,0),R=new l(0,0),O=new l(0,0),M=new l(0,0),I=new l(0,0),P=new l(0,0),N=new l(0,0),D=new l(0,0),F=new l(0,0),L=new l(0,0),H=new l(0,0),B=new l(0,0);for(w=0;w<k;){for(S=0;S<16;++S)E[S].high=x[w]<<24|x[w+1]<<16|x[w+2]<<8|x[w+3],E[S].low=x[w+4]<<24|x[w+5]<<16|x[w+6]<<8|x[w+7],w+=8;for(S=16;S<80;++S)o(T=E[S],E[S-2],B),T.add(E[S-7]),i(H,E[S-15],B),T.add(H),T.add(E[S-16]);for(A.assign(d),R.assign(f),O.assign(g),M.assign(p),I.assign(m),P.assign(v),N.assign(b),D.assign(y),S=0;S<80;++S)F.assign(D),n(H,I,B),F.add(H),e(H,I,P,N,B),F.add(H),F.add(a[S]),F.add(E[S]),r(L,A,B),t(H,A,R,O,B),L.add(H),T=D,D=N,N=P,P=I,M.add(F),I=M,M=O,O=R,R=A,T.assign(F),T.add(L),A=T;d.add(A),f.add(R),g.add(O),p.add(M),m.add(I),v.add(P),b.add(N),y.add(D)}return h?(_=new Uint8Array(48),d.copyTo(_,0),f.copyTo(_,8),g.copyTo(_,16),p.copyTo(_,24),m.copyTo(_,32),v.copyTo(_,40)):(_=new Uint8Array(64),d.copyTo(_,0),f.copyTo(_,8),g.copyTo(_,16),p.copyTo(_,24),m.copyTo(_,32),v.copyTo(_,40),b.copyTo(_,48),y.copyTo(_,56)),_}}();t.calculateSHA512=u;var h=function(e,t,r){return u(e,t,r,!0)};t.calculateSHA384=h;var d=function(){function e(){}return e.prototype={decryptBlock:function(e){return e},encrypt:function(e){return e}},e}();class f{constructor(){this.constructor===f&&(0,n.unreachable)("Cannot initialize AESBaseCipher."),this._s=new Uint8Array([99,124,119,123,242,107,111,197,48,1,103,43,254,215,171,118,202,130,201,125,250,89,71,240,173,212,162,175,156,164,114,192,183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21,4,199,35,195,24,150,5,154,7,18,128,226,235,39,178,117,9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132,83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207,208,239,170,251,67,77,51,133,69,249,2,127,80,60,159,168,81,163,64,143,146,157,56,245,188,182,218,33,16,255,243,210,205,12,19,236,95,151,68,23,196,167,126,61,100,93,25,115,96,129,79,220,34,42,144,136,70,238,184,20,222,94,11,219,224,50,58,10,73,6,36,92,194,211,172,98,145,149,228,121,231,200,55,109,141,213,78,169,108,86,244,234,101,122,174,8,186,120,37,46,28,166,180,198,232,221,116,31,75,189,139,138,112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,158,225,248,152,17,105,217,142,148,155,30,135,233,206,85,40,223,140,161,137,13,191,230,66,104,65,153,45,15,176,84,187,22]),this._inv_s=new Uint8Array([82,9,106,213,48,54,165,56,191,64,163,158,129,243,215,251,124,227,57,130,155,47,255,135,52,142,67,68,196,222,233,203,84,123,148,50,166,194,35,61,238,76,149,11,66,250,195,78,8,46,161,102,40,217,36,178,118,91,162,73,109,139,209,37,114,248,246,100,134,104,152,22,212,164,92,204,93,101,182,146,108,112,72,80,253,237,185,218,94,21,70,87,167,141,157,132,144,216,171,0,140,188,211,10,247,228,88,5,184,179,69,6,208,44,30,143,202,63,15,2,193,175,189,3,1,19,138,107,58,145,17,65,79,103,220,234,151,242,207,206,240,180,230,115,150,172,116,34,231,173,53,133,226,249,55,232,28,117,223,110,71,241,26,113,29,41,197,137,111,183,98,14,170,24,190,27,252,86,62,75,198,210,121,32,154,219,192,254,120,205,90,244,31,221,168,51,136,7,199,49,177,18,16,89,39,128,236,95,96,81,127,169,25,181,74,13,45,229,122,159,147,201,156,239,160,224,59,77,174,42,245,176,200,235,187,60,131,83,153,97,23,43,4,126,186,119,214,38,225,105,20,99,85,33,12,125]),this._mix=new Uint32Array([0,235474187,470948374,303765277,941896748,908933415,607530554,708780849,1883793496,2118214995,1817866830,1649639237,1215061108,1181045119,1417561698,1517767529,3767586992,4003061179,4236429990,4069246893,3635733660,3602770327,3299278474,3400528769,2430122216,2664543715,2362090238,2193862645,2835123396,2801107407,3035535058,3135740889,3678124923,3576870512,3341394285,3374361702,3810496343,3977675356,4279080257,4043610186,2876494627,2776292904,3076639029,3110650942,2472011535,2640243204,2403728665,2169303058,1001089995,899835584,666464733,699432150,59727847,226906860,530400753,294930682,1273168787,1172967064,1475418501,1509430414,1942435775,2110667444,1876241833,1641816226,2910219766,2743034109,2976151520,3211623147,2505202138,2606453969,2302690252,2269728455,3711829422,3543599269,3240894392,3475313331,3843699074,3943906441,4178062228,4144047775,1306967366,1139781709,1374988112,1610459739,1975683434,2076935265,1775276924,1742315127,1034867998,866637845,566021896,800440835,92987698,193195065,429456164,395441711,1984812685,2017778566,1784663195,1683407248,1315562145,1080094634,1383856311,1551037884,101039829,135050206,437757123,337553864,1042385657,807962610,573804783,742039012,2531067453,2564033334,2328828971,2227573024,2935566865,2700099354,3001755655,3168937228,3868552805,3902563182,4203181171,4102977912,3736164937,3501741890,3265478751,3433712980,1106041591,1340463100,1576976609,1408749034,2043211483,2009195472,1708848333,1809054150,832877231,1068351396,766945465,599762354,159417987,126454664,361929877,463180190,2709260871,2943682380,3178106961,3009879386,2572697195,2538681184,2236228733,2336434550,3509871135,3745345300,3441850377,3274667266,3910161971,3877198648,4110568485,4211818798,2597806476,2497604743,2261089178,2295101073,2733856160,2902087851,3202437046,2968011453,3936291284,3835036895,4136440770,4169408201,3535486456,3702665459,3467192302,3231722213,2051518780,1951317047,1716890410,1750902305,1113818384,1282050075,1584504582,1350078989,168810852,67556463,371049330,404016761,841739592,1008918595,775550814,540080725,3969562369,3801332234,4035489047,4269907996,3569255213,3669462566,3366754619,3332740144,2631065433,2463879762,2160117071,2395588676,2767645557,2868897406,3102011747,3069049960,202008497,33778362,270040487,504459436,875451293,975658646,675039627,641025152,2084704233,1917518562,1615861247,1851332852,1147550661,1248802510,1484005843,1451044056,933301370,967311729,733156972,632953703,260388950,25965917,328671808,496906059,1206477858,1239443753,1543208500,1441952575,2144161806,1908694277,1675577880,1842759443,3610369226,3644379585,3408119516,3307916247,4011190502,3776767469,4077384432,4245618683,2809771154,2842737049,3144396420,3043140495,2673705150,2438237621,2203032232,2370213795]),this._mixCol=new Uint8Array(256);for(let e=0;e<256;e++)this._mixCol[e]=e<128?e<<1:e<<1^27;this.buffer=new Uint8Array(16),this.bufferPosition=0}_expandKey(e){(0,n.unreachable)("Cannot call `_expandKey` on the base class")}_decrypt(e,t){let r,n,i;const o=new Uint8Array(16);o.set(e);for(let a=0,s=this._keySize;a<16;++a,++s)o[a]^=t[s];for(let a=this._cyclesOfRepetition-1;a>=1;--a){r=o[13],o[13]=o[9],o[9]=o[5],o[5]=o[1],o[1]=r,r=o[14],n=o[10],o[14]=o[6],o[10]=o[2],o[6]=r,o[2]=n,r=o[15],n=o[11],i=o[7],o[15]=o[3],o[11]=r,o[7]=n,o[3]=i;for(let e=0;e<16;++e)o[e]=this._inv_s[o[e]];for(let e=0,r=16*a;e<16;++e,++r)o[e]^=t[r];for(let e=0;e<16;e+=4){const t=this._mix[o[e]],n=this._mix[o[e+1]],i=this._mix[o[e+2]],a=this._mix[o[e+3]];r=t^n>>>8^n<<24^i>>>16^i<<16^a>>>24^a<<8,o[e]=r>>>24&255,o[e+1]=r>>16&255,o[e+2]=r>>8&255,o[e+3]=255&r}}r=o[13],o[13]=o[9],o[9]=o[5],o[5]=o[1],o[1]=r,r=o[14],n=o[10],o[14]=o[6],o[10]=o[2],o[6]=r,o[2]=n,r=o[15],n=o[11],i=o[7],o[15]=o[3],o[11]=r,o[7]=n,o[3]=i;for(let a=0;a<16;++a)o[a]=this._inv_s[o[a]],o[a]^=t[a];return o}_encrypt(e,t){const r=this._s;let n,i,o;const a=new Uint8Array(16);a.set(e);for(let s=0;s<16;++s)a[s]^=t[s];for(let s=1;s<this._cyclesOfRepetition;s++){for(let e=0;e<16;++e)a[e]=r[a[e]];o=a[1],a[1]=a[5],a[5]=a[9],a[9]=a[13],a[13]=o,o=a[2],i=a[6],a[2]=a[10],a[6]=a[14],a[10]=o,a[14]=i,o=a[3],i=a[7],n=a[11],a[3]=a[15],a[7]=o,a[11]=i,a[15]=n;for(let e=0;e<16;e+=4){const t=a[e+0],r=a[e+1],i=a[e+2],o=a[e+3];n=t^r^i^o,a[e+0]^=n^this._mixCol[t^r],a[e+1]^=n^this._mixCol[r^i],a[e+2]^=n^this._mixCol[i^o],a[e+3]^=n^this._mixCol[o^t]}for(let e=0,r=16*s;e<16;++e,++r)a[e]^=t[r]}for(let s=0;s<16;++s)a[s]=r[a[s]];o=a[1],a[1]=a[5],a[5]=a[9],a[9]=a[13],a[13]=o,o=a[2],i=a[6],a[2]=a[10],a[6]=a[14],a[10]=o,a[14]=i,o=a[3],i=a[7],n=a[11],a[3]=a[15],a[7]=o,a[11]=i,a[15]=n;for(let s=0,l=this._keySize;s<16;++s,++l)a[s]^=t[l];return a}_decryptBlock2(e,t){const r=e.length;let n=this.buffer,i=this.bufferPosition;const o=[];let a=this.iv;for(let c=0;c<r;++c){if(n[i]=e[c],++i,i<16)continue;const t=this._decrypt(n,this._key);for(let e=0;e<16;++e)t[e]^=a[e];a=n,o.push(t),n=new Uint8Array(16),i=0}if(this.buffer=n,this.bufferLength=i,this.iv=a,0===o.length)return new Uint8Array(0);let s=16*o.length;if(t){const e=o[o.length-1];let t=e[15];if(t<=16){for(let r=15,n=16-t;r>=n;--r)if(e[r]!==t){t=0;break}s-=t,o[o.length-1]=e.subarray(0,16-t)}}const l=new Uint8Array(s);for(let c=0,u=0,h=o.length;c<h;++c,u+=16)l.set(o[c],u);return l}decryptBlock(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const n=e.length,i=this.buffer;let o=this.bufferPosition;if(r)this.iv=r;else{for(let t=0;o<16&&t<n;++t,++o)i[o]=e[t];if(o<16)return this.bufferLength=o,new Uint8Array(0);this.iv=i,e=e.subarray(16)}return this.buffer=new Uint8Array(16),this.bufferLength=0,this.decryptBlock=this._decryptBlock2,this.decryptBlock(e,t)}encrypt(e,t){const r=e.length;let n=this.buffer,i=this.bufferPosition;const o=[];t||(t=new Uint8Array(16));for(let l=0;l<r;++l){if(n[i]=e[l],++i,i<16)continue;for(let e=0;e<16;++e)n[e]^=t[e];const r=this._encrypt(n,this._key);t=r,o.push(r),n=new Uint8Array(16),i=0}if(this.buffer=n,this.bufferLength=i,this.iv=t,0===o.length)return new Uint8Array(0);const a=16*o.length,s=new Uint8Array(a);for(let l=0,c=0,u=o.length;l<u;++l,c+=16)s.set(o[l],c);return s}}class g extends f{constructor(e){super(),this._cyclesOfRepetition=10,this._keySize=160,this._rcon=new Uint8Array([141,1,2,4,8,16,32,64,128,27,54,108,216,171,77,154,47,94,188,99,198,151,53,106,212,179,125,250,239,197,145,57,114,228,211,189,97,194,159,37,74,148,51,102,204,131,29,58,116,232,203,141,1,2,4,8,16,32,64,128,27,54,108,216,171,77,154,47,94,188,99,198,151,53,106,212,179,125,250,239,197,145,57,114,228,211,189,97,194,159,37,74,148,51,102,204,131,29,58,116,232,203,141,1,2,4,8,16,32,64,128,27,54,108,216,171,77,154,47,94,188,99,198,151,53,106,212,179,125,250,239,197,145,57,114,228,211,189,97,194,159,37,74,148,51,102,204,131,29,58,116,232,203,141,1,2,4,8,16,32,64,128,27,54,108,216,171,77,154,47,94,188,99,198,151,53,106,212,179,125,250,239,197,145,57,114,228,211,189,97,194,159,37,74,148,51,102,204,131,29,58,116,232,203,141,1,2,4,8,16,32,64,128,27,54,108,216,171,77,154,47,94,188,99,198,151,53,106,212,179,125,250,239,197,145,57,114,228,211,189,97,194,159,37,74,148,51,102,204,131,29,58,116,232,203,141]),this._key=this._expandKey(e)}_expandKey(e){const t=this._s,r=this._rcon,n=new Uint8Array(176);n.set(e);for(let i=16,o=1;i<176;++o){let e=n[i-3],a=n[i-2],s=n[i-1],l=n[i-4];e=t[e],a=t[a],s=t[s],l=t[l],e^=r[o];for(let t=0;t<4;++t)n[i]=e^=n[i-16],i++,n[i]=a^=n[i-16],i++,n[i]=s^=n[i-16],i++,n[i]=l^=n[i-16],i++}return n}}t.AES128Cipher=g;class p extends f{constructor(e){super(),this._cyclesOfRepetition=14,this._keySize=224,this._key=this._expandKey(e)}_expandKey(e){const t=this._s,r=new Uint8Array(240);r.set(e);let n,i,o,a,s=1;for(let l=32,c=1;l<240;++c){l%32===16?(n=t[n],i=t[i],o=t[o],a=t[a]):l%32===0&&(n=r[l-3],i=r[l-2],o=r[l-1],a=r[l-4],n=t[n],i=t[i],o=t[o],a=t[a],n^=s,(s<<=1)>=256&&(s=255&(27^s)));for(let e=0;e<4;++e)r[l]=n^=r[l-32],l++,r[l]=i^=r[l-32],l++,r[l]=o^=r[l-32],l++,r[l]=a^=r[l-32],l++}return r}}t.AES256Cipher=p;var m=function(){function e(e,t){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}function t(){}return t.prototype={checkOwnerPassword:function(t,r,n,i){var o=new Uint8Array(t.length+56);return o.set(t,0),o.set(r,t.length),o.set(n,t.length+r.length),e(c(o,0,o.length),i)},checkUserPassword:function(t,r,n){var i=new Uint8Array(t.length+8);return i.set(t,0),i.set(r,t.length),e(c(i,0,i.length),n)},getOwnerKey:function(e,t,r,n){var i=new Uint8Array(e.length+56);i.set(e,0),i.set(t,e.length),i.set(r,e.length+t.length);var o=c(i,0,i.length);return new p(o).decryptBlock(n,!1,new Uint8Array(16))},getUserKey:function(e,t,r){var n=new Uint8Array(e.length+8);n.set(e,0),n.set(t,e.length);var i=c(n,0,n.length);return new p(i).decryptBlock(r,!1,new Uint8Array(16))}},t}();t.PDF17=m;var v=function(){function e(e,t){var r=new Uint8Array(e.length+t.length);return r.set(e,0),r.set(t,e.length),r}function t(t,r,n){for(var i=c(r,0,r.length).subarray(0,32),o=[0],a=0;a<64||o[o.length-1]>a-32;){var s=t.length+i.length+n.length,l=new Uint8Array(64*s),d=e(t,i);d=e(d,n);for(var f=0,p=0;f<64;f++,p+=s)l.set(d,p);o=new g(i.subarray(0,16)).encrypt(l,i.subarray(16,32));for(var m=0,v=0;v<16;v++)m*=1,m%=3,m+=(o[v]>>>0)%3,m%=3;0===m?i=c(o,0,o.length):1===m?i=h(o,0,o.length):2===m&&(i=u(o,0,o.length)),a++}return i.subarray(0,32)}function r(){}function n(e,t){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}return r.prototype={hash:function(e,r,n){return t(e,r,n)},checkOwnerPassword:function(e,r,i,o){var a=new Uint8Array(e.length+56);return a.set(e,0),a.set(r,e.length),a.set(i,e.length+r.length),n(t(e,a,i),o)},checkUserPassword:function(e,r,i){var o=new Uint8Array(e.length+8);return o.set(e,0),o.set(r,e.length),n(t(e,o,[]),i)},getOwnerKey:function(e,r,n,i){var o=new Uint8Array(e.length+56);o.set(e,0),o.set(r,e.length),o.set(n,e.length+r.length);var a=t(e,o,n);return new p(a).decryptBlock(i,!1,new Uint8Array(16))},getUserKey:function(e,r,n){var i=new Uint8Array(e.length+8);i.set(e,0),i.set(r,e.length);var o=t(e,i,[]);return new p(o).decryptBlock(n,!1,new Uint8Array(16))}},r}();t.PDF20=v;var b=function(){function e(e,t){this.StringCipherConstructor=e,this.StreamCipherConstructor=t}return e.prototype={createStream:function(e,t){var r=new this.StreamCipherConstructor;return new o.DecryptStream(e,t,(function(e,t){return r.decryptBlock(e,t)}))},decryptString:function(e){var t=new this.StringCipherConstructor,r=(0,n.stringToBytes)(e);return r=t.decryptBlock(r,!0),(0,n.bytesToString)(r)},encryptString:function(e){const t=new this.StringCipherConstructor;if(t instanceof f){const r=e.length,i=16-r%16;16!==i&&(e=e.padEnd(16*Math.ceil(r/16),String.fromCharCode(i)));const o=new Uint8Array(16);if("undefined"!==typeof crypto)crypto.getRandomValues(o);else for(let e=0;e<16;e++)o[e]=Math.floor(256*Math.random());let a=(0,n.stringToBytes)(e);a=t.encrypt(a,o);const s=new Uint8Array(16+a.length);return s.set(o),s.set(a,16),(0,n.bytesToString)(s)}let r=(0,n.stringToBytes)(e);return r=t.encrypt(r),(0,n.bytesToString)(r)}},e}(),y=function(){var e=new Uint8Array([40,191,78,94,78,117,138,65,100,0,78,86,255,250,1,8,46,46,0,182,208,104,62,128,47,12,169,254,100,83,105,122]);function t(t,r,n,i,o,l,c,u){var h,d,f=40+n.length+t.length,g=new Uint8Array(f),p=0;if(r)for(d=Math.min(32,r.length);p<d;++p)g[p]=r[p];for(h=0;p<32;)g[p++]=e[h++];for(h=0,d=n.length;h<d;++h)g[p++]=n[h];for(g[p++]=255&o,g[p++]=o>>8&255,g[p++]=o>>16&255,g[p++]=o>>>24&255,h=0,d=t.length;h<d;++h)g[p++]=t[h];l>=4&&!u&&(g[p++]=255,g[p++]=255,g[p++]=255,g[p++]=255);var m=s(g,0,p),v=c>>3;if(l>=3)for(h=0;h<50;++h)m=s(m,0,v);var b,y=m.subarray(0,v);if(l>=3){for(p=0;p<32;++p)g[p]=e[p];for(h=0,d=t.length;h<d;++h)g[p++]=t[h];b=new a(y).encryptBlock(s(g,0,p)),d=y.length;var w,S=new Uint8Array(d);for(h=1;h<=19;++h){for(w=0;w<d;++w)S[w]=y[w]^h;b=new a(S).encryptBlock(b)}for(h=0,d=b.length;h<d;++h)if(i[h]!==b[h])return null}else for(h=0,d=(b=new a(y).encryptBlock(e)).length;h<d;++h)if(i[h]!==b[h])return null;return y}var r=i.Name.get("Identity");function o(o,l,c){var u=o.get("Filter");if(!(0,i.isName)(u,"Standard"))throw new n.FormatError("unknown encryption method");this.dict=o;var h=o.get("V");if(!Number.isInteger(h)||1!==h&&2!==h&&4!==h&&5!==h)throw new n.FormatError("unsupported encryption algorithm");this.algorithm=h;var d=o.get("Length");if(!d)if(h<=3)d=40;else{var f=o.get("CF"),g=o.get("StmF");if((0,i.isDict)(f)&&(0,i.isName)(g)){f.suppressEncryption=!0;var p=f.get(g.name);(d=p&&p.get("Length")||128)<40&&(d<<=3)}}if(!Number.isInteger(d)||d<40||d%8!==0)throw new n.FormatError("invalid key length");var b=(0,n.stringToBytes)(o.get("O")).subarray(0,32),y=(0,n.stringToBytes)(o.get("U")).subarray(0,32),w=o.get("P"),S=o.get("R"),C=(4===h||5===h)&&!1!==o.get("EncryptMetadata");this.encryptMetadata=C;var k,x,E=(0,n.stringToBytes)(l);if(c){if(6===S)try{c=(0,n.utf8StringToString)(c)}catch(D){(0,n.warn)("CipherTransformFactory: Unable to convert UTF8 encoded password.")}k=(0,n.stringToBytes)(c)}if(5!==h)x=t(E,k,b,y,w,S,d,C);else{var T=(0,n.stringToBytes)(o.get("O")).subarray(32,40),_=(0,n.stringToBytes)(o.get("O")).subarray(40,48),A=(0,n.stringToBytes)(o.get("U")).subarray(0,48),R=(0,n.stringToBytes)(o.get("U")).subarray(32,40),O=(0,n.stringToBytes)(o.get("U")).subarray(40,48),M=(0,n.stringToBytes)(o.get("OE")),I=(0,n.stringToBytes)(o.get("UE"));(0,n.stringToBytes)(o.get("Perms")),x=function(e,t,r,n,i,o,a,s,l,c,u){if(t){var h=Math.min(127,t.length);t=t.subarray(0,h)}else t=[];var d;return(d=6===e?new v:new m).checkUserPassword(t,s,a)?d.getUserKey(t,l,u):t.length&&d.checkOwnerPassword(t,n,o,r)?d.getOwnerKey(t,i,o,c):null}(S,k,b,T,_,A,y,R,O,M,I)}if(!x&&!c)throw new n.PasswordException("No password given",n.PasswordResponses.NEED_PASSWORD);if(!x&&c){var P=function(t,r,n,i){var o,l,c=new Uint8Array(32),u=0;for(l=Math.min(32,t.length);u<l;++u)c[u]=t[u];for(o=0;u<32;)c[u++]=e[o++];var h,d=s(c,0,u),f=i>>3;if(n>=3)for(o=0;o<50;++o)d=s(d,0,d.length);if(n>=3){h=r;var g,p=new Uint8Array(f);for(o=19;o>=0;o--){for(g=0;g<f;++g)p[g]=d[g]^o;h=new a(p).encryptBlock(h)}}else h=new a(d.subarray(0,f)).encryptBlock(r);return h}(k,b,S,d);x=t(E,P,b,y,w,S,d,C)}if(!x)throw new n.PasswordException("Incorrect Password",n.PasswordResponses.INCORRECT_PASSWORD);if(this.encryptionKey=x,h>=4){var N=o.get("CF");(0,i.isDict)(N)&&(N.suppressEncryption=!0),this.cf=N,this.stmf=o.get("StmF")||r,this.strf=o.get("StrF")||r,this.eff=o.get("EFF")||this.stmf}}function l(e,t,r,n){var i,o,a=new Uint8Array(r.length+9);for(i=0,o=r.length;i<o;++i)a[i]=r[i];return a[i++]=255&e,a[i++]=e>>8&255,a[i++]=e>>16&255,a[i++]=255&t,a[i++]=t>>8&255,n&&(a[i++]=115,a[i++]=65,a[i++]=108,a[i++]=84),s(a,0,i).subarray(0,Math.min(r.length+5,16))}function c(e,t,r,o,s){if(!(0,i.isName)(t))throw new n.FormatError("Invalid crypt filter name.");var c,u=e.get(t.name);if(null!==u&&void 0!==u&&(c=u.get("CFM")),!c||"None"===c.name)return function(){return new d};if("V2"===c.name)return function(){return new a(l(r,o,s,!1))};if("AESV2"===c.name)return function(){return new g(l(r,o,s,!0))};if("AESV3"===c.name)return function(){return new p(s)};throw new n.FormatError("Unknown crypto method")}return o.prototype={createCipherTransform:function(e,t){if(4===this.algorithm||5===this.algorithm)return new b(c(this.cf,this.stmf,e,t,this.encryptionKey),c(this.cf,this.strf,e,t,this.encryptionKey));var r=l(e,t,this.encryptionKey,!1),n=function(){return new a(r)};return new b(n,n)}},o}();t.CipherTransformFactory=y},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ColorSpace=void 0;var n=r(2),i=r(5),o=r(8);class a{constructor(e,t){this.constructor===a&&(0,n.unreachable)("Cannot initialize ColorSpace."),this.name=e,this.numComps=t}getRgb(e,t){const r=new Uint8ClampedArray(3);return this.getRgbItem(e,t,r,0),r}getRgbItem(e,t,r,i){(0,n.unreachable)("Should not call ColorSpace.getRgbItem")}getRgbBuffer(e,t,r,i,o,a,s){(0,n.unreachable)("Should not call ColorSpace.getRgbBuffer")}getOutputLength(e,t){(0,n.unreachable)("Should not call ColorSpace.getOutputLength")}isPassthrough(e){return!1}isDefaultDecode(e,t){return a.isDefaultDecode(e,this.numComps)}fillRgb(e,t,r,n,i,o,a,s,l){const c=t*r;let u=null;const h=1<<a,d=r!==i||t!==n;if(this.isPassthrough(a))u=s;else if(1===this.numComps&&c>h&&"DeviceGray"!==this.name&&"DeviceRGB"!==this.name){const t=a<=8?new Uint8Array(h):new Uint16Array(h);for(let e=0;e<h;e++)t[e]=e;const r=new Uint8ClampedArray(3*h);if(this.getRgbBuffer(t,0,h,r,0,a,0),d){u=new Uint8Array(3*c);let e=0;for(let t=0;t<c;++t){const n=3*s[t];u[e++]=r[n],u[e++]=r[n+1],u[e++]=r[n+2]}}else{let t=0;for(let n=0;n<c;++n){const i=3*s[n];e[t++]=r[i],e[t++]=r[i+1],e[t++]=r[i+2],t+=l}}}else d?(u=new Uint8ClampedArray(3*c),this.getRgbBuffer(s,0,c,u,0,a,0)):this.getRgbBuffer(s,0,n*o,e,0,a,l);if(u)if(d)!function(e,t,r,n,i,o,a){a=1!==a?0:a;const s=r/i,l=n/o;let c,u=0;const h=new Uint16Array(i),d=3*r;for(let f=0;f<i;f++)h[f]=3*Math.floor(f*s);for(let f=0;f<o;f++){const r=Math.floor(f*l)*d;for(let n=0;n<i;n++)c=r+h[n],t[u++]=e[c++],t[u++]=e[c++],t[u++]=e[c++],u+=a}}(u,e,t,r,n,i,l);else{let t=0,r=0;for(let i=0,a=n*o;i<a;i++)e[t++]=u[r++],e[t++]=u[r++],e[t++]=u[r++],t+=l}}get usesZeroToOneRange(){return(0,n.shadow)(this,"usesZeroToOneRange",!0)}static _cache(e,t,r,n){if(!r)throw new Error('ColorSpace._cache - expected "localColorSpaceCache" argument.');if(!n)throw new Error('ColorSpace._cache - expected "parsedColorSpace" argument.');let o,a;e instanceof i.Ref&&(a=e,e=t.fetch(e)),e instanceof i.Name&&(o=e.name),(o||a)&&r.set(o,a,n)}static getCached(e,t,r){if(!r)throw new Error('ColorSpace.getCached - expected "localColorSpaceCache" argument.');if(e instanceof i.Ref){const i=r.getByRef(e);if(i)return i;try{e=t.fetch(e)}catch(n){if(n instanceof o.MissingDataException)throw n}}if(e instanceof i.Name){const t=r.getByName(e.name);if(t)return t}return null}static async parseAsync(e){let{cs:t,xref:r,resources:n=null,pdfFunctionFactory:i,localColorSpaceCache:o}=e;const a=this._parse(t,r,n,i);return this._cache(t,r,o,a),a}static parse(e){let{cs:t,xref:r,resources:n=null,pdfFunctionFactory:i,localColorSpaceCache:o}=e;const a=this.getCached(t,r,o);if(a)return a;const s=this._parse(t,r,n,i);return this._cache(t,r,o,s),s}static _parse(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=arguments.length>3?arguments[3]:void 0;if(e=t.fetchIfRef(e),(0,i.isName)(e))switch(e.name){case"DeviceGray":case"G":return this.singletons.gray;case"DeviceRGB":case"RGB":return this.singletons.rgb;case"DeviceCMYK":case"CMYK":return this.singletons.cmyk;case"Pattern":return new l(null);default:if((0,i.isDict)(r)){const n=r.get("ColorSpace");if((0,i.isDict)(n)){const a=n.get(e.name);if(a){if((0,i.isName)(a))return this._parse(a,t,r,o);e=a;break}}}throw new n.FormatError(`Unrecognized ColorSpace: ${e.name}`)}if(Array.isArray(e)){const i=t.fetchIfRef(e[0]).name;let a,u,h,d,m,v;switch(i){case"DeviceGray":case"G":return this.singletons.gray;case"DeviceRGB":case"RGB":return this.singletons.rgb;case"DeviceCMYK":case"CMYK":return this.singletons.cmyk;case"CalGray":return a=t.fetchIfRef(e[1]),d=a.getArray("WhitePoint"),m=a.getArray("BlackPoint"),v=a.get("Gamma"),new f(d,m,v);case"CalRGB":a=t.fetchIfRef(e[1]),d=a.getArray("WhitePoint"),m=a.getArray("BlackPoint"),v=a.getArray("Gamma");const b=a.getArray("Matrix");return new g(d,m,v,b);case"ICCBased":const y=t.fetchIfRef(e[1]).dict;u=y.get("N");const w=y.get("Alternate");if(w){const e=this._parse(w,t,r,o);if(e.numComps===u)return e;(0,n.warn)("ICCBased color space: Ignoring incorrect /Alternate entry.")}if(1===u)return this.singletons.gray;if(3===u)return this.singletons.rgb;if(4===u)return this.singletons.cmyk;break;case"Pattern":return h=e[1]||null,h&&(h=this._parse(h,t,r,o)),new l(h);case"Indexed":case"I":h=this._parse(e[1],t,r,o);const S=t.fetchIfRef(e[2])+1,C=t.fetchIfRef(e[3]);return new c(h,S,C);case"Separation":case"DeviceN":const k=t.fetchIfRef(e[1]);u=Array.isArray(k)?k.length:1,h=this._parse(e[2],t,r,o);const x=o.create(e[3]);return new s(u,h,x);case"Lab":a=t.fetchIfRef(e[1]),d=a.getArray("WhitePoint"),m=a.getArray("BlackPoint");const E=a.getArray("Range");return new p(d,m,E);default:throw new n.FormatError(`Unimplemented ColorSpace object: ${i}`)}}throw new n.FormatError(`Unrecognized ColorSpace object: ${e}`)}static isDefaultDecode(e,t){if(!Array.isArray(e))return!0;if(2*t!==e.length)return(0,n.warn)("The decode map is not the correct length"),!0;for(let r=0,n=e.length;r<n;r+=2)if(0!==e[r]||1!==e[r+1])return!1;return!0}static get singletons(){return(0,n.shadow)(this,"singletons",{get gray(){return(0,n.shadow)(this,"gray",new u)},get rgb(){return(0,n.shadow)(this,"rgb",new h)},get cmyk(){return(0,n.shadow)(this,"cmyk",new d)}})}}t.ColorSpace=a;class s extends a{constructor(e,t,r){super("Alternate",e),this.base=t,this.tintFn=r,this.tmpBuf=new Float32Array(t.numComps)}getRgbItem(e,t,r,n){const i=this.tmpBuf;this.tintFn(e,t,i,0),this.base.getRgbItem(i,0,r,n)}getRgbBuffer(e,t,r,n,i,o,a){const s=this.tintFn,l=this.base,c=1/((1<<o)-1),u=l.numComps,h=l.usesZeroToOneRange,d=(l.isPassthrough(8)||!h)&&0===a;let f=d?i:0;const g=d?n:new Uint8ClampedArray(u*r),p=this.numComps,m=new Float32Array(p),v=new Float32Array(u);let b,y;for(b=0;b<r;b++){for(y=0;y<p;y++)m[y]=e[t++]*c;if(s(m,0,v,0),h)for(y=0;y<u;y++)g[f++]=255*v[y];else l.getRgbItem(v,0,g,f),f+=u}d||l.getRgbBuffer(g,0,r,n,i,8,a)}getOutputLength(e,t){return this.base.getOutputLength(e*this.base.numComps/this.numComps,t)}}class l extends a{constructor(e){super("Pattern",null),this.base=e}isDefaultDecode(e,t){(0,n.unreachable)("Should not call PatternCS.isDefaultDecode")}}class c extends a{constructor(e,t,r){super("Indexed",1),this.base=e,this.highVal=t;const o=e.numComps*t;if(this.lookup=new Uint8Array(o),(0,i.isStream)(r)){const e=r.getBytes(o);this.lookup.set(e)}else{if("string"!==typeof r)throw new n.FormatError(`IndexedCS - unrecognized lookup table: ${r}`);for(let e=0;e<o;++e)this.lookup[e]=255&r.charCodeAt(e)}}getRgbItem(e,t,r,n){const i=this.base.numComps,o=e[t]*i;this.base.getRgbBuffer(this.lookup,o,1,r,n,8,0)}getRgbBuffer(e,t,r,n,i,o,a){const s=this.base,l=s.numComps,c=s.getOutputLength(l,a),u=this.lookup;for(let h=0;h<r;++h){const r=e[t++]*l;s.getRgbBuffer(u,r,1,n,i,8,a),i+=c}}getOutputLength(e,t){return this.base.getOutputLength(e*this.base.numComps,t)}isDefaultDecode(e,t){return!Array.isArray(e)||(2!==e.length?((0,n.warn)("Decode map length is not correct"),!0):!Number.isInteger(t)||t<1?((0,n.warn)("Bits per component is not correct"),!0):0===e[0]&&e[1]===(1<<t)-1)}}class u extends a{constructor(){super("DeviceGray",1)}getRgbItem(e,t,r,n){const i=255*e[t];r[n]=r[n+1]=r[n+2]=i}getRgbBuffer(e,t,r,n,i,o,a){const s=255/((1<<o)-1);let l=t,c=i;for(let u=0;u<r;++u){const t=s*e[l++];n[c++]=t,n[c++]=t,n[c++]=t,c+=a}}getOutputLength(e,t){return e*(3+t)}}class h extends a{constructor(){super("DeviceRGB",3)}getRgbItem(e,t,r,n){r[n]=255*e[t],r[n+1]=255*e[t+1],r[n+2]=255*e[t+2]}getRgbBuffer(e,t,r,n,i,o,a){if(8===o&&0===a)return void n.set(e.subarray(t,t+3*r),i);const s=255/((1<<o)-1);let l=t,c=i;for(let u=0;u<r;++u)n[c++]=s*e[l++],n[c++]=s*e[l++],n[c++]=s*e[l++],c+=a}getOutputLength(e,t){return e*(3+t)/3|0}isPassthrough(e){return 8===e}}const d=function(){function e(e,t,r,n,i){const o=e[t]*r,a=e[t+1]*r,s=e[t+2]*r,l=e[t+3]*r;n[i]=255+o*(-4.387332384609988*o+54.48615194189176*a+18.82290502165302*s+212.25662451639585*l-285.2331026137004)+a*(1.7149763477362134*a-5.6096736904047315*s+-17.873870861415444*l-5.497006427196366)+s*(-2.5217340131683033*s-21.248923337353073*l+17.5119270841813)+l*(-21.86122147463605*l-189.48180835922747),n[i+1]=255+o*(8.841041422036149*o+60.118027045597366*a+6.871425592049007*s+31.159100130055922*l-79.2970844816548)+a*(-15.310361306967817*a+17.575251261109482*s+131.35250912493976*l-190.9453302588951)+s*(4.444339102852739*s+9.8632861493405*l-24.86741582555878)+l*(-20.737325471181034*l-187.80453709719578),n[i+2]=255+o*(.8842522430003296*o+8.078677503112928*a+30.89978309703729*s-.23883238689178934*l-14.183576799673286)+a*(10.49593273432072*a+63.02378494754052*s+50.606957656360734*l-112.23884253719248)+s*(.03296041114873217*s+115.60384449646641*l-193.58209356861505)+l*(-22.33816807309886*l-180.12613974708367)}return class extends a{constructor(){super("DeviceCMYK",4)}getRgbItem(t,r,n,i){e(t,r,1,n,i)}getRgbBuffer(t,r,n,i,o,a,s){const l=1/((1<<a)-1);for(let c=0;c<n;c++)e(t,r,l,i,o),r+=4,o+=3+s}getOutputLength(e,t){return e/4*(3+t)|0}}}(),f=function(){function e(e,t,r,n,i,o){const a=(t[r]*o)**e.G,s=e.YW*a,l=Math.max(295.8*s**.3333333333333333-40.8,0);n[i]=l,n[i+1]=l,n[i+2]=l}return class extends a{constructor(e,t,r){if(super("CalGray",1),!e)throw new n.FormatError("WhitePoint missing - required for color space CalGray");if(t=t||[0,0,0],r=r||1,this.XW=e[0],this.YW=e[1],this.ZW=e[2],this.XB=t[0],this.YB=t[1],this.ZB=t[2],this.G=r,this.XW<0||this.ZW<0||1!==this.YW)throw new n.FormatError(`Invalid WhitePoint components for ${this.name}, no fallback available`);(this.XB<0||this.YB<0||this.ZB<0)&&((0,n.info)(`Invalid BlackPoint for ${this.name}, falling back to default.`),this.XB=this.YB=this.ZB=0),0===this.XB&&0===this.YB&&0===this.ZB||(0,n.warn)(`${this.name}, BlackPoint: XB: ${this.XB}, YB: ${this.YB}, ZB: ${this.ZB}, only default values are supported.`),this.G<1&&((0,n.info)(`Invalid Gamma: ${this.G} for ${this.name}, falling back to default.`),this.G=1)}getRgbItem(t,r,n,i){e(this,t,r,n,i,1)}getRgbBuffer(t,r,n,i,o,a,s){const l=1/((1<<a)-1);for(let c=0;c<n;++c)e(this,t,r,i,o,l),r+=1,o+=3+s}getOutputLength(e,t){return e*(3+t)}}}(),g=function(){const e=new Float32Array([.8951,.2664,-.1614,-.7502,1.7135,.0367,.0389,-.0685,1.0296]),t=new Float32Array([.9869929,-.1470543,.1599627,.4323053,.5183603,.0492912,-.0085287,.0400428,.9684867]),r=new Float32Array([3.2404542,-1.5371385,-.4985314,-.969266,1.8760108,.041556,.0556434,-.2040259,1.0572252]),i=new Float32Array([1,1,1]),o=new Float32Array(3),s=new Float32Array(3),l=new Float32Array(3),c=(24/116)**3/8;function u(e,t,r){r[0]=e[0]*t[0]+e[1]*t[1]+e[2]*t[2],r[1]=e[3]*t[0]+e[4]*t[1]+e[5]*t[2],r[2]=e[6]*t[0]+e[7]*t[1]+e[8]*t[2]}function h(e){return e<=.0031308?d(0,1,12.92*e):e>=.99554525?1:d(0,1,1.055*e**(1/2.4)-.055)}function d(e,t,r){return Math.max(e,Math.min(t,r))}function f(e){return e<0?-f(-e):e>8?((e+16)/116)**3:e*c}function g(n,a,c,g,p,m){const v=d(0,1,a[c]*m),b=d(0,1,a[c+1]*m),y=d(0,1,a[c+2]*m),w=1===v?1:v**n.GR,S=1===b?1:b**n.GG,C=1===y?1:y**n.GB,k=n.MXA*w+n.MXB*S+n.MXC*C,x=n.MYA*w+n.MYB*S+n.MYC*C,E=n.MZA*w+n.MZB*S+n.MZC*C,T=s;T[0]=k,T[1]=x,T[2]=E;const _=l;!function(r,n,i){if(1===r[0]&&1===r[2])return i[0]=n[0],i[1]=n[1],void(i[2]=n[2]);const a=i;u(e,n,a);const s=o;!function(e,t,r){r[0]=1*t[0]/e[0],r[1]=1*t[1]/e[1],r[2]=1*t[2]/e[2]}(r,a,s),u(t,s,i)}(n.whitePoint,T,_);const A=s;!function(e,t,r){if(0===e[0]&&0===e[1]&&0===e[2])return r[0]=t[0],r[1]=t[1],void(r[2]=t[2]);const n=f(0),i=(1-n)/(1-f(e[0])),o=1-i,a=(1-n)/(1-f(e[1])),s=1-a,l=(1-n)/(1-f(e[2])),c=1-l;r[0]=t[0]*i+o,r[1]=t[1]*a+s,r[2]=t[2]*l+c}(n.blackPoint,_,A);const R=l;!function(r,n,i){const a=i;u(e,n,a);const s=o;!function(e,t,r){r[0]=.95047*t[0]/e[0],r[1]=1*t[1]/e[1],r[2]=1.08883*t[2]/e[2]}(r,a,s),u(t,s,i)}(i,A,R);const O=s;u(r,R,O),g[p]=255*h(O[0]),g[p+1]=255*h(O[1]),g[p+2]=255*h(O[2])}return class extends a{constructor(e,t,r,i){if(super("CalRGB",3),!e)throw new n.FormatError("WhitePoint missing - required for color space CalRGB");t=t||new Float32Array(3),r=r||new Float32Array([1,1,1]),i=i||new Float32Array([1,0,0,0,1,0,0,0,1]);const o=e[0],a=e[1],s=e[2];this.whitePoint=e;const l=t[0],c=t[1],u=t[2];if(this.blackPoint=t,this.GR=r[0],this.GG=r[1],this.GB=r[2],this.MXA=i[0],this.MYA=i[1],this.MZA=i[2],this.MXB=i[3],this.MYB=i[4],this.MZB=i[5],this.MXC=i[6],this.MYC=i[7],this.MZC=i[8],o<0||s<0||1!==a)throw new n.FormatError(`Invalid WhitePoint components for ${this.name}, no fallback available`);(l<0||c<0||u<0)&&((0,n.info)(`Invalid BlackPoint for ${this.name} [${l}, ${c}, ${u}], falling back to default.`),this.blackPoint=new Float32Array(3)),(this.GR<0||this.GG<0||this.GB<0)&&((0,n.info)(`Invalid Gamma [${this.GR}, ${this.GG}, ${this.GB}] for ${this.name}, falling back to default.`),this.GR=this.GG=this.GB=1)}getRgbItem(e,t,r,n){g(this,e,t,r,n,1)}getRgbBuffer(e,t,r,n,i,o,a){const s=1/((1<<o)-1);for(let l=0;l<r;++l)g(this,e,t,n,i,s),t+=3,i+=3+a}getOutputLength(e,t){return e*(3+t)/3|0}}}(),p=function(){function e(e){let t;return t=e>=6/29?e*e*e:108/841*(e-4/29),t}function t(e,t,r,n){return r+e*(n-r)/t}function r(r,n,i,o,a,s){let l=n[i],c=n[i+1],u=n[i+2];!1!==o&&(l=t(l,o,0,100),c=t(c,o,r.amin,r.amax),u=t(u,o,r.bmin,r.bmax)),c>r.amax?c=r.amax:c<r.amin&&(c=r.amin),u>r.bmax?u=r.bmax:u<r.bmin&&(u=r.bmin);const h=(l+16)/116,d=h+c/500,f=h-u/200,g=r.XW*e(d),p=r.YW*e(h),m=r.ZW*e(f);let v,b,y;r.ZW<1?(v=3.1339*g+-1.617*p+-.4906*m,b=-.9785*g+1.916*p+.0333*m,y=.072*g+-.229*p+1.4057*m):(v=3.2406*g+-1.5372*p+-.4986*m,b=-.9689*g+1.8758*p+.0415*m,y=.0557*g+-.204*p+1.057*m),a[s]=255*Math.sqrt(v),a[s+1]=255*Math.sqrt(b),a[s+2]=255*Math.sqrt(y)}return class extends a{constructor(e,t,r){if(super("Lab",3),!e)throw new n.FormatError("WhitePoint missing - required for color space Lab");if(t=t||[0,0,0],r=r||[-100,100,-100,100],this.XW=e[0],this.YW=e[1],this.ZW=e[2],this.amin=r[0],this.amax=r[1],this.bmin=r[2],this.bmax=r[3],this.XB=t[0],this.YB=t[1],this.ZB=t[2],this.XW<0||this.ZW<0||1!==this.YW)throw new n.FormatError("Invalid WhitePoint components, no fallback available");(this.XB<0||this.YB<0||this.ZB<0)&&((0,n.info)("Invalid BlackPoint, falling back to default"),this.XB=this.YB=this.ZB=0),(this.amin>this.amax||this.bmin>this.bmax)&&((0,n.info)("Invalid Range, falling back to defaults"),this.amin=-100,this.amax=100,this.bmin=-100,this.bmax=100)}getRgbItem(e,t,n,i){r(this,e,t,!1,n,i)}getRgbBuffer(e,t,n,i,o,a,s){const l=(1<<a)-1;for(let c=0;c<n;c++)r(this,e,t,l,i,o),t+=3,o+=3+s}getOutputLength(e,t){return e*(3+t)/3|0}isDefaultDecode(e,t){return!0}get usesZeroToOneRange(){return(0,n.shadow)(this,"usesZeroToOneRange",!1)}}}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GlobalImageCache=t.LocalGStateCache=t.LocalFunctionCache=t.LocalColorSpaceCache=t.LocalImageCache=void 0;var n=r(2),i=r(5);class o{constructor(e){this.constructor===o&&(0,n.unreachable)("Cannot initialize BaseLocalCache."),e&&e.onlyRefs||(this._nameRefMap=new Map,this._imageMap=new Map),this._imageCache=new i.RefSetCache}getByName(e){const t=this._nameRefMap.get(e);return t?this.getByRef(t):this._imageMap.get(e)||null}getByRef(e){return this._imageCache.get(e)||null}set(e,t,r){(0,n.unreachable)("Abstract method `set` called.")}}t.LocalImageCache=class extends o{set(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2?arguments[2]:void 0;if(!e)throw new Error('LocalImageCache.set - expected "name" argument.');if(t){if(this._imageCache.has(t))return;return this._nameRefMap.set(e,t),void this._imageCache.put(t,r)}this._imageMap.has(e)||this._imageMap.set(e,r)}},t.LocalColorSpaceCache=class extends o{set(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2?arguments[2]:void 0;if(!e&&!t)throw new Error('LocalColorSpaceCache.set - expected "name" and/or "ref" argument.');if(t){if(this._imageCache.has(t))return;return e&&this._nameRefMap.set(e,t),void this._imageCache.put(t,r)}this._imageMap.has(e)||this._imageMap.set(e,r)}},t.LocalFunctionCache=class extends o{constructor(e){super({onlyRefs:!0})}getByName(e){(0,n.unreachable)("Should not call `getByName` method.")}set(){let e=arguments.length>1?arguments[1]:void 0,t=arguments.length>2?arguments[2]:void 0;if(!e)throw new Error('LocalFunctionCache.set - expected "ref" argument.');this._imageCache.has(e)||this._imageCache.put(e,t)}},t.LocalGStateCache=class extends o{set(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2?arguments[2]:void 0;if(!e)throw new Error('LocalGStateCache.set - expected "name" argument.');if(t){if(this._imageCache.has(t))return;return this._nameRefMap.set(e,t),void this._imageCache.put(t,r)}this._imageMap.has(e)||this._imageMap.set(e,r)}};class a{static get NUM_PAGES_THRESHOLD(){return(0,n.shadow)(this,"NUM_PAGES_THRESHOLD",2)}static get MAX_IMAGES_TO_CACHE(){return(0,n.shadow)(this,"MAX_IMAGES_TO_CACHE",10)}constructor(){this._refCache=new i.RefSetCache,this._imageCache=new i.RefSetCache}shouldCache(e,t){const r=this._refCache.get(e);return!((r?r.size+(r.has(t)?0:1):1)<a.NUM_PAGES_THRESHOLD)&&!(!this._imageCache.has(e)&&this._imageCache.size>=a.MAX_IMAGES_TO_CACHE)}addPageIndex(e,t){let r=this._refCache.get(e);r||(r=new Set,this._refCache.put(e,r)),r.add(t)}getData(e,t){const r=this._refCache.get(e);return r?r.size<a.NUM_PAGES_THRESHOLD?null:this._imageCache.has(e)?(r.add(t),this._imageCache.get(e)):null:null}setData(e,t){if(!this._refCache.has(e))throw new Error('GlobalImageCache.setData - expected "addPageIndex" to have been called.');this._imageCache.has(e)||(this._imageCache.size>=a.MAX_IMAGES_TO_CACHE?(0,n.info)("GlobalImageCache.setData - ignoring image above MAX_IMAGES_TO_CACHE."):this._imageCache.put(e,t))}clear(){arguments.length>0&&void 0!==arguments[0]&&arguments[0]||this._refCache.clear(),this._imageCache.clear()}}t.GlobalImageCache=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getQuadPoints=h,t.MarkupAnnotation=t.AnnotationFactory=t.AnnotationBorderStyle=t.Annotation=void 0;var n=r(2),i=r(10),o=r(5),a=r(23),s=r(8),l=r(26),c=r(12),u=r(27);function h(e,t){if(!e.has("QuadPoints"))return null;const r=e.getArray("QuadPoints");if(!Array.isArray(r)||r.length%8>0)return null;const n=[];for(let i=0,o=r.length/8;i<o;i++){n.push([]);for(let e=8*i,o=8*i+8;e<o;e+=2){const o=r[e],a=r[e+1];if(null!==t&&(o<t[0]||o>t[2]||a<t[1]||a>t[3]))return null;n[i].push({x:o,y:a})}}return n}function d(e,t,r){const[i,o,a,s]=n.Util.getAxialAlignedBoundingBox(t,r);if(i===a||o===s)return[1,0,0,1,e[0],e[1]];const l=(e[2]-e[0])/(a-i),c=(e[3]-e[1])/(s-o);return[l,0,0,c,e[0]-i*l,e[1]-o*c]}t.AnnotationFactory=class{static create(e,t,r,n){return r.ensureCatalog("acroForm").then((i=>r.ensure(this,"_create",[e,t,r,n,i])))}static _create(e,t,r,i,a){const l=e.fetchIfRef(t);if(!(0,o.isDict)(l))return;const c=(0,o.isRef)(t)?t.toString():`annot_${i.createObjId()}`;let u=l.get("Subtype");u=(0,o.isName)(u)?u.name:null;const h={xref:e,ref:t,dict:l,subtype:u,id:c,pdfManager:r,acroForm:a instanceof o.Dict?a:o.Dict.empty};switch(u){case"Link":return new S(h);case"Text":return new w(h);case"Widget":let e=(0,s.getInheritableProperty)({dict:l,key:"FT"});switch(e=(0,o.isName)(e)?e.name:null,e){case"Tx":return new v(h);case"Btn":return new b(h);case"Ch":return new y(h)}return(0,n.warn)('Unimplemented widget field type "'+e+'", falling back to base field type.'),new m(h);case"Popup":return new C(h);case"FreeText":return new k(h);case"Line":return new x(h);case"Square":return new E(h);case"Circle":return new T(h);case"PolyLine":return new _(h);case"Polygon":return new A(h);case"Caret":return new R(h);case"Ink":return new O(h);case"Highlight":return new M(h);case"Underline":return new I(h);case"Squiggly":return new P(h);case"StrikeOut":return new N(h);case"Stamp":return new D(h);case"FileAttachment":return new F(h);default:return u?(0,n.warn)('Unimplemented annotation type "'+u+'", falling back to base annotation.'):(0,n.warn)("Annotation is missing the required /Subtype."),new f(h)}}};class f{constructor(e){const t=e.dict;this.setContents(t.get("Contents")),this.setModificationDate(t.get("M")),this.setFlags(t.get("F")),this.setRectangle(t.getArray("Rect")),this.setColor(t.getArray("C")),this.setBorderStyle(t),this.setAppearance(t),this.data={annotationFlags:this.flags,borderStyle:this.borderStyle,color:this.color,contents:this.contents,hasAppearance:!!this.appearance,id:e.id,modificationDate:this.modificationDate,rect:this.rectangle,subtype:e.subtype}}_hasFlag(e,t){return!!(e&t)}_isViewable(e){return!this._hasFlag(e,n.AnnotationFlag.INVISIBLE)&&!this._hasFlag(e,n.AnnotationFlag.HIDDEN)&&!this._hasFlag(e,n.AnnotationFlag.NOVIEW)}_isPrintable(e){return this._hasFlag(e,n.AnnotationFlag.PRINT)&&!this._hasFlag(e,n.AnnotationFlag.INVISIBLE)&&!this._hasFlag(e,n.AnnotationFlag.HIDDEN)}get viewable(){return 0===this.flags||this._isViewable(this.flags)}get printable(){return 0!==this.flags&&this._isPrintable(this.flags)}setContents(e){this.contents=(0,n.stringToPDFString)(e||"")}setModificationDate(e){this.modificationDate=(0,n.isString)(e)?e:null}setFlags(e){this.flags=Number.isInteger(e)&&e>0?e:0}hasFlag(e){return this._hasFlag(this.flags,e)}setRectangle(e){Array.isArray(e)&&4===e.length?this.rectangle=n.Util.normalizeRect(e):this.rectangle=[0,0,0,0]}setColor(e){const t=new Uint8ClampedArray(3);if(Array.isArray(e))switch(e.length){case 0:this.color=null;break;case 1:a.ColorSpace.singletons.gray.getRgbItem(e,0,t,0),this.color=t;break;case 3:a.ColorSpace.singletons.rgb.getRgbItem(e,0,t,0),this.color=t;break;case 4:a.ColorSpace.singletons.cmyk.getRgbItem(e,0,t,0),this.color=t;break;default:this.color=t}else this.color=t}setBorderStyle(e){if(this.borderStyle=new g,(0,o.isDict)(e))if(e.has("BS")){const t=e.get("BS"),r=t.get("Type");r&&!(0,o.isName)(r,"Border")||(this.borderStyle.setWidth(t.get("W"),this.rectangle),this.borderStyle.setStyle(t.get("S")),this.borderStyle.setDashArray(t.getArray("D")))}else if(e.has("Border")){const t=e.getArray("Border");Array.isArray(t)&&t.length>=3&&(this.borderStyle.setHorizontalCornerRadius(t[0]),this.borderStyle.setVerticalCornerRadius(t[1]),this.borderStyle.setWidth(t[2],this.rectangle),4===t.length&&this.borderStyle.setDashArray(t[3]))}else this.borderStyle.setWidth(0)}setAppearance(e){this.appearance=null;const t=e.get("AP");if(!(0,o.isDict)(t))return;const r=t.get("N");if((0,o.isStream)(r))return void(this.appearance=r);if(!(0,o.isDict)(r))return;const n=e.get("AS");(0,o.isName)(n)&&r.has(n.name)&&(this.appearance=r.get(n.name))}loadResources(e){return this.appearance.dict.getAsync("Resources").then((t=>{if(t)return new i.ObjectLoader(t,e,t.xref).load().then((function(){return t}))}))}getOperatorList(e,t,r,i){if(!this.appearance)return Promise.resolve(new l.OperatorList);const o=this.appearance,a=this.data,s=o.dict,c=this.loadResources(["ExtGState","ColorSpace","Pattern","Shading","XObject","Font"]),u=s.getArray("BBox")||[0,0,1,1],h=s.getArray("Matrix")||[1,0,0,1,0,0],f=d(a.rect,u,h);return c.then((r=>{const i=new l.OperatorList;return i.addOp(n.OPS.beginAnnotation,[a.rect,f,h]),e.getOperatorList({stream:o,task:t,resources:r,operatorList:i}).then((()=>(i.addOp(n.OPS.endAnnotation,[]),o.reset(),i)))}))}async save(e,t,r){return null}}t.Annotation=f;class g{constructor(){this.width=1,this.style=n.AnnotationBorderStyleType.SOLID,this.dashArray=[3],this.horizontalCornerRadius=0,this.verticalCornerRadius=0}setWidth(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0,0];if((0,o.isName)(e))this.width=0;else if(Number.isInteger(e)){if(e>0){const r=(t[2]-t[0])/2,i=(t[3]-t[1])/2;r>0&&i>0&&(e>r||e>i)&&((0,n.warn)(`AnnotationBorderStyle.setWidth - ignoring width: ${e}`),e=1)}this.width=e}}setStyle(e){if((0,o.isName)(e))switch(e.name){case"S":this.style=n.AnnotationBorderStyleType.SOLID;break;case"D":this.style=n.AnnotationBorderStyleType.DASHED;break;case"B":this.style=n.AnnotationBorderStyleType.BEVELED;break;case"I":this.style=n.AnnotationBorderStyleType.INSET;break;case"U":this.style=n.AnnotationBorderStyleType.UNDERLINE}}setDashArray(e){if(Array.isArray(e)&&e.length>0){let t=!0,r=!0;for(const n of e){if(!(+n>=0)){t=!1;break}n>0&&(r=!1)}t&&!r?this.dashArray=e:this.width=0}else e&&(this.width=0)}setHorizontalCornerRadius(e){Number.isInteger(e)&&(this.horizontalCornerRadius=e)}setVerticalCornerRadius(e){Number.isInteger(e)&&(this.verticalCornerRadius=e)}}t.AnnotationBorderStyle=g;class p extends f{constructor(e){super(e);const t=e.dict;if(t.has("IRT")){const e=t.getRaw("IRT");this.data.inReplyTo=(0,o.isRef)(e)?e.toString():null;const r=t.get("RT");this.data.replyType=(0,o.isName)(r)?r.name:n.AnnotationReplyType.REPLY}if(this.data.replyType===n.AnnotationReplyType.GROUP){const e=t.get("IRT");this.data.title=(0,n.stringToPDFString)(e.get("T")||""),this.setContents(e.get("Contents")),this.data.contents=this.contents,e.has("CreationDate")?(this.setCreationDate(e.get("CreationDate")),this.data.creationDate=this.creationDate):this.data.creationDate=null,e.has("M")?(this.setModificationDate(e.get("M")),this.data.modificationDate=this.modificationDate):this.data.modificationDate=null,this.data.hasPopup=e.has("Popup"),e.has("C")?(this.setColor(e.getArray("C")),this.data.color=this.color):this.data.color=null}else this.data.title=(0,n.stringToPDFString)(t.get("T")||""),this.setCreationDate(t.get("CreationDate")),this.data.creationDate=this.creationDate,this.data.hasPopup=t.has("Popup"),t.has("C")||(this.data.color=null)}setCreationDate(e){this.creationDate=(0,n.isString)(e)?e:null}_setDefaultAppearance(e){let{xref:t,extra:r,strokeColor:n,fillColor:i,blendMode:a,pointsCallback:s}=e,l=Number.MAX_VALUE,u=Number.MAX_VALUE,h=Number.MIN_VALUE,d=Number.MIN_VALUE;const f=["q"];r&&f.push(r),n&&f.push(`${n[0]} ${n[1]} ${n[2]} RG`),i&&f.push(`${i[0]} ${i[1]} ${i[2]} rg`);for(const o of this.data.quadPoints){const[e,t,r,n]=s(f,o);l=Math.min(l,e),h=Math.max(h,t),u=Math.min(u,r),d=Math.max(d,n)}f.push("Q");const g=new o.Dict(t),p=new o.Dict(t);p.set("Subtype",o.Name.get("Form"));const m=new c.StringStream(f.join(" "));m.dict=p,g.set("Fm0",m);const v=new o.Dict(t);a&&v.set("BM",o.Name.get(a));const b=new o.Dict(t);b.set("GS0",v);const y=new o.Dict(t);y.set("ExtGState",b),y.set("XObject",g);const w=new o.Dict(t);w.set("Resources",y);const S=this.data.rect=[l,u,h,d];w.set("BBox",S),this.appearance=new c.StringStream("/GS0 gs /Fm0 Do"),this.appearance.dict=w}}t.MarkupAnnotation=p;class m extends f{constructor(e){super(e);const t=e.dict,r=this.data;this.ref=e.ref,r.annotationType=n.AnnotationType.WIDGET,r.fieldName=this._constructFieldName(t);const i=(0,s.getInheritableProperty)({dict:t,key:"V",getArray:!0});r.fieldValue=this._decodeFormValue(i),r.alternativeText=(0,n.stringToPDFString)(t.get("TU")||""),r.defaultAppearance=(0,s.getInheritableProperty)({dict:t,key:"DA"})||e.acroForm.get("DA")||"";const a=(0,s.getInheritableProperty)({dict:t,key:"FT"});r.fieldType=(0,o.isName)(a)?a.name:null,this.fieldResources=(0,s.getInheritableProperty)({dict:t,key:"DR"})||e.acroForm.get("DR")||o.Dict.empty,r.fieldFlags=(0,s.getInheritableProperty)({dict:t,key:"Ff"}),(!Number.isInteger(r.fieldFlags)||r.fieldFlags<0)&&(r.fieldFlags=0),r.readOnly=this.hasFieldFlag(n.AnnotationFieldFlag.READONLY),"Sig"===r.fieldType&&(r.fieldValue=null,this.setFlags(n.AnnotationFlag.HIDDEN))}_constructFieldName(e){if(!e.has("T")&&!e.has("Parent"))return(0,n.warn)("Unknown field name, falling back to empty field name."),"";if(!e.has("Parent"))return(0,n.stringToPDFString)(e.get("T"));const t=[];e.has("T")&&t.unshift((0,n.stringToPDFString)(e.get("T")));let r=e;for(;r.has("Parent")&&(r=r.get("Parent"),(0,o.isDict)(r));)r.has("T")&&t.unshift((0,n.stringToPDFString)(r.get("T")));return t.join(".")}_decodeFormValue(e){return Array.isArray(e)?e.filter((e=>(0,n.isString)(e))).map((e=>(0,n.stringToPDFString)(e))):(0,o.isName)(e)?(0,n.stringToPDFString)(e.name):(0,n.isString)(e)?(0,n.stringToPDFString)(e):null}hasFieldFlag(e){return!!(this.data.fieldFlags&e)}getOperatorList(e,t,r,i){return r?Promise.resolve(new l.OperatorList):this._hasText?this._getAppearance(e,t,i).then((o=>{if(this.appearance&&null===o)return super.getOperatorList(e,t,r,i);const a=new l.OperatorList;if(!this.data.defaultAppearance||null===o)return a;const s=[1,0,0,1,0,0],u=[0,0,this.data.rect[2]-this.data.rect[0],this.data.rect[3]-this.data.rect[1]],h=d(this.data.rect,u,s);a.addOp(n.OPS.beginAnnotation,[this.data.rect,h,s]);const f=new c.StringStream(o);return e.getOperatorList({stream:f,task:t,resources:this.fieldResources,operatorList:a}).then((function(){return a.addOp(n.OPS.endAnnotation,[]),a}))})):super.getOperatorList(e,t,r,i)}async save(e,t,r){if(this.data.fieldValue===r[this.data.id])return null;let i=await this._getAppearance(e,t,r);if(null===i)return null;const a=e.xref.fetchIfRef(this.ref);if(!(0,o.isDict)(a))return null;const s=r[this.data.id],l=[0,0,this.data.rect[2]-this.data.rect[0],this.data.rect[3]-this.data.rect[1]],c={path:(0,n.stringToPDFString)(a.get("T")||""),value:s},h=e.xref.getNewRef(),d=new o.Dict(e.xref);d.set("N",h);const f=e.xref.encrypt;let g=null,p=null;f&&(g=f.createCipherTransform(this.ref.num,this.ref.gen),p=f.createCipherTransform(h.num,h.gen),i=p.encryptString(i)),a.set("V",s),a.set("AP",d),a.set("M",`D:${(0,n.getModificationDate)()}`);const m=new o.Dict(e.xref);m.set("Length",i.length),m.set("Subtype",o.Name.get("Form")),m.set("Resources",this.fieldResources),m.set("BBox",l);const v=[`${this.ref.num} ${this.ref.gen} obj\n`];(0,u.writeDict)(a,v,g),v.push("\nendobj\n");const b=[`${h.num} ${h.gen} obj\n`];return(0,u.writeDict)(m,b,p),b.push(" stream\n"),b.push(i),b.push("\nendstream\nendobj\n"),[{ref:this.ref,data:v.join(""),xfa:c},{ref:h,data:b.join(""),xfa:null}]}async _getAppearance(e,t,r){const i=this.hasFieldFlag(n.AnnotationFieldFlag.PASSWORD);if(!r||i)return null;const o=r[this.data.id];if(""===o)return"";const a=this.data.rect[3]-this.data.rect[1],s=this.data.rect[2]-this.data.rect[0],l=await this._getFontData(e,t),[c,u]=l;let h=l[2];h=this._computeFontSize(c,u,h,a);let d=c.descent;isNaN(d)&&(d=0);const f=2+Math.abs(d)*h,g=this.data.defaultAppearance,p=this.data.textAlignment;return this.data.comb?this._getCombAppearance(g,o,s,2,f):this.data.multiLine?this._getMultilineAppearance(g,o,c,h,s,a,p,2,f):0===p||p>2?"/Tx BMC q BT "+g+` 1 0 0 1 2 ${f} Tm (${(0,n.escapeString)(o)}) Tj ET Q EMC`:"/Tx BMC q BT "+g+` 1 0 0 1 0 0 Tm ${this._renderText(o,c,h,s,p,2,f)} ET Q EMC`}async _getFontData(e,t){const r=new l.OperatorList,n={fontSize:0,font:null,fontName:null,clone(){return this}};return await e.getOperatorList({stream:new c.StringStream(this.data.defaultAppearance),task:t,resources:this.fieldResources,operatorList:r,initialState:n}),[n.font,n.fontName,n.fontSize]}_computeFontSize(e,t,r,n){if(null===r||0===r){const i=e.charsToGlyphs("M",!0)[0].width/1e3*.7;r=Math.max(1,Math.floor(n/(1.5*i)));let o=new RegExp(`/${t}\\s+[0-9.]+\\s+Tf`);-1===this.data.defaultAppearance.search(o)&&(o=new RegExp(`/${t}\\s+Tf`)),this.data.defaultAppearance=this.data.defaultAppearance.replace(o,`/${t} ${r} Tf`)}return r}_renderText(e,t,r,i,o,a,s){const l=t.charsToGlyphs(e),c=r/1e3;let u,h=0;for(const n of l)h+=n.width*c;return u=1===o?(i-h)/2:2===o?i-h-a:a,u=u.toFixed(2),`${u} ${s=s.toFixed(2)} Td (${(0,n.escapeString)(e)}) Tj`}}class v extends m{constructor(e){super(e),this._hasText=!0;const t=e.dict;(0,n.isString)(this.data.fieldValue)||(this.data.fieldValue="");let r=(0,s.getInheritableProperty)({dict:t,key:"Q"});(!Number.isInteger(r)||r<0||r>2)&&(r=null),this.data.textAlignment=r;let i=(0,s.getInheritableProperty)({dict:t,key:"MaxLen"});(!Number.isInteger(i)||i<0)&&(i=null),this.data.maxLen=i,this.data.multiLine=this.hasFieldFlag(n.AnnotationFieldFlag.MULTILINE),this.data.comb=this.hasFieldFlag(n.AnnotationFieldFlag.COMB)&&!this.hasFieldFlag(n.AnnotationFieldFlag.MULTILINE)&&!this.hasFieldFlag(n.AnnotationFieldFlag.PASSWORD)&&!this.hasFieldFlag(n.AnnotationFieldFlag.FILESELECT)&&null!==this.data.maxLen}_getCombAppearance(e,t,r,i,o){const a=(r/this.data.maxLen).toFixed(2),s=[];for(const l of t)s.push(`(${(0,n.escapeString)(l)}) Tj`);return"/Tx BMC q BT "+e+` 1 0 0 1 ${i} ${o} Tm ${s.join(` ${a} 0 Td `)} ET Q EMC`}_getMultilineAppearance(e,t,r,n,i,o,a,s,l){const c=t.split(/\r\n|\r|\n/),u=[],h=i-2*s;for(const d of c){const e=this._splitLine(d,r,n,h);for(const t of e){const e=0===u.length?s:0;u.push(this._renderText(t,r,n,i,a,e,-n))}}return"/Tx BMC q BT "+e+` 1 0 0 1 0 ${o} Tm ${u.join("\n")} ET Q EMC`}_splitLine(e,t,r,n){if(e.length<=1)return[e];const i=r/1e3,o=t.charsToGlyphs(" ",!0)[0].width*i,a=[];let s=-1,l=0,c=0;for(let u=0,h=e.length;u<h;u++){const r=e.charAt(u);if(" "===r)c+o>n?(a.push(e.substring(l,u)),l=u,c=o,s=-1):(c+=o,s=u);else{const o=t.charsToGlyphs(r,!1)[0].width*i;c+o>n?-1!==s?(a.push(e.substring(l,s+1)),l=u=s+1,s=-1,c=0):(a.push(e.substring(l,u)),l=u,c=o):c+=o}}return l<e.length&&a.push(e.substring(l,e.length)),a}}class b extends m{constructor(e){super(e),this.checkedAppearance=null,this.uncheckedAppearance=null,this.data.checkBox=!this.hasFieldFlag(n.AnnotationFieldFlag.RADIO)&&!this.hasFieldFlag(n.AnnotationFieldFlag.PUSHBUTTON),this.data.radioButton=this.hasFieldFlag(n.AnnotationFieldFlag.RADIO)&&!this.hasFieldFlag(n.AnnotationFieldFlag.PUSHBUTTON),this.data.pushButton=this.hasFieldFlag(n.AnnotationFieldFlag.PUSHBUTTON),this.data.checkBox?this._processCheckBox(e):this.data.radioButton?this._processRadioButton(e):this.data.pushButton?this._processPushButton(e):(0,n.warn)("Invalid field flags for button widget annotation")}getOperatorList(e,t,r,n){if(this.data.pushButton)return super.getOperatorList(e,t,!1,n);if(n){let i;if(i=n[this.data.id]?this.checkedAppearance:this.uncheckedAppearance,i){const o=this.appearance;this.appearance=i;const a=super.getOperatorList(e,t,r,n);return this.appearance=o,a}return Promise.resolve(new l.OperatorList)}return super.getOperatorList(e,t,r,n)}async save(e,t,r){return this.data.checkBox?this._saveCheckbox(e,t,r):this.data.radioButton?this._saveRadioButton(e,t,r):null}async _saveCheckbox(e,t,r){const i=this.data.fieldValue&&"Off"!==this.data.fieldValue,a=r[this.data.id];if(i===a)return null;const s=e.xref.fetchIfRef(this.ref);if(!(0,o.isDict)(s))return null;const l={path:(0,n.stringToPDFString)(s.get("T")||""),value:a?this.data.exportValue:""},c=o.Name.get(a?this.data.exportValue:"Off");s.set("V",c),s.set("AS",c),s.set("M",`D:${(0,n.getModificationDate)()}`);const h=e.xref.encrypt;let d=null;h&&(d=h.createCipherTransform(this.ref.num,this.ref.gen));const f=[`${this.ref.num} ${this.ref.gen} obj\n`];return(0,u.writeDict)(s,f,d),f.push("\nendobj\n"),[{ref:this.ref,data:f.join(""),xfa:l}]}async _saveRadioButton(e,t,r){const i=this.data.fieldValue===this.data.buttonValue,a=r[this.data.id];if(i===a)return null;const s=e.xref.fetchIfRef(this.ref);if(!(0,o.isDict)(s))return null;const l={path:(0,n.stringToPDFString)(s.get("T")||""),value:a?this.data.buttonValue:""},c=o.Name.get(a?this.data.buttonValue:"Off");let h=null;const d=e.xref.encrypt;if(a)if((0,o.isRef)(this.parent)){const t=e.xref.fetch(this.parent);let r=null;d&&(r=d.createCipherTransform(this.parent.num,this.parent.gen)),t.set("V",c),h=[`${this.parent.num} ${this.parent.gen} obj\n`],(0,u.writeDict)(t,h,r),h.push("\nendobj\n")}else(0,o.isDict)(this.parent)&&this.parent.set("V",c);s.set("AS",c),s.set("M",`D:${(0,n.getModificationDate)()}`);let f=null;d&&(f=d.createCipherTransform(this.ref.num,this.ref.gen));const g=[`${this.ref.num} ${this.ref.gen} obj\n`];(0,u.writeDict)(s,g,f),g.push("\nendobj\n");const p=[{ref:this.ref,data:g.join(""),xfa:l}];return null!==h&&p.push({ref:this.parent,data:h.join(""),xfa:null}),p}_processCheckBox(e){const t=e.dict.get("AP");if(!(0,o.isDict)(t))return;const r=t.get("N");if(!(0,o.isDict)(r))return;const n=r.getKeys();n.includes("Off")||n.push("Off"),2===n.length&&(this.data.exportValue="Off"===n[0]?n[1]:n[0],this.checkedAppearance=r.get(this.data.exportValue),this.uncheckedAppearance=r.get("Off")||null)}_processRadioButton(e){this.data.fieldValue=this.data.buttonValue=null;const t=e.dict.get("Parent");if((0,o.isDict)(t)&&t.has("V")){const r=t.get("V");(0,o.isName)(r)&&(this.parent=e.dict.getRaw("Parent"),this.data.fieldValue=this._decodeFormValue(r))}const r=e.dict.get("AP");if(!(0,o.isDict)(r))return;const n=r.get("N");if((0,o.isDict)(n)){for(const e of n.getKeys())if("Off"!==e){this.data.buttonValue=e;break}this.checkedAppearance=n.get(this.data.buttonValue),this.uncheckedAppearance=n.get("Off")||null}}_processPushButton(e){e.dict.has("A")?i.Catalog.parseDestDictionary({destDict:e.dict,resultObj:this.data,docBaseUrl:e.pdfManager.docBaseUrl}):(0,n.warn)("Push buttons without action dictionaries are not supported")}}class y extends m{constructor(e){super(e),this.data.options=[];const t=(0,s.getInheritableProperty)({dict:e.dict,key:"Opt"});if(Array.isArray(t)){const r=e.xref;for(let e=0,n=t.length;e<n;e++){const n=r.fetchIfRef(t[e]),i=Array.isArray(n);this.data.options[e]={exportValue:this._decodeFormValue(i?r.fetchIfRef(n[0]):n),displayValue:this._decodeFormValue(i?r.fetchIfRef(n[1]):n)}}}(0,n.isString)(this.data.fieldValue)?this.data.fieldValue=[this.data.fieldValue]:this.data.fieldValue||(this.data.fieldValue=[]),this.data.combo=this.hasFieldFlag(n.AnnotationFieldFlag.COMBO),this.data.multiSelect=this.hasFieldFlag(n.AnnotationFieldFlag.MULTISELECT),this._hasText=!0}}class w extends p{constructor(e){super(e);const t=e.dict;this.data.annotationType=n.AnnotationType.TEXT,this.data.hasAppearance?this.data.name="NoIcon":(this.data.rect[1]=this.data.rect[3]-22,this.data.rect[2]=this.data.rect[0]+22,this.data.name=t.has("Name")?t.get("Name").name:"Note"),t.has("State")?(this.data.state=t.get("State")||null,this.data.stateModel=t.get("StateModel")||null):(this.data.state=null,this.data.stateModel=null)}}class S extends f{constructor(e){super(e),this.data.annotationType=n.AnnotationType.LINK;const t=h(e.dict,this.rectangle);t&&(this.data.quadPoints=t),i.Catalog.parseDestDictionary({destDict:e.dict,resultObj:this.data,docBaseUrl:e.pdfManager.docBaseUrl})}}class C extends f{constructor(e){super(e),this.data.annotationType=n.AnnotationType.POPUP;let t=e.dict.get("Parent");if(!t)return void(0,n.warn)("Popup annotation has a missing or invalid parent annotation.");const r=t.get("Subtype");this.data.parentType=(0,o.isName)(r)?r.name:null;const i=e.dict.getRaw("Parent");this.data.parentId=(0,o.isRef)(i)?i.toString():null;const a=t.get("RT");if((0,o.isName)(a,n.AnnotationReplyType.GROUP)&&(t=t.get("IRT")),t.has("M")?(this.setModificationDate(t.get("M")),this.data.modificationDate=this.modificationDate):this.data.modificationDate=null,t.has("C")?(this.setColor(t.getArray("C")),this.data.color=this.color):this.data.color=null,!this.viewable){const e=t.get("F");this._isViewable(e)&&this.setFlags(e)}this.data.title=(0,n.stringToPDFString)(t.get("T")||""),this.data.contents=(0,n.stringToPDFString)(t.get("Contents")||"")}}class k extends p{constructor(e){super(e),this.data.annotationType=n.AnnotationType.FREETEXT}}class x extends p{constructor(e){super(e),this.data.annotationType=n.AnnotationType.LINE,this.data.lineCoordinates=n.Util.normalizeRect(e.dict.getArray("L"))}}class E extends p{constructor(e){super(e),this.data.annotationType=n.AnnotationType.SQUARE}}class T extends p{constructor(e){super(e),this.data.annotationType=n.AnnotationType.CIRCLE}}class _ extends p{constructor(e){super(e),this.data.annotationType=n.AnnotationType.POLYLINE;const t=e.dict.getArray("Vertices");this.data.vertices=[];for(let r=0,n=t.length;r<n;r+=2)this.data.vertices.push({x:t[r],y:t[r+1]})}}class A extends _{constructor(e){super(e),this.data.annotationType=n.AnnotationType.POLYGON}}class R extends p{constructor(e){super(e),this.data.annotationType=n.AnnotationType.CARET}}class O extends p{constructor(e){super(e),this.data.annotationType=n.AnnotationType.INK;const t=e.xref,r=e.dict.getArray("InkList");this.data.inkLists=[];for(let n=0,i=r.length;n<i;++n){this.data.inkLists.push([]);for(let e=0,i=r[n].length;e<i;e+=2)this.data.inkLists[n].push({x:t.fetchIfRef(r[n][e]),y:t.fetchIfRef(r[n][e+1])})}}}class M extends p{constructor(e){super(e),this.data.annotationType=n.AnnotationType.HIGHLIGHT;const t=h(e.dict,null);if(t&&(this.data.quadPoints=t,!this.appearance)){const t=this.color?Array.from(this.color).map((e=>e/255)):[1,1,0];this._setDefaultAppearance({xref:e.xref,fillColor:t,blendMode:"Multiply",pointsCallback:(e,t)=>(e.push(`${t[0].x} ${t[0].y} m`),e.push(`${t[1].x} ${t[1].y} l`),e.push(`${t[3].x} ${t[3].y} l`),e.push(`${t[2].x} ${t[2].y} l`),e.push("f"),[t[0].x,t[1].x,t[3].y,t[1].y])})}}}class I extends p{constructor(e){super(e),this.data.annotationType=n.AnnotationType.UNDERLINE;const t=h(e.dict,null);if(t&&(this.data.quadPoints=t,!this.appearance)){const t=this.color?Array.from(this.color).map((e=>e/255)):[0,0,0];this._setDefaultAppearance({xref:e.xref,extra:"[] 0 d 1 w",strokeColor:t,pointsCallback:(e,t)=>(e.push(`${t[2].x} ${t[2].y} m`),e.push(`${t[3].x} ${t[3].y} l`),e.push("S"),[t[0].x,t[1].x,t[3].y,t[1].y])})}}}class P extends p{constructor(e){super(e),this.data.annotationType=n.AnnotationType.SQUIGGLY;const t=h(e.dict,null);if(t&&(this.data.quadPoints=t,!this.appearance)){const t=this.color?Array.from(this.color).map((e=>e/255)):[0,0,0];this._setDefaultAppearance({xref:e.xref,extra:"[] 0 d 1 w",strokeColor:t,pointsCallback:(e,t)=>{const r=(t[0].y-t[2].y)/6;let n=r,i=t[2].x;const o=t[2].y,a=t[3].x;e.push(`${i} ${o+n} m`);do{i+=2,n=0===n?r:0,e.push(`${i} ${o+n} l`)}while(i<a);return e.push("S"),[t[2].x,a,o-2*r,o+2*r]}})}}}class N extends p{constructor(e){super(e),this.data.annotationType=n.AnnotationType.STRIKEOUT;const t=h(e.dict,null);if(t&&(this.data.quadPoints=t,!this.appearance)){const t=this.color?Array.from(this.color).map((e=>e/255)):[0,0,0];this._setDefaultAppearance({xref:e.xref,extra:"[] 0 d 1 w",strokeColor:t,pointsCallback:(e,t)=>(e.push((t[0].x+t[2].x)/2+` ${(t[0].y+t[2].y)/2} m`),e.push((t[1].x+t[3].x)/2+` ${(t[1].y+t[3].y)/2} l`),e.push("S"),[t[0].x,t[1].x,t[3].y,t[1].y])})}}}class D extends p{constructor(e){super(e),this.data.annotationType=n.AnnotationType.STAMP}}class F extends p{constructor(e){super(e);const t=new i.FileSpec(e.dict.get("FS"),e.xref);this.data.annotationType=n.AnnotationType.FILEATTACHMENT,this.data.file=t.serializable}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OperatorList=void 0;var n=r(2),i=function(){function e(e,t,r,n,i){for(var o=e,a=0,s=t.length-1;a<s;a++){var l=t[a];o=o[l]||(o[l]=[])}o[t[t.length-1]]={checkFn:r,iterateFn:n,processFn:i}}var t=[];function r(e){this.queue=e,this.state=null,this.context={iCurr:0,fnArray:e.fnArray,argsArray:e.argsArray},this.match=null,this.lastProcessed=0}return e(t,[n.OPS.save,n.OPS.transform,n.OPS.paintInlineImageXObject,n.OPS.restore],null,(function(e,t){var r=e.fnArray,i=(t-(e.iCurr-3))%4;switch(i){case 0:return r[t]===n.OPS.save;case 1:return r[t]===n.OPS.transform;case 2:return r[t]===n.OPS.paintInlineImageXObject;case 3:return r[t]===n.OPS.restore}throw new Error(`iterateInlineImageGroup - invalid pos: ${i}`)}),(function(e,t){var r=e.fnArray,i=e.argsArray,o=e.iCurr,a=o-3,s=o-2,l=o-1,c=Math.min(Math.floor((t-a)/4),200);if(c<10)return t-(t-a)%4;var u,h=0,d=[],f=0,g=1,p=1;for(u=0;u<c;u++){var m=i[s+(u<<2)],v=i[l+(u<<2)][0];g+v.width>1e3&&(h=Math.max(h,g),p+=f+2,g=0,f=0),d.push({transform:m,x:g,y:p,w:v.width,h:v.height}),g+=v.width+2,f=Math.max(f,v.height)}var b=Math.max(h,g)+1,y=p+f+1,w=new Uint8ClampedArray(b*y*4),S=b<<2;for(u=0;u<c;u++){var C=i[l+(u<<2)][0].data,k=d[u].w<<2,x=0,E=d[u].x+d[u].y*b<<2;w.set(C.subarray(0,k),E-S);for(var T=0,_=d[u].h;T<_;T++)w.set(C.subarray(x,x+k),E),x+=k,E+=S;for(w.set(C.subarray(x-k,x),E);E>=0;)C[E-4]=C[E],C[E-3]=C[E+1],C[E-2]=C[E+2],C[E-1]=C[E+3],C[E+k]=C[E+k-4],C[E+k+1]=C[E+k-3],C[E+k+2]=C[E+k-2],C[E+k+3]=C[E+k-1],E-=S}return r.splice(a,4*c,n.OPS.paintInlineImageXObjectGroup),i.splice(a,4*c,[{width:b,height:y,kind:n.ImageKind.RGBA_32BPP,data:w},d]),a+1})),e(t,[n.OPS.save,n.OPS.transform,n.OPS.paintImageMaskXObject,n.OPS.restore],null,(function(e,t){var r=e.fnArray,i=(t-(e.iCurr-3))%4;switch(i){case 0:return r[t]===n.OPS.save;case 1:return r[t]===n.OPS.transform;case 2:return r[t]===n.OPS.paintImageMaskXObject;case 3:return r[t]===n.OPS.restore}throw new Error(`iterateImageMaskGroup - invalid pos: ${i}`)}),(function(e,t){var r,i=e.fnArray,o=e.argsArray,a=e.iCurr,s=a-3,l=a-2,c=a-1,u=Math.floor((t-s)/4);if(u=function(e,t,r,i){for(var o=e+2,a=0;a<t;a++){var s=i[o+4*a],l=1===s.length&&s[0];if(!l||1!==l.width||1!==l.height||l.data.length&&(1!==l.data.length||0!==l.data[0]))break;r[o+4*a]=n.OPS.paintSolidColorImageMask}return t-a}(s,u,i,o),u<10)return t-(t-s)%4;var h,d,f=!1,g=o[c][0];const p=o[l][0],m=o[l][1],v=o[l][2],b=o[l][3];if(m===v){f=!0,h=l+4;var y=c+4;for(r=1;r<u;r++,h+=4,y+=4)if(d=o[h],o[y][0]!==g||d[0]!==p||d[1]!==m||d[2]!==v||d[3]!==b){r<10?f=!1:u=r;break}}if(f){u=Math.min(u,1e3);var w=new Float32Array(2*u);for(h=l,r=0;r<u;r++,h+=4)d=o[h],w[r<<1]=d[4],w[1+(r<<1)]=d[5];i.splice(s,4*u,n.OPS.paintImageMaskXObjectRepeat),o.splice(s,4*u,[g,p,m,v,b,w])}else{u=Math.min(u,100);var S=[];for(r=0;r<u;r++){d=o[l+(r<<2)];var C=o[c+(r<<2)][0];S.push({data:C.data,width:C.width,height:C.height,transform:d})}i.splice(s,4*u,n.OPS.paintImageMaskXObjectGroup),o.splice(s,4*u,[S])}return s+1})),e(t,[n.OPS.save,n.OPS.transform,n.OPS.paintImageXObject,n.OPS.restore],(function(e){var t=e.argsArray,r=e.iCurr-2;return 0===t[r][1]&&0===t[r][2]}),(function(e,t){var r=e.fnArray,i=e.argsArray,o=(t-(e.iCurr-3))%4;switch(o){case 0:return r[t]===n.OPS.save;case 1:if(r[t]!==n.OPS.transform)return!1;var a=e.iCurr-2,s=i[a][0],l=i[a][3];return i[t][0]===s&&0===i[t][1]&&0===i[t][2]&&i[t][3]===l;case 2:if(r[t]!==n.OPS.paintImageXObject)return!1;var c=i[e.iCurr-1][0];return i[t][0]===c;case 3:return r[t]===n.OPS.restore}throw new Error(`iterateImageGroup - invalid pos: ${o}`)}),(function(e,t){var r=e.fnArray,i=e.argsArray,o=e.iCurr,a=o-3,s=o-2,l=i[o-1][0],c=i[s][0],u=i[s][3],h=Math.min(Math.floor((t-a)/4),1e3);if(h<3)return t-(t-a)%4;for(var d=new Float32Array(2*h),f=s,g=0;g<h;g++,f+=4){var p=i[f];d[g<<1]=p[4],d[1+(g<<1)]=p[5]}var m=[l,c,u,d];return r.splice(a,4*h,n.OPS.paintImageXObjectRepeat),i.splice(a,4*h,m),a+1})),e(t,[n.OPS.beginText,n.OPS.setFont,n.OPS.setTextMatrix,n.OPS.showText,n.OPS.endText],null,(function(e,t){var r=e.fnArray,i=e.argsArray,o=(t-(e.iCurr-4))%5;switch(o){case 0:return r[t]===n.OPS.beginText;case 1:return r[t]===n.OPS.setFont;case 2:return r[t]===n.OPS.setTextMatrix;case 3:if(r[t]!==n.OPS.showText)return!1;var a=e.iCurr-3,s=i[a][0],l=i[a][1];return i[t][0]===s&&i[t][1]===l;case 4:return r[t]===n.OPS.endText}throw new Error(`iterateShowTextGroup - invalid pos: ${o}`)}),(function(e,t){var r=e.fnArray,n=e.argsArray,i=e.iCurr,o=i-4,a=i-3,s=i-2,l=i-1,c=i,u=n[a][0],h=n[a][1],d=Math.min(Math.floor((t-o)/5),1e3);if(d<3)return t-(t-o)%5;var f=o;o>=4&&r[o-4]===r[a]&&r[o-3]===r[s]&&r[o-2]===r[l]&&r[o-1]===r[c]&&n[o-4][0]===u&&n[o-4][1]===h&&(d++,f-=5);for(var g=f+4,p=1;p<d;p++)r.splice(g,3),n.splice(g,3),g+=2;return g+1})),r.prototype={_optimize(){const e=this.queue.fnArray;let r=this.lastProcessed,n=e.length,i=this.state,o=this.match;if(!i&&!o&&r+1===n&&!t[e[r]])return void(this.lastProcessed=n);const a=this.context;for(;r<n;){if(o){if((0,o.iterateFn)(a,r)){r++;continue}if(r=(0,o.processFn)(a,r+1),n=e.length,o=null,i=null,r>=n)break}i=(i||t)[e[r]],i&&!Array.isArray(i)?(a.iCurr=r,r++,!i.checkFn||(0,i.checkFn)(a)?(o=i,i=null):i=null):r++}this.state=i,this.match=o,this.lastProcessed=r},push(e,t){this.queue.fnArray.push(e),this.queue.argsArray.push(t),this._optimize()},flush(){for(;this.match;){const e=this.queue.fnArray.length;this.lastProcessed=(0,this.match.processFn)(this.context,e),this.match=null,this.state=null,this._optimize()}},reset(){this.state=null,this.match=null,this.lastProcessed=0}},r}(),o=function(){function e(e){this.queue=e}return e.prototype={push(e,t){this.queue.fnArray.push(e),this.queue.argsArray.push(t)},flush(){},reset(){}},e}(),a=function(){function e(e,t){this._streamSink=t,this.fnArray=[],this.argsArray=[],this.optimizer=t&&"oplist"!==e?new i(this):new o(this),this.dependencies=new Set,this._totalLength=0,this.weight=0,this._resolved=t?null:Promise.resolve()}return e.prototype={get length(){return this.argsArray.length},get ready(){return this._resolved||this._streamSink.ready},get totalLength(){return this._totalLength+this.length},addOp(e,t){this.optimizer.push(e,t),this.weight++,this._streamSink&&(this.weight>=1e3||this.weight>=995&&(e===n.OPS.restore||e===n.OPS.endText))&&this.flush()},addDependency(e){this.dependencies.has(e)||(this.dependencies.add(e),this.addOp(n.OPS.dependency,[e]))},addDependencies(e){for(const t of e)this.addDependency(t)},addOpList(t){if(t instanceof e){for(const e of t.dependencies)this.dependencies.add(e);for(var r=0,i=t.length;r<i;r++)this.addOp(t.fnArray[r],t.argsArray[r])}else(0,n.warn)('addOpList - ignoring invalid "opList" parameter.')},getIR(){return{fnArray:this.fnArray,argsArray:this.argsArray,length:this.length}},get _transfers(){const e=[],{fnArray:t,argsArray:r,length:i}=this;for(let o=0;o<i;o++)switch(t[o]){case n.OPS.paintInlineImageXObject:case n.OPS.paintInlineImageXObjectGroup:case n.OPS.paintImageMaskXObject:const t=r[o][0];t.cached||e.push(t.data.buffer)}return e},flush(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.optimizer.flush();const t=this.length;this._totalLength+=t,this._streamSink.enqueue({fnArray:this.fnArray,argsArray:this.argsArray,lastChunk:e,length:t},1,this._transfers),this.dependencies.clear(),this.fnArray.length=0,this.argsArray.length=0,this.weight=0,this.optimizer.reset()}},e}();t.OperatorList=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.writeDict=l,t.incrementalUpdate=function(e){let{originalData:t,xrefInfo:r,newRefs:c,xref:d=null,datasetsRef:f=null}=e;!function(e,t,r){if(null===e||null===r)return;const i=r.fetchIfRef(e),a=(0,n.bytesToString)(i.getBytes()),l=new o.SimpleXMLParser(!0).parseFromString(a);for(const{xfa:f}of t){if(!f)continue;const{path:e,value:t}=f;if(!e)continue;const r=l.documentElement.searchNode((0,s.parseXFAPath)(e),0);r?r.childNodes=[new o.SimpleDOMNode("#text",t)]:(0,n.warn)(`Node not found for path: ${e}`)}const c=[];l.documentElement.dump(c);let u=c.join("");const h=r.encrypt;h&&(u=h.createCipherTransform(e.num,e.gen).encryptString(u));const d=`${e.num} ${e.gen} obj\n<< /Type /EmbeddedFile /Length ${u.length}>>\nstream\n`+u+"\nendstream\nendobj\n";t.push({ref:e,data:d})}(f,c,d);const g=new i.Dict(null),p=r.newRef;let m,v;const b=t[t.length-1];10===b||13===b?(m=[],v=t.length):(m=["\n"],v=t.length+1),g.set("Size",p.num+1),g.set("Prev",r.startXRef),g.set("Type",i.Name.get("XRef")),null!==r.rootRef&&g.set("Root",r.rootRef),null!==r.infoRef&&g.set("Info",r.infoRef),null!==r.encrypt&&g.set("Encrypt",r.encrypt),c.push({ref:p,data:""}),c=c.sort(((e,t)=>e.ref.num-t.ref.num));const y=[[0,1,65535]],w=[0,1];let S=0;for(const{ref:n,data:i}of c)S=Math.max(S,v),y.push([1,v,Math.min(n.gen,65535)]),v+=i.length,w.push(n.num),w.push(1),m.push(i);if(g.set("Index",w),0!==r.fileIds.length){const e=function(e,t){const r=Math.floor(Date.now()/1e3),i=t.filename||"",o=[r.toString(),i,e.toString()];let s=o.reduce(((e,t)=>e+t.length),0);for(const n of Object.values(t.info))o.push(n),s+=n.length;const l=new Uint8Array(s);let c=0;for(const n of o)h(n,c,l),c+=n.length;return(0,n.bytesToString)((0,a.calculateMD5)(l))}(v,r);g.set("ID",[r.fileIds[0],e])}const C=[1,Math.ceil(Math.log2(S)/8),2],k=(C[0]+C[1]+C[2])*y.length;g.set("W",C),g.set("Length",k),m.push(`${p.num} ${p.gen} obj\n`),l(g,m,null),m.push(" stream\n");const x=m.reduce(((e,t)=>e+t.length),0),E=`\nendstream\nendobj\nstartxref\n${v}\n%%EOF\n`,T=new Uint8Array(t.length+x+k+E.length);T.set(t);let _=t.length;for(const n of m)h(n,_,T),_+=n.length;for(const[n,i,o]of y)_=u(n,C[0],_,T),_=u(i,C[1],_,T),_=u(o,C[2],_,T);return h(E,_,T),T};var n=r(2),i=r(5),o=r(28),a=r(22),s=r(8);function l(e,t,r){t.push("<<");for(const n of e.getKeys())t.push(` /${n} `),c(e.getRaw(n),t,r);t.push(">>")}function c(e,t,r){(0,i.isName)(e)?t.push(`/${e.name}`):(0,i.isRef)(e)?t.push(`${e.num} ${e.gen} R`):Array.isArray(e)?function(e,t,r){t.push("[");let n=!0;for(const i of e)n?n=!1:t.push(" "),c(i,t,r);t.push("]")}(e,t,r):"string"===typeof e?(null!==r&&(e=r.encryptString(e)),t.push(`(${(0,n.escapeString)(e)})`)):"number"===typeof e?t.push(function(e){if(Number.isInteger(e))return e.toString();const t=Math.round(100*e);return t%100===0?(t/100).toString():t%10===0?e.toFixed(1):e.toFixed(2)}(e)):(0,i.isDict)(e)?l(e,t,r):(0,i.isStream)(e)&&function(e,t,r){l(e.dict,t,r),t.push(" stream\n");let i=(0,n.bytesToString)(e.getBytes());null!==r&&(i=r.encryptString(i)),t.push(i),t.push("\nendstream\n")}(e,t,r)}function u(e,t,r,n){for(let i=t+r-1;i>r-1;i--)n[i]=255&e,e>>=8;return r+t}function h(e,t,r){for(let n=0,i=e.length;n<i;n++)r[t+n]=255&e.charCodeAt(n)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SimpleXMLParser=t.SimpleDOMNode=void 0;var n=r(2);const i=0,o=-2,a=-3,s=-4,l=-5,c=-6,u=-9;function h(e,t){const r=e[t];return" "===r||"\n"===r||"\r"===r||"\t"===r}class d{_resolveEntities(e){return e.replace(/&([^;]+);/g,((e,t)=>{if("#x"===t.substring(0,2))return String.fromCodePoint(parseInt(t.substring(2),16));if("#"===t.substring(0,1))return String.fromCodePoint(parseInt(t.substring(1),10));switch(t){case"lt":return"<";case"gt":return">";case"amp":return"&";case"quot":return'"'}return this.onResolveEntity(t)}))}_parseContent(e,t){const r=[];let n=t;function i(){for(;n<e.length&&h(e,n);)++n}for(;n<e.length&&!h(e,n)&&">"!==e[n]&&"/"!==e[n];)++n;const o=e.substring(t,n);for(i();n<e.length&&">"!==e[n]&&"/"!==e[n]&&"?"!==e[n];){i();let t="",o="";for(;n<e.length&&!h(e,n)&&"="!==e[n];)t+=e[n],++n;if(i(),"="!==e[n])return null;++n,i();const a=e[n];if('"'!==a&&"'"!==a)return null;const s=e.indexOf(a,++n);if(s<0)return null;o=e.substring(n,s),r.push({name:t,value:this._resolveEntities(o)}),n=s+1,i()}return{name:o,attributes:r,parsed:n-t}}_parseProcessingInstruction(e,t){let r=t;for(;r<e.length&&!h(e,r)&&">"!==e[r]&&"/"!==e[r];)++r;const n=e.substring(t,r);!function(){for(;r<e.length&&h(e,r);)++r}();const i=r;for(;r<e.length&&("?"!==e[r]||">"!==e[r+1]);)++r;return{name:n,value:e.substring(i,r),parsed:r-t}}parseXml(e){let t=0;for(;t<e.length;){let r=t;if("<"===e[t]){let t;switch(++r,e[r]){case"/":if(++r,t=e.indexOf(">",r),t<0)return void this.onError(u);this.onEndElement(e.substring(r,t)),r=t+1;break;case"?":++r;const n=this._parseProcessingInstruction(e,r);if("?>"!==e.substring(r+n.parsed,r+n.parsed+2))return void this.onError(a);this.onPi(n.name,n.value),r+=n.parsed+2;break;case"!":if("--"===e.substring(r+1,r+3)){if(t=e.indexOf("--\x3e",r+3),t<0)return void this.onError(l);this.onComment(e.substring(r+3,t)),r=t+3}else if("[CDATA["===e.substring(r+1,r+8)){if(t=e.indexOf("]]>",r+8),t<0)return void this.onError(o);this.onCdata(e.substring(r+8,t)),r=t+3}else{if("DOCTYPE"!==e.substring(r+1,r+8))return void this.onError(c);{const n=e.indexOf("[",r+8);let i=!1;if(t=e.indexOf(">",r+8),t<0)return void this.onError(s);if(n>0&&t>n){if(t=e.indexOf("]>",r+8),t<0)return void this.onError(s);i=!0}const o=e.substring(r+8,t+(i?1:0));this.onDoctype(o),r=t+(i?2:1)}}break;default:const i=this._parseContent(e,r);if(null===i)return void this.onError(c);let h=!1;if("/>"===e.substring(r+i.parsed,r+i.parsed+2))h=!0;else if(">"!==e.substring(r+i.parsed,r+i.parsed+1))return void this.onError(u);this.onBeginElement(i.name,i.attributes,h),r+=i.parsed+(h?2:1)}}else{for(;r<e.length&&"<"!==e[r];)r++;const n=e.substring(t,r);this.onText(this._resolveEntities(n))}t=r}}onResolveEntity(e){return`&${e};`}onPi(e,t){}onComment(e){}onCdata(e){}onDoctype(e){}onText(e){}onBeginElement(e,t,r){}onEndElement(e){}onError(e){}}class f{constructor(e,t){this.nodeName=e,this.nodeValue=t,Object.defineProperty(this,"parentNode",{value:null,writable:!0})}get firstChild(){return this.childNodes&&this.childNodes[0]}get nextSibling(){const e=this.parentNode.childNodes;if(!e)return;const t=e.indexOf(this);return-1!==t?e[t+1]:void 0}get textContent(){return this.childNodes?this.childNodes.map((function(e){return e.textContent})).join(""):this.nodeValue||""}hasChildNodes(){return this.childNodes&&this.childNodes.length>0}searchNode(e,t){if(t>=e.length)return this;const r=e[t],n=[];let i=this;for(;;){if(r.name===i.nodeName){if(0!==r.pos){if(0===n.length)return null;{const[o]=n.pop();let a=0;for(const n of o.childNodes)if(r.name===n.nodeName){if(a===r.pos)return n.searchNode(e,t+1);a++}return i.searchNode(e,t+1)}}{const r=i.searchNode(e,t+1);if(null!==r)return r}}if(i.childNodes&&0!==i.childNodes.length)n.push([i,0]),i=i.childNodes[0];else{if(0===n.length)return null;for(;0!==n.length;){const[e,t]=n.pop(),r=t+1;if(r<e.childNodes.length){n.push([e,r]),i=e.childNodes[r];break}}if(0===n.length)return null}}}dump(e){if("#text"!==this.nodeName){if(e.push(`<${this.nodeName}`),this.attributes)for(const t of this.attributes)e.push(` ${t.name}="${(0,n.encodeToXmlString)(t.value)}"`);if(this.hasChildNodes()){e.push(">");for(const t of this.childNodes)t.dump(e);e.push(`</${this.nodeName}>`)}else this.nodeValue?e.push(`>${(0,n.encodeToXmlString)(this.nodeValue)}</${this.nodeName}>`):e.push("/>")}else e.push((0,n.encodeToXmlString)(this.nodeValue))}}t.SimpleDOMNode=f,t.SimpleXMLParser=class extends d{constructor(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];super(),this._currentFragment=null,this._stack=null,this._errorCode=i,this._hasAttributes=e}parseFromString(e){if(this._currentFragment=[],this._stack=[],this._errorCode=i,this.parseXml(e),this._errorCode!==i)return;const[t]=this._currentFragment;return t?{documentElement:t}:void 0}onResolveEntity(e){return"apos"===e?"'":super.onResolveEntity(e)}onText(e){if(function(e){for(let t=0,r=e.length;t<r;t++)if(!h(e,t))return!1;return!0}(e))return;const t=new f("#text",e);this._currentFragment.push(t)}onCdata(e){const t=new f("#text",e);this._currentFragment.push(t)}onBeginElement(e,t,r){const n=new f(e);n.childNodes=[],this._hasAttributes&&(n.attributes=t),this._currentFragment.push(n),r||(this._stack.push(this._currentFragment),this._currentFragment=n.childNodes)}onEndElement(e){this._currentFragment=this._stack.pop()||[];const t=this._currentFragment[this._currentFragment.length-1];if(t)for(let r=0,n=t.childNodes.length;r<n;r++)t.childNodes[r].parentNode=t}onError(e){this._errorCode=e}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PartialEvaluator=void 0;var n=r(2),i=r(30),o=r(5),a=r(31),s=r(34),l=r(8),c=r(37),u=r(36),h=r(40),d=r(41),f=r(11),g=r(24),p=r(43),m=r(23),v=r(12),b=r(35),y=r(44),w=r(45),S=r(26),C=r(46);const k=Object.freeze({maxImageSize:-1,disableFontFace:!1,ignoreErrors:!1,isEvalSupported:!0,fontExtraProperties:!1}),x=1,E=2,T=Promise.resolve();function _(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(Array.isArray(e)){for(let t=0,r=e.length;t<r;t++){const r=_(e[t],!0);if(r)return r}return(0,n.warn)(`Unsupported blend mode Array: ${e}`),"source-over"}if(!(0,o.isName)(e))return t?null:"source-over";switch(e.name){case"Normal":case"Compatible":return"source-over";case"Multiply":return"multiply";case"Screen":return"screen";case"Overlay":return"overlay";case"Darken":return"darken";case"Lighten":return"lighten";case"ColorDodge":return"color-dodge";case"ColorBurn":return"color-burn";case"HardLight":return"hard-light";case"SoftLight":return"soft-light";case"Difference":return"difference";case"Exclusion":return"exclusion";case"Hue":return"hue";case"Saturation":return"saturation";case"Color":return"color";case"Luminosity":return"luminosity"}return t?null:((0,n.warn)(`Unsupported blend mode: ${e.name}`),"source-over")}class A{static get TIME_SLOT_DURATION_MS(){return(0,n.shadow)(this,"TIME_SLOT_DURATION_MS",20)}static get CHECK_TIME_EVERY(){return(0,n.shadow)(this,"CHECK_TIME_EVERY",100)}constructor(){this.reset()}check(){return!(++this.checked<A.CHECK_TIME_EVERY)&&(this.checked=0,this.endTime<=Date.now())}reset(){this.endTime=Date.now()+A.TIME_SLOT_DURATION_MS,this.checked=0}}class R{constructor(e){let{xref:t,handler:r,pageIndex:n,idFactory:i,fontCache:o,builtInCMapCache:a,globalImageCache:s,options:l=null}=e;this.xref=t,this.handler=r,this.pageIndex=n,this.idFactory=i,this.fontCache=o,this.builtInCMapCache=a,this.globalImageCache=s,this.options=l||k,this.parsingType3Font=!1,this._fetchBuiltInCMapBound=this.fetchBuiltInCMap.bind(this)}get _pdfFunctionFactory(){const e=new d.PDFFunctionFactory({xref:this.xref,isEvalSupported:this.options.isEvalSupported});return(0,n.shadow)(this,"_pdfFunctionFactory",e)}clone(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:k;var t=Object.create(this);return t.options=e,t}hasBlendModes(e){if(!(e instanceof o.Dict))return!1;const t=new o.RefSet;e.objId&&t.put(e.objId);for(var r=[e],i=this.xref;r.length;){var a=r.shift(),s=a.get("ExtGState");if(s instanceof o.Dict)for(let e of s.getRawValues()){if(e instanceof o.Ref){if(t.has(e))continue;try{e=i.fetch(e)}catch(h){if(h instanceof l.MissingDataException)throw h;t.put(e),(0,n.info)(`hasBlendModes - ignoring ExtGState: "${h}".`);continue}}if(!(e instanceof o.Dict))continue;e.objId&&t.put(e.objId);const r=e.get("BM");if(r instanceof o.Name){if("Normal"!==r.name)return!0}else if(void 0!==r&&Array.isArray(r))for(const e of r)if(e instanceof o.Name&&"Normal"!==e.name)return!0}var c=a.get("XObject");if(c instanceof o.Dict)for(let e of c.getRawValues()){if(e instanceof o.Ref){if(t.has(e))continue;try{e=i.fetch(e)}catch(h){if(h instanceof l.MissingDataException)throw h;t.put(e),(0,n.info)(`hasBlendModes - ignoring XObject: "${h}".`);continue}}if((0,o.isStream)(e)){e.dict.objId&&t.put(e.dict.objId);var u=e.dict.get("Resources");u instanceof o.Dict&&(u.objId&&t.has(u.objId)||(r.push(u),u.objId&&t.put(u.objId)))}}}return!1}async fetchBuiltInCMap(e){const t=this.builtInCMapCache.get(e);if(t)return t;const r=this.handler.sendWithStream("FetchBuiltInCMap",{name:e}).getReader(),i=await new Promise((function(e,t){!function n(){r.read().then((function(t){let{value:r,done:i}=t;i||(e(r),n())}),t)}()}));return i.compressionType!==n.CMapCompressionType.NONE&&this.builtInCMapCache.set(e,i),i}async buildFormXObject(e,t,r,i,a,s,l){var c=t.dict,u=c.getArray("Matrix"),h=c.getArray("BBox");h=Array.isArray(h)&&4===h.length?n.Util.normalizeRect(h):null;let d=null;c.has("OC")&&(d=await this.parseMarkedContentProps(c.get("OC"),e),i.addOp(n.OPS.beginMarkedContentProps,["OC",d]));var f=c.get("Group");if(f){var g={matrix:u,bbox:h,smask:r,isolated:!1,knockout:!1},p=f.get("S"),v=null;if((0,o.isName)(p,"Transparency")&&(g.isolated=f.get("I")||!1,g.knockout=f.get("K")||!1,f.has("CS"))){const t=f.getRaw("CS"),r=m.ColorSpace.getCached(t,this.xref,l);v=r||await this.parseColorSpace({cs:t,resources:e,localColorSpaceCache:l})}r&&r.backdrop&&(v=v||m.ColorSpace.singletons.rgb,r.backdrop=v.getRgb(r.backdrop,0)),i.addOp(n.OPS.beginGroup,[g])}return i.addOp(n.OPS.paintFormXObjectBegin,[u,h]),this.getOperatorList({stream:t,task:a,resources:c.get("Resources")||e,operatorList:i,initialState:s}).then((function(){i.addOp(n.OPS.paintFormXObjectEnd,[]),f&&i.addOp(n.OPS.endGroup,[g]),d&&i.addOp(n.OPS.endMarkedContent,[])}))}_sendImgData(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n=t?[t.data.buffer]:null;return this.parsingType3Font||r?this.handler.send("commonobj",[e,"Image",t],n):this.handler.send("obj",[e,this.pageIndex,"Image",t],n)}async buildPaintImageXObject(e){let{resources:t,image:r,isInline:i=!1,operatorList:o,cacheKey:a,localImageCache:s,localColorSpaceCache:l}=e;var c=r.dict;const u=c.objId;var h=c.get("Width","W"),d=c.get("Height","H");if(!h||!(0,n.isNum)(h)||!d||!(0,n.isNum)(d))return void(0,n.warn)("Image dimensions are missing, or not numbers.");var f,g,p=this.options.maxImageSize;if(-1!==p&&h*d>p)return void(0,n.warn)("Image exceeded maximum allowed size and was removed.");if(c.get("ImageMask","IM")){var m=c.get("Width","W"),b=c.get("Height","H"),y=m+7>>3,w=r.getBytes(y*b,!0),S=c.getArray("Decode","D");return(f=C.PDFImage.createMask({imgArray:w,width:m,height:b,imageIsFromDecodeStream:r instanceof v.DecodeStream,inverseDecode:!!S&&S[0]>0})).cached=!!a,g=[f],o.addOp(n.OPS.paintImageMaskXObject,g),void(a&&s.set(a,u,{fn:n.OPS.paintImageMaskXObject,args:g}))}var k=c.get("SMask","SM")||!1,x=c.get("Mask")||!1;if(i&&!k&&!x&&h+d<200){const e=new C.PDFImage({xref:this.xref,res:t,image:r,isInline:i,pdfFunctionFactory:this._pdfFunctionFactory,localColorSpaceCache:l});return f=e.createImageData(!0),void o.addOp(n.OPS.paintInlineImageXObject,[f])}let E=`img_${this.idFactory.createObjId()}`,T=!1;this.parsingType3Font?E=`${this.idFactory.getDocId()}_type3_${E}`:u&&(T=this.globalImageCache.shouldCache(u,this.pageIndex),T&&(E=`${this.idFactory.getDocId()}_${E}`)),o.addDependency(E),g=[E,h,d],C.PDFImage.buildImage({xref:this.xref,res:t,image:r,isInline:i,pdfFunctionFactory:this._pdfFunctionFactory,localColorSpaceCache:l}).then((e=>(f=e.createImageData(!1),this._sendImgData(E,f,T)))).catch((e=>((0,n.warn)(`Unable to decode image "${E}": "${e}".`),this._sendImgData(E,null,T)))),o.addOp(n.OPS.paintImageXObject,g),a&&(s.set(a,u,{fn:n.OPS.paintImageXObject,args:g}),u&&((0,n.assert)(!i,"Cannot cache an inline image globally."),this.globalImageCache.addPageIndex(u,this.pageIndex),T&&this.globalImageCache.setData(u,{objId:E,fn:n.OPS.paintImageXObject,args:g})))}handleSMask(e,t,r,n,i,o){var a=e.get("G"),s={subtype:e.get("S").name,backdrop:e.get("BC")},l=e.get("TR");if((0,d.isPDFFunction)(l)){const e=this._pdfFunctionFactory.create(l);for(var c=new Uint8Array(256),u=new Float32Array(1),h=0;h<256;h++)u[0]=h/255,e(u,0,u,0),c[h]=255*u[0]|0;s.transferMap=c}return this.buildFormXObject(t,a,s,r,n,i.state.clone(),o)}handleTransferFunction(e){let t;if(Array.isArray(e))t=e;else{if(!(0,d.isPDFFunction)(e))return null;t=[e]}const r=[];let n=0,i=0;for(const a of t){const e=this.xref.fetchIfRef(a);if(n++,(0,o.isName)(e,"Identity")){r.push(null);continue}if(!(0,d.isPDFFunction)(e))return null;const t=this._pdfFunctionFactory.create(e),s=new Uint8Array(256),l=new Float32Array(1);for(let r=0;r<256;r++)l[0]=r/255,t(l,0,l,0),s[r]=255*l[0]|0;r.push(s),i++}return 1!==n&&4!==n||0===i?null:r}handleTilingType(e,t,r,i,a,s,l){const c=new S.OperatorList,u=o.Dict.merge({xref:this.xref,dictArray:[a.get("Resources"),r]});return this.getOperatorList({stream:i,task:l,resources:u,operatorList:c}).then((function(){return(0,h.getTilingPatternIR)({fnArray:c.fnArray,argsArray:c.argsArray},a,t)})).then((function(t){s.addDependencies(c.dependencies),s.addOp(e,t)}),(e=>{if(!(e instanceof n.AbortException)){if(this.options.ignoreErrors)return this.handler.send("UnsupportedFeature",{featureId:n.UNSUPPORTED_FEATURES.errorTilingPattern}),void(0,n.warn)(`handleTilingType - ignoring pattern: "${e}".`);throw e}}))}handleSetFont(e,t,r,i,o,s){var l,c=0;return t&&(t=t.slice(),l=t[0].name,c=t[1]),this.loadFont(l,r,e).then((t=>t.font.isType3Font?t.loadType3Data(this,e,o).then((function(){return i.addDependencies(t.type3Dependencies),t})).catch((e=>(this.handler.send("UnsupportedFeature",{featureId:n.UNSUPPORTED_FEATURES.errorFontLoadType3}),new O({loadedName:"g_font_error",font:new a.ErrorFont(`Type3 font load error: ${e}`),dict:t.font,extraProperties:this.options.fontExtraProperties})))):t)).then((e=>(s.font=e.font,s.fontSize=c,s.fontName=l,e.send(this.handler),e.loadedName)))}handleText(e,t){const r=t.font,i=r.charsToGlyphs(e);return r.data&&(t.textRenderingMode&n.TextRenderingMode.ADD_TO_PATH_FLAG||"Pattern"===t.fillColorSpace.name||r.disableFontFace||this.options.disableFontFace)&&R.buildFontPaths(r,i,this.handler),i}ensureStateFont(e){if(e.font)return;const t=new n.FormatError("Missing setFont (Tf) operator before text rendering operator.");if(this.options.ignoreErrors)return this.handler.send("UnsupportedFeature",{featureId:n.UNSUPPORTED_FEATURES.errorFontState}),void(0,n.warn)(`ensureStateFont: "${t}".`);throw t}async setGState(e){let{resources:t,gState:r,operatorList:i,cacheKey:a,task:s,stateManager:l,localGStateCache:c,localColorSpaceCache:u}=e;const h=r.objId;let d=!0;for(var f=[],g=r.getKeys(),p=Promise.resolve(),m=0,v=g.length;m<v;m++){const e=g[m],a=r.get(e);switch(e){case"Type":break;case"LW":case"LC":case"LJ":case"ML":case"D":case"RI":case"FL":case"CA":case"ca":f.push([e,a]);break;case"Font":d=!1,p=p.then((()=>this.handleSetFont(t,null,a[0],i,s,l.state).then((function(t){i.addDependency(t),f.push([e,[t,a[1]]])}))));break;case"BM":f.push([e,_(a)]);break;case"SMask":if((0,o.isName)(a,"None")){f.push([e,!1]);break}(0,o.isDict)(a)?(d=!1,p=p.then((()=>this.handleSMask(a,t,i,s,l,u))),f.push([e,!0])):(0,n.warn)("Unsupported SMask type");break;case"TR":const r=this.handleTransferFunction(a);f.push([e,r]);break;case"OP":case"op":case"OPM":case"BG":case"BG2":case"UCR":case"UCR2":case"TR2":case"HT":case"SM":case"SA":case"AIS":case"TK":(0,n.info)("graphic state operator "+e);break;default:(0,n.info)("Unknown graphic state operator "+e)}}return p.then((function(){f.length>0&&i.addOp(n.OPS.setGState,[f]),d&&c.set(a,h,f)}))}loadFont(e,t,r){const i=()=>Promise.resolve(new O({loadedName:"g_font_error",font:new a.ErrorFont(`Font "${e}" is not available.`),dict:t,extraProperties:this.options.fontExtraProperties}));var s,l=this.xref;if(t){if(!(0,o.isRef)(t))throw new n.FormatError('The "font" object should be a reference.');s=t}else{var c=r.get("Font");c&&(s=c.getRaw(e))}if(!s){const r=`Font "${e||t&&t.toString()}" is not available`;if(!this.options.ignoreErrors&&!this.parsingType3Font)return(0,n.warn)(`${r}.`),i();this.handler.send("UnsupportedFeature",{featureId:n.UNSUPPORTED_FEATURES.errorFontMissing}),(0,n.warn)(`${r} -- attempting to fallback to a default font.`),s=R.fallbackFontDict}if(this.fontCache.has(s))return this.fontCache.get(s);if(t=l.fetchIfRef(s),!(0,o.isDict)(t))return i();if(t.translated)return t.translated;var u=(0,n.createPromiseCapability)(),h=this.preEvaluateFont(t);const{descriptor:d,hash:f}=h;var g,p,m=(0,o.isRef)(s);if(m&&(g=`f${s.toString()}`),f&&(0,o.isDict)(d)){d.fontAliases||(d.fontAliases=Object.create(null));var v=d.fontAliases;if(v[f]){var b=v[f].aliasRef;if(m&&b&&this.fontCache.has(b))return this.fontCache.putAlias(s,b),this.fontCache.get(s)}else v[f]={fontID:this.idFactory.createFontId()};m&&(v[f].aliasRef=s),g=v[f].fontID}m?this.fontCache.put(s,u.promise):(g||(g=this.idFactory.createFontId()),this.fontCache.put(`id_${g}`,u.promise)),(0,n.assert)(g&&g.startsWith("f"),'The "fontID" must be (correctly) defined.'),t.loadedName=`${this.idFactory.getDocId()}_${g}`,t.translated=u.promise;try{p=this.translateFont(h)}catch(y){p=Promise.reject(y)}return p.then((e=>{void 0!==e.fontType&&(l.stats.fontTypes[e.fontType]=!0),u.resolve(new O({loadedName:t.loadedName,font:e,dict:t,extraProperties:this.options.fontExtraProperties}))})).catch((e=>{this.handler.send("UnsupportedFeature",{featureId:n.UNSUPPORTED_FEATURES.errorFontTranslate});try{var r=d&&d.get("FontFile3"),i=r&&r.get("Subtype"),o=(0,a.getFontType)(h.type,i&&i.name);l.stats.fontTypes[o]=!0}catch(s){}u.resolve(new O({loadedName:t.loadedName,font:new a.ErrorFont(e instanceof Error?e.message:e),dict:t,extraProperties:this.options.fontExtraProperties}))})),u.promise}buildPath(e,t,r){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];var o=e.length-1;if(r||(r=[]),o<0||e.fnArray[o]!==n.OPS.constructPath)i&&((0,n.warn)(`Encountered path operator "${t}" inside of a text object.`),e.addOp(n.OPS.save,null)),e.addOp(n.OPS.constructPath,[[t],r]),i&&e.addOp(n.OPS.restore,null);else{var a=e.argsArray[o];a[0].push(t),Array.prototype.push.apply(a[1],r)}}parseColorSpace(e){let{cs:t,resources:r,localColorSpaceCache:i}=e;return m.ColorSpace.parseAsync({cs:t,xref:this.xref,resources:r,pdfFunctionFactory:this._pdfFunctionFactory,localColorSpaceCache:i}).catch((e=>{if(e instanceof n.AbortException)return null;if(this.options.ignoreErrors)return this.handler.send("UnsupportedFeature",{featureId:n.UNSUPPORTED_FEATURES.errorColorSpace}),(0,n.warn)(`parseColorSpace - ignoring ColorSpace: "${e}".`),null;throw e}))}async handleColorN(e,t,r,i,a,s,l,c){var u,d=r[r.length-1];if((0,o.isName)(d)&&(u=a.get(d.name))){var f=(0,o.isStream)(u)?u.dict:u,g=f.get("PatternType");if(g===x){var p=i.base?i.base.getRgb(r,0):null;return this.handleTilingType(t,p,s,u,f,e,l)}if(g===E){var m=f.get("Shading"),v=f.getArray("Matrix");return u=h.Pattern.parseShading(m,v,this.xref,s,this.handler,this._pdfFunctionFactory,c),void e.addOp(t,u.getIR())}throw new n.FormatError(`Unknown PatternType: ${g}`)}throw new n.FormatError(`Unknown PatternName: ${d}`)}async parseMarkedContentProps(e,t){let r;if((0,o.isName)(e))r=t.get("Properties").get(e.name);else{if(!(0,o.isDict)(e))throw new n.FormatError("Optional content properties malformed.");r=e}const i=r.get("Type").name;if("OCG"===i)return{type:i,id:r.objId};if("OCMD"===i){const e=r.get("OCGs");if(Array.isArray(e)||(0,o.isDict)(e)){const t=[];Array.isArray(e)?r.get("OCGs").forEach((e=>{t.push(e.toString())})):t.push(e.objId);let n=null;return r.get("VE")&&(n=!0),{type:i,ids:t,policy:(0,o.isName)(r.get("P"))?r.get("P").name:null,expression:n}}if((0,o.isRef)(e))return{type:i,id:e.toString()}}return null}getOperatorList(e){let{stream:t,task:r,resources:i,operatorList:a,initialState:s=null}=e;if(i=i||o.Dict.empty,s=s||new P,!a)throw new Error('getOperatorList: missing "operatorList" parameter');var l=this,c=this.xref;let u=!1;const d=new g.LocalImageCache,f=new g.LocalColorSpaceCache,p=new g.LocalGStateCache;var v=i.get("XObject")||o.Dict.empty,b=i.get("Pattern")||o.Dict.empty,y=new M(s),w=new N(t,c,y),S=new A;function C(e){for(var t=0,r=w.savedStatesDepth;t<r;t++)a.addOp(n.OPS.restore,[])}return new Promise((function e(t,s){const g=function(r){Promise.all([r,a.ready]).then((function(){try{e(t,s)}catch(r){s(r)}}),s)};r.ensureNotTerminated(),S.reset();for(var k,x,E,_,A,R={};!(k=S.check())&&(R.args=null,w.read(R));){var O=R.args,M=R.fn;switch(0|M){case n.OPS.paintXObject:if(A=O[0].name){const e=d.getByName(A);if(e){a.addOp(e.fn,e.args),O=null;continue}}return void g(new Promise((function(e,t){if(!A)throw new n.FormatError("XObject must be referred to by name.");let s=v.getRaw(A);if(s instanceof o.Ref){const t=d.getByRef(s);if(t)return a.addOp(t.fn,t.args),void e();const r=l.globalImageCache.getData(s,l.pageIndex);if(r)return a.addDependency(r.objId),a.addOp(r.fn,r.args),void e();s=c.fetch(s)}if(!(0,o.isStream)(s))throw new n.FormatError("XObject should be a stream");const u=s.dict.get("Subtype");if(!(0,o.isName)(u))throw new n.FormatError("XObject should have a Name subtype");if("Form"===u.name)return y.save(),void l.buildFormXObject(i,s,null,a,r,y.state.clone(),f).then((function(){y.restore(),e()}),t);if("Image"!==u.name){if("PS"!==u.name)throw new n.FormatError(`Unhandled XObject subtype ${u.name}`);(0,n.info)("Ignored XObject subtype PS"),e()}else l.buildPaintImageXObject({resources:i,image:s,operatorList:a,cacheKey:A,localImageCache:d,localColorSpaceCache:f}).then(e,t)})).catch((function(e){if(!(e instanceof n.AbortException)){if(l.options.ignoreErrors)return l.handler.send("UnsupportedFeature",{featureId:n.UNSUPPORTED_FEATURES.errorXObject}),void(0,n.warn)(`getOperatorList - ignoring XObject: "${e}".`);throw e}})));case n.OPS.setFont:var I=O[1];return void g(l.handleSetFont(i,O,null,a,r,y.state).then((function(e){a.addDependency(e),a.addOp(n.OPS.setFont,[e,I])})));case n.OPS.beginText:u=!0;break;case n.OPS.endText:u=!1;break;case n.OPS.endInlineImage:var P=O[0].cacheKey;if(P){const e=d.getByName(P);if(e){a.addOp(e.fn,e.args),O=null;continue}}return void g(l.buildPaintImageXObject({resources:i,image:O[0],isInline:!0,operatorList:a,cacheKey:P,localImageCache:d,localColorSpaceCache:f}));case n.OPS.showText:if(!y.state.font){l.ensureStateFont(y.state);continue}O[0]=l.handleText(O[0],y.state);break;case n.OPS.showSpacedText:if(!y.state.font){l.ensureStateFont(y.state);continue}var N=O[0],D=[],F=N.length,L=y.state;for(x=0;x<F;++x){var H=N[x];(0,n.isString)(H)?Array.prototype.push.apply(D,l.handleText(H,L)):(0,n.isNum)(H)&&D.push(H)}O[0]=D,M=n.OPS.showText;break;case n.OPS.nextLineShowText:if(!y.state.font){l.ensureStateFont(y.state);continue}a.addOp(n.OPS.nextLine),O[0]=l.handleText(O[0],y.state),M=n.OPS.showText;break;case n.OPS.nextLineSetSpacingShowText:if(!y.state.font){l.ensureStateFont(y.state);continue}a.addOp(n.OPS.nextLine),a.addOp(n.OPS.setWordSpacing,[O.shift()]),a.addOp(n.OPS.setCharSpacing,[O.shift()]),O[0]=l.handleText(O[0],y.state),M=n.OPS.showText;break;case n.OPS.setTextRenderingMode:y.state.textRenderingMode=O[0];break;case n.OPS.setFillColorSpace:{const e=m.ColorSpace.getCached(O[0],c,f);if(e){y.state.fillColorSpace=e;continue}return void g(l.parseColorSpace({cs:O[0],resources:i,localColorSpaceCache:f}).then((function(e){e&&(y.state.fillColorSpace=e)})))}case n.OPS.setStrokeColorSpace:{const e=m.ColorSpace.getCached(O[0],c,f);if(e){y.state.strokeColorSpace=e;continue}return void g(l.parseColorSpace({cs:O[0],resources:i,localColorSpaceCache:f}).then((function(e){e&&(y.state.strokeColorSpace=e)})))}case n.OPS.setFillColor:O=(_=y.state.fillColorSpace).getRgb(O,0),M=n.OPS.setFillRGBColor;break;case n.OPS.setStrokeColor:O=(_=y.state.strokeColorSpace).getRgb(O,0),M=n.OPS.setStrokeRGBColor;break;case n.OPS.setFillGray:y.state.fillColorSpace=m.ColorSpace.singletons.gray,O=m.ColorSpace.singletons.gray.getRgb(O,0),M=n.OPS.setFillRGBColor;break;case n.OPS.setStrokeGray:y.state.strokeColorSpace=m.ColorSpace.singletons.gray,O=m.ColorSpace.singletons.gray.getRgb(O,0),M=n.OPS.setStrokeRGBColor;break;case n.OPS.setFillCMYKColor:y.state.fillColorSpace=m.ColorSpace.singletons.cmyk,O=m.ColorSpace.singletons.cmyk.getRgb(O,0),M=n.OPS.setFillRGBColor;break;case n.OPS.setStrokeCMYKColor:y.state.strokeColorSpace=m.ColorSpace.singletons.cmyk,O=m.ColorSpace.singletons.cmyk.getRgb(O,0),M=n.OPS.setStrokeRGBColor;break;case n.OPS.setFillRGBColor:y.state.fillColorSpace=m.ColorSpace.singletons.rgb,O=m.ColorSpace.singletons.rgb.getRgb(O,0);break;case n.OPS.setStrokeRGBColor:y.state.strokeColorSpace=m.ColorSpace.singletons.rgb,O=m.ColorSpace.singletons.rgb.getRgb(O,0);break;case n.OPS.setFillColorN:if("Pattern"===(_=y.state.fillColorSpace).name)return void g(l.handleColorN(a,n.OPS.setFillColorN,O,_,b,i,r,f));O=_.getRgb(O,0),M=n.OPS.setFillRGBColor;break;case n.OPS.setStrokeColorN:if("Pattern"===(_=y.state.strokeColorSpace).name)return void g(l.handleColorN(a,n.OPS.setStrokeColorN,O,_,b,i,r,f));O=_.getRgb(O,0),M=n.OPS.setStrokeRGBColor;break;case n.OPS.shadingFill:var B=i.get("Shading");if(!B)throw new n.FormatError("No shading resource found");var U=B.get(O[0].name);if(!U)throw new n.FormatError("No shading object found");O=[h.Pattern.parseShading(U,null,c,i,l.handler,l._pdfFunctionFactory,f).getIR()],M=n.OPS.shadingFill;break;case n.OPS.setGState:if(A=O[0].name){const e=p.getByName(A);if(e){e.length>0&&a.addOp(n.OPS.setGState,[e]),O=null;continue}}return void g(new Promise((function(e,t){if(!A)throw new n.FormatError("GState must be referred to by name.");const s=i.get("ExtGState");if(!(s instanceof o.Dict))throw new n.FormatError("ExtGState should be a dictionary.");const c=s.get(A);if(!(c instanceof o.Dict))throw new n.FormatError("GState should be a dictionary.");l.setGState({resources:i,gState:c,operatorList:a,cacheKey:A,task:r,stateManager:y,localGStateCache:p,localColorSpaceCache:f}).then(e,t)})).catch((function(e){if(!(e instanceof n.AbortException)){if(l.options.ignoreErrors)return l.handler.send("UnsupportedFeature",{featureId:n.UNSUPPORTED_FEATURES.errorExtGState}),void(0,n.warn)(`getOperatorList - ignoring ExtGState: "${e}".`);throw e}})));case n.OPS.moveTo:case n.OPS.lineTo:case n.OPS.curveTo:case n.OPS.curveTo2:case n.OPS.curveTo3:case n.OPS.closePath:case n.OPS.rectangle:l.buildPath(a,M,O,u);continue;case n.OPS.markPoint:case n.OPS.markPointProps:case n.OPS.beginCompat:case n.OPS.endCompat:continue;case n.OPS.beginMarkedContentProps:if(!(0,o.isName)(O[0])){(0,n.warn)(`Expected name for beginMarkedContentProps arg0=${O[0]}`);continue}if("OC"===O[0].name)return void g(l.parseMarkedContentProps(O[1],i).then((e=>{a.addOp(n.OPS.beginMarkedContentProps,["OC",e])})).catch((e=>{if(!(e instanceof n.AbortException)){if(l.options.ignoreErrors)return l.handler.send("UnsupportedFeature",{featureId:n.UNSUPPORTED_FEATURES.errorMarkedContent}),void(0,n.warn)(`getOperatorList - ignoring beginMarkedContentProps: "${e}".`);throw e}})));O=[O[0].name];break;case n.OPS.beginMarkedContent:case n.OPS.endMarkedContent:default:if(null!==O){for(x=0,E=O.length;x<E&&!(O[x]instanceof o.Dict);x++);if(x<E){(0,n.warn)("getOperatorList - ignoring operator: "+M);continue}}}a.addOp(M,O)}k?g(T):(C(),t())})).catch((e=>{if(!(e instanceof n.AbortException)){if(this.options.ignoreErrors)return this.handler.send("UnsupportedFeature",{featureId:n.UNSUPPORTED_FEATURES.errorOperatorList}),(0,n.warn)(`getOperatorList - ignoring errors during "${r.name}" task: "${e}".`),void C();throw e}}))}getTextContent(e){let{stream:t,task:r,resources:i,stateManager:a=null,normalizeWhitespace:s=!1,combineTextItems:l=!1,sink:u,seenStyles:h=Object.create(null)}=e;i=i||o.Dict.empty,a=a||new M(new I);var d=/\s/g,f={items:[],styles:Object.create(null)},m={initialized:!1,str:[],width:0,height:0,vertical:!1,lastAdvanceWidth:0,lastAdvanceHeight:0,textAdvanceScale:0,spaceWidth:0,fakeSpaceMin:1/0,fakeMultiSpaceMin:1/0,fakeMultiSpaceMax:-0,textRunBreakAllowed:!1,transform:null,fontName:null},v=this,b=this.xref,y=null;const w=new g.LocalImageCache,S=new g.LocalGStateCache;var C,k=new N(t,b,a);function x(){if(m.initialized)return m;var e=C.font;e.loadedName in h||(h[e.loadedName]=!0,f.styles[e.loadedName]={fontFamily:e.fallbackName,ascent:e.ascent,descent:e.descent,vertical:e.vertical}),m.fontName=e.loadedName;var t=[C.fontSize*C.textHScale,0,0,C.fontSize,0,C.textRise];if(e.isType3Font&&C.fontSize<=1&&!(0,n.isArrayEqual)(C.fontMatrix,n.FONT_IDENTITY_MATRIX)){const r=e.bbox[3]-e.bbox[1];r>0&&(t[3]*=r*C.fontMatrix[3])}var r=n.Util.transform(C.ctm,n.Util.transform(C.textMatrix,t));m.transform=r,e.vertical?(m.width=Math.sqrt(r[0]*r[0]+r[1]*r[1]),m.height=0,m.vertical=!0):(m.width=0,m.height=Math.sqrt(r[2]*r[2]+r[3]*r[3]),m.vertical=!1);var i=C.textLineMatrix[0],o=C.textLineMatrix[1],a=Math.sqrt(i*i+o*o);i=C.ctm[0],o=C.ctm[1];var s=Math.sqrt(i*i+o*o);m.textAdvanceScale=s*a,m.lastAdvanceWidth=0,m.lastAdvanceHeight=0;var l=e.spaceWidth/1e3*C.fontSize;return l?(m.spaceWidth=l,m.fakeSpaceMin=.3*l,m.fakeMultiSpaceMin=1.5*l,m.fakeMultiSpaceMax=4*l,m.textRunBreakAllowed=!e.isMonospace):(m.spaceWidth=0,m.fakeSpaceMin=1/0,m.fakeMultiSpaceMin=1/0,m.fakeMultiSpaceMax=0,m.textRunBreakAllowed=!1),m.initialized=!0,m}function E(e){for(var t,r=0,n=e.length;r<n&&(t=e.charCodeAt(r))>=32&&t<=127;)r++;return r<n?e.replace(d," "):e}function _(e,t){return v.loadFont(e,t,i).then((function(e){C.font=e.font,C.fontMatrix=e.font.fontMatrix||n.FONT_IDENTITY_MATRIX}))}function R(e){for(var t=C.font,r=x(),n=0,i=0,o=t.charsToGlyphs(e),a=0;a<o.length;a++){var s=o[a],l=null;l=t.vertical&&s.vmetric?s.vmetric[0]:s.width;var u=s.unicode,h=(0,c.getNormalizedUnicodes)();void 0!==h[u]&&(u=h[u]),u=(0,c.reverseIfRtl)(u);var d=C.charSpacing;if(s.isSpace){var f=C.wordSpacing;d+=f,f>0&&O(f,r.str)}var g=0,p=0;t.vertical?i+=p=l*C.fontMatrix[0]*C.fontSize+d:n+=g=(l*C.fontMatrix[0]*C.fontSize+d)*C.textHScale,C.translateTextMatrix(g,p),r.str.push(u)}return t.vertical?(r.lastAdvanceHeight=i,r.height+=Math.abs(i)):(r.lastAdvanceWidth=n,r.width+=n),r}function O(e,t){if(!(e<m.fakeSpaceMin))if(e<m.fakeMultiSpaceMin)t.push(" ");else for(var r=Math.round(e/m.spaceWidth);r-- >0;)t.push(" ")}function P(){m.initialized&&(m.vertical?m.height*=m.textAdvanceScale:m.width*=m.textAdvanceScale,f.items.push(function(e){var t=e.str.join(""),r=(0,p.bidi)(t,-1,e.vertical);return{str:s?E(r.str):r.str,dir:r.dir,width:e.width,height:e.height,transform:e.transform,fontName:e.fontName}}(m)),m.initialized=!1,m.str.length=0)}function D(){const e=f.items.length;e>0&&(u.enqueue(f,e),f.items=[],f.styles=Object.create(null))}var F=new A;return new Promise((function e(t,c){const d=function(r){D(),Promise.all([r,u.ready]).then((function(){try{e(t,c)}catch(r){c(r)}}),c)};r.ensureNotTerminated(),F.reset();for(var g,p={},E=[];!(g=F.check())&&(E.length=0,p.args=E,k.read(p));){C=a.state;var A,I=p.fn;switch(E=p.args,0|I){case n.OPS.setFont:var N=E[0].name,L=E[1];if(C.font&&N===C.fontName&&L===C.fontSize)break;return P(),C.fontName=N,C.fontSize=L,void d(_(N,null));case n.OPS.setTextRise:P(),C.textRise=E[0];break;case n.OPS.setHScale:P(),C.textHScale=E[0]/100;break;case n.OPS.setLeading:P(),C.leading=E[0];break;case n.OPS.moveText:var H=!!C.font&&0===(C.font.vertical?E[0]:E[1]);if(A=E[0]-E[1],l&&H&&m.initialized&&A>0&&A<=m.fakeMultiSpaceMax){C.translateTextLineMatrix(E[0],E[1]),m.width+=E[0]-m.lastAdvanceWidth,m.height+=E[1]-m.lastAdvanceHeight,O(E[0]-m.lastAdvanceWidth-(E[1]-m.lastAdvanceHeight),m.str);break}P(),C.translateTextLineMatrix(E[0],E[1]),C.textMatrix=C.textLineMatrix.slice();break;case n.OPS.setLeadingMoveText:P(),C.leading=-E[1],C.translateTextLineMatrix(E[0],E[1]),C.textMatrix=C.textLineMatrix.slice();break;case n.OPS.nextLine:P(),C.carriageReturn();break;case n.OPS.setTextMatrix:if(A=C.calcTextLineMatrixAdvance(E[0],E[1],E[2],E[3],E[4],E[5]),l&&null!==A&&m.initialized&&A.value>0&&A.value<=m.fakeMultiSpaceMax){C.translateTextLineMatrix(A.width,A.height),m.width+=A.width-m.lastAdvanceWidth,m.height+=A.height-m.lastAdvanceHeight,O(A.width-m.lastAdvanceWidth-(A.height-m.lastAdvanceHeight),m.str);break}P(),C.setTextMatrix(E[0],E[1],E[2],E[3],E[4],E[5]),C.setTextLineMatrix(E[0],E[1],E[2],E[3],E[4],E[5]);break;case n.OPS.setCharSpacing:C.charSpacing=E[0];break;case n.OPS.setWordSpacing:C.wordSpacing=E[0];break;case n.OPS.beginText:P(),C.textMatrix=n.IDENTITY_MATRIX.slice(),C.textLineMatrix=n.IDENTITY_MATRIX.slice();break;case n.OPS.showSpacedText:if(!a.state.font){v.ensureStateFont(a.state);continue}for(var B,U=E[0],j=0,W=U.length;j<W;j++)if("string"===typeof U[j])R(U[j]);else if((0,n.isNum)(U[j])){x(),A=U[j]*C.fontSize/1e3;var V=!1;C.font.vertical?(B=A,C.translateTextMatrix(0,B),(V=m.textRunBreakAllowed&&A>m.fakeMultiSpaceMax)||(m.height+=B)):(B=(A=-A)*C.textHScale,C.translateTextMatrix(B,0),(V=m.textRunBreakAllowed&&A>m.fakeMultiSpaceMax)||(m.width+=B)),V?P():A>0&&O(A,m.str)}break;case n.OPS.showText:if(!a.state.font){v.ensureStateFont(a.state);continue}R(E[0]);break;case n.OPS.nextLineShowText:if(!a.state.font){v.ensureStateFont(a.state);continue}P(),C.carriageReturn(),R(E[0]);break;case n.OPS.nextLineSetSpacingShowText:if(!a.state.font){v.ensureStateFont(a.state);continue}P(),C.wordSpacing=E[0],C.charSpacing=E[1],C.carriageReturn(),R(E[2]);break;case n.OPS.paintXObject:P(),y||(y=i.get("XObject")||o.Dict.empty);var z=E[0].name;if(z&&w.getByName(z))break;return void d(new Promise((function(e,t){if(!z)throw new n.FormatError("XObject must be referred to by name.");let c=y.getRaw(z);if(c instanceof o.Ref){if(w.getByRef(c))return void e();c=b.fetch(c)}if(!(0,o.isStream)(c))throw new n.FormatError("XObject should be a stream");const d=c.dict.get("Subtype");if(!(0,o.isName)(d))throw new n.FormatError("XObject should have a Name subtype");if("Form"!==d.name)return w.set(z,c.dict.objId,!0),void e();const f=a.state.clone(),g=new M(f),p=c.dict.getArray("Matrix");Array.isArray(p)&&6===p.length&&g.transform(p),D();const m={enqueueInvoked:!1,enqueue(e,t){this.enqueueInvoked=!0,u.enqueue(e,t)},get desiredSize(){return u.desiredSize},get ready(){return u.ready}};v.getTextContent({stream:c,task:r,resources:c.dict.get("Resources")||i,stateManager:g,normalizeWhitespace:s,combineTextItems:l,sink:m,seenStyles:h}).then((function(){m.enqueueInvoked||w.set(z,c.dict.objId,!0),e()}),t)})).catch((function(e){if(!(e instanceof n.AbortException)){if(!v.options.ignoreErrors)throw e;(0,n.warn)(`getTextContent - ignoring XObject: "${e}".`)}})));case n.OPS.setGState:if((z=E[0].name)&&S.getByName(z))break;return void d(new Promise((function(e,t){if(!z)throw new n.FormatError("GState must be referred to by name.");const r=i.get("ExtGState");if(!(r instanceof o.Dict))throw new n.FormatError("ExtGState should be a dictionary.");const a=r.get(z);if(!(a instanceof o.Dict))throw new n.FormatError("GState should be a dictionary.");const s=a.get("Font");if(!s)return S.set(z,a.objId,!0),void e();P(),C.fontName=null,C.fontSize=s[1],_(null,s[0]).then(e,t)})).catch((function(e){if(!(e instanceof n.AbortException)){if(!v.options.ignoreErrors)throw e;(0,n.warn)(`getTextContent - ignoring ExtGState: "${e}".`)}})))}if(f.items.length>=u.desiredSize){g=!0;break}}g?d(T):(P(),D(),t())})).catch((e=>{if(!(e instanceof n.AbortException)){if(this.options.ignoreErrors)return(0,n.warn)(`getTextContent - ignoring errors during "${r.name}" task: "${e}".`),P(),void D();throw e}}))}extractDataStructures(e,t,r){const i=this.xref;let l;var c=e.get("ToUnicode")||t.get("ToUnicode"),u=c?this.readToUnicode(c):Promise.resolve(void 0);if(r.composite){var h=e.get("CIDSystemInfo");(0,o.isDict)(h)&&(r.cidSystemInfo={registry:(0,n.stringToPDFString)(h.get("Registry")),ordering:(0,n.stringToPDFString)(h.get("Ordering")),supplement:h.get("Supplement")});var d=e.get("CIDToGIDMap");(0,o.isStream)(d)&&(l=d.getBytes())}var f,g=[],p=null;if(e.has("Encoding")){if(f=e.get("Encoding"),(0,o.isDict)(f)){if(p=f.get("BaseEncoding"),p=(0,o.isName)(p)?p.name:null,f.has("Differences"))for(var m=f.get("Differences"),v=0,b=0,y=m.length;b<y;b++){var w=i.fetchIfRef(m[b]);if((0,n.isNum)(w))v=w;else{if(!(0,o.isName)(w))throw new n.FormatError(`Invalid entry in 'Differences' array: ${w}`);g[v++]=w.name}}}else{if(!(0,o.isName)(f))throw new n.FormatError("Encoding is not a Name nor a Dict");p=f.name}"MacRomanEncoding"!==p&&"MacExpertEncoding"!==p&&"WinAnsiEncoding"!==p&&(p=null)}if(p)r.defaultEncoding=(0,s.getEncoding)(p).slice();else{var S=!!(r.flags&a.FontFlags.Symbolic),C=!!(r.flags&a.FontFlags.Nonsymbolic);f=s.StandardEncoding,"TrueType"!==r.type||C||(f=s.WinAnsiEncoding),S&&(f=s.MacRomanEncoding,r.file||(/Symbol/i.test(r.name)?f=s.SymbolSetEncoding:/Dingbats|Wingdings/i.test(r.name)&&(f=s.ZapfDingbatsEncoding))),r.defaultEncoding=f}return r.differences=g,r.baseEncodingName=p,r.hasEncoding=!!p||g.length>0,r.dict=e,u.then((e=>(r.toUnicode=e,this.buildToUnicode(r)))).then((e=>(r.toUnicode=e,l&&(r.cidToGidMap=this.readCidToGidMap(l,e)),r)))}_buildSimpleFontToUnicode(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];(0,n.assert)(!e.composite,"Must be a simple font.");const r=[],i=e.defaultEncoding.slice(),o=e.baseEncodingName,l=e.differences;for(const n in l){const e=l[n];".notdef"!==e&&(i[n]=e)}const u=(0,b.getGlyphsUnicode)();for(const n in i){let a=i[n];if(""!==a)if(void 0!==u[a])r[n]=String.fromCharCode(u[a]);else{let i=0;switch(a[0]){case"G":3===a.length&&(i=parseInt(a.substring(1),16));break;case"g":5===a.length&&(i=parseInt(a.substring(1),16));break;case"C":case"c":if(a.length>=3&&a.length<=4){const r=a.substring(1);if(t){i=parseInt(r,16);break}if(i=+r,Number.isNaN(i)&&Number.isInteger(parseInt(r,16)))return this._buildSimpleFontToUnicode(e,!0)}break;default:const r=(0,c.getUnicodeForGlyph)(a,u);-1!==r&&(i=r)}if(i>0&&i<=1114111&&Number.isInteger(i)){if(o&&i===+n){const e=(0,s.getEncoding)(o);if(e&&(a=e[n])){r[n]=String.fromCharCode(u[a]);continue}}r[n]=String.fromCodePoint(i)}}}return new a.ToUnicodeMap(r)}buildToUnicode(e){if(e.hasIncludedToUnicodeMap=!!e.toUnicode&&e.toUnicode.length>0,e.hasIncludedToUnicodeMap)return!e.composite&&e.hasEncoding&&(e.fallbackToUnicode=this._buildSimpleFontToUnicode(e)),Promise.resolve(e.toUnicode);if(!e.composite)return Promise.resolve(this._buildSimpleFontToUnicode(e));if(e.composite&&(e.cMap.builtInCMap&&!(e.cMap instanceof i.IdentityCMap)||"Adobe"===e.cidSystemInfo.registry&&("GB1"===e.cidSystemInfo.ordering||"CNS1"===e.cidSystemInfo.ordering||"Japan1"===e.cidSystemInfo.ordering||"Korea1"===e.cidSystemInfo.ordering))){const t=e.cidSystemInfo.registry,r=e.cidSystemInfo.ordering,s=o.Name.get(t+"-"+r+"-UCS2");return i.CMapFactory.create({encoding:s,fetchBuiltInCMap:this._fetchBuiltInCMapBound,useCMap:null}).then((function(t){const r=e.cMap,i=[];return r.forEach((function(e,r){if(r>65535)throw new n.FormatError("Max size of CID is 65,535");const o=t.lookup(r);o&&(i[e]=String.fromCharCode((o.charCodeAt(0)<<8)+o.charCodeAt(1)))})),new a.ToUnicodeMap(i)}))}return Promise.resolve(new a.IdentityToUnicodeMap(e.firstChar,e.lastChar))}readToUnicode(e){var t=e;return(0,o.isName)(t)?i.CMapFactory.create({encoding:t,fetchBuiltInCMap:this._fetchBuiltInCMapBound,useCMap:null}).then((function(e){return e instanceof i.IdentityCMap?new a.IdentityToUnicodeMap(0,65535):new a.ToUnicodeMap(e.getMap())})):(0,o.isStream)(t)?i.CMapFactory.create({encoding:t,fetchBuiltInCMap:this._fetchBuiltInCMapBound,useCMap:null}).then((function(e){if(e instanceof i.IdentityCMap)return new a.IdentityToUnicodeMap(0,65535);var t=new Array(e.length);return e.forEach((function(e,r){for(var n=[],i=0;i<r.length;i+=2){var o=r.charCodeAt(i)<<8|r.charCodeAt(i+1);if(55296===(63488&o)){i+=2;var a=r.charCodeAt(i)<<8|r.charCodeAt(i+1);n.push(((1023&o)<<10)+(1023&a)+65536)}else n.push(o)}t[e]=String.fromCodePoint.apply(String,n)})),new a.ToUnicodeMap(t)}),(e=>{if(e instanceof n.AbortException)return null;if(this.options.ignoreErrors)return this.handler.send("UnsupportedFeature",{featureId:n.UNSUPPORTED_FEATURES.errorFontToUnicode}),(0,n.warn)(`readToUnicode - ignoring ToUnicode data: "${e}".`),null;throw e})):Promise.resolve(null)}readCidToGidMap(e,t){for(var r=[],n=0,i=e.length;n<i;n++){var o=e[n++]<<8|e[n];const i=n>>1;(0!==o||t.has(i))&&(r[i]=o)}return r}extractWidths(e,t,r){var n,i,s,l,c,u,h,d,f=this.xref,g=[],p=0,m=[];if(r.composite){if(p=e.has("DW")?e.get("DW"):1e3,d=e.get("W"))for(i=0,s=d.length;i<s;i++)if(u=f.fetchIfRef(d[i++]),h=f.fetchIfRef(d[i]),Array.isArray(h))for(l=0,c=h.length;l<c;l++)g[u++]=f.fetchIfRef(h[l]);else{var v=f.fetchIfRef(d[++i]);for(l=u;l<=h;l++)g[l]=v}if(r.vertical){var b=e.getArray("DW2")||[880,-1e3];if(n=[b[1],.5*p,b[0]],b=e.get("W2"))for(i=0,s=b.length;i<s;i++)if(u=f.fetchIfRef(b[i++]),h=f.fetchIfRef(b[i]),Array.isArray(h))for(l=0,c=h.length;l<c;l++)m[u++]=[f.fetchIfRef(h[l++]),f.fetchIfRef(h[l++]),f.fetchIfRef(h[l])];else{var y=[f.fetchIfRef(b[++i]),f.fetchIfRef(b[++i]),f.fetchIfRef(b[++i])];for(l=u;l<=h;l++)m[l]=y}}}else{var w=r.firstChar;if(d=e.get("Widths")){for(l=w,i=0,s=d.length;i<s;i++)g[l++]=f.fetchIfRef(d[i]);p=parseFloat(t.get("MissingWidth"))||0}else{var S=e.get("BaseFont");if((0,o.isName)(S)){var C=this.getBaseFontMetrics(S.name);g=this.buildCharCodeToWidth(C.widths,r),p=C.defaultWidth}}}var k=!0,x=p;for(var E in g){var T=g[E];if(T)if(x){if(x!==T){k=!1;break}}else x=T}k&&(r.flags|=a.FontFlags.FixedPitch),r.defaultWidth=p,r.widths=g,r.defaultVMetrics=n,r.vmetrics=m}isSerifFont(e){var t=e.split("-")[0];return t in(0,u.getSerifFonts)()||-1!==t.search(/serif/gi)}getBaseFontMetrics(e){var t=0,r=[],i=!1,o=(0,u.getStdFontMap)()[e]||e,a=(0,y.getMetrics)();o in a||(o=this.isSerifFont(e)?"Times-Roman":"Helvetica");var s=a[o];return(0,n.isNum)(s)?(t=s,i=!0):r=s(),{defaultWidth:t,monospace:i,widths:r}}buildCharCodeToWidth(e,t){for(var r=Object.create(null),n=t.differences,i=t.defaultEncoding,o=0;o<256;o++)o in n&&e[n[o]]?r[o]=e[n[o]]:o in i&&e[i[o]]&&(r[o]=e[i[o]]);return r}preEvaluateFont(e){var t=e,r=e.get("Subtype");if(!(0,o.isName)(r))throw new n.FormatError("invalid font Subtype");var i,a=!1;if("Type0"===r.name){var s=e.get("DescendantFonts");if(!s)throw new n.FormatError("Descendant fonts are not specified");if(r=(e=Array.isArray(s)?this.xref.fetchIfRef(s[0]):s).get("Subtype"),!(0,o.isName)(r))throw new n.FormatError("invalid font Subtype");a=!0}var l=e.get("FontDescriptor");if(l){var c=new w.MurmurHash3_64,u=t.getRaw("Encoding");if((0,o.isName)(u))c.update(u.name);else if((0,o.isRef)(u))c.update(u.toString());else if((0,o.isDict)(u))for(const e of u.getRawValues())if((0,o.isName)(e))c.update(e.name);else if((0,o.isRef)(e))c.update(e.toString());else if(Array.isArray(e)){for(var h=e.length,d=new Array(h),f=0;f<h;f++){var g=e[f];(0,o.isName)(g)?d[f]=g.name:((0,n.isNum)(g)||(0,o.isRef)(g))&&(d[f]=g.toString())}c.update(d.join())}const r=e.get("FirstChar")||0,s=e.get("LastChar")||(a?65535:255);c.update(`${r}-${s}`);var p=e.get("ToUnicode")||t.get("ToUnicode");if((0,o.isStream)(p)){var m=p.str||p;i=m.buffer?new Uint8Array(m.buffer.buffer,0,m.bufferLength):new Uint8Array(m.bytes.buffer,m.start,m.end-m.start),c.update(i)}else(0,o.isName)(p)&&c.update(p.name);var v=e.get("Widths")||t.get("Widths");v&&(i=new Uint8Array(new Uint32Array(v).buffer),c.update(i))}return{descriptor:l,dict:e,baseDict:t,composite:a,type:r.name,hash:c?c.hexdigest():""}}translateFont(e){var t,r=e.baseDict,s=e.dict,l=e.composite,c=e.descriptor,h=e.type,d=l?65535:255;const f=s.get("FirstChar")||0,g=s.get("LastChar")||d;if(!c){if("Type3"!==h){var p=s.get("BaseFont");if(!(0,o.isName)(p))throw new n.FormatError("Base font is not specified");p=p.name.replace(/[,_]/g,"-");var m=this.getBaseFontMetrics(p),v=p.split("-")[0],b=(this.isSerifFont(v)?a.FontFlags.Serif:0)|(m.monospace?a.FontFlags.FixedPitch:0)|((0,u.getSymbolsFonts)()[v]?a.FontFlags.Symbolic:a.FontFlags.Nonsymbolic);t={type:h,name:p,widths:m.widths,defaultWidth:m.defaultWidth,flags:b,firstChar:f,lastChar:g};const e=s.get("Widths");return this.extractDataStructures(s,s,t).then((t=>{if(e){const r=[];let n=f;for(let t=0,i=e.length;t<i;t++)r[n++]=this.xref.fetchIfRef(e[t]);t.widths=r}else t.widths=this.buildCharCodeToWidth(m.widths,t);return new a.Font(p,null,t)}))}(c=new o.Dict(null)).set("FontName",o.Name.get(h)),c.set("FontBBox",s.getArray("FontBBox")||[0,0,0,0])}var y=c.get("FontName"),w=s.get("BaseFont");if((0,n.isString)(y)&&(y=o.Name.get(y)),(0,n.isString)(w)&&(w=o.Name.get(w)),"Type3"!==h){var S=y&&y.name,C=w&&w.name;S!==C&&((0,n.info)(`The FontDescriptor's FontName is "${S}" but should be the same as the Font's BaseFont "${C}".`),S&&C&&C.startsWith(S)&&(y=w))}if(y=y||w,!(0,o.isName)(y))throw new n.FormatError("invalid font name");var k,x=c.get("FontFile","FontFile2","FontFile3");if(x&&x.dict){var E=x.dict.get("Subtype");E&&(E=E.name);var T=x.dict.get("Length1"),_=x.dict.get("Length2"),A=x.dict.get("Length3")}if(t={type:h,name:y.name,subtype:E,file:x,length1:T,length2:_,length3:A,loadedName:r.loadedName,composite:l,fixedPitch:!1,fontMatrix:s.getArray("FontMatrix")||n.FONT_IDENTITY_MATRIX,firstChar:f||0,lastChar:g||d,bbox:c.getArray("FontBBox"),ascent:c.get("Ascent"),descent:c.get("Descent"),xHeight:c.get("XHeight"),capHeight:c.get("CapHeight"),flags:c.get("Flags"),italicAngle:c.get("ItalicAngle"),isType3Font:!1},l){var R=r.get("Encoding");(0,o.isName)(R)&&(t.cidEncoding=R.name),k=i.CMapFactory.create({encoding:R,fetchBuiltInCMap:this._fetchBuiltInCMapBound,useCMap:null}).then((function(e){t.cMap=e,t.vertical=t.cMap.vertical}))}else k=Promise.resolve(void 0);return k.then((()=>this.extractDataStructures(s,r,t))).then((e=>(this.extractWidths(s,c,e),"Type3"===h&&(e.isType3Font=!0),new a.Font(y.name,x,e))))}static buildFontPaths(e,t,r){function n(t){e.renderer.hasBuiltPath(t)||r.send("commonobj",[`${e.loadedName}_path_${t}`,"FontPath",e.renderer.getPathJs(t)])}for(const i of t){n(i.fontChar);const e=i.accent;e&&e.fontChar&&n(e.fontChar)}}static get fallbackFontDict(){const e=new o.Dict;return e.set("BaseFont",o.Name.get("PDFJS-FallbackFont")),e.set("Type",o.Name.get("FallbackType")),e.set("Subtype",o.Name.get("FallbackType")),e.set("Encoding",o.Name.get("WinAnsiEncoding")),(0,n.shadow)(this,"fallbackFontDict",e)}}t.PartialEvaluator=R;class O{constructor(e){let{loadedName:t,font:r,dict:n,extraProperties:i=!1}=e;this.loadedName=t,this.font=r,this.dict=n,this._extraProperties=i,this.type3Loaded=null,this.type3Dependencies=r.isType3Font?new Set:null,this.sent=!1}send(e){this.sent||(this.sent=!0,e.send("commonobj",[this.loadedName,"Font",this.font.exportData(this._extraProperties)]))}fallback(e){if(!this.font.data)return;this.font.disableFontFace=!0;const t=this.font.glyphCacheValues;R.buildFontPaths(this.font,t,e)}loadType3Data(e,t,r){if(this.type3Loaded)return this.type3Loaded;if(!this.font.isType3Font)throw new Error("Must be a Type3 font.");var i=Object.create(e.options);i.ignoreErrors=!1;var o=e.clone(i);o.parsingType3Font=!0;const a=this.font,s=this.type3Dependencies;var l=Promise.resolve(),c=this.dict.get("CharProcs"),u=this.dict.get("Resources")||t,h=Object.create(null);for(const d of c.getKeys())l=l.then((function(){var e=c.get(d),t=new S.OperatorList;return o.getOperatorList({stream:e,task:r,resources:u,operatorList:t}).then((function(){h[d]=t.getIR();for(const e of t.dependencies)s.add(e)})).catch((function(e){(0,n.warn)(`Type3 font resource "${d}" is not available.`);const t=new S.OperatorList;h[d]=t.getIR()}))}));return this.type3Loaded=l.then((function(){a.charProcOperatorList=h})),this.type3Loaded}}class M{constructor(e){this.state=e,this.stateStack=[]}save(){var e=this.state;this.stateStack.push(this.state),this.state=e.clone()}restore(){var e=this.stateStack.pop();e&&(this.state=e)}transform(e){this.state.ctm=n.Util.transform(this.state.ctm,e)}}class I{constructor(){this.ctm=new Float32Array(n.IDENTITY_MATRIX),this.fontName=null,this.fontSize=0,this.font=null,this.fontMatrix=n.FONT_IDENTITY_MATRIX,this.textMatrix=n.IDENTITY_MATRIX.slice(),this.textLineMatrix=n.IDENTITY_MATRIX.slice(),this.charSpacing=0,this.wordSpacing=0,this.leading=0,this.textHScale=1,this.textRise=0}setTextMatrix(e,t,r,n,i,o){var a=this.textMatrix;a[0]=e,a[1]=t,a[2]=r,a[3]=n,a[4]=i,a[5]=o}setTextLineMatrix(e,t,r,n,i,o){var a=this.textLineMatrix;a[0]=e,a[1]=t,a[2]=r,a[3]=n,a[4]=i,a[5]=o}translateTextMatrix(e,t){var r=this.textMatrix;r[4]=r[0]*e+r[2]*t+r[4],r[5]=r[1]*e+r[3]*t+r[5]}translateTextLineMatrix(e,t){var r=this.textLineMatrix;r[4]=r[0]*e+r[2]*t+r[4],r[5]=r[1]*e+r[3]*t+r[5]}calcTextLineMatrixAdvance(e,t,r,n,i,o){var a=this.font;if(!a)return null;var s=this.textLineMatrix;if(e!==s[0]||t!==s[1]||r!==s[2]||n!==s[3])return null;var l=i-s[4],c=o-s[5];if(a.vertical&&0!==l||!a.vertical&&0!==c)return null;var u,h,d=e*n-t*r;return a.vertical?(u=-c*r/d,h=c*e/d):(u=l*n/d,h=-l*t/d),{width:u,height:h,value:a.vertical?h:u}}calcRenderMatrix(e){var t=[this.fontSize*this.textHScale,0,0,this.fontSize,0,this.textRise];return n.Util.transform(e,n.Util.transform(this.textMatrix,t))}carriageReturn(){this.translateTextLineMatrix(0,-this.leading),this.textMatrix=this.textLineMatrix.slice()}clone(){var e=Object.create(this);return e.textMatrix=this.textMatrix.slice(),e.textLineMatrix=this.textLineMatrix.slice(),e.fontMatrix=this.fontMatrix.slice(),e}}class P{constructor(){this.ctm=new Float32Array(n.IDENTITY_MATRIX),this.font=null,this.textRenderingMode=n.TextRenderingMode.FILL,this.fillColorSpace=m.ColorSpace.singletons.gray,this.strokeColorSpace=m.ColorSpace.singletons.gray}clone(){return Object.create(this)}}class N{static get opMap(){const e=(0,l.getLookupTableFactory)((function(e){e.w={id:n.OPS.setLineWidth,numArgs:1,variableArgs:!1},e.J={id:n.OPS.setLineCap,numArgs:1,variableArgs:!1},e.j={id:n.OPS.setLineJoin,numArgs:1,variableArgs:!1},e.M={id:n.OPS.setMiterLimit,numArgs:1,variableArgs:!1},e.d={id:n.OPS.setDash,numArgs:2,variableArgs:!1},e.ri={id:n.OPS.setRenderingIntent,numArgs:1,variableArgs:!1},e.i={id:n.OPS.setFlatness,numArgs:1,variableArgs:!1},e.gs={id:n.OPS.setGState,numArgs:1,variableArgs:!1},e.q={id:n.OPS.save,numArgs:0,variableArgs:!1},e.Q={id:n.OPS.restore,numArgs:0,variableArgs:!1},e.cm={id:n.OPS.transform,numArgs:6,variableArgs:!1},e.m={id:n.OPS.moveTo,numArgs:2,variableArgs:!1},e.l={id:n.OPS.lineTo,numArgs:2,variableArgs:!1},e.c={id:n.OPS.curveTo,numArgs:6,variableArgs:!1},e.v={id:n.OPS.curveTo2,numArgs:4,variableArgs:!1},e.y={id:n.OPS.curveTo3,numArgs:4,variableArgs:!1},e.h={id:n.OPS.closePath,numArgs:0,variableArgs:!1},e.re={id:n.OPS.rectangle,numArgs:4,variableArgs:!1},e.S={id:n.OPS.stroke,numArgs:0,variableArgs:!1},e.s={id:n.OPS.closeStroke,numArgs:0,variableArgs:!1},e.f={id:n.OPS.fill,numArgs:0,variableArgs:!1},e.F={id:n.OPS.fill,numArgs:0,variableArgs:!1},e["f*"]={id:n.OPS.eoFill,numArgs:0,variableArgs:!1},e.B={id:n.OPS.fillStroke,numArgs:0,variableArgs:!1},e["B*"]={id:n.OPS.eoFillStroke,numArgs:0,variableArgs:!1},e.b={id:n.OPS.closeFillStroke,numArgs:0,variableArgs:!1},e["b*"]={id:n.OPS.closeEOFillStroke,numArgs:0,variableArgs:!1},e.n={id:n.OPS.endPath,numArgs:0,variableArgs:!1},e.W={id:n.OPS.clip,numArgs:0,variableArgs:!1},e["W*"]={id:n.OPS.eoClip,numArgs:0,variableArgs:!1},e.BT={id:n.OPS.beginText,numArgs:0,variableArgs:!1},e.ET={id:n.OPS.endText,numArgs:0,variableArgs:!1},e.Tc={id:n.OPS.setCharSpacing,numArgs:1,variableArgs:!1},e.Tw={id:n.OPS.setWordSpacing,numArgs:1,variableArgs:!1},e.Tz={id:n.OPS.setHScale,numArgs:1,variableArgs:!1},e.TL={id:n.OPS.setLeading,numArgs:1,variableArgs:!1},e.Tf={id:n.OPS.setFont,numArgs:2,variableArgs:!1},e.Tr={id:n.OPS.setTextRenderingMode,numArgs:1,variableArgs:!1},e.Ts={id:n.OPS.setTextRise,numArgs:1,variableArgs:!1},e.Td={id:n.OPS.moveText,numArgs:2,variableArgs:!1},e.TD={id:n.OPS.setLeadingMoveText,numArgs:2,variableArgs:!1},e.Tm={id:n.OPS.setTextMatrix,numArgs:6,variableArgs:!1},e["T*"]={id:n.OPS.nextLine,numArgs:0,variableArgs:!1},e.Tj={id:n.OPS.showText,numArgs:1,variableArgs:!1},e.TJ={id:n.OPS.showSpacedText,numArgs:1,variableArgs:!1},e["'"]={id:n.OPS.nextLineShowText,numArgs:1,variableArgs:!1},e['"']={id:n.OPS.nextLineSetSpacingShowText,numArgs:3,variableArgs:!1},e.d0={id:n.OPS.setCharWidth,numArgs:2,variableArgs:!1},e.d1={id:n.OPS.setCharWidthAndBounds,numArgs:6,variableArgs:!1},e.CS={id:n.OPS.setStrokeColorSpace,numArgs:1,variableArgs:!1},e.cs={id:n.OPS.setFillColorSpace,numArgs:1,variableArgs:!1},e.SC={id:n.OPS.setStrokeColor,numArgs:4,variableArgs:!0},e.SCN={id:n.OPS.setStrokeColorN,numArgs:33,variableArgs:!0},e.sc={id:n.OPS.setFillColor,numArgs:4,variableArgs:!0},e.scn={id:n.OPS.setFillColorN,numArgs:33,variableArgs:!0},e.G={id:n.OPS.setStrokeGray,numArgs:1,variableArgs:!1},e.g={id:n.OPS.setFillGray,numArgs:1,variableArgs:!1},e.RG={id:n.OPS.setStrokeRGBColor,numArgs:3,variableArgs:!1},e.rg={id:n.OPS.setFillRGBColor,numArgs:3,variableArgs:!1},e.K={id:n.OPS.setStrokeCMYKColor,numArgs:4,variableArgs:!1},e.k={id:n.OPS.setFillCMYKColor,numArgs:4,variableArgs:!1},e.sh={id:n.OPS.shadingFill,numArgs:1,variableArgs:!1},e.BI={id:n.OPS.beginInlineImage,numArgs:0,variableArgs:!1},e.ID={id:n.OPS.beginImageData,numArgs:0,variableArgs:!1},e.EI={id:n.OPS.endInlineImage,numArgs:1,variableArgs:!1},e.Do={id:n.OPS.paintXObject,numArgs:1,variableArgs:!1},e.MP={id:n.OPS.markPoint,numArgs:1,variableArgs:!1},e.DP={id:n.OPS.markPointProps,numArgs:2,variableArgs:!1},e.BMC={id:n.OPS.beginMarkedContent,numArgs:1,variableArgs:!1},e.BDC={id:n.OPS.beginMarkedContentProps,numArgs:2,variableArgs:!1},e.EMC={id:n.OPS.endMarkedContent,numArgs:0,variableArgs:!1},e.BX={id:n.OPS.beginCompat,numArgs:0,variableArgs:!1},e.EX={id:n.OPS.endCompat,numArgs:0,variableArgs:!1},e.BM=null,e.BD=null,e.true=null,e.fa=null,e.fal=null,e.fals=null,e.false=null,e.nu=null,e.nul=null,e.null=null}));return(0,n.shadow)(this,"opMap",e())}static get MAX_INVALID_PATH_OPS(){return(0,n.shadow)(this,"MAX_INVALID_PATH_OPS",20)}constructor(e,t,r){this.parser=new f.Parser({lexer:new f.Lexer(e,N.opMap),xref:t}),this.stateManager=r,this.nonProcessedArgs=[],this._numInvalidPathOPS=0}get savedStatesDepth(){return this.stateManager.stateStack.length}read(e){for(var t=e.args;;){var r=this.parser.getObj();if(r instanceof o.Cmd){var i=r.cmd,a=N.opMap[i];if(!a){(0,n.warn)(`Unknown command "${i}".`);continue}var s=a.id,l=a.numArgs,c=null!==t?t.length:0;if(a.variableArgs)c>l&&(0,n.info)(`Command ${i}: expected [0, ${l}] args, but received ${c} args.`);else{if(c!==l){for(var u=this.nonProcessedArgs;c>l;)u.push(t.shift()),c--;for(;c<l&&0!==u.length;)null===t&&(t=[]),t.unshift(u.pop()),c++}if(c<l){const e=`command ${i}: expected ${l} args, but received ${c} args.`;if(s>=n.OPS.moveTo&&s<=n.OPS.endPath&&++this._numInvalidPathOPS>N.MAX_INVALID_PATH_OPS)throw new n.FormatError(`Invalid ${e}`);(0,n.warn)(`Skipping ${e}`),null!==t&&(t.length=0);continue}}return this.preprocessCommand(s,t),e.fn=s,e.args=t,!0}if(r===o.EOF)return!1;if(null!==r&&(null===t&&(t=[]),t.push(r),t.length>33))throw new n.FormatError("Too many arguments")}}preprocessCommand(e,t){switch(0|e){case n.OPS.save:this.stateManager.save();break;case n.OPS.restore:this.stateManager.restore();break;case n.OPS.transform:this.stateManager.transform(t)}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CMapFactory=t.IdentityCMap=t.CMap=void 0;var n=r(2),i=r(5),o=r(11),a=r(8),s=r(12),l=["Adobe-GB1-UCS2","Adobe-CNS1-UCS2","Adobe-Japan1-UCS2","Adobe-Korea1-UCS2","78-EUC-H","78-EUC-V","78-H","78-RKSJ-H","78-RKSJ-V","78-V","78ms-RKSJ-H","78ms-RKSJ-V","83pv-RKSJ-H","90ms-RKSJ-H","90ms-RKSJ-V","90msp-RKSJ-H","90msp-RKSJ-V","90pv-RKSJ-H","90pv-RKSJ-V","Add-H","Add-RKSJ-H","Add-RKSJ-V","Add-V","Adobe-CNS1-0","Adobe-CNS1-1","Adobe-CNS1-2","Adobe-CNS1-3","Adobe-CNS1-4","Adobe-CNS1-5","Adobe-CNS1-6","Adobe-GB1-0","Adobe-GB1-1","Adobe-GB1-2","Adobe-GB1-3","Adobe-GB1-4","Adobe-GB1-5","Adobe-Japan1-0","Adobe-Japan1-1","Adobe-Japan1-2","Adobe-Japan1-3","Adobe-Japan1-4","Adobe-Japan1-5","Adobe-Japan1-6","Adobe-Korea1-0","Adobe-Korea1-1","Adobe-Korea1-2","B5-H","B5-V","B5pc-H","B5pc-V","CNS-EUC-H","CNS-EUC-V","CNS1-H","CNS1-V","CNS2-H","CNS2-V","ETHK-B5-H","ETHK-B5-V","ETen-B5-H","ETen-B5-V","ETenms-B5-H","ETenms-B5-V","EUC-H","EUC-V","Ext-H","Ext-RKSJ-H","Ext-RKSJ-V","Ext-V","GB-EUC-H","GB-EUC-V","GB-H","GB-V","GBK-EUC-H","GBK-EUC-V","GBK2K-H","GBK2K-V","GBKp-EUC-H","GBKp-EUC-V","GBT-EUC-H","GBT-EUC-V","GBT-H","GBT-V","GBTpc-EUC-H","GBTpc-EUC-V","GBpc-EUC-H","GBpc-EUC-V","H","HKdla-B5-H","HKdla-B5-V","HKdlb-B5-H","HKdlb-B5-V","HKgccs-B5-H","HKgccs-B5-V","HKm314-B5-H","HKm314-B5-V","HKm471-B5-H","HKm471-B5-V","HKscs-B5-H","HKscs-B5-V","Hankaku","Hiragana","KSC-EUC-H","KSC-EUC-V","KSC-H","KSC-Johab-H","KSC-Johab-V","KSC-V","KSCms-UHC-H","KSCms-UHC-HW-H","KSCms-UHC-HW-V","KSCms-UHC-V","KSCpc-EUC-H","KSCpc-EUC-V","Katakana","NWP-H","NWP-V","RKSJ-H","RKSJ-V","Roman","UniCNS-UCS2-H","UniCNS-UCS2-V","UniCNS-UTF16-H","UniCNS-UTF16-V","UniCNS-UTF32-H","UniCNS-UTF32-V","UniCNS-UTF8-H","UniCNS-UTF8-V","UniGB-UCS2-H","UniGB-UCS2-V","UniGB-UTF16-H","UniGB-UTF16-V","UniGB-UTF32-H","UniGB-UTF32-V","UniGB-UTF8-H","UniGB-UTF8-V","UniJIS-UCS2-H","UniJIS-UCS2-HW-H","UniJIS-UCS2-HW-V","UniJIS-UCS2-V","UniJIS-UTF16-H","UniJIS-UTF16-V","UniJIS-UTF32-H","UniJIS-UTF32-V","UniJIS-UTF8-H","UniJIS-UTF8-V","UniJIS2004-UTF16-H","UniJIS2004-UTF16-V","UniJIS2004-UTF32-H","UniJIS2004-UTF32-V","UniJIS2004-UTF8-H","UniJIS2004-UTF8-V","UniJISPro-UCS2-HW-V","UniJISPro-UCS2-V","UniJISPro-UTF8-V","UniJISX0213-UTF32-H","UniJISX0213-UTF32-V","UniJISX02132004-UTF32-H","UniJISX02132004-UTF32-V","UniKS-UCS2-H","UniKS-UCS2-V","UniKS-UTF16-H","UniKS-UTF16-V","UniKS-UTF32-H","UniKS-UTF32-V","UniKS-UTF8-H","UniKS-UTF8-V","V","WP-Symbol"];const c=2**24-1;class u{constructor(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.codespaceRanges=[[],[],[],[]],this.numCodespaceRanges=0,this._map=[],this.name="",this.vertical=!1,this.useCMap=null,this.builtInCMap=e}addCodespaceRange(e,t,r){this.codespaceRanges[e-1].push(t,r),this.numCodespaceRanges++}mapCidRange(e,t,r){if(t-e>c)throw new Error("mapCidRange - ignoring data above MAX_MAP_RANGE.");for(;e<=t;)this._map[e++]=r++}mapBfRange(e,t,r){if(t-e>c)throw new Error("mapBfRange - ignoring data above MAX_MAP_RANGE.");for(var n=r.length-1;e<=t;)this._map[e++]=r,r=r.substring(0,n)+String.fromCharCode(r.charCodeAt(n)+1)}mapBfRangeToArray(e,t,r){if(t-e>c)throw new Error("mapBfRangeToArray - ignoring data above MAX_MAP_RANGE.");const n=r.length;let i=0;for(;e<=t&&i<n;)this._map[e]=r[i++],++e}mapOne(e,t){this._map[e]=t}lookup(e){return this._map[e]}contains(e){return void 0!==this._map[e]}forEach(e){const t=this._map,r=t.length;if(r<=65536)for(let n=0;n<r;n++)void 0!==t[n]&&e(n,t[n]);else for(const n in t)e(n,t[n])}charCodeOf(e){const t=this._map;if(t.length<=65536)return t.indexOf(e);for(const r in t)if(t[r]===e)return 0|r;return-1}getMap(){return this._map}readCharCode(e,t,r){let n=0;const i=this.codespaceRanges;for(let o=0,a=i.length;o<a;o++){n=(n<<8|e.charCodeAt(t+o))>>>0;const a=i[o];for(let e=0,t=a.length;e<t;){const t=a[e++],i=a[e++];if(n>=t&&n<=i)return r.charcode=n,void(r.length=o+1)}}r.charcode=0,r.length=1}get length(){return this._map.length}get isIdentityCMap(){if("Identity-H"!==this.name&&"Identity-V"!==this.name)return!1;if(65536!==this._map.length)return!1;for(let e=0;e<65536;e++)if(this._map[e]!==e)return!1;return!0}}t.CMap=u;class h extends u{constructor(e,t){super(),this.vertical=e,this.addCodespaceRange(t,0,65535)}mapCidRange(e,t,r){(0,n.unreachable)("should not call mapCidRange")}mapBfRange(e,t,r){(0,n.unreachable)("should not call mapBfRange")}mapBfRangeToArray(e,t,r){(0,n.unreachable)("should not call mapBfRangeToArray")}mapOne(e,t){(0,n.unreachable)("should not call mapCidOne")}lookup(e){return Number.isInteger(e)&&e<=65535?e:void 0}contains(e){return Number.isInteger(e)&&e<=65535}forEach(e){for(let t=0;t<=65535;t++)e(t,t)}charCodeOf(e){return Number.isInteger(e)&&e<=65535?e:-1}getMap(){const e=new Array(65536);for(let t=0;t<=65535;t++)e[t]=t;return e}get length(){return 65536}get isIdentityCMap(){(0,n.unreachable)("should not access .isIdentityCMap")}}t.IdentityCMap=h;var d=function(){function e(e,t){for(var r=0,n=0;n<=t;n++)r=r<<8|e[n];return r>>>0}function t(e,t){return 1===t?String.fromCharCode(e[0],e[1]):3===t?String.fromCharCode(e[0],e[1],e[2],e[3]):String.fromCharCode.apply(null,e.subarray(0,t+1))}function r(e,t,r){for(var n=0,i=r;i>=0;i--)n+=e[i]+t[i],e[i]=255&n,n>>=8}function i(e,t){for(var r=1,n=t;n>=0&&r>0;n--)r+=e[n],e[n]=255&r,r>>=8}var o=16,a=19;function s(e){this.buffer=e,this.pos=0,this.end=e.length,this.tmpBuf=new Uint8Array(a)}function l(){}return s.prototype={readByte(){return this.pos>=this.end?-1:this.buffer[this.pos++]},readNumber(){var e,t=0;do{var r=this.readByte();if(r<0)throw new n.FormatError("unexpected EOF in bcmap");e=!(128&r),t=t<<7|127&r}while(!e);return t},readSigned(){var e=this.readNumber();return 1&e?~(e>>>1):e>>>1},readHex(e,t){e.set(this.buffer.subarray(this.pos,this.pos+t+1)),this.pos+=t+1},readHexNumber(e,t){var r,i=this.tmpBuf,o=0;do{var a=this.readByte();if(a<0)throw new n.FormatError("unexpected EOF in bcmap");r=!(128&a),i[o++]=127&a}while(!r);for(var s=t,l=0,c=0;s>=0;){for(;c<8&&i.length>0;)l=i[--o]<<c|l,c+=7;e[s]=255&l,s--,l>>=8,c-=8}},readHexSigned(e,t){this.readHexNumber(e,t);for(var r=1&e[t]?255:0,n=0,i=0;i<=t;i++)n=(1&n)<<8|e[i],e[i]=n>>1^r},readString(){for(var e=this.readNumber(),t="",r=0;r<e;r++)t+=String.fromCharCode(this.readNumber());return t}},l.prototype={process:function(n,a,l){return new Promise((function(c,u){var h=new s(n),d=h.readByte();a.vertical=!!(1&d);for(var f,g,p=null,m=new Uint8Array(o),v=new Uint8Array(o),b=new Uint8Array(o),y=new Uint8Array(o),w=new Uint8Array(o);(g=h.readByte())>=0;){var S=g>>5;if(7!==S){var C=!!(16&g),k=15&g;if(k+1>o)throw new Error("processBinaryCMap: Invalid dataSize.");var x,E=h.readNumber();switch(S){case 0:for(h.readHex(m,k),h.readHexNumber(v,k),r(v,m,k),a.addCodespaceRange(k+1,e(m,k),e(v,k)),x=1;x<E;x++)i(v,k),h.readHexNumber(m,k),r(m,v,k),h.readHexNumber(v,k),r(v,m,k),a.addCodespaceRange(k+1,e(m,k),e(v,k));break;case 1:for(h.readHex(m,k),h.readHexNumber(v,k),r(v,m,k),h.readNumber(),x=1;x<E;x++)i(v,k),h.readHexNumber(m,k),r(m,v,k),h.readHexNumber(v,k),r(v,m,k),h.readNumber();break;case 2:for(h.readHex(b,k),f=h.readNumber(),a.mapOne(e(b,k),f),x=1;x<E;x++)i(b,k),C||(h.readHexNumber(w,k),r(b,w,k)),f=h.readSigned()+(f+1),a.mapOne(e(b,k),f);break;case 3:for(h.readHex(m,k),h.readHexNumber(v,k),r(v,m,k),f=h.readNumber(),a.mapCidRange(e(m,k),e(v,k),f),x=1;x<E;x++)i(v,k),C?m.set(v):(h.readHexNumber(m,k),r(m,v,k)),h.readHexNumber(v,k),r(v,m,k),f=h.readNumber(),a.mapCidRange(e(m,k),e(v,k),f);break;case 4:for(h.readHex(b,1),h.readHex(y,k),a.mapOne(e(b,1),t(y,k)),x=1;x<E;x++)i(b,1),C||(h.readHexNumber(w,1),r(b,w,1)),i(y,k),h.readHexSigned(w,k),r(y,w,k),a.mapOne(e(b,1),t(y,k));break;case 5:for(h.readHex(m,1),h.readHexNumber(v,1),r(v,m,1),h.readHex(y,k),a.mapBfRange(e(m,1),e(v,1),t(y,k)),x=1;x<E;x++)i(v,1),C?m.set(v):(h.readHexNumber(m,1),r(m,v,1)),h.readHexNumber(v,1),r(v,m,1),h.readHex(y,k),a.mapBfRange(e(m,1),e(v,1),t(y,k));break;default:return void u(new Error("processBinaryCMap: Unknown type: "+S))}}else switch(31&g){case 0:h.readString();break;case 1:p=h.readString()}}c(p?l(p):a)}))}},l}(),f=function(){function e(e){for(var t=0,r=0;r<e.length;r++)t=t<<8|e.charCodeAt(r);return t>>>0}function t(e){if(!(0,n.isString)(e))throw new n.FormatError("Malformed CMap: expected string.")}function r(e){if(!Number.isInteger(e))throw new n.FormatError("Malformed CMap: expected int.")}function c(r,n){for(;;){var o=n.getObj();if((0,i.isEOF)(o))break;if((0,i.isCmd)(o,"endbfchar"))return;t(o);var a=e(o);t(o=n.getObj());var s=o;r.mapOne(a,s)}}function f(r,o){for(;;){var a=o.getObj();if((0,i.isEOF)(a))break;if((0,i.isCmd)(a,"endbfrange"))return;t(a);var s=e(a);t(a=o.getObj());var l=e(a);if(a=o.getObj(),Number.isInteger(a)||(0,n.isString)(a)){var c=Number.isInteger(a)?String.fromCharCode(a):a;r.mapBfRange(s,l,c)}else{if(!(0,i.isCmd)(a,"["))break;a=o.getObj();for(var u=[];!(0,i.isCmd)(a,"]")&&!(0,i.isEOF)(a);)u.push(a),a=o.getObj();r.mapBfRangeToArray(s,l,u)}}throw new n.FormatError("Invalid bf range.")}function g(n,o){for(;;){var a=o.getObj();if((0,i.isEOF)(a))break;if((0,i.isCmd)(a,"endcidchar"))return;t(a);var s=e(a);r(a=o.getObj());var l=a;n.mapOne(s,l)}}function p(n,o){for(;;){var a=o.getObj();if((0,i.isEOF)(a))break;if((0,i.isCmd)(a,"endcidrange"))return;t(a);var s=e(a);t(a=o.getObj());var l=e(a);r(a=o.getObj());var c=a;n.mapCidRange(s,l,c)}}function m(t,r){for(;;){var o=r.getObj();if((0,i.isEOF)(o))break;if((0,i.isCmd)(o,"endcodespacerange"))return;if(!(0,n.isString)(o))break;var a=e(o);if(o=r.getObj(),!(0,n.isString)(o))break;var s=e(o);t.addCodespaceRange(o.length,a,s)}throw new n.FormatError("Invalid codespace range.")}function v(e,t){var r=t.getObj();Number.isInteger(r)&&(e.vertical=!!r)}function b(e,t){var r=t.getObj();(0,i.isName)(r)&&(0,n.isString)(r.name)&&(e.name=r.name)}function y(e,t,r,o){var s,l;e:for(;;)try{var u=t.getObj();if((0,i.isEOF)(u))break;if((0,i.isName)(u))"WMode"===u.name?v(e,t):"CMapName"===u.name&&b(e,t),s=u;else if((0,i.isCmd)(u))switch(u.cmd){case"endcmap":break e;case"usecmap":(0,i.isName)(s)&&(l=s.name);break;case"begincodespacerange":m(e,t);break;case"beginbfchar":c(e,t);break;case"begincidchar":g(e,t);break;case"beginbfrange":f(e,t);break;case"begincidrange":p(e,t)}}catch(h){if(h instanceof a.MissingDataException)throw h;(0,n.warn)("Invalid cMap data: "+h);continue}return!o&&l&&(o=l),o?w(e,r,o):Promise.resolve(e)}function w(e,t,r){return S(r,t).then((function(t){if(e.useCMap=t,0===e.numCodespaceRanges){for(var r=e.useCMap.codespaceRanges,n=0;n<r.length;n++)e.codespaceRanges[n]=r[n].slice();e.numCodespaceRanges=e.useCMap.numCodespaceRanges}return e.useCMap.forEach((function(t,r){e.contains(t)||e.mapOne(t,e.useCMap.lookup(t))})),e}))}function S(e,t){return"Identity-H"===e?Promise.resolve(new h(!1,2)):"Identity-V"===e?Promise.resolve(new h(!0,2)):l.includes(e)?t?t(e).then((function(e){var r=e.cMapData,i=e.compressionType,a=new u(!0);if(i===n.CMapCompressionType.BINARY)return(new d).process(r,a,(function(e){return w(a,t,e)}));if(i===n.CMapCompressionType.NONE){var l=new o.Lexer(new s.Stream(r));return y(a,l,t,null)}return Promise.reject(new Error("TODO: Only BINARY/NONE CMap compression is currently supported."))})):Promise.reject(new Error("Built-in CMap parameters are not provided.")):Promise.reject(new Error("Unknown CMap name: "+e))}return{async create(e){var t=e.encoding,r=e.fetchBuiltInCMap,n=e.useCMap;if((0,i.isName)(t))return S(t.name,r);if((0,i.isStream)(t))return y(new u,new o.Lexer(t),r,n).then((function(e){return e.isIdentityCMap?S(e.name,r):e}));throw new Error("Encoding required.")}}}();t.CMapFactory=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getFontType=C,t.IdentityToUnicodeMap=t.ToUnicodeMap=t.FontFlags=t.Font=t.ErrorFont=t.SEAC_ANALYSIS_ENABLED=void 0;var n=r(2),i=r(32),o=r(35),a=r(34),s=r(36),l=r(37),c=r(8),u=r(38),h=r(30),d=r(12),f=r(39);const g=[[57344,63743],[1048576,1114109]];var p=1e3,m=!0;t.SEAC_ANALYSIS_ENABLED=m;const v=["ascent","bbox","black","bold","charProcOperatorList","composite","data","defaultVMetrics","defaultWidth","descent","fallbackName","fontMatrix","fontType","isMonospace","isSerifFont","isType3Font","italic","loadedName","mimetype","missingFile","name","remeasure","subtype","type","vertical"],b=["cMap","defaultEncoding","differences","isSymbolicFont","seacMap","toFontChar","toUnicode","vmetrics","widths"];var y={FixedPitch:1,Serif:2,Symbolic:4,Script:8,Nonsymbolic:32,Italic:64,AllCap:65536,SmallCap:131072,ForceBold:262144};t.FontFlags=y;var w=[".notdef",".null","nonmarkingreturn","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quotesingle","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","grave","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","Adieresis","Aring","Ccedilla","Eacute","Ntilde","Odieresis","Udieresis","aacute","agrave","acircumflex","adieresis","atilde","aring","ccedilla","eacute","egrave","ecircumflex","edieresis","iacute","igrave","icircumflex","idieresis","ntilde","oacute","ograve","ocircumflex","odieresis","otilde","uacute","ugrave","ucircumflex","udieresis","dagger","degree","cent","sterling","section","bullet","paragraph","germandbls","registered","copyright","trademark","acute","dieresis","notequal","AE","Oslash","infinity","plusminus","lessequal","greaterequal","yen","mu","partialdiff","summation","product","pi","integral","ordfeminine","ordmasculine","Omega","ae","oslash","questiondown","exclamdown","logicalnot","radical","florin","approxequal","Delta","guillemotleft","guillemotright","ellipsis","nonbreakingspace","Agrave","Atilde","Otilde","OE","oe","endash","emdash","quotedblleft","quotedblright","quoteleft","quoteright","divide","lozenge","ydieresis","Ydieresis","fraction","currency","guilsinglleft","guilsinglright","fi","fl","daggerdbl","periodcentered","quotesinglbase","quotedblbase","perthousand","Acircumflex","Ecircumflex","Aacute","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Oacute","Ocircumflex","apple","Ograve","Uacute","Ucircumflex","Ugrave","dotlessi","circumflex","tilde","macron","breve","dotaccent","ring","cedilla","hungarumlaut","ogonek","caron","Lslash","lslash","Scaron","scaron","Zcaron","zcaron","brokenbar","Eth","eth","Yacute","yacute","Thorn","thorn","minus","multiply","onesuperior","twosuperior","threesuperior","onehalf","onequarter","threequarters","franc","Gbreve","gbreve","Idotaccent","Scedilla","scedilla","Cacute","cacute","Ccaron","ccaron","dcroat"];function S(e){if(e.fontMatrix&&e.fontMatrix[0]!==n.FONT_IDENTITY_MATRIX[0]){var t=.001/e.fontMatrix[0],r=e.widths;for(var i in r)r[i]*=t;e.defaultWidth*=t}}function C(e,t){switch(e){case"Type1":return"Type1C"===t?n.FontType.TYPE1C:n.FontType.TYPE1;case"CIDFontType0":return"CIDFontType0C"===t?n.FontType.CIDFONTTYPE0C:n.FontType.CIDFONTTYPE0;case"OpenType":return n.FontType.OPENTYPE;case"TrueType":return n.FontType.TRUETYPE;case"CIDFontType2":return n.FontType.CIDFONTTYPE2;case"MMType1":return n.FontType.MMTYPE1;case"Type0":return n.FontType.TYPE0;default:return n.FontType.UNKNOWN}}function k(e,t){if(void 0!==t[e])return e;var r=(0,l.getUnicodeForGlyph)(e,t);if(-1!==r)for(var i in t)if(t[i]===r)return i;return(0,n.info)("Unable to recover a standard glyph name for: "+e),e}var x=function(){function e(e,t,r,n,i,o,a,s){this.fontChar=e,this.unicode=t,this.accent=r,this.width=n,this.vmetric=i,this.operatorListId=o,this.isSpace=a,this.isInFont=s}return e.prototype.matchesForCache=function(e,t,r,n,i,o,a,s){return this.fontChar===e&&this.unicode===t&&this.accent===r&&this.width===n&&this.vmetric===i&&this.operatorListId===o&&this.isSpace===a&&this.isInFont===s},e}(),E=function(){function e(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this._map=e}return e.prototype={get length(){return this._map.length},forEach(e){for(var t in this._map)e(t,this._map[t].charCodeAt(0))},has(e){return void 0!==this._map[e]},get(e){return this._map[e]},charCodeOf(e){const t=this._map;if(t.length<=65536)return t.indexOf(e);for(const r in t)if(t[r]===e)return 0|r;return-1},amend(e){for(var t in e)this._map[t]=e[t]}},e}();t.ToUnicodeMap=E;var T=function(){function e(e,t){this.firstChar=e,this.lastChar=t}return e.prototype={get length(){return this.lastChar+1-this.firstChar},forEach(e){for(var t=this.firstChar,r=this.lastChar;t<=r;t++)e(t,t)},has(e){return this.firstChar<=e&&e<=this.lastChar},get(e){if(this.firstChar<=e&&e<=this.lastChar)return String.fromCharCode(e)},charCodeOf(e){return Number.isInteger(e)&&e>=this.firstChar&&e<=this.lastChar?e:-1},amend(e){(0,n.unreachable)("Should not call amend()")}},e}();t.IdentityToUnicodeMap=T;var _=function(){function e(e,t,r){e[t]=r>>8&255,e[t+1]=255&r}function t(e,t,r){e[t]=r>>24&255,e[t+1]=r>>16&255,e[t+2]=r>>8&255,e[t+3]=255&r}function r(e,t,r){var n,i;if(r instanceof Uint8Array)e.set(r,t);else if("string"===typeof r)for(n=0,i=r.length;n<i;n++)e[t++]=255&r.charCodeAt(n);else for(n=0,i=r.length;n<i;n++)e[t++]=255&r[n]}function i(e){this.sfnt=e,this.tables=Object.create(null)}return i.getSearchParams=function(e,t){for(var r=1,n=0;(r^e)>r;)r<<=1,n++;var i=r*t;return{range:i,entry:n,rangeShift:t*e-i}},i.prototype={toArray:function(){var o=this.sfnt,a=this.tables,s=Object.keys(a);s.sort();var l,u,h,d,f,g=s.length,p=12+16*g,m=[p];for(l=0;l<g;l++)p+=((d=a[s[l]]).length+3&-4)>>>0,m.push(p);var v=new Uint8Array(p);for(l=0;l<g;l++)d=a[s[l]],r(v,m[l],d);"true"===o&&(o=(0,n.string32)(65536)),v[0]=255&o.charCodeAt(0),v[1]=255&o.charCodeAt(1),v[2]=255&o.charCodeAt(2),v[3]=255&o.charCodeAt(3),e(v,4,g);var b=i.getSearchParams(g,16);for(e(v,6,b.range),e(v,8,b.entry),e(v,10,b.rangeShift),p=12,l=0;l<g;l++){f=s[l],v[p]=255&f.charCodeAt(0),v[p+1]=255&f.charCodeAt(1),v[p+2]=255&f.charCodeAt(2),v[p+3]=255&f.charCodeAt(3);var y=0;for(u=m[l],h=m[l+1];u<h;u+=4)y=y+(0,c.readUint32)(v,u)>>>0;t(v,p+4,y),t(v,p+8,m[l]),t(v,p+12,a[f].length),p+=16}return v},addTable:function(e,t){if(e in this.tables)throw new Error("Table "+e+" already exists");this.tables[e]=t}},i}(),A=function(){function e(e,t,r){var i;this.name=e,this.loadedName=r.loadedName,this.isType3Font=r.isType3Font,this.missingFile=!1,this.glyphCache=Object.create(null),this.isSerifFont=!!(r.flags&y.Serif),this.isSymbolicFont=!!(r.flags&y.Symbolic),this.isMonospace=!!(r.flags&y.FixedPitch);var o=r.type,a=r.subtype;this.type=o,this.subtype=a;let s="sans-serif";if(this.isMonospace?s="monospace":this.isSerifFont&&(s="serif"),this.fallbackName=s,this.differences=r.differences,this.widths=r.widths,this.defaultWidth=r.defaultWidth,this.composite=r.composite,this.cMap=r.cMap,this.ascent=r.ascent/p,this.descent=r.descent/p,this.fontMatrix=r.fontMatrix,this.bbox=r.bbox,this.defaultEncoding=r.defaultEncoding,this.toUnicode=r.toUnicode,this.fallbackToUnicode=r.fallbackToUnicode||new E,this.toFontChar=[],"Type3"!==r.type){if(this.cidEncoding=r.cidEncoding,this.vertical=!!r.vertical,this.vertical&&(this.vmetrics=r.vmetrics,this.defaultVMetrics=r.defaultVMetrics),!t||t.isEmpty)return t&&(0,n.warn)('Font file is empty in "'+e+'" ('+this.loadedName+")"),void this.fallbackToSystemFont();[o,a]=function(e,t){let r,i,{type:o,subtype:a,composite:s}=t;return function(e){var t=e.peekBytes(4);return 65536===(0,c.readUint32)(t,0)||"true"===(0,n.bytesToString)(t)}(e)||R(e)?r=s?"CIDFontType2":"TrueType":function(e){var t=e.peekBytes(4);return"OTTO"===(0,n.bytesToString)(t)}(e)?r=s?"CIDFontType2":"OpenType":function(e){var t=e.peekBytes(2);return 37===t[0]&&33===t[1]||128===t[0]&&1===t[1]}(e)?r=s?"CIDFontType0":"MMType1"===o?"MMType1":"Type1":function(e){const t=e.peekBytes(4);return t[0]>=1&&t[3]>=1&&t[3]<=4}(e)?s?(r="CIDFontType0",i="CIDFontType0C"):(r="MMType1"===o?"MMType1":"Type1",i="Type1C"):((0,n.warn)("getFontFileType: Unable to detect correct font file Type/Subtype."),r=o,i=a),[r,i]}(t,r),o===this.type&&a===this.subtype||(0,n.info)(`Inconsistent font file Type/SubType, expected: ${this.type}/${this.subtype} but found: ${o}/${a}.`);try{var l;switch(o){case"MMType1":(0,n.info)("MMType1 font ("+e+"), falling back to Type1.");case"Type1":case"CIDFontType0":this.mimetype="font/opentype";var u="Type1C"===a||"CIDFontType0C"===a?new I(t,r):new M(e,t,r);S(r),l=this.convert(e,u,r);break;case"OpenType":case"TrueType":case"CIDFontType2":this.mimetype="font/opentype",l=this.checkAndRepair(e,t,r),this.isOpenType&&(S(r),o="OpenType");break;default:throw new n.FormatError(`Font ${o} is not supported`)}}catch(h){return(0,n.warn)(h),void this.fallbackToSystemFont()}this.data=l,this.fontType=C(o,a),this.fontMatrix=r.fontMatrix,this.widths=r.widths,this.defaultWidth=r.defaultWidth,this.toUnicode=r.toUnicode,this.seacMap=r.seacMap}else{for(i=0;i<256;i++)this.toFontChar[i]=this.differences[i]||r.defaultEncoding[i];this.fontType=n.FontType.TYPE3}}function t(e,t){return(e<<8)+t}function r(e,t){var r=(e<<8)+t;return 32768&r?r-65536:r}function f(e){return String.fromCharCode(e>>8&255,255&e)}function A(e){return e>32767?e=32767:e<-32768&&(e=-32768),String.fromCharCode(e>>8&255,255&e)}function R(e){const t=e.peekBytes(4);return"ttcf"===(0,n.bytesToString)(t)}function O(e,t,r){for(var n,i=[],o=0,a=e.length;o<a;o++)-1!==(n=(0,l.getUnicodeForGlyph)(e[o],t))&&(i[o]=n);for(var s in r)-1!==(n=(0,l.getUnicodeForGlyph)(r[s],t))&&(i[+s]=n);return i}function P(e,t,r){var i=Object.create(null),o=[],a=0,s=g[a][0],l=g[a][1];for(var c in e){var u=e[c|=0];if(t(u)){if(s>l){if(++a>=g.length){(0,n.warn)("Ran out of space in font private use area.");break}s=g[a][0],l=g[a][1]}var h=s++;0===u&&(u=r),i[h]=u,o[c]=h}}return{toFontChar:o,charCodeToGlyphId:i,nextAvailableFontCharCode:s}}function N(e,t){var r,i,o,a,s=function(e,t){var r=[];for(var n in e)e[n]>=t||r.push({fontCharCode:0|n,glyphId:e[n]});0===r.length&&r.push({fontCharCode:0,glyphId:0}),r.sort((function(e,t){return e.fontCharCode-t.fontCharCode}));for(var i=[],o=r.length,a=0;a<o;){var s=r[a].fontCharCode,l=[r[a].glyphId];++a;for(var c=s;a<o&&c+1===r[a].fontCharCode&&(l.push(r[a].glyphId),++a,65535!==++c););i.push([s,c,l])}return i}(e,t),l=s[s.length-1][1]>65535?2:1,c="\0\0"+f(l)+"\0\x03\0\x01"+(0,n.string32)(4+8*l);for(r=s.length-1;r>=0&&!(s[r][0]<=65535);--r);var u=r+1;s[r][0]<65535&&65535===s[r][1]&&(s[r][1]=65534);var h,d,g,p,m=s[r][1]<65535?1:0,v=u+m,b=_.getSearchParams(v,2),y="",w="",S="",C="",k="",x=0;for(r=0,i=u;r<i;r++){d=(h=s[r])[0],g=h[1],y+=f(d),w+=f(g);var E=!0;for(o=1,a=(p=h[2]).length;o<a;++o)if(p[o]!==p[o-1]+1){E=!1;break}if(E)S+=f(p[0]-d&65535),C+=f(0);else{var T=2*(v-r)+2*x;for(x+=g-d+1,S+=f(0),C+=f(T),o=0,a=p.length;o<a;++o)k+=f(p[o])}}m>0&&(w+="\xff\xff",y+="\xff\xff",S+="\0\x01",C+="\0\0");var A="\0\0"+f(2*v)+f(b.range)+f(b.entry)+f(b.rangeShift)+w+"\0\0"+y+S+C+k,R="",O="";if(l>1){for(c+="\0\x03\0\n"+(0,n.string32)(4+8*l+4+A.length),R="",r=0,i=s.length;r<i;r++){d=(h=s[r])[0];var M=(p=h[2])[0];for(o=1,a=p.length;o<a;++o)p[o]!==p[o-1]+1&&(g=h[0]+o-1,R+=(0,n.string32)(d)+(0,n.string32)(g)+(0,n.string32)(M),d=g+1,M=p[o]);R+=(0,n.string32)(d)+(0,n.string32)(h[1])+(0,n.string32)(M)}O="\0\f\0\0"+(0,n.string32)(R.length+16)+"\0\0\0\0"+(0,n.string32)(R.length/12)}return c+"\0\x04"+f(A.length+4)+A+O+R}function D(e,t,r){r=r||{unitsPerEm:0,yMax:0,yMin:0,ascent:0,descent:0};var i=0,o=0,a=0,s=0,c=null,u=0;if(t){for(var h in t){(c>(h|=0)||!c)&&(c=h),u<h&&(u=h);var d=(0,l.getUnicodeRangeFor)(h);if(d<32)i|=1<<d;else if(d<64)o|=1<<d-32;else if(d<96)a|=1<<d-64;else{if(!(d<123))throw new n.FormatError("Unicode ranges Bits > 123 are reserved for internal usage");s|=1<<d-96}}u>65535&&(u=65535)}else c=0,u=255;var g=e.bbox||[0,0,0,0],m=r.unitsPerEm||1/(e.fontMatrix||n.FONT_IDENTITY_MATRIX)[0],v=e.ascentScaled?1:m/p,b=r.ascent||Math.round(v*(e.ascent||g[3])),y=r.descent||Math.round(v*(e.descent||g[1]));y>0&&e.descent>0&&g[1]<0&&(y=-y);var w=r.yMax||b,S=-r.yMin||-y;return"\0\x03\x02$\x01\xf4\0\x05\0\0\x02\x8a\x02\xbb\0\0\0\x8c\x02\x8a\x02\xbb\0\0\x01\xdf\x001\x01\x02\0\0\0\0\x06"+String.fromCharCode(e.fixedPitch?9:0)+"\0\0\0\0\0\0"+(0,n.string32)(i)+(0,n.string32)(o)+(0,n.string32)(a)+(0,n.string32)(s)+"*21*"+f(e.italicAngle?1:0)+f(c||e.firstChar)+f(u||e.lastChar)+f(b)+f(y)+"\0d"+f(w)+f(S)+"\0\0\0\0\0\0\0\0"+f(e.xHeight)+f(e.capHeight)+f(0)+f(c||e.firstChar)+"\0\x03"}function F(e){var t=Math.floor(65536*e.italicAngle);return"\0\x03\0\0"+(0,n.string32)(t)+"\0\0\0\0"+(0,n.string32)(e.fixedPitch)+"\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0"}function L(e,t){t||(t=[[],[]]);var r,n,i,o,a,s=[t[0][0]||"Original licence",t[0][1]||e,t[0][2]||"Unknown",t[0][3]||"uniqueID",t[0][4]||e,t[0][5]||"Version 0.11",t[0][6]||"",t[0][7]||"Unknown",t[0][8]||"Unknown",t[0][9]||"Unknown"],l=[];for(r=0,n=s.length;r<n;r++){var c=[];for(i=0,o=(a=t[1][r]||s[r]).length;i<o;i++)c.push(f(a.charCodeAt(i)));l.push(c.join(""))}var u=[s,l],h=["\0\x01","\0\x03"],d=["\0\0","\0\x01"],g=["\0\0","\x04\t"],p=s.length*h.length,m="\0\0"+f(p)+f(12*p+6),v=0;for(r=0,n=h.length;r<n;r++){var b=u[r];for(i=0,o=b.length;i<o;i++)a=b[i],m+=h[r]+d[r]+g[r]+f(i)+f(a.length)+f(v),v+=a.length}return m+=s.join("")+l.join("")}return e.prototype={name:null,font:null,mimetype:null,disableFontFace:!1,get renderer(){var e=u.FontRendererFactory.create(this,m);return(0,n.shadow)(this,"renderer",e)},exportData(){const e=arguments.length>0&&void 0!==arguments[0]&&arguments[0]?[...v,...b]:v,t=Object.create(null);let r,n;for(r of e)n=this[r],void 0!==n&&(t[r]=n);return t},fallbackToSystemFont:function(){this.missingFile=!0;var e=this.name,t=this.type,r=this.subtype;let i=e.replace(/[,_]/g,"-").replace(/\s/g,"");var c=(0,s.getStdFontMap)(),u=(0,s.getNonStdFontMap)(),h=!!c[i]||!(!u[i]||!c[u[i]]);if(i=c[i]||u[i]||i,this.bold=-1!==i.search(/bold/gi),this.italic=-1!==i.search(/oblique/gi)||-1!==i.search(/italic/gi),this.black=-1!==e.search(/Black/g),this.remeasure=Object.keys(this.widths).length>0,h&&"CIDFontType2"===t&&this.cidEncoding.startsWith("Identity-")){const t=(0,s.getGlyphMapForStandardFonts)(),r=[];for(const e in t)r[+e]=t[e];if(/Arial-?Black/i.test(e)){var d=(0,s.getSupplementalGlyphMapForArialBlack)();for(const e in d)r[+e]=d[e]}else if(/Calibri/i.test(e)){const e=(0,s.getSupplementalGlyphMapForCalibri)();for(const t in e)r[+t]=e[t]}this.toUnicode instanceof T||this.toUnicode.forEach((function(e,t){r[+e]=t})),this.toFontChar=r,this.toUnicode=new E(r)}else if(/Symbol/i.test(i))this.toFontChar=O(a.SymbolSetEncoding,(0,o.getGlyphsUnicode)(),this.differences);else if(/Dingbats/i.test(i))/Wingdings/i.test(e)&&(0,n.warn)("Non-embedded Wingdings font, falling back to ZapfDingbats."),this.toFontChar=O(a.ZapfDingbatsEncoding,(0,o.getDingbatsGlyphsUnicode)(),this.differences);else if(h)this.toFontChar=O(this.defaultEncoding,(0,o.getGlyphsUnicode)(),this.differences);else{const t=(0,o.getGlyphsUnicode)(),r=[];if(this.toUnicode.forEach(((e,n)=>{if(!this.composite){var i=this.differences[e]||this.defaultEncoding[e];const r=(0,l.getUnicodeForGlyph)(i,t);-1!==r&&(n=r)}r[+e]=n})),this.composite&&this.toUnicode instanceof T&&/Verdana/i.test(e)){const e=(0,s.getGlyphMapForStandardFonts)();for(const t in e)r[+t]=e[t]}this.toFontChar=r}this.loadedName=i.split("-")[0],this.fontType=C(t,r)},checkAndRepair:function(e,s,l){const c=["OS/2","cmap","head","hhea","hmtx","maxp","name","post","loca","glyf","fpgm","prep","cvt ","CFF "];function u(e,t){const r=Object.create(null);r["OS/2"]=null,r.cmap=null,r.head=null,r.hhea=null,r.hmtx=null,r.maxp=null,r.name=null,r.post=null;for(let n=0;n<t;n++){const t=f(e);c.includes(t.tag)&&0!==t.length&&(r[t.tag]=t)}return r}function f(e){var t=(0,n.bytesToString)(e.getBytes(4)),r=e.getInt32()>>>0,i=e.getInt32()>>>0,o=e.getInt32()>>>0,a=e.pos;e.pos=e.start?e.start:0,e.skip(i);var s=e.getBytes(o);return e.pos=a,"head"===t&&(s[8]=s[9]=s[10]=s[11]=0,s[17]|=32),{tag:t,checksum:r,length:o,offset:i,data:s}}function g(e){return{version:(0,n.bytesToString)(e.getBytes(4)),numTables:e.getUint16(),searchRange:e.getUint16(),entrySelector:e.getUint16(),rangeShift:e.getUint16()}}function p(e,t,n,i,o,a){var s={length:0,sizeOfInstructions:0};if(n-t<=12)return s;var l,c,u,h=e.subarray(t,n),d=r(h[0],h[1]);if(d<0)return u=d=-1,(l=h)[1+(c=0)]=u,l[c]=u>>>8,i.set(h,o),s.length=h.length,s;var f,g=10,p=0;for(f=0;f<d;f++)p=1+(h[g]<<8|h[g+1]),g+=2;var m=g,v=h[g]<<8|h[g+1];s.sizeOfInstructions=v;var b=g+=2+v,y=0;for(f=0;f<p;f++){var w=h[g++];192&w&&(h[g-1]=63&w);let e=2;2&w?e=1:16&w&&(e=0);let t=2;4&w?t=1:32&w&&(t=0);const r=e+t;if(y+=r,8&w){var S=h[g++];f+=S,y+=S*r}}if(0===y)return s;var C=g+y;return C>h.length?s:!a&&v>0?(i.set(h.subarray(0,m),o),i.set([0,0],o+m),i.set(h.subarray(b,C),o+m+2),C-=v,h.length-C>3&&(C=C+3&-4),s.length=C,s):h.length-C>3?(C=C+3&-4,i.set(h.subarray(0,C),o),s.length=C,s):(i.set(h,o),s.length=h.length,s)}function v(e){var t=(s.start?s.start:0)+e.offset;s.pos=t;var r=[[],[]],i=e.length,o=t+i;if(0!==s.getUint16()||i<6)return r;var a,l,c=s.getUint16(),u=s.getUint16(),h=[];for(a=0;a<c&&s.pos+12<=o;a++){var d={platform:s.getUint16(),encoding:s.getUint16(),language:s.getUint16(),name:s.getUint16(),length:s.getUint16(),offset:s.getUint16()};(1===d.platform&&0===d.encoding&&0===d.language||3===d.platform&&1===d.encoding&&1033===d.language)&&h.push(d)}for(a=0,l=h.length;a<l;a++){var f=h[a];if(!(f.length<=0)){var g=t+u+f.offset;if(!(g+f.length>o)){s.pos=g;var p=f.name;if(f.encoding){for(var m="",v=0,b=f.length;v<b;v+=2)m+=String.fromCharCode(s.getUint16());r[1][p]=m}else r[0][p]=(0,n.bytesToString)(s.getBytes(f.length))}}}return r}var b=[0,0,0,0,0,0,0,0,-2,-2,-2,-2,0,0,-2,-5,-1,-1,-1,-1,-1,-1,-1,-1,0,0,-1,0,-1,-1,-1,-1,1,-1,-999,0,1,0,-1,-2,0,-1,-2,-1,-1,0,-1,-1,0,0,-999,-999,-1,-1,-1,-1,-2,-999,-2,-2,-999,0,-2,-2,0,0,-2,0,-2,0,0,0,-2,-1,-1,1,1,0,0,-1,-1,-1,-1,-1,-1,-1,0,0,-1,0,-1,-1,0,-999,-1,-1,-1,-1,-1,-1,0,0,0,0,0,0,0,0,0,0,0,0,-2,-999,-999,-999,-999,-999,-1,-1,-2,-2,0,0,0,0,-1,-1,-999,-2,-2,0,0,-1,-2,-2,0,0,0,-1,-1,-1,-2];function y(e,t){for(var r,i,o,a,s,l=e.data,c=0,u=0,h=0,d=[],f=[],g=[],p=t.tooComplexToFollowFunctions,m=!1,v=0,y=0,w=l.length;c<w;){var S=l[c++];if(64===S)if(i=l[c++],m||y)c+=i;else for(r=0;r<i;r++)d.push(l[c++]);else if(65===S)if(i=l[c++],m||y)c+=2*i;else for(r=0;r<i;r++)o=l[c++],d.push(o<<8|l[c++]);else if(176===(248&S))if(i=S-176+1,m||y)c+=i;else for(r=0;r<i;r++)d.push(l[c++]);else if(184===(248&S))if(i=S-184+1,m||y)c+=2*i;else for(r=0;r<i;r++)o=l[c++],d.push(o<<8|l[c++]);else if(43!==S||p)if(44!==S||p){if(45===S)if(m)m=!1,u=c;else{if(!(s=f.pop()))return(0,n.warn)("TT: ENDF bad stack"),void(t.hintsValid=!1);a=g.pop(),l=s.data,c=s.i,t.functionsStackDeltas[a]=d.length-s.stackTop}else if(137===S)(m||y)&&((0,n.warn)("TT: nested IDEFs not allowed"),p=!0),m=!0,h=c;else if(88===S)++v;else if(27===S)y=v;else if(89===S)y===v&&(y=0),--v;else if(28===S&&!m&&!y){var C=d[d.length-1];C>0&&(c+=C-1)}}else(m||y)&&((0,n.warn)("TT: nested FDEFs not allowed"),p=!0),m=!0,h=c,a=d.pop(),t.functionsDefined[a]={data:l,i:c};else if(!m&&!y)if(a=d[d.length-1],isNaN(a))(0,n.info)("TT: CALL empty stack (or invalid entry).");else if(t.functionsUsed[a]=!0,a in t.functionsStackDeltas){const e=d.length+t.functionsStackDeltas[a];if(e<0)return(0,n.warn)("TT: CALL invalid functions stack delta."),void(t.hintsValid=!1);d.length=e}else if(a in t.functionsDefined&&!g.includes(a)){if(f.push({data:l,i:c,stackTop:d.length-1}),g.push(a),!(s=t.functionsDefined[a]))return(0,n.warn)("TT: CALL non-existent function"),void(t.hintsValid=!1);l=s.data,c=s.i}if(!m&&!y){let e=0;for(S<=142?e=b[S]:S>=192&&S<=223?e=-1:S>=224&&(e=-2),S>=113&&S<=117&&(i=d.pop(),isNaN(i)||(e=2*-i));e<0&&d.length>0;)d.pop(),e++;for(;e>0;)d.push(NaN),e--}}t.tooComplexToFollowFunctions=p;var k=[l];c>l.length&&k.push(new Uint8Array(c-l.length)),h>u&&((0,n.warn)("TT: complementing a missing function tail"),k.push(new Uint8Array([34,45]))),function(e,t){if(t.length>1){var r,n,i=0;for(r=0,n=t.length;r<n;r++)i+=t[r].length;i=i+3&-4;var o=new Uint8Array(i),a=0;for(r=0,n=t.length;r<n;r++)o.set(t[r],a),a+=t[r].length;e.data=o,e.length=i}}(e,k)}let C,x,E,T;if(R(s=new d.Stream(new Uint8Array(s.getBytes())))){const e=function(e,t){const{numFonts:r,offsetTable:i}=function(e){const t=(0,n.bytesToString)(e.getBytes(4));(0,n.assert)("ttcf"===t,"Must be a TrueType Collection font.");const r=e.getUint16(),i=e.getUint16(),o=e.getInt32()>>>0,a=[];for(let n=0;n<o;n++)a.push(e.getInt32()>>>0);const s={ttcTag:t,majorVersion:r,minorVersion:i,numFonts:o,offsetTable:a};switch(r){case 1:return s;case 2:return s.dsigTag=e.getInt32()>>>0,s.dsigLength=e.getInt32()>>>0,s.dsigOffset=e.getInt32()>>>0,s}throw new n.FormatError(`Invalid TrueType Collection majorVersion: ${r}.`)}(e);for(let o=0;o<r;o++){e.pos=(e.start||0)+i[o];const r=g(e),a=u(e,r.numTables);if(!a.name)throw new n.FormatError('TrueType Collection font must contain a "name" table.');const s=v(a.name);for(let e=0,n=s.length;e<n;e++)for(let i=0,o=s[e].length;i<o;i++){const n=s[e][i];if(n&&n.replace(/\s/g,"")===t)return{header:r,tables:a}}}throw new n.FormatError(`TrueType Collection does not contain "${t}" font.`)}(s,this.name);C=e.header,x=e.tables}else C=g(s),x=u(s,C.numTables);var A=!x["CFF "];if(A){if(!x.loca)throw new n.FormatError('Required "loca" table is not found');x.glyf||((0,n.warn)('Required "glyf" table is not found -- trying to recover.'),x.glyf={tag:"glyf",data:new Uint8Array(0)}),this.isOpenType=!1}else{const t=l.composite&&((l.cidToGidMap||[]).length>0||!(l.cMap instanceof h.IdentityCMap));if("OTTO"===C.version&&!t||!x.head||!x.hhea||!x.maxp||!x.post)return T=new d.Stream(x["CFF "].data),E=new I(T,l),S(l),this.convert(e,E,l);delete x.glyf,delete x.loca,delete x.fpgm,delete x.prep,delete x["cvt "],this.isOpenType=!0}if(!x.maxp)throw new n.FormatError('Required "maxp" table is not found');s.pos=(s.start||0)+x.maxp.offset;var O=s.getInt32();const M=s.getUint16();let H=M+1,B=!0;H>65535&&(B=!1,H=M,(0,n.warn)("Not enough space in glyfs to duplicate first glyph."));var U=0,j=0;O>=65536&&x.maxp.length>=22&&(s.pos+=8,s.getUint16()>2&&(x.maxp.data[14]=0,x.maxp.data[15]=2),s.pos+=4,U=s.getUint16(),s.pos+=4,j=s.getUint16()),x.maxp.data[4]=H>>8,x.maxp.data[5]=255&H;var W=function(e,t,r,i){var o={functionsDefined:[],functionsUsed:[],functionsStackDeltas:[],tooComplexToFollowFunctions:!1,hintsValid:!0};if(e&&y(e,o),t&&y(t,o),e&&function(e,t){if(!e.tooComplexToFollowFunctions){if(e.functionsDefined.length>t)return(0,n.warn)("TT: more functions defined than expected"),void(e.hintsValid=!1);for(var r=0,i=e.functionsUsed.length;r<i;r++){if(r>t)return(0,n.warn)("TT: invalid function id: "+r),void(e.hintsValid=!1);if(e.functionsUsed[r]&&!e.functionsDefined[r])return(0,n.warn)("TT: undefined function: "+r),void(e.hintsValid=!1)}}}(o,i),r&&1&r.length){var a=new Uint8Array(r.length+1);a.set(r.data),r.data=a}return o.hintsValid}(x.fpgm,x.prep,x["cvt "],U);if(W||(delete x.fpgm,delete x.prep,delete x["cvt "]),function(e,t,r,i,o){if(t){e.pos=(e.start?e.start:0)+t.offset,e.pos+=4,e.pos+=2,e.pos+=2,e.pos+=2,e.pos+=2,e.pos+=2,e.pos+=2,e.pos+=2,e.pos+=2,e.pos+=2,e.pos+=2,e.pos+=8,e.pos+=2;var a=e.getUint16();a>i&&((0,n.info)("The numOfMetrics ("+a+") should not be greater than the numGlyphs ("+i+")"),a=i,t.data[34]=(65280&a)>>8,t.data[35]=255&a);var s=i-a-(r.length-4*a>>1);if(s>0){var l=new Uint8Array(r.length+2*s);l.set(r.data),o&&(l[r.length]=r.data[2],l[r.length+1]=r.data[3]),r.data=l}}else r&&(r.data=null)}(s,x.hhea,x.hmtx,H,B),!x.head)throw new n.FormatError('Required "head" table is not found');!function(e,r,i){var o,a,s,l,c=e.data,u=(o=c[0],a=c[1],s=c[2],l=c[3],(o<<24)+(a<<16)+(s<<8)+l);u>>16!==1&&((0,n.info)("Attempting to fix invalid version in head table: "+u),c[0]=0,c[1]=1,c[2]=0,c[3]=0);var h=t(c[50],c[51]);if(h<0||h>1){(0,n.info)("Attempting to fix invalid indexToLocFormat in head table: "+h);var d=r+1;if(i===d<<1)c[50]=0,c[51]=0;else{if(i!==d<<2)throw new n.FormatError("Could not fix indexToLocFormat: "+h);c[50]=0,c[51]=1}}}(x.head,M,A?x.loca.length:0);var V=Object.create(null);if(A){var z=t(x.head.data[50],x.head.data[51]),q=function(e,t,r,n,i,o,a){var s,l,c;n?(s=4,l=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]},c=function(e,t,r){e[t]=r>>>24&255,e[t+1]=r>>16&255,e[t+2]=r>>8&255,e[t+3]=255&r}):(s=2,l=function(e,t){return e[t]<<9|e[t+1]<<1},c=function(e,t,r){e[t]=r>>9&255,e[t+1]=r>>1&255});var u=o?r+1:r,h=s*(1+u),d=new Uint8Array(h);d.set(e.data.subarray(0,h)),e.data=d;var f,g,m=t.data,v=m.length,b=new Uint8Array(v);const y=[];for(f=0,g=0;f<r+1;f++,g+=s){let e=l(d,g);e>v&&(e=v),y.push({index:f,offset:e,endOffset:0})}for(y.sort(((e,t)=>e.offset-t.offset)),f=0;f<r;f++)y[f].endOffset=y[f+1].offset;y.sort(((e,t)=>e.index-t.index));var w=Object.create(null),S=0;for(c(d,0,S),f=0,g=s;f<r;f++,g+=s){var C=p(m,y[f].offset,y[f].endOffset,b,S,i),k=C.length;0===k&&(w[f]=!0),C.sizeOfInstructions>a&&(a=C.sizeOfInstructions),c(d,g,S+=k)}if(0===S){var x=new Uint8Array([0,1,0,0,0,0,0,0,0,0,0,0,0,0,49,0]);for(f=0,g=s;f<u;f++,g+=s)c(d,g,x.length);t.data=x}else if(o){var E=l(d,s);b.length>E+S?t.data=b.subarray(0,E+S):(t.data=new Uint8Array(E+S),t.data.set(b.subarray(0,S))),t.data.set(b.subarray(0,E),S),c(e.data,d.length-s,S+E)}else t.data=b.subarray(0,S);return{missingGlyphs:w,maxSizeOfInstructions:a}}(x.loca,x.glyf,M,z,W,B,j);V=q.missingGlyphs,O>=65536&&x.maxp.length>=22&&(x.maxp.data[26]=q.maxSizeOfInstructions>>8,x.maxp.data[27]=255&q.maxSizeOfInstructions)}if(!x.hhea)throw new n.FormatError('Required "hhea" table is not found');0===x.hhea.data[10]&&0===x.hhea.data[11]&&(x.hhea.data[10]=255,x.hhea.data[11]=255);var G={unitsPerEm:t(x.head.data[18],x.head.data[19]),yMax:t(x.head.data[42],x.head.data[43]),yMin:r(x.head.data[38],x.head.data[39]),ascent:t(x.hhea.data[4],x.hhea.data[5]),descent:r(x.hhea.data[6],x.hhea.data[7])};this.ascent=G.ascent/G.unitsPerEm,this.descent=G.descent/G.unitsPerEm,x.post&&function(e,t,r){var i=(s.start?s.start:0)+e.offset;s.pos=i;var o,a=i+e.length,l=s.getInt32();s.skip(28);var c,u=!0;switch(l){case 65536:o=w;break;case 131072:var h=s.getUint16();if(h!==r){u=!1;break}var d=[];for(c=0;c<h;++c){var f=s.getUint16();if(f>=32768){u=!1;break}d.push(f)}if(!u)break;for(var g=[],p=[];s.pos<a;){var m=s.getByte();for(p.length=m,c=0;c<m;++c)p[c]=String.fromCharCode(s.getByte());g.push(p.join(""))}for(o=[],c=0;c<h;++c){var v=d[c];v<258?o.push(w[v]):o.push(g[v-258])}break;case 196608:break;default:(0,n.warn)("Unknown/unsupported post table version "+l),u=!1,t.defaultEncoding&&(o=t.defaultEncoding)}t.glyphNames=o}(x.post,l,M),x.post={tag:"post",data:F(l)};const $=[];function K(e){return!V[e]}if(l.composite){var Y=l.cidToGidMap||[],X=0===Y.length;l.cMap.forEach((function(e,t){if(t>65535)throw new n.FormatError("Max size of CID is 65,535");var r=-1;X?r=t:void 0!==Y[t]&&(r=Y[t]),r>=0&&r<M&&K(r)&&($[e]=r)}))}else{var J=function(e,t,r,i){if(!e)return(0,n.warn)("No cmap table available."),{platformId:-1,encodingId:-1,mappings:[],hasShortCmap:!1};var o,a=(t.start?t.start:0)+e.offset;t.pos=a,t.skip(2);for(var s,l=t.getUint16(),c=!1,u=0;u<l;u++){var h=t.getUint16(),d=t.getUint16(),f=t.getInt32()>>>0,g=!1;if((!s||s.platformId!==h||s.encodingId!==d)&&(0!==h||0!==d&&1!==d&&3!==d?1===h&&0===d?g=!0:3!==h||1!==d||!i&&s?r&&3===h&&0===d&&(g=!0,c=!0):(g=!0,r||(c=!0)):g=!0,g&&(s={platformId:h,encodingId:d,offset:f}),c))break}if(s&&(t.pos=a+s.offset),!s||-1===t.peekByte())return(0,n.warn)("Could not find a preferred cmap table."),{platformId:-1,encodingId:-1,mappings:[],hasShortCmap:!1};var p=t.getUint16();t.skip(4);var m,v,b=!1,y=[];if(0===p){for(m=0;m<256;m++){var w=t.getByte();w&&y.push({charCode:m,glyphId:w})}b=!0}else if(4===p){var S=t.getUint16()>>1;t.skip(6);var C,k=[];for(C=0;C<S;C++)k.push({end:t.getUint16()});for(t.skip(2),C=0;C<S;C++)k[C].start=t.getUint16();for(C=0;C<S;C++)k[C].delta=t.getUint16();var x=0;for(C=0;C<S;C++){o=k[C];var E=t.getUint16();if(E){var T=(E>>1)-(S-C);o.offsetIndex=T,x=Math.max(x,T+o.end-o.start+1)}else o.offsetIndex=-1}var _=[];for(m=0;m<x;m++)_.push(t.getUint16());for(C=0;C<S;C++){a=(o=k[C]).start;var A=o.end,R=o.delta;for(T=o.offsetIndex,m=a;m<=A;m++)65535!==m&&(v=(v=T<0?m:_[T+m-a])+R&65535,y.push({charCode:m,glyphId:v}))}}else{if(6!==p)return(0,n.warn)("cmap table has unsupported format: "+p),{platformId:-1,encodingId:-1,mappings:[],hasShortCmap:!1};var O=t.getUint16(),M=t.getUint16();for(m=0;m<M;m++){v=t.getUint16();var I=O+m;y.push({charCode:I,glyphId:v})}}for(y.sort((function(e,t){return e.charCode-t.charCode})),u=1;u<y.length;u++)y[u-1].charCode===y[u].charCode&&(y.splice(u,1),u--);return{platformId:s.platformId,encodingId:s.encodingId,mappings:y,hasShortCmap:b}}(x.cmap,s,this.isSymbolicFont,l.hasEncoding),Z=J.platformId,Q=J.encodingId,ee=J.mappings,te=ee.length;let e=[];if(!l.hasEncoding||"MacRomanEncoding"!==l.baseEncodingName&&"WinAnsiEncoding"!==l.baseEncodingName||(e=(0,a.getEncoding)(l.baseEncodingName)),l.hasEncoding&&!this.isSymbolicFont&&(3===Z&&1===Q||1===Z&&0===Q)){var re=(0,o.getGlyphsUnicode)();for(let t=0;t<256;t++){var ne,ie;if(ne=this.differences&&t in this.differences?this.differences[t]:t in e&&""!==e[t]?e[t]:a.StandardEncoding[t]){var oe;ie=k(ne,re),3===Z&&1===Q?oe=re[ie]:1===Z&&0===Q&&(oe=a.MacRomanEncoding.indexOf(ie));for(let e=0;e<te;++e)if(ee[e].charCode===oe){$[t]=ee[e].glyphId;break}}}}else if(0===Z)for(let t=0;t<te;++t)$[ee[t].charCode]=ee[t].glyphId;else for(let t=0;t<te;++t){let e=ee[t].charCode;3===Z&&e>=61440&&e<=61695&&(e&=255),$[e]=ee[t].glyphId}if(l.glyphNames&&e.length)for(let t=0;t<256;++t)if(void 0===$[t]&&e[t]){ne=e[t];const r=l.glyphNames.indexOf(ne);r>0&&K(r)&&($[t]=r)}}0===$.length&&($[0]=0);let ae=H-1;B||(ae=0);var se=P($,K,ae);if(this.toFontChar=se.toFontChar,x.cmap={tag:"cmap",data:N(se.charCodeToGlyphId,H)},x["OS/2"]&&function(e,t){t.pos=(t.start||0)+e.offset;var r=t.getUint16();t.skip(60);var n=t.getUint16();return!(r<4&&768&n)&&!(t.getUint16()>t.getUint16())&&(t.skip(6),0!==t.getUint16()&&(e.data[8]=e.data[9]=0,!0))}(x["OS/2"],s)||(x["OS/2"]={tag:"OS/2",data:D(l,se.charCodeToGlyphId,G)}),!A)try{T=new d.Stream(x["CFF "].data),E=new i.CFFParser(T,l,m).parse(),E.duplicateFirstGlyph();var le=new i.CFFCompiler(E);x["CFF "].data=le.compile()}catch(de){(0,n.warn)("Failed to compile font "+l.loadedName)}if(x.name){var ce=v(x.name);x.name.data=L(e,ce)}else x.name={tag:"name",data:L(this.name)};var ue=new _(C.version);for(var he in x)ue.addTable(he,x[he].data);return ue.toArray()},convert:function(e,t,r){r.fixedPitch=!1,r.builtInEncoding&&function(e,t){if(!e.hasIncludedToUnicodeMap&&!e.hasEncoding&&t!==e.defaultEncoding&&!(e.toUnicode instanceof T)){var r=[],n=(0,o.getGlyphsUnicode)();for(var i in t){var a=t[i],s=(0,l.getUnicodeForGlyph)(a,n);-1!==s&&(r[i]=String.fromCharCode(s))}e.toUnicode.amend(r)}}(r,r.builtInEncoding);let i=1;t instanceof I&&(i=t.numGlyphs-1);var s=t.getGlyphMapping(r),c=P(s,t.hasGlyphId.bind(t),i);this.toFontChar=c.toFontChar;var u=t.numGlyphs;function h(e,t){var r=null;for(var n in e)t===e[n]&&(r||(r=[]),r.push(0|n));return r}function d(e,t){for(var r in e)if(t===e[r])return 0|r;return c.charCodeToGlyphId[c.nextAvailableFontCharCode]=t,c.nextAvailableFontCharCode++}var g=t.seacs;if(g&&g.length){var p=r.fontMatrix||n.FONT_IDENTITY_MATRIX,m=t.getCharset(),v=Object.create(null);for(var b in g){var y=g[b|=0],w=a.StandardEncoding[y[2]],S=a.StandardEncoding[y[3]],C=m.indexOf(w),k=m.indexOf(S);if(!(C<0||k<0)){var x={x:y[0]*p[0]+y[1]*p[2]+p[4],y:y[0]*p[1]+y[1]*p[3]+p[5]},E=h(s,b);if(E)for(let e=0,t=E.length;e<t;e++){var R=E[e],O=c.charCodeToGlyphId,M=d(O,C),H=d(O,k);v[R]={baseFontCharCode:M,accentFontCharCode:H,accentOffset:x}}}}r.seacMap=v}var B=1/(r.fontMatrix||n.FONT_IDENTITY_MATRIX)[0],U=new _("OTTO");return U.addTable("CFF ",t.data),U.addTable("OS/2",D(r,c.charCodeToGlyphId)),U.addTable("cmap",N(c.charCodeToGlyphId,u)),U.addTable("head","\0\x01\0\0\0\0\x10\0\0\0\0\0_\x0f<\xf5\0\0"+A(B)+"\0\0\0\0\x9e\v~'\0\0\0\0\x9e\v~'\0\0"+A(r.descent)+"\x0f\xff"+A(r.ascent)+f(r.italicAngle?2:0)+"\0\x11\0\0\0\0\0\0"),U.addTable("hhea","\0\x01\0\0"+A(r.ascent)+A(r.descent)+"\0\0\xff\xff\0\0\0\0\0\0"+A(r.capHeight)+A(Math.tan(r.italicAngle)*r.xHeight)+"\0\0\0\0\0\0\0\0\0\0\0\0"+f(u)),U.addTable("hmtx",function(){var e=t.charstrings,r=t.cff?t.cff.widths:null,n="\0\0\0\0";for(let t=1,a=u;t<a;t++){var i=0;if(e){var o=e[t-1];i="width"in o?o.width:0}else r&&(i=Math.ceil(r[t]||0));n+=f(i)+f(0)}return n}()),U.addTable("maxp","\0\0P\0"+f(u)),U.addTable("name",L(e)),U.addTable("post",F(r)),U.toArray()},get spaceWidth(){for(var e,t=["space","minus","one","i","I"],r=0,i=t.length;r<i;r++){var a=t[r];if(a in this.widths){e=this.widths[a];break}var s=(0,o.getGlyphsUnicode)()[a],l=0;if(this.composite&&this.cMap.contains(s)&&(l=this.cMap.lookup(s)),!l&&this.toUnicode&&(l=this.toUnicode.charCodeOf(s)),l<=0&&(l=s),e=this.widths[l])break}return e=e||this.defaultWidth,(0,n.shadow)(this,"spaceWidth",e)},charToGlyph:function(e,t){var r,i,o,a=e;this.cMap&&this.cMap.contains(e)&&(a=this.cMap.lookup(e)),i=this.widths[a],i=(0,n.isNum)(i)?i:this.defaultWidth;var s=this.vmetrics&&this.vmetrics[a];let c=this.toUnicode.get(e)||this.fallbackToUnicode.get(e)||e;"number"===typeof c&&(c=String.fromCharCode(c));var u=e in this.toFontChar;if(r=this.toFontChar[e]||e,this.missingFile){const t=this.differences[e]||this.defaultEncoding[e];".notdef"!==t&&""!==t||"Type1"!==this.type||(r=32),r=(0,l.mapSpecialUnicodeValues)(r)}this.isType3Font&&(o=r);var h=null;if(this.seacMap&&this.seacMap[e]){u=!0;var d=this.seacMap[e];r=d.baseFontCharCode,h={fontChar:String.fromCodePoint(d.accentFontCharCode),offset:d.accentOffset}}let f="";"number"===typeof r&&(r<=1114111?f=String.fromCodePoint(r):(0,n.warn)(`charToGlyph - invalid fontCharCode: ${r}`));var g=this.glyphCache[e];return g&&g.matchesForCache(f,c,h,i,s,o,t,u)||(g=new x(f,c,h,i,s,o,t,u),this.glyphCache[e]=g),g},charsToGlyphs:function(e){var t,r,n,i=this.charsCache;if(i&&(t=i[e]))return t;i||(i=this.charsCache=Object.create(null)),t=[];var o,a=e,s=0;if(this.cMap)for(var l=Object.create(null);s<e.length;){this.cMap.readCharCode(e,s,l),n=l.charcode;var c=l.length;s+=c;var u=1===c&&32===e.charCodeAt(s-1);r=this.charToGlyph(n,u),t.push(r)}else for(s=0,o=e.length;s<o;++s)n=e.charCodeAt(s),r=this.charToGlyph(n,32===n),t.push(r);return i[a]=t},get glyphCacheValues(){return Object.values(this.glyphCache)}},e}();t.Font=A;var R=function(){function e(e){this.error=e,this.loadedName="g_font_error",this.missingFile=!0}return e.prototype={charsToGlyphs:function(){return[]},exportData(){return{error:this.error}}},e}();function O(e,t,r){var n,i,s,l=Object.create(null),c=!!(e.flags&y.Symbolic);if(e.baseEncodingName)for(s=(0,a.getEncoding)(e.baseEncodingName),i=0;i<s.length;i++)n=r.indexOf(s[i]),l[i]=n>=0?n:0;else if(c)for(i in t)l[i]=t[i];else for(s=a.StandardEncoding,i=0;i<s.length;i++)n=r.indexOf(s[i]),l[i]=n>=0?n:0;var u,h=e.differences;if(h)for(i in h){var d=h[i];if(-1===(n=r.indexOf(d))){u||(u=(0,o.getGlyphsUnicode)());var f=k(d,u);f!==d&&(n=r.indexOf(f))}l[i]=n>=0?n:0}return l}t.ErrorFont=R;var M=function(){function e(e,t,r){for(var n,i=e.length,o=t.length,a=i-o,s=r,l=!1;s<a;){for(n=0;n<o&&e[s+n]===t[n];)n++;if(n>=o){for(s+=n;s<i&&(0,c.isWhiteSpace)(e[s]);)s++;l=!0;break}s++}return{found:l,length:s}}function t(t,r,i){var o=i.length1,a=(i.length2,r.peekBytes(6)),s=128===a[0]&&1===a[1];s&&(r.skip(6),o=a[5]<<24|a[4]<<16|a[3]<<8|a[2]);var l=function(t,r){var i,o,a,s,l=[101,101,120,101,99],u=t.pos;try{o=(i=t.getBytes(r)).length}catch(h){if(h instanceof c.MissingDataException)throw h}if(o===r&&(a=e(i,l,r-2*l.length)).found&&a.length===r)return{stream:new d.Stream(i),length:r};for((0,n.warn)('Invalid "Length1" property in Type1 font -- trying to recover.'),t.pos=u;0!==(a=e(t.peekBytes(2048),l,0)).length;)if(t.pos+=a.length,a.found){s=t.pos-u;break}return t.pos=u,s?{stream:new d.Stream(t.getBytes(s)),length:s}:((0,n.warn)('Unable to recover "Length1" property in Type1 font -- using as is.'),{stream:new d.Stream(t.getBytes(r)),length:r})}(r,o);new f.Type1Parser(l.stream,!1,m).extractFontHeader(i),s&&((a=r.getBytes(6))[5],a[4],a[3],a[2]);var u=function(e){var t=e.getBytes();return{stream:new d.Stream(t),length:t.length}}(r),h=new f.Type1Parser(u.stream,!0,m).extractFontProgram(i);for(const e in h.properties)i[e]=h.properties[e];var g=h.charstrings,p=this.getType2Charstrings(g),v=this.getType2Subrs(h.subrs);this.charstrings=g,this.data=this.wrap(t,p,this.charstrings,v,i),this.seacs=this.getSeacs(h.charstrings)}return t.prototype={get numGlyphs(){return this.charstrings.length+1},getCharset:function(){for(var e=[".notdef"],t=this.charstrings,r=0;r<t.length;r++)e.push(t[r].glyphName);return e},getGlyphMapping:function(e){var t=this.charstrings;if(e.composite){const r=Object.create(null);for(let n=0,i=t.length;n<i;n++)r[e.cMap.charCodeOf(n)]=n+1;return r}var r,n=[".notdef"];for(r=0;r<t.length;r++)n.push(t[r].glyphName);var i=e.builtInEncoding;if(i){var o=Object.create(null);for(var a in i)(r=n.indexOf(i[a]))>=0&&(o[a]=r)}return O(e,o,n)},hasGlyphId:function(e){return!(e<0||e>=this.numGlyphs)&&(0===e||this.charstrings[e-1].charstring.length>0)},getSeacs:function(e){var t,r,n=[];for(t=0,r=e.length;t<r;t++){var i=e[t];i.seac&&(n[t+1]=i.seac)}return n},getType2Charstrings:function(e){for(var t=[],r=0,n=e.length;r<n;r++)t.push(e[r].charstring);return t},getType2Subrs:function(e){var t=0,r=e.length;t=r<1133?107:r<33769?1131:32768;var n,i=[];for(n=0;n<t;n++)i.push([11]);for(n=0;n<r;n++)i.push(e[n]);return i},wrap:function(e,t,r,n,o){var a=new i.CFF;a.header=new i.CFFHeader(1,0,4,4),a.names=[e];var s=new i.CFFTopDict;s.setByName("version",391),s.setByName("Notice",392),s.setByName("FullName",393),s.setByName("FamilyName",394),s.setByName("Weight",395),s.setByName("Encoding",null),s.setByName("FontMatrix",o.fontMatrix),s.setByName("FontBBox",o.bbox),s.setByName("charset",null),s.setByName("CharStrings",null),s.setByName("Private",null),a.topDict=s;var l=new i.CFFStrings;l.add("Version 0.11"),l.add("See original notice"),l.add(e),l.add(e),l.add("Medium"),a.strings=l,a.globalSubrIndex=new i.CFFIndex;var c,u,h=t.length,d=[".notdef"];for(c=0;c<h;c++){const e=r[c].glyphName;-1===i.CFFStandardStrings.indexOf(e)&&l.add(e),d.push(e)}a.charset=new i.CFFCharset(!1,0,d);var f=new i.CFFIndex;for(f.add([139,14]),c=0;c<h;c++)f.add(t[c]);a.charStrings=f;var g=new i.CFFPrivateDict;g.setByName("Subrs",null);var p=["BlueValues","OtherBlues","FamilyBlues","FamilyOtherBlues","StemSnapH","StemSnapV","BlueShift","BlueFuzz","BlueScale","LanguageGroup","ExpansionFactor","ForceBold","StdHW","StdVW"];for(c=0,u=p.length;c<u;c++){var m=p[c];if(m in o.privateData){var v=o.privateData[m];if(Array.isArray(v))for(var b=v.length-1;b>0;b--)v[b]-=v[b-1];g.setByName(m,v)}}a.topDict.privateDict=g;var y=new i.CFFIndex;for(c=0,u=n.length;c<u;c++)y.add(n[c]);return g.subrsIndex=y,new i.CFFCompiler(a).compile()}},t}(),I=function(){function e(e,t){this.properties=t;var r=new i.CFFParser(e,t,m);this.cff=r.parse(),this.cff.duplicateFirstGlyph();var o=new i.CFFCompiler(this.cff);this.seacs=this.cff.seacs;try{this.data=o.compile()}catch(a){(0,n.warn)("Failed to compile font "+t.loadedName),this.data=e}}return e.prototype={get numGlyphs(){return this.cff.charStrings.count},getCharset:function(){return this.cff.charset.charset},getGlyphMapping:function(){var e,t,r=this.cff,n=this.properties,i=r.charset.charset;if(n.composite){let a;if(e=Object.create(null),r.isCIDFont)for(t=0;t<i.length;t++){var o=i[t];a=n.cMap.charCodeOf(o),e[a]=t}else for(t=0;t<r.charStrings.count;t++)a=n.cMap.charCodeOf(t),e[a]=t;return e}return e=O(n,r.encoding?r.encoding.encoding:null,i)},hasGlyphId:function(e){return this.cff.hasGlyphId(e)}},e}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CFFFDSelect=t.CFFCompiler=t.CFFPrivateDict=t.CFFTopDict=t.CFFCharset=t.CFFIndex=t.CFFStrings=t.CFFHeader=t.CFF=t.CFFParser=t.CFFStandardStrings=void 0;var n=r(2),i=r(33),o=r(34),a=[".notdef","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quoteright","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","quoteleft","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","exclamdown","cent","sterling","fraction","yen","florin","section","currency","quotesingle","quotedblleft","guillemotleft","guilsinglleft","guilsinglright","fi","fl","endash","dagger","daggerdbl","periodcentered","paragraph","bullet","quotesinglbase","quotedblbase","quotedblright","guillemotright","ellipsis","perthousand","questiondown","grave","acute","circumflex","tilde","macron","breve","dotaccent","dieresis","ring","cedilla","hungarumlaut","ogonek","caron","emdash","AE","ordfeminine","Lslash","Oslash","OE","ordmasculine","ae","dotlessi","lslash","oslash","oe","germandbls","onesuperior","logicalnot","mu","trademark","Eth","onehalf","plusminus","Thorn","onequarter","divide","brokenbar","degree","thorn","threequarters","twosuperior","registered","minus","eth","multiply","threesuperior","copyright","Aacute","Acircumflex","Adieresis","Agrave","Aring","Atilde","Ccedilla","Eacute","Ecircumflex","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Ntilde","Oacute","Ocircumflex","Odieresis","Ograve","Otilde","Scaron","Uacute","Ucircumflex","Udieresis","Ugrave","Yacute","Ydieresis","Zcaron","aacute","acircumflex","adieresis","agrave","aring","atilde","ccedilla","eacute","ecircumflex","edieresis","egrave","iacute","icircumflex","idieresis","igrave","ntilde","oacute","ocircumflex","odieresis","ograve","otilde","scaron","uacute","ucircumflex","udieresis","ugrave","yacute","ydieresis","zcaron","exclamsmall","Hungarumlautsmall","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","twodotenleader","onedotenleader","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","commasuperior","threequartersemdash","periodsuperior","questionsmall","asuperior","bsuperior","centsuperior","dsuperior","esuperior","isuperior","lsuperior","msuperior","nsuperior","osuperior","rsuperior","ssuperior","tsuperior","ff","ffi","ffl","parenleftinferior","parenrightinferior","Circumflexsmall","hyphensuperior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","exclamdownsmall","centoldstyle","Lslashsmall","Scaronsmall","Zcaronsmall","Dieresissmall","Brevesmall","Caronsmall","Dotaccentsmall","Macronsmall","figuredash","hypheninferior","Ogoneksmall","Ringsmall","Cedillasmall","questiondownsmall","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","zerosuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior","Agravesmall","Aacutesmall","Acircumflexsmall","Atildesmall","Adieresissmall","Aringsmall","AEsmall","Ccedillasmall","Egravesmall","Eacutesmall","Ecircumflexsmall","Edieresissmall","Igravesmall","Iacutesmall","Icircumflexsmall","Idieresissmall","Ethsmall","Ntildesmall","Ogravesmall","Oacutesmall","Ocircumflexsmall","Otildesmall","Odieresissmall","OEsmall","Oslashsmall","Ugravesmall","Uacutesmall","Ucircumflexsmall","Udieresissmall","Yacutesmall","Thornsmall","Ydieresissmall","001.000","001.001","001.002","001.003","Black","Bold","Book","Light","Medium","Regular","Roman","Semibold"];t.CFFStandardStrings=a;const s=391;var l=function(){var e=[null,{id:"hstem",min:2,stackClearing:!0,stem:!0},null,{id:"vstem",min:2,stackClearing:!0,stem:!0},{id:"vmoveto",min:1,stackClearing:!0},{id:"rlineto",min:2,resetStack:!0},{id:"hlineto",min:1,resetStack:!0},{id:"vlineto",min:1,resetStack:!0},{id:"rrcurveto",min:6,resetStack:!0},null,{id:"callsubr",min:1,undefStack:!0},{id:"return",min:0,undefStack:!0},null,null,{id:"endchar",min:0,stackClearing:!0},null,null,null,{id:"hstemhm",min:2,stackClearing:!0,stem:!0},{id:"hintmask",min:0,stackClearing:!0},{id:"cntrmask",min:0,stackClearing:!0},{id:"rmoveto",min:2,stackClearing:!0},{id:"hmoveto",min:1,stackClearing:!0},{id:"vstemhm",min:2,stackClearing:!0,stem:!0},{id:"rcurveline",min:8,resetStack:!0},{id:"rlinecurve",min:8,resetStack:!0},{id:"vvcurveto",min:4,resetStack:!0},{id:"hhcurveto",min:4,resetStack:!0},null,{id:"callgsubr",min:1,undefStack:!0},{id:"vhcurveto",min:4,resetStack:!0},{id:"hvcurveto",min:4,resetStack:!0}],t=[null,null,null,{id:"and",min:2,stackDelta:-1},{id:"or",min:2,stackDelta:-1},{id:"not",min:1,stackDelta:0},null,null,null,{id:"abs",min:1,stackDelta:0},{id:"add",min:2,stackDelta:-1,stackFn:function(e,t){e[t-2]=e[t-2]+e[t-1]}},{id:"sub",min:2,stackDelta:-1,stackFn:function(e,t){e[t-2]=e[t-2]-e[t-1]}},{id:"div",min:2,stackDelta:-1,stackFn:function(e,t){e[t-2]=e[t-2]/e[t-1]}},null,{id:"neg",min:1,stackDelta:0,stackFn:function(e,t){e[t-1]=-e[t-1]}},{id:"eq",min:2,stackDelta:-1},null,null,{id:"drop",min:1,stackDelta:-1},null,{id:"put",min:2,stackDelta:-2},{id:"get",min:1,stackDelta:0},{id:"ifelse",min:4,stackDelta:-3},{id:"random",min:0,stackDelta:1},{id:"mul",min:2,stackDelta:-1,stackFn:function(e,t){e[t-2]=e[t-2]*e[t-1]}},null,{id:"sqrt",min:1,stackDelta:0},{id:"dup",min:1,stackDelta:1},{id:"exch",min:2,stackDelta:0},{id:"index",min:2,stackDelta:0},{id:"roll",min:3,stackDelta:-2},null,null,null,{id:"hflex",min:7,resetStack:!0},{id:"flex",min:13,resetStack:!0},{id:"hflex1",min:9,resetStack:!0},{id:"flex1",min:11,resetStack:!0}];return class{constructor(e,t,r){this.bytes=e.getBytes(),this.properties=t,this.seacAnalysisEnabled=!!r}parse(){var e=this.properties,t=new c;this.cff=t;var r=this.parseHeader(),n=this.parseIndex(r.endPos),i=this.parseIndex(n.endPos),o=this.parseIndex(i.endPos),a=this.parseIndex(o.endPos),s=this.parseDict(i.obj.get(0)),l=this.createDict(g,s,t.strings);t.header=r.obj,t.names=this.parseNameIndex(n.obj),t.strings=this.parseStringIndex(o.obj),t.topDict=l,t.globalSubrIndex=a.obj,this.parsePrivateDict(t.topDict),t.isCIDFont=l.hasName("ROS");var u=l.getByName("CharStrings"),h=this.parseIndex(u).obj,d=l.getByName("FontMatrix");d&&(e.fontMatrix=d);var f,p,m=l.getByName("FontBBox");if(m&&(e.ascent=Math.max(m[3],m[1]),e.descent=Math.min(m[1],m[3]),e.ascentScaled=!0),t.isCIDFont){for(var v=this.parseIndex(l.getByName("FDArray")).obj,b=0,y=v.count;b<y;++b){var w=v.get(b),S=this.createDict(g,this.parseDict(w),t.strings);this.parsePrivateDict(S),t.fdArray.push(S)}p=null,f=this.parseCharsets(l.getByName("charset"),h.count,t.strings,!0),t.fdSelect=this.parseFDSelect(l.getByName("FDSelect"),h.count)}else f=this.parseCharsets(l.getByName("charset"),h.count,t.strings,!1),p=this.parseEncoding(l.getByName("Encoding"),e,t.strings,f.charset);t.charset=f,t.encoding=p;var C=this.parseCharStrings({charStrings:h,localSubrIndex:l.privateDict.subrsIndex,globalSubrIndex:a.obj,fdSelect:t.fdSelect,fdArray:t.fdArray,privateDict:l.privateDict});return t.charStrings=C.charStrings,t.seacs=C.seacs,t.widths=C.widths,t}parseHeader(){for(var e=this.bytes,t=e.length,r=0;r<t&&1!==e[r];)++r;if(r>=t)throw new n.FormatError("Invalid CFF header");0!==r&&((0,n.info)("cff data is shifted"),e=e.subarray(r),this.bytes=e);var i=e[0],o=e[1],a=e[2],s=e[3];return{obj:new u(i,o,a,s),endPos:a}}parseDict(e){var t=0;function r(){var r=e[t++];return 30===r?function(){var r="",n=15;const i=["0","1","2","3","4","5","6","7","8","9",".","E","E-",null,"-"];for(var o=e.length;t<o;){var a=e[t++],s=a>>4,l=15&a;if(s===n)break;if(r+=i[s],l===n)break;r+=i[l]}return parseFloat(r)}():28===r?r=((r=e[t++])<<24|e[t++]<<16)>>16:29===r?r=(r=(r=(r=e[t++])<<8|e[t++])<<8|e[t++])<<8|e[t++]:r>=32&&r<=246?r-139:r>=247&&r<=250?256*(r-247)+e[t++]+108:r>=251&&r<=254?-256*(r-251)-e[t++]-108:((0,n.warn)('CFFParser_parseDict: "'+r+'" is a reserved command.'),NaN)}var i=[],o=[];t=0;for(var a=e.length;t<a;){var s=e[t];s<=21?(12===s&&(s=s<<8|e[++t]),o.push([s,i]),i=[],++t):i.push(r())}return o}parseIndex(e){var t,r,n=new d,i=this.bytes,o=i[e++]<<8|i[e++],a=[],s=e;if(0!==o){var l=i[e++],c=e+(o+1)*l-1;for(t=0,r=o+1;t<r;++t){for(var u=0,h=0;h<l;++h)u<<=8,u+=i[e++];a.push(c+u)}s=a[o]}for(t=0,r=a.length-1;t<r;++t){var f=a[t],g=a[t+1];n.add(i.subarray(f,g))}return{obj:n,endPos:s}}parseNameIndex(e){for(var t=[],r=0,i=e.count;r<i;++r){var o=e.get(r);t.push((0,n.bytesToString)(o))}return t}parseStringIndex(e){for(var t=new h,r=0,i=e.count;r<i;++r){var o=e.get(r);t.add((0,n.bytesToString)(o))}return t}createDict(e,t,r){for(var n=new e(r),i=0,o=t.length;i<o;++i){var a=t[i],s=a[0],l=a[1];n.setByKey(s,l)}return n}parseCharString(r,i,o,a){if(!i||r.callDepth>10)return!1;for(var s=r.stackSize,l=r.stack,c=i.length,u=0;u<c;){var h=i[u++],d=null;if(12===h){var f=i[u++];0===f?(i[u-2]=139,i[u-1]=22,s=0):d=t[f]}else if(28===h)l[s]=(i[u]<<24|i[u+1]<<16)>>16,u+=2,s++;else if(14===h){if(s>=4&&(s-=4,this.seacAnalysisEnabled))return r.seac=l.slice(s,s+4),!1;d=e[h]}else if(h>=32&&h<=246)l[s]=h-139,s++;else if(h>=247&&h<=254)l[s]=h<251?(h-247<<8)+i[u]+108:-(h-251<<8)-i[u]-108,u++,s++;else if(255===h)l[s]=(i[u]<<24|i[u+1]<<16|i[u+2]<<8|i[u+3])/65536,u+=4,s++;else if(19===h||20===h)r.hints+=s>>1,u+=r.hints+7>>3,s%=2,d=e[h];else{if(10===h||29===h){var g;if(!(g=10===h?o:a))return d=e[h],(0,n.warn)("Missing subrsIndex for "+d.id),!1;var p=32768;g.count<1240?p=107:g.count<33900&&(p=1131);var m=l[--s]+p;if(m<0||m>=g.count||isNaN(m))return d=e[h],(0,n.warn)("Out of bounds subrIndex for "+d.id),!1;if(r.stackSize=s,r.callDepth++,!this.parseCharString(r,g.get(m),o,a))return!1;r.callDepth--,s=r.stackSize;continue}if(11===h)return r.stackSize=s,!0;d=e[h]}if(d){if(d.stem&&(r.hints+=s>>1,3===h||23===h?r.hasVStems=!0:!r.hasVStems||1!==h&&18!==h||((0,n.warn)("CFF stem hints are in wrong order"),i[u-1]=1===h?3:23)),"min"in d&&!r.undefStack&&s<d.min)return(0,n.warn)("Not enough parameters for "+d.id+"; actual: "+s+", expected: "+d.min),!1;r.firstStackClearing&&d.stackClearing&&(r.firstStackClearing=!1,(s-=d.min)>=2&&d.stem?s%=2:s>1&&(0,n.warn)("Found too many parameters for stack-clearing command"),s>0&&l[s-1]>=0&&(r.width=l[s-1])),"stackDelta"in d?("stackFn"in d&&d.stackFn(l,s),s+=d.stackDelta):d.stackClearing?s=0:d.resetStack?(s=0,r.undefStack=!1):d.undefStack&&(s=0,r.undefStack=!0,r.firstStackClearing=!1)}}return r.stackSize=s,!0}parseCharStrings(e){let{charStrings:t,localSubrIndex:r,globalSubrIndex:i,fdSelect:o,fdArray:a,privateDict:s}=e;for(var l=[],c=[],u=t.count,h=0;h<u;h++){var d=t.get(h),f={callDepth:0,stackSize:0,stack:[],undefStack:!0,hints:0,firstStackClearing:!0,seac:null,width:null,hasVStems:!1},g=!0,p=null,m=s;if(o&&a.length){var v=o.getFDIndex(h);-1===v&&((0,n.warn)("Glyph index is not in fd select."),g=!1),v>=a.length&&((0,n.warn)("Invalid fd index for glyph index."),g=!1),g&&(p=(m=a[v].privateDict).subrsIndex)}else r&&(p=r);if(g&&(g=this.parseCharString(f,d,p,i)),null!==f.width){const e=m.getByName("nominalWidthX");c[h]=e+f.width}else{const e=m.getByName("defaultWidthX");c[h]=e}null!==f.seac&&(l[h]=f.seac),g||t.set(h,new Uint8Array([14]))}return{charStrings:t,seacs:l,widths:c}}emptyPrivateDictionary(e){var t=this.createDict(p,[],e.strings);e.setByKey(18,[0,0]),e.privateDict=t}parsePrivateDict(e){if(e.hasName("Private")){var t=e.getByName("Private");if(Array.isArray(t)&&2===t.length){var r=t[0],n=t[1];if(0===r||n>=this.bytes.length)this.emptyPrivateDictionary(e);else{var i=n+r,o=this.bytes.subarray(n,i),a=this.parseDict(o),s=this.createDict(p,a,e.strings);if(e.privateDict=s,s.getByName("Subrs")){var l=s.getByName("Subrs"),c=n+l;if(0===l||c>=this.bytes.length)this.emptyPrivateDictionary(e);else{var u=this.parseIndex(c);s.subrsIndex=u.obj}}}}else e.removeByName("Private")}else this.emptyPrivateDictionary(e)}parseCharsets(e,t,r,o){if(0===e)return new v(!0,m.ISO_ADOBE,i.ISOAdobeCharset);if(1===e)return new v(!0,m.EXPERT,i.ExpertCharset);if(2===e)return new v(!0,m.EXPERT_SUBSET,i.ExpertSubsetCharset);var a=this.bytes,s=e,l=a[e++];const c=[o?0:".notdef"];var u,h,d;switch(t-=1,l){case 0:for(d=0;d<t;d++)u=a[e++]<<8|a[e++],c.push(o?u:r.get(u));break;case 1:for(;c.length<=t;)for(u=a[e++]<<8|a[e++],h=a[e++],d=0;d<=h;d++)c.push(o?u++:r.get(u++));break;case 2:for(;c.length<=t;)for(u=a[e++]<<8|a[e++],h=a[e++]<<8|a[e++],d=0;d<=h;d++)c.push(o?u++:r.get(u++));break;default:throw new n.FormatError("Unknown charset format")}var f=e,g=a.subarray(s,f);return new v(!1,l,c,g)}parseEncoding(e,t,r,i){var a,s,l,c=Object.create(null),u=this.bytes,h=!1,d=null;if(0===e||1===e){h=!0,a=e;var f=e?o.ExpertEncoding:o.StandardEncoding;for(s=0,l=i.length;s<l;s++){var g=f.indexOf(i[s]);-1!==g&&(c[g]=s)}}else{var p=e;switch(127&(a=u[e++])){case 0:var m=u[e++];for(s=1;s<=m;s++)c[u[e++]]=s;break;case 1:var v=u[e++],y=1;for(s=0;s<v;s++)for(var w=u[e++],S=u[e++],C=w;C<=w+S;C++)c[C]=y++;break;default:throw new n.FormatError(`Unknown encoding format: ${a} in CFF`)}var k=e;128&a&&(u[p]&=127,function(){var t=u[e++];for(s=0;s<t;s++){var n=u[e++],o=(u[e++]<<8)+(255&u[e++]);c[n]=i.indexOf(r.get(o))}}()),d=u.subarray(p,k)}return new b(h,a&=127,c,d)}parseFDSelect(e,t){var r,i=this.bytes,o=i[e++],a=[];switch(o){case 0:for(r=0;r<t;++r){var s=i[e++];a.push(s)}break;case 3:var l=i[e++]<<8|i[e++];for(r=0;r<l;++r){var c=i[e++]<<8|i[e++];0===r&&0!==c&&((0,n.warn)("parseFDSelect: The first range must have a first GID of 0 -- trying to recover."),c=0);for(var u=i[e++],h=i[e]<<8|i[e+1],d=c;d<h;++d)a.push(u)}e+=2;break;default:throw new n.FormatError(`parseFDSelect: Unknown format "${o}".`)}if(a.length!==t)throw new n.FormatError("parseFDSelect: Invalid font data.");return new y(o,a)}}}();t.CFFParser=l;class c{constructor(){this.header=null,this.names=[],this.topDict=null,this.strings=new h,this.globalSubrIndex=null,this.encoding=null,this.charset=null,this.charStrings=null,this.fdArray=[],this.fdSelect=null,this.isCIDFont=!1}duplicateFirstGlyph(){if(this.charStrings.count>=65535)(0,n.warn)("Not enough space in charstrings to duplicate first glyph.");else{var e=this.charStrings.get(0);this.charStrings.add(e),this.isCIDFont&&this.fdSelect.fdSelect.push(this.fdSelect.fdSelect[0])}}hasGlyphId(e){return!(e<0||e>=this.charStrings.count)&&this.charStrings.get(e).length>0}}t.CFF=c;class u{constructor(e,t,r,n){this.major=e,this.minor=t,this.hdrSize=r,this.offSize=n}}t.CFFHeader=u;class h{constructor(){this.strings=[]}get(e){return e>=0&&e<=390?a[e]:e-s<=this.strings.length?this.strings[e-s]:a[0]}getSID(e){let t=a.indexOf(e);return-1!==t?t:(t=this.strings.indexOf(e),-1!==t?t+s:-1)}add(e){this.strings.push(e)}get count(){return this.strings.length}}t.CFFStrings=h;class d{constructor(){this.objects=[],this.length=0}add(e){this.length+=e.length,this.objects.push(e)}set(e,t){this.length+=t.length-this.objects[e].length,this.objects[e]=t}get(e){return this.objects[e]}get count(){return this.objects.length}}t.CFFIndex=d;class f{constructor(e,t){this.keyToNameMap=e.keyToNameMap,this.nameToKeyMap=e.nameToKeyMap,this.defaults=e.defaults,this.types=e.types,this.opcodes=e.opcodes,this.order=e.order,this.strings=t,this.values=Object.create(null)}setByKey(e,t){if(!(e in this.keyToNameMap))return!1;var r=t.length;if(0===r)return!0;for(var i=0;i<r;i++)if(isNaN(t[i]))return(0,n.warn)('Invalid CFFDict value: "'+t+'" for key "'+e+'".'),!0;var o=this.types[e];return"num"!==o&&"sid"!==o&&"offset"!==o||(t=t[0]),this.values[e]=t,!0}setByName(e,t){if(!(e in this.nameToKeyMap))throw new n.FormatError(`Invalid dictionary name "${e}"`);this.values[this.nameToKeyMap[e]]=t}hasName(e){return this.nameToKeyMap[e]in this.values}getByName(e){if(!(e in this.nameToKeyMap))throw new n.FormatError(`Invalid dictionary name ${e}"`);var t=this.nameToKeyMap[e];return t in this.values?this.values[t]:this.defaults[t]}removeByName(e){delete this.values[this.nameToKeyMap[e]]}static createTables(e){for(var t={keyToNameMap:{},nameToKeyMap:{},defaults:{},types:{},opcodes:{},order:[]},r=0,n=e.length;r<n;++r){var i=e[r],o=Array.isArray(i[0])?(i[0][0]<<8)+i[0][1]:i[0];t.keyToNameMap[o]=i[1],t.nameToKeyMap[i[1]]=o,t.types[o]=i[2],t.defaults[o]=i[3],t.opcodes[o]=Array.isArray(i[0])?i[0]:[i[0]],t.order.push(o)}return t}}var g=function(){var e=[[[12,30],"ROS",["sid","sid","num"],null],[[12,20],"SyntheticBase","num",null],[0,"version","sid",null],[1,"Notice","sid",null],[[12,0],"Copyright","sid",null],[2,"FullName","sid",null],[3,"FamilyName","sid",null],[4,"Weight","sid",null],[[12,1],"isFixedPitch","num",0],[[12,2],"ItalicAngle","num",0],[[12,3],"UnderlinePosition","num",-100],[[12,4],"UnderlineThickness","num",50],[[12,5],"PaintType","num",0],[[12,6],"CharstringType","num",2],[[12,7],"FontMatrix",["num","num","num","num","num","num"],[.001,0,0,.001,0,0]],[13,"UniqueID","num",null],[5,"FontBBox",["num","num","num","num"],[0,0,0,0]],[[12,8],"StrokeWidth","num",0],[14,"XUID","array",null],[15,"charset","offset",0],[16,"Encoding","offset",0],[17,"CharStrings","offset",0],[18,"Private",["offset","offset"],null],[[12,21],"PostScript","sid",null],[[12,22],"BaseFontName","sid",null],[[12,23],"BaseFontBlend","delta",null],[[12,31],"CIDFontVersion","num",0],[[12,32],"CIDFontRevision","num",0],[[12,33],"CIDFontType","num",0],[[12,34],"CIDCount","num",8720],[[12,35],"UIDBase","num",null],[[12,37],"FDSelect","offset",null],[[12,36],"FDArray","offset",null],[[12,38],"FontName","sid",null]],t=null;return class extends f{constructor(r){null===t&&(t=f.createTables(e)),super(t,r),this.privateDict=null}}}();t.CFFTopDict=g;var p=function(){var e=[[6,"BlueValues","delta",null],[7,"OtherBlues","delta",null],[8,"FamilyBlues","delta",null],[9,"FamilyOtherBlues","delta",null],[[12,9],"BlueScale","num",.039625],[[12,10],"BlueShift","num",7],[[12,11],"BlueFuzz","num",1],[10,"StdHW","num",null],[11,"StdVW","num",null],[[12,12],"StemSnapH","delta",null],[[12,13],"StemSnapV","delta",null],[[12,14],"ForceBold","num",0],[[12,17],"LanguageGroup","num",0],[[12,18],"ExpansionFactor","num",.06],[[12,19],"initialRandomSeed","num",0],[20,"defaultWidthX","num",0],[21,"nominalWidthX","num",0],[19,"Subrs","offset",null]],t=null;return class extends f{constructor(r){null===t&&(t=f.createTables(e)),super(t,r),this.subrsIndex=null}}}();t.CFFPrivateDict=p;var m={ISO_ADOBE:0,EXPERT:1,EXPERT_SUBSET:2};class v{constructor(e,t,r,n){this.predefined=e,this.format=t,this.charset=r,this.raw=n}}t.CFFCharset=v;class b{constructor(e,t,r,n){this.predefined=e,this.format=t,this.encoding=r,this.raw=n}}class y{constructor(e,t){this.format=e,this.fdSelect=t}getFDIndex(e){return e<0||e>=this.fdSelect.length?-1:this.fdSelect[e]}}t.CFFFDSelect=y;class w{constructor(){this.offsets=Object.create(null)}isTracking(e){return e in this.offsets}track(e,t){if(e in this.offsets)throw new n.FormatError(`Already tracking location of ${e}`);this.offsets[e]=t}offset(e){for(var t in this.offsets)this.offsets[t]+=e}setEntryLocation(e,t,r){if(!(e in this.offsets))throw new n.FormatError(`Not tracking location of ${e}`);for(var i=r.data,o=this.offsets[e],a=0,s=t.length;a<s;++a){var l=5*a+o,c=l+1,u=l+2,h=l+3,d=l+4;if(29!==i[l]||0!==i[c]||0!==i[u]||0!==i[h]||0!==i[d])throw new n.FormatError("writing to an offset that is not empty");var f=t[a];i[l]=29,i[c]=f>>24&255,i[u]=f>>16&255,i[h]=f>>8&255,i[d]=255&f}}}class S{constructor(e){this.cff=e}compile(){var e=this.cff,t={data:[],length:0,add:function(e){this.data=this.data.concat(e),this.length=this.data.length}},r=this.compileHeader(e.header);t.add(r);var i=this.compileNameIndex(e.names);if(t.add(i),e.isCIDFont&&e.topDict.hasName("FontMatrix")){var o=e.topDict.getByName("FontMatrix");e.topDict.removeByName("FontMatrix");for(var a=0,s=e.fdArray.length;a<s;a++){var l=e.fdArray[a],c=o.slice(0);l.hasName("FontMatrix")&&(c=n.Util.transform(c,l.getByName("FontMatrix"))),l.setByName("FontMatrix",c)}}e.topDict.setByName("charset",0);var u=this.compileTopDicts([e.topDict],t.length,e.isCIDFont);t.add(u.output);var h=u.trackers[0],d=this.compileStringIndex(e.strings.strings);t.add(d);var f=this.compileIndex(e.globalSubrIndex);if(t.add(f),e.encoding&&e.topDict.hasName("Encoding"))if(e.encoding.predefined)h.setEntryLocation("Encoding",[e.encoding.format],t);else{var g=this.compileEncoding(e.encoding);h.setEntryLocation("Encoding",[t.length],t),t.add(g)}var p=this.compileCharset(e.charset,e.charStrings.count,e.strings,e.isCIDFont);h.setEntryLocation("charset",[t.length],t),t.add(p);var m=this.compileCharStrings(e.charStrings);if(h.setEntryLocation("CharStrings",[t.length],t),t.add(m),e.isCIDFont){h.setEntryLocation("FDSelect",[t.length],t);var v=this.compileFDSelect(e.fdSelect);t.add(v),u=this.compileTopDicts(e.fdArray,t.length,!0),h.setEntryLocation("FDArray",[t.length],t),t.add(u.output);var b=u.trackers;this.compilePrivateDicts(e.fdArray,b,t)}return this.compilePrivateDicts([e.topDict],[h],t),t.add([0]),t.data}encodeNumber(e){return Number.isInteger(e)?this.encodeInteger(e):this.encodeFloat(e)}static get EncodeFloatRegExp(){return(0,n.shadow)(this,"EncodeFloatRegExp",/\.(\d*?)(?:9{5,20}|0{5,20})\d{0,2}(?:e(.+)|$)/)}encodeFloat(e){var t=e.toString(),r=S.EncodeFloatRegExp.exec(t);if(r){var n=parseFloat("1e"+((r[2]?+r[2]:0)+r[1].length));t=(Math.round(e*n)/n).toString()}var i,o,a="";for(i=0,o=t.length;i<o;++i){var s=t[i];a+="e"===s?"-"===t[++i]?"c":"b":"."===s?"a":"-"===s?"e":s}var l=[30];for(i=0,o=(a+=1&a.length?"f":"ff").length;i<o;i+=2)l.push(parseInt(a.substring(i,i+2),16));return l}encodeInteger(e){return e>=-107&&e<=107?[e+139]:e>=108&&e<=1131?[247+((e-=108)>>8),255&e]:e>=-1131&&e<=-108?[251+((e=-e-108)>>8),255&e]:e>=-32768&&e<=32767?[28,e>>8&255,255&e]:[29,e>>24&255,e>>16&255,e>>8&255,255&e]}compileHeader(e){return[e.major,e.minor,e.hdrSize,e.offSize]}compileNameIndex(e){for(var t=new d,r=0,i=e.length;r<i;++r){for(var o=e[r],a=Math.min(o.length,127),s=new Array(a),l=0;l<a;l++){var c=o[l];(c<"!"||c>"~"||"["===c||"]"===c||"("===c||")"===c||"{"===c||"}"===c||"<"===c||">"===c||"/"===c||"%"===c)&&(c="_"),s[l]=c}""===(s=s.join(""))&&(s="Bad_Font_Name"),t.add((0,n.stringToBytes)(s))}return this.compileIndex(t)}compileTopDicts(e,t,r){for(var n=[],i=new d,o=0,a=e.length;o<a;++o){var s=e[o];r&&(s.removeByName("CIDFontVersion"),s.removeByName("CIDFontRevision"),s.removeByName("CIDFontType"),s.removeByName("CIDCount"),s.removeByName("UIDBase"));var l=new w,c=this.compileDict(s,l);n.push(l),i.add(c),l.offset(t)}return{trackers:n,output:i=this.compileIndex(i,n)}}compilePrivateDicts(e,t,r){for(var i=0,o=e.length;i<o;++i){var a=e[i],s=a.privateDict;if(!s||!a.hasName("Private"))throw new n.FormatError("There must be a private dictionary.");var l=new w,c=this.compileDict(s,l),u=r.length;if(l.offset(u),c.length||(u=0),t[i].setEntryLocation("Private",[c.length,u],r),r.add(c),s.subrsIndex&&s.hasName("Subrs")){var h=this.compileIndex(s.subrsIndex);l.setEntryLocation("Subrs",[c.length],r),r.add(h)}}}compileDict(e,t){for(var r=[],i=e.order,o=0;o<i.length;++o){var a=i[o];if(a in e.values){var s=e.values[a],l=e.types[a];if(Array.isArray(l)||(l=[l]),Array.isArray(s)||(s=[s]),0!==s.length){for(var c=0,u=l.length;c<u;++c){var h=l[c],d=s[c];switch(h){case"num":case"sid":r=r.concat(this.encodeNumber(d));break;case"offset":var f=e.keyToNameMap[a];t.isTracking(f)||t.track(f,r.length),r=r.concat([29,0,0,0,0]);break;case"array":case"delta":r=r.concat(this.encodeNumber(d));for(var g=1,p=s.length;g<p;++g)r=r.concat(this.encodeNumber(s[g]));break;default:throw new n.FormatError(`Unknown data type of ${h}`)}}r=r.concat(e.opcodes[a])}}}return r}compileStringIndex(e){for(var t=new d,r=0,i=e.length;r<i;++r)t.add((0,n.stringToBytes)(e[r]));return this.compileIndex(t)}compileGlobalSubrIndex(){var e=this.cff.globalSubrIndex;this.out.writeByteArray(this.compileIndex(e))}compileCharStrings(e){for(var t=new d,r=0;r<e.count;r++){var n=e.get(r);0!==n.length?t.add(n):t.add(new Uint8Array([139,14]))}return this.compileIndex(t)}compileCharset(e,t,r,i){let o;const a=t-1;if(i)o=new Uint8Array([2,0,0,a>>8&255,255&a]);else{o=new Uint8Array(1+2*a),o[0]=0;let t=0;const i=e.charset.length;let s=!1;for(let a=1;a<o.length;a+=2){let l=0;if(t<i){const i=e.charset[t++];l=r.getSID(i),-1===l&&(l=0,s||(s=!0,(0,n.warn)(`Couldn't find ${i} in CFF strings`)))}o[a]=l>>8&255,o[a+1]=255&l}}return this.compileTypedArray(o)}compileEncoding(e){return this.compileTypedArray(e.raw)}compileFDSelect(e){const t=e.format;let r,n;switch(t){case 0:for(r=new Uint8Array(1+e.fdSelect.length),r[0]=t,n=0;n<e.fdSelect.length;n++)r[n+1]=e.fdSelect[n];break;case 3:const i=0;let o=e.fdSelect[0];const a=[t,0,0,i>>8&255,255&i,o];for(n=1;n<e.fdSelect.length;n++){const t=e.fdSelect[n];t!==o&&(a.push(n>>8&255,255&n,t),o=t)}const s=(a.length-3)/3;a[1]=s>>8&255,a[2]=255&s,a.push(n>>8&255,255&n),r=new Uint8Array(a)}return this.compileTypedArray(r)}compileTypedArray(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e[r];return t}compileIndex(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];var r=e.objects,n=r.length;if(0===n)return[0,0,0];var i,o,a=[n>>8&255,255&n],s=1;for(i=0;i<n;++i)s+=r[i].length;o=s<256?1:s<65536?2:s<16777216?3:4,a.push(o);var l=1;for(i=0;i<n+1;i++)1===o?a.push(255&l):2===o?a.push(l>>8&255,255&l):3===o?a.push(l>>16&255,l>>8&255,255&l):a.push(l>>>24&255,l>>16&255,l>>8&255,255&l),r[i]&&(l+=r[i].length);for(i=0;i<n;i++){t[i]&&t[i].offset(a.length);for(var c=0,u=r[i].length;c<u;c++)a.push(r[i][c])}return a}}t.CFFCompiler=S},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExpertSubsetCharset=t.ExpertCharset=t.ISOAdobeCharset=void 0,t.ISOAdobeCharset=[".notdef","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quoteright","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","quoteleft","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","exclamdown","cent","sterling","fraction","yen","florin","section","currency","quotesingle","quotedblleft","guillemotleft","guilsinglleft","guilsinglright","fi","fl","endash","dagger","daggerdbl","periodcentered","paragraph","bullet","quotesinglbase","quotedblbase","quotedblright","guillemotright","ellipsis","perthousand","questiondown","grave","acute","circumflex","tilde","macron","breve","dotaccent","dieresis","ring","cedilla","hungarumlaut","ogonek","caron","emdash","AE","ordfeminine","Lslash","Oslash","OE","ordmasculine","ae","dotlessi","lslash","oslash","oe","germandbls","onesuperior","logicalnot","mu","trademark","Eth","onehalf","plusminus","Thorn","onequarter","divide","brokenbar","degree","thorn","threequarters","twosuperior","registered","minus","eth","multiply","threesuperior","copyright","Aacute","Acircumflex","Adieresis","Agrave","Aring","Atilde","Ccedilla","Eacute","Ecircumflex","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Ntilde","Oacute","Ocircumflex","Odieresis","Ograve","Otilde","Scaron","Uacute","Ucircumflex","Udieresis","Ugrave","Yacute","Ydieresis","Zcaron","aacute","acircumflex","adieresis","agrave","aring","atilde","ccedilla","eacute","ecircumflex","edieresis","egrave","iacute","icircumflex","idieresis","igrave","ntilde","oacute","ocircumflex","odieresis","ograve","otilde","scaron","uacute","ucircumflex","udieresis","ugrave","yacute","ydieresis","zcaron"],t.ExpertCharset=[".notdef","space","exclamsmall","Hungarumlautsmall","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","twodotenleader","onedotenleader","comma","hyphen","period","fraction","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","colon","semicolon","commasuperior","threequartersemdash","periodsuperior","questionsmall","asuperior","bsuperior","centsuperior","dsuperior","esuperior","isuperior","lsuperior","msuperior","nsuperior","osuperior","rsuperior","ssuperior","tsuperior","ff","fi","fl","ffi","ffl","parenleftinferior","parenrightinferior","Circumflexsmall","hyphensuperior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","exclamdownsmall","centoldstyle","Lslashsmall","Scaronsmall","Zcaronsmall","Dieresissmall","Brevesmall","Caronsmall","Dotaccentsmall","Macronsmall","figuredash","hypheninferior","Ogoneksmall","Ringsmall","Cedillasmall","onequarter","onehalf","threequarters","questiondownsmall","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","zerosuperior","onesuperior","twosuperior","threesuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior","Agravesmall","Aacutesmall","Acircumflexsmall","Atildesmall","Adieresissmall","Aringsmall","AEsmall","Ccedillasmall","Egravesmall","Eacutesmall","Ecircumflexsmall","Edieresissmall","Igravesmall","Iacutesmall","Icircumflexsmall","Idieresissmall","Ethsmall","Ntildesmall","Ogravesmall","Oacutesmall","Ocircumflexsmall","Otildesmall","Odieresissmall","OEsmall","Oslashsmall","Ugravesmall","Uacutesmall","Ucircumflexsmall","Udieresissmall","Yacutesmall","Thornsmall","Ydieresissmall"],t.ExpertSubsetCharset=[".notdef","space","dollaroldstyle","dollarsuperior","parenleftsuperior","parenrightsuperior","twodotenleader","onedotenleader","comma","hyphen","period","fraction","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","colon","semicolon","commasuperior","threequartersemdash","periodsuperior","asuperior","bsuperior","centsuperior","dsuperior","esuperior","isuperior","lsuperior","msuperior","nsuperior","osuperior","rsuperior","ssuperior","tsuperior","ff","fi","fl","ffi","ffl","parenleftinferior","parenrightinferior","hyphensuperior","colonmonetary","onefitted","rupiah","centoldstyle","figuredash","hypheninferior","onequarter","onehalf","threequarters","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","zerosuperior","onesuperior","twosuperior","threesuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior"]},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getEncoding=function(e){switch(e){case"WinAnsiEncoding":return s;case"StandardEncoding":return a;case"MacRomanEncoding":return o;case"SymbolSetEncoding":return l;case"ZapfDingbatsEncoding":return c;case"ExpertEncoding":return n;case"MacExpertEncoding":return i;default:return null}},t.ExpertEncoding=t.ZapfDingbatsEncoding=t.SymbolSetEncoding=t.MacRomanEncoding=t.StandardEncoding=t.WinAnsiEncoding=void 0;const n=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclamsmall","Hungarumlautsmall","","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","twodotenleader","onedotenleader","comma","hyphen","period","fraction","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","colon","semicolon","commasuperior","threequartersemdash","periodsuperior","questionsmall","","asuperior","bsuperior","centsuperior","dsuperior","esuperior","","","","isuperior","","","lsuperior","msuperior","nsuperior","osuperior","","","rsuperior","ssuperior","tsuperior","","ff","fi","fl","ffi","ffl","parenleftinferior","","parenrightinferior","Circumflexsmall","hyphensuperior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","exclamdownsmall","centoldstyle","Lslashsmall","","","Scaronsmall","Zcaronsmall","Dieresissmall","Brevesmall","Caronsmall","","Dotaccentsmall","","","Macronsmall","","","figuredash","hypheninferior","","","Ogoneksmall","Ringsmall","Cedillasmall","","","","onequarter","onehalf","threequarters","questiondownsmall","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","","","zerosuperior","onesuperior","twosuperior","threesuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior","Agravesmall","Aacutesmall","Acircumflexsmall","Atildesmall","Adieresissmall","Aringsmall","AEsmall","Ccedillasmall","Egravesmall","Eacutesmall","Ecircumflexsmall","Edieresissmall","Igravesmall","Iacutesmall","Icircumflexsmall","Idieresissmall","Ethsmall","Ntildesmall","Ogravesmall","Oacutesmall","Ocircumflexsmall","Otildesmall","Odieresissmall","OEsmall","Oslashsmall","Ugravesmall","Uacutesmall","Ucircumflexsmall","Udieresissmall","Yacutesmall","Thornsmall","Ydieresissmall"];t.ExpertEncoding=n;const i=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclamsmall","Hungarumlautsmall","centoldstyle","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","twodotenleader","onedotenleader","comma","hyphen","period","fraction","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","colon","semicolon","","threequartersemdash","","questionsmall","","","","","Ethsmall","","","onequarter","onehalf","threequarters","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","","","","","","","ff","fi","fl","ffi","ffl","parenleftinferior","","parenrightinferior","Circumflexsmall","hypheninferior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","","","asuperior","centsuperior","","","","","Aacutesmall","Agravesmall","Acircumflexsmall","Adieresissmall","Atildesmall","Aringsmall","Ccedillasmall","Eacutesmall","Egravesmall","Ecircumflexsmall","Edieresissmall","Iacutesmall","Igravesmall","Icircumflexsmall","Idieresissmall","Ntildesmall","Oacutesmall","Ogravesmall","Ocircumflexsmall","Odieresissmall","Otildesmall","Uacutesmall","Ugravesmall","Ucircumflexsmall","Udieresissmall","","eightsuperior","fourinferior","threeinferior","sixinferior","eightinferior","seveninferior","Scaronsmall","","centinferior","twoinferior","","Dieresissmall","","Caronsmall","osuperior","fiveinferior","","commainferior","periodinferior","Yacutesmall","","dollarinferior","","","Thornsmall","","nineinferior","zeroinferior","Zcaronsmall","AEsmall","Oslashsmall","questiondownsmall","oneinferior","Lslashsmall","","","","","","","Cedillasmall","","","","","","OEsmall","figuredash","hyphensuperior","","","","","exclamdownsmall","","Ydieresissmall","","onesuperior","twosuperior","threesuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","ninesuperior","zerosuperior","","esuperior","rsuperior","tsuperior","","","isuperior","ssuperior","dsuperior","","","","","","lsuperior","Ogoneksmall","Brevesmall","Macronsmall","bsuperior","nsuperior","msuperior","commasuperior","periodsuperior","Dotaccentsmall","Ringsmall","","","",""],o=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quotesingle","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","grave","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","","Adieresis","Aring","Ccedilla","Eacute","Ntilde","Odieresis","Udieresis","aacute","agrave","acircumflex","adieresis","atilde","aring","ccedilla","eacute","egrave","ecircumflex","edieresis","iacute","igrave","icircumflex","idieresis","ntilde","oacute","ograve","ocircumflex","odieresis","otilde","uacute","ugrave","ucircumflex","udieresis","dagger","degree","cent","sterling","section","bullet","paragraph","germandbls","registered","copyright","trademark","acute","dieresis","notequal","AE","Oslash","infinity","plusminus","lessequal","greaterequal","yen","mu","partialdiff","summation","product","pi","integral","ordfeminine","ordmasculine","Omega","ae","oslash","questiondown","exclamdown","logicalnot","radical","florin","approxequal","Delta","guillemotleft","guillemotright","ellipsis","space","Agrave","Atilde","Otilde","OE","oe","endash","emdash","quotedblleft","quotedblright","quoteleft","quoteright","divide","lozenge","ydieresis","Ydieresis","fraction","currency","guilsinglleft","guilsinglright","fi","fl","daggerdbl","periodcentered","quotesinglbase","quotedblbase","perthousand","Acircumflex","Ecircumflex","Aacute","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Oacute","Ocircumflex","apple","Ograve","Uacute","Ucircumflex","Ugrave","dotlessi","circumflex","tilde","macron","breve","dotaccent","ring","cedilla","hungarumlaut","ogonek","caron"];t.MacRomanEncoding=o;const a=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quoteright","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","quoteleft","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","exclamdown","cent","sterling","fraction","yen","florin","section","currency","quotesingle","quotedblleft","guillemotleft","guilsinglleft","guilsinglright","fi","fl","","endash","dagger","daggerdbl","periodcentered","","paragraph","bullet","quotesinglbase","quotedblbase","quotedblright","guillemotright","ellipsis","perthousand","","questiondown","","grave","acute","circumflex","tilde","macron","breve","dotaccent","dieresis","","ring","cedilla","","hungarumlaut","ogonek","caron","emdash","","","","","","","","","","","","","","","","","AE","","ordfeminine","","","","","Lslash","Oslash","OE","ordmasculine","","","","","","ae","","","","dotlessi","","","lslash","oslash","oe","germandbls","","","",""];t.StandardEncoding=a;const s=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quotesingle","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","grave","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","bullet","Euro","bullet","quotesinglbase","florin","quotedblbase","ellipsis","dagger","daggerdbl","circumflex","perthousand","Scaron","guilsinglleft","OE","bullet","Zcaron","bullet","bullet","quoteleft","quoteright","quotedblleft","quotedblright","bullet","endash","emdash","tilde","trademark","scaron","guilsinglright","oe","bullet","zcaron","Ydieresis","space","exclamdown","cent","sterling","currency","yen","brokenbar","section","dieresis","copyright","ordfeminine","guillemotleft","logicalnot","hyphen","registered","macron","degree","plusminus","twosuperior","threesuperior","acute","mu","paragraph","periodcentered","cedilla","onesuperior","ordmasculine","guillemotright","onequarter","onehalf","threequarters","questiondown","Agrave","Aacute","Acircumflex","Atilde","Adieresis","Aring","AE","Ccedilla","Egrave","Eacute","Ecircumflex","Edieresis","Igrave","Iacute","Icircumflex","Idieresis","Eth","Ntilde","Ograve","Oacute","Ocircumflex","Otilde","Odieresis","multiply","Oslash","Ugrave","Uacute","Ucircumflex","Udieresis","Yacute","Thorn","germandbls","agrave","aacute","acircumflex","atilde","adieresis","aring","ae","ccedilla","egrave","eacute","ecircumflex","edieresis","igrave","iacute","icircumflex","idieresis","eth","ntilde","ograve","oacute","ocircumflex","otilde","odieresis","divide","oslash","ugrave","uacute","ucircumflex","udieresis","yacute","thorn","ydieresis"];t.WinAnsiEncoding=s;const l=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclam","universal","numbersign","existential","percent","ampersand","suchthat","parenleft","parenright","asteriskmath","plus","comma","minus","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","congruent","Alpha","Beta","Chi","Delta","Epsilon","Phi","Gamma","Eta","Iota","theta1","Kappa","Lambda","Mu","Nu","Omicron","Pi","Theta","Rho","Sigma","Tau","Upsilon","sigma1","Omega","Xi","Psi","Zeta","bracketleft","therefore","bracketright","perpendicular","underscore","radicalex","alpha","beta","chi","delta","epsilon","phi","gamma","eta","iota","phi1","kappa","lambda","mu","nu","omicron","pi","theta","rho","sigma","tau","upsilon","omega1","omega","xi","psi","zeta","braceleft","bar","braceright","similar","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","Euro","Upsilon1","minute","lessequal","fraction","infinity","florin","club","diamond","heart","spade","arrowboth","arrowleft","arrowup","arrowright","arrowdown","degree","plusminus","second","greaterequal","multiply","proportional","partialdiff","bullet","divide","notequal","equivalence","approxequal","ellipsis","arrowvertex","arrowhorizex","carriagereturn","aleph","Ifraktur","Rfraktur","weierstrass","circlemultiply","circleplus","emptyset","intersection","union","propersuperset","reflexsuperset","notsubset","propersubset","reflexsubset","element","notelement","angle","gradient","registerserif","copyrightserif","trademarkserif","product","radical","dotmath","logicalnot","logicaland","logicalor","arrowdblboth","arrowdblleft","arrowdblup","arrowdblright","arrowdbldown","lozenge","angleleft","registersans","copyrightsans","trademarksans","summation","parenlefttp","parenleftex","parenleftbt","bracketlefttp","bracketleftex","bracketleftbt","bracelefttp","braceleftmid","braceleftbt","braceex","","angleright","integral","integraltp","integralex","integralbt","parenrighttp","parenrightex","parenrightbt","bracketrighttp","bracketrightex","bracketrightbt","bracerighttp","bracerightmid","bracerightbt",""];t.SymbolSetEncoding=l;const c=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","a1","a2","a202","a3","a4","a5","a119","a118","a117","a11","a12","a13","a14","a15","a16","a105","a17","a18","a19","a20","a21","a22","a23","a24","a25","a26","a27","a28","a6","a7","a8","a9","a10","a29","a30","a31","a32","a33","a34","a35","a36","a37","a38","a39","a40","a41","a42","a43","a44","a45","a46","a47","a48","a49","a50","a51","a52","a53","a54","a55","a56","a57","a58","a59","a60","a61","a62","a63","a64","a65","a66","a67","a68","a69","a70","a71","a72","a73","a74","a203","a75","a204","a76","a77","a78","a79","a81","a82","a83","a84","a97","a98","a99","a100","","a89","a90","a93","a94","a91","a92","a205","a85","a206","a86","a87","a88","a95","a96","","","","","","","","","","","","","","","","","","","","a101","a102","a103","a104","a106","a107","a108","a112","a111","a110","a109","a120","a121","a122","a123","a124","a125","a126","a127","a128","a129","a130","a131","a132","a133","a134","a135","a136","a137","a138","a139","a140","a141","a142","a143","a144","a145","a146","a147","a148","a149","a150","a151","a152","a153","a154","a155","a156","a157","a158","a159","a160","a161","a163","a164","a196","a165","a192","a166","a167","a168","a169","a170","a171","a172","a173","a162","a174","a175","a176","a177","a178","a179","a193","a180","a199","a181","a200","a182","","a201","a183","a184","a197","a185","a194","a198","a186","a195","a187","a188","a189","a190","a191",""];t.ZapfDingbatsEncoding=c},function(e,t,r){var n=r(8).getLookupTableFactory,i=n((function(e){e.A=65,e.AE=198,e.AEacute=508,e.AEmacron=482,e.AEsmall=63462,e.Aacute=193,e.Aacutesmall=63457,e.Abreve=258,e.Abreveacute=7854,e.Abrevecyrillic=1232,e.Abrevedotbelow=7862,e.Abrevegrave=7856,e.Abrevehookabove=7858,e.Abrevetilde=7860,e.Acaron=461,e.Acircle=9398,e.Acircumflex=194,e.Acircumflexacute=7844,e.Acircumflexdotbelow=7852,e.Acircumflexgrave=7846,e.Acircumflexhookabove=7848,e.Acircumflexsmall=63458,e.Acircumflextilde=7850,e.Acute=63177,e.Acutesmall=63412,e.Acyrillic=1040,e.Adblgrave=512,e.Adieresis=196,e.Adieresiscyrillic=1234,e.Adieresismacron=478,e.Adieresissmall=63460,e.Adotbelow=7840,e.Adotmacron=480,e.Agrave=192,e.Agravesmall=63456,e.Ahookabove=7842,e.Aiecyrillic=1236,e.Ainvertedbreve=514,e.Alpha=913,e.Alphatonos=902,e.Amacron=256,e.Amonospace=65313,e.Aogonek=260,e.Aring=197,e.Aringacute=506,e.Aringbelow=7680,e.Aringsmall=63461,e.Asmall=63329,e.Atilde=195,e.Atildesmall=63459,e.Aybarmenian=1329,e.B=66,e.Bcircle=9399,e.Bdotaccent=7682,e.Bdotbelow=7684,e.Becyrillic=1041,e.Benarmenian=1330,e.Beta=914,e.Bhook=385,e.Blinebelow=7686,e.Bmonospace=65314,e.Brevesmall=63220,e.Bsmall=63330,e.Btopbar=386,e.C=67,e.Caarmenian=1342,e.Cacute=262,e.Caron=63178,e.Caronsmall=63221,e.Ccaron=268,e.Ccedilla=199,e.Ccedillaacute=7688,e.Ccedillasmall=63463,e.Ccircle=9400,e.Ccircumflex=264,e.Cdot=266,e.Cdotaccent=266,e.Cedillasmall=63416,e.Chaarmenian=1353,e.Cheabkhasiancyrillic=1212,e.Checyrillic=1063,e.Chedescenderabkhasiancyrillic=1214,e.Chedescendercyrillic=1206,e.Chedieresiscyrillic=1268,e.Cheharmenian=1347,e.Chekhakassiancyrillic=1227,e.Cheverticalstrokecyrillic=1208,e.Chi=935,e.Chook=391,e.Circumflexsmall=63222,e.Cmonospace=65315,e.Coarmenian=1361,e.Csmall=63331,e.D=68,e.DZ=497,e.DZcaron=452,e.Daarmenian=1332,e.Dafrican=393,e.Dcaron=270,e.Dcedilla=7696,e.Dcircle=9401,e.Dcircumflexbelow=7698,e.Dcroat=272,e.Ddotaccent=7690,e.Ddotbelow=7692,e.Decyrillic=1044,e.Deicoptic=1006,e.Delta=8710,e.Deltagreek=916,e.Dhook=394,e.Dieresis=63179,e.DieresisAcute=63180,e.DieresisGrave=63181,e.Dieresissmall=63400,e.Digammagreek=988,e.Djecyrillic=1026,e.Dlinebelow=7694,e.Dmonospace=65316,e.Dotaccentsmall=63223,e.Dslash=272,e.Dsmall=63332,e.Dtopbar=395,e.Dz=498,e.Dzcaron=453,e.Dzeabkhasiancyrillic=1248,e.Dzecyrillic=1029,e.Dzhecyrillic=1039,e.E=69,e.Eacute=201,e.Eacutesmall=63465,e.Ebreve=276,e.Ecaron=282,e.Ecedillabreve=7708,e.Echarmenian=1333,e.Ecircle=9402,e.Ecircumflex=202,e.Ecircumflexacute=7870,e.Ecircumflexbelow=7704,e.Ecircumflexdotbelow=7878,e.Ecircumflexgrave=7872,e.Ecircumflexhookabove=7874,e.Ecircumflexsmall=63466,e.Ecircumflextilde=7876,e.Ecyrillic=1028,e.Edblgrave=516,e.Edieresis=203,e.Edieresissmall=63467,e.Edot=278,e.Edotaccent=278,e.Edotbelow=7864,e.Efcyrillic=1060,e.Egrave=200,e.Egravesmall=63464,e.Eharmenian=1335,e.Ehookabove=7866,e.Eightroman=8551,e.Einvertedbreve=518,e.Eiotifiedcyrillic=1124,e.Elcyrillic=1051,e.Elevenroman=8554,e.Emacron=274,e.Emacronacute=7702,e.Emacrongrave=7700,e.Emcyrillic=1052,e.Emonospace=65317,e.Encyrillic=1053,e.Endescendercyrillic=1186,e.Eng=330,e.Enghecyrillic=1188,e.Enhookcyrillic=1223,e.Eogonek=280,e.Eopen=400,e.Epsilon=917,e.Epsilontonos=904,e.Ercyrillic=1056,e.Ereversed=398,e.Ereversedcyrillic=1069,e.Escyrillic=1057,e.Esdescendercyrillic=1194,e.Esh=425,e.Esmall=63333,e.Eta=919,e.Etarmenian=1336,e.Etatonos=905,e.Eth=208,e.Ethsmall=63472,e.Etilde=7868,e.Etildebelow=7706,e.Euro=8364,e.Ezh=439,e.Ezhcaron=494,e.Ezhreversed=440,e.F=70,e.Fcircle=9403,e.Fdotaccent=7710,e.Feharmenian=1366,e.Feicoptic=996,e.Fhook=401,e.Fitacyrillic=1138,e.Fiveroman=8548,e.Fmonospace=65318,e.Fourroman=8547,e.Fsmall=63334,e.G=71,e.GBsquare=13191,e.Gacute=500,e.Gamma=915,e.Gammaafrican=404,e.Gangiacoptic=1002,e.Gbreve=286,e.Gcaron=486,e.Gcedilla=290,e.Gcircle=9404,e.Gcircumflex=284,e.Gcommaaccent=290,e.Gdot=288,e.Gdotaccent=288,e.Gecyrillic=1043,e.Ghadarmenian=1346,e.Ghemiddlehookcyrillic=1172,e.Ghestrokecyrillic=1170,e.Gheupturncyrillic=1168,e.Ghook=403,e.Gimarmenian=1331,e.Gjecyrillic=1027,e.Gmacron=7712,e.Gmonospace=65319,e.Grave=63182,e.Gravesmall=63328,e.Gsmall=63335,e.Gsmallhook=667,e.Gstroke=484,e.H=72,e.H18533=9679,e.H18543=9642,e.H18551=9643,e.H22073=9633,e.HPsquare=13259,e.Haabkhasiancyrillic=1192,e.Hadescendercyrillic=1202,e.Hardsigncyrillic=1066,e.Hbar=294,e.Hbrevebelow=7722,e.Hcedilla=7720,e.Hcircle=9405,e.Hcircumflex=292,e.Hdieresis=7718,e.Hdotaccent=7714,e.Hdotbelow=7716,e.Hmonospace=65320,e.Hoarmenian=1344,e.Horicoptic=1e3,e.Hsmall=63336,e.Hungarumlaut=63183,e.Hungarumlautsmall=63224,e.Hzsquare=13200,e.I=73,e.IAcyrillic=1071,e.IJ=306,e.IUcyrillic=1070,e.Iacute=205,e.Iacutesmall=63469,e.Ibreve=300,e.Icaron=463,e.Icircle=9406,e.Icircumflex=206,e.Icircumflexsmall=63470,e.Icyrillic=1030,e.Idblgrave=520,e.Idieresis=207,e.Idieresisacute=7726,e.Idieresiscyrillic=1252,e.Idieresissmall=63471,e.Idot=304,e.Idotaccent=304,e.Idotbelow=7882,e.Iebrevecyrillic=1238,e.Iecyrillic=1045,e.Ifraktur=8465,e.Igrave=204,e.Igravesmall=63468,e.Ihookabove=7880,e.Iicyrillic=1048,e.Iinvertedbreve=522,e.Iishortcyrillic=1049,e.Imacron=298,e.Imacroncyrillic=1250,e.Imonospace=65321,e.Iniarmenian=1339,e.Iocyrillic=1025,e.Iogonek=302,e.Iota=921,e.Iotaafrican=406,e.Iotadieresis=938,e.Iotatonos=906,e.Ismall=63337,e.Istroke=407,e.Itilde=296,e.Itildebelow=7724,e.Izhitsacyrillic=1140,e.Izhitsadblgravecyrillic=1142,e.J=74,e.Jaarmenian=1345,e.Jcircle=9407,e.Jcircumflex=308,e.Jecyrillic=1032,e.Jheharmenian=1355,e.Jmonospace=65322,e.Jsmall=63338,e.K=75,e.KBsquare=13189,e.KKsquare=13261,e.Kabashkircyrillic=1184,e.Kacute=7728,e.Kacyrillic=1050,e.Kadescendercyrillic=1178,e.Kahookcyrillic=1219,e.Kappa=922,e.Kastrokecyrillic=1182,e.Kaverticalstrokecyrillic=1180,e.Kcaron=488,e.Kcedilla=310,e.Kcircle=9408,e.Kcommaaccent=310,e.Kdotbelow=7730,e.Keharmenian=1364,e.Kenarmenian=1343,e.Khacyrillic=1061,e.Kheicoptic=998,e.Khook=408,e.Kjecyrillic=1036,e.Klinebelow=7732,e.Kmonospace=65323,e.Koppacyrillic=1152,e.Koppagreek=990,e.Ksicyrillic=1134,e.Ksmall=63339,e.L=76,e.LJ=455,e.LL=63167,e.Lacute=313,e.Lambda=923,e.Lcaron=317,e.Lcedilla=315,e.Lcircle=9409,e.Lcircumflexbelow=7740,e.Lcommaaccent=315,e.Ldot=319,e.Ldotaccent=319,e.Ldotbelow=7734,e.Ldotbelowmacron=7736,e.Liwnarmenian=1340,e.Lj=456,e.Ljecyrillic=1033,e.Llinebelow=7738,e.Lmonospace=65324,e.Lslash=321,e.Lslashsmall=63225,e.Lsmall=63340,e.M=77,e.MBsquare=13190,e.Macron=63184,e.Macronsmall=63407,e.Macute=7742,e.Mcircle=9410,e.Mdotaccent=7744,e.Mdotbelow=7746,e.Menarmenian=1348,e.Mmonospace=65325,e.Msmall=63341,e.Mturned=412,e.Mu=924,e.N=78,e.NJ=458,e.Nacute=323,e.Ncaron=327,e.Ncedilla=325,e.Ncircle=9411,e.Ncircumflexbelow=7754,e.Ncommaaccent=325,e.Ndotaccent=7748,e.Ndotbelow=7750,e.Nhookleft=413,e.Nineroman=8552,e.Nj=459,e.Njecyrillic=1034,e.Nlinebelow=7752,e.Nmonospace=65326,e.Nowarmenian=1350,e.Nsmall=63342,e.Ntilde=209,e.Ntildesmall=63473,e.Nu=925,e.O=79,e.OE=338,e.OEsmall=63226,e.Oacute=211,e.Oacutesmall=63475,e.Obarredcyrillic=1256,e.Obarreddieresiscyrillic=1258,e.Obreve=334,e.Ocaron=465,e.Ocenteredtilde=415,e.Ocircle=9412,e.Ocircumflex=212,e.Ocircumflexacute=7888,e.Ocircumflexdotbelow=7896,e.Ocircumflexgrave=7890,e.Ocircumflexhookabove=7892,e.Ocircumflexsmall=63476,e.Ocircumflextilde=7894,e.Ocyrillic=1054,e.Odblacute=336,e.Odblgrave=524,e.Odieresis=214,e.Odieresiscyrillic=1254,e.Odieresissmall=63478,e.Odotbelow=7884,e.Ogoneksmall=63227,e.Ograve=210,e.Ogravesmall=63474,e.Oharmenian=1365,e.Ohm=8486,e.Ohookabove=7886,e.Ohorn=416,e.Ohornacute=7898,e.Ohorndotbelow=7906,e.Ohorngrave=7900,e.Ohornhookabove=7902,e.Ohorntilde=7904,e.Ohungarumlaut=336,e.Oi=418,e.Oinvertedbreve=526,e.Omacron=332,e.Omacronacute=7762,e.Omacrongrave=7760,e.Omega=8486,e.Omegacyrillic=1120,e.Omegagreek=937,e.Omegaroundcyrillic=1146,e.Omegatitlocyrillic=1148,e.Omegatonos=911,e.Omicron=927,e.Omicrontonos=908,e.Omonospace=65327,e.Oneroman=8544,e.Oogonek=490,e.Oogonekmacron=492,e.Oopen=390,e.Oslash=216,e.Oslashacute=510,e.Oslashsmall=63480,e.Osmall=63343,e.Ostrokeacute=510,e.Otcyrillic=1150,e.Otilde=213,e.Otildeacute=7756,e.Otildedieresis=7758,e.Otildesmall=63477,e.P=80,e.Pacute=7764,e.Pcircle=9413,e.Pdotaccent=7766,e.Pecyrillic=1055,e.Peharmenian=1354,e.Pemiddlehookcyrillic=1190,e.Phi=934,e.Phook=420,e.Pi=928,e.Piwrarmenian=1363,e.Pmonospace=65328,e.Psi=936,e.Psicyrillic=1136,e.Psmall=63344,e.Q=81,e.Qcircle=9414,e.Qmonospace=65329,e.Qsmall=63345,e.R=82,e.Raarmenian=1356,e.Racute=340,e.Rcaron=344,e.Rcedilla=342,e.Rcircle=9415,e.Rcommaaccent=342,e.Rdblgrave=528,e.Rdotaccent=7768,e.Rdotbelow=7770,e.Rdotbelowmacron=7772,e.Reharmenian=1360,e.Rfraktur=8476,e.Rho=929,e.Ringsmall=63228,e.Rinvertedbreve=530,e.Rlinebelow=7774,e.Rmonospace=65330,e.Rsmall=63346,e.Rsmallinverted=641,e.Rsmallinvertedsuperior=694,e.S=83,e.SF010000=9484,e.SF020000=9492,e.SF030000=9488,e.SF040000=9496,e.SF050000=9532,e.SF060000=9516,e.SF070000=9524,e.SF080000=9500,e.SF090000=9508,e.SF100000=9472,e.SF110000=9474,e.SF190000=9569,e.SF200000=9570,e.SF210000=9558,e.SF220000=9557,e.SF230000=9571,e.SF240000=9553,e.SF250000=9559,e.SF260000=9565,e.SF270000=9564,e.SF280000=9563,e.SF360000=9566,e.SF370000=9567,e.SF380000=9562,e.SF390000=9556,e.SF400000=9577,e.SF410000=9574,e.SF420000=9568,e.SF430000=9552,e.SF440000=9580,e.SF450000=9575,e.SF460000=9576,e.SF470000=9572,e.SF480000=9573,e.SF490000=9561,e.SF500000=9560,e.SF510000=9554,e.SF520000=9555,e.SF530000=9579,e.SF540000=9578,e.Sacute=346,e.Sacutedotaccent=7780,e.Sampigreek=992,e.Scaron=352,e.Scarondotaccent=7782,e.Scaronsmall=63229,e.Scedilla=350,e.Schwa=399,e.Schwacyrillic=1240,e.Schwadieresiscyrillic=1242,e.Scircle=9416,e.Scircumflex=348,e.Scommaaccent=536,e.Sdotaccent=7776,e.Sdotbelow=7778,e.Sdotbelowdotaccent=7784,e.Seharmenian=1357,e.Sevenroman=8550,e.Shaarmenian=1351,e.Shacyrillic=1064,e.Shchacyrillic=1065,e.Sheicoptic=994,e.Shhacyrillic=1210,e.Shimacoptic=1004,e.Sigma=931,e.Sixroman=8549,e.Smonospace=65331,e.Softsigncyrillic=1068,e.Ssmall=63347,e.Stigmagreek=986,e.T=84,e.Tau=932,e.Tbar=358,e.Tcaron=356,e.Tcedilla=354,e.Tcircle=9417,e.Tcircumflexbelow=7792,e.Tcommaaccent=354,e.Tdotaccent=7786,e.Tdotbelow=7788,e.Tecyrillic=1058,e.Tedescendercyrillic=1196,e.Tenroman=8553,e.Tetsecyrillic=1204,e.Theta=920,e.Thook=428,e.Thorn=222,e.Thornsmall=63486,e.Threeroman=8546,e.Tildesmall=63230,e.Tiwnarmenian=1359,e.Tlinebelow=7790,e.Tmonospace=65332,e.Toarmenian=1337,e.Tonefive=444,e.Tonesix=388,e.Tonetwo=423,e.Tretroflexhook=430,e.Tsecyrillic=1062,e.Tshecyrillic=1035,e.Tsmall=63348,e.Twelveroman=8555,e.Tworoman=8545,e.U=85,e.Uacute=218,e.Uacutesmall=63482,e.Ubreve=364,e.Ucaron=467,e.Ucircle=9418,e.Ucircumflex=219,e.Ucircumflexbelow=7798,e.Ucircumflexsmall=63483,e.Ucyrillic=1059,e.Udblacute=368,e.Udblgrave=532,e.Udieresis=220,e.Udieresisacute=471,e.Udieresisbelow=7794,e.Udieresiscaron=473,e.Udieresiscyrillic=1264,e.Udieresisgrave=475,e.Udieresismacron=469,e.Udieresissmall=63484,e.Udotbelow=7908,e.Ugrave=217,e.Ugravesmall=63481,e.Uhookabove=7910,e.Uhorn=431,e.Uhornacute=7912,e.Uhorndotbelow=7920,e.Uhorngrave=7914,e.Uhornhookabove=7916,e.Uhorntilde=7918,e.Uhungarumlaut=368,e.Uhungarumlautcyrillic=1266,e.Uinvertedbreve=534,e.Ukcyrillic=1144,e.Umacron=362,e.Umacroncyrillic=1262,e.Umacrondieresis=7802,e.Umonospace=65333,e.Uogonek=370,e.Upsilon=933,e.Upsilon1=978,e.Upsilonacutehooksymbolgreek=979,e.Upsilonafrican=433,e.Upsilondieresis=939,e.Upsilondieresishooksymbolgreek=980,e.Upsilonhooksymbol=978,e.Upsilontonos=910,e.Uring=366,e.Ushortcyrillic=1038,e.Usmall=63349,e.Ustraightcyrillic=1198,e.Ustraightstrokecyrillic=1200,e.Utilde=360,e.Utildeacute=7800,e.Utildebelow=7796,e.V=86,e.Vcircle=9419,e.Vdotbelow=7806,e.Vecyrillic=1042,e.Vewarmenian=1358,e.Vhook=434,e.Vmonospace=65334,e.Voarmenian=1352,e.Vsmall=63350,e.Vtilde=7804,e.W=87,e.Wacute=7810,e.Wcircle=9420,e.Wcircumflex=372,e.Wdieresis=7812,e.Wdotaccent=7814,e.Wdotbelow=7816,e.Wgrave=7808,e.Wmonospace=65335,e.Wsmall=63351,e.X=88,e.Xcircle=9421,e.Xdieresis=7820,e.Xdotaccent=7818,e.Xeharmenian=1341,e.Xi=926,e.Xmonospace=65336,e.Xsmall=63352,e.Y=89,e.Yacute=221,e.Yacutesmall=63485,e.Yatcyrillic=1122,e.Ycircle=9422,e.Ycircumflex=374,e.Ydieresis=376,e.Ydieresissmall=63487,e.Ydotaccent=7822,e.Ydotbelow=7924,e.Yericyrillic=1067,e.Yerudieresiscyrillic=1272,e.Ygrave=7922,e.Yhook=435,e.Yhookabove=7926,e.Yiarmenian=1349,e.Yicyrillic=1031,e.Yiwnarmenian=1362,e.Ymonospace=65337,e.Ysmall=63353,e.Ytilde=7928,e.Yusbigcyrillic=1130,e.Yusbigiotifiedcyrillic=1132,e.Yuslittlecyrillic=1126,e.Yuslittleiotifiedcyrillic=1128,e.Z=90,e.Zaarmenian=1334,e.Zacute=377,e.Zcaron=381,e.Zcaronsmall=63231,e.Zcircle=9423,e.Zcircumflex=7824,e.Zdot=379,e.Zdotaccent=379,e.Zdotbelow=7826,e.Zecyrillic=1047,e.Zedescendercyrillic=1176,e.Zedieresiscyrillic=1246,e.Zeta=918,e.Zhearmenian=1338,e.Zhebrevecyrillic=1217,e.Zhecyrillic=1046,e.Zhedescendercyrillic=1174,e.Zhedieresiscyrillic=1244,e.Zlinebelow=7828,e.Zmonospace=65338,e.Zsmall=63354,e.Zstroke=437,e.a=97,e.aabengali=2438,e.aacute=225,e.aadeva=2310,e.aagujarati=2694,e.aagurmukhi=2566,e.aamatragurmukhi=2622,e.aarusquare=13059,e.aavowelsignbengali=2494,e.aavowelsigndeva=2366,e.aavowelsigngujarati=2750,e.abbreviationmarkarmenian=1375,e.abbreviationsigndeva=2416,e.abengali=2437,e.abopomofo=12570,e.abreve=259,e.abreveacute=7855,e.abrevecyrillic=1233,e.abrevedotbelow=7863,e.abrevegrave=7857,e.abrevehookabove=7859,e.abrevetilde=7861,e.acaron=462,e.acircle=9424,e.acircumflex=226,e.acircumflexacute=7845,e.acircumflexdotbelow=7853,e.acircumflexgrave=7847,e.acircumflexhookabove=7849,e.acircumflextilde=7851,e.acute=180,e.acutebelowcmb=791,e.acutecmb=769,e.acutecomb=769,e.acutedeva=2388,e.acutelowmod=719,e.acutetonecmb=833,e.acyrillic=1072,e.adblgrave=513,e.addakgurmukhi=2673,e.adeva=2309,e.adieresis=228,e.adieresiscyrillic=1235,e.adieresismacron=479,e.adotbelow=7841,e.adotmacron=481,e.ae=230,e.aeacute=509,e.aekorean=12624,e.aemacron=483,e.afii00208=8213,e.afii08941=8356,e.afii10017=1040,e.afii10018=1041,e.afii10019=1042,e.afii10020=1043,e.afii10021=1044,e.afii10022=1045,e.afii10023=1025,e.afii10024=1046,e.afii10025=1047,e.afii10026=1048,e.afii10027=1049,e.afii10028=1050,e.afii10029=1051,e.afii10030=1052;e.afii10031=1053,e.afii10032=1054,e.afii10033=1055,e.afii10034=1056,e.afii10035=1057,e.afii10036=1058,e.afii10037=1059,e.afii10038=1060,e.afii10039=1061,e.afii10040=1062,e.afii10041=1063,e.afii10042=1064,e.afii10043=1065,e.afii10044=1066,e.afii10045=1067,e.afii10046=1068,e.afii10047=1069,e.afii10048=1070,e.afii10049=1071,e.afii10050=1168,e.afii10051=1026,e.afii10052=1027,e.afii10053=1028,e.afii10054=1029,e.afii10055=1030,e.afii10056=1031,e.afii10057=1032,e.afii10058=1033,e.afii10059=1034,e.afii10060=1035,e.afii10061=1036,e.afii10062=1038,e.afii10063=63172,e.afii10064=63173,e.afii10065=1072,e.afii10066=1073,e.afii10067=1074,e.afii10068=1075,e.afii10069=1076,e.afii10070=1077,e.afii10071=1105,e.afii10072=1078,e.afii10073=1079,e.afii10074=1080,e.afii10075=1081,e.afii10076=1082,e.afii10077=1083,e.afii10078=1084,e.afii10079=1085,e.afii10080=1086,e.afii10081=1087,e.afii10082=1088,e.afii10083=1089,e.afii10084=1090,e.afii10085=1091,e.afii10086=1092,e.afii10087=1093,e.afii10088=1094,e.afii10089=1095,e.afii10090=1096,e.afii10091=1097,e.afii10092=1098,e.afii10093=1099,e.afii10094=1100,e.afii10095=1101,e.afii10096=1102,e.afii10097=1103,e.afii10098=1169,e.afii10099=1106,e.afii10100=1107,e.afii10101=1108,e.afii10102=1109,e.afii10103=1110,e.afii10104=1111,e.afii10105=1112,e.afii10106=1113,e.afii10107=1114,e.afii10108=1115,e.afii10109=1116,e.afii10110=1118,e.afii10145=1039,e.afii10146=1122,e.afii10147=1138,e.afii10148=1140,e.afii10192=63174,e.afii10193=1119,e.afii10194=1123,e.afii10195=1139,e.afii10196=1141,e.afii10831=63175,e.afii10832=63176,e.afii10846=1241,e.afii299=8206,e.afii300=8207,e.afii301=8205,e.afii57381=1642,e.afii57388=1548,e.afii57392=1632,e.afii57393=1633,e.afii57394=1634,e.afii57395=1635,e.afii57396=1636,e.afii57397=1637,e.afii57398=1638,e.afii57399=1639,e.afii57400=1640,e.afii57401=1641,e.afii57403=1563,e.afii57407=1567,e.afii57409=1569,e.afii57410=1570,e.afii57411=1571,e.afii57412=1572,e.afii57413=1573,e.afii57414=1574,e.afii57415=1575,e.afii57416=1576,e.afii57417=1577,e.afii57418=1578,e.afii57419=1579,e.afii57420=1580,e.afii57421=1581,e.afii57422=1582,e.afii57423=1583,e.afii57424=1584,e.afii57425=1585,e.afii57426=1586,e.afii57427=1587,e.afii57428=1588,e.afii57429=1589,e.afii57430=1590,e.afii57431=1591,e.afii57432=1592,e.afii57433=1593,e.afii57434=1594,e.afii57440=1600,e.afii57441=1601,e.afii57442=1602,e.afii57443=1603,e.afii57444=1604,e.afii57445=1605,e.afii57446=1606,e.afii57448=1608,e.afii57449=1609,e.afii57450=1610,e.afii57451=1611,e.afii57452=1612,e.afii57453=1613,e.afii57454=1614,e.afii57455=1615,e.afii57456=1616,e.afii57457=1617,e.afii57458=1618,e.afii57470=1607,e.afii57505=1700,e.afii57506=1662,e.afii57507=1670,e.afii57508=1688,e.afii57509=1711,e.afii57511=1657,e.afii57512=1672,e.afii57513=1681,e.afii57514=1722,e.afii57519=1746,e.afii57534=1749,e.afii57636=8362,e.afii57645=1470,e.afii57658=1475,e.afii57664=1488,e.afii57665=1489,e.afii57666=1490,e.afii57667=1491,e.afii57668=1492,e.afii57669=1493,e.afii57670=1494,e.afii57671=1495,e.afii57672=1496,e.afii57673=1497,e.afii57674=1498,e.afii57675=1499,e.afii57676=1500,e.afii57677=1501,e.afii57678=1502,e.afii57679=1503,e.afii57680=1504,e.afii57681=1505,e.afii57682=1506,e.afii57683=1507,e.afii57684=1508,e.afii57685=1509,e.afii57686=1510,e.afii57687=1511,e.afii57688=1512,e.afii57689=1513,e.afii57690=1514,e.afii57694=64298,e.afii57695=64299,e.afii57700=64331,e.afii57705=64287,e.afii57716=1520,e.afii57717=1521,e.afii57718=1522,e.afii57723=64309,e.afii57793=1460,e.afii57794=1461,e.afii57795=1462,e.afii57796=1467,e.afii57797=1464,e.afii57798=1463,e.afii57799=1456,e.afii57800=1458,e.afii57801=1457,e.afii57802=1459,e.afii57803=1474,e.afii57804=1473,e.afii57806=1465,e.afii57807=1468,e.afii57839=1469,e.afii57841=1471,e.afii57842=1472,e.afii57929=700,e.afii61248=8453,e.afii61289=8467,e.afii61352=8470,e.afii61573=8236,e.afii61574=8237,e.afii61575=8238,e.afii61664=8204,e.afii63167=1645,e.afii64937=701,e.agrave=224,e.agujarati=2693,e.agurmukhi=2565,e.ahiragana=12354,e.ahookabove=7843,e.aibengali=2448,e.aibopomofo=12574,e.aideva=2320,e.aiecyrillic=1237,e.aigujarati=2704,e.aigurmukhi=2576,e.aimatragurmukhi=2632,e.ainarabic=1593,e.ainfinalarabic=65226,e.aininitialarabic=65227,e.ainmedialarabic=65228,e.ainvertedbreve=515,e.aivowelsignbengali=2504,e.aivowelsigndeva=2376,e.aivowelsigngujarati=2760,e.akatakana=12450,e.akatakanahalfwidth=65393,e.akorean=12623,e.alef=1488,e.alefarabic=1575,e.alefdageshhebrew=64304,e.aleffinalarabic=65166,e.alefhamzaabovearabic=1571,e.alefhamzaabovefinalarabic=65156,e.alefhamzabelowarabic=1573,e.alefhamzabelowfinalarabic=65160,e.alefhebrew=1488,e.aleflamedhebrew=64335,e.alefmaddaabovearabic=1570,e.alefmaddaabovefinalarabic=65154,e.alefmaksuraarabic=1609,e.alefmaksurafinalarabic=65264,e.alefmaksurainitialarabic=65267,e.alefmaksuramedialarabic=65268,e.alefpatahhebrew=64302,e.alefqamatshebrew=64303,e.aleph=8501,e.allequal=8780,e.alpha=945,e.alphatonos=940,e.amacron=257,e.amonospace=65345,e.ampersand=38,e.ampersandmonospace=65286,e.ampersandsmall=63270,e.amsquare=13250,e.anbopomofo=12578,e.angbopomofo=12580,e.angbracketleft=12296,e.angbracketright=12297,e.angkhankhuthai=3674,e.angle=8736,e.anglebracketleft=12296,e.anglebracketleftvertical=65087,e.anglebracketright=12297,e.anglebracketrightvertical=65088,e.angleleft=9001,e.angleright=9002,e.angstrom=8491,e.anoteleia=903,e.anudattadeva=2386,e.anusvarabengali=2434,e.anusvaradeva=2306,e.anusvaragujarati=2690,e.aogonek=261,e.apaatosquare=13056,e.aparen=9372,e.apostrophearmenian=1370,e.apostrophemod=700,e.apple=63743,e.approaches=8784,e.approxequal=8776,e.approxequalorimage=8786,e.approximatelyequal=8773,e.araeaekorean=12686,e.araeakorean=12685,e.arc=8978,e.arighthalfring=7834,e.aring=229,e.aringacute=507,e.aringbelow=7681,e.arrowboth=8596,e.arrowdashdown=8675,e.arrowdashleft=8672,e.arrowdashright=8674,e.arrowdashup=8673,e.arrowdblboth=8660,e.arrowdbldown=8659,e.arrowdblleft=8656,e.arrowdblright=8658,e.arrowdblup=8657,e.arrowdown=8595,e.arrowdownleft=8601,e.arrowdownright=8600,e.arrowdownwhite=8681,e.arrowheaddownmod=709,e.arrowheadleftmod=706,e.arrowheadrightmod=707,e.arrowheadupmod=708,e.arrowhorizex=63719,e.arrowleft=8592,e.arrowleftdbl=8656,e.arrowleftdblstroke=8653,e.arrowleftoverright=8646,e.arrowleftwhite=8678,e.arrowright=8594,e.arrowrightdblstroke=8655,e.arrowrightheavy=10142,e.arrowrightoverleft=8644,e.arrowrightwhite=8680,e.arrowtableft=8676,e.arrowtabright=8677,e.arrowup=8593,e.arrowupdn=8597,e.arrowupdnbse=8616,e.arrowupdownbase=8616,e.arrowupleft=8598,e.arrowupleftofdown=8645,e.arrowupright=8599,e.arrowupwhite=8679,e.arrowvertex=63718,e.asciicircum=94,e.asciicircummonospace=65342,e.asciitilde=126,e.asciitildemonospace=65374,e.ascript=593,e.ascriptturned=594,e.asmallhiragana=12353,e.asmallkatakana=12449,e.asmallkatakanahalfwidth=65383,e.asterisk=42,e.asteriskaltonearabic=1645,e.asteriskarabic=1645,e.asteriskmath=8727,e.asteriskmonospace=65290,e.asterisksmall=65121,e.asterism=8258,e.asuperior=63209,e.asymptoticallyequal=8771,e.at=64,e.atilde=227,e.atmonospace=65312,e.atsmall=65131,e.aturned=592,e.aubengali=2452,e.aubopomofo=12576,e.audeva=2324,e.augujarati=2708,e.augurmukhi=2580,e.aulengthmarkbengali=2519,e.aumatragurmukhi=2636,e.auvowelsignbengali=2508,e.auvowelsigndeva=2380,e.auvowelsigngujarati=2764,e.avagrahadeva=2365,e.aybarmenian=1377,e.ayin=1506,e.ayinaltonehebrew=64288,e.ayinhebrew=1506,e.b=98,e.babengali=2476,e.backslash=92,e.backslashmonospace=65340,e.badeva=2348,e.bagujarati=2732,e.bagurmukhi=2604,e.bahiragana=12400,e.bahtthai=3647,e.bakatakana=12496,e.bar=124,e.barmonospace=65372,e.bbopomofo=12549,e.bcircle=9425,e.bdotaccent=7683,e.bdotbelow=7685,e.beamedsixteenthnotes=9836,e.because=8757,e.becyrillic=1073,e.beharabic=1576,e.behfinalarabic=65168,e.behinitialarabic=65169,e.behiragana=12409,e.behmedialarabic=65170,e.behmeeminitialarabic=64671,e.behmeemisolatedarabic=64520,e.behnoonfinalarabic=64621,e.bekatakana=12505,e.benarmenian=1378,e.bet=1489,e.beta=946,e.betasymbolgreek=976,e.betdagesh=64305,e.betdageshhebrew=64305,e.bethebrew=1489,e.betrafehebrew=64332,e.bhabengali=2477,e.bhadeva=2349,e.bhagujarati=2733,e.bhagurmukhi=2605,e.bhook=595,e.bihiragana=12403,e.bikatakana=12499,e.bilabialclick=664,e.bindigurmukhi=2562,e.birusquare=13105,e.blackcircle=9679,e.blackdiamond=9670,e.blackdownpointingtriangle=9660,e.blackleftpointingpointer=9668,e.blackleftpointingtriangle=9664,e.blacklenticularbracketleft=12304,e.blacklenticularbracketleftvertical=65083,e.blacklenticularbracketright=12305,e.blacklenticularbracketrightvertical=65084,e.blacklowerlefttriangle=9699,e.blacklowerrighttriangle=9698,e.blackrectangle=9644,e.blackrightpointingpointer=9658,e.blackrightpointingtriangle=9654,e.blacksmallsquare=9642,e.blacksmilingface=9787,e.blacksquare=9632,e.blackstar=9733,e.blackupperlefttriangle=9700,e.blackupperrighttriangle=9701,e.blackuppointingsmalltriangle=9652,e.blackuppointingtriangle=9650,e.blank=9251,e.blinebelow=7687,e.block=9608,e.bmonospace=65346,e.bobaimaithai=3610,e.bohiragana=12412,e.bokatakana=12508,e.bparen=9373,e.bqsquare=13251,e.braceex=63732,e.braceleft=123,e.braceleftbt=63731,e.braceleftmid=63730,e.braceleftmonospace=65371,e.braceleftsmall=65115,e.bracelefttp=63729,e.braceleftvertical=65079,e.braceright=125,e.bracerightbt=63742,e.bracerightmid=63741,e.bracerightmonospace=65373,e.bracerightsmall=65116,e.bracerighttp=63740,e.bracerightvertical=65080,e.bracketleft=91,e.bracketleftbt=63728,e.bracketleftex=63727,e.bracketleftmonospace=65339,e.bracketlefttp=63726,e.bracketright=93,e.bracketrightbt=63739,e.bracketrightex=63738,e.bracketrightmonospace=65341,e.bracketrighttp=63737,e.breve=728,e.brevebelowcmb=814,e.brevecmb=774,e.breveinvertedbelowcmb=815,e.breveinvertedcmb=785,e.breveinverteddoublecmb=865,e.bridgebelowcmb=810,e.bridgeinvertedbelowcmb=826,e.brokenbar=166,e.bstroke=384,e.bsuperior=63210,e.btopbar=387,e.buhiragana=12406,e.bukatakana=12502,e.bullet=8226,e.bulletinverse=9688,e.bulletoperator=8729,e.bullseye=9678,e.c=99,e.caarmenian=1390,e.cabengali=2458,e.cacute=263,e.cadeva=2330,e.cagujarati=2714,e.cagurmukhi=2586,e.calsquare=13192,e.candrabindubengali=2433,e.candrabinducmb=784,e.candrabindudeva=2305,e.candrabindugujarati=2689,e.capslock=8682,e.careof=8453,e.caron=711,e.caronbelowcmb=812,e.caroncmb=780,e.carriagereturn=8629,e.cbopomofo=12568,e.ccaron=269,e.ccedilla=231,e.ccedillaacute=7689,e.ccircle=9426,e.ccircumflex=265,e.ccurl=597,e.cdot=267,e.cdotaccent=267,e.cdsquare=13253,e.cedilla=184,e.cedillacmb=807,e.cent=162,e.centigrade=8451,e.centinferior=63199,e.centmonospace=65504,e.centoldstyle=63394,e.centsuperior=63200,e.chaarmenian=1401,e.chabengali=2459,e.chadeva=2331,e.chagujarati=2715,e.chagurmukhi=2587,e.chbopomofo=12564,e.cheabkhasiancyrillic=1213,e.checkmark=10003,e.checyrillic=1095,e.chedescenderabkhasiancyrillic=1215,e.chedescendercyrillic=1207,e.chedieresiscyrillic=1269,e.cheharmenian=1395,e.chekhakassiancyrillic=1228,e.cheverticalstrokecyrillic=1209,e.chi=967,e.chieuchacirclekorean=12919,e.chieuchaparenkorean=12823,e.chieuchcirclekorean=12905,e.chieuchkorean=12618,e.chieuchparenkorean=12809,e.chochangthai=3594,e.chochanthai=3592,e.chochingthai=3593,e.chochoethai=3596,e.chook=392,e.cieucacirclekorean=12918,e.cieucaparenkorean=12822,e.cieuccirclekorean=12904,e.cieuckorean=12616,e.cieucparenkorean=12808,e.cieucuparenkorean=12828,e.circle=9675,e.circlecopyrt=169,e.circlemultiply=8855,e.circleot=8857,e.circleplus=8853,e.circlepostalmark=12342,e.circlewithlefthalfblack=9680,e.circlewithrighthalfblack=9681,e.circumflex=710,e.circumflexbelowcmb=813,e.circumflexcmb=770,e.clear=8999,e.clickalveolar=450,e.clickdental=448,e.clicklateral=449,e.clickretroflex=451,e.club=9827,e.clubsuitblack=9827,e.clubsuitwhite=9831,e.cmcubedsquare=13220,e.cmonospace=65347,e.cmsquaredsquare=13216,e.coarmenian=1409,e.colon=58,e.colonmonetary=8353,e.colonmonospace=65306,e.colonsign=8353,e.colonsmall=65109,e.colontriangularhalfmod=721,e.colontriangularmod=720,e.comma=44,e.commaabovecmb=787,e.commaaboverightcmb=789,e.commaaccent=63171,e.commaarabic=1548,e.commaarmenian=1373,e.commainferior=63201,e.commamonospace=65292,e.commareversedabovecmb=788,e.commareversedmod=701,e.commasmall=65104,e.commasuperior=63202,e.commaturnedabovecmb=786,e.commaturnedmod=699,e.compass=9788,e.congruent=8773,e.contourintegral=8750,e.control=8963,e.controlACK=6,e.controlBEL=7,e.controlBS=8,e.controlCAN=24,e.controlCR=13,e.controlDC1=17,e.controlDC2=18,e.controlDC3=19,e.controlDC4=20,e.controlDEL=127,e.controlDLE=16,e.controlEM=25,e.controlENQ=5,e.controlEOT=4,e.controlESC=27,e.controlETB=23,e.controlETX=3,e.controlFF=12,e.controlFS=28,e.controlGS=29,e.controlHT=9,e.controlLF=10,e.controlNAK=21,e.controlNULL=0,e.controlRS=30,e.controlSI=15,e.controlSO=14,e.controlSOT=2,e.controlSTX=1,e.controlSUB=26,e.controlSYN=22,e.controlUS=31,e.controlVT=11,e.copyright=169,e.copyrightsans=63721,e.copyrightserif=63193,e.cornerbracketleft=12300,e.cornerbracketlefthalfwidth=65378,e.cornerbracketleftvertical=65089,e.cornerbracketright=12301,e.cornerbracketrighthalfwidth=65379,e.cornerbracketrightvertical=65090,e.corporationsquare=13183,e.cosquare=13255,e.coverkgsquare=13254,e.cparen=9374,e.cruzeiro=8354,e.cstretched=663,e.curlyand=8911,e.curlyor=8910,e.currency=164,e.cyrBreve=63185,e.cyrFlex=63186,e.cyrbreve=63188,e.cyrflex=63189,e.d=100,e.daarmenian=1380,e.dabengali=2470,e.dadarabic=1590,e.dadeva=2342,e.dadfinalarabic=65214,e.dadinitialarabic=65215,e.dadmedialarabic=65216,e.dagesh=1468,e.dageshhebrew=1468,e.dagger=8224,e.daggerdbl=8225,e.dagujarati=2726,e.dagurmukhi=2598,e.dahiragana=12384,e.dakatakana=12480,e.dalarabic=1583,e.dalet=1491,e.daletdagesh=64307,e.daletdageshhebrew=64307,e.dalethebrew=1491,e.dalfinalarabic=65194,e.dammaarabic=1615,e.dammalowarabic=1615,e.dammatanaltonearabic=1612,e.dammatanarabic=1612,e.danda=2404,e.dargahebrew=1447,e.dargalefthebrew=1447,e.dasiapneumatacyrilliccmb=1157,e.dblGrave=63187,e.dblanglebracketleft=12298,e.dblanglebracketleftvertical=65085,e.dblanglebracketright=12299,e.dblanglebracketrightvertical=65086,e.dblarchinvertedbelowcmb=811,e.dblarrowleft=8660,e.dblarrowright=8658,e.dbldanda=2405,e.dblgrave=63190,e.dblgravecmb=783,e.dblintegral=8748,e.dbllowline=8215,e.dbllowlinecmb=819,e.dbloverlinecmb=831,e.dblprimemod=698,e.dblverticalbar=8214,e.dblverticallineabovecmb=782,e.dbopomofo=12553,e.dbsquare=13256,e.dcaron=271,e.dcedilla=7697,e.dcircle=9427,e.dcircumflexbelow=7699,e.dcroat=273,e.ddabengali=2465,e.ddadeva=2337,e.ddagujarati=2721,e.ddagurmukhi=2593,e.ddalarabic=1672,e.ddalfinalarabic=64393,e.dddhadeva=2396,e.ddhabengali=2466,e.ddhadeva=2338,e.ddhagujarati=2722,e.ddhagurmukhi=2594,e.ddotaccent=7691,e.ddotbelow=7693,e.decimalseparatorarabic=1643,e.decimalseparatorpersian=1643,e.decyrillic=1076,e.degree=176,e.dehihebrew=1453,e.dehiragana=12391,e.deicoptic=1007,e.dekatakana=12487,e.deleteleft=9003,e.deleteright=8998,e.delta=948,e.deltaturned=397,e.denominatorminusonenumeratorbengali=2552,e.dezh=676,e.dhabengali=2471,e.dhadeva=2343,e.dhagujarati=2727,e.dhagurmukhi=2599,e.dhook=599,e.dialytikatonos=901,e.dialytikatonoscmb=836,e.diamond=9830,e.diamondsuitwhite=9826,e.dieresis=168,e.dieresisacute=63191,e.dieresisbelowcmb=804,e.dieresiscmb=776,e.dieresisgrave=63192,e.dieresistonos=901,e.dihiragana=12386,e.dikatakana=12482,e.dittomark=12291,e.divide=247,e.divides=8739,e.divisionslash=8725,e.djecyrillic=1106,e.dkshade=9619,e.dlinebelow=7695,e.dlsquare=13207,e.dmacron=273,e.dmonospace=65348,e.dnblock=9604,e.dochadathai=3598,e.dodekthai=3604,e.dohiragana=12393,e.dokatakana=12489,e.dollar=36;e.dollarinferior=63203,e.dollarmonospace=65284,e.dollaroldstyle=63268,e.dollarsmall=65129,e.dollarsuperior=63204,e.dong=8363,e.dorusquare=13094,e.dotaccent=729,e.dotaccentcmb=775,e.dotbelowcmb=803,e.dotbelowcomb=803,e.dotkatakana=12539,e.dotlessi=305,e.dotlessj=63166,e.dotlessjstrokehook=644,e.dotmath=8901,e.dottedcircle=9676,e.doubleyodpatah=64287,e.doubleyodpatahhebrew=64287,e.downtackbelowcmb=798,e.downtackmod=725,e.dparen=9375,e.dsuperior=63211,e.dtail=598,e.dtopbar=396,e.duhiragana=12389,e.dukatakana=12485,e.dz=499,e.dzaltone=675,e.dzcaron=454,e.dzcurl=677,e.dzeabkhasiancyrillic=1249,e.dzecyrillic=1109,e.dzhecyrillic=1119,e.e=101,e.eacute=233,e.earth=9793,e.ebengali=2447,e.ebopomofo=12572,e.ebreve=277,e.ecandradeva=2317,e.ecandragujarati=2701,e.ecandravowelsigndeva=2373,e.ecandravowelsigngujarati=2757,e.ecaron=283,e.ecedillabreve=7709,e.echarmenian=1381,e.echyiwnarmenian=1415,e.ecircle=9428,e.ecircumflex=234,e.ecircumflexacute=7871,e.ecircumflexbelow=7705,e.ecircumflexdotbelow=7879,e.ecircumflexgrave=7873,e.ecircumflexhookabove=7875,e.ecircumflextilde=7877,e.ecyrillic=1108,e.edblgrave=517,e.edeva=2319,e.edieresis=235,e.edot=279,e.edotaccent=279,e.edotbelow=7865,e.eegurmukhi=2575,e.eematragurmukhi=2631,e.efcyrillic=1092,e.egrave=232,e.egujarati=2703,e.eharmenian=1383,e.ehbopomofo=12573,e.ehiragana=12360,e.ehookabove=7867,e.eibopomofo=12575,e.eight=56,e.eightarabic=1640,e.eightbengali=2542,e.eightcircle=9319,e.eightcircleinversesansserif=10129,e.eightdeva=2414,e.eighteencircle=9329,e.eighteenparen=9349,e.eighteenperiod=9369,e.eightgujarati=2798,e.eightgurmukhi=2670,e.eighthackarabic=1640,e.eighthangzhou=12328,e.eighthnotebeamed=9835,e.eightideographicparen=12839,e.eightinferior=8328,e.eightmonospace=65304,e.eightoldstyle=63288,e.eightparen=9339,e.eightperiod=9359,e.eightpersian=1784,e.eightroman=8567,e.eightsuperior=8312,e.eightthai=3672,e.einvertedbreve=519,e.eiotifiedcyrillic=1125,e.ekatakana=12456,e.ekatakanahalfwidth=65396,e.ekonkargurmukhi=2676,e.ekorean=12628,e.elcyrillic=1083,e.element=8712,e.elevencircle=9322,e.elevenparen=9342,e.elevenperiod=9362,e.elevenroman=8570,e.ellipsis=8230,e.ellipsisvertical=8942,e.emacron=275,e.emacronacute=7703,e.emacrongrave=7701,e.emcyrillic=1084,e.emdash=8212,e.emdashvertical=65073,e.emonospace=65349,e.emphasismarkarmenian=1371,e.emptyset=8709,e.enbopomofo=12579,e.encyrillic=1085,e.endash=8211,e.endashvertical=65074,e.endescendercyrillic=1187,e.eng=331,e.engbopomofo=12581,e.enghecyrillic=1189,e.enhookcyrillic=1224,e.enspace=8194,e.eogonek=281,e.eokorean=12627,e.eopen=603,e.eopenclosed=666,e.eopenreversed=604,e.eopenreversedclosed=606,e.eopenreversedhook=605,e.eparen=9376,e.epsilon=949,e.epsilontonos=941,e.equal=61,e.equalmonospace=65309,e.equalsmall=65126,e.equalsuperior=8316,e.equivalence=8801,e.erbopomofo=12582,e.ercyrillic=1088,e.ereversed=600,e.ereversedcyrillic=1101,e.escyrillic=1089,e.esdescendercyrillic=1195,e.esh=643,e.eshcurl=646,e.eshortdeva=2318,e.eshortvowelsigndeva=2374,e.eshreversedloop=426,e.eshsquatreversed=645,e.esmallhiragana=12359,e.esmallkatakana=12455,e.esmallkatakanahalfwidth=65386,e.estimated=8494,e.esuperior=63212,e.eta=951,e.etarmenian=1384,e.etatonos=942,e.eth=240,e.etilde=7869,e.etildebelow=7707,e.etnahtafoukhhebrew=1425,e.etnahtafoukhlefthebrew=1425,e.etnahtahebrew=1425,e.etnahtalefthebrew=1425,e.eturned=477,e.eukorean=12641,e.euro=8364,e.evowelsignbengali=2503,e.evowelsigndeva=2375,e.evowelsigngujarati=2759,e.exclam=33,e.exclamarmenian=1372,e.exclamdbl=8252,e.exclamdown=161,e.exclamdownsmall=63393,e.exclammonospace=65281,e.exclamsmall=63265,e.existential=8707,e.ezh=658,e.ezhcaron=495,e.ezhcurl=659,e.ezhreversed=441,e.ezhtail=442,e.f=102,e.fadeva=2398,e.fagurmukhi=2654,e.fahrenheit=8457,e.fathaarabic=1614,e.fathalowarabic=1614,e.fathatanarabic=1611,e.fbopomofo=12552,e.fcircle=9429,e.fdotaccent=7711,e.feharabic=1601,e.feharmenian=1414,e.fehfinalarabic=65234,e.fehinitialarabic=65235,e.fehmedialarabic=65236,e.feicoptic=997,e.female=9792,e.ff=64256,e.f_f=64256,e.ffi=64259,e.ffl=64260,e.fi=64257,e.fifteencircle=9326,e.fifteenparen=9346,e.fifteenperiod=9366,e.figuredash=8210,e.filledbox=9632,e.filledrect=9644,e.finalkaf=1498,e.finalkafdagesh=64314,e.finalkafdageshhebrew=64314,e.finalkafhebrew=1498,e.finalmem=1501,e.finalmemhebrew=1501,e.finalnun=1503,e.finalnunhebrew=1503,e.finalpe=1507,e.finalpehebrew=1507,e.finaltsadi=1509,e.finaltsadihebrew=1509,e.firsttonechinese=713,e.fisheye=9673,e.fitacyrillic=1139,e.five=53,e.fivearabic=1637,e.fivebengali=2539,e.fivecircle=9316,e.fivecircleinversesansserif=10126,e.fivedeva=2411,e.fiveeighths=8541,e.fivegujarati=2795,e.fivegurmukhi=2667,e.fivehackarabic=1637,e.fivehangzhou=12325,e.fiveideographicparen=12836,e.fiveinferior=8325,e.fivemonospace=65301,e.fiveoldstyle=63285,e.fiveparen=9336,e.fiveperiod=9356,e.fivepersian=1781,e.fiveroman=8564,e.fivesuperior=8309,e.fivethai=3669,e.fl=64258,e.florin=402,e.fmonospace=65350,e.fmsquare=13209,e.fofanthai=3615,e.fofathai=3613,e.fongmanthai=3663,e.forall=8704,e.four=52,e.fourarabic=1636,e.fourbengali=2538,e.fourcircle=9315,e.fourcircleinversesansserif=10125,e.fourdeva=2410,e.fourgujarati=2794,e.fourgurmukhi=2666,e.fourhackarabic=1636,e.fourhangzhou=12324,e.fourideographicparen=12835,e.fourinferior=8324,e.fourmonospace=65300,e.fournumeratorbengali=2551,e.fouroldstyle=63284,e.fourparen=9335,e.fourperiod=9355,e.fourpersian=1780,e.fourroman=8563,e.foursuperior=8308,e.fourteencircle=9325,e.fourteenparen=9345,e.fourteenperiod=9365,e.fourthai=3668,e.fourthtonechinese=715,e.fparen=9377,e.fraction=8260,e.franc=8355,e.g=103,e.gabengali=2455,e.gacute=501,e.gadeva=2327,e.gafarabic=1711,e.gaffinalarabic=64403,e.gafinitialarabic=64404,e.gafmedialarabic=64405,e.gagujarati=2711,e.gagurmukhi=2583,e.gahiragana=12364,e.gakatakana=12460,e.gamma=947,e.gammalatinsmall=611,e.gammasuperior=736,e.gangiacoptic=1003,e.gbopomofo=12557,e.gbreve=287,e.gcaron=487,e.gcedilla=291,e.gcircle=9430,e.gcircumflex=285,e.gcommaaccent=291,e.gdot=289,e.gdotaccent=289,e.gecyrillic=1075,e.gehiragana=12370,e.gekatakana=12466,e.geometricallyequal=8785,e.gereshaccenthebrew=1436,e.gereshhebrew=1523,e.gereshmuqdamhebrew=1437,e.germandbls=223,e.gershayimaccenthebrew=1438,e.gershayimhebrew=1524,e.getamark=12307,e.ghabengali=2456,e.ghadarmenian=1394,e.ghadeva=2328,e.ghagujarati=2712,e.ghagurmukhi=2584,e.ghainarabic=1594,e.ghainfinalarabic=65230,e.ghaininitialarabic=65231,e.ghainmedialarabic=65232,e.ghemiddlehookcyrillic=1173,e.ghestrokecyrillic=1171,e.gheupturncyrillic=1169,e.ghhadeva=2394,e.ghhagurmukhi=2650,e.ghook=608,e.ghzsquare=13203,e.gihiragana=12366,e.gikatakana=12462,e.gimarmenian=1379,e.gimel=1490,e.gimeldagesh=64306,e.gimeldageshhebrew=64306,e.gimelhebrew=1490,e.gjecyrillic=1107,e.glottalinvertedstroke=446,e.glottalstop=660,e.glottalstopinverted=662,e.glottalstopmod=704,e.glottalstopreversed=661,e.glottalstopreversedmod=705,e.glottalstopreversedsuperior=740,e.glottalstopstroke=673,e.glottalstopstrokereversed=674,e.gmacron=7713,e.gmonospace=65351,e.gohiragana=12372,e.gokatakana=12468,e.gparen=9378,e.gpasquare=13228,e.gradient=8711,e.grave=96,e.gravebelowcmb=790,e.gravecmb=768,e.gravecomb=768,e.gravedeva=2387,e.gravelowmod=718,e.gravemonospace=65344,e.gravetonecmb=832,e.greater=62,e.greaterequal=8805,e.greaterequalorless=8923,e.greatermonospace=65310,e.greaterorequivalent=8819,e.greaterorless=8823,e.greateroverequal=8807,e.greatersmall=65125,e.gscript=609,e.gstroke=485,e.guhiragana=12368,e.guillemotleft=171,e.guillemotright=187,e.guilsinglleft=8249,e.guilsinglright=8250,e.gukatakana=12464,e.guramusquare=13080,e.gysquare=13257,e.h=104,e.haabkhasiancyrillic=1193,e.haaltonearabic=1729,e.habengali=2489,e.hadescendercyrillic=1203,e.hadeva=2361,e.hagujarati=2745,e.hagurmukhi=2617,e.haharabic=1581,e.hahfinalarabic=65186,e.hahinitialarabic=65187,e.hahiragana=12399,e.hahmedialarabic=65188,e.haitusquare=13098,e.hakatakana=12495,e.hakatakanahalfwidth=65418,e.halantgurmukhi=2637,e.hamzaarabic=1569,e.hamzalowarabic=1569,e.hangulfiller=12644,e.hardsigncyrillic=1098,e.harpoonleftbarbup=8636,e.harpoonrightbarbup=8640,e.hasquare=13258,e.hatafpatah=1458,e.hatafpatah16=1458,e.hatafpatah23=1458,e.hatafpatah2f=1458,e.hatafpatahhebrew=1458,e.hatafpatahnarrowhebrew=1458,e.hatafpatahquarterhebrew=1458,e.hatafpatahwidehebrew=1458,e.hatafqamats=1459,e.hatafqamats1b=1459,e.hatafqamats28=1459,e.hatafqamats34=1459,e.hatafqamatshebrew=1459,e.hatafqamatsnarrowhebrew=1459,e.hatafqamatsquarterhebrew=1459,e.hatafqamatswidehebrew=1459,e.hatafsegol=1457,e.hatafsegol17=1457,e.hatafsegol24=1457,e.hatafsegol30=1457,e.hatafsegolhebrew=1457,e.hatafsegolnarrowhebrew=1457,e.hatafsegolquarterhebrew=1457,e.hatafsegolwidehebrew=1457,e.hbar=295,e.hbopomofo=12559,e.hbrevebelow=7723,e.hcedilla=7721,e.hcircle=9431,e.hcircumflex=293,e.hdieresis=7719,e.hdotaccent=7715,e.hdotbelow=7717,e.he=1492,e.heart=9829,e.heartsuitblack=9829,e.heartsuitwhite=9825,e.hedagesh=64308,e.hedageshhebrew=64308,e.hehaltonearabic=1729,e.heharabic=1607,e.hehebrew=1492,e.hehfinalaltonearabic=64423,e.hehfinalalttwoarabic=65258,e.hehfinalarabic=65258,e.hehhamzaabovefinalarabic=64421,e.hehhamzaaboveisolatedarabic=64420,e.hehinitialaltonearabic=64424,e.hehinitialarabic=65259,e.hehiragana=12408,e.hehmedialaltonearabic=64425,e.hehmedialarabic=65260,e.heiseierasquare=13179,e.hekatakana=12504,e.hekatakanahalfwidth=65421,e.hekutaarusquare=13110,e.henghook=615,e.herutusquare=13113,e.het=1495,e.hethebrew=1495,e.hhook=614,e.hhooksuperior=689,e.hieuhacirclekorean=12923,e.hieuhaparenkorean=12827,e.hieuhcirclekorean=12909,e.hieuhkorean=12622,e.hieuhparenkorean=12813,e.hihiragana=12402,e.hikatakana=12498,e.hikatakanahalfwidth=65419,e.hiriq=1460,e.hiriq14=1460,e.hiriq21=1460,e.hiriq2d=1460,e.hiriqhebrew=1460,e.hiriqnarrowhebrew=1460,e.hiriqquarterhebrew=1460,e.hiriqwidehebrew=1460,e.hlinebelow=7830,e.hmonospace=65352,e.hoarmenian=1392,e.hohipthai=3627,e.hohiragana=12411,e.hokatakana=12507,e.hokatakanahalfwidth=65422,e.holam=1465,e.holam19=1465,e.holam26=1465,e.holam32=1465,e.holamhebrew=1465,e.holamnarrowhebrew=1465,e.holamquarterhebrew=1465,e.holamwidehebrew=1465,e.honokhukthai=3630,e.hookabovecomb=777,e.hookcmb=777,e.hookpalatalizedbelowcmb=801,e.hookretroflexbelowcmb=802,e.hoonsquare=13122,e.horicoptic=1001,e.horizontalbar=8213,e.horncmb=795,e.hotsprings=9832,e.house=8962,e.hparen=9379,e.hsuperior=688,e.hturned=613,e.huhiragana=12405,e.huiitosquare=13107,e.hukatakana=12501,e.hukatakanahalfwidth=65420,e.hungarumlaut=733,e.hungarumlautcmb=779,e.hv=405,e.hyphen=45,e.hypheninferior=63205,e.hyphenmonospace=65293,e.hyphensmall=65123,e.hyphensuperior=63206,e.hyphentwo=8208,e.i=105,e.iacute=237,e.iacyrillic=1103,e.ibengali=2439,e.ibopomofo=12583,e.ibreve=301,e.icaron=464,e.icircle=9432,e.icircumflex=238,e.icyrillic=1110,e.idblgrave=521,e.ideographearthcircle=12943,e.ideographfirecircle=12939,e.ideographicallianceparen=12863,e.ideographiccallparen=12858,e.ideographiccentrecircle=12965,e.ideographicclose=12294,e.ideographiccomma=12289,e.ideographiccommaleft=65380,e.ideographiccongratulationparen=12855,e.ideographiccorrectcircle=12963,e.ideographicearthparen=12847,e.ideographicenterpriseparen=12861,e.ideographicexcellentcircle=12957,e.ideographicfestivalparen=12864,e.ideographicfinancialcircle=12950,e.ideographicfinancialparen=12854,e.ideographicfireparen=12843,e.ideographichaveparen=12850,e.ideographichighcircle=12964,e.ideographiciterationmark=12293,e.ideographiclaborcircle=12952,e.ideographiclaborparen=12856,e.ideographicleftcircle=12967,e.ideographiclowcircle=12966,e.ideographicmedicinecircle=12969,e.ideographicmetalparen=12846,e.ideographicmoonparen=12842,e.ideographicnameparen=12852,e.ideographicperiod=12290,e.ideographicprintcircle=12958,e.ideographicreachparen=12867,e.ideographicrepresentparen=12857,e.ideographicresourceparen=12862,e.ideographicrightcircle=12968,e.ideographicsecretcircle=12953,e.ideographicselfparen=12866,e.ideographicsocietyparen=12851,e.ideographicspace=12288,e.ideographicspecialparen=12853,e.ideographicstockparen=12849,e.ideographicstudyparen=12859,e.ideographicsunparen=12848,e.ideographicsuperviseparen=12860,e.ideographicwaterparen=12844,e.ideographicwoodparen=12845,e.ideographiczero=12295,e.ideographmetalcircle=12942,e.ideographmooncircle=12938,e.ideographnamecircle=12948,e.ideographsuncircle=12944,e.ideographwatercircle=12940,e.ideographwoodcircle=12941,e.ideva=2311,e.idieresis=239,e.idieresisacute=7727,e.idieresiscyrillic=1253,e.idotbelow=7883,e.iebrevecyrillic=1239,e.iecyrillic=1077,e.ieungacirclekorean=12917,e.ieungaparenkorean=12821,e.ieungcirclekorean=12903,e.ieungkorean=12615,e.ieungparenkorean=12807,e.igrave=236,e.igujarati=2695,e.igurmukhi=2567,e.ihiragana=12356,e.ihookabove=7881,e.iibengali=2440,e.iicyrillic=1080,e.iideva=2312,e.iigujarati=2696,e.iigurmukhi=2568,e.iimatragurmukhi=2624,e.iinvertedbreve=523,e.iishortcyrillic=1081,e.iivowelsignbengali=2496,e.iivowelsigndeva=2368,e.iivowelsigngujarati=2752,e.ij=307,e.ikatakana=12452,e.ikatakanahalfwidth=65394,e.ikorean=12643,e.ilde=732,e.iluyhebrew=1452,e.imacron=299,e.imacroncyrillic=1251,e.imageorapproximatelyequal=8787,e.imatragurmukhi=2623,e.imonospace=65353,e.increment=8710,e.infinity=8734,e.iniarmenian=1387,e.integral=8747,e.integralbottom=8993,e.integralbt=8993,e.integralex=63733,e.integraltop=8992,e.integraltp=8992,e.intersection=8745,e.intisquare=13061,e.invbullet=9688,e.invcircle=9689,e.invsmileface=9787,e.iocyrillic=1105,e.iogonek=303,e.iota=953,e.iotadieresis=970,e.iotadieresistonos=912,e.iotalatin=617,e.iotatonos=943,e.iparen=9380,e.irigurmukhi=2674,e.ismallhiragana=12355,e.ismallkatakana=12451,e.ismallkatakanahalfwidth=65384,e.issharbengali=2554,e.istroke=616,e.isuperior=63213,e.iterationhiragana=12445,e.iterationkatakana=12541,e.itilde=297,e.itildebelow=7725,e.iubopomofo=12585,e.iucyrillic=1102,e.ivowelsignbengali=2495,e.ivowelsigndeva=2367,e.ivowelsigngujarati=2751,e.izhitsacyrillic=1141,e.izhitsadblgravecyrillic=1143,e.j=106,e.jaarmenian=1393,e.jabengali=2460,e.jadeva=2332,e.jagujarati=2716,e.jagurmukhi=2588,e.jbopomofo=12560,e.jcaron=496,e.jcircle=9433,e.jcircumflex=309,e.jcrossedtail=669,e.jdotlessstroke=607,e.jecyrillic=1112,e.jeemarabic=1580,e.jeemfinalarabic=65182,e.jeeminitialarabic=65183,e.jeemmedialarabic=65184,e.jeharabic=1688,e.jehfinalarabic=64395,e.jhabengali=2461,e.jhadeva=2333,e.jhagujarati=2717,e.jhagurmukhi=2589,e.jheharmenian=1403,e.jis=12292,e.jmonospace=65354,e.jparen=9381,e.jsuperior=690,e.k=107,e.kabashkircyrillic=1185,e.kabengali=2453,e.kacute=7729,e.kacyrillic=1082,e.kadescendercyrillic=1179,e.kadeva=2325,e.kaf=1499,e.kafarabic=1603,e.kafdagesh=64315,e.kafdageshhebrew=64315,e.kaffinalarabic=65242,e.kafhebrew=1499,e.kafinitialarabic=65243,e.kafmedialarabic=65244,e.kafrafehebrew=64333,e.kagujarati=2709,e.kagurmukhi=2581,e.kahiragana=12363,e.kahookcyrillic=1220,e.kakatakana=12459,e.kakatakanahalfwidth=65398,e.kappa=954,e.kappasymbolgreek=1008,e.kapyeounmieumkorean=12657,e.kapyeounphieuphkorean=12676,e.kapyeounpieupkorean=12664,e.kapyeounssangpieupkorean=12665,e.karoriisquare=13069,e.kashidaautoarabic=1600,e.kashidaautonosidebearingarabic=1600,e.kasmallkatakana=12533,e.kasquare=13188,e.kasraarabic=1616,e.kasratanarabic=1613,e.kastrokecyrillic=1183,e.katahiraprolongmarkhalfwidth=65392,e.kaverticalstrokecyrillic=1181,e.kbopomofo=12558,e.kcalsquare=13193,e.kcaron=489,e.kcedilla=311,e.kcircle=9434,e.kcommaaccent=311,e.kdotbelow=7731,e.keharmenian=1412,e.kehiragana=12369,e.kekatakana=12465,e.kekatakanahalfwidth=65401,e.kenarmenian=1391,e.kesmallkatakana=12534,e.kgreenlandic=312,e.khabengali=2454,e.khacyrillic=1093,e.khadeva=2326,e.khagujarati=2710,e.khagurmukhi=2582,e.khaharabic=1582,e.khahfinalarabic=65190,e.khahinitialarabic=65191,e.khahmedialarabic=65192,e.kheicoptic=999,e.khhadeva=2393,e.khhagurmukhi=2649,e.khieukhacirclekorean=12920,e.khieukhaparenkorean=12824,e.khieukhcirclekorean=12906,e.khieukhkorean=12619,e.khieukhparenkorean=12810,e.khokhaithai=3586,e.khokhonthai=3589,e.khokhuatthai=3587,e.khokhwaithai=3588,e.khomutthai=3675,e.khook=409,e.khorakhangthai=3590,e.khzsquare=13201,e.kihiragana=12365,e.kikatakana=12461,e.kikatakanahalfwidth=65399,e.kiroguramusquare=13077,e.kiromeetorusquare=13078,e.kirosquare=13076,e.kiyeokacirclekorean=12910,e.kiyeokaparenkorean=12814,e.kiyeokcirclekorean=12896,e.kiyeokkorean=12593,e.kiyeokparenkorean=12800,e.kiyeoksioskorean=12595,e.kjecyrillic=1116,e.klinebelow=7733,e.klsquare=13208,e.kmcubedsquare=13222;e.kmonospace=65355,e.kmsquaredsquare=13218,e.kohiragana=12371,e.kohmsquare=13248,e.kokaithai=3585,e.kokatakana=12467,e.kokatakanahalfwidth=65402,e.kooposquare=13086,e.koppacyrillic=1153,e.koreanstandardsymbol=12927,e.koroniscmb=835,e.kparen=9382,e.kpasquare=13226,e.ksicyrillic=1135,e.ktsquare=13263,e.kturned=670,e.kuhiragana=12367,e.kukatakana=12463,e.kukatakanahalfwidth=65400,e.kvsquare=13240,e.kwsquare=13246,e.l=108,e.labengali=2482,e.lacute=314,e.ladeva=2354,e.lagujarati=2738,e.lagurmukhi=2610,e.lakkhangyaothai=3653,e.lamaleffinalarabic=65276,e.lamalefhamzaabovefinalarabic=65272,e.lamalefhamzaaboveisolatedarabic=65271,e.lamalefhamzabelowfinalarabic=65274,e.lamalefhamzabelowisolatedarabic=65273,e.lamalefisolatedarabic=65275,e.lamalefmaddaabovefinalarabic=65270,e.lamalefmaddaaboveisolatedarabic=65269,e.lamarabic=1604,e.lambda=955,e.lambdastroke=411,e.lamed=1500,e.lameddagesh=64316,e.lameddageshhebrew=64316,e.lamedhebrew=1500,e.lamfinalarabic=65246,e.lamhahinitialarabic=64714,e.laminitialarabic=65247,e.lamjeeminitialarabic=64713,e.lamkhahinitialarabic=64715,e.lamlamhehisolatedarabic=65010,e.lammedialarabic=65248,e.lammeemhahinitialarabic=64904,e.lammeeminitialarabic=64716,e.largecircle=9711,e.lbar=410,e.lbelt=620,e.lbopomofo=12556,e.lcaron=318,e.lcedilla=316,e.lcircle=9435,e.lcircumflexbelow=7741,e.lcommaaccent=316,e.ldot=320,e.ldotaccent=320,e.ldotbelow=7735,e.ldotbelowmacron=7737,e.leftangleabovecmb=794,e.lefttackbelowcmb=792,e.less=60,e.lessequal=8804,e.lessequalorgreater=8922,e.lessmonospace=65308,e.lessorequivalent=8818,e.lessorgreater=8822,e.lessoverequal=8806,e.lesssmall=65124,e.lezh=622,e.lfblock=9612,e.lhookretroflex=621,e.lira=8356,e.liwnarmenian=1388,e.lj=457,e.ljecyrillic=1113,e.ll=63168,e.lladeva=2355,e.llagujarati=2739,e.llinebelow=7739,e.llladeva=2356,e.llvocalicbengali=2529,e.llvocalicdeva=2401,e.llvocalicvowelsignbengali=2531,e.llvocalicvowelsigndeva=2403,e.lmiddletilde=619,e.lmonospace=65356,e.lmsquare=13264,e.lochulathai=3628,e.logicaland=8743,e.logicalnot=172,e.logicalnotreversed=8976,e.logicalor=8744,e.lolingthai=3621,e.longs=383,e.lowlinecenterline=65102,e.lowlinecmb=818,e.lowlinedashed=65101,e.lozenge=9674,e.lparen=9383,e.lslash=322,e.lsquare=8467,e.lsuperior=63214,e.ltshade=9617,e.luthai=3622,e.lvocalicbengali=2444,e.lvocalicdeva=2316,e.lvocalicvowelsignbengali=2530,e.lvocalicvowelsigndeva=2402,e.lxsquare=13267,e.m=109,e.mabengali=2478,e.macron=175,e.macronbelowcmb=817,e.macroncmb=772,e.macronlowmod=717,e.macronmonospace=65507,e.macute=7743,e.madeva=2350,e.magujarati=2734,e.magurmukhi=2606,e.mahapakhhebrew=1444,e.mahapakhlefthebrew=1444,e.mahiragana=12414,e.maichattawalowleftthai=63637,e.maichattawalowrightthai=63636,e.maichattawathai=3659,e.maichattawaupperleftthai=63635,e.maieklowleftthai=63628,e.maieklowrightthai=63627,e.maiekthai=3656,e.maiekupperleftthai=63626,e.maihanakatleftthai=63620,e.maihanakatthai=3633,e.maitaikhuleftthai=63625,e.maitaikhuthai=3655,e.maitholowleftthai=63631,e.maitholowrightthai=63630,e.maithothai=3657,e.maithoupperleftthai=63629,e.maitrilowleftthai=63634,e.maitrilowrightthai=63633,e.maitrithai=3658,e.maitriupperleftthai=63632,e.maiyamokthai=3654,e.makatakana=12510,e.makatakanahalfwidth=65423,e.male=9794,e.mansyonsquare=13127,e.maqafhebrew=1470,e.mars=9794,e.masoracirclehebrew=1455,e.masquare=13187,e.mbopomofo=12551,e.mbsquare=13268,e.mcircle=9436,e.mcubedsquare=13221,e.mdotaccent=7745,e.mdotbelow=7747,e.meemarabic=1605,e.meemfinalarabic=65250,e.meeminitialarabic=65251,e.meemmedialarabic=65252,e.meemmeeminitialarabic=64721,e.meemmeemisolatedarabic=64584,e.meetorusquare=13133,e.mehiragana=12417,e.meizierasquare=13182,e.mekatakana=12513,e.mekatakanahalfwidth=65426,e.mem=1502,e.memdagesh=64318,e.memdageshhebrew=64318,e.memhebrew=1502,e.menarmenian=1396,e.merkhahebrew=1445,e.merkhakefulahebrew=1446,e.merkhakefulalefthebrew=1446,e.merkhalefthebrew=1445,e.mhook=625,e.mhzsquare=13202,e.middledotkatakanahalfwidth=65381,e.middot=183,e.mieumacirclekorean=12914,e.mieumaparenkorean=12818,e.mieumcirclekorean=12900,e.mieumkorean=12609,e.mieumpansioskorean=12656,e.mieumparenkorean=12804,e.mieumpieupkorean=12654,e.mieumsioskorean=12655,e.mihiragana=12415,e.mikatakana=12511,e.mikatakanahalfwidth=65424,e.minus=8722,e.minusbelowcmb=800,e.minuscircle=8854,e.minusmod=727,e.minusplus=8723,e.minute=8242,e.miribaarusquare=13130,e.mirisquare=13129,e.mlonglegturned=624,e.mlsquare=13206,e.mmcubedsquare=13219,e.mmonospace=65357,e.mmsquaredsquare=13215,e.mohiragana=12418,e.mohmsquare=13249,e.mokatakana=12514,e.mokatakanahalfwidth=65427,e.molsquare=13270,e.momathai=3617,e.moverssquare=13223,e.moverssquaredsquare=13224,e.mparen=9384,e.mpasquare=13227,e.mssquare=13235,e.msuperior=63215,e.mturned=623,e.mu=181,e.mu1=181,e.muasquare=13186,e.muchgreater=8811,e.muchless=8810,e.mufsquare=13196,e.mugreek=956,e.mugsquare=13197,e.muhiragana=12416,e.mukatakana=12512,e.mukatakanahalfwidth=65425,e.mulsquare=13205,e.multiply=215,e.mumsquare=13211,e.munahhebrew=1443,e.munahlefthebrew=1443,e.musicalnote=9834,e.musicalnotedbl=9835,e.musicflatsign=9837,e.musicsharpsign=9839,e.mussquare=13234,e.muvsquare=13238,e.muwsquare=13244,e.mvmegasquare=13241,e.mvsquare=13239,e.mwmegasquare=13247,e.mwsquare=13245,e.n=110,e.nabengali=2472,e.nabla=8711,e.nacute=324,e.nadeva=2344,e.nagujarati=2728,e.nagurmukhi=2600,e.nahiragana=12394,e.nakatakana=12490,e.nakatakanahalfwidth=65413,e.napostrophe=329,e.nasquare=13185,e.nbopomofo=12555,e.nbspace=160,e.ncaron=328,e.ncedilla=326,e.ncircle=9437,e.ncircumflexbelow=7755,e.ncommaaccent=326,e.ndotaccent=7749,e.ndotbelow=7751,e.nehiragana=12397,e.nekatakana=12493,e.nekatakanahalfwidth=65416,e.newsheqelsign=8362,e.nfsquare=13195,e.ngabengali=2457,e.ngadeva=2329,e.ngagujarati=2713,e.ngagurmukhi=2585,e.ngonguthai=3591,e.nhiragana=12435,e.nhookleft=626,e.nhookretroflex=627,e.nieunacirclekorean=12911,e.nieunaparenkorean=12815,e.nieuncieuckorean=12597,e.nieuncirclekorean=12897,e.nieunhieuhkorean=12598,e.nieunkorean=12596,e.nieunpansioskorean=12648,e.nieunparenkorean=12801,e.nieunsioskorean=12647,e.nieuntikeutkorean=12646,e.nihiragana=12395,e.nikatakana=12491,e.nikatakanahalfwidth=65414,e.nikhahitleftthai=63641,e.nikhahitthai=3661,e.nine=57,e.ninearabic=1641,e.ninebengali=2543,e.ninecircle=9320,e.ninecircleinversesansserif=10130,e.ninedeva=2415,e.ninegujarati=2799,e.ninegurmukhi=2671,e.ninehackarabic=1641,e.ninehangzhou=12329,e.nineideographicparen=12840,e.nineinferior=8329,e.ninemonospace=65305,e.nineoldstyle=63289,e.nineparen=9340,e.nineperiod=9360,e.ninepersian=1785,e.nineroman=8568,e.ninesuperior=8313,e.nineteencircle=9330,e.nineteenparen=9350,e.nineteenperiod=9370,e.ninethai=3673,e.nj=460,e.njecyrillic=1114,e.nkatakana=12531,e.nkatakanahalfwidth=65437,e.nlegrightlong=414,e.nlinebelow=7753,e.nmonospace=65358,e.nmsquare=13210,e.nnabengali=2467,e.nnadeva=2339,e.nnagujarati=2723,e.nnagurmukhi=2595,e.nnnadeva=2345,e.nohiragana=12398,e.nokatakana=12494,e.nokatakanahalfwidth=65417,e.nonbreakingspace=160,e.nonenthai=3603,e.nonuthai=3609,e.noonarabic=1606,e.noonfinalarabic=65254,e.noonghunnaarabic=1722,e.noonghunnafinalarabic=64415,e.nooninitialarabic=65255,e.noonjeeminitialarabic=64722,e.noonjeemisolatedarabic=64587,e.noonmedialarabic=65256,e.noonmeeminitialarabic=64725,e.noonmeemisolatedarabic=64590,e.noonnoonfinalarabic=64653,e.notcontains=8716,e.notelement=8713,e.notelementof=8713,e.notequal=8800,e.notgreater=8815,e.notgreaternorequal=8817,e.notgreaternorless=8825,e.notidentical=8802,e.notless=8814,e.notlessnorequal=8816,e.notparallel=8742,e.notprecedes=8832,e.notsubset=8836,e.notsucceeds=8833,e.notsuperset=8837,e.nowarmenian=1398,e.nparen=9385,e.nssquare=13233,e.nsuperior=8319,e.ntilde=241,e.nu=957,e.nuhiragana=12396,e.nukatakana=12492,e.nukatakanahalfwidth=65415,e.nuktabengali=2492,e.nuktadeva=2364,e.nuktagujarati=2748,e.nuktagurmukhi=2620,e.numbersign=35,e.numbersignmonospace=65283,e.numbersignsmall=65119,e.numeralsigngreek=884,e.numeralsignlowergreek=885,e.numero=8470,e.nun=1504,e.nundagesh=64320,e.nundageshhebrew=64320,e.nunhebrew=1504,e.nvsquare=13237,e.nwsquare=13243,e.nyabengali=2462,e.nyadeva=2334,e.nyagujarati=2718,e.nyagurmukhi=2590,e.o=111,e.oacute=243,e.oangthai=3629,e.obarred=629,e.obarredcyrillic=1257,e.obarreddieresiscyrillic=1259,e.obengali=2451,e.obopomofo=12571,e.obreve=335,e.ocandradeva=2321,e.ocandragujarati=2705,e.ocandravowelsigndeva=2377,e.ocandravowelsigngujarati=2761,e.ocaron=466,e.ocircle=9438,e.ocircumflex=244,e.ocircumflexacute=7889,e.ocircumflexdotbelow=7897,e.ocircumflexgrave=7891,e.ocircumflexhookabove=7893,e.ocircumflextilde=7895,e.ocyrillic=1086,e.odblacute=337,e.odblgrave=525,e.odeva=2323,e.odieresis=246,e.odieresiscyrillic=1255,e.odotbelow=7885,e.oe=339,e.oekorean=12634,e.ogonek=731,e.ogonekcmb=808,e.ograve=242,e.ogujarati=2707,e.oharmenian=1413,e.ohiragana=12362,e.ohookabove=7887,e.ohorn=417,e.ohornacute=7899,e.ohorndotbelow=7907,e.ohorngrave=7901,e.ohornhookabove=7903,e.ohorntilde=7905,e.ohungarumlaut=337,e.oi=419,e.oinvertedbreve=527,e.okatakana=12458,e.okatakanahalfwidth=65397,e.okorean=12631,e.olehebrew=1451,e.omacron=333,e.omacronacute=7763,e.omacrongrave=7761,e.omdeva=2384,e.omega=969,e.omega1=982,e.omegacyrillic=1121,e.omegalatinclosed=631,e.omegaroundcyrillic=1147,e.omegatitlocyrillic=1149,e.omegatonos=974,e.omgujarati=2768,e.omicron=959,e.omicrontonos=972,e.omonospace=65359,e.one=49,e.onearabic=1633,e.onebengali=2535,e.onecircle=9312,e.onecircleinversesansserif=10122,e.onedeva=2407,e.onedotenleader=8228,e.oneeighth=8539,e.onefitted=63196,e.onegujarati=2791,e.onegurmukhi=2663,e.onehackarabic=1633,e.onehalf=189,e.onehangzhou=12321,e.oneideographicparen=12832,e.oneinferior=8321,e.onemonospace=65297,e.onenumeratorbengali=2548,e.oneoldstyle=63281,e.oneparen=9332,e.oneperiod=9352,e.onepersian=1777,e.onequarter=188,e.oneroman=8560,e.onesuperior=185,e.onethai=3665,e.onethird=8531,e.oogonek=491,e.oogonekmacron=493,e.oogurmukhi=2579,e.oomatragurmukhi=2635,e.oopen=596,e.oparen=9386,e.openbullet=9702,e.option=8997,e.ordfeminine=170,e.ordmasculine=186,e.orthogonal=8735,e.oshortdeva=2322,e.oshortvowelsigndeva=2378,e.oslash=248,e.oslashacute=511,e.osmallhiragana=12361,e.osmallkatakana=12457,e.osmallkatakanahalfwidth=65387,e.ostrokeacute=511,e.osuperior=63216,e.otcyrillic=1151,e.otilde=245,e.otildeacute=7757,e.otildedieresis=7759,e.oubopomofo=12577,e.overline=8254,e.overlinecenterline=65098,e.overlinecmb=773,e.overlinedashed=65097,e.overlinedblwavy=65100,e.overlinewavy=65099,e.overscore=175,e.ovowelsignbengali=2507,e.ovowelsigndeva=2379,e.ovowelsigngujarati=2763,e.p=112,e.paampssquare=13184,e.paasentosquare=13099,e.pabengali=2474,e.pacute=7765,e.padeva=2346,e.pagedown=8671,e.pageup=8670,e.pagujarati=2730,e.pagurmukhi=2602,e.pahiragana=12401,e.paiyannoithai=3631,e.pakatakana=12497,e.palatalizationcyrilliccmb=1156,e.palochkacyrillic=1216,e.pansioskorean=12671,e.paragraph=182,e.parallel=8741,e.parenleft=40,e.parenleftaltonearabic=64830,e.parenleftbt=63725,e.parenleftex=63724,e.parenleftinferior=8333,e.parenleftmonospace=65288,e.parenleftsmall=65113,e.parenleftsuperior=8317,e.parenlefttp=63723,e.parenleftvertical=65077,e.parenright=41,e.parenrightaltonearabic=64831,e.parenrightbt=63736,e.parenrightex=63735,e.parenrightinferior=8334,e.parenrightmonospace=65289,e.parenrightsmall=65114,e.parenrightsuperior=8318,e.parenrighttp=63734,e.parenrightvertical=65078,e.partialdiff=8706,e.paseqhebrew=1472,e.pashtahebrew=1433,e.pasquare=13225,e.patah=1463,e.patah11=1463,e.patah1d=1463,e.patah2a=1463,e.patahhebrew=1463,e.patahnarrowhebrew=1463,e.patahquarterhebrew=1463,e.patahwidehebrew=1463,e.pazerhebrew=1441,e.pbopomofo=12550,e.pcircle=9439,e.pdotaccent=7767,e.pe=1508,e.pecyrillic=1087,e.pedagesh=64324,e.pedageshhebrew=64324,e.peezisquare=13115,e.pefinaldageshhebrew=64323,e.peharabic=1662,e.peharmenian=1402,e.pehebrew=1508,e.pehfinalarabic=64343,e.pehinitialarabic=64344,e.pehiragana=12410,e.pehmedialarabic=64345,e.pekatakana=12506,e.pemiddlehookcyrillic=1191,e.perafehebrew=64334,e.percent=37,e.percentarabic=1642,e.percentmonospace=65285,e.percentsmall=65130,e.period=46,e.periodarmenian=1417,e.periodcentered=183,e.periodhalfwidth=65377,e.periodinferior=63207,e.periodmonospace=65294,e.periodsmall=65106,e.periodsuperior=63208,e.perispomenigreekcmb=834,e.perpendicular=8869,e.perthousand=8240,e.peseta=8359,e.pfsquare=13194,e.phabengali=2475,e.phadeva=2347,e.phagujarati=2731,e.phagurmukhi=2603,e.phi=966,e.phi1=981,e.phieuphacirclekorean=12922,e.phieuphaparenkorean=12826,e.phieuphcirclekorean=12908,e.phieuphkorean=12621,e.phieuphparenkorean=12812,e.philatin=632,e.phinthuthai=3642,e.phisymbolgreek=981,e.phook=421,e.phophanthai=3614,e.phophungthai=3612,e.phosamphaothai=3616,e.pi=960,e.pieupacirclekorean=12915,e.pieupaparenkorean=12819,e.pieupcieuckorean=12662,e.pieupcirclekorean=12901,e.pieupkiyeokkorean=12658,e.pieupkorean=12610,e.pieupparenkorean=12805,e.pieupsioskiyeokkorean=12660,e.pieupsioskorean=12612,e.pieupsiostikeutkorean=12661,e.pieupthieuthkorean=12663,e.pieuptikeutkorean=12659,e.pihiragana=12404,e.pikatakana=12500,e.pisymbolgreek=982,e.piwrarmenian=1411,e.plus=43,e.plusbelowcmb=799,e.pluscircle=8853,e.plusminus=177,e.plusmod=726,e.plusmonospace=65291,e.plussmall=65122,e.plussuperior=8314,e.pmonospace=65360,e.pmsquare=13272,e.pohiragana=12413,e.pointingindexdownwhite=9759,e.pointingindexleftwhite=9756,e.pointingindexrightwhite=9758,e.pointingindexupwhite=9757,e.pokatakana=12509,e.poplathai=3611,e.postalmark=12306,e.postalmarkface=12320,e.pparen=9387,e.precedes=8826,e.prescription=8478,e.primemod=697,e.primereversed=8245,e.product=8719,e.projective=8965,e.prolongedkana=12540,e.propellor=8984,e.propersubset=8834,e.propersuperset=8835,e.proportion=8759,e.proportional=8733,e.psi=968,e.psicyrillic=1137,e.psilipneumatacyrilliccmb=1158,e.pssquare=13232,e.puhiragana=12407,e.pukatakana=12503,e.pvsquare=13236,e.pwsquare=13242,e.q=113,e.qadeva=2392,e.qadmahebrew=1448,e.qafarabic=1602,e.qaffinalarabic=65238,e.qafinitialarabic=65239,e.qafmedialarabic=65240,e.qamats=1464,e.qamats10=1464,e.qamats1a=1464,e.qamats1c=1464,e.qamats27=1464,e.qamats29=1464,e.qamats33=1464,e.qamatsde=1464,e.qamatshebrew=1464,e.qamatsnarrowhebrew=1464,e.qamatsqatanhebrew=1464,e.qamatsqatannarrowhebrew=1464,e.qamatsqatanquarterhebrew=1464,e.qamatsqatanwidehebrew=1464,e.qamatsquarterhebrew=1464,e.qamatswidehebrew=1464,e.qarneyparahebrew=1439,e.qbopomofo=12561,e.qcircle=9440,e.qhook=672,e.qmonospace=65361,e.qof=1511,e.qofdagesh=64327,e.qofdageshhebrew=64327,e.qofhebrew=1511,e.qparen=9388,e.quarternote=9833,e.qubuts=1467,e.qubuts18=1467,e.qubuts25=1467,e.qubuts31=1467,e.qubutshebrew=1467,e.qubutsnarrowhebrew=1467,e.qubutsquarterhebrew=1467,e.qubutswidehebrew=1467,e.question=63,e.questionarabic=1567,e.questionarmenian=1374,e.questiondown=191,e.questiondownsmall=63423,e.questiongreek=894,e.questionmonospace=65311,e.questionsmall=63295,e.quotedbl=34,e.quotedblbase=8222,e.quotedblleft=8220,e.quotedblmonospace=65282,e.quotedblprime=12318,e.quotedblprimereversed=12317,e.quotedblright=8221,e.quoteleft=8216,e.quoteleftreversed=8219,e.quotereversed=8219,e.quoteright=8217,e.quoterightn=329,e.quotesinglbase=8218,e.quotesingle=39,e.quotesinglemonospace=65287,e.r=114,e.raarmenian=1404,e.rabengali=2480,e.racute=341,e.radeva=2352,e.radical=8730,e.radicalex=63717,e.radoverssquare=13230,e.radoverssquaredsquare=13231,e.radsquare=13229,e.rafe=1471,e.rafehebrew=1471,e.ragujarati=2736,e.ragurmukhi=2608,e.rahiragana=12425,e.rakatakana=12521,e.rakatakanahalfwidth=65431,e.ralowerdiagonalbengali=2545,e.ramiddlediagonalbengali=2544,e.ramshorn=612,e.ratio=8758,e.rbopomofo=12566,e.rcaron=345,e.rcedilla=343,e.rcircle=9441,e.rcommaaccent=343,e.rdblgrave=529,e.rdotaccent=7769,e.rdotbelow=7771,e.rdotbelowmacron=7773,e.referencemark=8251,e.reflexsubset=8838,e.reflexsuperset=8839,e.registered=174,e.registersans=63720,e.registerserif=63194,e.reharabic=1585,e.reharmenian=1408,e.rehfinalarabic=65198,e.rehiragana=12428,e.rekatakana=12524,e.rekatakanahalfwidth=65434,e.resh=1512,e.reshdageshhebrew=64328,e.reshhebrew=1512,e.reversedtilde=8765,e.reviahebrew=1431;e.reviamugrashhebrew=1431,e.revlogicalnot=8976,e.rfishhook=638,e.rfishhookreversed=639,e.rhabengali=2525,e.rhadeva=2397,e.rho=961,e.rhook=637,e.rhookturned=635,e.rhookturnedsuperior=693,e.rhosymbolgreek=1009,e.rhotichookmod=734,e.rieulacirclekorean=12913,e.rieulaparenkorean=12817,e.rieulcirclekorean=12899,e.rieulhieuhkorean=12608,e.rieulkiyeokkorean=12602,e.rieulkiyeoksioskorean=12649,e.rieulkorean=12601,e.rieulmieumkorean=12603,e.rieulpansioskorean=12652,e.rieulparenkorean=12803,e.rieulphieuphkorean=12607,e.rieulpieupkorean=12604,e.rieulpieupsioskorean=12651,e.rieulsioskorean=12605,e.rieulthieuthkorean=12606,e.rieultikeutkorean=12650,e.rieulyeorinhieuhkorean=12653,e.rightangle=8735,e.righttackbelowcmb=793,e.righttriangle=8895,e.rihiragana=12426,e.rikatakana=12522,e.rikatakanahalfwidth=65432,e.ring=730,e.ringbelowcmb=805,e.ringcmb=778,e.ringhalfleft=703,e.ringhalfleftarmenian=1369,e.ringhalfleftbelowcmb=796,e.ringhalfleftcentered=723,e.ringhalfright=702,e.ringhalfrightbelowcmb=825,e.ringhalfrightcentered=722,e.rinvertedbreve=531,e.rittorusquare=13137,e.rlinebelow=7775,e.rlongleg=636,e.rlonglegturned=634,e.rmonospace=65362,e.rohiragana=12429,e.rokatakana=12525,e.rokatakanahalfwidth=65435,e.roruathai=3619,e.rparen=9389,e.rrabengali=2524,e.rradeva=2353,e.rragurmukhi=2652,e.rreharabic=1681,e.rrehfinalarabic=64397,e.rrvocalicbengali=2528,e.rrvocalicdeva=2400,e.rrvocalicgujarati=2784,e.rrvocalicvowelsignbengali=2500,e.rrvocalicvowelsigndeva=2372,e.rrvocalicvowelsigngujarati=2756,e.rsuperior=63217,e.rtblock=9616,e.rturned=633,e.rturnedsuperior=692,e.ruhiragana=12427,e.rukatakana=12523,e.rukatakanahalfwidth=65433,e.rupeemarkbengali=2546,e.rupeesignbengali=2547,e.rupiah=63197,e.ruthai=3620,e.rvocalicbengali=2443,e.rvocalicdeva=2315,e.rvocalicgujarati=2699,e.rvocalicvowelsignbengali=2499,e.rvocalicvowelsigndeva=2371,e.rvocalicvowelsigngujarati=2755,e.s=115,e.sabengali=2488,e.sacute=347,e.sacutedotaccent=7781,e.sadarabic=1589,e.sadeva=2360,e.sadfinalarabic=65210,e.sadinitialarabic=65211,e.sadmedialarabic=65212,e.sagujarati=2744,e.sagurmukhi=2616,e.sahiragana=12373,e.sakatakana=12469,e.sakatakanahalfwidth=65403,e.sallallahoualayhewasallamarabic=65018,e.samekh=1505,e.samekhdagesh=64321,e.samekhdageshhebrew=64321,e.samekhhebrew=1505,e.saraaathai=3634,e.saraaethai=3649,e.saraaimaimalaithai=3652,e.saraaimaimuanthai=3651,e.saraamthai=3635,e.saraathai=3632,e.saraethai=3648,e.saraiileftthai=63622,e.saraiithai=3637,e.saraileftthai=63621,e.saraithai=3636,e.saraothai=3650,e.saraueeleftthai=63624,e.saraueethai=3639,e.saraueleftthai=63623,e.sarauethai=3638,e.sarauthai=3640,e.sarauuthai=3641,e.sbopomofo=12569,e.scaron=353,e.scarondotaccent=7783,e.scedilla=351,e.schwa=601,e.schwacyrillic=1241,e.schwadieresiscyrillic=1243,e.schwahook=602,e.scircle=9442,e.scircumflex=349,e.scommaaccent=537,e.sdotaccent=7777,e.sdotbelow=7779,e.sdotbelowdotaccent=7785,e.seagullbelowcmb=828,e.second=8243,e.secondtonechinese=714,e.section=167,e.seenarabic=1587,e.seenfinalarabic=65202,e.seeninitialarabic=65203,e.seenmedialarabic=65204,e.segol=1462,e.segol13=1462,e.segol1f=1462,e.segol2c=1462,e.segolhebrew=1462,e.segolnarrowhebrew=1462,e.segolquarterhebrew=1462,e.segoltahebrew=1426,e.segolwidehebrew=1462,e.seharmenian=1405,e.sehiragana=12379,e.sekatakana=12475,e.sekatakanahalfwidth=65406,e.semicolon=59,e.semicolonarabic=1563,e.semicolonmonospace=65307,e.semicolonsmall=65108,e.semivoicedmarkkana=12444,e.semivoicedmarkkanahalfwidth=65439,e.sentisquare=13090,e.sentosquare=13091,e.seven=55,e.sevenarabic=1639,e.sevenbengali=2541,e.sevencircle=9318,e.sevencircleinversesansserif=10128,e.sevendeva=2413,e.seveneighths=8542,e.sevengujarati=2797,e.sevengurmukhi=2669,e.sevenhackarabic=1639,e.sevenhangzhou=12327,e.sevenideographicparen=12838,e.seveninferior=8327,e.sevenmonospace=65303,e.sevenoldstyle=63287,e.sevenparen=9338,e.sevenperiod=9358,e.sevenpersian=1783,e.sevenroman=8566,e.sevensuperior=8311,e.seventeencircle=9328,e.seventeenparen=9348,e.seventeenperiod=9368,e.seventhai=3671,e.sfthyphen=173,e.shaarmenian=1399,e.shabengali=2486,e.shacyrillic=1096,e.shaddaarabic=1617,e.shaddadammaarabic=64609,e.shaddadammatanarabic=64606,e.shaddafathaarabic=64608,e.shaddakasraarabic=64610,e.shaddakasratanarabic=64607,e.shade=9618,e.shadedark=9619,e.shadelight=9617,e.shademedium=9618,e.shadeva=2358,e.shagujarati=2742,e.shagurmukhi=2614,e.shalshelethebrew=1427,e.shbopomofo=12565,e.shchacyrillic=1097,e.sheenarabic=1588,e.sheenfinalarabic=65206,e.sheeninitialarabic=65207,e.sheenmedialarabic=65208,e.sheicoptic=995,e.sheqel=8362,e.sheqelhebrew=8362,e.sheva=1456,e.sheva115=1456,e.sheva15=1456,e.sheva22=1456,e.sheva2e=1456,e.shevahebrew=1456,e.shevanarrowhebrew=1456,e.shevaquarterhebrew=1456,e.shevawidehebrew=1456,e.shhacyrillic=1211,e.shimacoptic=1005,e.shin=1513,e.shindagesh=64329,e.shindageshhebrew=64329,e.shindageshshindot=64300,e.shindageshshindothebrew=64300,e.shindageshsindot=64301,e.shindageshsindothebrew=64301,e.shindothebrew=1473,e.shinhebrew=1513,e.shinshindot=64298,e.shinshindothebrew=64298,e.shinsindot=64299,e.shinsindothebrew=64299,e.shook=642,e.sigma=963,e.sigma1=962,e.sigmafinal=962,e.sigmalunatesymbolgreek=1010,e.sihiragana=12375,e.sikatakana=12471,e.sikatakanahalfwidth=65404,e.siluqhebrew=1469,e.siluqlefthebrew=1469,e.similar=8764,e.sindothebrew=1474,e.siosacirclekorean=12916,e.siosaparenkorean=12820,e.sioscieuckorean=12670,e.sioscirclekorean=12902,e.sioskiyeokkorean=12666,e.sioskorean=12613,e.siosnieunkorean=12667,e.siosparenkorean=12806,e.siospieupkorean=12669,e.siostikeutkorean=12668,e.six=54,e.sixarabic=1638,e.sixbengali=2540,e.sixcircle=9317,e.sixcircleinversesansserif=10127,e.sixdeva=2412,e.sixgujarati=2796,e.sixgurmukhi=2668,e.sixhackarabic=1638,e.sixhangzhou=12326,e.sixideographicparen=12837,e.sixinferior=8326,e.sixmonospace=65302,e.sixoldstyle=63286,e.sixparen=9337,e.sixperiod=9357,e.sixpersian=1782,e.sixroman=8565,e.sixsuperior=8310,e.sixteencircle=9327,e.sixteencurrencydenominatorbengali=2553,e.sixteenparen=9347,e.sixteenperiod=9367,e.sixthai=3670,e.slash=47,e.slashmonospace=65295,e.slong=383,e.slongdotaccent=7835,e.smileface=9786,e.smonospace=65363,e.sofpasuqhebrew=1475,e.softhyphen=173,e.softsigncyrillic=1100,e.sohiragana=12381,e.sokatakana=12477,e.sokatakanahalfwidth=65407,e.soliduslongoverlaycmb=824,e.solidusshortoverlaycmb=823,e.sorusithai=3625,e.sosalathai=3624,e.sosothai=3595,e.sosuathai=3626,e.space=32,e.spacehackarabic=32,e.spade=9824,e.spadesuitblack=9824,e.spadesuitwhite=9828,e.sparen=9390,e.squarebelowcmb=827,e.squarecc=13252,e.squarecm=13213,e.squarediagonalcrosshatchfill=9641,e.squarehorizontalfill=9636,e.squarekg=13199,e.squarekm=13214,e.squarekmcapital=13262,e.squareln=13265,e.squarelog=13266,e.squaremg=13198,e.squaremil=13269,e.squaremm=13212,e.squaremsquared=13217,e.squareorthogonalcrosshatchfill=9638,e.squareupperlefttolowerrightfill=9639,e.squareupperrighttolowerleftfill=9640,e.squareverticalfill=9637,e.squarewhitewithsmallblack=9635,e.srsquare=13275,e.ssabengali=2487,e.ssadeva=2359,e.ssagujarati=2743,e.ssangcieuckorean=12617,e.ssanghieuhkorean=12677,e.ssangieungkorean=12672,e.ssangkiyeokkorean=12594,e.ssangnieunkorean=12645,e.ssangpieupkorean=12611,e.ssangsioskorean=12614,e.ssangtikeutkorean=12600,e.ssuperior=63218,e.sterling=163,e.sterlingmonospace=65505,e.strokelongoverlaycmb=822,e.strokeshortoverlaycmb=821,e.subset=8834,e.subsetnotequal=8842,e.subsetorequal=8838,e.succeeds=8827,e.suchthat=8715,e.suhiragana=12377,e.sukatakana=12473,e.sukatakanahalfwidth=65405,e.sukunarabic=1618,e.summation=8721,e.sun=9788,e.superset=8835,e.supersetnotequal=8843,e.supersetorequal=8839,e.svsquare=13276,e.syouwaerasquare=13180,e.t=116,e.tabengali=2468,e.tackdown=8868,e.tackleft=8867,e.tadeva=2340,e.tagujarati=2724,e.tagurmukhi=2596,e.taharabic=1591,e.tahfinalarabic=65218,e.tahinitialarabic=65219,e.tahiragana=12383,e.tahmedialarabic=65220,e.taisyouerasquare=13181,e.takatakana=12479,e.takatakanahalfwidth=65408,e.tatweelarabic=1600,e.tau=964,e.tav=1514,e.tavdages=64330,e.tavdagesh=64330,e.tavdageshhebrew=64330,e.tavhebrew=1514,e.tbar=359,e.tbopomofo=12554,e.tcaron=357,e.tccurl=680,e.tcedilla=355,e.tcheharabic=1670,e.tchehfinalarabic=64379,e.tchehinitialarabic=64380,e.tchehmedialarabic=64381,e.tcircle=9443,e.tcircumflexbelow=7793,e.tcommaaccent=355,e.tdieresis=7831,e.tdotaccent=7787,e.tdotbelow=7789,e.tecyrillic=1090,e.tedescendercyrillic=1197,e.teharabic=1578,e.tehfinalarabic=65174,e.tehhahinitialarabic=64674,e.tehhahisolatedarabic=64524,e.tehinitialarabic=65175,e.tehiragana=12390,e.tehjeeminitialarabic=64673,e.tehjeemisolatedarabic=64523,e.tehmarbutaarabic=1577,e.tehmarbutafinalarabic=65172,e.tehmedialarabic=65176,e.tehmeeminitialarabic=64676,e.tehmeemisolatedarabic=64526,e.tehnoonfinalarabic=64627,e.tekatakana=12486,e.tekatakanahalfwidth=65411,e.telephone=8481,e.telephoneblack=9742,e.telishagedolahebrew=1440,e.telishaqetanahebrew=1449,e.tencircle=9321,e.tenideographicparen=12841,e.tenparen=9341,e.tenperiod=9361,e.tenroman=8569,e.tesh=679,e.tet=1496,e.tetdagesh=64312,e.tetdageshhebrew=64312,e.tethebrew=1496,e.tetsecyrillic=1205,e.tevirhebrew=1435,e.tevirlefthebrew=1435,e.thabengali=2469,e.thadeva=2341,e.thagujarati=2725,e.thagurmukhi=2597,e.thalarabic=1584,e.thalfinalarabic=65196,e.thanthakhatlowleftthai=63640,e.thanthakhatlowrightthai=63639,e.thanthakhatthai=3660,e.thanthakhatupperleftthai=63638,e.theharabic=1579,e.thehfinalarabic=65178,e.thehinitialarabic=65179,e.thehmedialarabic=65180,e.thereexists=8707,e.therefore=8756,e.theta=952,e.theta1=977,e.thetasymbolgreek=977,e.thieuthacirclekorean=12921,e.thieuthaparenkorean=12825,e.thieuthcirclekorean=12907,e.thieuthkorean=12620,e.thieuthparenkorean=12811,e.thirteencircle=9324,e.thirteenparen=9344,e.thirteenperiod=9364,e.thonangmonthothai=3601,e.thook=429,e.thophuthaothai=3602,e.thorn=254,e.thothahanthai=3607,e.thothanthai=3600,e.thothongthai=3608,e.thothungthai=3606,e.thousandcyrillic=1154,e.thousandsseparatorarabic=1644,e.thousandsseparatorpersian=1644,e.three=51,e.threearabic=1635,e.threebengali=2537,e.threecircle=9314,e.threecircleinversesansserif=10124,e.threedeva=2409,e.threeeighths=8540,e.threegujarati=2793,e.threegurmukhi=2665,e.threehackarabic=1635,e.threehangzhou=12323,e.threeideographicparen=12834,e.threeinferior=8323,e.threemonospace=65299,e.threenumeratorbengali=2550,e.threeoldstyle=63283,e.threeparen=9334,e.threeperiod=9354,e.threepersian=1779,e.threequarters=190,e.threequartersemdash=63198,e.threeroman=8562,e.threesuperior=179,e.threethai=3667,e.thzsquare=13204,e.tihiragana=12385,e.tikatakana=12481,e.tikatakanahalfwidth=65409,e.tikeutacirclekorean=12912,e.tikeutaparenkorean=12816,e.tikeutcirclekorean=12898,e.tikeutkorean=12599,e.tikeutparenkorean=12802,e.tilde=732,e.tildebelowcmb=816,e.tildecmb=771,e.tildecomb=771,e.tildedoublecmb=864,e.tildeoperator=8764,e.tildeoverlaycmb=820,e.tildeverticalcmb=830,e.timescircle=8855,e.tipehahebrew=1430,e.tipehalefthebrew=1430,e.tippigurmukhi=2672,e.titlocyrilliccmb=1155,e.tiwnarmenian=1407,e.tlinebelow=7791,e.tmonospace=65364,e.toarmenian=1385,e.tohiragana=12392,e.tokatakana=12488,e.tokatakanahalfwidth=65412,e.tonebarextrahighmod=741,e.tonebarextralowmod=745,e.tonebarhighmod=742,e.tonebarlowmod=744,e.tonebarmidmod=743,e.tonefive=445,e.tonesix=389,e.tonetwo=424,e.tonos=900,e.tonsquare=13095,e.topatakthai=3599,e.tortoiseshellbracketleft=12308,e.tortoiseshellbracketleftsmall=65117,e.tortoiseshellbracketleftvertical=65081,e.tortoiseshellbracketright=12309,e.tortoiseshellbracketrightsmall=65118,e.tortoiseshellbracketrightvertical=65082,e.totaothai=3605,e.tpalatalhook=427,e.tparen=9391,e.trademark=8482,e.trademarksans=63722,e.trademarkserif=63195,e.tretroflexhook=648,e.triagdn=9660,e.triaglf=9668,e.triagrt=9658,e.triagup=9650,e.ts=678,e.tsadi=1510,e.tsadidagesh=64326,e.tsadidageshhebrew=64326,e.tsadihebrew=1510,e.tsecyrillic=1094,e.tsere=1461,e.tsere12=1461,e.tsere1e=1461,e.tsere2b=1461,e.tserehebrew=1461,e.tserenarrowhebrew=1461,e.tserequarterhebrew=1461,e.tserewidehebrew=1461,e.tshecyrillic=1115,e.tsuperior=63219,e.ttabengali=2463,e.ttadeva=2335,e.ttagujarati=2719,e.ttagurmukhi=2591,e.tteharabic=1657,e.ttehfinalarabic=64359,e.ttehinitialarabic=64360,e.ttehmedialarabic=64361,e.tthabengali=2464,e.tthadeva=2336,e.tthagujarati=2720,e.tthagurmukhi=2592,e.tturned=647,e.tuhiragana=12388,e.tukatakana=12484,e.tukatakanahalfwidth=65410,e.tusmallhiragana=12387,e.tusmallkatakana=12483,e.tusmallkatakanahalfwidth=65391,e.twelvecircle=9323,e.twelveparen=9343,e.twelveperiod=9363,e.twelveroman=8571,e.twentycircle=9331,e.twentyhangzhou=21316,e.twentyparen=9351,e.twentyperiod=9371,e.two=50,e.twoarabic=1634,e.twobengali=2536,e.twocircle=9313,e.twocircleinversesansserif=10123,e.twodeva=2408,e.twodotenleader=8229,e.twodotleader=8229,e.twodotleadervertical=65072,e.twogujarati=2792,e.twogurmukhi=2664,e.twohackarabic=1634,e.twohangzhou=12322,e.twoideographicparen=12833,e.twoinferior=8322,e.twomonospace=65298,e.twonumeratorbengali=2549,e.twooldstyle=63282,e.twoparen=9333,e.twoperiod=9353,e.twopersian=1778,e.tworoman=8561,e.twostroke=443,e.twosuperior=178,e.twothai=3666,e.twothirds=8532,e.u=117,e.uacute=250,e.ubar=649,e.ubengali=2441,e.ubopomofo=12584,e.ubreve=365,e.ucaron=468,e.ucircle=9444,e.ucircumflex=251,e.ucircumflexbelow=7799,e.ucyrillic=1091,e.udattadeva=2385,e.udblacute=369,e.udblgrave=533,e.udeva=2313,e.udieresis=252,e.udieresisacute=472,e.udieresisbelow=7795,e.udieresiscaron=474,e.udieresiscyrillic=1265,e.udieresisgrave=476,e.udieresismacron=470,e.udotbelow=7909,e.ugrave=249,e.ugujarati=2697,e.ugurmukhi=2569,e.uhiragana=12358,e.uhookabove=7911,e.uhorn=432,e.uhornacute=7913,e.uhorndotbelow=7921,e.uhorngrave=7915,e.uhornhookabove=7917,e.uhorntilde=7919,e.uhungarumlaut=369,e.uhungarumlautcyrillic=1267,e.uinvertedbreve=535,e.ukatakana=12454,e.ukatakanahalfwidth=65395,e.ukcyrillic=1145,e.ukorean=12636,e.umacron=363,e.umacroncyrillic=1263,e.umacrondieresis=7803,e.umatragurmukhi=2625,e.umonospace=65365,e.underscore=95,e.underscoredbl=8215,e.underscoremonospace=65343,e.underscorevertical=65075,e.underscorewavy=65103,e.union=8746,e.universal=8704,e.uogonek=371,e.uparen=9392,e.upblock=9600,e.upperdothebrew=1476,e.upsilon=965,e.upsilondieresis=971,e.upsilondieresistonos=944,e.upsilonlatin=650,e.upsilontonos=973,e.uptackbelowcmb=797,e.uptackmod=724,e.uragurmukhi=2675,e.uring=367,e.ushortcyrillic=1118,e.usmallhiragana=12357,e.usmallkatakana=12453,e.usmallkatakanahalfwidth=65385,e.ustraightcyrillic=1199,e.ustraightstrokecyrillic=1201,e.utilde=361,e.utildeacute=7801,e.utildebelow=7797,e.uubengali=2442,e.uudeva=2314,e.uugujarati=2698,e.uugurmukhi=2570,e.uumatragurmukhi=2626,e.uuvowelsignbengali=2498,e.uuvowelsigndeva=2370,e.uuvowelsigngujarati=2754,e.uvowelsignbengali=2497,e.uvowelsigndeva=2369,e.uvowelsigngujarati=2753,e.v=118,e.vadeva=2357,e.vagujarati=2741,e.vagurmukhi=2613,e.vakatakana=12535,e.vav=1493,e.vavdagesh=64309,e.vavdagesh65=64309,e.vavdageshhebrew=64309,e.vavhebrew=1493,e.vavholam=64331,e.vavholamhebrew=64331,e.vavvavhebrew=1520,e.vavyodhebrew=1521,e.vcircle=9445,e.vdotbelow=7807,e.vecyrillic=1074,e.veharabic=1700,e.vehfinalarabic=64363,e.vehinitialarabic=64364,e.vehmedialarabic=64365,e.vekatakana=12537,e.venus=9792,e.verticalbar=124,e.verticallineabovecmb=781,e.verticallinebelowcmb=809,e.verticallinelowmod=716,e.verticallinemod=712,e.vewarmenian=1406,e.vhook=651,e.vikatakana=12536,e.viramabengali=2509,e.viramadeva=2381,e.viramagujarati=2765,e.visargabengali=2435,e.visargadeva=2307,e.visargagujarati=2691,e.vmonospace=65366,e.voarmenian=1400,e.voicediterationhiragana=12446,e.voicediterationkatakana=12542,e.voicedmarkkana=12443,e.voicedmarkkanahalfwidth=65438,e.vokatakana=12538,e.vparen=9393,e.vtilde=7805,e.vturned=652,e.vuhiragana=12436,e.vukatakana=12532,e.w=119,e.wacute=7811,e.waekorean=12633,e.wahiragana=12431,e.wakatakana=12527,e.wakatakanahalfwidth=65436,e.wakorean=12632,e.wasmallhiragana=12430,e.wasmallkatakana=12526,e.wattosquare=13143,e.wavedash=12316,e.wavyunderscorevertical=65076,e.wawarabic=1608,e.wawfinalarabic=65262,e.wawhamzaabovearabic=1572,e.wawhamzaabovefinalarabic=65158,e.wbsquare=13277,e.wcircle=9446,e.wcircumflex=373,e.wdieresis=7813,e.wdotaccent=7815,e.wdotbelow=7817,e.wehiragana=12433,e.weierstrass=8472,e.wekatakana=12529,e.wekorean=12638,e.weokorean=12637,e.wgrave=7809,e.whitebullet=9702,e.whitecircle=9675,e.whitecircleinverse=9689,e.whitecornerbracketleft=12302,e.whitecornerbracketleftvertical=65091,e.whitecornerbracketright=12303,e.whitecornerbracketrightvertical=65092,e.whitediamond=9671,e.whitediamondcontainingblacksmalldiamond=9672,e.whitedownpointingsmalltriangle=9663,e.whitedownpointingtriangle=9661,e.whiteleftpointingsmalltriangle=9667,e.whiteleftpointingtriangle=9665,e.whitelenticularbracketleft=12310,e.whitelenticularbracketright=12311,e.whiterightpointingsmalltriangle=9657;e.whiterightpointingtriangle=9655,e.whitesmallsquare=9643,e.whitesmilingface=9786,e.whitesquare=9633,e.whitestar=9734,e.whitetelephone=9743,e.whitetortoiseshellbracketleft=12312,e.whitetortoiseshellbracketright=12313,e.whiteuppointingsmalltriangle=9653,e.whiteuppointingtriangle=9651,e.wihiragana=12432,e.wikatakana=12528,e.wikorean=12639,e.wmonospace=65367,e.wohiragana=12434,e.wokatakana=12530,e.wokatakanahalfwidth=65382,e.won=8361,e.wonmonospace=65510,e.wowaenthai=3623,e.wparen=9394,e.wring=7832,e.wsuperior=695,e.wturned=653,e.wynn=447,e.x=120,e.xabovecmb=829,e.xbopomofo=12562,e.xcircle=9447,e.xdieresis=7821,e.xdotaccent=7819,e.xeharmenian=1389,e.xi=958,e.xmonospace=65368,e.xparen=9395,e.xsuperior=739,e.y=121,e.yaadosquare=13134,e.yabengali=2479,e.yacute=253,e.yadeva=2351,e.yaekorean=12626,e.yagujarati=2735,e.yagurmukhi=2607,e.yahiragana=12420,e.yakatakana=12516,e.yakatakanahalfwidth=65428,e.yakorean=12625,e.yamakkanthai=3662,e.yasmallhiragana=12419,e.yasmallkatakana=12515,e.yasmallkatakanahalfwidth=65388,e.yatcyrillic=1123,e.ycircle=9448,e.ycircumflex=375,e.ydieresis=255,e.ydotaccent=7823,e.ydotbelow=7925,e.yeharabic=1610,e.yehbarreearabic=1746,e.yehbarreefinalarabic=64431,e.yehfinalarabic=65266,e.yehhamzaabovearabic=1574,e.yehhamzaabovefinalarabic=65162,e.yehhamzaaboveinitialarabic=65163,e.yehhamzaabovemedialarabic=65164,e.yehinitialarabic=65267,e.yehmedialarabic=65268,e.yehmeeminitialarabic=64733,e.yehmeemisolatedarabic=64600,e.yehnoonfinalarabic=64660,e.yehthreedotsbelowarabic=1745,e.yekorean=12630,e.yen=165,e.yenmonospace=65509,e.yeokorean=12629,e.yeorinhieuhkorean=12678,e.yerahbenyomohebrew=1450,e.yerahbenyomolefthebrew=1450,e.yericyrillic=1099,e.yerudieresiscyrillic=1273,e.yesieungkorean=12673,e.yesieungpansioskorean=12675,e.yesieungsioskorean=12674,e.yetivhebrew=1434,e.ygrave=7923,e.yhook=436,e.yhookabove=7927,e.yiarmenian=1397,e.yicyrillic=1111,e.yikorean=12642,e.yinyang=9775,e.yiwnarmenian=1410,e.ymonospace=65369,e.yod=1497,e.yoddagesh=64313,e.yoddageshhebrew=64313,e.yodhebrew=1497,e.yodyodhebrew=1522,e.yodyodpatahhebrew=64287,e.yohiragana=12424,e.yoikorean=12681,e.yokatakana=12520,e.yokatakanahalfwidth=65430,e.yokorean=12635,e.yosmallhiragana=12423,e.yosmallkatakana=12519,e.yosmallkatakanahalfwidth=65390,e.yotgreek=1011,e.yoyaekorean=12680,e.yoyakorean=12679,e.yoyakthai=3618,e.yoyingthai=3597,e.yparen=9396,e.ypogegrammeni=890,e.ypogegrammenigreekcmb=837,e.yr=422,e.yring=7833,e.ysuperior=696,e.ytilde=7929,e.yturned=654,e.yuhiragana=12422,e.yuikorean=12684,e.yukatakana=12518,e.yukatakanahalfwidth=65429,e.yukorean=12640,e.yusbigcyrillic=1131,e.yusbigiotifiedcyrillic=1133,e.yuslittlecyrillic=1127,e.yuslittleiotifiedcyrillic=1129,e.yusmallhiragana=12421,e.yusmallkatakana=12517,e.yusmallkatakanahalfwidth=65389,e.yuyekorean=12683,e.yuyeokorean=12682,e.yyabengali=2527,e.yyadeva=2399,e.z=122,e.zaarmenian=1382,e.zacute=378,e.zadeva=2395,e.zagurmukhi=2651,e.zaharabic=1592,e.zahfinalarabic=65222,e.zahinitialarabic=65223,e.zahiragana=12374,e.zahmedialarabic=65224,e.zainarabic=1586,e.zainfinalarabic=65200,e.zakatakana=12470,e.zaqefgadolhebrew=1429,e.zaqefqatanhebrew=1428,e.zarqahebrew=1432,e.zayin=1494,e.zayindagesh=64310,e.zayindageshhebrew=64310,e.zayinhebrew=1494,e.zbopomofo=12567,e.zcaron=382,e.zcircle=9449,e.zcircumflex=7825,e.zcurl=657,e.zdot=380,e.zdotaccent=380,e.zdotbelow=7827,e.zecyrillic=1079,e.zedescendercyrillic=1177,e.zedieresiscyrillic=1247,e.zehiragana=12380,e.zekatakana=12476,e.zero=48,e.zeroarabic=1632,e.zerobengali=2534,e.zerodeva=2406,e.zerogujarati=2790,e.zerogurmukhi=2662,e.zerohackarabic=1632,e.zeroinferior=8320,e.zeromonospace=65296,e.zerooldstyle=63280,e.zeropersian=1776,e.zerosuperior=8304,e.zerothai=3664,e.zerowidthjoiner=65279,e.zerowidthnonjoiner=8204,e.zerowidthspace=8203,e.zeta=950,e.zhbopomofo=12563,e.zhearmenian=1386,e.zhebrevecyrillic=1218,e.zhecyrillic=1078,e.zhedescendercyrillic=1175,e.zhedieresiscyrillic=1245,e.zihiragana=12376,e.zikatakana=12472,e.zinorhebrew=1454,e.zlinebelow=7829,e.zmonospace=65370,e.zohiragana=12382,e.zokatakana=12478,e.zparen=9397,e.zretroflexhook=656,e.zstroke=438,e.zuhiragana=12378,e.zukatakana=12474,e[".notdef"]=0,e.angbracketleftbig=9001,e.angbracketleftBig=9001,e.angbracketleftbigg=9001,e.angbracketleftBigg=9001,e.angbracketrightBig=9002,e.angbracketrightbig=9002,e.angbracketrightBigg=9002,e.angbracketrightbigg=9002,e.arrowhookleft=8618,e.arrowhookright=8617,e.arrowlefttophalf=8636,e.arrowleftbothalf=8637,e.arrownortheast=8599,e.arrownorthwest=8598,e.arrowrighttophalf=8640,e.arrowrightbothalf=8641,e.arrowsoutheast=8600,e.arrowsouthwest=8601,e.backslashbig=8726,e.backslashBig=8726,e.backslashBigg=8726,e.backslashbigg=8726,e.bardbl=8214,e.bracehtipdownleft=65079,e.bracehtipdownright=65079,e.bracehtipupleft=65080,e.bracehtipupright=65080,e.braceleftBig=123,e.braceleftbig=123,e.braceleftbigg=123,e.braceleftBigg=123,e.bracerightBig=125,e.bracerightbig=125,e.bracerightbigg=125,e.bracerightBigg=125,e.bracketleftbig=91,e.bracketleftBig=91,e.bracketleftbigg=91,e.bracketleftBigg=91,e.bracketrightBig=93,e.bracketrightbig=93,e.bracketrightbigg=93,e.bracketrightBigg=93,e.ceilingleftbig=8968,e.ceilingleftBig=8968,e.ceilingleftBigg=8968,e.ceilingleftbigg=8968,e.ceilingrightbig=8969,e.ceilingrightBig=8969,e.ceilingrightbigg=8969,e.ceilingrightBigg=8969,e.circledotdisplay=8857,e.circledottext=8857,e.circlemultiplydisplay=8855,e.circlemultiplytext=8855,e.circleplusdisplay=8853,e.circleplustext=8853,e.contintegraldisplay=8750,e.contintegraltext=8750,e.coproductdisplay=8720,e.coproducttext=8720,e.floorleftBig=8970,e.floorleftbig=8970,e.floorleftbigg=8970,e.floorleftBigg=8970,e.floorrightbig=8971,e.floorrightBig=8971,e.floorrightBigg=8971,e.floorrightbigg=8971,e.hatwide=770,e.hatwider=770,e.hatwidest=770,e.intercal=7488,e.integraldisplay=8747,e.integraltext=8747,e.intersectiondisplay=8898,e.intersectiontext=8898,e.logicalanddisplay=8743,e.logicalandtext=8743,e.logicalordisplay=8744,e.logicalortext=8744,e.parenleftBig=40,e.parenleftbig=40,e.parenleftBigg=40,e.parenleftbigg=40,e.parenrightBig=41,e.parenrightbig=41,e.parenrightBigg=41,e.parenrightbigg=41,e.prime=8242,e.productdisplay=8719,e.producttext=8719,e.radicalbig=8730,e.radicalBig=8730,e.radicalBigg=8730,e.radicalbigg=8730,e.radicalbt=8730,e.radicaltp=8730,e.radicalvertex=8730,e.slashbig=47,e.slashBig=47,e.slashBigg=47,e.slashbigg=47,e.summationdisplay=8721,e.summationtext=8721,e.tildewide=732,e.tildewider=732,e.tildewidest=732,e.uniondisplay=8899,e.unionmultidisplay=8846,e.unionmultitext=8846,e.unionsqdisplay=8852,e.unionsqtext=8852,e.uniontext=8899,e.vextenddouble=8741,e.vextendsingle=8739})),o=n((function(e){e.space=32,e.a1=9985,e.a2=9986,e.a202=9987,e.a3=9988,e.a4=9742,e.a5=9990,e.a119=9991,e.a118=9992,e.a117=9993,e.a11=9755,e.a12=9758,e.a13=9996,e.a14=9997,e.a15=9998,e.a16=9999,e.a105=1e4,e.a17=10001,e.a18=10002,e.a19=10003,e.a20=10004,e.a21=10005,e.a22=10006,e.a23=10007,e.a24=10008,e.a25=10009,e.a26=10010,e.a27=10011,e.a28=10012,e.a6=10013,e.a7=10014,e.a8=10015,e.a9=10016,e.a10=10017,e.a29=10018,e.a30=10019,e.a31=10020,e.a32=10021,e.a33=10022,e.a34=10023,e.a35=9733,e.a36=10025,e.a37=10026,e.a38=10027,e.a39=10028,e.a40=10029,e.a41=10030,e.a42=10031,e.a43=10032,e.a44=10033,e.a45=10034,e.a46=10035,e.a47=10036,e.a48=10037,e.a49=10038,e.a50=10039,e.a51=10040,e.a52=10041,e.a53=10042,e.a54=10043,e.a55=10044,e.a56=10045,e.a57=10046,e.a58=10047,e.a59=10048,e.a60=10049,e.a61=10050,e.a62=10051,e.a63=10052,e.a64=10053,e.a65=10054,e.a66=10055,e.a67=10056,e.a68=10057,e.a69=10058,e.a70=10059,e.a71=9679,e.a72=10061,e.a73=9632,e.a74=10063,e.a203=10064,e.a75=10065,e.a204=10066,e.a76=9650,e.a77=9660,e.a78=9670,e.a79=10070,e.a81=9687,e.a82=10072,e.a83=10073,e.a84=10074,e.a97=10075,e.a98=10076,e.a99=10077,e.a100=10078,e.a101=10081,e.a102=10082,e.a103=10083,e.a104=10084,e.a106=10085,e.a107=10086,e.a108=10087,e.a112=9827,e.a111=9830,e.a110=9829,e.a109=9824,e.a120=9312,e.a121=9313,e.a122=9314,e.a123=9315,e.a124=9316,e.a125=9317,e.a126=9318,e.a127=9319,e.a128=9320,e.a129=9321,e.a130=10102,e.a131=10103,e.a132=10104,e.a133=10105,e.a134=10106,e.a135=10107,e.a136=10108,e.a137=10109,e.a138=10110,e.a139=10111,e.a140=10112,e.a141=10113,e.a142=10114,e.a143=10115,e.a144=10116,e.a145=10117,e.a146=10118,e.a147=10119,e.a148=10120,e.a149=10121,e.a150=10122,e.a151=10123,e.a152=10124,e.a153=10125,e.a154=10126,e.a155=10127,e.a156=10128,e.a157=10129,e.a158=10130,e.a159=10131,e.a160=10132,e.a161=8594,e.a163=8596,e.a164=8597,e.a196=10136,e.a165=10137,e.a192=10138,e.a166=10139,e.a167=10140,e.a168=10141,e.a169=10142,e.a170=10143,e.a171=10144,e.a172=10145,e.a173=10146,e.a162=10147,e.a174=10148,e.a175=10149,e.a176=10150,e.a177=10151,e.a178=10152,e.a179=10153,e.a193=10154,e.a180=10155,e.a199=10156,e.a181=10157,e.a200=10158,e.a182=10159,e.a201=10161,e.a183=10162,e.a184=10163,e.a197=10164,e.a185=10165,e.a194=10166,e.a198=10167,e.a186=10168,e.a195=10169,e.a187=10170,e.a188=10171,e.a189=10172,e.a190=10173,e.a191=10174,e.a89=10088,e.a90=10089,e.a93=10090,e.a94=10091,e.a91=10092,e.a92=10093,e.a205=10094,e.a85=10095,e.a206=10096,e.a86=10097,e.a87=10098,e.a88=10099,e.a95=10100,e.a96=10101,e[".notdef"]=0}));t.getGlyphsUnicode=i,t.getDingbatsGlyphsUnicode=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getSupplementalGlyphMapForCalibri=t.getSupplementalGlyphMapForArialBlack=t.getGlyphMapForStandardFonts=t.getSymbolsFonts=t.getSerifFonts=t.getNonStdFontMap=t.getStdFontMap=void 0;var n=r(8);const i=(0,n.getLookupTableFactory)((function(e){e.ArialNarrow="Helvetica",e["ArialNarrow-Bold"]="Helvetica-Bold",e["ArialNarrow-BoldItalic"]="Helvetica-BoldOblique",e["ArialNarrow-Italic"]="Helvetica-Oblique",e.ArialBlack="Helvetica",e["ArialBlack-Bold"]="Helvetica-Bold",e["ArialBlack-BoldItalic"]="Helvetica-BoldOblique",e["ArialBlack-Italic"]="Helvetica-Oblique",e["Arial-Black"]="Helvetica",e["Arial-Black-Bold"]="Helvetica-Bold",e["Arial-Black-BoldItalic"]="Helvetica-BoldOblique",e["Arial-Black-Italic"]="Helvetica-Oblique",e.Arial="Helvetica",e["Arial-Bold"]="Helvetica-Bold",e["Arial-BoldItalic"]="Helvetica-BoldOblique",e["Arial-Italic"]="Helvetica-Oblique",e["Arial-BoldItalicMT"]="Helvetica-BoldOblique",e["Arial-BoldMT"]="Helvetica-Bold",e["Arial-ItalicMT"]="Helvetica-Oblique",e.ArialMT="Helvetica",e["Courier-Bold"]="Courier-Bold",e["Courier-BoldItalic"]="Courier-BoldOblique",e["Courier-Italic"]="Courier-Oblique",e.CourierNew="Courier",e["CourierNew-Bold"]="Courier-Bold",e["CourierNew-BoldItalic"]="Courier-BoldOblique",e["CourierNew-Italic"]="Courier-Oblique",e["CourierNewPS-BoldItalicMT"]="Courier-BoldOblique",e["CourierNewPS-BoldMT"]="Courier-Bold",e["CourierNewPS-ItalicMT"]="Courier-Oblique",e.CourierNewPSMT="Courier",e.Helvetica="Helvetica",e["Helvetica-Bold"]="Helvetica-Bold",e["Helvetica-BoldItalic"]="Helvetica-BoldOblique",e["Helvetica-BoldOblique"]="Helvetica-BoldOblique",e["Helvetica-Italic"]="Helvetica-Oblique",e["Helvetica-Oblique"]="Helvetica-Oblique",e["Symbol-Bold"]="Symbol",e["Symbol-BoldItalic"]="Symbol",e["Symbol-Italic"]="Symbol",e.TimesNewRoman="Times-Roman",e["TimesNewRoman-Bold"]="Times-Bold",e["TimesNewRoman-BoldItalic"]="Times-BoldItalic",e["TimesNewRoman-Italic"]="Times-Italic",e.TimesNewRomanPS="Times-Roman",e["TimesNewRomanPS-Bold"]="Times-Bold",e["TimesNewRomanPS-BoldItalic"]="Times-BoldItalic",e["TimesNewRomanPS-BoldItalicMT"]="Times-BoldItalic",e["TimesNewRomanPS-BoldMT"]="Times-Bold",e["TimesNewRomanPS-Italic"]="Times-Italic",e["TimesNewRomanPS-ItalicMT"]="Times-Italic",e.TimesNewRomanPSMT="Times-Roman",e["TimesNewRomanPSMT-Bold"]="Times-Bold",e["TimesNewRomanPSMT-BoldItalic"]="Times-BoldItalic",e["TimesNewRomanPSMT-Italic"]="Times-Italic"}));t.getStdFontMap=i;const o=(0,n.getLookupTableFactory)((function(e){e.Calibri="Helvetica",e["Calibri-Bold"]="Helvetica-Bold",e["Calibri-BoldItalic"]="Helvetica-BoldOblique",e["Calibri-Italic"]="Helvetica-Oblique",e.CenturyGothic="Helvetica",e["CenturyGothic-Bold"]="Helvetica-Bold",e["CenturyGothic-BoldItalic"]="Helvetica-BoldOblique",e["CenturyGothic-Italic"]="Helvetica-Oblique",e.ComicSansMS="Comic Sans MS",e["ComicSansMS-Bold"]="Comic Sans MS-Bold",e["ComicSansMS-BoldItalic"]="Comic Sans MS-BoldItalic",e["ComicSansMS-Italic"]="Comic Sans MS-Italic",e.LucidaConsole="Courier",e["LucidaConsole-Bold"]="Courier-Bold",e["LucidaConsole-BoldItalic"]="Courier-BoldOblique",e["LucidaConsole-Italic"]="Courier-Oblique",e["LucidaSans-Demi"]="Helvetica-Bold",e["MS-Gothic"]="MS Gothic",e["MS-Gothic-Bold"]="MS Gothic-Bold",e["MS-Gothic-BoldItalic"]="MS Gothic-BoldItalic",e["MS-Gothic-Italic"]="MS Gothic-Italic",e["MS-Mincho"]="MS Mincho",e["MS-Mincho-Bold"]="MS Mincho-Bold",e["MS-Mincho-BoldItalic"]="MS Mincho-BoldItalic",e["MS-Mincho-Italic"]="MS Mincho-Italic",e["MS-PGothic"]="MS PGothic",e["MS-PGothic-Bold"]="MS PGothic-Bold",e["MS-PGothic-BoldItalic"]="MS PGothic-BoldItalic",e["MS-PGothic-Italic"]="MS PGothic-Italic",e["MS-PMincho"]="MS PMincho",e["MS-PMincho-Bold"]="MS PMincho-Bold",e["MS-PMincho-BoldItalic"]="MS PMincho-BoldItalic",e["MS-PMincho-Italic"]="MS PMincho-Italic",e.NuptialScript="Times-Italic",e.SegoeUISymbol="Helvetica",e.Wingdings="ZapfDingbats",e["Wingdings-Regular"]="ZapfDingbats"}));t.getNonStdFontMap=o;const a=(0,n.getLookupTableFactory)((function(e){e["Adobe Jenson"]=!0,e["Adobe Text"]=!0,e.Albertus=!0,e.Aldus=!0,e.Alexandria=!0,e.Algerian=!0,e["American Typewriter"]=!0,e.Antiqua=!0,e.Apex=!0,e.Arno=!0,e.Aster=!0,e.Aurora=!0,e.Baskerville=!0,e.Bell=!0,e.Bembo=!0,e["Bembo Schoolbook"]=!0,e.Benguiat=!0,e["Berkeley Old Style"]=!0,e["Bernhard Modern"]=!0,e["Berthold City"]=!0,e.Bodoni=!0,e["Bauer Bodoni"]=!0,e["Book Antiqua"]=!0,e.Bookman=!0,e["Bordeaux Roman"]=!0,e["Californian FB"]=!0,e.Calisto=!0,e.Calvert=!0,e.Capitals=!0,e.Cambria=!0,e.Cartier=!0,e.Caslon=!0,e.Catull=!0,e.Centaur=!0,e["Century Old Style"]=!0,e["Century Schoolbook"]=!0,e.Chaparral=!0,e["Charis SIL"]=!0,e.Cheltenham=!0,e["Cholla Slab"]=!0,e.Clarendon=!0,e.Clearface=!0,e.Cochin=!0,e.Colonna=!0,e["Computer Modern"]=!0,e["Concrete Roman"]=!0,e.Constantia=!0,e["Cooper Black"]=!0,e.Corona=!0,e.Ecotype=!0,e.Egyptienne=!0,e.Elephant=!0,e.Excelsior=!0,e.Fairfield=!0,e["FF Scala"]=!0,e.Folkard=!0,e.Footlight=!0,e.FreeSerif=!0,e["Friz Quadrata"]=!0,e.Garamond=!0,e.Gentium=!0,e.Georgia=!0,e.Gloucester=!0,e["Goudy Old Style"]=!0,e["Goudy Schoolbook"]=!0,e["Goudy Pro Font"]=!0,e.Granjon=!0,e["Guardian Egyptian"]=!0,e.Heather=!0,e.Hercules=!0,e["High Tower Text"]=!0,e.Hiroshige=!0,e["Hoefler Text"]=!0,e["Humana Serif"]=!0,e.Imprint=!0,e["Ionic No. 5"]=!0,e.Janson=!0,e.Joanna=!0,e.Korinna=!0,e.Lexicon=!0,e["Liberation Serif"]=!0,e["Linux Libertine"]=!0,e.Literaturnaya=!0,e.Lucida=!0,e["Lucida Bright"]=!0,e.Melior=!0,e.Memphis=!0,e.Miller=!0,e.Minion=!0,e.Modern=!0,e["Mona Lisa"]=!0,e["Mrs Eaves"]=!0,e["MS Serif"]=!0,e["Museo Slab"]=!0,e["New York"]=!0,e["Nimbus Roman"]=!0,e["NPS Rawlinson Roadway"]=!0,e.NuptialScript=!0,e.Palatino=!0,e.Perpetua=!0,e.Plantin=!0,e["Plantin Schoolbook"]=!0,e.Playbill=!0,e["Poor Richard"]=!0,e["Rawlinson Roadway"]=!0,e.Renault=!0,e.Requiem=!0,e.Rockwell=!0,e.Roman=!0,e["Rotis Serif"]=!0,e.Sabon=!0,e.Scala=!0,e.Seagull=!0,e.Sistina=!0,e.Souvenir=!0,e.STIX=!0,e["Stone Informal"]=!0,e["Stone Serif"]=!0,e.Sylfaen=!0,e.Times=!0,e.Trajan=!0,e["Trinit\xe9"]=!0,e["Trump Mediaeval"]=!0,e.Utopia=!0,e["Vale Type"]=!0,e["Bitstream Vera"]=!0,e["Vera Serif"]=!0,e.Versailles=!0,e.Wanted=!0,e.Weiss=!0,e["Wide Latin"]=!0,e.Windsor=!0,e.XITS=!0}));t.getSerifFonts=a;const s=(0,n.getLookupTableFactory)((function(e){e.Dingbats=!0,e.Symbol=!0,e.ZapfDingbats=!0}));t.getSymbolsFonts=s;const l=(0,n.getLookupTableFactory)((function(e){e[2]=10,e[3]=32,e[4]=33,e[5]=34,e[6]=35,e[7]=36,e[8]=37,e[9]=38,e[10]=39,e[11]=40,e[12]=41,e[13]=42,e[14]=43,e[15]=44,e[16]=45,e[17]=46,e[18]=47,e[19]=48,e[20]=49,e[21]=50,e[22]=51,e[23]=52,e[24]=53,e[25]=54,e[26]=55,e[27]=56,e[28]=57,e[29]=58,e[30]=894,e[31]=60,e[32]=61,e[33]=62,e[34]=63,e[35]=64,e[36]=65,e[37]=66,e[38]=67,e[39]=68,e[40]=69,e[41]=70,e[42]=71,e[43]=72,e[44]=73,e[45]=74,e[46]=75,e[47]=76,e[48]=77,e[49]=78,e[50]=79,e[51]=80,e[52]=81,e[53]=82,e[54]=83,e[55]=84,e[56]=85,e[57]=86,e[58]=87,e[59]=88,e[60]=89,e[61]=90,e[62]=91,e[63]=92,e[64]=93,e[65]=94,e[66]=95,e[67]=96,e[68]=97,e[69]=98,e[70]=99,e[71]=100,e[72]=101,e[73]=102,e[74]=103,e[75]=104,e[76]=105,e[77]=106,e[78]=107,e[79]=108,e[80]=109,e[81]=110,e[82]=111,e[83]=112,e[84]=113,e[85]=114,e[86]=115,e[87]=116,e[88]=117,e[89]=118,e[90]=119,e[91]=120,e[92]=121,e[93]=122,e[94]=123,e[95]=124,e[96]=125,e[97]=126,e[98]=196,e[99]=197,e[100]=199,e[101]=201,e[102]=209,e[103]=214,e[104]=220,e[105]=225,e[106]=224,e[107]=226,e[108]=228,e[109]=227,e[110]=229,e[111]=231,e[112]=233,e[113]=232,e[114]=234,e[115]=235,e[116]=237,e[117]=236,e[118]=238,e[119]=239,e[120]=241,e[121]=243,e[122]=242,e[123]=244,e[124]=246,e[125]=245,e[126]=250,e[127]=249,e[128]=251,e[129]=252,e[130]=8224,e[131]=176,e[132]=162,e[133]=163,e[134]=167,e[135]=8226,e[136]=182,e[137]=223,e[138]=174,e[139]=169,e[140]=8482,e[141]=180,e[142]=168,e[143]=8800,e[144]=198,e[145]=216,e[146]=8734,e[147]=177,e[148]=8804,e[149]=8805,e[150]=165,e[151]=181,e[152]=8706,e[153]=8721,e[154]=8719,e[156]=8747,e[157]=170,e[158]=186,e[159]=8486,e[160]=230,e[161]=248,e[162]=191,e[163]=161,e[164]=172,e[165]=8730,e[166]=402,e[167]=8776,e[168]=8710,e[169]=171,e[170]=187,e[171]=8230,e[210]=218,e[223]=711,e[224]=321,e[225]=322,e[227]=353,e[229]=382,e[234]=253,e[252]=263,e[253]=268,e[254]=269,e[258]=258,e[260]=260,e[261]=261,e[265]=280,e[266]=281,e[268]=283,e[269]=313,e[275]=323,e[276]=324,e[278]=328,e[284]=345,e[285]=346,e[286]=347,e[292]=367,e[295]=377,e[296]=378,e[298]=380,e[305]=963,e[306]=964,e[307]=966,e[308]=8215,e[309]=8252,e[310]=8319,e[311]=8359,e[312]=8592,e[313]=8593,e[337]=9552,e[493]=1039,e[494]=1040,e[705]=1524,e[706]=8362,e[710]=64288,e[711]=64298,e[759]=1617,e[761]=1776,e[763]=1778,e[775]=1652,e[777]=1764,e[778]=1780,e[779]=1781,e[780]=1782,e[782]=771,e[783]=64726,e[786]=8363,e[788]=8532,e[790]=768,e[791]=769,e[792]=768,e[795]=803,e[797]=64336,e[798]=64337,e[799]=64342,e[800]=64343,e[801]=64344,e[802]=64345,e[803]=64362,e[804]=64363,e[805]=64364,e[2424]=7821,e[2425]=7822,e[2426]=7823,e[2427]=7824,e[2428]=7825,e[2429]=7826,e[2430]=7827,e[2433]=7682,e[2678]=8045,e[2679]=8046,e[2830]=1552,e[2838]=686,e[2840]=751,e[2842]=753,e[2843]=754,e[2844]=755,e[2846]=757,e[2856]=767,e[2857]=848,e[2858]=849,e[2862]=853,e[2863]=854,e[2864]=855,e[2865]=861,e[2866]=862,e[2906]=7460,e[2908]=7462,e[2909]=7463,e[2910]=7464,e[2912]=7466,e[2913]=7467,e[2914]=7468,e[2916]=7470,e[2917]=7471,e[2918]=7472,e[2920]=7474,e[2921]=7475,e[2922]=7476,e[2924]=7478,e[2925]=7479,e[2926]=7480,e[2928]=7482,e[2929]=7483,e[2930]=7484,e[2932]=7486,e[2933]=7487,e[2934]=7488,e[2936]=7490,e[2937]=7491,e[2938]=7492,e[2940]=7494,e[2941]=7495,e[2942]=7496,e[2944]=7498,e[2946]=7500,e[2948]=7502,e[2950]=7504,e[2951]=7505,e[2952]=7506,e[2954]=7508,e[2955]=7509,e[2956]=7510,e[2958]=7512,e[2959]=7513,e[2960]=7514,e[2962]=7516,e[2963]=7517,e[2964]=7518,e[2966]=7520,e[2967]=7521,e[2968]=7522,e[2970]=7524,e[2971]=7525,e[2972]=7526,e[2974]=7528,e[2975]=7529,e[2976]=7530,e[2978]=1537,e[2979]=1538,e[2980]=1539,e[2982]=1549,e[2983]=1551,e[2984]=1552,e[2986]=1554,e[2987]=1555,e[2988]=1556,e[2990]=1623,e[2991]=1624,e[2995]=1775,e[2999]=1791,e[3002]=64290,e[3003]=64291,e[3004]=64292,e[3006]=64294,e[3007]=64295,e[3008]=64296,e[3011]=1900,e[3014]=8223,e[3015]=8244,e[3017]=7532,e[3018]=7533,e[3019]=7534,e[3075]=7590,e[3076]=7591,e[3079]=7594,e[3080]=7595,e[3083]=7598,e[3084]=7599,e[3087]=7602,e[3088]=7603,e[3091]=7606,e[3092]=7607,e[3095]=7610,e[3096]=7611,e[3099]=7614,e[3100]=7615,e[3103]=7618,e[3104]=7619,e[3107]=8337,e[3108]=8338,e[3116]=1884,e[3119]=1885,e[3120]=1885,e[3123]=1886,e[3124]=1886,e[3127]=1887,e[3128]=1887,e[3131]=1888,e[3132]=1888,e[3135]=1889,e[3136]=1889,e[3139]=1890,e[3140]=1890,e[3143]=1891,e[3144]=1891,e[3147]=1892,e[3148]=1892,e[3153]=580,e[3154]=581,e[3157]=584,e[3158]=585,e[3161]=588,e[3162]=589,e[3165]=891,e[3166]=892,e[3169]=1274,e[3170]=1275,e[3173]=1278,e[3174]=1279,e[3181]=7622,e[3182]=7623,e[3282]=11799,e[3316]=578,e[3379]=42785,e[3393]=1159,e[3416]=8377}));t.getGlyphMapForStandardFonts=l;const c=(0,n.getLookupTableFactory)((function(e){e[227]=322,e[264]=261,e[291]=346}));t.getSupplementalGlyphMapForArialBlack=c;const u=(0,n.getLookupTableFactory)((function(e){e[1]=32,e[4]=65,e[17]=66,e[18]=67,e[24]=68,e[28]=69,e[38]=70,e[39]=71,e[44]=72,e[47]=73,e[58]=74,e[60]=75,e[62]=76,e[68]=77,e[69]=78,e[75]=79,e[87]=80,e[89]=81,e[90]=82,e[94]=83,e[100]=84,e[104]=85,e[115]=86,e[116]=87,e[121]=88,e[122]=89,e[127]=90,e[258]=97,e[268]=261,e[271]=98,e[272]=99,e[273]=263,e[282]=100,e[286]=101,e[295]=281,e[296]=102,e[336]=103,e[346]=104,e[349]=105,e[361]=106,e[364]=107,e[367]=108,e[371]=322,e[373]=109,e[374]=110,e[381]=111,e[383]=243,e[393]=112,e[395]=113,e[396]=114,e[400]=115,e[401]=347,e[410]=116,e[437]=117,e[448]=118,e[449]=119,e[454]=120,e[455]=121,e[460]=122,e[463]=380,e[853]=44,e[855]=58,e[856]=46,e[876]=47,e[878]=45,e[882]=45,e[894]=40,e[895]=41,e[896]=91,e[897]=93,e[923]=64,e[1004]=48,e[1005]=49,e[1006]=50,e[1007]=51,e[1008]=52,e[1009]=53,e[1010]=54,e[1011]=55,e[1012]=56,e[1013]=57,e[1081]=37,e[1085]=43,e[1086]=45}));t.getSupplementalGlyphMapForCalibri=u},function(e,t,r){var n=r(8).getLookupTableFactory,i=n((function(e){e[63721]=169,e[63193]=169,e[63720]=174,e[63194]=174,e[63722]=8482,e[63195]=8482,e[63729]=9127,e[63730]=9128,e[63731]=9129,e[63740]=9131,e[63741]=9132,e[63742]=9133,e[63726]=9121,e[63727]=9122,e[63728]=9123,e[63737]=9124,e[63738]=9125,e[63739]=9126,e[63723]=9115,e[63724]=9116,e[63725]=9117,e[63734]=9118,e[63735]=9119,e[63736]=9120})),o=[{begin:0,end:127},{begin:128,end:255},{begin:256,end:383},{begin:384,end:591},{begin:592,end:687},{begin:688,end:767},{begin:768,end:879},{begin:880,end:1023},{begin:11392,end:11519},{begin:1024,end:1279},{begin:1328,end:1423},{begin:1424,end:1535},{begin:42240,end:42559},{begin:1536,end:1791},{begin:1984,end:2047},{begin:2304,end:2431},{begin:2432,end:2559},{begin:2560,end:2687},{begin:2688,end:2815},{begin:2816,end:2943},{begin:2944,end:3071},{begin:3072,end:3199},{begin:3200,end:3327},{begin:3328,end:3455},{begin:3584,end:3711},{begin:3712,end:3839},{begin:4256,end:4351},{begin:6912,end:7039},{begin:4352,end:4607},{begin:7680,end:7935},{begin:7936,end:8191},{begin:8192,end:8303},{begin:8304,end:8351},{begin:8352,end:8399},{begin:8400,end:8447},{begin:8448,end:8527},{begin:8528,end:8591},{begin:8592,end:8703},{begin:8704,end:8959},{begin:8960,end:9215},{begin:9216,end:9279},{begin:9280,end:9311},{begin:9312,end:9471},{begin:9472,end:9599},{begin:9600,end:9631},{begin:9632,end:9727},{begin:9728,end:9983},{begin:9984,end:10175},{begin:12288,end:12351},{begin:12352,end:12447},{begin:12448,end:12543},{begin:12544,end:12591},{begin:12592,end:12687},{begin:43072,end:43135},{begin:12800,end:13055},{begin:13056,end:13311},{begin:44032,end:55215},{begin:55296,end:57343},{begin:67840,end:67871},{begin:19968,end:40959},{begin:57344,end:63743},{begin:12736,end:12783},{begin:64256,end:64335},{begin:64336,end:65023},{begin:65056,end:65071},{begin:65040,end:65055},{begin:65104,end:65135},{begin:65136,end:65279},{begin:65280,end:65519},{begin:65520,end:65535},{begin:3840,end:4095},{begin:1792,end:1871},{begin:1920,end:1983},{begin:3456,end:3583},{begin:4096,end:4255},{begin:4608,end:4991},{begin:5024,end:5119},{begin:5120,end:5759},{begin:5760,end:5791},{begin:5792,end:5887},{begin:6016,end:6143},{begin:6144,end:6319},{begin:10240,end:10495},{begin:40960,end:42127},{begin:5888,end:5919},{begin:66304,end:66351},{begin:66352,end:66383},{begin:66560,end:66639},{begin:118784,end:119039},{begin:119808,end:120831},{begin:1044480,end:1048573},{begin:65024,end:65039},{begin:917504,end:917631},{begin:6400,end:6479},{begin:6480,end:6527},{begin:6528,end:6623},{begin:6656,end:6687},{begin:11264,end:11359},{begin:11568,end:11647},{begin:19904,end:19967},{begin:43008,end:43055},{begin:65536,end:65663},{begin:65856,end:65935},{begin:66432,end:66463},{begin:66464,end:66527},{begin:66640,end:66687},{begin:66688,end:66735},{begin:67584,end:67647},{begin:68096,end:68191},{begin:119552,end:119647},{begin:73728,end:74751},{begin:119648,end:119679},{begin:7040,end:7103},{begin:7168,end:7247},{begin:7248,end:7295},{begin:43136,end:43231},{begin:43264,end:43311},{begin:43312,end:43359},{begin:43520,end:43615},{begin:65936,end:65999},{begin:66e3,end:66047},{begin:66208,end:66271},{begin:127024,end:127135}],a=n((function(e){e["\xa8"]=" \u0308",e["\xaf"]=" \u0304",e["\xb4"]=" \u0301",e["\xb5"]="\u03bc",e["\xb8"]=" \u0327",e["\u0132"]="IJ",e["\u0133"]="ij",e["\u013f"]="L\xb7",e["\u0140"]="l\xb7",e["\u0149"]="\u02bcn",e["\u017f"]="s",e["\u01c4"]="D\u017d",e["\u01c5"]="D\u017e",e["\u01c6"]="d\u017e",e["\u01c7"]="LJ",e["\u01c8"]="Lj",e["\u01c9"]="lj",e["\u01ca"]="NJ",e["\u01cb"]="Nj",e["\u01cc"]="nj",e["\u01f1"]="DZ",e["\u01f2"]="Dz",e["\u01f3"]="dz",e["\u02d8"]=" \u0306",e["\u02d9"]=" \u0307",e["\u02da"]=" \u030a",e["\u02db"]=" \u0328",e["\u02dc"]=" \u0303",e["\u02dd"]=" \u030b",e["\u037a"]=" \u0345",e["\u0384"]=" \u0301",e["\u03d0"]="\u03b2",e["\u03d1"]="\u03b8",e["\u03d2"]="\u03a5",e["\u03d5"]="\u03c6",e["\u03d6"]="\u03c0",e["\u03f0"]="\u03ba",e["\u03f1"]="\u03c1",e["\u03f2"]="\u03c2",e["\u03f4"]="\u0398",e["\u03f5"]="\u03b5",e["\u03f9"]="\u03a3",e["\u0587"]="\u0565\u0582",e["\u0675"]="\u0627\u0674",e["\u0676"]="\u0648\u0674",e["\u0677"]="\u06c7\u0674",e["\u0678"]="\u064a\u0674",e["\u0e33"]="\u0e4d\u0e32",e["\u0eb3"]="\u0ecd\u0eb2",e["\u0edc"]="\u0eab\u0e99",e["\u0edd"]="\u0eab\u0ea1",e["\u0f77"]="\u0fb2\u0f81",e["\u0f79"]="\u0fb3\u0f81",e["\u1e9a"]="a\u02be",e["\u1fbd"]=" \u0313",e["\u1fbf"]=" \u0313",e["\u1fc0"]=" \u0342",e["\u1ffe"]=" \u0314",e["\u2002"]=" ",e["\u2003"]=" ",e["\u2004"]=" ",e["\u2005"]=" ",e["\u2006"]=" ",e["\u2008"]=" ",e["\u2009"]=" ",e["\u200a"]=" ",e["\u2017"]=" \u0333",e["\u2024"]=".",e["\u2025"]="..",e["\u2026"]="...",e["\u2033"]="\u2032\u2032",e["\u2034"]="\u2032\u2032\u2032",e["\u2036"]="\u2035\u2035",e["\u2037"]="\u2035\u2035\u2035",e["\u203c"]="!!",e["\u203e"]=" \u0305",e["\u2047"]="??",e["\u2048"]="?!",e["\u2049"]="!?",e["\u2057"]="\u2032\u2032\u2032\u2032",e["\u205f"]=" ",e["\u20a8"]="Rs",e["\u2100"]="a/c",e["\u2101"]="a/s",e["\u2103"]="\xb0C",e["\u2105"]="c/o",e["\u2106"]="c/u",e["\u2107"]="\u0190",e["\u2109"]="\xb0F",e["\u2116"]="No",e["\u2121"]="TEL",e["\u2135"]="\u05d0",e["\u2136"]="\u05d1",e["\u2137"]="\u05d2",e["\u2138"]="\u05d3",e["\u213b"]="FAX",e["\u2160"]="I",e["\u2161"]="II",e["\u2162"]="III",e["\u2163"]="IV",e["\u2164"]="V",e["\u2165"]="VI",e["\u2166"]="VII",e["\u2167"]="VIII",e["\u2168"]="IX",e["\u2169"]="X",e["\u216a"]="XI",e["\u216b"]="XII",e["\u216c"]="L",e["\u216d"]="C",e["\u216e"]="D",e["\u216f"]="M",e["\u2170"]="i",e["\u2171"]="ii",e["\u2172"]="iii",e["\u2173"]="iv",e["\u2174"]="v",e["\u2175"]="vi",e["\u2176"]="vii",e["\u2177"]="viii",e["\u2178"]="ix",e["\u2179"]="x",e["\u217a"]="xi",e["\u217b"]="xii",e["\u217c"]="l",e["\u217d"]="c",e["\u217e"]="d",e["\u217f"]="m",e["\u222c"]="\u222b\u222b",e["\u222d"]="\u222b\u222b\u222b",e["\u222f"]="\u222e\u222e",e["\u2230"]="\u222e\u222e\u222e",e["\u2474"]="(1)",e["\u2475"]="(2)",e["\u2476"]="(3)",e["\u2477"]="(4)",e["\u2478"]="(5)",e["\u2479"]="(6)",e["\u247a"]="(7)",e["\u247b"]="(8)",e["\u247c"]="(9)",e["\u247d"]="(10)",e["\u247e"]="(11)",e["\u247f"]="(12)",e["\u2480"]="(13)",e["\u2481"]="(14)",e["\u2482"]="(15)",e["\u2483"]="(16)",e["\u2484"]="(17)",e["\u2485"]="(18)",e["\u2486"]="(19)",e["\u2487"]="(20)",e["\u2488"]="1.",e["\u2489"]="2.",e["\u248a"]="3.",e["\u248b"]="4.",e["\u248c"]="5.",e["\u248d"]="6.",e["\u248e"]="7.",e["\u248f"]="8.",e["\u2490"]="9.",e["\u2491"]="10.",e["\u2492"]="11.",e["\u2493"]="12.",e["\u2494"]="13.",e["\u2495"]="14.",e["\u2496"]="15.",e["\u2497"]="16.",e["\u2498"]="17.",e["\u2499"]="18.",e["\u249a"]="19.",e["\u249b"]="20.",e["\u249c"]="(a)",e["\u249d"]="(b)",e["\u249e"]="(c)",e["\u249f"]="(d)",e["\u24a0"]="(e)",e["\u24a1"]="(f)",e["\u24a2"]="(g)",e["\u24a3"]="(h)",e["\u24a4"]="(i)",e["\u24a5"]="(j)",e["\u24a6"]="(k)",e["\u24a7"]="(l)",e["\u24a8"]="(m)",e["\u24a9"]="(n)",e["\u24aa"]="(o)",e["\u24ab"]="(p)",e["\u24ac"]="(q)",e["\u24ad"]="(r)",e["\u24ae"]="(s)",e["\u24af"]="(t)",e["\u24b0"]="(u)",e["\u24b1"]="(v)",e["\u24b2"]="(w)",e["\u24b3"]="(x)",e["\u24b4"]="(y)",e["\u24b5"]="(z)",e["\u2a0c"]="\u222b\u222b\u222b\u222b",e["\u2a74"]="::=",e["\u2a75"]="==",e["\u2a76"]="===",e["\u2e9f"]="\u6bcd",e["\u2ef3"]="\u9f9f",e["\u2f00"]="\u4e00",e["\u2f01"]="\u4e28",e["\u2f02"]="\u4e36",e["\u2f03"]="\u4e3f",e["\u2f04"]="\u4e59",e["\u2f05"]="\u4e85",e["\u2f06"]="\u4e8c",e["\u2f07"]="\u4ea0",e["\u2f08"]="\u4eba",e["\u2f09"]="\u513f",e["\u2f0a"]="\u5165",e["\u2f0b"]="\u516b",e["\u2f0c"]="\u5182",e["\u2f0d"]="\u5196",e["\u2f0e"]="\u51ab",e["\u2f0f"]="\u51e0",e["\u2f10"]="\u51f5",e["\u2f11"]="\u5200",e["\u2f12"]="\u529b",e["\u2f13"]="\u52f9",e["\u2f14"]="\u5315",e["\u2f15"]="\u531a",e["\u2f16"]="\u5338",e["\u2f17"]="\u5341",e["\u2f18"]="\u535c",e["\u2f19"]="\u5369",e["\u2f1a"]="\u5382",e["\u2f1b"]="\u53b6",e["\u2f1c"]="\u53c8",e["\u2f1d"]="\u53e3",e["\u2f1e"]="\u56d7",e["\u2f1f"]="\u571f",e["\u2f20"]="\u58eb",e["\u2f21"]="\u5902",e["\u2f22"]="\u590a",e["\u2f23"]="\u5915",e["\u2f24"]="\u5927",e["\u2f25"]="\u5973",e["\u2f26"]="\u5b50",e["\u2f27"]="\u5b80",e["\u2f28"]="\u5bf8",e["\u2f29"]="\u5c0f",e["\u2f2a"]="\u5c22",e["\u2f2b"]="\u5c38",e["\u2f2c"]="\u5c6e",e["\u2f2d"]="\u5c71",e["\u2f2e"]="\u5ddb",e["\u2f2f"]="\u5de5",e["\u2f30"]="\u5df1",e["\u2f31"]="\u5dfe",e["\u2f32"]="\u5e72",e["\u2f33"]="\u5e7a",e["\u2f34"]="\u5e7f",e["\u2f35"]="\u5ef4",e["\u2f36"]="\u5efe",e["\u2f37"]="\u5f0b",e["\u2f38"]="\u5f13",e["\u2f39"]="\u5f50",e["\u2f3a"]="\u5f61",e["\u2f3b"]="\u5f73",e["\u2f3c"]="\u5fc3",e["\u2f3d"]="\u6208",e["\u2f3e"]="\u6236",e["\u2f3f"]="\u624b",e["\u2f40"]="\u652f",e["\u2f41"]="\u6534",e["\u2f42"]="\u6587",e["\u2f43"]="\u6597",e["\u2f44"]="\u65a4",e["\u2f45"]="\u65b9",e["\u2f46"]="\u65e0",e["\u2f47"]="\u65e5",e["\u2f48"]="\u66f0",e["\u2f49"]="\u6708",e["\u2f4a"]="\u6728",e["\u2f4b"]="\u6b20",e["\u2f4c"]="\u6b62",e["\u2f4d"]="\u6b79",e["\u2f4e"]="\u6bb3",e["\u2f4f"]="\u6bcb",e["\u2f50"]="\u6bd4",e["\u2f51"]="\u6bdb",e["\u2f52"]="\u6c0f",e["\u2f53"]="\u6c14",e["\u2f54"]="\u6c34",e["\u2f55"]="\u706b",e["\u2f56"]="\u722a",e["\u2f57"]="\u7236",e["\u2f58"]="\u723b",e["\u2f59"]="\u723f",e["\u2f5a"]="\u7247",e["\u2f5b"]="\u7259",e["\u2f5c"]="\u725b",e["\u2f5d"]="\u72ac",e["\u2f5e"]="\u7384",e["\u2f5f"]="\u7389",e["\u2f60"]="\u74dc",e["\u2f61"]="\u74e6",e["\u2f62"]="\u7518",e["\u2f63"]="\u751f",e["\u2f64"]="\u7528",e["\u2f65"]="\u7530",e["\u2f66"]="\u758b",e["\u2f67"]="\u7592",e["\u2f68"]="\u7676",e["\u2f69"]="\u767d",e["\u2f6a"]="\u76ae",e["\u2f6b"]="\u76bf",e["\u2f6c"]="\u76ee",e["\u2f6d"]="\u77db",e["\u2f6e"]="\u77e2",e["\u2f6f"]="\u77f3",e["\u2f70"]="\u793a",e["\u2f71"]="\u79b8",e["\u2f72"]="\u79be",e["\u2f73"]="\u7a74",e["\u2f74"]="\u7acb",e["\u2f75"]="\u7af9",e["\u2f76"]="\u7c73",e["\u2f77"]="\u7cf8",e["\u2f78"]="\u7f36",e["\u2f79"]="\u7f51",e["\u2f7a"]="\u7f8a",e["\u2f7b"]="\u7fbd",e["\u2f7c"]="\u8001",e["\u2f7d"]="\u800c",e["\u2f7e"]="\u8012",e["\u2f7f"]="\u8033",e["\u2f80"]="\u807f",e["\u2f81"]="\u8089",e["\u2f82"]="\u81e3",e["\u2f83"]="\u81ea",e["\u2f84"]="\u81f3",e["\u2f85"]="\u81fc",e["\u2f86"]="\u820c",e["\u2f87"]="\u821b",e["\u2f88"]="\u821f",e["\u2f89"]="\u826e",e["\u2f8a"]="\u8272",e["\u2f8b"]="\u8278",e["\u2f8c"]="\u864d",e["\u2f8d"]="\u866b",e["\u2f8e"]="\u8840",e["\u2f8f"]="\u884c",e["\u2f90"]="\u8863",e["\u2f91"]="\u897e",e["\u2f92"]="\u898b",e["\u2f93"]="\u89d2",e["\u2f94"]="\u8a00",e["\u2f95"]="\u8c37",e["\u2f96"]="\u8c46",e["\u2f97"]="\u8c55",e["\u2f98"]="\u8c78",e["\u2f99"]="\u8c9d",e["\u2f9a"]="\u8d64",e["\u2f9b"]="\u8d70",e["\u2f9c"]="\u8db3",e["\u2f9d"]="\u8eab",e["\u2f9e"]="\u8eca",e["\u2f9f"]="\u8f9b",e["\u2fa0"]="\u8fb0",e["\u2fa1"]="\u8fb5",e["\u2fa2"]="\u9091",e["\u2fa3"]="\u9149",e["\u2fa4"]="\u91c6",e["\u2fa5"]="\u91cc",e["\u2fa6"]="\u91d1",e["\u2fa7"]="\u9577",e["\u2fa8"]="\u9580",e["\u2fa9"]="\u961c",e["\u2faa"]="\u96b6",e["\u2fab"]="\u96b9",e["\u2fac"]="\u96e8",e["\u2fad"]="\u9751",e["\u2fae"]="\u975e",e["\u2faf"]="\u9762",e["\u2fb0"]="\u9769",e["\u2fb1"]="\u97cb",e["\u2fb2"]="\u97ed",e["\u2fb3"]="\u97f3",e["\u2fb4"]="\u9801",e["\u2fb5"]="\u98a8",e["\u2fb6"]="\u98db",e["\u2fb7"]="\u98df",e["\u2fb8"]="\u9996",e["\u2fb9"]="\u9999",e["\u2fba"]="\u99ac",e["\u2fbb"]="\u9aa8",e["\u2fbc"]="\u9ad8",e["\u2fbd"]="\u9adf",e["\u2fbe"]="\u9b25",e["\u2fbf"]="\u9b2f",e["\u2fc0"]="\u9b32",e["\u2fc1"]="\u9b3c",e["\u2fc2"]="\u9b5a",e["\u2fc3"]="\u9ce5",e["\u2fc4"]="\u9e75",e["\u2fc5"]="\u9e7f",e["\u2fc6"]="\u9ea5",e["\u2fc7"]="\u9ebb",e["\u2fc8"]="\u9ec3",e["\u2fc9"]="\u9ecd",e["\u2fca"]="\u9ed1",e["\u2fcb"]="\u9ef9",e["\u2fcc"]="\u9efd",e["\u2fcd"]="\u9f0e",e["\u2fce"]="\u9f13",e["\u2fcf"]="\u9f20",e["\u2fd0"]="\u9f3b",e["\u2fd1"]="\u9f4a",e["\u2fd2"]="\u9f52",e["\u2fd3"]="\u9f8d",e["\u2fd4"]="\u9f9c",e["\u2fd5"]="\u9fa0",e["\u3036"]="\u3012",e["\u3038"]="\u5341",e["\u3039"]="\u5344",e["\u303a"]="\u5345",e["\u309b"]=" \u3099",e["\u309c"]=" \u309a",e["\u3131"]="\u1100",e["\u3132"]="\u1101",e["\u3133"]="\u11aa",e["\u3134"]="\u1102",e["\u3135"]="\u11ac",e["\u3136"]="\u11ad",e["\u3137"]="\u1103",e["\u3138"]="\u1104",e["\u3139"]="\u1105",e["\u313a"]="\u11b0",e["\u313b"]="\u11b1",e["\u313c"]="\u11b2",e["\u313d"]="\u11b3",e["\u313e"]="\u11b4",e["\u313f"]="\u11b5",e["\u3140"]="\u111a",e["\u3141"]="\u1106",e["\u3142"]="\u1107",e["\u3143"]="\u1108",e["\u3144"]="\u1121",e["\u3145"]="\u1109",e["\u3146"]="\u110a",e["\u3147"]="\u110b",e["\u3148"]="\u110c",e["\u3149"]="\u110d",e["\u314a"]="\u110e",e["\u314b"]="\u110f",e["\u314c"]="\u1110",e["\u314d"]="\u1111",e["\u314e"]="\u1112",e["\u314f"]="\u1161",e["\u3150"]="\u1162",e["\u3151"]="\u1163",e["\u3152"]="\u1164",e["\u3153"]="\u1165",e["\u3154"]="\u1166",e["\u3155"]="\u1167",e["\u3156"]="\u1168",e["\u3157"]="\u1169",e["\u3158"]="\u116a",e["\u3159"]="\u116b",e["\u315a"]="\u116c",e["\u315b"]="\u116d",e["\u315c"]="\u116e",e["\u315d"]="\u116f",e["\u315e"]="\u1170",e["\u315f"]="\u1171",e["\u3160"]="\u1172",e["\u3161"]="\u1173",e["\u3162"]="\u1174",e["\u3163"]="\u1175",e["\u3164"]="\u1160",e["\u3165"]="\u1114",e["\u3166"]="\u1115",e["\u3167"]="\u11c7",e["\u3168"]="\u11c8",e["\u3169"]="\u11cc",e["\u316a"]="\u11ce",e["\u316b"]="\u11d3",e["\u316c"]="\u11d7",e["\u316d"]="\u11d9",e["\u316e"]="\u111c",e["\u316f"]="\u11dd",e["\u3170"]="\u11df",e["\u3171"]="\u111d",e["\u3172"]="\u111e",e["\u3173"]="\u1120",e["\u3174"]="\u1122",e["\u3175"]="\u1123",e["\u3176"]="\u1127",e["\u3177"]="\u1129",e["\u3178"]="\u112b",e["\u3179"]="\u112c",e["\u317a"]="\u112d",e["\u317b"]="\u112e",e["\u317c"]="\u112f",e["\u317d"]="\u1132",e["\u317e"]="\u1136",e["\u317f"]="\u1140",e["\u3180"]="\u1147",e["\u3181"]="\u114c",e["\u3182"]="\u11f1",e["\u3183"]="\u11f2",e["\u3184"]="\u1157",e["\u3185"]="\u1158",e["\u3186"]="\u1159",e["\u3187"]="\u1184",e["\u3188"]="\u1185",e["\u3189"]="\u1188",e["\u318a"]="\u1191",e["\u318b"]="\u1192",e["\u318c"]="\u1194",e["\u318d"]="\u119e",e["\u318e"]="\u11a1",e["\u3200"]="(\u1100)",e["\u3201"]="(\u1102)",e["\u3202"]="(\u1103)",e["\u3203"]="(\u1105)",e["\u3204"]="(\u1106)",e["\u3205"]="(\u1107)",e["\u3206"]="(\u1109)",e["\u3207"]="(\u110b)",e["\u3208"]="(\u110c)",e["\u3209"]="(\u110e)",e["\u320a"]="(\u110f)",e["\u320b"]="(\u1110)",e["\u320c"]="(\u1111)",e["\u320d"]="(\u1112)",e["\u320e"]="(\u1100\u1161)",e["\u320f"]="(\u1102\u1161)",e["\u3210"]="(\u1103\u1161)",e["\u3211"]="(\u1105\u1161)",e["\u3212"]="(\u1106\u1161)",e["\u3213"]="(\u1107\u1161)",e["\u3214"]="(\u1109\u1161)",e["\u3215"]="(\u110b\u1161)",e["\u3216"]="(\u110c\u1161)",e["\u3217"]="(\u110e\u1161)",e["\u3218"]="(\u110f\u1161)",e["\u3219"]="(\u1110\u1161)",e["\u321a"]="(\u1111\u1161)",e["\u321b"]="(\u1112\u1161)",e["\u321c"]="(\u110c\u116e)",e["\u321d"]="(\u110b\u1169\u110c\u1165\u11ab)",e["\u321e"]="(\u110b\u1169\u1112\u116e)",e["\u3220"]="(\u4e00)",e["\u3221"]="(\u4e8c)",e["\u3222"]="(\u4e09)",e["\u3223"]="(\u56db)",e["\u3224"]="(\u4e94)",e["\u3225"]="(\u516d)",e["\u3226"]="(\u4e03)",e["\u3227"]="(\u516b)",e["\u3228"]="(\u4e5d)",e["\u3229"]="(\u5341)",e["\u322a"]="(\u6708)",e["\u322b"]="(\u706b)",e["\u322c"]="(\u6c34)",e["\u322d"]="(\u6728)",e["\u322e"]="(\u91d1)",e["\u322f"]="(\u571f)",e["\u3230"]="(\u65e5)",e["\u3231"]="(\u682a)",e["\u3232"]="(\u6709)",e["\u3233"]="(\u793e)",e["\u3234"]="(\u540d)",e["\u3235"]="(\u7279)",e["\u3236"]="(\u8ca1)",e["\u3237"]="(\u795d)",e["\u3238"]="(\u52b4)",e["\u3239"]="(\u4ee3)",e["\u323a"]="(\u547c)",e["\u323b"]="(\u5b66)",e["\u323c"]="(\u76e3)",e["\u323d"]="(\u4f01)",e["\u323e"]="(\u8cc7)",e["\u323f"]="(\u5354)",e["\u3240"]="(\u796d)",e["\u3241"]="(\u4f11)",e["\u3242"]="(\u81ea)",e["\u3243"]="(\u81f3)",e["\u32c0"]="1\u6708",e["\u32c1"]="2\u6708",e["\u32c2"]="3\u6708",e["\u32c3"]="4\u6708",e["\u32c4"]="5\u6708",e["\u32c5"]="6\u6708",e["\u32c6"]="7\u6708",e["\u32c7"]="8\u6708",e["\u32c8"]="9\u6708",e["\u32c9"]="10\u6708",e["\u32ca"]="11\u6708",e["\u32cb"]="12\u6708",e["\u3358"]="0\u70b9",e["\u3359"]="1\u70b9",e["\u335a"]="2\u70b9",e["\u335b"]="3\u70b9",e["\u335c"]="4\u70b9",e["\u335d"]="5\u70b9",e["\u335e"]="6\u70b9",e["\u335f"]="7\u70b9",e["\u3360"]="8\u70b9",e["\u3361"]="9\u70b9",e["\u3362"]="10\u70b9",e["\u3363"]="11\u70b9",e["\u3364"]="12\u70b9",e["\u3365"]="13\u70b9",e["\u3366"]="14\u70b9",e["\u3367"]="15\u70b9",e["\u3368"]="16\u70b9",e["\u3369"]="17\u70b9",e["\u336a"]="18\u70b9",e["\u336b"]="19\u70b9",e["\u336c"]="20\u70b9",e["\u336d"]="21\u70b9",e["\u336e"]="22\u70b9",e["\u336f"]="23\u70b9",e["\u3370"]="24\u70b9",e["\u33e0"]="1\u65e5",e["\u33e1"]="2\u65e5",e["\u33e2"]="3\u65e5",e["\u33e3"]="4\u65e5",e["\u33e4"]="5\u65e5",e["\u33e5"]="6\u65e5",e["\u33e6"]="7\u65e5",e["\u33e7"]="8\u65e5",e["\u33e8"]="9\u65e5",e["\u33e9"]="10\u65e5",e["\u33ea"]="11\u65e5",e["\u33eb"]="12\u65e5",e["\u33ec"]="13\u65e5",e["\u33ed"]="14\u65e5",e["\u33ee"]="15\u65e5",e["\u33ef"]="16\u65e5",e["\u33f0"]="17\u65e5",e["\u33f1"]="18\u65e5",e["\u33f2"]="19\u65e5",e["\u33f3"]="20\u65e5",e["\u33f4"]="21\u65e5",e["\u33f5"]="22\u65e5",e["\u33f6"]="23\u65e5",e["\u33f7"]="24\u65e5",e["\u33f8"]="25\u65e5",e["\u33f9"]="26\u65e5",e["\u33fa"]="27\u65e5",e["\u33fb"]="28\u65e5",e["\u33fc"]="29\u65e5",e["\u33fd"]="30\u65e5",e["\u33fe"]="31\u65e5",e["\ufb00"]="ff",e["\ufb01"]="fi",e["\ufb02"]="fl",e["\ufb03"]="ffi",e["\ufb04"]="ffl",e["\ufb05"]="\u017ft",e["\ufb06"]="st",e["\ufb13"]="\u0574\u0576",e["\ufb14"]="\u0574\u0565",e["\ufb15"]="\u0574\u056b",e["\ufb16"]="\u057e\u0576",e["\ufb17"]="\u0574\u056d",e["\ufb4f"]="\u05d0\u05dc",e["\ufb50"]="\u0671",e["\ufb51"]="\u0671",e["\ufb52"]="\u067b",e["\ufb53"]="\u067b",e["\ufb54"]="\u067b",e["\ufb55"]="\u067b",e["\ufb56"]="\u067e",e["\ufb57"]="\u067e",e["\ufb58"]="\u067e",e["\ufb59"]="\u067e",e["\ufb5a"]="\u0680",e["\ufb5b"]="\u0680",e["\ufb5c"]="\u0680",e["\ufb5d"]="\u0680",e["\ufb5e"]="\u067a",e["\ufb5f"]="\u067a",e["\ufb60"]="\u067a",e["\ufb61"]="\u067a",e["\ufb62"]="\u067f",e["\ufb63"]="\u067f",e["\ufb64"]="\u067f",e["\ufb65"]="\u067f",e["\ufb66"]="\u0679",e["\ufb67"]="\u0679",e["\ufb68"]="\u0679",e["\ufb69"]="\u0679",e["\ufb6a"]="\u06a4",e["\ufb6b"]="\u06a4",e["\ufb6c"]="\u06a4",e["\ufb6d"]="\u06a4",e["\ufb6e"]="\u06a6",e["\ufb6f"]="\u06a6",e["\ufb70"]="\u06a6",e["\ufb71"]="\u06a6",e["\ufb72"]="\u0684",e["\ufb73"]="\u0684",e["\ufb74"]="\u0684",e["\ufb75"]="\u0684",e["\ufb76"]="\u0683",e["\ufb77"]="\u0683",e["\ufb78"]="\u0683",e["\ufb79"]="\u0683",e["\ufb7a"]="\u0686",e["\ufb7b"]="\u0686",e["\ufb7c"]="\u0686",e["\ufb7d"]="\u0686",e["\ufb7e"]="\u0687",e["\ufb7f"]="\u0687",e["\ufb80"]="\u0687",e["\ufb81"]="\u0687",e["\ufb82"]="\u068d",e["\ufb83"]="\u068d",e["\ufb84"]="\u068c",e["\ufb85"]="\u068c",e["\ufb86"]="\u068e",e["\ufb87"]="\u068e",e["\ufb88"]="\u0688",e["\ufb89"]="\u0688",e["\ufb8a"]="\u0698",e["\ufb8b"]="\u0698",e["\ufb8c"]="\u0691",e["\ufb8d"]="\u0691",e["\ufb8e"]="\u06a9",e["\ufb8f"]="\u06a9",e["\ufb90"]="\u06a9",e["\ufb91"]="\u06a9",e["\ufb92"]="\u06af",e["\ufb93"]="\u06af",e["\ufb94"]="\u06af",e["\ufb95"]="\u06af",e["\ufb96"]="\u06b3",e["\ufb97"]="\u06b3",e["\ufb98"]="\u06b3",e["\ufb99"]="\u06b3",e["\ufb9a"]="\u06b1",e["\ufb9b"]="\u06b1",e["\ufb9c"]="\u06b1",e["\ufb9d"]="\u06b1",e["\ufb9e"]="\u06ba",e["\ufb9f"]="\u06ba",e["\ufba0"]="\u06bb",e["\ufba1"]="\u06bb",e["\ufba2"]="\u06bb",e["\ufba3"]="\u06bb",e["\ufba4"]="\u06c0",e["\ufba5"]="\u06c0",e["\ufba6"]="\u06c1",e["\ufba7"]="\u06c1",e["\ufba8"]="\u06c1",e["\ufba9"]="\u06c1",e["\ufbaa"]="\u06be",e["\ufbab"]="\u06be",e["\ufbac"]="\u06be",e["\ufbad"]="\u06be",e["\ufbae"]="\u06d2",e["\ufbaf"]="\u06d2",e["\ufbb0"]="\u06d3",e["\ufbb1"]="\u06d3",e["\ufbd3"]="\u06ad",e["\ufbd4"]="\u06ad",e["\ufbd5"]="\u06ad",e["\ufbd6"]="\u06ad",e["\ufbd7"]="\u06c7",e["\ufbd8"]="\u06c7",e["\ufbd9"]="\u06c6",e["\ufbda"]="\u06c6",e["\ufbdb"]="\u06c8",e["\ufbdc"]="\u06c8",e["\ufbdd"]="\u0677",e["\ufbde"]="\u06cb",e["\ufbdf"]="\u06cb",e["\ufbe0"]="\u06c5",e["\ufbe1"]="\u06c5",e["\ufbe2"]="\u06c9",e["\ufbe3"]="\u06c9",e["\ufbe4"]="\u06d0",e["\ufbe5"]="\u06d0",e["\ufbe6"]="\u06d0",e["\ufbe7"]="\u06d0",e["\ufbe8"]="\u0649",e["\ufbe9"]="\u0649",e["\ufbea"]="\u0626\u0627",e["\ufbeb"]="\u0626\u0627",e["\ufbec"]="\u0626\u06d5",e["\ufbed"]="\u0626\u06d5",e["\ufbee"]="\u0626\u0648",e["\ufbef"]="\u0626\u0648",e["\ufbf0"]="\u0626\u06c7",e["\ufbf1"]="\u0626\u06c7",e["\ufbf2"]="\u0626\u06c6",e["\ufbf3"]="\u0626\u06c6",e["\ufbf4"]="\u0626\u06c8",e["\ufbf5"]="\u0626\u06c8",e["\ufbf6"]="\u0626\u06d0";e["\ufbf7"]="\u0626\u06d0",e["\ufbf8"]="\u0626\u06d0",e["\ufbf9"]="\u0626\u0649",e["\ufbfa"]="\u0626\u0649",e["\ufbfb"]="\u0626\u0649",e["\ufbfc"]="\u06cc",e["\ufbfd"]="\u06cc",e["\ufbfe"]="\u06cc",e["\ufbff"]="\u06cc",e["\ufc00"]="\u0626\u062c",e["\ufc01"]="\u0626\u062d",e["\ufc02"]="\u0626\u0645",e["\ufc03"]="\u0626\u0649",e["\ufc04"]="\u0626\u064a",e["\ufc05"]="\u0628\u062c",e["\ufc06"]="\u0628\u062d",e["\ufc07"]="\u0628\u062e",e["\ufc08"]="\u0628\u0645",e["\ufc09"]="\u0628\u0649",e["\ufc0a"]="\u0628\u064a",e["\ufc0b"]="\u062a\u062c",e["\ufc0c"]="\u062a\u062d",e["\ufc0d"]="\u062a\u062e",e["\ufc0e"]="\u062a\u0645",e["\ufc0f"]="\u062a\u0649",e["\ufc10"]="\u062a\u064a",e["\ufc11"]="\u062b\u062c",e["\ufc12"]="\u062b\u0645",e["\ufc13"]="\u062b\u0649",e["\ufc14"]="\u062b\u064a",e["\ufc15"]="\u062c\u062d",e["\ufc16"]="\u062c\u0645",e["\ufc17"]="\u062d\u062c",e["\ufc18"]="\u062d\u0645",e["\ufc19"]="\u062e\u062c",e["\ufc1a"]="\u062e\u062d",e["\ufc1b"]="\u062e\u0645",e["\ufc1c"]="\u0633\u062c",e["\ufc1d"]="\u0633\u062d",e["\ufc1e"]="\u0633\u062e",e["\ufc1f"]="\u0633\u0645",e["\ufc20"]="\u0635\u062d",e["\ufc21"]="\u0635\u0645",e["\ufc22"]="\u0636\u062c",e["\ufc23"]="\u0636\u062d",e["\ufc24"]="\u0636\u062e",e["\ufc25"]="\u0636\u0645",e["\ufc26"]="\u0637\u062d",e["\ufc27"]="\u0637\u0645",e["\ufc28"]="\u0638\u0645",e["\ufc29"]="\u0639\u062c",e["\ufc2a"]="\u0639\u0645",e["\ufc2b"]="\u063a\u062c",e["\ufc2c"]="\u063a\u0645",e["\ufc2d"]="\u0641\u062c",e["\ufc2e"]="\u0641\u062d",e["\ufc2f"]="\u0641\u062e",e["\ufc30"]="\u0641\u0645",e["\ufc31"]="\u0641\u0649",e["\ufc32"]="\u0641\u064a",e["\ufc33"]="\u0642\u062d",e["\ufc34"]="\u0642\u0645",e["\ufc35"]="\u0642\u0649",e["\ufc36"]="\u0642\u064a",e["\ufc37"]="\u0643\u0627",e["\ufc38"]="\u0643\u062c",e["\ufc39"]="\u0643\u062d",e["\ufc3a"]="\u0643\u062e",e["\ufc3b"]="\u0643\u0644",e["\ufc3c"]="\u0643\u0645",e["\ufc3d"]="\u0643\u0649",e["\ufc3e"]="\u0643\u064a",e["\ufc3f"]="\u0644\u062c",e["\ufc40"]="\u0644\u062d",e["\ufc41"]="\u0644\u062e",e["\ufc42"]="\u0644\u0645",e["\ufc43"]="\u0644\u0649",e["\ufc44"]="\u0644\u064a",e["\ufc45"]="\u0645\u062c",e["\ufc46"]="\u0645\u062d",e["\ufc47"]="\u0645\u062e",e["\ufc48"]="\u0645\u0645",e["\ufc49"]="\u0645\u0649",e["\ufc4a"]="\u0645\u064a",e["\ufc4b"]="\u0646\u062c",e["\ufc4c"]="\u0646\u062d",e["\ufc4d"]="\u0646\u062e",e["\ufc4e"]="\u0646\u0645",e["\ufc4f"]="\u0646\u0649",e["\ufc50"]="\u0646\u064a",e["\ufc51"]="\u0647\u062c",e["\ufc52"]="\u0647\u0645",e["\ufc53"]="\u0647\u0649",e["\ufc54"]="\u0647\u064a",e["\ufc55"]="\u064a\u062c",e["\ufc56"]="\u064a\u062d",e["\ufc57"]="\u064a\u062e",e["\ufc58"]="\u064a\u0645",e["\ufc59"]="\u064a\u0649",e["\ufc5a"]="\u064a\u064a",e["\ufc5b"]="\u0630\u0670",e["\ufc5c"]="\u0631\u0670",e["\ufc5d"]="\u0649\u0670",e["\ufc5e"]=" \u064c\u0651",e["\ufc5f"]=" \u064d\u0651",e["\ufc60"]=" \u064e\u0651",e["\ufc61"]=" \u064f\u0651",e["\ufc62"]=" \u0650\u0651",e["\ufc63"]=" \u0651\u0670",e["\ufc64"]="\u0626\u0631",e["\ufc65"]="\u0626\u0632",e["\ufc66"]="\u0626\u0645",e["\ufc67"]="\u0626\u0646",e["\ufc68"]="\u0626\u0649",e["\ufc69"]="\u0626\u064a",e["\ufc6a"]="\u0628\u0631",e["\ufc6b"]="\u0628\u0632",e["\ufc6c"]="\u0628\u0645",e["\ufc6d"]="\u0628\u0646",e["\ufc6e"]="\u0628\u0649",e["\ufc6f"]="\u0628\u064a",e["\ufc70"]="\u062a\u0631",e["\ufc71"]="\u062a\u0632",e["\ufc72"]="\u062a\u0645",e["\ufc73"]="\u062a\u0646",e["\ufc74"]="\u062a\u0649",e["\ufc75"]="\u062a\u064a",e["\ufc76"]="\u062b\u0631",e["\ufc77"]="\u062b\u0632",e["\ufc78"]="\u062b\u0645",e["\ufc79"]="\u062b\u0646",e["\ufc7a"]="\u062b\u0649",e["\ufc7b"]="\u062b\u064a",e["\ufc7c"]="\u0641\u0649",e["\ufc7d"]="\u0641\u064a",e["\ufc7e"]="\u0642\u0649",e["\ufc7f"]="\u0642\u064a",e["\ufc80"]="\u0643\u0627",e["\ufc81"]="\u0643\u0644",e["\ufc82"]="\u0643\u0645",e["\ufc83"]="\u0643\u0649",e["\ufc84"]="\u0643\u064a",e["\ufc85"]="\u0644\u0645",e["\ufc86"]="\u0644\u0649",e["\ufc87"]="\u0644\u064a",e["\ufc88"]="\u0645\u0627",e["\ufc89"]="\u0645\u0645",e["\ufc8a"]="\u0646\u0631",e["\ufc8b"]="\u0646\u0632",e["\ufc8c"]="\u0646\u0645",e["\ufc8d"]="\u0646\u0646",e["\ufc8e"]="\u0646\u0649",e["\ufc8f"]="\u0646\u064a",e["\ufc90"]="\u0649\u0670",e["\ufc91"]="\u064a\u0631",e["\ufc92"]="\u064a\u0632",e["\ufc93"]="\u064a\u0645",e["\ufc94"]="\u064a\u0646",e["\ufc95"]="\u064a\u0649",e["\ufc96"]="\u064a\u064a",e["\ufc97"]="\u0626\u062c",e["\ufc98"]="\u0626\u062d",e["\ufc99"]="\u0626\u062e",e["\ufc9a"]="\u0626\u0645",e["\ufc9b"]="\u0626\u0647",e["\ufc9c"]="\u0628\u062c",e["\ufc9d"]="\u0628\u062d",e["\ufc9e"]="\u0628\u062e",e["\ufc9f"]="\u0628\u0645",e["\ufca0"]="\u0628\u0647",e["\ufca1"]="\u062a\u062c",e["\ufca2"]="\u062a\u062d",e["\ufca3"]="\u062a\u062e",e["\ufca4"]="\u062a\u0645",e["\ufca5"]="\u062a\u0647",e["\ufca6"]="\u062b\u0645",e["\ufca7"]="\u062c\u062d",e["\ufca8"]="\u062c\u0645",e["\ufca9"]="\u062d\u062c",e["\ufcaa"]="\u062d\u0645",e["\ufcab"]="\u062e\u062c",e["\ufcac"]="\u062e\u0645",e["\ufcad"]="\u0633\u062c",e["\ufcae"]="\u0633\u062d",e["\ufcaf"]="\u0633\u062e",e["\ufcb0"]="\u0633\u0645",e["\ufcb1"]="\u0635\u062d",e["\ufcb2"]="\u0635\u062e",e["\ufcb3"]="\u0635\u0645",e["\ufcb4"]="\u0636\u062c",e["\ufcb5"]="\u0636\u062d",e["\ufcb6"]="\u0636\u062e",e["\ufcb7"]="\u0636\u0645",e["\ufcb8"]="\u0637\u062d",e["\ufcb9"]="\u0638\u0645",e["\ufcba"]="\u0639\u062c",e["\ufcbb"]="\u0639\u0645",e["\ufcbc"]="\u063a\u062c",e["\ufcbd"]="\u063a\u0645",e["\ufcbe"]="\u0641\u062c",e["\ufcbf"]="\u0641\u062d",e["\ufcc0"]="\u0641\u062e",e["\ufcc1"]="\u0641\u0645",e["\ufcc2"]="\u0642\u062d",e["\ufcc3"]="\u0642\u0645",e["\ufcc4"]="\u0643\u062c",e["\ufcc5"]="\u0643\u062d",e["\ufcc6"]="\u0643\u062e",e["\ufcc7"]="\u0643\u0644",e["\ufcc8"]="\u0643\u0645",e["\ufcc9"]="\u0644\u062c",e["\ufcca"]="\u0644\u062d",e["\ufccb"]="\u0644\u062e",e["\ufccc"]="\u0644\u0645",e["\ufccd"]="\u0644\u0647",e["\ufcce"]="\u0645\u062c",e["\ufccf"]="\u0645\u062d",e["\ufcd0"]="\u0645\u062e",e["\ufcd1"]="\u0645\u0645",e["\ufcd2"]="\u0646\u062c",e["\ufcd3"]="\u0646\u062d",e["\ufcd4"]="\u0646\u062e",e["\ufcd5"]="\u0646\u0645",e["\ufcd6"]="\u0646\u0647",e["\ufcd7"]="\u0647\u062c",e["\ufcd8"]="\u0647\u0645",e["\ufcd9"]="\u0647\u0670",e["\ufcda"]="\u064a\u062c",e["\ufcdb"]="\u064a\u062d",e["\ufcdc"]="\u064a\u062e",e["\ufcdd"]="\u064a\u0645",e["\ufcde"]="\u064a\u0647",e["\ufcdf"]="\u0626\u0645",e["\ufce0"]="\u0626\u0647",e["\ufce1"]="\u0628\u0645",e["\ufce2"]="\u0628\u0647",e["\ufce3"]="\u062a\u0645",e["\ufce4"]="\u062a\u0647",e["\ufce5"]="\u062b\u0645",e["\ufce6"]="\u062b\u0647",e["\ufce7"]="\u0633\u0645",e["\ufce8"]="\u0633\u0647",e["\ufce9"]="\u0634\u0645",e["\ufcea"]="\u0634\u0647",e["\ufceb"]="\u0643\u0644",e["\ufcec"]="\u0643\u0645",e["\ufced"]="\u0644\u0645",e["\ufcee"]="\u0646\u0645",e["\ufcef"]="\u0646\u0647",e["\ufcf0"]="\u064a\u0645",e["\ufcf1"]="\u064a\u0647",e["\ufcf2"]="\u0640\u064e\u0651",e["\ufcf3"]="\u0640\u064f\u0651",e["\ufcf4"]="\u0640\u0650\u0651",e["\ufcf5"]="\u0637\u0649",e["\ufcf6"]="\u0637\u064a",e["\ufcf7"]="\u0639\u0649",e["\ufcf8"]="\u0639\u064a",e["\ufcf9"]="\u063a\u0649",e["\ufcfa"]="\u063a\u064a",e["\ufcfb"]="\u0633\u0649",e["\ufcfc"]="\u0633\u064a",e["\ufcfd"]="\u0634\u0649",e["\ufcfe"]="\u0634\u064a",e["\ufcff"]="\u062d\u0649",e["\ufd00"]="\u062d\u064a",e["\ufd01"]="\u062c\u0649",e["\ufd02"]="\u062c\u064a",e["\ufd03"]="\u062e\u0649",e["\ufd04"]="\u062e\u064a",e["\ufd05"]="\u0635\u0649",e["\ufd06"]="\u0635\u064a",e["\ufd07"]="\u0636\u0649",e["\ufd08"]="\u0636\u064a",e["\ufd09"]="\u0634\u062c",e["\ufd0a"]="\u0634\u062d",e["\ufd0b"]="\u0634\u062e",e["\ufd0c"]="\u0634\u0645",e["\ufd0d"]="\u0634\u0631",e["\ufd0e"]="\u0633\u0631",e["\ufd0f"]="\u0635\u0631",e["\ufd10"]="\u0636\u0631",e["\ufd11"]="\u0637\u0649",e["\ufd12"]="\u0637\u064a",e["\ufd13"]="\u0639\u0649",e["\ufd14"]="\u0639\u064a",e["\ufd15"]="\u063a\u0649",e["\ufd16"]="\u063a\u064a",e["\ufd17"]="\u0633\u0649",e["\ufd18"]="\u0633\u064a",e["\ufd19"]="\u0634\u0649",e["\ufd1a"]="\u0634\u064a",e["\ufd1b"]="\u062d\u0649",e["\ufd1c"]="\u062d\u064a",e["\ufd1d"]="\u062c\u0649",e["\ufd1e"]="\u062c\u064a",e["\ufd1f"]="\u062e\u0649",e["\ufd20"]="\u062e\u064a",e["\ufd21"]="\u0635\u0649",e["\ufd22"]="\u0635\u064a",e["\ufd23"]="\u0636\u0649",e["\ufd24"]="\u0636\u064a",e["\ufd25"]="\u0634\u062c",e["\ufd26"]="\u0634\u062d",e["\ufd27"]="\u0634\u062e",e["\ufd28"]="\u0634\u0645",e["\ufd29"]="\u0634\u0631",e["\ufd2a"]="\u0633\u0631",e["\ufd2b"]="\u0635\u0631",e["\ufd2c"]="\u0636\u0631",e["\ufd2d"]="\u0634\u062c",e["\ufd2e"]="\u0634\u062d",e["\ufd2f"]="\u0634\u062e",e["\ufd30"]="\u0634\u0645",e["\ufd31"]="\u0633\u0647",e["\ufd32"]="\u0634\u0647",e["\ufd33"]="\u0637\u0645",e["\ufd34"]="\u0633\u062c",e["\ufd35"]="\u0633\u062d",e["\ufd36"]="\u0633\u062e",e["\ufd37"]="\u0634\u062c",e["\ufd38"]="\u0634\u062d",e["\ufd39"]="\u0634\u062e",e["\ufd3a"]="\u0637\u0645",e["\ufd3b"]="\u0638\u0645",e["\ufd3c"]="\u0627\u064b",e["\ufd3d"]="\u0627\u064b",e["\ufd50"]="\u062a\u062c\u0645",e["\ufd51"]="\u062a\u062d\u062c",e["\ufd52"]="\u062a\u062d\u062c",e["\ufd53"]="\u062a\u062d\u0645",e["\ufd54"]="\u062a\u062e\u0645",e["\ufd55"]="\u062a\u0645\u062c",e["\ufd56"]="\u062a\u0645\u062d",e["\ufd57"]="\u062a\u0645\u062e",e["\ufd58"]="\u062c\u0645\u062d",e["\ufd59"]="\u062c\u0645\u062d",e["\ufd5a"]="\u062d\u0645\u064a",e["\ufd5b"]="\u062d\u0645\u0649",e["\ufd5c"]="\u0633\u062d\u062c",e["\ufd5d"]="\u0633\u062c\u062d",e["\ufd5e"]="\u0633\u062c\u0649",e["\ufd5f"]="\u0633\u0645\u062d",e["\ufd60"]="\u0633\u0645\u062d",e["\ufd61"]="\u0633\u0645\u062c",e["\ufd62"]="\u0633\u0645\u0645",e["\ufd63"]="\u0633\u0645\u0645",e["\ufd64"]="\u0635\u062d\u062d",e["\ufd65"]="\u0635\u062d\u062d",e["\ufd66"]="\u0635\u0645\u0645",e["\ufd67"]="\u0634\u062d\u0645",e["\ufd68"]="\u0634\u062d\u0645",e["\ufd69"]="\u0634\u062c\u064a",e["\ufd6a"]="\u0634\u0645\u062e",e["\ufd6b"]="\u0634\u0645\u062e",e["\ufd6c"]="\u0634\u0645\u0645",e["\ufd6d"]="\u0634\u0645\u0645",e["\ufd6e"]="\u0636\u062d\u0649",e["\ufd6f"]="\u0636\u062e\u0645",e["\ufd70"]="\u0636\u062e\u0645",e["\ufd71"]="\u0637\u0645\u062d",e["\ufd72"]="\u0637\u0645\u062d",e["\ufd73"]="\u0637\u0645\u0645",e["\ufd74"]="\u0637\u0645\u064a",e["\ufd75"]="\u0639\u062c\u0645",e["\ufd76"]="\u0639\u0645\u0645",e["\ufd77"]="\u0639\u0645\u0645",e["\ufd78"]="\u0639\u0645\u0649",e["\ufd79"]="\u063a\u0645\u0645",e["\ufd7a"]="\u063a\u0645\u064a",e["\ufd7b"]="\u063a\u0645\u0649",e["\ufd7c"]="\u0641\u062e\u0645",e["\ufd7d"]="\u0641\u062e\u0645",e["\ufd7e"]="\u0642\u0645\u062d",e["\ufd7f"]="\u0642\u0645\u0645",e["\ufd80"]="\u0644\u062d\u0645",e["\ufd81"]="\u0644\u062d\u064a",e["\ufd82"]="\u0644\u062d\u0649",e["\ufd83"]="\u0644\u062c\u062c",e["\ufd84"]="\u0644\u062c\u062c",e["\ufd85"]="\u0644\u062e\u0645",e["\ufd86"]="\u0644\u062e\u0645",e["\ufd87"]="\u0644\u0645\u062d",e["\ufd88"]="\u0644\u0645\u062d",e["\ufd89"]="\u0645\u062d\u062c",e["\ufd8a"]="\u0645\u062d\u0645",e["\ufd8b"]="\u0645\u062d\u064a",e["\ufd8c"]="\u0645\u062c\u062d",e["\ufd8d"]="\u0645\u062c\u0645",e["\ufd8e"]="\u0645\u062e\u062c",e["\ufd8f"]="\u0645\u062e\u0645",e["\ufd92"]="\u0645\u062c\u062e",e["\ufd93"]="\u0647\u0645\u062c",e["\ufd94"]="\u0647\u0645\u0645",e["\ufd95"]="\u0646\u062d\u0645",e["\ufd96"]="\u0646\u062d\u0649",e["\ufd97"]="\u0646\u062c\u0645",e["\ufd98"]="\u0646\u062c\u0645",e["\ufd99"]="\u0646\u062c\u0649",e["\ufd9a"]="\u0646\u0645\u064a",e["\ufd9b"]="\u0646\u0645\u0649",e["\ufd9c"]="\u064a\u0645\u0645",e["\ufd9d"]="\u064a\u0645\u0645",e["\ufd9e"]="\u0628\u062e\u064a",e["\ufd9f"]="\u062a\u062c\u064a",e["\ufda0"]="\u062a\u062c\u0649",e["\ufda1"]="\u062a\u062e\u064a",e["\ufda2"]="\u062a\u062e\u0649",e["\ufda3"]="\u062a\u0645\u064a",e["\ufda4"]="\u062a\u0645\u0649",e["\ufda5"]="\u062c\u0645\u064a",e["\ufda6"]="\u062c\u062d\u0649",e["\ufda7"]="\u062c\u0645\u0649",e["\ufda8"]="\u0633\u062e\u0649",e["\ufda9"]="\u0635\u062d\u064a",e["\ufdaa"]="\u0634\u062d\u064a",e["\ufdab"]="\u0636\u062d\u064a",e["\ufdac"]="\u0644\u062c\u064a",e["\ufdad"]="\u0644\u0645\u064a",e["\ufdae"]="\u064a\u062d\u064a",e["\ufdaf"]="\u064a\u062c\u064a",e["\ufdb0"]="\u064a\u0645\u064a",e["\ufdb1"]="\u0645\u0645\u064a",e["\ufdb2"]="\u0642\u0645\u064a",e["\ufdb3"]="\u0646\u062d\u064a",e["\ufdb4"]="\u0642\u0645\u062d",e["\ufdb5"]="\u0644\u062d\u0645",e["\ufdb6"]="\u0639\u0645\u064a",e["\ufdb7"]="\u0643\u0645\u064a",e["\ufdb8"]="\u0646\u062c\u062d",e["\ufdb9"]="\u0645\u062e\u064a",e["\ufdba"]="\u0644\u062c\u0645",e["\ufdbb"]="\u0643\u0645\u0645",e["\ufdbc"]="\u0644\u062c\u0645",e["\ufdbd"]="\u0646\u062c\u062d",e["\ufdbe"]="\u062c\u062d\u064a",e["\ufdbf"]="\u062d\u062c\u064a",e["\ufdc0"]="\u0645\u062c\u064a",e["\ufdc1"]="\u0641\u0645\u064a",e["\ufdc2"]="\u0628\u062d\u064a",e["\ufdc3"]="\u0643\u0645\u0645",e["\ufdc4"]="\u0639\u062c\u0645",e["\ufdc5"]="\u0635\u0645\u0645",e["\ufdc6"]="\u0633\u062e\u064a",e["\ufdc7"]="\u0646\u062c\u064a",e["\ufe49"]="\u203e",e["\ufe4a"]="\u203e",e["\ufe4b"]="\u203e",e["\ufe4c"]="\u203e",e["\ufe4d"]="_",e["\ufe4e"]="_",e["\ufe4f"]="_",e["\ufe80"]="\u0621",e["\ufe81"]="\u0622",e["\ufe82"]="\u0622",e["\ufe83"]="\u0623",e["\ufe84"]="\u0623",e["\ufe85"]="\u0624",e["\ufe86"]="\u0624",e["\ufe87"]="\u0625",e["\ufe88"]="\u0625",e["\ufe89"]="\u0626",e["\ufe8a"]="\u0626",e["\ufe8b"]="\u0626",e["\ufe8c"]="\u0626",e["\ufe8d"]="\u0627",e["\ufe8e"]="\u0627",e["\ufe8f"]="\u0628",e["\ufe90"]="\u0628",e["\ufe91"]="\u0628",e["\ufe92"]="\u0628",e["\ufe93"]="\u0629",e["\ufe94"]="\u0629",e["\ufe95"]="\u062a",e["\ufe96"]="\u062a",e["\ufe97"]="\u062a",e["\ufe98"]="\u062a",e["\ufe99"]="\u062b",e["\ufe9a"]="\u062b",e["\ufe9b"]="\u062b",e["\ufe9c"]="\u062b",e["\ufe9d"]="\u062c",e["\ufe9e"]="\u062c",e["\ufe9f"]="\u062c",e["\ufea0"]="\u062c",e["\ufea1"]="\u062d",e["\ufea2"]="\u062d",e["\ufea3"]="\u062d",e["\ufea4"]="\u062d",e["\ufea5"]="\u062e",e["\ufea6"]="\u062e",e["\ufea7"]="\u062e",e["\ufea8"]="\u062e",e["\ufea9"]="\u062f",e["\ufeaa"]="\u062f",e["\ufeab"]="\u0630",e["\ufeac"]="\u0630",e["\ufead"]="\u0631",e["\ufeae"]="\u0631",e["\ufeaf"]="\u0632",e["\ufeb0"]="\u0632",e["\ufeb1"]="\u0633",e["\ufeb2"]="\u0633",e["\ufeb3"]="\u0633",e["\ufeb4"]="\u0633",e["\ufeb5"]="\u0634",e["\ufeb6"]="\u0634",e["\ufeb7"]="\u0634",e["\ufeb8"]="\u0634",e["\ufeb9"]="\u0635",e["\ufeba"]="\u0635",e["\ufebb"]="\u0635",e["\ufebc"]="\u0635",e["\ufebd"]="\u0636",e["\ufebe"]="\u0636",e["\ufebf"]="\u0636",e["\ufec0"]="\u0636",e["\ufec1"]="\u0637",e["\ufec2"]="\u0637",e["\ufec3"]="\u0637",e["\ufec4"]="\u0637",e["\ufec5"]="\u0638",e["\ufec6"]="\u0638",e["\ufec7"]="\u0638",e["\ufec8"]="\u0638",e["\ufec9"]="\u0639",e["\ufeca"]="\u0639",e["\ufecb"]="\u0639",e["\ufecc"]="\u0639",e["\ufecd"]="\u063a",e["\ufece"]="\u063a",e["\ufecf"]="\u063a",e["\ufed0"]="\u063a",e["\ufed1"]="\u0641",e["\ufed2"]="\u0641",e["\ufed3"]="\u0641",e["\ufed4"]="\u0641",e["\ufed5"]="\u0642",e["\ufed6"]="\u0642",e["\ufed7"]="\u0642",e["\ufed8"]="\u0642",e["\ufed9"]="\u0643",e["\ufeda"]="\u0643",e["\ufedb"]="\u0643",e["\ufedc"]="\u0643",e["\ufedd"]="\u0644",e["\ufede"]="\u0644",e["\ufedf"]="\u0644",e["\ufee0"]="\u0644",e["\ufee1"]="\u0645",e["\ufee2"]="\u0645",e["\ufee3"]="\u0645",e["\ufee4"]="\u0645",e["\ufee5"]="\u0646",e["\ufee6"]="\u0646",e["\ufee7"]="\u0646",e["\ufee8"]="\u0646",e["\ufee9"]="\u0647",e["\ufeea"]="\u0647",e["\ufeeb"]="\u0647",e["\ufeec"]="\u0647",e["\ufeed"]="\u0648",e["\ufeee"]="\u0648",e["\ufeef"]="\u0649",e["\ufef0"]="\u0649",e["\ufef1"]="\u064a",e["\ufef2"]="\u064a",e["\ufef3"]="\u064a",e["\ufef4"]="\u064a",e["\ufef5"]="\u0644\u0622",e["\ufef6"]="\u0644\u0622",e["\ufef7"]="\u0644\u0623",e["\ufef8"]="\u0644\u0623",e["\ufef9"]="\u0644\u0625",e["\ufefa"]="\u0644\u0625",e["\ufefb"]="\u0644\u0627",e["\ufefc"]="\u0644\u0627"}));t.mapSpecialUnicodeValues=function(e){return e>=65520&&e<=65535?0:e>=62976&&e<=63743?i()[e]||e:173===e?45:e},t.reverseIfRtl=function(e){var t=e.length;if(t<=1||!function(e){var t=o[13];return e>=t.begin&&e<t.end||e>=(t=o[11]).begin&&e<t.end}(e.charCodeAt(0)))return e;for(var r="",n=t-1;n>=0;n--)r+=e[n];return r},t.getUnicodeRangeFor=function(e){for(var t=0,r=o.length;t<r;t++){var n=o[t];if(e>=n.begin&&e<n.end)return t}return-1},t.getNormalizedUnicodes=a,t.getUnicodeForGlyph=function(e,t){var r=t[e];if(void 0!==r)return r;if(!e)return-1;if("u"===e[0]){var n,i=e.length;if(7===i&&"n"===e[1]&&"i"===e[2])n=e.substring(3);else{if(!(i>=5&&i<=7))return-1;n=e.substring(1)}if(n===n.toUpperCase()&&(r=parseInt(n,16))>=0)return r}return-1}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FontRendererFactory=void 0;var n=r(2),i=r(32),o=r(35),a=r(34),s=r(12),l=function(){function e(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]}function t(e,t){return e[t]<<8|e[t+1]}function r(e){const t=e.length;let r=32768;return t<1240?r=107:t<33900&&(r=1131),r}function l(r,i,o){var a,s,l,c=1===t(r,i+2)?e(r,i+8):e(r,i+16),u=t(r,i+c);if(4===u){t(r,i+c+2);var h=t(r,i+c+6)>>1;for(s=i+c+14,a=[],l=0;l<h;l++,s+=2)a[l]={end:t(r,s)};for(s+=2,l=0;l<h;l++,s+=2)a[l].start=t(r,s);for(l=0;l<h;l++,s+=2)a[l].idDelta=t(r,s);for(l=0;l<h;l++,s+=2){var d=t(r,s);if(0!==d){a[l].ids=[];for(var f=0,g=a[l].end-a[l].start+1;f<g;f++)a[l].ids[f]=t(r,s+d),d+=2}}return a}if(12===u){e(r,i+c+4);var p=e(r,i+c+12);for(s=i+c+16,a=[],l=0;l<p;l++)a.push({start:e(r,s),end:e(r,s+4),idDelta:e(r,s+8)-e(r,s)}),s+=12;return a}throw new n.FormatError(`unsupported cmap: ${u}`)}function c(e,t,r,n){var o=new i.CFFParser(new s.Stream(e,t,r-t),{},n).parse();return{glyphs:o.charStrings.objects,subrs:o.topDict.privateDict&&o.topDict.privateDict.subrsIndex&&o.topDict.privateDict.subrsIndex.objects,gsubrs:o.globalSubrIndex&&o.globalSubrIndex.objects,isCFFCIDFont:o.isCIDFont,fdSelect:o.fdSelect,fdArray:o.fdArray}}function u(e,t){for(var r=t.codePointAt(0),n=0,i=0,o=e.length-1;i<o;){var a=i+o+1>>1;r<e[a].start?o=a-1:i=a}return e[i].start<=r&&r<=e[i].end&&(n=e[i].idDelta+(e[i].ids?e[i].ids[r-e[i].start]:r)&65535),{charCode:r,glyphId:n}}function h(e,t,r){function n(e,r){t.push({cmd:"moveTo",args:[e,r]})}function i(e,r){t.push({cmd:"lineTo",args:[e,r]})}function o(e,r,n,i){t.push({cmd:"quadraticCurveTo",args:[e,r,n,i]})}var a,s=0,l=(e[s]<<24|e[s+1]<<16)>>16,c=0,u=0;if(s+=10,l<0)do{a=e[s]<<8|e[s+1];var d,f,g=e[s+2]<<8|e[s+3];s+=4,1&a?(d=(e[s]<<24|e[s+1]<<16)>>16,f=(e[s+2]<<24|e[s+3]<<16)>>16,s+=4):(d=e[s++],f=e[s++]),2&a?(c=d,u=f):(c=0,u=0);var p=1,m=1,v=0,b=0;8&a?(p=m=(e[s]<<24|e[s+1]<<16)/1073741824,s+=2):64&a?(p=(e[s]<<24|e[s+1]<<16)/1073741824,m=(e[s+2]<<24|e[s+3]<<16)/1073741824,s+=4):128&a&&(p=(e[s]<<24|e[s+1]<<16)/1073741824,v=(e[s+2]<<24|e[s+3]<<16)/1073741824,b=(e[s+4]<<24|e[s+5]<<16)/1073741824,m=(e[s+6]<<24|e[s+7]<<16)/1073741824,s+=8);var y=r.glyphs[g];y&&(t.push({cmd:"save"}),t.push({cmd:"transform",args:[p,v,b,m,c,u]}),h(y,t,r),t.push({cmd:"restore"}))}while(32&a);else{var w,S,C=[];for(w=0;w<l;w++)C.push(e[s]<<8|e[s+1]),s+=2;s+=2+(e[s]<<8|e[s+1]);for(var k=C[C.length-1]+1,x=[];x.length<k;){var E=1;for(8&(a=e[s++])&&(E+=e[s++]);E-- >0;)x.push({flags:a})}for(w=0;w<k;w++){switch(18&x[w].flags){case 0:c+=(e[s]<<24|e[s+1]<<16)>>16,s+=2;break;case 2:c-=e[s++];break;case 18:c+=e[s++]}x[w].x=c}for(w=0;w<k;w++){switch(36&x[w].flags){case 0:u+=(e[s]<<24|e[s+1]<<16)>>16,s+=2;break;case 4:u-=e[s++];break;case 36:u+=e[s++]}x[w].y=u}var T=0;for(s=0;s<l;s++){var _=C[s],A=x.slice(T,_+1);if(1&A[0].flags)A.push(A[0]);else if(1&A[A.length-1].flags)A.unshift(A[A.length-1]);else{var R={flags:1,x:(A[0].x+A[A.length-1].x)/2,y:(A[0].y+A[A.length-1].y)/2};A.unshift(R),A.push(R)}for(n(A[0].x,A[0].y),w=1,S=A.length;w<S;w++)1&A[w].flags?i(A[w].x,A[w].y):1&A[w+1].flags?(o(A[w].x,A[w].y,A[w+1].x,A[w+1].y),w++):o(A[w].x,A[w].y,(A[w].x+A[w+1].x)/2,(A[w].y+A[w+1].y)/2);T=_+1}}}function d(e,t,i,o){function s(e,r){t.push({cmd:"moveTo",args:[e,r]})}function l(e,r){t.push({cmd:"lineTo",args:[e,r]})}function c(e,r,n,i,o,a){t.push({cmd:"bezierCurveTo",args:[e,r,n,i,o,a]})}var h=[],f=0,g=0,p=0;!function e(m){for(var v=0;v<m.length;){var b,y,w,S,C,k,x,E,T=!1,_=m[v++];switch(_){case 1:case 3:case 18:case 23:p+=h.length>>1,T=!0;break;case 4:g+=h.pop(),s(f,g),T=!0;break;case 5:for(;h.length>0;)f+=h.shift(),g+=h.shift(),l(f,g);break;case 6:for(;h.length>0&&(l(f+=h.shift(),g),0!==h.length);)g+=h.shift(),l(f,g);break;case 7:for(;h.length>0&&(g+=h.shift(),l(f,g),0!==h.length);)l(f+=h.shift(),g);break;case 8:for(;h.length>0;)b=f+h.shift(),w=g+h.shift(),y=b+h.shift(),S=w+h.shift(),f=y+h.shift(),g=S+h.shift(),c(b,w,y,S,f,g);break;case 10:if(x=h.pop(),E=null,i.isCFFCIDFont){const e=i.fdSelect.getFDIndex(o);if(e>=0&&e<i.fdArray.length){const t=i.fdArray[e];let n;t.privateDict&&t.privateDict.subrsIndex&&(n=t.privateDict.subrsIndex.objects),n&&(E=n[x+=r(n)])}else(0,n.warn)("Invalid fd index for glyph index.")}else E=i.subrs[x+i.subrsBias];E&&e(E);break;case 11:return;case 12:switch(_=m[v++]){case 34:y=(b=f+h.shift())+h.shift(),C=g+h.shift(),f=y+h.shift(),c(b,g,y,C,f,C),y=(b=f+h.shift())+h.shift(),f=y+h.shift(),c(b,C,y,g,f,g);break;case 35:b=f+h.shift(),w=g+h.shift(),y=b+h.shift(),S=w+h.shift(),f=y+h.shift(),g=S+h.shift(),c(b,w,y,S,f,g),b=f+h.shift(),w=g+h.shift(),y=b+h.shift(),S=w+h.shift(),f=y+h.shift(),g=S+h.shift(),c(b,w,y,S,f,g),h.pop();break;case 36:c(b=f+h.shift(),C=g+h.shift(),y=b+h.shift(),k=C+h.shift(),f=y+h.shift(),k),c(b=f+h.shift(),k,y=b+h.shift(),k+h.shift(),f=y+h.shift(),g);break;case 37:var A=f,R=g;b=f+h.shift(),w=g+h.shift(),y=b+h.shift(),S=w+h.shift(),f=y+h.shift(),g=S+h.shift(),c(b,w,y,S,f,g),b=f+h.shift(),w=g+h.shift(),y=b+h.shift(),S=w+h.shift(),f=y,g=S,Math.abs(f-A)>Math.abs(g-R)?f+=h.shift():g+=h.shift(),c(b,w,y,S,f,g);break;default:throw new n.FormatError(`unknown operator: 12 ${_}`)}break;case 14:if(h.length>=4){var O=h.pop(),M=h.pop();g=h.pop(),f=h.pop(),t.push({cmd:"save"}),t.push({cmd:"translate",args:[f,g]});var I=u(i.cmap,String.fromCharCode(i.glyphNameMap[a.StandardEncoding[O]]));d(i.glyphs[I.glyphId],t,i,I.glyphId),t.push({cmd:"restore"}),I=u(i.cmap,String.fromCharCode(i.glyphNameMap[a.StandardEncoding[M]])),d(i.glyphs[I.glyphId],t,i,I.glyphId)}return;case 19:case 20:v+=(p+=h.length>>1)+7>>3,T=!0;break;case 21:g+=h.pop(),s(f+=h.pop(),g),T=!0;break;case 22:s(f+=h.pop(),g),T=!0;break;case 24:for(;h.length>2;)b=f+h.shift(),w=g+h.shift(),y=b+h.shift(),S=w+h.shift(),f=y+h.shift(),g=S+h.shift(),c(b,w,y,S,f,g);f+=h.shift(),g+=h.shift(),l(f,g);break;case 25:for(;h.length>6;)f+=h.shift(),g+=h.shift(),l(f,g);b=f+h.shift(),w=g+h.shift(),y=b+h.shift(),S=w+h.shift(),f=y+h.shift(),g=S+h.shift(),c(b,w,y,S,f,g);break;case 26:for(h.length%2&&(f+=h.shift());h.length>0;)b=f,w=g+h.shift(),y=b+h.shift(),S=w+h.shift(),f=y,g=S+h.shift(),c(b,w,y,S,f,g);break;case 27:for(h.length%2&&(g+=h.shift());h.length>0;)c(b=f+h.shift(),w=g,y=b+h.shift(),S=w+h.shift(),f=y+h.shift(),g=S);break;case 28:h.push((m[v]<<24|m[v+1]<<16)>>16),v+=2;break;case 29:x=h.pop()+i.gsubrsBias,(E=i.gsubrs[x])&&e(E);break;case 30:for(;h.length>0&&(b=f,w=g+h.shift(),y=b+h.shift(),S=w+h.shift(),f=y+h.shift(),g=S+(1===h.length?h.shift():0),c(b,w,y,S,f,g),0!==h.length);)b=f+h.shift(),w=g,y=b+h.shift(),S=w+h.shift(),g=S+h.shift(),c(b,w,y,S,f=y+(1===h.length?h.shift():0),g);break;case 31:for(;h.length>0&&(b=f+h.shift(),w=g,y=b+h.shift(),S=w+h.shift(),g=S+h.shift(),c(b,w,y,S,f=y+(1===h.length?h.shift():0),g),0!==h.length);)b=f,w=g+h.shift(),y=b+h.shift(),S=w+h.shift(),f=y+h.shift(),g=S+(1===h.length?h.shift():0),c(b,w,y,S,f,g);break;default:if(_<32)throw new n.FormatError(`unknown operator: ${_}`);_<247?h.push(_-139):_<251?h.push(256*(_-247)+m[v++]+108):_<255?h.push(256*-(_-251)-m[v++]-108):(h.push((m[v]<<24|m[v+1]<<16|m[v+2]<<8|m[v+3])/65536),v+=4)}T&&(h.length=0)}}(e)}const f=[];class g{constructor(e){this.constructor===g&&(0,n.unreachable)("Cannot initialize CompiledFont."),this.fontMatrix=e,this.compiledGlyphs=Object.create(null),this.compiledCharCodeToGlyphId=Object.create(null)}getPathJs(e){const t=u(this.cmap,e);let r=this.compiledGlyphs[t.glyphId];return r||(r=this.compileGlyph(this.glyphs[t.glyphId],t.glyphId),this.compiledGlyphs[t.glyphId]=r),void 0===this.compiledCharCodeToGlyphId[t.charCode]&&(this.compiledCharCodeToGlyphId[t.charCode]=t.glyphId),r}compileGlyph(e,t){if(!e||0===e.length||14===e[0])return f;let r=this.fontMatrix;if(this.isCFFCIDFont){const e=this.fdSelect.getFDIndex(t);e>=0&&e<this.fdArray.length?r=this.fdArray[e].getByName("FontMatrix")||n.FONT_IDENTITY_MATRIX:(0,n.warn)("Invalid fd index for glyph index.")}const i=[];return i.push({cmd:"save"}),i.push({cmd:"transform",args:r.slice()}),i.push({cmd:"scale",args:["size","-size"]}),this.compileGlyphImpl(e,i,t),i.push({cmd:"restore"}),i}compileGlyphImpl(){(0,n.unreachable)("Children classes should implement this.")}hasBuiltPath(e){const t=u(this.cmap,e);return void 0!==this.compiledGlyphs[t.glyphId]&&void 0!==this.compiledCharCodeToGlyphId[t.charCode]}}class p extends g{constructor(e,t,r){super(r||[488e-6,0,0,488e-6,0,0]),this.glyphs=e,this.cmap=t}compileGlyphImpl(e,t){h(e,t,this)}}class m extends g{constructor(e,t,n,i){super(n||[.001,0,0,.001,0,0]),this.glyphs=e.glyphs,this.gsubrs=e.gsubrs||[],this.subrs=e.subrs||[],this.cmap=t,this.glyphNameMap=i||(0,o.getGlyphsUnicode)(),this.gsubrsBias=r(this.gsubrs),this.subrsBias=r(this.subrs),this.isCFFCIDFont=e.isCFFCIDFont,this.fdSelect=e.fdSelect,this.fdArray=e.fdArray}compileGlyphImpl(e,t,r){d(e,t,this,r)}}return{create:function(r,i){for(var o,a,s,u,h,d,f=new Uint8Array(r.data),g=t(f,4),v=0,b=12;v<g;v++,b+=16){var y=(0,n.bytesToString)(f.subarray(b,b+4)),w=e(f,b+8),S=e(f,b+12);switch(y){case"cmap":o=l(f,w);break;case"glyf":a=f.subarray(w,w+S);break;case"loca":s=f.subarray(w,w+S);break;case"head":d=t(f,w+18),h=t(f,w+50);break;case"CFF ":u=c(f,w,w+S,i)}}if(a){var C=d?[1/d,0,0,1/d,0,0]:r.fontMatrix;return new p(function(e,t,r){var n,i;r?(n=4,i=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]}):(n=2,i=function(e,t){return e[t]<<9|e[t+1]<<1});for(var o=[],a=i(t,0),s=n;s<t.length;s+=n){var l=i(t,s);o.push(e.subarray(a,l)),a=l}return o}(a,s,h),o,C)}return new m(u,o,r.fontMatrix,r.glyphNameMap)}}}();t.FontRendererFactory=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Type1Parser=void 0;var n=r(34),i=r(8),o=r(12),a=r(2),s=function(){var e=[4],t=[5],r=[6],n=[7],i=[8],o=[12,35],s=[14],l=[21],c=[22],u=[30],h=[31];function d(){this.width=0,this.lsb=0,this.flexing=!1,this.output=[],this.stack=[]}return d.prototype={convert:function(d,f,g){for(var p,m,v,b=d.length,y=!1,w=0;w<b;w++){var S=d[w];if(S<32){switch(12===S&&(S=(S<<8)+d[++w]),S){case 1:case 3:case 9:case 3072:case 3073:case 3074:case 3105:this.stack=[];break;case 4:if(this.flexing){if(this.stack.length<1){y=!0;break}var C=this.stack.pop();this.stack.push(0,C);break}y=this.executeCommand(1,e);break;case 5:y=this.executeCommand(2,t);break;case 6:y=this.executeCommand(1,r);break;case 7:y=this.executeCommand(1,n);break;case 8:y=this.executeCommand(6,i);break;case 10:if(this.stack.length<1){y=!0;break}if(!f[v=this.stack.pop()]){y=!0;break}y=this.convert(f[v],f,g);break;case 11:return y;case 13:if(this.stack.length<2){y=!0;break}p=this.stack.pop(),m=this.stack.pop(),this.lsb=m,this.width=p,this.stack.push(p,m),y=this.executeCommand(2,c);break;case 14:this.output.push(s[0]);break;case 21:if(this.flexing)break;y=this.executeCommand(2,l);break;case 22:if(this.flexing){this.stack.push(0);break}y=this.executeCommand(1,c);break;case 30:y=this.executeCommand(4,u);break;case 31:y=this.executeCommand(4,h);break;case 3078:if(g){const e=this.stack[this.stack.length-5];this.seac=this.stack.splice(-4,4),this.seac[0]+=this.lsb-e,y=this.executeCommand(0,s)}else y=this.executeCommand(4,s);break;case 3079:if(this.stack.length<4){y=!0;break}this.stack.pop(),p=this.stack.pop();var k=this.stack.pop();m=this.stack.pop(),this.lsb=m,this.width=p,this.stack.push(p,m,k),y=this.executeCommand(3,l);break;case 3084:if(this.stack.length<2){y=!0;break}var x=this.stack.pop(),E=this.stack.pop();this.stack.push(E/x);break;case 3088:if(this.stack.length<2){y=!0;break}v=this.stack.pop();var T=this.stack.pop();if(0===v&&3===T){var _=this.stack.splice(this.stack.length-17,17);this.stack.push(_[2]+_[0],_[3]+_[1],_[4],_[5],_[6],_[7],_[8],_[9],_[10],_[11],_[12],_[13],_[14]),y=this.executeCommand(13,o,!0),this.flexing=!1,this.stack.push(_[15],_[16])}else 1===v&&0===T&&(this.flexing=!0);break;case 3089:break;default:(0,a.warn)('Unknown type 1 charstring command of "'+S+'"')}if(y)break}else S<=246?S-=139:S=S<=250?256*(S-247)+d[++w]+108:S<=254?-256*(S-251)-d[++w]-108:(255&d[++w])<<24|(255&d[++w])<<16|(255&d[++w])<<8|255&d[++w],this.stack.push(S)}return y},executeCommand(e,t,r){var n=this.stack.length;if(e>n)return!0;for(var i=n-e,o=i;o<n;o++){var a=this.stack[o];Number.isInteger(a)?this.output.push(28,a>>8&255,255&a):(a=65536*a|0,this.output.push(255,a>>24&255,a>>16&255,a>>8&255,255&a))}return this.output.push.apply(this.output,t),r?this.stack.splice(i,e):this.stack.length=0,!1}},d}(),l=function(){function e(e){return e>=48&&e<=57||e>=65&&e<=70||e>=97&&e<=102}function t(e,t,r){if(r>=e.length)return new Uint8Array(0);var n,i,o=0|t;for(n=0;n<r;n++)o=52845*(e[n]+o)+22719&65535;var a=e.length-r,s=new Uint8Array(a);for(n=r,i=0;i<a;n++,i++){var l=e[n];s[i]=l^o>>8,o=52845*(l+o)+22719&65535}return s}function r(e){return 47===e||91===e||93===e||123===e||125===e||40===e||41===e}function a(r,n,a){if(n){var s=r.getBytes(),l=!((e(s[0])||(0,i.isWhiteSpace)(s[0]))&&e(s[1])&&e(s[2])&&e(s[3])&&e(s[4])&&e(s[5])&&e(s[6])&&e(s[7]));r=new o.Stream(l?t(s,55665,4):function(t,r,n){var i,o,a=0|r,s=t.length,l=new Uint8Array(s>>>1);for(i=0,o=0;i<s;i++){var c=t[i];if(e(c)){var u;for(i++;i<s&&!e(u=t[i]);)i++;if(i<s){var h=parseInt(String.fromCharCode(c,u),16);l[o++]=h^a>>8,a=52845*(h+a)+22719&65535}}}return l.slice(n,o)}(s,55665,4))}this.seacAnalysisEnabled=!!a,this.stream=r,this.nextChar()}return a.prototype={readNumberArray:function(){this.getToken();for(var e=[];;){var t=this.getToken();if(null===t||"]"===t||"}"===t)break;e.push(parseFloat(t||0))}return e},readNumber:function(){var e=this.getToken();return parseFloat(e||0)},readInt:function(){var e=this.getToken();return 0|parseInt(e||0,10)},readBoolean:function(){return"true"===this.getToken()?1:0},nextChar:function(){return this.currentChar=this.stream.getByte()},getToken:function(){for(var e=!1,t=this.currentChar;;){if(-1===t)return null;if(e)10!==t&&13!==t||(e=!1);else if(37===t)e=!0;else if(!(0,i.isWhiteSpace)(t))break;t=this.nextChar()}if(r(t))return this.nextChar(),String.fromCharCode(t);var n="";do{n+=String.fromCharCode(t),t=this.nextChar()}while(t>=0&&!(0,i.isWhiteSpace)(t)&&!r(t));return n},readCharStrings:function(e,r){return-1===r?e:t(e,4330,r)},extractFontProgram:function(e){var t=this.stream,r=[],n=[],i=Object.create(null);i.lenIV=4;for(var o,a,l,c,u,h={subrs:[],charstrings:[],properties:{privateData:i}};null!==(o=this.getToken());)if("/"===o)switch(o=this.getToken()){case"CharStrings":for(this.getToken(),this.getToken(),this.getToken(),this.getToken();null!==(o=this.getToken())&&"end"!==o;)if("/"===o){var d=this.getToken();a=this.readInt(),this.getToken(),l=a>0?t.getBytes(a):new Uint8Array(0),c=h.properties.privateData.lenIV,u=this.readCharStrings(l,c),this.nextChar(),"noaccess"===(o=this.getToken())&&this.getToken(),n.push({glyph:d,encoded:u})}break;case"Subrs":for(this.readInt(),this.getToken();"dup"===this.getToken();){const e=this.readInt();a=this.readInt(),this.getToken(),l=a>0?t.getBytes(a):new Uint8Array(0),c=h.properties.privateData.lenIV,u=this.readCharStrings(l,c),this.nextChar(),"noaccess"===(o=this.getToken())&&this.getToken(),r[e]=u}break;case"BlueValues":case"OtherBlues":case"FamilyBlues":case"FamilyOtherBlues":var f=this.readNumberArray();f.length>0&&f.length;break;case"StemSnapH":case"StemSnapV":h.properties.privateData[o]=this.readNumberArray();break;case"StdHW":case"StdVW":h.properties.privateData[o]=this.readNumberArray()[0];break;case"BlueShift":case"lenIV":case"BlueFuzz":case"BlueScale":case"LanguageGroup":case"ExpansionFactor":h.properties.privateData[o]=this.readNumber();break;case"ForceBold":h.properties.privateData[o]=this.readBoolean()}for(var g=0;g<n.length;g++){d=n[g].glyph,u=n[g].encoded;var p=new s,m=p.convert(u,r,this.seacAnalysisEnabled),v=p.output;m&&(v=[14]);const t={glyphName:d,charstring:v,width:p.width,lsb:p.lsb,seac:p.seac};if(".notdef"===d?h.charstrings.unshift(t):h.charstrings.push(t),e.builtInEncoding){const t=e.builtInEncoding.indexOf(d);t>-1&&void 0===e.widths[t]&&t>=e.firstChar&&t<=e.lastChar&&(e.widths[t]=p.width)}}return h},extractFontHeader:function(e){for(var t;null!==(t=this.getToken());)if("/"===t)switch(t=this.getToken()){case"FontMatrix":var r=this.readNumberArray();e.fontMatrix=r;break;case"Encoding":var i,o=this.getToken();if(/^\d+$/.test(o)){i=[];var a=0|parseInt(o,10);this.getToken();for(var s=0;s<a;s++){for(t=this.getToken();"dup"!==t&&"def"!==t;)if(null===(t=this.getToken()))return;if("def"===t)break;var l=this.readInt();this.getToken();var c=this.getToken();i[l]=c,this.getToken()}}else i=(0,n.getEncoding)(o);e.builtInEncoding=i;break;case"FontBBox":var u=this.readNumberArray();e.ascent=Math.max(u[3],u[1]),e.descent=Math.min(u[1],u[3]),e.ascentScaled=!0}}},a}();t.Type1Parser=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getTilingPatternIR=function(e,t,r){const i=t.getArray("Matrix"),o=n.Util.normalizeRect(t.getArray("BBox")),a=t.get("XStep"),s=t.get("YStep"),l=t.get("PaintType"),c=t.get("TilingType");if(o[2]-o[0]===0||o[3]-o[1]===0)throw new n.FormatError(`Invalid getTilingPatternIR /BBox array: [${o}].`);return["TilingPattern",r,e,i,o,a,s,l,c]},t.Pattern=void 0;var n=r(2),i=r(23),o=r(5),a=r(8),s=2,l=3,c=4,u=5,h=6,d=7,f=function(){function e(){(0,n.unreachable)("should not call Pattern constructor")}return e.prototype={getPattern:function(e){(0,n.unreachable)(`Should not call Pattern.getStyle: ${e}`)}},e.parseShading=function(e,t,r,i,f,p,m){var v=(0,o.isStream)(e)?e.dict:e,b=v.get("ShadingType");try{switch(b){case s:case l:return new g.RadialAxial(v,t,r,i,p,m);case c:case u:case h:case d:return new g.Mesh(e,t,r,i,p,m);default:throw new n.FormatError("Unsupported ShadingType: "+b)}}catch(y){if(y instanceof a.MissingDataException)throw y;return f.send("UnsupportedFeature",{featureId:n.UNSUPPORTED_FEATURES.shadingPattern}),(0,n.warn)(y),new g.Dummy}},e}();t.Pattern=f;var g={SMALL_NUMBER:1e-6};g.RadialAxial=function(){function e(e,t,r,o,a,s){this.matrix=t,this.coordsArr=e.getArray("Coords"),this.shadingType=e.get("ShadingType"),this.type="Pattern";const c=i.ColorSpace.parse({cs:e.getRaw("ColorSpace")||e.getRaw("CS"),xref:r,resources:o,pdfFunctionFactory:a,localColorSpaceCache:s});this.cs=c;const u=e.getArray("BBox");Array.isArray(u)&&4===u.length?this.bbox=n.Util.normalizeRect(u):this.bbox=null;var h=0,d=1;if(e.has("Domain")){var f=e.getArray("Domain");h=f[0],d=f[1]}var p=!1,m=!1;if(e.has("Extend")){var v=e.getArray("Extend");p=v[0],m=v[1]}if(this.shadingType===l&&(!p||!m)){var b=this.coordsArr[0],y=this.coordsArr[1],w=this.coordsArr[2],S=this.coordsArr[3],C=this.coordsArr[4],k=this.coordsArr[5],x=Math.sqrt((b-S)*(b-S)+(y-C)*(y-C));w<=k+x&&k<=w+x&&(0,n.warn)("Unsupported radial gradient.")}this.extendStart=p,this.extendEnd=m;var E=e.getRaw("Function"),T=a.createFromArray(E);const _=(d-h)/10;var A=this.colorStops=[];if(h>=d||_<=0)(0,n.info)("Bad shading domain.");else{var R,O=new Float32Array(c.numComps),M=new Float32Array(1);for(let e=0;e<=10;e++){M[0]=h+e*_,T(M,0,O,0),R=c.getRgb(O,0);var I=n.Util.makeCssRgb(R[0],R[1],R[2]);A.push([e/10,I])}var P="transparent";e.has("Background")&&(R=c.getRgb(e.get("Background"),0),P=n.Util.makeCssRgb(R[0],R[1],R[2])),p||(A.unshift([0,P]),A[1][0]+=g.SMALL_NUMBER),m||(A[A.length-1][0]-=g.SMALL_NUMBER,A.push([1,P])),this.colorStops=A}}return e.prototype={getIR:function(){var e,t,r,i,o,a=this.coordsArr,c=this.shadingType;c===s?(t=[a[0],a[1]],r=[a[2],a[3]],i=null,o=null,e="axial"):c===l?(t=[a[0],a[1]],r=[a[3],a[4]],i=a[2],o=a[5],e="radial"):(0,n.unreachable)(`getPattern type unknown: ${c}`);var u=this.matrix;if(u&&(t=n.Util.applyTransform(t,u),r=n.Util.applyTransform(r,u),c===l)){var h=n.Util.singularValueDecompose2dScale(u);i*=h[0],o*=h[1]}return["RadialAxial",e,this.bbox,this.colorStops,t,r,i,o]}},e}(),g.Mesh=function(){function e(e,t){this.stream=e,this.context=t,this.buffer=0,this.bufferLength=0;var r=t.numComps;this.tmpCompsBuf=new Float32Array(r);var n=t.colorSpace.numComps;this.tmpCsCompsBuf=t.colorFn?new Float32Array(n):this.tmpCompsBuf}e.prototype={get hasData(){if(this.stream.end)return this.stream.pos<this.stream.end;if(this.bufferLength>0)return!0;var e=this.stream.getByte();return!(e<0)&&(this.buffer=e,this.bufferLength=8,!0)},readBits:function(e){var t=this.buffer,r=this.bufferLength;if(32===e){if(0===r)return(this.stream.getByte()<<24|this.stream.getByte()<<16|this.stream.getByte()<<8|this.stream.getByte())>>>0;t=t<<24|this.stream.getByte()<<16|this.stream.getByte()<<8|this.stream.getByte();var n=this.stream.getByte();return this.buffer=n&(1<<r)-1,(t<<8-r|(255&n)>>r)>>>0}if(8===e&&0===r)return this.stream.getByte();for(;r<e;)t=t<<8|this.stream.getByte(),r+=8;return r-=e,this.bufferLength=r,this.buffer=t&(1<<r)-1,t>>r},align:function(){this.buffer=0,this.bufferLength=0},readFlag:function(){return this.readBits(this.context.bitsPerFlag)},readCoordinate:function(){var e=this.context.bitsPerCoordinate,t=this.readBits(e),r=this.readBits(e),n=this.context.decode,i=e<32?1/((1<<e)-1):2.3283064365386963e-10;return[t*i*(n[1]-n[0])+n[0],r*i*(n[3]-n[2])+n[2]]},readComponents:function(){for(var e=this.context.numComps,t=this.context.bitsPerComponent,r=t<32?1/((1<<t)-1):2.3283064365386963e-10,n=this.context.decode,i=this.tmpCompsBuf,o=0,a=4;o<e;o++,a+=2){var s=this.readBits(t);i[o]=s*r*(n[a+1]-n[a])+n[a]}var l=this.tmpCsCompsBuf;return this.context.colorFn&&this.context.colorFn(i,0,l,0),this.context.colorSpace.getRgb(l,0)}};var t=3,r=20,a=20,s=function(){var e=[];return function(t){return e[t]||(e[t]=function(e){for(var t=[],r=0;r<=e;r++){var n=r/e,i=1-n;t.push(new Float32Array([i*i*i,3*n*i*i,3*n*n*i,n*n*n]))}return t}(t)),e[t]}}();function l(e,i){var o=e.figures[i];(0,n.assert)("patch"===o.type,"Unexpected patch mesh figure");var l=e.coords,c=e.colors,u=o.coords,h=o.colors,d=Math.min(l[u[0]][0],l[u[3]][0],l[u[12]][0],l[u[15]][0]),f=Math.min(l[u[0]][1],l[u[3]][1],l[u[12]][1],l[u[15]][1]),g=Math.max(l[u[0]][0],l[u[3]][0],l[u[12]][0],l[u[15]][0]),p=Math.max(l[u[0]][1],l[u[3]][1],l[u[12]][1],l[u[15]][1]),m=Math.ceil((g-d)*a/(e.bounds[2]-e.bounds[0]));m=Math.max(t,Math.min(r,m));var v=Math.ceil((p-f)*a/(e.bounds[3]-e.bounds[1]));v=Math.max(t,Math.min(r,v));for(var b=m+1,y=new Int32Array((v+1)*b),w=new Int32Array((v+1)*b),S=0,C=new Uint8Array(3),k=new Uint8Array(3),x=c[h[0]],E=c[h[1]],T=c[h[2]],_=c[h[3]],A=s(v),R=s(m),O=0;O<=v;O++){C[0]=(x[0]*(v-O)+T[0]*O)/v|0,C[1]=(x[1]*(v-O)+T[1]*O)/v|0,C[2]=(x[2]*(v-O)+T[2]*O)/v|0,k[0]=(E[0]*(v-O)+_[0]*O)/v|0,k[1]=(E[1]*(v-O)+_[1]*O)/v|0,k[2]=(E[2]*(v-O)+_[2]*O)/v|0;for(var M=0;M<=m;M++,S++)if(0!==O&&O!==v||0!==M&&M!==m){for(var I=0,P=0,N=0,D=0;D<=3;D++)for(var F=0;F<=3;F++,N++){var L=A[O][D]*R[M][F];I+=l[u[N]][0]*L,P+=l[u[N]][1]*L}y[S]=l.length,l.push([I,P]),w[S]=c.length;var H=new Uint8Array(3);H[0]=(C[0]*(m-M)+k[0]*M)/m|0,H[1]=(C[1]*(m-M)+k[1]*M)/m|0,H[2]=(C[2]*(m-M)+k[2]*M)/m|0,c.push(H)}}y[0]=u[0],w[0]=h[0],y[m]=u[3],w[m]=h[1],y[b*v]=u[12],w[b*v]=h[2],y[b*v+m]=u[15],w[b*v+m]=h[3],e.figures[i]={type:"lattice",coords:y,colors:w,verticesPerRow:b}}function f(e){for(var t=e.coords[0][0],r=e.coords[0][1],n=t,i=r,o=1,a=e.coords.length;o<a;o++){var s=e.coords[o][0],l=e.coords[o][1];t=t>s?s:t,r=r>l?l:r,n=n<s?s:n,i=i<l?l:i}e.bounds=[t,r,n,i]}function g(t,r,a,s,g,p){if(!(0,o.isStream)(t))throw new n.FormatError("Mesh data is not a stream");var m=t.dict;this.matrix=r,this.shadingType=m.get("ShadingType"),this.type="Pattern";const v=m.getArray("BBox");Array.isArray(v)&&4===v.length?this.bbox=n.Util.normalizeRect(v):this.bbox=null;const b=i.ColorSpace.parse({cs:m.getRaw("ColorSpace")||m.getRaw("CS"),xref:a,resources:s,pdfFunctionFactory:g,localColorSpaceCache:p});this.cs=b,this.background=m.has("Background")?b.getRgb(m.get("Background"),0):null;var y=m.getRaw("Function"),w=y?g.createFromArray(y):null;this.coords=[],this.colors=[],this.figures=[];var S=new e(t,{bitsPerCoordinate:m.get("BitsPerCoordinate"),bitsPerComponent:m.get("BitsPerComponent"),bitsPerFlag:m.get("BitsPerFlag"),decode:m.getArray("Decode"),colorFn:w,colorSpace:b,numComps:w?1:b.numComps}),C=!1;switch(this.shadingType){case c:!function(e,t){for(var r=e.coords,i=e.colors,o=[],a=[],s=0;t.hasData;){var l=t.readFlag(),c=t.readCoordinate(),u=t.readComponents();if(0===s){if(!(0<=l&&l<=2))throw new n.FormatError("Unknown type4 flag");switch(l){case 0:s=3;break;case 1:a.push(a[a.length-2],a[a.length-1]),s=1;break;case 2:a.push(a[a.length-3],a[a.length-1]),s=1}o.push(l)}a.push(r.length),r.push(c),i.push(u),s--,t.align()}e.figures.push({type:"triangles",coords:new Int32Array(a),colors:new Int32Array(a)})}(this,S);break;case u:var k=0|m.get("VerticesPerRow");if(k<2)throw new n.FormatError("Invalid VerticesPerRow");!function(e,t,r){for(var n=e.coords,i=e.colors,o=[];t.hasData;){var a=t.readCoordinate(),s=t.readComponents();o.push(n.length),n.push(a),i.push(s)}e.figures.push({type:"lattice",coords:new Int32Array(o),colors:new Int32Array(o),verticesPerRow:r})}(this,S,k);break;case h:!function(e,t){for(var r=e.coords,i=e.colors,o=new Int32Array(16),a=new Int32Array(4);t.hasData;){var s,l,c=t.readFlag();if(!(0<=c&&c<=3))throw new n.FormatError("Unknown type6 flag");var u=r.length;for(s=0,l=0!==c?8:12;s<l;s++)r.push(t.readCoordinate());var h,d,f,g,p=i.length;for(s=0,l=0!==c?2:4;s<l;s++)i.push(t.readComponents());switch(c){case 0:o[12]=u+3,o[13]=u+4,o[14]=u+5,o[15]=u+6,o[8]=u+2,o[11]=u+7,o[4]=u+1,o[7]=u+8,o[0]=u,o[1]=u+11,o[2]=u+10,o[3]=u+9,a[2]=p+1,a[3]=p+2,a[0]=p,a[1]=p+3;break;case 1:h=o[12],d=o[13],f=o[14],g=o[15],o[12]=g,o[13]=u+0,o[14]=u+1,o[15]=u+2,o[8]=f,o[11]=u+3,o[4]=d,o[7]=u+4,o[0]=h,o[1]=u+7,o[2]=u+6,o[3]=u+5,h=a[2],d=a[3],a[2]=d,a[3]=p,a[0]=h,a[1]=p+1;break;case 2:h=o[15],d=o[11],o[12]=o[3],o[13]=u+0,o[14]=u+1,o[15]=u+2,o[8]=o[7],o[11]=u+3,o[4]=d,o[7]=u+4,o[0]=h,o[1]=u+7,o[2]=u+6,o[3]=u+5,h=a[3],a[2]=a[1],a[3]=p,a[0]=h,a[1]=p+1;break;case 3:o[12]=o[0],o[13]=u+0,o[14]=u+1,o[15]=u+2,o[8]=o[1],o[11]=u+3,o[4]=o[2],o[7]=u+4,o[0]=o[3],o[1]=u+7,o[2]=u+6,o[3]=u+5,a[2]=a[0],a[3]=p,a[0]=a[1],a[1]=p+1}o[5]=r.length,r.push([(-4*r[o[0]][0]-r[o[15]][0]+6*(r[o[4]][0]+r[o[1]][0])-2*(r[o[12]][0]+r[o[3]][0])+3*(r[o[13]][0]+r[o[7]][0]))/9,(-4*r[o[0]][1]-r[o[15]][1]+6*(r[o[4]][1]+r[o[1]][1])-2*(r[o[12]][1]+r[o[3]][1])+3*(r[o[13]][1]+r[o[7]][1]))/9]),o[6]=r.length,r.push([(-4*r[o[3]][0]-r[o[12]][0]+6*(r[o[2]][0]+r[o[7]][0])-2*(r[o[0]][0]+r[o[15]][0])+3*(r[o[4]][0]+r[o[14]][0]))/9,(-4*r[o[3]][1]-r[o[12]][1]+6*(r[o[2]][1]+r[o[7]][1])-2*(r[o[0]][1]+r[o[15]][1])+3*(r[o[4]][1]+r[o[14]][1]))/9]),o[9]=r.length,r.push([(-4*r[o[12]][0]-r[o[3]][0]+6*(r[o[8]][0]+r[o[13]][0])-2*(r[o[0]][0]+r[o[15]][0])+3*(r[o[11]][0]+r[o[1]][0]))/9,(-4*r[o[12]][1]-r[o[3]][1]+6*(r[o[8]][1]+r[o[13]][1])-2*(r[o[0]][1]+r[o[15]][1])+3*(r[o[11]][1]+r[o[1]][1]))/9]),o[10]=r.length,r.push([(-4*r[o[15]][0]-r[o[0]][0]+6*(r[o[11]][0]+r[o[14]][0])-2*(r[o[12]][0]+r[o[3]][0])+3*(r[o[2]][0]+r[o[8]][0]))/9,(-4*r[o[15]][1]-r[o[0]][1]+6*(r[o[11]][1]+r[o[14]][1])-2*(r[o[12]][1]+r[o[3]][1])+3*(r[o[2]][1]+r[o[8]][1]))/9]),e.figures.push({type:"patch",coords:new Int32Array(o),colors:new Int32Array(a)})}}(this,S),C=!0;break;case d:!function(e,t){for(var r=e.coords,i=e.colors,o=new Int32Array(16),a=new Int32Array(4);t.hasData;){var s,l,c=t.readFlag();if(!(0<=c&&c<=3))throw new n.FormatError("Unknown type7 flag");var u=r.length;for(s=0,l=0!==c?12:16;s<l;s++)r.push(t.readCoordinate());var h,d,f,g,p=i.length;for(s=0,l=0!==c?2:4;s<l;s++)i.push(t.readComponents());switch(c){case 0:o[12]=u+3,o[13]=u+4,o[14]=u+5,o[15]=u+6,o[8]=u+2,o[9]=u+13,o[10]=u+14,o[11]=u+7,o[4]=u+1,o[5]=u+12,o[6]=u+15,o[7]=u+8,o[0]=u,o[1]=u+11,o[2]=u+10,o[3]=u+9,a[2]=p+1,a[3]=p+2,a[0]=p,a[1]=p+3;break;case 1:h=o[12],d=o[13],f=o[14],g=o[15],o[12]=g,o[13]=u+0,o[14]=u+1,o[15]=u+2,o[8]=f,o[9]=u+9,o[10]=u+10,o[11]=u+3,o[4]=d,o[5]=u+8,o[6]=u+11,o[7]=u+4,o[0]=h,o[1]=u+7,o[2]=u+6,o[3]=u+5,h=a[2],d=a[3],a[2]=d,a[3]=p,a[0]=h,a[1]=p+1;break;case 2:h=o[15],d=o[11],o[12]=o[3],o[13]=u+0,o[14]=u+1,o[15]=u+2,o[8]=o[7],o[9]=u+9,o[10]=u+10,o[11]=u+3,o[4]=d,o[5]=u+8,o[6]=u+11,o[7]=u+4,o[0]=h,o[1]=u+7,o[2]=u+6,o[3]=u+5,h=a[3],a[2]=a[1],a[3]=p,a[0]=h,a[1]=p+1;break;case 3:o[12]=o[0],o[13]=u+0,o[14]=u+1,o[15]=u+2,o[8]=o[1],o[9]=u+9,o[10]=u+10,o[11]=u+3,o[4]=o[2],o[5]=u+8,o[6]=u+11,o[7]=u+4,o[0]=o[3],o[1]=u+7,o[2]=u+6,o[3]=u+5,a[2]=a[0],a[3]=p,a[0]=a[1],a[1]=p+1}e.figures.push({type:"patch",coords:new Int32Array(o),colors:new Int32Array(a)})}}(this,S),C=!0;break;default:(0,n.unreachable)("Unsupported mesh type.")}if(C){f(this);for(var x=0,E=this.figures.length;x<E;x++)l(this,x)}f(this),function(e){var t,r,n,i,o=e.coords,a=new Float32Array(2*o.length);for(t=0,n=0,r=o.length;t<r;t++){var s=o[t];a[n++]=s[0],a[n++]=s[1]}e.coords=a;var l=e.colors,c=new Uint8Array(3*l.length);for(t=0,n=0,r=l.length;t<r;t++){var u=l[t];c[n++]=u[0],c[n++]=u[1],c[n++]=u[2]}e.colors=c;var h=e.figures;for(t=0,r=h.length;t<r;t++){var d=h[t],f=d.coords,g=d.colors;for(n=0,i=f.length;n<i;n++)f[n]*=2,g[n]*=3}}(this)}return g.prototype={getIR:function(){return["Mesh",this.shadingType,this.coords,this.colors,this.figures,this.bounds,this.matrix,this.bbox,this.background]}},g}(),g.Dummy=function(){function e(){this.type="Pattern"}return e.prototype={getIR:function(){return["Dummy"]}},e}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isPDFFunction=function(e){var t;if("object"!==typeof e)return!1;if((0,n.isDict)(e))t=e;else{if(!(0,n.isStream)(e))return!1;t=e.dict}return t.has("FunctionType")},t.PostScriptCompiler=t.PostScriptEvaluator=t.PDFFunctionFactory=void 0;var n=r(5),i=r(2),o=r(42),a=r(24);function s(e){if(!Array.isArray(e))return null;const t=e.length;for(let r=0;r<t;r++)if("number"!==typeof e[r]){const r=new Array(t);for(let n=0;n<t;n++)r[n]=+e[n];return r}return e}t.PDFFunctionFactory=class{constructor(e){let{xref:t,isEvalSupported:r=!0}=e;this.xref=t,this.isEvalSupported=!1!==r,this._localFunctionCache=null}create(e){const t=this.getCached(e);if(t)return t;const r=l.parse({xref:this.xref,isEvalSupported:this.isEvalSupported,fn:e instanceof n.Ref?this.xref.fetch(e):e});return this._cache(e,r),r}createFromArray(e){const t=this.getCached(e);if(t)return t;const r=l.parseArray({xref:this.xref,isEvalSupported:this.isEvalSupported,fnObj:e instanceof n.Ref?this.xref.fetch(e):e});return this._cache(e,r),r}getCached(e){let t;if(e instanceof n.Ref?t=e:e instanceof n.Dict?t=e.objId:(0,n.isStream)(e)&&(t=e.dict&&e.dict.objId),t){this._localFunctionCache||(this._localFunctionCache=new a.LocalFunctionCache);const e=this._localFunctionCache.getByRef(t);if(e)return e}return null}_cache(e,t){if(!t)throw new Error('PDFFunctionFactory._cache - expected "parsedFunction" argument.');let r;e instanceof n.Ref?r=e:e instanceof n.Dict?r=e.objId:(0,n.isStream)(e)&&(r=e.dict&&e.dict.objId),r&&(this._localFunctionCache||(this._localFunctionCache=new a.LocalFunctionCache),this._localFunctionCache.set(null,r,t))}};var l={getSampleArray(e,t,r,n){var i,o,a=1;for(i=0,o=e.length;i<o;i++)a*=e[i];a*=t;var s=new Array(a),l=0,c=0,u=1/(2**r-1),h=n.getBytes((a*r+7)/8),d=0;for(i=0;i<a;i++){for(;l<r;)c<<=8,c|=h[d++],l+=8;l-=r,s[i]=(c>>l)*u,c&=(1<<l)-1}return s},getIR(e){let{xref:t,isEvalSupported:r,fn:n}=e;var o=n.dict;o||(o=n);var a=[this.constructSampled,null,this.constructInterpolated,this.constructStiched,this.constructPostScript][o.get("FunctionType")];if(!a)throw new i.FormatError("Unknown type of function");return a.call(this,{xref:t,isEvalSupported:r,fn:n,dict:o})},fromIR(e){let{xref:t,isEvalSupported:r,IR:n}=e;switch(n[0]){case 0:return this.constructSampledFromIR({xref:t,isEvalSupported:r,IR:n});case 2:return this.constructInterpolatedFromIR({xref:t,isEvalSupported:r,IR:n});case 3:return this.constructStichedFromIR({xref:t,isEvalSupported:r,IR:n});default:return this.constructPostScriptFromIR({xref:t,isEvalSupported:r,IR:n})}},parse(e){let{xref:t,isEvalSupported:r,fn:n}=e;const i=this.getIR({xref:t,isEvalSupported:r,fn:n});return this.fromIR({xref:t,isEvalSupported:r,IR:i})},parseArray(e){let{xref:t,isEvalSupported:r,fnObj:n}=e;if(!Array.isArray(n))return this.parse({xref:t,isEvalSupported:r,fn:n});for(var i=[],o=0,a=n.length;o<a;o++)i.push(this.parse({xref:t,isEvalSupported:r,fn:t.fetchIfRef(n[o])}));return function(e,t,r,n){for(var o=0,a=i.length;o<a;o++)i[o](e,t,r,n+o)}},constructSampled(e){let{xref:t,isEvalSupported:r,fn:n,dict:o}=e;function a(e){for(var t=e.length,r=[],n=0,i=0;i<t;i+=2)r[n]=[e[i],e[i+1]],++n;return r}var l=s(o.getArray("Domain")),c=s(o.getArray("Range"));if(!l||!c)throw new i.FormatError("No domain or range");var u=l.length/2,h=c.length/2;l=a(l),c=a(c);var d=s(o.getArray("Size")),f=o.get("BitsPerSample"),g=o.get("Order")||1;1!==g&&(0,i.info)("No support for cubic spline interpolation: "+g);var p=s(o.getArray("Encode"));if(p)p=a(p);else{p=[];for(var m=0;m<u;++m)p.push([0,d[m]-1])}var v=s(o.getArray("Decode"));return[0,u,l,p,v=v?a(v):c,this.getSampleArray(d,h,f,n),d,h,2**f-1,c]},constructSampledFromIR(e){let{xref:t,isEvalSupported:r,IR:n}=e;function i(e,t,r,n,i){return n+(i-n)/(r-t)*(e-t)}return function(e,t,r,o){var a,s,l=n[1],c=n[2],u=n[3],h=n[4],d=n[5],f=n[6],g=n[7],p=n[9],m=1<<l,v=new Float64Array(m),b=new Uint32Array(m);for(s=0;s<m;s++)v[s]=1;var y=g,w=1;for(a=0;a<l;++a){var S=c[a][0],C=c[a][1],k=i(Math.min(Math.max(e[t+a],S),C),S,C,u[a][0],u[a][1]),x=f[a],E=(k=Math.min(Math.max(k,0),x-1))<x-1?Math.floor(k):k-1,T=E+1-k,_=k-E,A=E*y,R=A+y;for(s=0;s<m;s++)s&w?(v[s]*=_,b[s]+=R):(v[s]*=T,b[s]+=A);y*=x,w<<=1}for(s=0;s<g;++s){var O=0;for(a=0;a<m;a++)O+=d[b[a]+s]*v[a];O=i(O,0,1,h[s][0],h[s][1]),r[o+s]=Math.min(Math.max(O,p[s][0]),p[s][1])}}},constructInterpolated(e){let{xref:t,isEvalSupported:r,fn:n,dict:i}=e;for(var o=s(i.getArray("C0"))||[0],a=s(i.getArray("C1"))||[1],l=i.get("N"),c=o.length,u=[],h=0;h<c;++h)u.push(a[h]-o[h]);return[2,o,u,l]},constructInterpolatedFromIR(e){let{xref:t,isEvalSupported:r,IR:n}=e;var i=n[1],o=n[2],a=n[3],s=o.length;return function(e,t,r,n){for(var l=1===a?e[t]:e[t]**a,c=0;c<s;++c)r[n+c]=i[c]+l*o[c]}},constructStiched(e){let{xref:t,isEvalSupported:r,fn:n,dict:o}=e;var a=s(o.getArray("Domain"));if(!a)throw new i.FormatError("No domain");if(1!==a.length/2)throw new i.FormatError("Bad domain for stiched function");for(var l=o.get("Functions"),c=[],u=0,h=l.length;u<h;++u)c.push(this.parse({xref:t,isEvalSupported:r,fn:t.fetchIfRef(l[u])}));return[3,a,s(o.getArray("Bounds")),s(o.getArray("Encode")),c]},constructStichedFromIR(e){let{xref:t,isEvalSupported:r,IR:n}=e;var i=n[1],o=n[2],a=n[3],s=n[4],l=new Float32Array(1);return function(e,t,r,n){for(var c=function(e,t,r){return e>r?e=r:e<t&&(e=t),e}(e[t],i[0],i[1]),u=0,h=o.length;u<h&&!(c<o[u]);++u);var d=i[0];u>0&&(d=o[u-1]);var f=i[1];u<o.length&&(f=o[u]);var g=a[2*u],p=a[2*u+1];l[0]=d===f?g:g+(c-d)*(p-g)/(f-d),s[u](l,0,r,n)}},constructPostScript(e){let{xref:t,isEvalSupported:r,fn:n,dict:a}=e;var l=s(a.getArray("Domain")),c=s(a.getArray("Range"));if(!l)throw new i.FormatError("No domain.");if(!c)throw new i.FormatError("No range.");var u=new o.PostScriptLexer(n);return[4,l,c,new o.PostScriptParser(u).parse()]},constructPostScriptFromIR(e){let{xref:t,isEvalSupported:r,IR:n}=e;var o=n[1],a=n[2],s=n[3];if(r&&i.IsEvalSupportedCached.value){const e=(new h).compile(s,o,a);if(e)return new Function("src","srcOffset","dest","destOffset",e)}(0,i.info)("Unable to compile PS function");var l=a.length>>1,c=o.length>>1,d=new u(s),f=Object.create(null),g=8192,p=new Float32Array(c);return function(e,t,r,n){var i,o,s="",u=p;for(i=0;i<c;i++)o=e[t+i],u[i]=o,s+=o+"_";var h=f[s];if(void 0===h){var m=new Float32Array(l),v=d.execute(u),b=v.length-l;for(i=0;i<l;i++){o=v[b+i];var y=a[2*i];(o<y||o>(y=a[2*i+1]))&&(o=y),m[i]=o}g>0&&(g--,f[s]=m),r.set(m,n)}else r.set(h,n)}}},c=function(){function e(e){this.stack=e?Array.prototype.slice.call(e,0):[]}return e.prototype={push:function(e){if(this.stack.length>=100)throw new Error("PostScript function stack overflow.");this.stack.push(e)},pop:function(){if(this.stack.length<=0)throw new Error("PostScript function stack underflow.");return this.stack.pop()},copy:function(e){if(this.stack.length+e>=100)throw new Error("PostScript function stack overflow.");for(var t=this.stack,r=t.length-e,n=e-1;n>=0;n--,r++)t.push(t[r])},index:function(e){this.push(this.stack[this.stack.length-e-1])},roll:function(e,t){var r,n,i,o=this.stack,a=o.length-e,s=o.length-1,l=a+(t-Math.floor(t/e)*e);for(r=a,n=s;r<n;r++,n--)i=o[r],o[r]=o[n],o[n]=i;for(r=a,n=l-1;r<n;r++,n--)i=o[r],o[r]=o[n],o[n]=i;for(r=l,n=s;r<n;r++,n--)i=o[r],o[r]=o[n],o[n]=i}},e}(),u=function(){function e(e){this.operators=e}return e.prototype={execute:function(e){for(var t,r,n,o=new c(e),a=0,s=this.operators,l=s.length;a<l;)if("number"!==typeof(t=s[a++]))switch(t){case"jz":n=o.pop(),(r=o.pop())||(a=n);break;case"j":a=r=o.pop();break;case"abs":r=o.pop(),o.push(Math.abs(r));break;case"add":n=o.pop(),r=o.pop(),o.push(r+n);break;case"and":n=o.pop(),r=o.pop(),(0,i.isBool)(r)&&(0,i.isBool)(n)?o.push(r&&n):o.push(r&n);break;case"atan":r=o.pop(),o.push(Math.atan(r));break;case"bitshift":n=o.pop(),(r=o.pop())>0?o.push(r<<n):o.push(r>>n);break;case"ceiling":r=o.pop(),o.push(Math.ceil(r));break;case"copy":r=o.pop(),o.copy(r);break;case"cos":r=o.pop(),o.push(Math.cos(r));break;case"cvi":r=0|o.pop(),o.push(r);break;case"cvr":break;case"div":n=o.pop(),r=o.pop(),o.push(r/n);break;case"dup":o.copy(1);break;case"eq":n=o.pop(),r=o.pop(),o.push(r===n);break;case"exch":o.roll(2,1);break;case"exp":n=o.pop(),r=o.pop(),o.push(r**n);break;case"false":o.push(!1);break;case"floor":r=o.pop(),o.push(Math.floor(r));break;case"ge":n=o.pop(),r=o.pop(),o.push(r>=n);break;case"gt":n=o.pop(),r=o.pop(),o.push(r>n);break;case"idiv":n=o.pop(),r=o.pop(),o.push(r/n|0);break;case"index":r=o.pop(),o.index(r);break;case"le":n=o.pop(),r=o.pop(),o.push(r<=n);break;case"ln":r=o.pop(),o.push(Math.log(r));break;case"log":r=o.pop(),o.push(Math.log(r)/Math.LN10);break;case"lt":n=o.pop(),r=o.pop(),o.push(r<n);break;case"mod":n=o.pop(),r=o.pop(),o.push(r%n);break;case"mul":n=o.pop(),r=o.pop(),o.push(r*n);break;case"ne":n=o.pop(),r=o.pop(),o.push(r!==n);break;case"neg":r=o.pop(),o.push(-r);break;case"not":r=o.pop(),(0,i.isBool)(r)?o.push(!r):o.push(~r);break;case"or":n=o.pop(),r=o.pop(),(0,i.isBool)(r)&&(0,i.isBool)(n)?o.push(r||n):o.push(r|n);break;case"pop":o.pop();break;case"roll":n=o.pop(),r=o.pop(),o.roll(r,n);break;case"round":r=o.pop(),o.push(Math.round(r));break;case"sin":r=o.pop(),o.push(Math.sin(r));break;case"sqrt":r=o.pop(),o.push(Math.sqrt(r));break;case"sub":n=o.pop(),r=o.pop(),o.push(r-n);break;case"true":o.push(!0);break;case"truncate":r=(r=o.pop())<0?Math.ceil(r):Math.floor(r),o.push(r);break;case"xor":n=o.pop(),r=o.pop(),(0,i.isBool)(r)&&(0,i.isBool)(n)?o.push(r!==n):o.push(r^n);break;default:throw new i.FormatError(`Unknown operator ${t}`)}else o.push(t);return o.stack}},e}();t.PostScriptEvaluator=u;var h=function(){function e(e){this.type=e}function t(t,r,n){e.call(this,"args"),this.index=t,this.min=r,this.max=n}function r(t){e.call(this,"literal"),this.number=t,this.min=t,this.max=t}function n(t,r,n,i,o){e.call(this,"binary"),this.op=t,this.arg1=r,this.arg2=n,this.min=i,this.max=o}function o(t,r){e.call(this,"max"),this.arg=t,this.min=t.min,this.max=r}function a(t,r,n){e.call(this,"var"),this.index=t,this.min=r,this.max=n}function s(t,r){e.call(this,"definition"),this.variable=t,this.arg=r}function l(){this.parts=[]}function c(e,t){return"literal"===t.type&&0===t.number?e:"literal"===e.type&&0===e.number?t:"literal"===t.type&&"literal"===e.type?new r(e.number+t.number):new n("+",e,t,e.min+t.min,e.max+t.max)}function u(e,t){if("literal"===t.type){if(0===t.number)return new r(0);if(1===t.number)return e;if("literal"===e.type)return new r(e.number*t.number)}if("literal"===e.type){if(0===e.number)return new r(0);if(1===e.number)return t}return new n("*",e,t,Math.min(e.min*t.min,e.min*t.max,e.max*t.min,e.max*t.max),Math.max(e.min*t.min,e.min*t.max,e.max*t.min,e.max*t.max))}function h(e,t){if("literal"===t.type){if(0===t.number)return e;if("literal"===e.type)return new r(e.number-t.number)}return"binary"===t.type&&"-"===t.op&&"literal"===e.type&&1===e.number&&"literal"===t.arg1.type&&1===t.arg1.number?t.arg2:new n("-",e,t,e.min-t.max,e.max-t.min)}function d(e,t){return e.min>=t?new r(t):e.max<=t?e:new o(e,t)}function f(){}return e.prototype.visit=function(e){(0,i.unreachable)("abstract method")},t.prototype=Object.create(e.prototype),t.prototype.visit=function(e){e.visitArgument(this)},r.prototype=Object.create(e.prototype),r.prototype.visit=function(e){e.visitLiteral(this)},n.prototype=Object.create(e.prototype),n.prototype.visit=function(e){e.visitBinaryOperation(this)},o.prototype=Object.create(e.prototype),o.prototype.visit=function(e){e.visitMin(this)},a.prototype=Object.create(e.prototype),a.prototype.visit=function(e){e.visitVariable(this)},s.prototype=Object.create(e.prototype),s.prototype.visit=function(e){e.visitVariableDefinition(this)},l.prototype={visitArgument(e){this.parts.push("Math.max(",e.min,", Math.min(",e.max,", src[srcOffset + ",e.index,"]))")},visitVariable(e){this.parts.push("v",e.index)},visitLiteral(e){this.parts.push(e.number)},visitBinaryOperation(e){this.parts.push("("),e.arg1.visit(this),this.parts.push(" ",e.op," "),e.arg2.visit(this),this.parts.push(")")},visitVariableDefinition(e){this.parts.push("var "),e.variable.visit(this),this.parts.push(" = "),e.arg.visit(this),this.parts.push(";")},visitMin(e){this.parts.push("Math.min("),e.arg.visit(this),this.parts.push(", ",e.max,")")},toString(){return this.parts.join("")}},f.prototype={compile:function(e,n,i){var o,f,g,p,m,v,b,y,w=[],S=[],C=n.length>>1,k=i.length>>1,x=0;for(let r=0;r<C;r++)w.push(new t(r,n[2*r],n[2*r+1]));for(let t=0,l=e.length;t<l;t++)if("number"!==typeof(y=e[t]))switch(y){case"add":if(w.length<2)return null;p=w.pop(),g=w.pop(),w.push(c(g,p));break;case"cvr":if(w.length<1)return null;break;case"mul":if(w.length<2)return null;p=w.pop(),g=w.pop(),w.push(u(g,p));break;case"sub":if(w.length<2)return null;p=w.pop(),g=w.pop(),w.push(h(g,p));break;case"exch":if(w.length<2)return null;m=w.pop(),v=w.pop(),w.push(m,v);break;case"pop":if(w.length<1)return null;w.pop();break;case"index":if(w.length<1)return null;if("literal"!==(g=w.pop()).type)return null;if((o=g.number)<0||!Number.isInteger(o)||w.length<o)return null;if("literal"===(m=w[w.length-o-1]).type||"var"===m.type){w.push(m);break}b=new a(x++,m.min,m.max),w[w.length-o-1]=b,w.push(b),S.push(new s(b,m));break;case"dup":if(w.length<1)return null;if("number"===typeof e[t+1]&&"gt"===e[t+2]&&e[t+3]===t+7&&"jz"===e[t+4]&&"pop"===e[t+5]&&e[t+6]===e[t+1]){g=w.pop(),w.push(d(g,e[t+1])),t+=6;break}if("literal"===(m=w[w.length-1]).type||"var"===m.type){w.push(m);break}b=new a(x++,m.min,m.max),w[w.length-1]=b,w.push(b),S.push(new s(b,m));break;case"roll":if(w.length<2)return null;if(p=w.pop(),g=w.pop(),"literal"!==p.type||"literal"!==g.type)return null;if(f=p.number,(o=g.number)<=0||!Number.isInteger(o)||!Number.isInteger(f)||w.length<o)return null;if(0===(f=(f%o+o)%o))break;Array.prototype.push.apply(w,w.splice(w.length-o,o-f));break;default:return null}else w.push(new r(y));if(w.length!==k)return null;var E=[];return S.forEach((function(e){var t=new l;e.visit(t),E.push(t.toString())})),w.forEach((function(e,t){var r=new l;e.visit(r);var n=i[2*t],o=i[2*t+1],a=[r.toString()];n>e.min&&(a.unshift("Math.max(",n,", "),a.push(")")),o<e.max&&(a.unshift("Math.min(",o,", "),a.push(")")),a.unshift("dest[destOffset + ",t,"] = "),a.push(";"),E.push(a.join(""))})),E.join("\n")}},f}();t.PostScriptCompiler=h},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PostScriptParser=t.PostScriptLexer=void 0;var n=r(2),i=r(5),o=r(8);t.PostScriptParser=class{constructor(e){this.lexer=e,this.operators=[],this.token=null,this.prev=null}nextToken(){this.prev=this.token,this.token=this.lexer.getToken()}accept(e){return this.token.type===e&&(this.nextToken(),!0)}expect(e){if(this.accept(e))return!0;throw new n.FormatError(`Unexpected symbol: found ${this.token.type} expected ${e}.`)}parse(){return this.nextToken(),this.expect(a.LBRACE),this.parseBlock(),this.expect(a.RBRACE),this.operators}parseBlock(){for(;;)if(this.accept(a.NUMBER))this.operators.push(this.prev.value);else if(this.accept(a.OPERATOR))this.operators.push(this.prev.value);else{if(!this.accept(a.LBRACE))return;this.parseCondition()}}parseCondition(){const e=this.operators.length;if(this.operators.push(null,null),this.parseBlock(),this.expect(a.RBRACE),this.accept(a.IF))this.operators[e]=this.operators.length,this.operators[e+1]="jz";else{if(!this.accept(a.LBRACE))throw new n.FormatError("PS Function: error parsing conditional.");{const t=this.operators.length;this.operators.push(null,null);const r=this.operators.length;this.parseBlock(),this.expect(a.RBRACE),this.expect(a.IFELSE),this.operators[t]=this.operators.length,this.operators[t+1]="j",this.operators[e]=r,this.operators[e+1]="jz"}}}};const a={LBRACE:0,RBRACE:1,NUMBER:2,OPERATOR:3,IF:4,IFELSE:5},s=function(){const e=Object.create(null);class t{constructor(e,t){this.type=e,this.value=t}static getOperator(r){const n=e[r];return n||(e[r]=new t(a.OPERATOR,r))}static get LBRACE(){return(0,n.shadow)(this,"LBRACE",new t(a.LBRACE,"{"))}static get RBRACE(){return(0,n.shadow)(this,"RBRACE",new t(a.RBRACE,"}"))}static get IF(){return(0,n.shadow)(this,"IF",new t(a.IF,"IF"))}static get IFELSE(){return(0,n.shadow)(this,"IFELSE",new t(a.IFELSE,"IFELSE"))}}return t}();t.PostScriptLexer=class{constructor(e){this.stream=e,this.nextChar(),this.strBuf=[]}nextChar(){return this.currentChar=this.stream.getByte()}getToken(){let e=!1,t=this.currentChar;for(;;){if(t<0)return i.EOF;if(e)10!==t&&13!==t||(e=!1);else if(37===t)e=!0;else if(!(0,o.isWhiteSpace)(t))break;t=this.nextChar()}switch(0|t){case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:case 43:case 45:case 46:return new s(a.NUMBER,this.getNumber());case 123:return this.nextChar(),s.LBRACE;case 125:return this.nextChar(),s.RBRACE}const r=this.strBuf;for(r.length=0,r[0]=String.fromCharCode(t);(t=this.nextChar())>=0&&(t>=65&&t<=90||t>=97&&t<=122);)r.push(String.fromCharCode(t));const n=r.join("");switch(n.toLowerCase()){case"if":return s.IF;case"ifelse":return s.IFELSE;default:return s.getOperator(n)}}getNumber(){let e=this.currentChar;const t=this.strBuf;for(t.length=0,t[0]=String.fromCharCode(e);(e=this.nextChar())>=0&&(e>=48&&e<=57||45===e||46===e);)t.push(String.fromCharCode(e));const r=parseFloat(t.join(""));if(isNaN(r))throw new n.FormatError(`Invalid floating point number: ${r}`);return r}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.bidi=function(e,t,r){var g=!0,p=e.length;if(0===p||r)return h(e,g,r);d.length=p,f.length=p;var m,v,b=0;for(m=0;m<p;++m){d[m]=e.charAt(m);var y=e.charCodeAt(m),w="L";y<=255?w=i[y]:1424<=y&&y<=1524?w="R":1536<=y&&y<=1791?(w=o[255&y])||(0,n.warn)("Bidi: invalid Unicode character "+y.toString(16)):1792<=y&&y<=2220&&(w="AL"),"R"!==w&&"AL"!==w&&"AN"!==w||b++,f[m]=w}if(0===b)return h(e,g=!0);-1===t&&(b/p<.3?(g=!0,t=0):(g=!1,t=1));var S=[];for(m=0;m<p;++m)S[m]=t;var C,k=a(t)?"R":"L",x=k,E=x,T=x;for(m=0;m<p;++m)"NSM"===f[m]?f[m]=T:T=f[m];for(T=x,m=0;m<p;++m)"EN"===(C=f[m])?f[m]="AL"===T?"AN":"EN":"R"!==C&&"L"!==C&&"AL"!==C||(T=C);for(m=0;m<p;++m)"AL"===(C=f[m])&&(f[m]="R");for(m=1;m<p-1;++m)"ES"===f[m]&&"EN"===f[m-1]&&"EN"===f[m+1]&&(f[m]="EN"),"CS"!==f[m]||"EN"!==f[m-1]&&"AN"!==f[m-1]||f[m+1]!==f[m-1]||(f[m]=f[m-1]);for(m=0;m<p;++m)if("EN"===f[m]){var _;for(_=m-1;_>=0&&"ET"===f[_];--_)f[_]="EN";for(_=m+1;_<p&&"ET"===f[_];++_)f[_]="EN"}for(m=0;m<p;++m)"WS"!==(C=f[m])&&"ES"!==C&&"ET"!==C&&"CS"!==C||(f[m]="ON");for(T=x,m=0;m<p;++m)"EN"===(C=f[m])?f[m]="L"===T?"L":"EN":"R"!==C&&"L"!==C||(T=C);for(m=0;m<p;++m)if("ON"===f[m]){var A=l(f,m+1,"ON"),R=x;m>0&&(R=f[m-1]);var O=E;A+1<p&&(O=f[A+1]),"L"!==R&&(R="R"),"L"!==O&&(O="R"),R===O&&c(f,m,A,R),m=A-1}for(m=0;m<p;++m)"ON"===f[m]&&(f[m]=k);for(m=0;m<p;++m)C=f[m],s(S[m])?"R"===C?S[m]+=1:"AN"!==C&&"EN"!==C||(S[m]+=2):"L"!==C&&"AN"!==C&&"EN"!==C||(S[m]+=1);var M,I=-1,P=99;for(m=0,v=S.length;m<v;++m)I<(M=S[m])&&(I=M),P>M&&a(M)&&(P=M);for(M=I;M>=P;--M){var N=-1;for(m=0,v=S.length;m<v;++m)S[m]<M?N>=0&&(u(d,N,m),N=-1):N<0&&(N=m);N>=0&&u(d,N,S.length)}for(m=0,v=d.length;m<v;++m){var D=d[m];"<"!==D&&">"!==D||(d[m]="")}return h(d.join(""),g)};var n=r(2),i=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","ON","ON","ET","ET","ET","ON","ON","ON","ON","ON","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","ON","ON","ON","ON","ON","ON","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","ON","ON","ON","ON","ON","ON","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","ON","ON","ON","ON","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","ON","ET","ET","ET","ET","ON","ON","ON","ON","L","ON","ON","BN","ON","ON","ET","ET","EN","EN","ON","L","ON","ON","ON","EN","L","ON","ON","ON","ON","ON","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","ON","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","ON","L","L","L","L","L","L","L","L"],o=["AN","AN","AN","AN","AN","AN","ON","ON","AL","ET","ET","AL","CS","AL","ON","ON","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","ON","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","ON","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL"];function a(e){return 0!==(1&e)}function s(e){return 0===(1&e)}function l(e,t,r){for(var n=t,i=e.length;n<i;++n)if(e[n]!==r)return n;return n}function c(e,t,r,n){for(var i=t;i<r;++i)e[i]=n}function u(e,t,r){for(var n=t,i=r-1;n<i;++n,--i){var o=e[n];e[n]=e[i],e[i]=o}}function h(e,t){let r="ltr";return arguments.length>2&&void 0!==arguments[2]&&arguments[2]?r="ttb":t||(r="rtl"),{str:e,dir:r}}var d=[],f=[]},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getMetrics=void 0;var n=r(8),i=(0,n.getLookupTableFactory)((function(e){e.Courier=600,e["Courier-Bold"]=600,e["Courier-BoldOblique"]=600,e["Courier-Oblique"]=600,e.Helvetica=(0,n.getLookupTableFactory)((function(e){e.space=278,e.exclam=278,e.quotedbl=355,e.numbersign=556,e.dollar=556,e.percent=889,e.ampersand=667,e.quoteright=222,e.parenleft=333,e.parenright=333,e.asterisk=389,e.plus=584,e.comma=278,e.hyphen=333,e.period=278,e.slash=278,e.zero=556,e.one=556,e.two=556,e.three=556,e.four=556,e.five=556,e.six=556,e.seven=556,e.eight=556,e.nine=556,e.colon=278,e.semicolon=278,e.less=584,e.equal=584,e.greater=584,e.question=556,e.at=1015,e.A=667,e.B=667,e.C=722,e.D=722,e.E=667,e.F=611,e.G=778,e.H=722,e.I=278,e.J=500,e.K=667,e.L=556,e.M=833,e.N=722,e.O=778,e.P=667,e.Q=778,e.R=722,e.S=667,e.T=611,e.U=722,e.V=667,e.W=944,e.X=667,e.Y=667,e.Z=611,e.bracketleft=278,e.backslash=278,e.bracketright=278,e.asciicircum=469,e.underscore=556,e.quoteleft=222,e.a=556,e.b=556,e.c=500,e.d=556,e.e=556,e.f=278,e.g=556,e.h=556,e.i=222,e.j=222,e.k=500,e.l=222,e.m=833,e.n=556,e.o=556,e.p=556,e.q=556,e.r=333,e.s=500,e.t=278,e.u=556,e.v=500,e.w=722,e.x=500,e.y=500,e.z=500,e.braceleft=334,e.bar=260,e.braceright=334,e.asciitilde=584,e.exclamdown=333,e.cent=556,e.sterling=556,e.fraction=167,e.yen=556,e.florin=556,e.section=556,e.currency=556,e.quotesingle=191,e.quotedblleft=333,e.guillemotleft=556,e.guilsinglleft=333,e.guilsinglright=333,e.fi=500,e.fl=500,e.endash=556,e.dagger=556,e.daggerdbl=556,e.periodcentered=278,e.paragraph=537,e.bullet=350,e.quotesinglbase=222,e.quotedblbase=333,e.quotedblright=333,e.guillemotright=556,e.ellipsis=1e3,e.perthousand=1e3,e.questiondown=611,e.grave=333,e.acute=333,e.circumflex=333,e.tilde=333,e.macron=333,e.breve=333,e.dotaccent=333,e.dieresis=333,e.ring=333,e.cedilla=333,e.hungarumlaut=333,e.ogonek=333,e.caron=333,e.emdash=1e3,e.AE=1e3,e.ordfeminine=370,e.Lslash=556,e.Oslash=778,e.OE=1e3,e.ordmasculine=365,e.ae=889,e.dotlessi=278,e.lslash=222,e.oslash=611,e.oe=944,e.germandbls=611,e.Idieresis=278,e.eacute=556,e.abreve=556,e.uhungarumlaut=556,e.ecaron=556,e.Ydieresis=667,e.divide=584,e.Yacute=667,e.Acircumflex=667,e.aacute=556,e.Ucircumflex=722,e.yacute=500,e.scommaaccent=500,e.ecircumflex=556,e.Uring=722,e.Udieresis=722,e.aogonek=556,e.Uacute=722,e.uogonek=556,e.Edieresis=667,e.Dcroat=722,e.commaaccent=250,e.copyright=737,e.Emacron=667,e.ccaron=500,e.aring=556,e.Ncommaaccent=722,e.lacute=222,e.agrave=556,e.Tcommaaccent=611,e.Cacute=722,e.atilde=556,e.Edotaccent=667,e.scaron=500,e.scedilla=500,e.iacute=278,e.lozenge=471,e.Rcaron=722,e.Gcommaaccent=778,e.ucircumflex=556,e.acircumflex=556,e.Amacron=667,e.rcaron=333,e.ccedilla=500,e.Zdotaccent=611,e.Thorn=667,e.Omacron=778,e.Racute=722,e.Sacute=667,e.dcaron=643,e.Umacron=722,e.uring=556,e.threesuperior=333,e.Ograve=778,e.Agrave=667,e.Abreve=667,e.multiply=584,e.uacute=556,e.Tcaron=611,e.partialdiff=476,e.ydieresis=500,e.Nacute=722,e.icircumflex=278,e.Ecircumflex=667,e.adieresis=556,e.edieresis=556,e.cacute=500,e.nacute=556,e.umacron=556,e.Ncaron=722,e.Iacute=278,e.plusminus=584,e.brokenbar=260,e.registered=737,e.Gbreve=778,e.Idotaccent=278,e.summation=600,e.Egrave=667,e.racute=333,e.omacron=556,e.Zacute=611,e.Zcaron=611,e.greaterequal=549,e.Eth=722,e.Ccedilla=722,e.lcommaaccent=222,e.tcaron=317,e.eogonek=556,e.Uogonek=722,e.Aacute=667,e.Adieresis=667,e.egrave=556,e.zacute=500,e.iogonek=222,e.Oacute=778,e.oacute=556,e.amacron=556,e.sacute=500,e.idieresis=278,e.Ocircumflex=778,e.Ugrave=722,e.Delta=612,e.thorn=556,e.twosuperior=333,e.Odieresis=778,e.mu=556,e.igrave=278,e.ohungarumlaut=556,e.Eogonek=667,e.dcroat=556,e.threequarters=834,e.Scedilla=667,e.lcaron=299,e.Kcommaaccent=667,e.Lacute=556,e.trademark=1e3,e.edotaccent=556,e.Igrave=278,e.Imacron=278,e.Lcaron=556,e.onehalf=834,e.lessequal=549,e.ocircumflex=556,e.ntilde=556,e.Uhungarumlaut=722,e.Eacute=667,e.emacron=556,e.gbreve=556,e.onequarter=834,e.Scaron=667,e.Scommaaccent=667,e.Ohungarumlaut=778,e.degree=400,e.ograve=556,e.Ccaron=722,e.ugrave=556,e.radical=453,e.Dcaron=722,e.rcommaaccent=333,e.Ntilde=722,e.otilde=556,e.Rcommaaccent=722,e.Lcommaaccent=556,e.Atilde=667,e.Aogonek=667,e.Aring=667,e.Otilde=778,e.zdotaccent=500,e.Ecaron=667,e.Iogonek=278,e.kcommaaccent=500,e.minus=584,e.Icircumflex=278,e.ncaron=556,e.tcommaaccent=278,e.logicalnot=584,e.odieresis=556,e.udieresis=556,e.notequal=549,e.gcommaaccent=556,e.eth=556,e.zcaron=500,e.ncommaaccent=556,e.onesuperior=333,e.imacron=278,e.Euro=556})),e["Helvetica-Bold"]=(0,n.getLookupTableFactory)((function(e){e.space=278,e.exclam=333,e.quotedbl=474,e.numbersign=556,e.dollar=556,e.percent=889,e.ampersand=722,e.quoteright=278,e.parenleft=333,e.parenright=333,e.asterisk=389,e.plus=584,e.comma=278,e.hyphen=333,e.period=278,e.slash=278,e.zero=556,e.one=556,e.two=556,e.three=556,e.four=556,e.five=556,e.six=556,e.seven=556,e.eight=556,e.nine=556,e.colon=333,e.semicolon=333,e.less=584,e.equal=584,e.greater=584,e.question=611,e.at=975,e.A=722,e.B=722,e.C=722,e.D=722,e.E=667,e.F=611,e.G=778,e.H=722,e.I=278,e.J=556,e.K=722,e.L=611,e.M=833,e.N=722,e.O=778,e.P=667,e.Q=778,e.R=722,e.S=667,e.T=611,e.U=722,e.V=667,e.W=944,e.X=667,e.Y=667,e.Z=611,e.bracketleft=333,e.backslash=278,e.bracketright=333,e.asciicircum=584,e.underscore=556,e.quoteleft=278,e.a=556,e.b=611,e.c=556,e.d=611,e.e=556,e.f=333,e.g=611,e.h=611,e.i=278,e.j=278,e.k=556,e.l=278,e.m=889,e.n=611,e.o=611,e.p=611,e.q=611,e.r=389,e.s=556,e.t=333,e.u=611,e.v=556,e.w=778,e.x=556,e.y=556,e.z=500,e.braceleft=389,e.bar=280,e.braceright=389,e.asciitilde=584,e.exclamdown=333,e.cent=556,e.sterling=556,e.fraction=167,e.yen=556,e.florin=556,e.section=556,e.currency=556,e.quotesingle=238,e.quotedblleft=500,e.guillemotleft=556,e.guilsinglleft=333,e.guilsinglright=333,e.fi=611,e.fl=611,e.endash=556,e.dagger=556,e.daggerdbl=556,e.periodcentered=278,e.paragraph=556,e.bullet=350,e.quotesinglbase=278,e.quotedblbase=500,e.quotedblright=500,e.guillemotright=556,e.ellipsis=1e3,e.perthousand=1e3,e.questiondown=611,e.grave=333,e.acute=333,e.circumflex=333,e.tilde=333,e.macron=333,e.breve=333,e.dotaccent=333,e.dieresis=333,e.ring=333,e.cedilla=333,e.hungarumlaut=333,e.ogonek=333,e.caron=333,e.emdash=1e3,e.AE=1e3,e.ordfeminine=370,e.Lslash=611,e.Oslash=778,e.OE=1e3,e.ordmasculine=365,e.ae=889,e.dotlessi=278,e.lslash=278,e.oslash=611,e.oe=944,e.germandbls=611,e.Idieresis=278,e.eacute=556,e.abreve=556,e.uhungarumlaut=611,e.ecaron=556,e.Ydieresis=667,e.divide=584,e.Yacute=667,e.Acircumflex=722,e.aacute=556,e.Ucircumflex=722,e.yacute=556,e.scommaaccent=556,e.ecircumflex=556,e.Uring=722,e.Udieresis=722,e.aogonek=556,e.Uacute=722,e.uogonek=611,e.Edieresis=667,e.Dcroat=722,e.commaaccent=250,e.copyright=737,e.Emacron=667,e.ccaron=556,e.aring=556,e.Ncommaaccent=722,e.lacute=278,e.agrave=556,e.Tcommaaccent=611,e.Cacute=722,e.atilde=556,e.Edotaccent=667,e.scaron=556,e.scedilla=556,e.iacute=278,e.lozenge=494,e.Rcaron=722,e.Gcommaaccent=778,e.ucircumflex=611,e.acircumflex=556,e.Amacron=722,e.rcaron=389,e.ccedilla=556,e.Zdotaccent=611,e.Thorn=667,e.Omacron=778,e.Racute=722,e.Sacute=667,e.dcaron=743,e.Umacron=722,e.uring=611,e.threesuperior=333,e.Ograve=778,e.Agrave=722,e.Abreve=722,e.multiply=584,e.uacute=611,e.Tcaron=611,e.partialdiff=494,e.ydieresis=556,e.Nacute=722,e.icircumflex=278,e.Ecircumflex=667,e.adieresis=556,e.edieresis=556,e.cacute=556,e.nacute=611,e.umacron=611,e.Ncaron=722,e.Iacute=278,e.plusminus=584,e.brokenbar=280,e.registered=737,e.Gbreve=778,e.Idotaccent=278,e.summation=600,e.Egrave=667,e.racute=389,e.omacron=611,e.Zacute=611,e.Zcaron=611,e.greaterequal=549,e.Eth=722,e.Ccedilla=722,e.lcommaaccent=278,e.tcaron=389,e.eogonek=556,e.Uogonek=722,e.Aacute=722,e.Adieresis=722,e.egrave=556,e.zacute=500,e.iogonek=278,e.Oacute=778,e.oacute=611,e.amacron=556,e.sacute=556,e.idieresis=278,e.Ocircumflex=778,e.Ugrave=722,e.Delta=612,e.thorn=611,e.twosuperior=333,e.Odieresis=778,e.mu=611,e.igrave=278,e.ohungarumlaut=611,e.Eogonek=667,e.dcroat=611,e.threequarters=834,e.Scedilla=667,e.lcaron=400,e.Kcommaaccent=722,e.Lacute=611,e.trademark=1e3,e.edotaccent=556,e.Igrave=278,e.Imacron=278,e.Lcaron=611,e.onehalf=834,e.lessequal=549,e.ocircumflex=611,e.ntilde=611,e.Uhungarumlaut=722,e.Eacute=667,e.emacron=556,e.gbreve=611,e.onequarter=834,e.Scaron=667,e.Scommaaccent=667,e.Ohungarumlaut=778,e.degree=400,e.ograve=611,e.Ccaron=722,e.ugrave=611,e.radical=549,e.Dcaron=722,e.rcommaaccent=389,e.Ntilde=722,e.otilde=611,e.Rcommaaccent=722,e.Lcommaaccent=611,e.Atilde=722,e.Aogonek=722,e.Aring=722,e.Otilde=778,e.zdotaccent=500,e.Ecaron=667,e.Iogonek=278,e.kcommaaccent=556,e.minus=584,e.Icircumflex=278,e.ncaron=611,e.tcommaaccent=333,e.logicalnot=584,e.odieresis=611,e.udieresis=611,e.notequal=549,e.gcommaaccent=611,e.eth=611,e.zcaron=500,e.ncommaaccent=611,e.onesuperior=333,e.imacron=278,e.Euro=556})),e["Helvetica-BoldOblique"]=(0,n.getLookupTableFactory)((function(e){e.space=278,e.exclam=333,e.quotedbl=474,e.numbersign=556,e.dollar=556,e.percent=889,e.ampersand=722,e.quoteright=278,e.parenleft=333,e.parenright=333,e.asterisk=389,e.plus=584,e.comma=278,e.hyphen=333,e.period=278,e.slash=278,e.zero=556,e.one=556,e.two=556,e.three=556,e.four=556,e.five=556,e.six=556,e.seven=556,e.eight=556,e.nine=556,e.colon=333,e.semicolon=333,e.less=584,e.equal=584,e.greater=584,e.question=611,e.at=975,e.A=722,e.B=722,e.C=722,e.D=722,e.E=667,e.F=611,e.G=778,e.H=722,e.I=278,e.J=556,e.K=722,e.L=611,e.M=833,e.N=722,e.O=778,e.P=667,e.Q=778,e.R=722,e.S=667,e.T=611,e.U=722,e.V=667,e.W=944,e.X=667,e.Y=667,e.Z=611,e.bracketleft=333,e.backslash=278,e.bracketright=333,e.asciicircum=584,e.underscore=556,e.quoteleft=278,e.a=556,e.b=611,e.c=556,e.d=611,e.e=556,e.f=333,e.g=611,e.h=611,e.i=278,e.j=278,e.k=556,e.l=278,e.m=889,e.n=611,e.o=611,e.p=611,e.q=611,e.r=389,e.s=556,e.t=333,e.u=611,e.v=556,e.w=778,e.x=556,e.y=556,e.z=500,e.braceleft=389,e.bar=280,e.braceright=389,e.asciitilde=584,e.exclamdown=333,e.cent=556,e.sterling=556,e.fraction=167,e.yen=556,e.florin=556,e.section=556,e.currency=556,e.quotesingle=238,e.quotedblleft=500,e.guillemotleft=556,e.guilsinglleft=333,e.guilsinglright=333,e.fi=611,e.fl=611,e.endash=556,e.dagger=556,e.daggerdbl=556,e.periodcentered=278,e.paragraph=556,e.bullet=350,e.quotesinglbase=278,e.quotedblbase=500,e.quotedblright=500,e.guillemotright=556,e.ellipsis=1e3,e.perthousand=1e3,e.questiondown=611,e.grave=333,e.acute=333,e.circumflex=333,e.tilde=333,e.macron=333,e.breve=333,e.dotaccent=333,e.dieresis=333,e.ring=333,e.cedilla=333,e.hungarumlaut=333,e.ogonek=333,e.caron=333,e.emdash=1e3,e.AE=1e3,e.ordfeminine=370,e.Lslash=611,e.Oslash=778,e.OE=1e3,e.ordmasculine=365,e.ae=889,e.dotlessi=278,e.lslash=278,e.oslash=611,e.oe=944,e.germandbls=611,e.Idieresis=278,e.eacute=556,e.abreve=556,e.uhungarumlaut=611,e.ecaron=556,e.Ydieresis=667,e.divide=584,e.Yacute=667,e.Acircumflex=722,e.aacute=556,e.Ucircumflex=722,e.yacute=556,e.scommaaccent=556,e.ecircumflex=556,e.Uring=722,e.Udieresis=722,e.aogonek=556,e.Uacute=722,e.uogonek=611,e.Edieresis=667,e.Dcroat=722,e.commaaccent=250,e.copyright=737,e.Emacron=667,e.ccaron=556,e.aring=556,e.Ncommaaccent=722,e.lacute=278,e.agrave=556,e.Tcommaaccent=611,e.Cacute=722,e.atilde=556,e.Edotaccent=667,e.scaron=556,e.scedilla=556,e.iacute=278,e.lozenge=494,e.Rcaron=722,e.Gcommaaccent=778,e.ucircumflex=611,e.acircumflex=556,e.Amacron=722,e.rcaron=389,e.ccedilla=556,e.Zdotaccent=611,e.Thorn=667,e.Omacron=778,e.Racute=722,e.Sacute=667,e.dcaron=743,e.Umacron=722,e.uring=611,e.threesuperior=333,e.Ograve=778,e.Agrave=722,e.Abreve=722,e.multiply=584,e.uacute=611,e.Tcaron=611,e.partialdiff=494,e.ydieresis=556,e.Nacute=722,e.icircumflex=278,e.Ecircumflex=667,e.adieresis=556,e.edieresis=556,e.cacute=556,e.nacute=611,e.umacron=611,e.Ncaron=722,e.Iacute=278,e.plusminus=584,e.brokenbar=280,e.registered=737,e.Gbreve=778,e.Idotaccent=278,e.summation=600,e.Egrave=667,e.racute=389,e.omacron=611,e.Zacute=611,e.Zcaron=611,e.greaterequal=549,e.Eth=722,e.Ccedilla=722,e.lcommaaccent=278,e.tcaron=389,e.eogonek=556,e.Uogonek=722,e.Aacute=722,e.Adieresis=722,e.egrave=556,e.zacute=500,e.iogonek=278,e.Oacute=778,e.oacute=611,e.amacron=556,e.sacute=556,e.idieresis=278,e.Ocircumflex=778,e.Ugrave=722,e.Delta=612,e.thorn=611,e.twosuperior=333,e.Odieresis=778,e.mu=611,e.igrave=278,e.ohungarumlaut=611,e.Eogonek=667,e.dcroat=611,e.threequarters=834,e.Scedilla=667,e.lcaron=400,e.Kcommaaccent=722,e.Lacute=611,e.trademark=1e3,e.edotaccent=556,e.Igrave=278,e.Imacron=278,e.Lcaron=611,e.onehalf=834,e.lessequal=549,e.ocircumflex=611,e.ntilde=611,e.Uhungarumlaut=722,e.Eacute=667,e.emacron=556,e.gbreve=611,e.onequarter=834,e.Scaron=667,e.Scommaaccent=667,e.Ohungarumlaut=778,e.degree=400,e.ograve=611,e.Ccaron=722,e.ugrave=611,e.radical=549,e.Dcaron=722,e.rcommaaccent=389,e.Ntilde=722,e.otilde=611,e.Rcommaaccent=722,e.Lcommaaccent=611,e.Atilde=722,e.Aogonek=722,e.Aring=722,e.Otilde=778,e.zdotaccent=500,e.Ecaron=667,e.Iogonek=278,e.kcommaaccent=556,e.minus=584,e.Icircumflex=278,e.ncaron=611,e.tcommaaccent=333,e.logicalnot=584,e.odieresis=611,e.udieresis=611,e.notequal=549,e.gcommaaccent=611,e.eth=611,e.zcaron=500,e.ncommaaccent=611,e.onesuperior=333,e.imacron=278,e.Euro=556})),e["Helvetica-Oblique"]=(0,n.getLookupTableFactory)((function(e){e.space=278,e.exclam=278,e.quotedbl=355,e.numbersign=556,e.dollar=556,e.percent=889,e.ampersand=667,e.quoteright=222,e.parenleft=333,e.parenright=333,e.asterisk=389,e.plus=584,e.comma=278,e.hyphen=333,e.period=278,e.slash=278,e.zero=556,e.one=556,e.two=556,e.three=556,e.four=556,e.five=556,e.six=556,e.seven=556,e.eight=556,e.nine=556,e.colon=278,e.semicolon=278,e.less=584,e.equal=584,e.greater=584,e.question=556,e.at=1015,e.A=667,e.B=667,e.C=722,e.D=722,e.E=667,e.F=611,e.G=778,e.H=722,e.I=278,e.J=500,e.K=667,e.L=556,e.M=833,e.N=722,e.O=778,e.P=667,e.Q=778,e.R=722,e.S=667,e.T=611,e.U=722,e.V=667,e.W=944,e.X=667,e.Y=667,e.Z=611,e.bracketleft=278,e.backslash=278,e.bracketright=278,e.asciicircum=469,e.underscore=556,e.quoteleft=222,e.a=556,e.b=556,e.c=500,e.d=556,e.e=556,e.f=278,e.g=556,e.h=556,e.i=222,e.j=222,e.k=500,e.l=222,e.m=833,e.n=556,e.o=556,e.p=556,e.q=556,e.r=333,e.s=500,e.t=278,e.u=556,e.v=500,e.w=722,e.x=500,e.y=500,e.z=500,e.braceleft=334,e.bar=260,e.braceright=334,e.asciitilde=584,e.exclamdown=333,e.cent=556,e.sterling=556,e.fraction=167,e.yen=556,e.florin=556,e.section=556,e.currency=556,e.quotesingle=191,e.quotedblleft=333,e.guillemotleft=556,e.guilsinglleft=333,e.guilsinglright=333,e.fi=500,e.fl=500,e.endash=556,e.dagger=556,e.daggerdbl=556,e.periodcentered=278,e.paragraph=537,e.bullet=350,e.quotesinglbase=222,e.quotedblbase=333,e.quotedblright=333,e.guillemotright=556,e.ellipsis=1e3,e.perthousand=1e3,e.questiondown=611,e.grave=333,e.acute=333,e.circumflex=333,e.tilde=333,e.macron=333,e.breve=333,e.dotaccent=333,e.dieresis=333,e.ring=333,e.cedilla=333,e.hungarumlaut=333,e.ogonek=333,e.caron=333,e.emdash=1e3,e.AE=1e3,e.ordfeminine=370,e.Lslash=556,e.Oslash=778,e.OE=1e3,e.ordmasculine=365,e.ae=889,e.dotlessi=278,e.lslash=222,e.oslash=611,e.oe=944,e.germandbls=611,e.Idieresis=278,e.eacute=556,e.abreve=556,e.uhungarumlaut=556,e.ecaron=556,e.Ydieresis=667,e.divide=584,e.Yacute=667,e.Acircumflex=667,e.aacute=556,e.Ucircumflex=722,e.yacute=500,e.scommaaccent=500,e.ecircumflex=556,e.Uring=722,e.Udieresis=722,e.aogonek=556,e.Uacute=722,e.uogonek=556,e.Edieresis=667,e.Dcroat=722,e.commaaccent=250,e.copyright=737,e.Emacron=667,e.ccaron=500,e.aring=556,e.Ncommaaccent=722,e.lacute=222,e.agrave=556,e.Tcommaaccent=611,e.Cacute=722,e.atilde=556,e.Edotaccent=667,e.scaron=500,e.scedilla=500,e.iacute=278,e.lozenge=471,e.Rcaron=722,e.Gcommaaccent=778,e.ucircumflex=556,e.acircumflex=556,e.Amacron=667,e.rcaron=333,e.ccedilla=500,e.Zdotaccent=611,e.Thorn=667,e.Omacron=778,e.Racute=722,e.Sacute=667,e.dcaron=643,e.Umacron=722,e.uring=556,e.threesuperior=333,e.Ograve=778,e.Agrave=667,e.Abreve=667,e.multiply=584,e.uacute=556,e.Tcaron=611,e.partialdiff=476,e.ydieresis=500,e.Nacute=722,e.icircumflex=278,e.Ecircumflex=667,e.adieresis=556,e.edieresis=556,e.cacute=500,e.nacute=556,e.umacron=556,e.Ncaron=722,e.Iacute=278,e.plusminus=584,e.brokenbar=260,e.registered=737,e.Gbreve=778,e.Idotaccent=278,e.summation=600,e.Egrave=667,e.racute=333,e.omacron=556,e.Zacute=611,e.Zcaron=611,e.greaterequal=549,e.Eth=722,e.Ccedilla=722,e.lcommaaccent=222,e.tcaron=317,e.eogonek=556,e.Uogonek=722,e.Aacute=667,e.Adieresis=667,e.egrave=556,e.zacute=500,e.iogonek=222,e.Oacute=778,e.oacute=556,e.amacron=556,e.sacute=500,e.idieresis=278,e.Ocircumflex=778,e.Ugrave=722,e.Delta=612,e.thorn=556,e.twosuperior=333,e.Odieresis=778,e.mu=556,e.igrave=278,e.ohungarumlaut=556,e.Eogonek=667,e.dcroat=556,e.threequarters=834,e.Scedilla=667,e.lcaron=299,e.Kcommaaccent=667,e.Lacute=556,e.trademark=1e3,e.edotaccent=556,e.Igrave=278,e.Imacron=278,e.Lcaron=556,e.onehalf=834,e.lessequal=549,e.ocircumflex=556,e.ntilde=556,e.Uhungarumlaut=722,e.Eacute=667,e.emacron=556,e.gbreve=556,e.onequarter=834,e.Scaron=667,e.Scommaaccent=667,e.Ohungarumlaut=778,e.degree=400,e.ograve=556,e.Ccaron=722,e.ugrave=556,e.radical=453,e.Dcaron=722,e.rcommaaccent=333,e.Ntilde=722,e.otilde=556,e.Rcommaaccent=722,e.Lcommaaccent=556,e.Atilde=667,e.Aogonek=667,e.Aring=667,e.Otilde=778,e.zdotaccent=500,e.Ecaron=667,e.Iogonek=278,e.kcommaaccent=500,e.minus=584,e.Icircumflex=278,e.ncaron=556,e.tcommaaccent=278,e.logicalnot=584,e.odieresis=556,e.udieresis=556,e.notequal=549,e.gcommaaccent=556,e.eth=556,e.zcaron=500,e.ncommaaccent=556,e.onesuperior=333,e.imacron=278,e.Euro=556})),e.Symbol=(0,n.getLookupTableFactory)((function(e){e.space=250,e.exclam=333,e.universal=713,e.numbersign=500,e.existential=549,e.percent=833,e.ampersand=778,e.suchthat=439,e.parenleft=333,e.parenright=333,e.asteriskmath=500,e.plus=549,e.comma=250,e.minus=549,e.period=250,e.slash=278,e.zero=500,e.one=500,e.two=500,e.three=500,e.four=500,e.five=500,e.six=500,e.seven=500,e.eight=500,e.nine=500,e.colon=278,e.semicolon=278,e.less=549,e.equal=549,e.greater=549,e.question=444,e.congruent=549,e.Alpha=722,e.Beta=667,e.Chi=722,e.Delta=612,e.Epsilon=611,e.Phi=763,e.Gamma=603,e.Eta=722,e.Iota=333,e.theta1=631,e.Kappa=722,e.Lambda=686,e.Mu=889,e.Nu=722,e.Omicron=722,e.Pi=768,e.Theta=741,e.Rho=556,e.Sigma=592,e.Tau=611,e.Upsilon=690,e.sigma1=439,e.Omega=768,e.Xi=645,e.Psi=795,e.Zeta=611,e.bracketleft=333,e.therefore=863,e.bracketright=333,e.perpendicular=658,e.underscore=500,e.radicalex=500,e.alpha=631,e.beta=549,e.chi=549,e.delta=494,e.epsilon=439,e.phi=521,e.gamma=411,e.eta=603,e.iota=329,e.phi1=603,e.kappa=549,e.lambda=549,e.mu=576,e.nu=521,e.omicron=549,e.pi=549,e.theta=521,e.rho=549,e.sigma=603,e.tau=439,e.upsilon=576,e.omega1=713,e.omega=686,e.xi=493,e.psi=686,e.zeta=494,e.braceleft=480,e.bar=200,e.braceright=480,e.similar=549,e.Euro=750,e.Upsilon1=620,e.minute=247,e.lessequal=549,e.fraction=167,e.infinity=713,e.florin=500,e.club=753,e.diamond=753,e.heart=753,e.spade=753,e.arrowboth=1042,e.arrowleft=987,e.arrowup=603,e.arrowright=987,e.arrowdown=603,e.degree=400,e.plusminus=549,e.second=411,e.greaterequal=549,e.multiply=549,e.proportional=713,e.partialdiff=494,e.bullet=460,e.divide=549,e.notequal=549,e.equivalence=549,e.approxequal=549,e.ellipsis=1e3,e.arrowvertex=603,e.arrowhorizex=1e3,e.carriagereturn=658,e.aleph=823,e.Ifraktur=686,e.Rfraktur=795,e.weierstrass=987,e.circlemultiply=768,e.circleplus=768,e.emptyset=823,e.intersection=768,e.union=768,e.propersuperset=713,e.reflexsuperset=713,e.notsubset=713,e.propersubset=713,e.reflexsubset=713,e.element=713,e.notelement=713,e.angle=768,e.gradient=713,e.registerserif=790,e.copyrightserif=790,e.trademarkserif=890,e.product=823,e.radical=549,e.dotmath=250,e.logicalnot=713,e.logicaland=603,e.logicalor=603,e.arrowdblboth=1042,e.arrowdblleft=987,e.arrowdblup=603,e.arrowdblright=987,e.arrowdbldown=603,e.lozenge=494,e.angleleft=329,e.registersans=790,e.copyrightsans=790,e.trademarksans=786,e.summation=713,e.parenlefttp=384,e.parenleftex=384,e.parenleftbt=384,e.bracketlefttp=384,e.bracketleftex=384,e.bracketleftbt=384,e.bracelefttp=494,e.braceleftmid=494,e.braceleftbt=494,e.braceex=494,e.angleright=329,e.integral=274,e.integraltp=686,e.integralex=686,e.integralbt=686,e.parenrighttp=384,e.parenrightex=384,e.parenrightbt=384,e.bracketrighttp=384,e.bracketrightex=384,e.bracketrightbt=384,e.bracerighttp=494,e.bracerightmid=494,e.bracerightbt=494,e.apple=790})),e["Times-Roman"]=(0,n.getLookupTableFactory)((function(e){e.space=250,e.exclam=333,e.quotedbl=408,e.numbersign=500,e.dollar=500,e.percent=833,e.ampersand=778,e.quoteright=333,e.parenleft=333,e.parenright=333,e.asterisk=500,e.plus=564,e.comma=250,e.hyphen=333,e.period=250,e.slash=278,e.zero=500,e.one=500,e.two=500,e.three=500,e.four=500,e.five=500,e.six=500,e.seven=500,e.eight=500,e.nine=500,e.colon=278,e.semicolon=278,e.less=564,e.equal=564,e.greater=564,e.question=444,e.at=921,e.A=722,e.B=667,e.C=667,e.D=722,e.E=611,e.F=556,e.G=722,e.H=722,e.I=333,e.J=389,e.K=722,e.L=611,e.M=889,e.N=722,e.O=722,e.P=556,e.Q=722,e.R=667,e.S=556,e.T=611,e.U=722,e.V=722,e.W=944,e.X=722,e.Y=722,e.Z=611,e.bracketleft=333,e.backslash=278,e.bracketright=333,e.asciicircum=469,e.underscore=500,e.quoteleft=333,e.a=444,e.b=500,e.c=444,e.d=500,e.e=444,e.f=333,e.g=500,e.h=500,e.i=278,e.j=278,e.k=500,e.l=278,e.m=778,e.n=500,e.o=500,e.p=500,e.q=500,e.r=333,e.s=389,e.t=278,e.u=500,e.v=500,e.w=722,e.x=500,e.y=500,e.z=444,e.braceleft=480,e.bar=200,e.braceright=480,e.asciitilde=541,e.exclamdown=333,e.cent=500,e.sterling=500,e.fraction=167,e.yen=500,e.florin=500,e.section=500,e.currency=500,e.quotesingle=180,e.quotedblleft=444,e.guillemotleft=500,e.guilsinglleft=333,e.guilsinglright=333,e.fi=556,e.fl=556,e.endash=500,e.dagger=500,e.daggerdbl=500,e.periodcentered=250,e.paragraph=453,e.bullet=350,e.quotesinglbase=333,e.quotedblbase=444,e.quotedblright=444,e.guillemotright=500,e.ellipsis=1e3,e.perthousand=1e3,e.questiondown=444,e.grave=333,e.acute=333,e.circumflex=333,e.tilde=333,e.macron=333,e.breve=333,e.dotaccent=333,e.dieresis=333,e.ring=333,e.cedilla=333,e.hungarumlaut=333,e.ogonek=333,e.caron=333,e.emdash=1e3,e.AE=889,e.ordfeminine=276,e.Lslash=611,e.Oslash=722,e.OE=889,e.ordmasculine=310,e.ae=667,e.dotlessi=278,e.lslash=278,e.oslash=500,e.oe=722,e.germandbls=500,e.Idieresis=333,e.eacute=444,e.abreve=444,e.uhungarumlaut=500,e.ecaron=444,e.Ydieresis=722,e.divide=564,e.Yacute=722,e.Acircumflex=722,e.aacute=444,e.Ucircumflex=722,e.yacute=500,e.scommaaccent=389,e.ecircumflex=444,e.Uring=722,e.Udieresis=722,e.aogonek=444,e.Uacute=722,e.uogonek=500,e.Edieresis=611,e.Dcroat=722,e.commaaccent=250,e.copyright=760,e.Emacron=611,e.ccaron=444,e.aring=444,e.Ncommaaccent=722,e.lacute=278,e.agrave=444,e.Tcommaaccent=611,e.Cacute=667,e.atilde=444,e.Edotaccent=611,e.scaron=389,e.scedilla=389,e.iacute=278,e.lozenge=471,e.Rcaron=667,e.Gcommaaccent=722,e.ucircumflex=500,e.acircumflex=444,e.Amacron=722,e.rcaron=333,e.ccedilla=444,e.Zdotaccent=611,e.Thorn=556,e.Omacron=722,e.Racute=667,e.Sacute=556,e.dcaron=588,e.Umacron=722,e.uring=500,e.threesuperior=300,e.Ograve=722,e.Agrave=722,e.Abreve=722,e.multiply=564,e.uacute=500,e.Tcaron=611,e.partialdiff=476,e.ydieresis=500,e.Nacute=722,e.icircumflex=278,e.Ecircumflex=611,e.adieresis=444,e.edieresis=444,e.cacute=444,e.nacute=500,e.umacron=500,e.Ncaron=722,e.Iacute=333,e.plusminus=564,e.brokenbar=200,e.registered=760,e.Gbreve=722,e.Idotaccent=333,e.summation=600,e.Egrave=611,e.racute=333,e.omacron=500,e.Zacute=611,e.Zcaron=611,e.greaterequal=549,e.Eth=722,e.Ccedilla=667,e.lcommaaccent=278,e.tcaron=326,e.eogonek=444,e.Uogonek=722,e.Aacute=722,e.Adieresis=722,e.egrave=444,e.zacute=444,e.iogonek=278,e.Oacute=722,e.oacute=500,e.amacron=444,e.sacute=389,e.idieresis=278,e.Ocircumflex=722,e.Ugrave=722,e.Delta=612,e.thorn=500,e.twosuperior=300,e.Odieresis=722,e.mu=500,e.igrave=278,e.ohungarumlaut=500,e.Eogonek=611,e.dcroat=500,e.threequarters=750,e.Scedilla=556,e.lcaron=344,e.Kcommaaccent=722,e.Lacute=611,e.trademark=980,e.edotaccent=444,e.Igrave=333,e.Imacron=333,e.Lcaron=611,e.onehalf=750,e.lessequal=549,e.ocircumflex=500,e.ntilde=500,e.Uhungarumlaut=722,e.Eacute=611,e.emacron=444,e.gbreve=500,e.onequarter=750,e.Scaron=556,e.Scommaaccent=556,e.Ohungarumlaut=722,e.degree=400,e.ograve=500,e.Ccaron=667,e.ugrave=500,e.radical=453,e.Dcaron=722,e.rcommaaccent=333,e.Ntilde=722,e.otilde=500,e.Rcommaaccent=667,e.Lcommaaccent=611,e.Atilde=722,e.Aogonek=722,e.Aring=722,e.Otilde=722,e.zdotaccent=444,e.Ecaron=611,e.Iogonek=333,e.kcommaaccent=500,e.minus=564,e.Icircumflex=333,e.ncaron=500,e.tcommaaccent=278,e.logicalnot=564,e.odieresis=500,e.udieresis=500,e.notequal=549,e.gcommaaccent=500,e.eth=500,e.zcaron=444,e.ncommaaccent=500,e.onesuperior=300,e.imacron=278,e.Euro=500})),e["Times-Bold"]=(0,n.getLookupTableFactory)((function(e){e.space=250,e.exclam=333,e.quotedbl=555,e.numbersign=500,e.dollar=500,e.percent=1e3,e.ampersand=833,e.quoteright=333,e.parenleft=333,e.parenright=333,e.asterisk=500,e.plus=570,e.comma=250,e.hyphen=333,e.period=250,e.slash=278,e.zero=500,e.one=500,e.two=500,e.three=500,e.four=500,e.five=500,e.six=500,e.seven=500,e.eight=500,e.nine=500,e.colon=333,e.semicolon=333,e.less=570,e.equal=570,e.greater=570,e.question=500,e.at=930,e.A=722,e.B=667,e.C=722,e.D=722,e.E=667,e.F=611,e.G=778,e.H=778,e.I=389,e.J=500,e.K=778,e.L=667,e.M=944,e.N=722,e.O=778,e.P=611,e.Q=778,e.R=722,e.S=556,e.T=667,e.U=722,e.V=722,e.W=1e3,e.X=722,e.Y=722,e.Z=667,e.bracketleft=333,e.backslash=278,e.bracketright=333,e.asciicircum=581,e.underscore=500,e.quoteleft=333,e.a=500,e.b=556,e.c=444,e.d=556,e.e=444,e.f=333,e.g=500,e.h=556,e.i=278,e.j=333,e.k=556,e.l=278,e.m=833,e.n=556,e.o=500,e.p=556,e.q=556,e.r=444,e.s=389,e.t=333,e.u=556,e.v=500,e.w=722,e.x=500,e.y=500,e.z=444,e.braceleft=394,e.bar=220,e.braceright=394,e.asciitilde=520,e.exclamdown=333,e.cent=500,e.sterling=500,e.fraction=167,e.yen=500,e.florin=500,e.section=500,e.currency=500,e.quotesingle=278,e.quotedblleft=500,e.guillemotleft=500,e.guilsinglleft=333,e.guilsinglright=333,e.fi=556,e.fl=556,e.endash=500,e.dagger=500,e.daggerdbl=500,e.periodcentered=250,e.paragraph=540,e.bullet=350,e.quotesinglbase=333,e.quotedblbase=500,e.quotedblright=500,e.guillemotright=500,e.ellipsis=1e3,e.perthousand=1e3,e.questiondown=500,e.grave=333,e.acute=333,e.circumflex=333,e.tilde=333,e.macron=333,e.breve=333,e.dotaccent=333,e.dieresis=333,e.ring=333,e.cedilla=333,e.hungarumlaut=333,e.ogonek=333,e.caron=333,e.emdash=1e3,e.AE=1e3,e.ordfeminine=300,e.Lslash=667,e.Oslash=778,e.OE=1e3,e.ordmasculine=330,e.ae=722,e.dotlessi=278,e.lslash=278,e.oslash=500,e.oe=722,e.germandbls=556,e.Idieresis=389,e.eacute=444,e.abreve=500,e.uhungarumlaut=556,e.ecaron=444,e.Ydieresis=722,e.divide=570,e.Yacute=722,e.Acircumflex=722,e.aacute=500,e.Ucircumflex=722,e.yacute=500,e.scommaaccent=389,e.ecircumflex=444,e.Uring=722,e.Udieresis=722,e.aogonek=500,e.Uacute=722,e.uogonek=556,e.Edieresis=667,e.Dcroat=722,e.commaaccent=250,e.copyright=747,e.Emacron=667,e.ccaron=444,e.aring=500,e.Ncommaaccent=722,e.lacute=278,e.agrave=500,e.Tcommaaccent=667,e.Cacute=722,e.atilde=500,e.Edotaccent=667,e.scaron=389,e.scedilla=389,e.iacute=278,e.lozenge=494,e.Rcaron=722,e.Gcommaaccent=778,e.ucircumflex=556,e.acircumflex=500,e.Amacron=722,e.rcaron=444,e.ccedilla=444,e.Zdotaccent=667,e.Thorn=611,e.Omacron=778,e.Racute=722,e.Sacute=556,e.dcaron=672,e.Umacron=722,e.uring=556,e.threesuperior=300,e.Ograve=778,e.Agrave=722,e.Abreve=722,e.multiply=570,e.uacute=556,e.Tcaron=667,e.partialdiff=494,e.ydieresis=500,e.Nacute=722,e.icircumflex=278,e.Ecircumflex=667,e.adieresis=500,e.edieresis=444,e.cacute=444,e.nacute=556,e.umacron=556,e.Ncaron=722,e.Iacute=389,e.plusminus=570,e.brokenbar=220,e.registered=747,e.Gbreve=778,e.Idotaccent=389,e.summation=600,e.Egrave=667,e.racute=444,e.omacron=500,e.Zacute=667,e.Zcaron=667,e.greaterequal=549,e.Eth=722,e.Ccedilla=722,e.lcommaaccent=278,e.tcaron=416,e.eogonek=444,e.Uogonek=722,e.Aacute=722,e.Adieresis=722,e.egrave=444,e.zacute=444,e.iogonek=278,e.Oacute=778,e.oacute=500,e.amacron=500,e.sacute=389,e.idieresis=278,e.Ocircumflex=778,e.Ugrave=722,e.Delta=612,e.thorn=556,e.twosuperior=300,e.Odieresis=778,e.mu=556,e.igrave=278,e.ohungarumlaut=500,e.Eogonek=667,e.dcroat=556,e.threequarters=750,e.Scedilla=556,e.lcaron=394,e.Kcommaaccent=778,e.Lacute=667,e.trademark=1e3,e.edotaccent=444,e.Igrave=389,e.Imacron=389,e.Lcaron=667,e.onehalf=750,e.lessequal=549,e.ocircumflex=500,e.ntilde=556,e.Uhungarumlaut=722,e.Eacute=667,e.emacron=444,e.gbreve=500,e.onequarter=750,e.Scaron=556,e.Scommaaccent=556,e.Ohungarumlaut=778,e.degree=400,e.ograve=500,e.Ccaron=722,e.ugrave=556,e.radical=549,e.Dcaron=722,e.rcommaaccent=444,e.Ntilde=722,e.otilde=500,e.Rcommaaccent=722,e.Lcommaaccent=667,e.Atilde=722,e.Aogonek=722,e.Aring=722,e.Otilde=778,e.zdotaccent=444,e.Ecaron=667,e.Iogonek=389,e.kcommaaccent=556,e.minus=570,e.Icircumflex=389,e.ncaron=556,e.tcommaaccent=333,e.logicalnot=570,e.odieresis=500,e.udieresis=556,e.notequal=549,e.gcommaaccent=500,e.eth=500,e.zcaron=444,e.ncommaaccent=556,e.onesuperior=300,e.imacron=278,e.Euro=500})),e["Times-BoldItalic"]=(0,n.getLookupTableFactory)((function(e){e.space=250,e.exclam=389,e.quotedbl=555,e.numbersign=500,e.dollar=500,e.percent=833,e.ampersand=778,e.quoteright=333,e.parenleft=333,e.parenright=333,e.asterisk=500,e.plus=570,e.comma=250,e.hyphen=333,e.period=250,e.slash=278,e.zero=500,e.one=500,e.two=500,e.three=500,e.four=500,e.five=500,e.six=500,e.seven=500,e.eight=500,e.nine=500,e.colon=333,e.semicolon=333,e.less=570,e.equal=570,e.greater=570,e.question=500,e.at=832,e.A=667,e.B=667,e.C=667,e.D=722,e.E=667,e.F=667,e.G=722,e.H=778,e.I=389,e.J=500,e.K=667,e.L=611,e.M=889,e.N=722,e.O=722,e.P=611,e.Q=722,e.R=667,e.S=556,e.T=611,e.U=722,e.V=667,e.W=889,e.X=667,e.Y=611,e.Z=611,e.bracketleft=333,e.backslash=278,e.bracketright=333,e.asciicircum=570,e.underscore=500,e.quoteleft=333,e.a=500,e.b=500,e.c=444,e.d=500,e.e=444,e.f=333,e.g=500,e.h=556,e.i=278,e.j=278,e.k=500,e.l=278,e.m=778,e.n=556,e.o=500,e.p=500,e.q=500,e.r=389,e.s=389,e.t=278,e.u=556,e.v=444,e.w=667,e.x=500,e.y=444,e.z=389,e.braceleft=348,e.bar=220,e.braceright=348,e.asciitilde=570,e.exclamdown=389,e.cent=500,e.sterling=500,e.fraction=167,e.yen=500,e.florin=500,e.section=500,e.currency=500,e.quotesingle=278,e.quotedblleft=500,e.guillemotleft=500,e.guilsinglleft=333,e.guilsinglright=333,e.fi=556,e.fl=556,e.endash=500,e.dagger=500,e.daggerdbl=500,e.periodcentered=250,e.paragraph=500,e.bullet=350,e.quotesinglbase=333,e.quotedblbase=500,e.quotedblright=500,e.guillemotright=500,e.ellipsis=1e3,e.perthousand=1e3,e.questiondown=500,e.grave=333,e.acute=333,e.circumflex=333,e.tilde=333,e.macron=333,e.breve=333,e.dotaccent=333,e.dieresis=333,e.ring=333,e.cedilla=333,e.hungarumlaut=333,e.ogonek=333,e.caron=333,e.emdash=1e3,e.AE=944,e.ordfeminine=266,e.Lslash=611,e.Oslash=722,e.OE=944,e.ordmasculine=300,e.ae=722,e.dotlessi=278,e.lslash=278,e.oslash=500,e.oe=722,e.germandbls=500,e.Idieresis=389,e.eacute=444,e.abreve=500,e.uhungarumlaut=556,e.ecaron=444,e.Ydieresis=611,e.divide=570,e.Yacute=611,e.Acircumflex=667,e.aacute=500,e.Ucircumflex=722,e.yacute=444,e.scommaaccent=389,e.ecircumflex=444,e.Uring=722,e.Udieresis=722,e.aogonek=500,e.Uacute=722,e.uogonek=556,e.Edieresis=667,e.Dcroat=722,e.commaaccent=250,e.copyright=747,e.Emacron=667,e.ccaron=444,e.aring=500,e.Ncommaaccent=722,e.lacute=278,e.agrave=500,e.Tcommaaccent=611,e.Cacute=667,e.atilde=500,e.Edotaccent=667,e.scaron=389,e.scedilla=389,e.iacute=278,e.lozenge=494,e.Rcaron=667,e.Gcommaaccent=722,e.ucircumflex=556,e.acircumflex=500,e.Amacron=667,e.rcaron=389,e.ccedilla=444,e.Zdotaccent=611,e.Thorn=611,e.Omacron=722,e.Racute=667,e.Sacute=556,e.dcaron=608,e.Umacron=722,e.uring=556,e.threesuperior=300,e.Ograve=722,e.Agrave=667,e.Abreve=667,e.multiply=570,e.uacute=556,e.Tcaron=611,e.partialdiff=494,e.ydieresis=444,e.Nacute=722,e.icircumflex=278,e.Ecircumflex=667,e.adieresis=500,e.edieresis=444,e.cacute=444,e.nacute=556,e.umacron=556,e.Ncaron=722,e.Iacute=389,e.plusminus=570,e.brokenbar=220,e.registered=747,e.Gbreve=722,e.Idotaccent=389,e.summation=600,e.Egrave=667,e.racute=389,e.omacron=500,e.Zacute=611,e.Zcaron=611,e.greaterequal=549,e.Eth=722,e.Ccedilla=667,e.lcommaaccent=278,e.tcaron=366,e.eogonek=444,e.Uogonek=722,e.Aacute=667,e.Adieresis=667,e.egrave=444,e.zacute=389,e.iogonek=278,e.Oacute=722,e.oacute=500,e.amacron=500,e.sacute=389,e.idieresis=278,e.Ocircumflex=722,e.Ugrave=722,e.Delta=612,e.thorn=500,e.twosuperior=300,e.Odieresis=722,e.mu=576,e.igrave=278,e.ohungarumlaut=500,e.Eogonek=667,e.dcroat=500,e.threequarters=750,e.Scedilla=556,e.lcaron=382,e.Kcommaaccent=667,e.Lacute=611,e.trademark=1e3,e.edotaccent=444,e.Igrave=389,e.Imacron=389,e.Lcaron=611,e.onehalf=750,e.lessequal=549,e.ocircumflex=500,e.ntilde=556,e.Uhungarumlaut=722,e.Eacute=667,e.emacron=444,e.gbreve=500,e.onequarter=750,e.Scaron=556,e.Scommaaccent=556,e.Ohungarumlaut=722,e.degree=400,e.ograve=500,e.Ccaron=667,e.ugrave=556,e.radical=549,e.Dcaron=722,e.rcommaaccent=389,e.Ntilde=722,e.otilde=500,e.Rcommaaccent=667,e.Lcommaaccent=611,e.Atilde=667,e.Aogonek=667,e.Aring=667,e.Otilde=722,e.zdotaccent=389,e.Ecaron=667,e.Iogonek=389,e.kcommaaccent=500,e.minus=606,e.Icircumflex=389,e.ncaron=556,e.tcommaaccent=278,e.logicalnot=606,e.odieresis=500,e.udieresis=556,e.notequal=549,e.gcommaaccent=500,e.eth=500,e.zcaron=389,e.ncommaaccent=556,e.onesuperior=300,e.imacron=278,e.Euro=500})),e["Times-Italic"]=(0,n.getLookupTableFactory)((function(e){e.space=250,e.exclam=333,e.quotedbl=420,e.numbersign=500,e.dollar=500,e.percent=833,e.ampersand=778,e.quoteright=333,e.parenleft=333,e.parenright=333,e.asterisk=500,e.plus=675,e.comma=250,e.hyphen=333,e.period=250,e.slash=278,e.zero=500,e.one=500,e.two=500,e.three=500,e.four=500,e.five=500,e.six=500,e.seven=500,e.eight=500,e.nine=500,e.colon=333,e.semicolon=333,e.less=675,e.equal=675,e.greater=675,e.question=500,e.at=920,e.A=611,e.B=611,e.C=667,e.D=722,e.E=611,e.F=611,e.G=722,e.H=722,e.I=333,e.J=444,e.K=667,e.L=556,e.M=833,e.N=667,e.O=722,e.P=611,e.Q=722,e.R=611,e.S=500,e.T=556,e.U=722,e.V=611,e.W=833,e.X=611,e.Y=556,e.Z=556,e.bracketleft=389,e.backslash=278,e.bracketright=389,e.asciicircum=422,e.underscore=500,e.quoteleft=333,e.a=500,e.b=500,e.c=444,e.d=500,e.e=444,e.f=278,e.g=500,e.h=500,e.i=278,e.j=278,e.k=444,e.l=278,e.m=722,e.n=500,e.o=500,e.p=500,e.q=500,e.r=389,e.s=389,e.t=278,e.u=500,e.v=444,e.w=667,e.x=444,e.y=444,e.z=389,e.braceleft=400,e.bar=275,e.braceright=400,e.asciitilde=541,e.exclamdown=389,e.cent=500,e.sterling=500,e.fraction=167,e.yen=500,e.florin=500,e.section=500,e.currency=500,e.quotesingle=214,e.quotedblleft=556,e.guillemotleft=500,e.guilsinglleft=333,e.guilsinglright=333,e.fi=500,e.fl=500,e.endash=500,e.dagger=500,e.daggerdbl=500,e.periodcentered=250,e.paragraph=523,e.bullet=350,e.quotesinglbase=333,e.quotedblbase=556,e.quotedblright=556,e.guillemotright=500,e.ellipsis=889,e.perthousand=1e3,e.questiondown=500,e.grave=333,e.acute=333,e.circumflex=333,e.tilde=333,e.macron=333,e.breve=333,e.dotaccent=333,e.dieresis=333,e.ring=333,e.cedilla=333,e.hungarumlaut=333,e.ogonek=333,e.caron=333,e.emdash=889,e.AE=889,e.ordfeminine=276,e.Lslash=556,e.Oslash=722,e.OE=944,e.ordmasculine=310,e.ae=667,e.dotlessi=278,e.lslash=278,e.oslash=500,e.oe=667,e.germandbls=500,e.Idieresis=333,e.eacute=444,e.abreve=500,e.uhungarumlaut=500,e.ecaron=444,e.Ydieresis=556,e.divide=675,e.Yacute=556,e.Acircumflex=611,e.aacute=500,e.Ucircumflex=722,e.yacute=444,e.scommaaccent=389,e.ecircumflex=444,e.Uring=722,e.Udieresis=722,e.aogonek=500,e.Uacute=722,e.uogonek=500,e.Edieresis=611,e.Dcroat=722,e.commaaccent=250,e.copyright=760,e.Emacron=611,e.ccaron=444,e.aring=500,e.Ncommaaccent=667,e.lacute=278,e.agrave=500,e.Tcommaaccent=556,e.Cacute=667,e.atilde=500,e.Edotaccent=611,e.scaron=389,e.scedilla=389,e.iacute=278,e.lozenge=471,e.Rcaron=611,e.Gcommaaccent=722,e.ucircumflex=500,e.acircumflex=500,e.Amacron=611,e.rcaron=389,e.ccedilla=444,e.Zdotaccent=556,e.Thorn=611,e.Omacron=722,e.Racute=611,e.Sacute=500,e.dcaron=544,e.Umacron=722,e.uring=500,e.threesuperior=300,e.Ograve=722,e.Agrave=611,e.Abreve=611,e.multiply=675,e.uacute=500,e.Tcaron=556,e.partialdiff=476,e.ydieresis=444,e.Nacute=667,e.icircumflex=278,e.Ecircumflex=611,e.adieresis=500,e.edieresis=444,e.cacute=444,e.nacute=500,e.umacron=500,e.Ncaron=667,e.Iacute=333,e.plusminus=675,e.brokenbar=275,e.registered=760,e.Gbreve=722,e.Idotaccent=333,e.summation=600,e.Egrave=611,e.racute=389,e.omacron=500,e.Zacute=556,e.Zcaron=556,e.greaterequal=549,e.Eth=722,e.Ccedilla=667,e.lcommaaccent=278,e.tcaron=300,e.eogonek=444,e.Uogonek=722,e.Aacute=611,e.Adieresis=611,e.egrave=444,e.zacute=389,e.iogonek=278,e.Oacute=722,e.oacute=500,e.amacron=500,e.sacute=389,e.idieresis=278,e.Ocircumflex=722,e.Ugrave=722,e.Delta=612,e.thorn=500,e.twosuperior=300,e.Odieresis=722,e.mu=500,e.igrave=278,e.ohungarumlaut=500,e.Eogonek=611,e.dcroat=500,e.threequarters=750,e.Scedilla=500,e.lcaron=300,e.Kcommaaccent=667,e.Lacute=556,e.trademark=980,e.edotaccent=444,e.Igrave=333,e.Imacron=333,e.Lcaron=611,e.onehalf=750,e.lessequal=549,e.ocircumflex=500,e.ntilde=500,e.Uhungarumlaut=722,e.Eacute=611,e.emacron=444,e.gbreve=500,e.onequarter=750,e.Scaron=500,e.Scommaaccent=500,e.Ohungarumlaut=722,e.degree=400,e.ograve=500,e.Ccaron=667,e.ugrave=500,e.radical=453,e.Dcaron=722,e.rcommaaccent=389,e.Ntilde=667,e.otilde=500,e.Rcommaaccent=611,e.Lcommaaccent=556,e.Atilde=611,e.Aogonek=611,e.Aring=611,e.Otilde=722,e.zdotaccent=389,e.Ecaron=611,e.Iogonek=333,e.kcommaaccent=444,e.minus=675,e.Icircumflex=333,e.ncaron=500,e.tcommaaccent=278,e.logicalnot=675,e.odieresis=500,e.udieresis=500,e.notequal=549,e.gcommaaccent=500,e.eth=500,e.zcaron=389,e.ncommaaccent=500,e.onesuperior=300,e.imacron=278,e.Euro=500})),e.ZapfDingbats=(0,n.getLookupTableFactory)((function(e){e.space=278,e.a1=974,e.a2=961,e.a202=974,e.a3=980,e.a4=719,e.a5=789,e.a119=790,e.a118=791,e.a117=690,e.a11=960,e.a12=939,e.a13=549,e.a14=855,e.a15=911,e.a16=933,e.a105=911,e.a17=945,e.a18=974,e.a19=755,e.a20=846,e.a21=762,e.a22=761,e.a23=571,e.a24=677,e.a25=763,e.a26=760,e.a27=759,e.a28=754,e.a6=494,e.a7=552,e.a8=537,e.a9=577,e.a10=692,e.a29=786,e.a30=788,e.a31=788,e.a32=790,e.a33=793,e.a34=794,e.a35=816,e.a36=823,e.a37=789,e.a38=841,e.a39=823,e.a40=833,e.a41=816,e.a42=831,e.a43=923,e.a44=744,e.a45=723,e.a46=749,e.a47=790,e.a48=792,e.a49=695,e.a50=776,e.a51=768,e.a52=792,e.a53=759,e.a54=707,e.a55=708,e.a56=682,e.a57=701,e.a58=826,e.a59=815,e.a60=789,e.a61=789,e.a62=707,e.a63=687,e.a64=696,e.a65=689,e.a66=786,e.a67=787,e.a68=713,e.a69=791,e.a70=785,e.a71=791,e.a72=873,e.a73=761,e.a74=762,e.a203=762,e.a75=759,e.a204=759,e.a76=892,e.a77=892,e.a78=788,e.a79=784,e.a81=438,e.a82=138,e.a83=277,e.a84=415,e.a97=392,e.a98=392,e.a99=668,e.a100=668,e.a89=390,e.a90=390,e.a93=317,e.a94=317,e.a91=276,e.a92=276,e.a205=509,e.a85=509,e.a206=410,e.a86=410,e.a87=234,e.a88=234,e.a95=334,e.a96=334,e.a101=732,e.a102=544,e.a103=544,e.a104=910,e.a106=667,e.a107=760,e.a108=760,e.a112=776,e.a111=595,e.a110=694,e.a109=626,e.a120=788,e.a121=788,e.a122=788,e.a123=788,e.a124=788,e.a125=788,e.a126=788,e.a127=788,e.a128=788,e.a129=788,e.a130=788,e.a131=788,e.a132=788,e.a133=788,e.a134=788,e.a135=788,e.a136=788,e.a137=788,e.a138=788,e.a139=788,e.a140=788,e.a141=788,e.a142=788,e.a143=788,e.a144=788,e.a145=788,e.a146=788,e.a147=788,e.a148=788,e.a149=788,e.a150=788,e.a151=788,e.a152=788,e.a153=788,e.a154=788,e.a155=788,e.a156=788,e.a157=788,e.a158=788,e.a159=788,e.a160=894,e.a161=838,e.a163=1016,e.a164=458,e.a196=748,e.a165=924,e.a192=748,e.a166=918,e.a167=927,e.a168=928,e.a169=928,e.a170=834,e.a171=873,e.a172=828,e.a173=924,e.a162=924,e.a174=917,e.a175=930,e.a176=931,e.a177=463,e.a178=883,e.a179=836,e.a193=836,e.a180=867,e.a199=867,e.a181=696,e.a200=696,e.a182=874,e.a201=874,e.a183=760,e.a184=946,e.a197=771,e.a185=865,e.a194=771,e.a198=888,e.a186=967,e.a195=888,e.a187=831,e.a188=873,e.a189=927,e.a190=970,e.a191=918}))}));t.getMetrics=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MurmurHash3_64=void 0;var n=r(2);const i=3285377520,o=4294901760,a=65535;t.MurmurHash3_64=class{constructor(e){this.h1=e?4294967295&e:i,this.h2=e?4294967295&e:i}update(e){let t,r;if((0,n.isString)(e)){t=new Uint8Array(2*e.length),r=0;for(let n=0,i=e.length;n<i;n++){const i=e.charCodeAt(n);i<=255?t[r++]=i:(t[r++]=i>>>8,t[r++]=255&i)}}else{if(!(0,n.isArrayBuffer)(e))throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");t=e,r=t.byteLength}const i=r>>2,s=r-4*i,l=new Uint32Array(t.buffer,0,i);let c=0,u=0,h=this.h1,d=this.h2;const f=3432918353,g=461845907,p=11601,m=13715;for(let n=0;n<i;n++)1&n?(c=l[n],c=c*f&o|c*p&a,c=c<<15|c>>>17,c=c*g&o|c*m&a,h^=c,h=h<<13|h>>>19,h=5*h+3864292196):(u=l[n],u=u*f&o|u*p&a,u=u<<15|u>>>17,u=u*g&o|u*m&a,d^=u,d=d<<13|d>>>19,d=5*d+3864292196);switch(c=0,s){case 3:c^=t[4*i+2]<<16;case 2:c^=t[4*i+1]<<8;case 1:c^=t[4*i],c=c*f&o|c*p&a,c=c<<15|c>>>17,c=c*g&o|c*m&a,1&i?h^=c:d^=c}this.h1=h,this.h2=d}hexdigest(){let e=this.h1,t=this.h2;e^=t>>>1,e=3981806797*e&o|36045*e&a,t=4283543511*t&o|(2950163797*(t<<16|e>>>16)&o)>>>16,e^=t>>>1,e=444984403*e&o|60499*e&a,t=3301882366*t&o|(3120437893*(t<<16|e>>>16)&o)>>>16,e^=t>>>1;const r=(e>>>0).toString(16),n=(t>>>0).toString(16);return r.padStart(8,"0")+n.padStart(8,"0")}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PDFImage=void 0;var n=r(2),i=r(5),o=r(23),a=r(12),s=r(18),l=r(21);function c(e,t,r,n){return(e=t+e*r)<0?e=0:e>n&&(e=n),e}function u(e,t,r,n,i,o){var a=i*o;let s;s=t<=8?new Uint8Array(a):t<=16?new Uint16Array(a):new Uint32Array(a);var l,c,u,h,d=r/i,f=n/o,g=0,p=new Uint16Array(i),m=r;for(l=0;l<i;l++)p[l]=Math.floor(l*d);for(l=0;l<o;l++)for(u=Math.floor(l*f)*m,c=0;c<i;c++)h=u+p[c],s[g++]=e[h];return s}class h{constructor(e){let{xref:t,res:r,image:a,isInline:s=!1,smask:c=null,mask:u=null,isMask:d=!1,pdfFunctionFactory:f,localColorSpaceCache:g}=e;this.image=a;var p=a.dict;const m=p.get("Filter");if((0,i.isName)(m))switch(m.name){case"JPXDecode":var v=new l.JpxImage;v.parseImageProperties(a.stream),a.stream.reset(),a.width=v.width,a.height=v.height,a.bitsPerComponent=v.bitsPerComponent,a.numComps=v.componentsCount;break;case"JBIG2Decode":a.bitsPerComponent=1,a.numComps=1}let b=p.get("Width","W"),y=p.get("Height","H");if(Number.isInteger(a.width)&&a.width>0&&Number.isInteger(a.height)&&a.height>0&&(a.width!==b||a.height!==y)&&((0,n.warn)("PDFImage - using the Width/Height of the image data, rather than the image dictionary."),b=a.width,y=a.height),b<1||y<1)throw new n.FormatError(`Invalid image width: ${b} or height: ${y}`);this.width=b,this.height=y,this.interpolate=p.get("Interpolate","I")||!1,this.imageMask=p.get("ImageMask","IM")||!1,this.matte=p.get("Matte")||!1;var w=a.bitsPerComponent;if(!w&&!(w=p.get("BitsPerComponent","BPC"))){if(!this.imageMask)throw new n.FormatError(`Bits per component missing in image: ${this.imageMask}`);w=1}if(this.bpc=w,!this.imageMask){let e=p.getRaw("ColorSpace")||p.getRaw("CS");if(!e)switch((0,n.info)("JPX images (which do not require color spaces)"),a.numComps){case 1:e=i.Name.get("DeviceGray");break;case 3:e=i.Name.get("DeviceRGB");break;case 4:e=i.Name.get("DeviceCMYK");break;default:throw new Error(`JPX images with ${a.numComps} color components not supported.`)}this.colorSpace=o.ColorSpace.parse({cs:e,xref:t,resources:s?r:null,pdfFunctionFactory:f,localColorSpaceCache:g}),this.numComps=this.colorSpace.numComps}if(this.decode=p.getArray("Decode","D"),this.needsDecode=!1,this.decode&&(this.colorSpace&&!this.colorSpace.isDefaultDecode(this.decode,w)||d&&!o.ColorSpace.isDefaultDecode(this.decode,1))){this.needsDecode=!0;var S=(1<<w)-1;this.decodeCoefficients=[],this.decodeAddends=[];const e=this.colorSpace&&"Indexed"===this.colorSpace.name;for(var C=0,k=0;C<this.decode.length;C+=2,++k){var x=this.decode[C],E=this.decode[C+1];this.decodeCoefficients[k]=e?(E-x)/S:E-x,this.decodeAddends[k]=e?x:S*x}}c?this.smask=new h({xref:t,res:r,image:c,isInline:s,pdfFunctionFactory:f,localColorSpaceCache:g}):u&&((0,i.isStream)(u)?u.dict.get("ImageMask","IM")?this.mask=new h({xref:t,res:r,image:u,isInline:s,isMask:!0,pdfFunctionFactory:f,localColorSpaceCache:g}):(0,n.warn)("Ignoring /Mask in image without /ImageMask."):this.mask=u)}static async buildImage(e){let{xref:t,res:r,image:o,isInline:a=!1,pdfFunctionFactory:s,localColorSpaceCache:l}=e;const c=o;let u=null,d=null;const f=o.dict.get("SMask"),g=o.dict.get("Mask");return f?u=f:g&&((0,i.isStream)(g)||Array.isArray(g)?d=g:(0,n.warn)("Unsupported mask format.")),new h({xref:t,res:r,image:c,isInline:a,smask:u,mask:d,pdfFunctionFactory:s,localColorSpaceCache:l})}static createMask(e){let{imgArray:t,width:r,height:n,imageIsFromDecodeStream:i,inverseDecode:o}=e;var a,s,l=(r+7>>3)*n,c=t.byteLength;if(!i||o&&l!==c)if(o)for((a=new Uint8ClampedArray(l)).set(t),s=c;s<l;s++)a[s]=255;else(a=new Uint8ClampedArray(c)).set(t);else a=t;if(o)for(s=0;s<c;s++)a[s]^=255;return{data:a,width:r,height:n}}get drawWidth(){return Math.max(this.width,this.smask&&this.smask.width||0,this.mask&&this.mask.width||0)}get drawHeight(){return Math.max(this.height,this.smask&&this.smask.height||0,this.mask&&this.mask.height||0)}decodeBuffer(e){var t,r,n=this.bpc,i=this.numComps,o=this.decodeAddends,a=this.decodeCoefficients,s=(1<<n)-1;if(1!==n){var l=0;for(t=0,r=this.width*this.height;t<r;t++)for(var u=0;u<i;u++)e[l]=c(e[l],o[u],a[u],s),l++}else for(t=0,r=e.length;t<r;t++)e[t]=+!e[t]}getComponents(e){var t=this.bpc;if(8===t)return e;var r=this.width,n=this.height,i=this.numComps,o=r*n*i,a=0;let s;s=t<=8?new Uint8Array(o):t<=16?new Uint16Array(o):new Uint32Array(o);var l,c,u=r*i,h=(1<<t)-1,d=0;if(1===t)for(var f,g,p,m=0;m<n;m++){for(g=d+(-8&u),p=d+u;d<g;)c=e[a++],s[d]=c>>7&1,s[d+1]=c>>6&1,s[d+2]=c>>5&1,s[d+3]=c>>4&1,s[d+4]=c>>3&1,s[d+5]=c>>2&1,s[d+6]=c>>1&1,s[d+7]=1&c,d+=8;if(d<p)for(c=e[a++],f=128;d<p;)s[d++]=+!!(c&f),f>>=1}else{var v=0;for(c=0,d=0,l=o;d<l;++d){for(d%u===0&&(c=0,v=0);v<t;)c=c<<8|e[a++],v+=8;var b=v-t;let r=c>>b;r<0?r=0:r>h&&(r=h),s[d]=r,c&=(1<<b)-1,v=b}}return s}fillOpacity(e,t,r,i,o){var a,s,l,c,d,f,g=this.smask,p=this.mask;if(g)s=g.width,l=g.height,a=new Uint8ClampedArray(s*l),g.fillGrayBuffer(a),s===t&&l===r||(a=u(a,g.bpc,s,l,t,r));else if(p)if(p instanceof h){for(s=p.width,l=p.height,a=new Uint8ClampedArray(s*l),p.numComps=1,p.fillGrayBuffer(a),c=0,d=s*l;c<d;++c)a[c]=255-a[c];s===t&&l===r||(a=u(a,p.bpc,s,l,t,r))}else{if(!Array.isArray(p))throw new n.FormatError("Unknown mask format.");a=new Uint8ClampedArray(t*r);var m=this.numComps;for(c=0,d=t*r;c<d;++c){var v=0,b=c*m;for(f=0;f<m;++f){var y=o[b+f],w=2*f;if(y<p[w]||y>p[w+1]){v=255;break}}a[c]=v}}if(a)for(c=0,f=3,d=t*i;c<d;++c,f+=4)e[f]=a[c];else for(c=0,f=3,d=t*i;c<d;++c,f+=4)e[f]=255}undoPreblend(e,t,r){var n=this.smask&&this.smask.matte;if(n)for(var i=this.colorSpace.getRgb(n,0),o=i[0],a=i[1],s=i[2],l=t*r*4,c=0;c<l;c+=4){var u=e[c+3];if(0!==u){var h=255/u;e[c]=(e[c]-o)*h+o,e[c+1]=(e[c+1]-a)*h+a,e[c+2]=(e[c+2]-s)*h+s}else e[c]=255,e[c+1]=255,e[c+2]=255}}createImageData(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];var t,r=this.drawWidth,i=this.drawHeight,o={width:r,height:i,kind:0,data:null},l=this.numComps,c=this.width,u=this.height,h=this.bpc,d=c*l*h+7>>3;if(!e){var f;if("DeviceGray"===this.colorSpace.name&&1===h?f=n.ImageKind.GRAYSCALE_1BPP:"DeviceRGB"!==this.colorSpace.name||8!==h||this.needsDecode||(f=n.ImageKind.RGB_24BPP),f&&!this.smask&&!this.mask&&r===c&&i===u){if(o.kind=f,t=this.getImageBytes(u*d),this.image instanceof a.DecodeStream)o.data=t;else{var g=new Uint8ClampedArray(t.length);g.set(t),o.data=g}if(this.needsDecode){(0,n.assert)(f===n.ImageKind.GRAYSCALE_1BPP,"PDFImage.createImageData: The image must be grayscale.");for(var p=o.data,m=0,v=p.length;m<v;m++)p[m]^=255}return o}if(this.image instanceof s.JpegStream&&!this.smask&&!this.mask){let e=u*d;switch(this.colorSpace.name){case"DeviceGray":e*=3;case"DeviceRGB":case"DeviceCMYK":return o.kind=n.ImageKind.RGB_24BPP,o.data=this.getImageBytes(e,r,i,!0),o}}}var b,y,w=0|(t=this.getImageBytes(u*d)).length/d*i/u,S=this.getComponents(t);return e||this.smask||this.mask?(o.kind=n.ImageKind.RGBA_32BPP,o.data=new Uint8ClampedArray(r*i*4),b=1,y=!0,this.fillOpacity(o.data,r,i,w,S)):(o.kind=n.ImageKind.RGB_24BPP,o.data=new Uint8ClampedArray(r*i*3),b=0,y=!1),this.needsDecode&&this.decodeBuffer(S),this.colorSpace.fillRgb(o.data,c,u,r,i,w,h,S,b),y&&this.undoPreblend(o.data,r,w),o}fillGrayBuffer(e){var t=this.numComps;if(1!==t)throw new n.FormatError(`Reading gray scale from a color image: ${t}`);var r,i,o=this.width,a=this.height,s=this.bpc,l=o*t*s+7>>3,c=this.getImageBytes(a*l),u=this.getComponents(c);if(1!==s){this.needsDecode&&this.decodeBuffer(u),i=o*a;var h=255/((1<<s)-1);for(r=0;r<i;++r)e[r]=h*u[r]}else if(i=o*a,this.needsDecode)for(r=0;r<i;++r)e[r]=u[r]-1&255;else for(r=0;r<i;++r)e[r]=255&-u[r]}getImageBytes(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return this.image.reset(),this.image.drawWidth=t||this.width,this.image.drawHeight=r||this.height,this.image.forceRGB=!!n,this.image.getBytes(e,!0)}}t.PDFImage=h},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MessageHandler=void 0;var n=r(2);const i=1,o=2,a=1,s=2,l=3,c=4,u=5,h=6,d=7,f=8;function g(e){if("object"!==typeof e||null===e)return e;switch(e.name){case"AbortException":return new n.AbortException(e.message);case"MissingPDFException":return new n.MissingPDFException(e.message);case"UnexpectedResponseException":return new n.UnexpectedResponseException(e.message,e.status);case"UnknownErrorException":return new n.UnknownErrorException(e.message,e.details);default:return new n.UnknownErrorException(e.message,e.toString())}}t.MessageHandler=class{constructor(e,t,r){this.sourceName=e,this.targetName=t,this.comObj=r,this.callbackId=1,this.streamId=1,this.postMessageTransfers=!0,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=e=>{const t=e.data;if(t.targetName!==this.sourceName)return;if(t.stream)return void this._processStreamMessage(t);if(t.callback){const e=t.callbackId,r=this.callbackCapabilities[e];if(!r)throw new Error(`Cannot resolve callback ${e}`);if(delete this.callbackCapabilities[e],t.callback===i)r.resolve(t.data);else{if(t.callback!==o)throw new Error("Unexpected callback case");r.reject(g(t.reason))}return}const n=this.actionHandler[t.action];if(!n)throw new Error(`Unknown action from worker: ${t.action}`);if(t.callbackId){const e=this.sourceName,a=t.sourceName;new Promise((function(e){e(n(t.data))})).then((function(n){r.postMessage({sourceName:e,targetName:a,callback:i,callbackId:t.callbackId,data:n})}),(function(n){r.postMessage({sourceName:e,targetName:a,callback:o,callbackId:t.callbackId,reason:g(n)})}))}else t.streamId?this._createStreamSink(t):n(t.data)},r.addEventListener("message",this._onComObjOnMessage)}on(e,t){const r=this.actionHandler;if(r[e])throw new Error(`There is already an actionName called "${e}"`);r[e]=t}send(e,t,r){this._postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},r)}sendWithPromise(e,t,r){const i=this.callbackId++,o=(0,n.createPromiseCapability)();this.callbackCapabilities[i]=o;try{this._postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:i,data:t},r)}catch(a){o.reject(a)}return o.promise}sendWithStream(e,t,r,i){const o=this.streamId++,s=this.sourceName,l=this.targetName,c=this.comObj;return new ReadableStream({start:r=>{const a=(0,n.createPromiseCapability)();return this.streamControllers[o]={controller:r,startCall:a,pullCall:null,cancelCall:null,isClosed:!1},this._postMessage({sourceName:s,targetName:l,action:e,streamId:o,data:t,desiredSize:r.desiredSize},i),a.promise},pull:e=>{const t=(0,n.createPromiseCapability)();return this.streamControllers[o].pullCall=t,c.postMessage({sourceName:s,targetName:l,stream:h,streamId:o,desiredSize:e.desiredSize}),t.promise},cancel:e=>{(0,n.assert)(e instanceof Error,"cancel must have a valid reason");const t=(0,n.createPromiseCapability)();return this.streamControllers[o].cancelCall=t,this.streamControllers[o].isClosed=!0,c.postMessage({sourceName:s,targetName:l,stream:a,streamId:o,reason:g(e)}),t.promise}},r)}_createStreamSink(e){const t=this,r=this.actionHandler[e.action],i=e.streamId,o=this.sourceName,a=e.sourceName,s=this.comObj,h={enqueue(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,s=arguments.length>2?arguments[2]:void 0;if(this.isCancelled)return;const l=this.desiredSize;this.desiredSize-=r,l>0&&this.desiredSize<=0&&(this.sinkCapability=(0,n.createPromiseCapability)(),this.ready=this.sinkCapability.promise),t._postMessage({sourceName:o,targetName:a,stream:c,streamId:i,chunk:e},s)},close(){this.isCancelled||(this.isCancelled=!0,s.postMessage({sourceName:o,targetName:a,stream:l,streamId:i}),delete t.streamSinks[i])},error(e){(0,n.assert)(e instanceof Error,"error must have a valid reason"),this.isCancelled||(this.isCancelled=!0,s.postMessage({sourceName:o,targetName:a,stream:u,streamId:i,reason:g(e)}))},sinkCapability:(0,n.createPromiseCapability)(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};h.sinkCapability.resolve(),h.ready=h.sinkCapability.promise,this.streamSinks[i]=h,new Promise((function(t){t(r(e.data,h))})).then((function(){s.postMessage({sourceName:o,targetName:a,stream:f,streamId:i,success:!0})}),(function(e){s.postMessage({sourceName:o,targetName:a,stream:f,streamId:i,reason:g(e)})}))}_processStreamMessage(e){const t=e.streamId,r=this.sourceName,i=e.sourceName,o=this.comObj;switch(e.stream){case f:e.success?this.streamControllers[t].startCall.resolve():this.streamControllers[t].startCall.reject(g(e.reason));break;case d:e.success?this.streamControllers[t].pullCall.resolve():this.streamControllers[t].pullCall.reject(g(e.reason));break;case h:if(!this.streamSinks[t]){o.postMessage({sourceName:r,targetName:i,stream:d,streamId:t,success:!0});break}this.streamSinks[t].desiredSize<=0&&e.desiredSize>0&&this.streamSinks[t].sinkCapability.resolve(),this.streamSinks[t].desiredSize=e.desiredSize;const{onPull:p}=this.streamSinks[e.streamId];new Promise((function(e){e(p&&p())})).then((function(){o.postMessage({sourceName:r,targetName:i,stream:d,streamId:t,success:!0})}),(function(e){o.postMessage({sourceName:r,targetName:i,stream:d,streamId:t,reason:g(e)})}));break;case c:if((0,n.assert)(this.streamControllers[t],"enqueue should have stream controller"),this.streamControllers[t].isClosed)break;this.streamControllers[t].controller.enqueue(e.chunk);break;case l:if((0,n.assert)(this.streamControllers[t],"close should have stream controller"),this.streamControllers[t].isClosed)break;this.streamControllers[t].isClosed=!0,this.streamControllers[t].controller.close(),this._deleteStreamController(t);break;case u:(0,n.assert)(this.streamControllers[t],"error should have stream controller"),this.streamControllers[t].controller.error(g(e.reason)),this._deleteStreamController(t);break;case s:e.success?this.streamControllers[t].cancelCall.resolve():this.streamControllers[t].cancelCall.reject(g(e.reason)),this._deleteStreamController(t);break;case a:if(!this.streamSinks[t])break;const{onCancel:m}=this.streamSinks[e.streamId];new Promise((function(t){t(m&&m(g(e.reason)))})).then((function(){o.postMessage({sourceName:r,targetName:i,stream:s,streamId:t,success:!0})}),(function(e){o.postMessage({sourceName:r,targetName:i,stream:s,streamId:t,reason:g(e)})})),this.streamSinks[t].sinkCapability.reject(g(e.reason)),this.streamSinks[t].isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}}async _deleteStreamController(e){await Promise.allSettled([this.streamControllers[e].startCall,this.streamControllers[e].pullCall,this.streamControllers[e].cancelCall].map((function(e){return e&&e.promise}))),delete this.streamControllers[e]}_postMessage(e,t){t&&this.postMessageTransfers?this.comObj.postMessage(e,t):this.comObj.postMessage(e)}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PDFWorkerStream=void 0;var n=r(2);t.PDFWorkerStream=class{constructor(e){this._msgHandler=e,this._contentLength=null,this._fullRequestReader=null,this._rangeRequestReaders=[]}getFullReader(){return(0,n.assert)(!this._fullRequestReader,"PDFWorkerStream.getFullReader can only be called once."),this._fullRequestReader=new i(this._msgHandler),this._fullRequestReader}getRangeReader(e,t){const r=new o(e,t,this._msgHandler);return this._rangeRequestReaders.push(r),r}cancelAllRequests(e){this._fullRequestReader&&this._fullRequestReader.cancel(e),this._rangeRequestReaders.slice(0).forEach((function(t){t.cancel(e)}))}};class i{constructor(e){this._msgHandler=e,this.onProgress=null,this._contentLength=null,this._isRangeSupported=!1,this._isStreamingSupported=!1;const t=this._msgHandler.sendWithStream("GetReader");this._reader=t.getReader(),this._headersReady=this._msgHandler.sendWithPromise("ReaderHeadersReady").then((e=>{this._isStreamingSupported=e.isStreamingSupported,this._isRangeSupported=e.isRangeSupported,this._contentLength=e.contentLength}))}get headersReady(){return this._headersReady}get contentLength(){return this._contentLength}get isStreamingSupported(){return this._isStreamingSupported}get isRangeSupported(){return this._isRangeSupported}async read(){const{value:e,done:t}=await this._reader.read();return t?{value:void 0,done:!0}:{value:e.buffer,done:!1}}cancel(e){this._reader.cancel(e)}}class o{constructor(e,t,r){this._msgHandler=r,this.onProgress=null;const n=this._msgHandler.sendWithStream("GetRangeReader",{begin:e,end:t});this._reader=n.getReader()}get isStreamingSupported(){return!1}async read(){const{value:e,done:t}=await this._reader.read();return t?{value:void 0,done:!0}:{value:e.buffer,done:!1}}cancel(e){this._reader.cancel(e)}}}])},e.exports=t()},6213:function(e){e.exports=function(){"use strict";function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,r){return t=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},t(e,r)}function r(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function n(e,i,o){return n=r()?Reflect.construct:function(e,r,n){var i=[null];i.push.apply(i,r);var o=new(Function.bind.apply(e,i));return n&&t(o,n.prototype),o},n.apply(null,arguments)}function i(e){return o(e)||a(e)||s(e)||c()}function o(e){if(Array.isArray(e))return l(e)}function a(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function s(e,t){if(e){if("string"===typeof e)return l(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?l(e,t):void 0}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function c(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var u=Object.hasOwnProperty,h=Object.setPrototypeOf,d=Object.isFrozen,f=Object.getPrototypeOf,g=Object.getOwnPropertyDescriptor,p=Object.freeze,m=Object.seal,v=Object.create,b="undefined"!==typeof Reflect&&Reflect,y=b.apply,w=b.construct;y||(y=function(e,t,r){return e.apply(t,r)}),p||(p=function(e){return e}),m||(m=function(e){return e}),w||(w=function(e,t){return n(e,i(t))});var S=I(Array.prototype.forEach),C=I(Array.prototype.pop),k=I(Array.prototype.push),x=I(String.prototype.toLowerCase),E=I(String.prototype.toString),T=I(String.prototype.match),_=I(String.prototype.replace),A=I(String.prototype.indexOf),R=I(String.prototype.trim),O=I(RegExp.prototype.test),M=P(TypeError);function I(e){return function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return y(e,t,n)}}function P(e){return function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return w(e,r)}}function N(e,t,r){var n;r=null!==(n=r)&&void 0!==n?n:x,h&&h(e,null);for(var i=t.length;i--;){var o=t[i];if("string"===typeof o){var a=r(o);a!==o&&(d(t)||(t[i]=a),o=a)}e[o]=!0}return e}function D(e){var t,r=v(null);for(t in e)!0===y(u,e,[t])&&(r[t]=e[t]);return r}function F(e,t){for(;null!==e;){var r=g(e,t);if(r){if(r.get)return I(r.get);if("function"===typeof r.value)return I(r.value)}e=f(e)}function n(e){return console.warn("fallback value for",e),null}return n}var L=p(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),H=p(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),B=p(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),U=p(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),j=p(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),W=p(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),V=p(["#text"]),z=p(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),q=p(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),G=p(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),$=p(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),K=m(/\{\{[\w\W]*|[\w\W]*\}\}/gm),Y=m(/<%[\w\W]*|[\w\W]*%>/gm),X=m(/\${[\w\W]*}/gm),J=m(/^data-[\-\w.\u00B7-\uFFFF]/),Z=m(/^aria-[\-\w]+$/),Q=m(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),ee=m(/^(?:\w+script|data):/i),te=m(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),re=m(/^html$/i),ne=m(/^[a-z][.\w]*(-[.\w]+)+$/i),ie=function(){return"undefined"===typeof window?null:window},oe=function(t,r){if("object"!==e(t)||"function"!==typeof t.createPolicy)return null;var n=null,i="data-tt-policy-suffix";r.currentScript&&r.currentScript.hasAttribute(i)&&(n=r.currentScript.getAttribute(i));var o="dompurify"+(n?"#"+n:"");try{return t.createPolicy(o,{createHTML:function(e){return e},createScriptURL:function(e){return e}})}catch(a){return console.warn("TrustedTypes policy "+o+" could not be created."),null}};function ae(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ie(),r=function(e){return ae(e)};if(r.version="2.5.6",r.removed=[],!t||!t.document||9!==t.document.nodeType)return r.isSupported=!1,r;var n=t.document,o=t.document,a=t.DocumentFragment,s=t.HTMLTemplateElement,l=t.Node,c=t.Element,u=t.NodeFilter,h=t.NamedNodeMap,d=void 0===h?t.NamedNodeMap||t.MozNamedAttrMap:h,f=t.HTMLFormElement,g=t.DOMParser,m=t.trustedTypes,v=c.prototype,b=F(v,"cloneNode"),y=F(v,"nextSibling"),w=F(v,"childNodes"),I=F(v,"parentNode");if("function"===typeof s){var P=o.createElement("template");P.content&&P.content.ownerDocument&&(o=P.content.ownerDocument)}var se=oe(m,n),le=se?se.createHTML(""):"",ce=o,ue=ce.implementation,he=ce.createNodeIterator,de=ce.createDocumentFragment,fe=ce.getElementsByTagName,ge=n.importNode,pe={};try{pe=D(o).documentMode?o.documentMode:{}}catch(Ft){}var me={};r.isSupported="function"===typeof I&&ue&&void 0!==ue.createHTMLDocument&&9!==pe;var ve,be,ye=K,we=Y,Se=X,Ce=J,ke=Z,xe=ee,Ee=te,Te=ne,_e=Q,Ae=null,Re=N({},[].concat(i(L),i(H),i(B),i(j),i(V))),Oe=null,Me=N({},[].concat(i(z),i(q),i(G),i($))),Ie=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Pe=null,Ne=null,De=!0,Fe=!0,Le=!1,He=!0,Be=!1,Ue=!0,je=!1,We=!1,Ve=!1,ze=!1,qe=!1,Ge=!1,$e=!0,Ke=!1,Ye="user-content-",Xe=!0,Je=!1,Ze={},Qe=null,et=N({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),tt=null,rt=N({},["audio","video","img","source","image","track"]),nt=null,it=N({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),ot="http://www.w3.org/1998/Math/MathML",at="http://www.w3.org/2000/svg",st="http://www.w3.org/1999/xhtml",lt=st,ct=!1,ut=null,ht=N({},[ot,at,st],E),dt=["application/xhtml+xml","text/html"],ft="text/html",gt=null,pt=o.createElement("form"),mt=function(e){return e instanceof RegExp||e instanceof Function},vt=function(t){gt&&gt===t||(t&&"object"===e(t)||(t={}),t=D(t),ve=ve=-1===dt.indexOf(t.PARSER_MEDIA_TYPE)?ft:t.PARSER_MEDIA_TYPE,be="application/xhtml+xml"===ve?E:x,Ae="ALLOWED_TAGS"in t?N({},t.ALLOWED_TAGS,be):Re,Oe="ALLOWED_ATTR"in t?N({},t.ALLOWED_ATTR,be):Me,ut="ALLOWED_NAMESPACES"in t?N({},t.ALLOWED_NAMESPACES,E):ht,nt="ADD_URI_SAFE_ATTR"in t?N(D(it),t.ADD_URI_SAFE_ATTR,be):it,tt="ADD_DATA_URI_TAGS"in t?N(D(rt),t.ADD_DATA_URI_TAGS,be):rt,Qe="FORBID_CONTENTS"in t?N({},t.FORBID_CONTENTS,be):et,Pe="FORBID_TAGS"in t?N({},t.FORBID_TAGS,be):{},Ne="FORBID_ATTR"in t?N({},t.FORBID_ATTR,be):{},Ze="USE_PROFILES"in t&&t.USE_PROFILES,De=!1!==t.ALLOW_ARIA_ATTR,Fe=!1!==t.ALLOW_DATA_ATTR,Le=t.ALLOW_UNKNOWN_PROTOCOLS||!1,He=!1!==t.ALLOW_SELF_CLOSE_IN_ATTR,Be=t.SAFE_FOR_TEMPLATES||!1,Ue=!1!==t.SAFE_FOR_XML,je=t.WHOLE_DOCUMENT||!1,ze=t.RETURN_DOM||!1,qe=t.RETURN_DOM_FRAGMENT||!1,Ge=t.RETURN_TRUSTED_TYPE||!1,Ve=t.FORCE_BODY||!1,$e=!1!==t.SANITIZE_DOM,Ke=t.SANITIZE_NAMED_PROPS||!1,Xe=!1!==t.KEEP_CONTENT,Je=t.IN_PLACE||!1,_e=t.ALLOWED_URI_REGEXP||_e,lt=t.NAMESPACE||st,Ie=t.CUSTOM_ELEMENT_HANDLING||{},t.CUSTOM_ELEMENT_HANDLING&&mt(t.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(Ie.tagNameCheck=t.CUSTOM_ELEMENT_HANDLING.tagNameCheck),t.CUSTOM_ELEMENT_HANDLING&&mt(t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(Ie.attributeNameCheck=t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),t.CUSTOM_ELEMENT_HANDLING&&"boolean"===typeof t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(Ie.allowCustomizedBuiltInElements=t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Be&&(Fe=!1),qe&&(ze=!0),Ze&&(Ae=N({},i(V)),Oe=[],!0===Ze.html&&(N(Ae,L),N(Oe,z)),!0===Ze.svg&&(N(Ae,H),N(Oe,q),N(Oe,$)),!0===Ze.svgFilters&&(N(Ae,B),N(Oe,q),N(Oe,$)),!0===Ze.mathMl&&(N(Ae,j),N(Oe,G),N(Oe,$))),t.ADD_TAGS&&(Ae===Re&&(Ae=D(Ae)),N(Ae,t.ADD_TAGS,be)),t.ADD_ATTR&&(Oe===Me&&(Oe=D(Oe)),N(Oe,t.ADD_ATTR,be)),t.ADD_URI_SAFE_ATTR&&N(nt,t.ADD_URI_SAFE_ATTR,be),t.FORBID_CONTENTS&&(Qe===et&&(Qe=D(Qe)),N(Qe,t.FORBID_CONTENTS,be)),Xe&&(Ae["#text"]=!0),je&&N(Ae,["html","head","body"]),Ae.table&&(N(Ae,["tbody"]),delete Pe.tbody),p&&p(t),gt=t)},bt=N({},["mi","mo","mn","ms","mtext"]),yt=N({},["foreignobject","annotation-xml"]),wt=N({},["title","style","font","a","script"]),St=N({},H);N(St,B),N(St,U);var Ct=N({},j);N(Ct,W);var kt=function(e){var t=I(e);t&&t.tagName||(t={namespaceURI:lt,tagName:"template"});var r=x(e.tagName),n=x(t.tagName);return!!ut[e.namespaceURI]&&(e.namespaceURI===at?t.namespaceURI===st?"svg"===r:t.namespaceURI===ot?"svg"===r&&("annotation-xml"===n||bt[n]):Boolean(St[r]):e.namespaceURI===ot?t.namespaceURI===st?"math"===r:t.namespaceURI===at?"math"===r&&yt[n]:Boolean(Ct[r]):e.namespaceURI===st?!(t.namespaceURI===at&&!yt[n])&&!(t.namespaceURI===ot&&!bt[n])&&!Ct[r]&&(wt[r]||!St[r]):!("application/xhtml+xml"!==ve||!ut[e.namespaceURI]))},xt=function(e){k(r.removed,{element:e});try{e.parentNode.removeChild(e)}catch(Ft){try{e.outerHTML=le}catch(Ft){e.remove()}}},Et=function(e,t){try{k(r.removed,{attribute:t.getAttributeNode(e),from:t})}catch(Ft){k(r.removed,{attribute:null,from:t})}if(t.removeAttribute(e),"is"===e&&!Oe[e])if(ze||qe)try{xt(t)}catch(Ft){}else try{t.setAttribute(e,"")}catch(Ft){}},Tt=function(e){var t,r;if(Ve)e="<remove></remove>"+e;else{var n=T(e,/^[\r\n\t ]+/);r=n&&n[0]}"application/xhtml+xml"===ve&&lt===st&&(e='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+e+"</body></html>");var i=se?se.createHTML(e):e;if(lt===st)try{t=(new g).parseFromString(i,ve)}catch(Ft){}if(!t||!t.documentElement){t=ue.createDocument(lt,"template",null);try{t.documentElement.innerHTML=ct?le:i}catch(Ft){}}var a=t.body||t.documentElement;return e&&r&&a.insertBefore(o.createTextNode(r),a.childNodes[0]||null),lt===st?fe.call(t,je?"html":"body")[0]:je?t.documentElement:a},_t=function(e){return he.call(e.ownerDocument||e,e,u.SHOW_ELEMENT|u.SHOW_COMMENT|u.SHOW_TEXT|u.SHOW_PROCESSING_INSTRUCTION|u.SHOW_CDATA_SECTION,null,!1)},At=function(e){return e instanceof f&&("string"!==typeof e.nodeName||"string"!==typeof e.textContent||"function"!==typeof e.removeChild||!(e.attributes instanceof d)||"function"!==typeof e.removeAttribute||"function"!==typeof e.setAttribute||"string"!==typeof e.namespaceURI||"function"!==typeof e.insertBefore||"function"!==typeof e.hasChildNodes)},Rt=function(t){return"object"===e(l)?t instanceof l:t&&"object"===e(t)&&"number"===typeof t.nodeType&&"string"===typeof t.nodeName},Ot=function(e,t,n){me[e]&&S(me[e],(function(e){e.call(r,t,n,gt)}))},Mt=function(e){var t;if(Ot("beforeSanitizeElements",e,null),At(e))return xt(e),!0;if(O(/[\u0080-\uFFFF]/,e.nodeName))return xt(e),!0;var n=be(e.nodeName);if(Ot("uponSanitizeElement",e,{tagName:n,allowedTags:Ae}),e.hasChildNodes()&&!Rt(e.firstElementChild)&&(!Rt(e.content)||!Rt(e.content.firstElementChild))&&O(/<[/\w]/g,e.innerHTML)&&O(/<[/\w]/g,e.textContent))return xt(e),!0;if("select"===n&&O(/<template/i,e.innerHTML))return xt(e),!0;if(7===e.nodeType)return xt(e),!0;if(Ue&&8===e.nodeType&&O(/<[/\w]/g,e.data))return xt(e),!0;if(!Ae[n]||Pe[n]){if(!Pe[n]&&Pt(n)){if(Ie.tagNameCheck instanceof RegExp&&O(Ie.tagNameCheck,n))return!1;if(Ie.tagNameCheck instanceof Function&&Ie.tagNameCheck(n))return!1}if(Xe&&!Qe[n]){var i=I(e)||e.parentNode,o=w(e)||e.childNodes;if(o&&i)for(var a=o.length-1;a>=0;--a){var s=b(o[a],!0);s.__removalCount=(e.__removalCount||0)+1,i.insertBefore(s,y(e))}}return xt(e),!0}return e instanceof c&&!kt(e)?(xt(e),!0):"noscript"!==n&&"noembed"!==n&&"noframes"!==n||!O(/<\/no(script|embed|frames)/i,e.innerHTML)?(Be&&3===e.nodeType&&(t=e.textContent,t=_(t,ye," "),t=_(t,we," "),t=_(t,Se," "),e.textContent!==t&&(k(r.removed,{element:e.cloneNode()}),e.textContent=t)),Ot("afterSanitizeElements",e,null),!1):(xt(e),!0)},It=function(e,t,r){if($e&&("id"===t||"name"===t)&&(r in o||r in pt))return!1;if(Fe&&!Ne[t]&&O(Ce,t));else if(De&&O(ke,t));else if(!Oe[t]||Ne[t]){if(!(Pt(e)&&(Ie.tagNameCheck instanceof RegExp&&O(Ie.tagNameCheck,e)||Ie.tagNameCheck instanceof Function&&Ie.tagNameCheck(e))&&(Ie.attributeNameCheck instanceof RegExp&&O(Ie.attributeNameCheck,t)||Ie.attributeNameCheck instanceof Function&&Ie.attributeNameCheck(t))||"is"===t&&Ie.allowCustomizedBuiltInElements&&(Ie.tagNameCheck instanceof RegExp&&O(Ie.tagNameCheck,r)||Ie.tagNameCheck instanceof Function&&Ie.tagNameCheck(r))))return!1}else if(nt[t]);else if(O(_e,_(r,Ee,"")));else if("src"!==t&&"xlink:href"!==t&&"href"!==t||"script"===e||0!==A(r,"data:")||!tt[e])if(Le&&!O(xe,_(r,Ee,"")));else if(r)return!1;return!0},Pt=function(e){return"annotation-xml"!==e&&T(e,Te)},Nt=function(t){var n,i,o,a;Ot("beforeSanitizeAttributes",t,null);var s=t.attributes;if(s){var l={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:Oe};for(a=s.length;a--;){var c=n=s[a],u=c.name,h=c.namespaceURI;if(i="value"===u?n.value:R(n.value),o=be(u),l.attrName=o,l.attrValue=i,l.keepAttr=!0,l.forceKeepAttr=void 0,Ot("uponSanitizeAttribute",t,l),i=l.attrValue,Ue&&O(/((--!?|])>)|<\/(style|title)/i,i))Et(u,t);else if(!l.forceKeepAttr&&(Et(u,t),l.keepAttr))if(He||!O(/\/>/i,i)){Be&&(i=_(i,ye," "),i=_(i,we," "),i=_(i,Se," "));var d=be(t.nodeName);if(It(d,o,i)){if(!Ke||"id"!==o&&"name"!==o||(Et(u,t),i=Ye+i),se&&"object"===e(m)&&"function"===typeof m.getAttributeType)if(h);else switch(m.getAttributeType(d,o)){case"TrustedHTML":i=se.createHTML(i);break;case"TrustedScriptURL":i=se.createScriptURL(i)}try{h?t.setAttributeNS(h,u,i):t.setAttribute(u,i),At(t)?xt(t):C(r.removed)}catch(Ft){}}}else Et(u,t)}Ot("afterSanitizeAttributes",t,null)}},Dt=function e(t){var r,n=_t(t);for(Ot("beforeSanitizeShadowDOM",t,null);r=n.nextNode();)Ot("uponSanitizeShadowNode",r,null),Mt(r)||(r.content instanceof a&&e(r.content),Nt(r));Ot("afterSanitizeShadowDOM",t,null)};return r.sanitize=function(i){var o,s,c,u,h,d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if((ct=!i)&&(i="\x3c!--\x3e"),"string"!==typeof i&&!Rt(i)){if("function"!==typeof i.toString)throw M("toString is not a function");if("string"!==typeof(i=i.toString()))throw M("dirty is not a string, aborting")}if(!r.isSupported){if("object"===e(t.toStaticHTML)||"function"===typeof t.toStaticHTML){if("string"===typeof i)return t.toStaticHTML(i);if(Rt(i))return t.toStaticHTML(i.outerHTML)}return i}if(We||vt(d),r.removed=[],"string"===typeof i&&(Je=!1),Je){if(i.nodeName){var f=be(i.nodeName);if(!Ae[f]||Pe[f])throw M("root node is forbidden and cannot be sanitized in-place")}}else if(i instanceof l)1===(s=(o=Tt("\x3c!----\x3e")).ownerDocument.importNode(i,!0)).nodeType&&"BODY"===s.nodeName||"HTML"===s.nodeName?o=s:o.appendChild(s);else{if(!ze&&!Be&&!je&&-1===i.indexOf("<"))return se&&Ge?se.createHTML(i):i;if(!(o=Tt(i)))return ze?null:Ge?le:""}o&&Ve&&xt(o.firstChild);for(var g=_t(Je?i:o);c=g.nextNode();)3===c.nodeType&&c===u||Mt(c)||(c.content instanceof a&&Dt(c.content),Nt(c),u=c);if(u=null,Je)return i;if(ze){if(qe)for(h=de.call(o.ownerDocument);o.firstChild;)h.appendChild(o.firstChild);else h=o;return(Oe.shadowroot||Oe.shadowrootmod)&&(h=ge.call(n,h,!0)),h}var p=je?o.outerHTML:o.innerHTML;return je&&Ae["!doctype"]&&o.ownerDocument&&o.ownerDocument.doctype&&o.ownerDocument.doctype.name&&O(re,o.ownerDocument.doctype.name)&&(p="<!DOCTYPE "+o.ownerDocument.doctype.name+">\n"+p),Be&&(p=_(p,ye," "),p=_(p,we," "),p=_(p,Se," ")),se&&Ge?se.createHTML(p):p},r.setConfig=function(e){vt(e),We=!0},r.clearConfig=function(){gt=null,We=!1},r.isValidAttribute=function(e,t,r){gt||vt({});var n=be(e),i=be(t);return It(n,i,r)},r.addHook=function(e,t){"function"===typeof t&&(me[e]=me[e]||[],k(me[e],t))},r.removeHook=function(e){if(me[e])return C(me[e])},r.removeHooks=function(e){me[e]&&(me[e]=[])},r.removeAllHooks=function(){me={}},r}return ae()}()},2370:(e,t,r)=>{"use strict";function n(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){i(e,t,r[t])}))}return e}function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var o=r(3305),a=r(2367),s=r(7707),l=r(6559),c=r(5763),u=r(6283),h=r(306),d=r(8819),f=r(4453),g=r(7414),p=d("draft_tree_data_support"),m=p?l:s,v=f.List,b=f.Repeat,y={insertAtomicBlock:function(e,t,r){var i=e.getCurrentContent(),s=e.getSelection(),l=c.removeRange(i,s,"backward"),d=l.getSelectionAfter(),f=c.splitBlock(l,d),g=f.getSelectionAfter(),y=c.setBlockType(f,g,"atomic"),w=a.create({entity:t}),S={key:h(),type:"atomic",text:r,characterList:v(b(w,r.length))},C={key:h(),type:"unstyled"};p&&(S=n({},S,{nextSibling:C.key}),C=n({},C,{prevSibling:S.key}));var k=[new m(S),new m(C)],x=o.createFromArray(k),E=c.replaceWithFragment(y,g,x),T=E.merge({selectionBefore:s,selectionAfter:E.getSelectionAfter().set("hasFocus",!0)});return u.push(e,T,"insert-fragment")},moveAtomicBlock:function(e,t,r,n){var i,o=e.getCurrentContent(),a=e.getSelection();if("before"===n||"after"===n){var s=o.getBlockForKey("before"===n?r.getStartKey():r.getEndKey());i=g(o,t,s,n)}else{var l=c.removeRange(o,r,"backward"),h=l.getSelectionAfter(),d=l.getBlockForKey(h.getFocusKey());if(0===h.getStartOffset())i=g(l,t,d,"before");else if(h.getEndOffset()===d.getLength())i=g(l,t,d,"after");else{var f=c.splitBlock(l,h),p=f.getSelectionAfter(),m=f.getBlockForKey(p.getFocusKey());i=g(f,t,m,"before")}}var v=i.merge({selectionBefore:a,selectionAfter:i.getSelectionAfter().set("hasFocus",!0)});return u.push(e,v,"move-block")}};e.exports=y},3305:(e,t,r)=>{"use strict";var n=r(4453).OrderedMap,i={createFromArray:function(e){return n(e.map((function(e){return[e.getKey(),e]})))}};e.exports=i},8208:(e,t,r)=>{"use strict";function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var i=r(8678),o=r(3112),a=r(4453),s=a.List,l=a.Repeat,c=a.Record,u=function(){return!0},h=c({start:null,end:null}),d=c({start:null,end:null,decoratorKey:null,leaves:null}),f={generate:function(e,t,r){var n=t.getLength();if(!n)return s.of(new d({start:0,end:0,decoratorKey:null,leaves:s.of(new h({start:0,end:0}))}));var o=[],a=r?r.getDecorations(t,e):s(l(null,n)),c=t.getCharacterList();return i(a,p,u,(function(e,t){o.push(new d({start:e,end:t,decoratorKey:a.get(e),leaves:g(c.slice(e,t).toList(),e)}))})),s(o)},fromJS:function(e){var t=e.leaves,r=function(e,t){if(null==e)return{};var r,n,i={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,["leaves"]);return new d(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},i=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),i.forEach((function(t){n(e,t,r[t])}))}return e}({},r,{leaves:null!=t?s(Array.isArray(t)?t:o(t)).map((function(e){return h(e)})):null}))}};function g(e,t){var r=[],n=e.map((function(e){return e.getStyle()})).toList();return i(n,p,u,(function(e,n){r.push(new h({start:e+t,end:n+t}))})),s(r)}function p(e,t){return e===t}e.exports=f},2367:(e,t,r)=>{"use strict";var n=r(4453),i=n.Map,o=n.OrderedSet,a=n.Record,s=o(),l={style:s,entity:null},c=function(e){var t,r;function n(){return e.apply(this,arguments)||this}r=e,(t=n).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var a=n.prototype;return a.getStyle=function(){return this.get("style")},a.getEntity=function(){return this.get("entity")},a.hasStyle=function(e){return this.getStyle().includes(e)},n.applyStyle=function(e,t){var r=e.set("style",e.getStyle().add(t));return n.create(r)},n.removeStyle=function(e,t){var r=e.set("style",e.getStyle().remove(t));return n.create(r)},n.applyEntity=function(e,t){var r=e.getEntity()===t?e:e.set("entity",t);return n.create(r)},n.create=function(e){if(!e)return u;var t=i({style:s,entity:null}).merge(e),r=h.get(t);if(r)return r;var o=new n(t);return h=h.set(t,o),o},n.fromJS=function(e){var t=e.style,r=e.entity;return new n({style:Array.isArray(t)?o(t):t,entity:Array.isArray(r)?o(r):r})},n}(a(l)),u=new c,h=i([[i(l),u]]);c.EMPTY=u,e.exports=c},3366:(e,t,r)=>{"use strict";var n=r(4453).List,i=function(){function e(e){var t,r,n;n=void 0,(r="_decorators")in(t=this)?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n,this._decorators=e.slice()}var t=e.prototype;return t.getDecorations=function(e,t){var r=Array(e.getText().length).fill(null);return this._decorators.forEach((function(n,i){var o=0;(0,n.strategy)(e,(function(e,t){(function(e,t,r){for(var n=t;n<r;n++)if(null!=e[n])return!1;return!0})(r,e,t)&&(!function(e,t,r,n){for(var i=t;i<r;i++)e[i]=n}(r,e,t,i+"."+o),o++)}),t)})),n(r)},t.getComponentForKey=function(e){var t=parseInt(e.split(".")[0],10);return this._decorators[t].component},t.getPropsForKey=function(e){var t=parseInt(e.split(".")[0],10);return this._decorators[t].props},e}();e.exports=i},7707:(e,t,r)=>{"use strict";var n=r(2367),i=r(8678),o=r(4453),a=o.List,s=o.Map,l=o.OrderedSet,c=o.Record,u=o.Repeat,h=l(),d=c({key:"",type:"unstyled",text:"",characterList:a(),depth:0,data:s()}),f=function(e){var t,r;function o(t){return e.call(this,function(e){if(!e)return e;var t=e.characterList,r=e.text;return r&&!t&&(e.characterList=a(u(n.EMPTY,r.length))),e}(t))||this}r=e,(t=o).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var s=o.prototype;return s.getKey=function(){return this.get("key")},s.getType=function(){return this.get("type")},s.getText=function(){return this.get("text")},s.getCharacterList=function(){return this.get("characterList")},s.getLength=function(){return this.getText().length},s.getDepth=function(){return this.get("depth")},s.getData=function(){return this.get("data")},s.getInlineStyleAt=function(e){var t=this.getCharacterList().get(e);return t?t.getStyle():h},s.getEntityAt=function(e){var t=this.getCharacterList().get(e);return t?t.getEntity():null},s.findStyleRanges=function(e,t){i(this.getCharacterList(),g,e,t)},s.findEntityRanges=function(e,t){i(this.getCharacterList(),p,e,t)},o}(d);function g(e,t){return e.getStyle()===t.getStyle()}function p(e,t){return e.getEntity()===t.getEntity()}e.exports=f},6559:(e,t,r)=>{"use strict";var n=r(2367),i=r(8678),o=r(4453),a=o.List,s=o.Map,l=o.OrderedSet,c=o.Record,u=o.Repeat,h=l(),d={parent:null,characterList:a(),data:s(),depth:0,key:"",text:"",type:"unstyled",children:a(),prevSibling:null,nextSibling:null},f=function(e,t){return e.getStyle()===t.getStyle()},g=function(e,t){return e.getEntity()===t.getEntity()},p=function(e){var t,r;function o(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d;return e.call(this,function(e){if(!e)return e;var t=e.characterList,r=e.text;return r&&!t&&(e.characterList=a(u(n.EMPTY,r.length))),e}(t))||this}r=e,(t=o).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var s=o.prototype;return s.getKey=function(){return this.get("key")},s.getType=function(){return this.get("type")},s.getText=function(){return this.get("text")},s.getCharacterList=function(){return this.get("characterList")},s.getLength=function(){return this.getText().length},s.getDepth=function(){return this.get("depth")},s.getData=function(){return this.get("data")},s.getInlineStyleAt=function(e){var t=this.getCharacterList().get(e);return t?t.getStyle():h},s.getEntityAt=function(e){var t=this.getCharacterList().get(e);return t?t.getEntity():null},s.getChildKeys=function(){return this.get("children")},s.getParentKey=function(){return this.get("parent")},s.getPrevSiblingKey=function(){return this.get("prevSibling")},s.getNextSiblingKey=function(){return this.get("nextSibling")},s.findStyleRanges=function(e,t){i(this.getCharacterList(),f,e,t)},s.findEntityRanges=function(e,t){i(this.getCharacterList(),g,e,t)},o}(c(d));e.exports=p},4075:(e,t,r)=>{"use strict";function n(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){i(e,t,r[t])}))}return e}function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var o=r(3305),a=r(2367),s=r(7707),l=r(6559),c=r(2593),u=r(4666),h=r(306),d=r(3112),f=r(8819),g=r(4453),p=r(3272),m=g.List,v=g.Record,b=g.Repeat,y=g.Map,w=g.OrderedMap,S=v({entityMap:null,blockMap:null,selectionBefore:null,selectionAfter:null}),C=f("draft_tree_data_support")?l:s,k=function(e){var t,r;function i(){return e.apply(this,arguments)||this}r=e,(t=i).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var s=i.prototype;return s.getEntityMap=function(){return c},s.getBlockMap=function(){return this.get("blockMap")},s.getSelectionBefore=function(){return this.get("selectionBefore")},s.getSelectionAfter=function(){return this.get("selectionAfter")},s.getBlockForKey=function(e){return this.getBlockMap().get(e)},s.getKeyBefore=function(e){return this.getBlockMap().reverse().keySeq().skipUntil((function(t){return t===e})).skip(1).first()},s.getKeyAfter=function(e){return this.getBlockMap().keySeq().skipUntil((function(t){return t===e})).skip(1).first()},s.getBlockAfter=function(e){return this.getBlockMap().skipUntil((function(t,r){return r===e})).skip(1).first()},s.getBlockBefore=function(e){return this.getBlockMap().reverse().skipUntil((function(t,r){return r===e})).skip(1).first()},s.getBlocksAsArray=function(){return this.getBlockMap().toArray()},s.getFirstBlock=function(){return this.getBlockMap().first()},s.getLastBlock=function(){return this.getBlockMap().last()},s.getPlainText=function(e){return this.getBlockMap().map((function(e){return e?e.getText():""})).join(e||"\n")},s.getLastCreatedEntityKey=function(){return c.__getLastCreatedEntityKey()},s.hasText=function(){var e=this.getBlockMap();return e.size>1||escape(e.first().getText()).replace(/%u200B/g,"").length>0},s.createEntity=function(e,t,r){return c.__create(e,t,r),this},s.mergeEntityData=function(e,t){return c.__mergeData(e,t),this},s.replaceEntityData=function(e,t){return c.__replaceData(e,t),this},s.addEntity=function(e){return c.__add(e),this},s.getEntity=function(e){return c.__get(e)},s.getAllEntities=function(){return c.__getAll()},s.loadWithEntities=function(e){return c.__loadWithEntities(e)},i.createFromBlockArray=function(e,t){var r=Array.isArray(e)?e:e.contentBlocks,n=o.createFromArray(r),a=n.isEmpty()?new u:u.createEmpty(n.first().getKey());return new i({blockMap:n,entityMap:t||c,selectionBefore:a,selectionAfter:a})},i.createFromText=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:/\r\n?|\n/g,r=e.split(t).map((function(e){return e=p(e),new C({key:h(),text:e,type:"unstyled",characterList:m(b(a.EMPTY,e.length))})}));return i.createFromBlockArray(r)},i.fromJS=function(e){return new i(n({},e,{blockMap:w(e.blockMap).map(i.createContentBlockFromJS),selectionBefore:new u(e.selectionBefore),selectionAfter:new u(e.selectionAfter)}))},i.createContentBlockFromJS=function(e){var t=e.characterList;return new C(n({},e,{data:y(e.data),characterList:null!=t?m((Array.isArray(t)?t:d(t)).map((function(e){return a.fromJS(e)}))):void 0}))},i}(S);e.exports=k},1589:(e,t,r)=>{"use strict";var n=r(2367),i=r(4453).Map,o={add:function(e,t,r){return a(e,t,r,!0)},remove:function(e,t,r){return a(e,t,r,!1)}};function a(e,t,r,o){var a=e.getBlockMap(),s=t.getStartKey(),l=t.getStartOffset(),c=t.getEndKey(),u=t.getEndOffset(),h=a.skipUntil((function(e,t){return t===s})).takeUntil((function(e,t){return t===c})).concat(i([[c,a.get(c)]])).map((function(e,t){var i,a;s===c?(i=l,a=u):(i=t===s?l:0,a=t===c?u:e.getLength());for(var h,d=e.getCharacterList();i<a;)h=d.get(i),d=d.set(i,o?n.applyStyle(h,r):n.removeStyle(h,r)),i++;return e.set("characterList",d)}));return e.merge({blockMap:a.merge(h),selectionBefore:t,selectionAfter:t})}e.exports=o},3935:(e,t,r)=>{"use strict";function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var i=r(6143),o=r(5037),a=r(978),s=r(4453),l=r(6415),c=r(8691),u=s.Map,h={subtree:!0,characterData:!0,childList:!0,characterDataOldValue:!1,attributes:!1},d=i.isBrowser("IE <= 11"),f=function(){function e(e){var t=this;n(this,"observer",void 0),n(this,"container",void 0),n(this,"mutations",void 0),n(this,"onCharData",void 0),this.container=e,this.mutations=u();var r=a(e);r.MutationObserver&&!d?this.observer=new r.MutationObserver((function(e){return t.registerMutations(e)})):this.onCharData=function(e){e.target instanceof Node||l(!1),t.registerMutation({type:"characterData",target:e.target})}}var t=e.prototype;return t.start=function(){this.observer?this.observer.observe(this.container,h):this.container.addEventListener("DOMCharacterDataModified",this.onCharData)},t.stopAndFlushMutations=function(){var e=this.observer;e?(this.registerMutations(e.takeRecords()),e.disconnect()):this.container.removeEventListener("DOMCharacterDataModified",this.onCharData);var t=this.mutations;return this.mutations=u(),t},t.registerMutations=function(e){for(var t=0;t<e.length;t++)this.registerMutation(e[t])},t.getMutationTextContent=function(e){var t=e.type,r=e.target,n=e.removedNodes;if("characterData"===t){if(""!==r.textContent)return d?r.textContent.replace("\n",""):r.textContent}else if("childList"===t){if(n&&n.length)return"";if(""!==r.textContent)return r.textContent}return null},t.registerMutation=function(e){var t=this.getMutationTextContent(e);if(null!=t){var r=c(o(e.target));this.mutations=this.mutations.set(r,t)}},e}();e.exports=f},1144:(e,t,r)=>{"use strict";var n=r(5043),i=r(7904),o=(0,r(4453).Map)({"header-one":{element:"h1"},"header-two":{element:"h2"},"header-three":{element:"h3"},"header-four":{element:"h4"},"header-five":{element:"h5"},"header-six":{element:"h6"},section:{element:"section"},article:{element:"article"},"unordered-list-item":{element:"li",wrapper:n.createElement("ul",{className:i("public/DraftStyleDefault/ul")})},"ordered-list-item":{element:"li",wrapper:n.createElement("ol",{className:i("public/DraftStyleDefault/ol")})},blockquote:{element:"blockquote"},atomic:{element:"figure"},"code-block":{element:"pre",wrapper:n.createElement("pre",{className:i("public/DraftStyleDefault/pre")})},unstyled:{element:"div",aliasedElements:["p"]}});e.exports=o},8063:e=>{"use strict";e.exports={BOLD:{fontWeight:"bold"},CODE:{fontFamily:"monospace",wordWrap:"break-word"},ITALIC:{fontStyle:"italic"},STRIKETHROUGH:{textDecoration:"line-through"},UNDERLINE:{textDecoration:"underline"}}},4410:(e,t,r)=>{"use strict";var n=r(2370),i=r(3305),o=r(2367),a=r(3366),s=r(7707),l=r(4075),c=r(1144),u=r(8063),h=r(7538),d=r(7159),f=r(2593),g=r(5763),p=r(186),m=r(6283),v=r(2333),b=r(6966),y=r(169),w=r(4666),S=r(8421),C=r(3327),k=r(306),x=r(9684),E=r(4587),T={Editor:h,EditorBlock:d,EditorState:m,CompositeDecorator:a,Entity:f,EntityInstance:p,BlockMapBuilder:i,CharacterMetadata:o,ContentBlock:s,ContentState:l,RawDraftContentState:b,SelectionState:w,AtomicBlockUtils:n,KeyBindingUtil:v,Modifier:g,RichUtils:y,DefaultDraftBlockRenderMap:c,DefaultDraftInlineStyle:u,convertFromHTML:r(555),convertFromRaw:C,convertToRaw:S,genKey:k,getDefaultKeyBinding:x,getVisibleSelectionRect:E};e.exports=T},7538:(e,t,r)=>{"use strict";var n=r(2123);function i(){return i=n||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},i.apply(this,arguments)}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){s(e,t,r[t])}))}return e}function a(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function s(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function l(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}var c=r(1144),u=r(8063),h=r(5401),d=r(7996),f=r(1609),g=r(6627),p=r(8847),m=r(2251),v=r(8250),b=r(6283),y=r(5043),w=r(5914),S=r(1614),C=r(6143),k=r(7904),x=r(306),E=r(9684),T=r(8349),_=r(8819),A=r(6415),R=r(9990),O=r(8691),M=C.isBrowser("IE"),I=!M,P={edit:g,composite:h,drag:f,cut:null,render:null},N=!1,D=function(e){function t(){return e.apply(this,arguments)||this}l(t,e);var r=t.prototype;return r.render=function(){return null},r.componentDidMount=function(){this._update()},r.componentDidUpdate=function(){this._update()},r._update=function(){var e=this.props.editor;e._latestEditorState=this.props.editorState,e._blockSelectEvents=!0},t}(y.Component),F=function(e){function t(t){var r;return s(a(r=e.call(this,t)||this),"_blockSelectEvents",void 0),s(a(r),"_clipboard",void 0),s(a(r),"_handler",void 0),s(a(r),"_dragCount",void 0),s(a(r),"_internalDrag",void 0),s(a(r),"_editorKey",void 0),s(a(r),"_placeholderAccessibilityID",void 0),s(a(r),"_latestEditorState",void 0),s(a(r),"_latestCommittedEditorState",void 0),s(a(r),"_pendingStateFromBeforeInput",void 0),s(a(r),"_onBeforeInput",void 0),s(a(r),"_onBlur",void 0),s(a(r),"_onCharacterData",void 0),s(a(r),"_onCompositionEnd",void 0),s(a(r),"_onCompositionStart",void 0),s(a(r),"_onCopy",void 0),s(a(r),"_onCut",void 0),s(a(r),"_onDragEnd",void 0),s(a(r),"_onDragOver",void 0),s(a(r),"_onDragStart",void 0),s(a(r),"_onDrop",void 0),s(a(r),"_onInput",void 0),s(a(r),"_onFocus",void 0),s(a(r),"_onKeyDown",void 0),s(a(r),"_onKeyPress",void 0),s(a(r),"_onKeyUp",void 0),s(a(r),"_onMouseDown",void 0),s(a(r),"_onMouseUp",void 0),s(a(r),"_onPaste",void 0),s(a(r),"_onSelect",void 0),s(a(r),"editor",void 0),s(a(r),"editorContainer",void 0),s(a(r),"focus",void 0),s(a(r),"blur",void 0),s(a(r),"setMode",void 0),s(a(r),"exitCurrentMode",void 0),s(a(r),"restoreEditorDOM",void 0),s(a(r),"setClipboard",void 0),s(a(r),"getClipboard",void 0),s(a(r),"getEditorKey",void 0),s(a(r),"update",void 0),s(a(r),"onDragEnter",void 0),s(a(r),"onDragLeave",void 0),s(a(r),"_handleEditorContainerRef",(function(e){r.editorContainer=e,r.editor=null!==e?e.firstChild:null})),s(a(r),"focus",(function(e){var t=r.props.editorState,n=t.getSelection().getHasFocus(),i=r.editor;if(i){var o=S.getScrollParent(i),a=e||T(o),s=a.x,l=a.y;R(i)||A(!1),i.focus(),o===window?window.scrollTo(s,l):w.setTop(o,l),n||r.update(b.forceSelection(t,t.getSelection()))}})),s(a(r),"blur",(function(){var e=r.editor;e&&(R(e)||A(!1),e.blur())})),s(a(r),"setMode",(function(e){var t=r.props,n=t.onPaste,i=t.onCut,a=t.onCopy,s=o({},P.edit);n&&(s.onPaste=n),i&&(s.onCut=i),a&&(s.onCopy=a);var l=o({},P,{edit:s});r._handler=l[e]})),s(a(r),"exitCurrentMode",(function(){r.setMode("edit")})),s(a(r),"restoreEditorDOM",(function(e){r.setState({contentsKey:r.state.contentsKey+1},(function(){r.focus(e)}))})),s(a(r),"setClipboard",(function(e){r._clipboard=e})),s(a(r),"getClipboard",(function(){return r._clipboard})),s(a(r),"update",(function(e){r._latestEditorState=e,r.props.onChange(e)})),s(a(r),"onDragEnter",(function(){r._dragCount++})),s(a(r),"onDragLeave",(function(){r._dragCount--,0===r._dragCount&&r.exitCurrentMode()})),r._blockSelectEvents=!1,r._clipboard=null,r._handler=null,r._dragCount=0,r._editorKey=t.editorKey||x(),r._placeholderAccessibilityID="placeholder-"+r._editorKey,r._latestEditorState=t.editorState,r._latestCommittedEditorState=t.editorState,r._onBeforeInput=r._buildHandler("onBeforeInput"),r._onBlur=r._buildHandler("onBlur"),r._onCharacterData=r._buildHandler("onCharacterData"),r._onCompositionEnd=r._buildHandler("onCompositionEnd"),r._onCompositionStart=r._buildHandler("onCompositionStart"),r._onCopy=r._buildHandler("onCopy"),r._onCut=r._buildHandler("onCut"),r._onDragEnd=r._buildHandler("onDragEnd"),r._onDragOver=r._buildHandler("onDragOver"),r._onDragStart=r._buildHandler("onDragStart"),r._onDrop=r._buildHandler("onDrop"),r._onInput=r._buildHandler("onInput"),r._onFocus=r._buildHandler("onFocus"),r._onKeyDown=r._buildHandler("onKeyDown"),r._onKeyPress=r._buildHandler("onKeyPress"),r._onKeyUp=r._buildHandler("onKeyUp"),r._onMouseDown=r._buildHandler("onMouseDown"),r._onMouseUp=r._buildHandler("onMouseUp"),r._onPaste=r._buildHandler("onPaste"),r._onSelect=r._buildHandler("onSelect"),r.getEditorKey=function(){return r._editorKey},r.state={contentsKey:0},r}l(t,e);var n=t.prototype;return n._buildHandler=function(e){var t=this;return function(r){if(!t.props.readOnly){var n=t._handler&&t._handler[e];n&&(p?p((function(){return n(t,r)})):n(t,r))}}},n._showPlaceholder=function(){return!!this.props.placeholder&&!this.props.editorState.isInCompositionMode()&&!this.props.editorState.getCurrentContent().hasText()},n._renderPlaceholder=function(){if(this._showPlaceholder()){var e={text:O(this.props.placeholder),editorState:this.props.editorState,textAlignment:this.props.textAlignment,accessibilityID:this._placeholderAccessibilityID};return y.createElement(m,e)}return null},n._renderARIADescribedBy=function(){var e=this.props.ariaDescribedBy||"",t=this._showPlaceholder()?this._placeholderAccessibilityID:"";return e.replace("{{editor_id_placeholder}}",t)||void 0},n.render=function(){var e=this.props,t=e.blockRenderMap,r=e.blockRendererFn,n=e.blockStyleFn,a=e.customStyleFn,s=e.customStyleMap,l=e.editorState,c=e.preventScroll,h=e.readOnly,f=e.textAlignment,g=e.textDirectionality,p=k({"DraftEditor/root":!0,"DraftEditor/alignLeft":"left"===f,"DraftEditor/alignRight":"right"===f,"DraftEditor/alignCenter":"center"===f}),m=this.props.role||"textbox",v="combobox"===m?!!this.props.ariaExpanded:null,b={blockRenderMap:t,blockRendererFn:r,blockStyleFn:n,customStyleMap:o({},u,s),customStyleFn:a,editorKey:this._editorKey,editorState:l,preventScroll:c,textDirectionality:g};return y.createElement("div",{className:p},this._renderPlaceholder(),y.createElement("div",{className:k("DraftEditor/editorContainer"),ref:this._handleEditorContainerRef},y.createElement("div",{"aria-activedescendant":h?null:this.props.ariaActiveDescendantID,"aria-autocomplete":h?null:this.props.ariaAutoComplete,"aria-controls":h?null:this.props.ariaControls,"aria-describedby":this._renderARIADescribedBy(),"aria-expanded":h?null:v,"aria-label":this.props.ariaLabel,"aria-labelledby":this.props.ariaLabelledBy,"aria-multiline":this.props.ariaMultiline,"aria-owns":h?null:this.props.ariaOwneeID,autoCapitalize:this.props.autoCapitalize,autoComplete:this.props.autoComplete,autoCorrect:this.props.autoCorrect,className:k({notranslate:!h,"public/DraftEditor/content":!0}),contentEditable:!h,"data-testid":this.props.webDriverTestID,onBeforeInput:this._onBeforeInput,onBlur:this._onBlur,onCompositionEnd:this._onCompositionEnd,onCompositionStart:this._onCompositionStart,onCopy:this._onCopy,onCut:this._onCut,onDragEnd:this._onDragEnd,onDragEnter:this.onDragEnter,onDragLeave:this.onDragLeave,onDragOver:this._onDragOver,onDragStart:this._onDragStart,onDrop:this._onDrop,onFocus:this._onFocus,onInput:this._onInput,onKeyDown:this._onKeyDown,onKeyPress:this._onKeyPress,onKeyUp:this._onKeyUp,onMouseUp:this._onMouseUp,onPaste:this._onPaste,onSelect:this._onSelect,ref:this.props.editorRef,role:h?null:m,spellCheck:I&&this.props.spellCheck,style:{outline:"none",userSelect:"text",WebkitUserSelect:"text",whiteSpace:"pre-wrap",wordWrap:"break-word"},suppressContentEditableWarning:!0,tabIndex:this.props.tabIndex},y.createElement(D,{editor:this,editorState:l}),y.createElement(d,i({},b,{key:"contents"+this.state.contentsKey})))))},n.componentDidMount=function(){this._blockSelectEvents=!1,!N&&_("draft_ods_enabled")&&(N=!0,v.initODS()),this.setMode("edit"),M&&(this.editor?this.editor.ownerDocument.execCommand("AutoUrlDetect",!1,!1):r.g.execCommand("AutoUrlDetect",!1,!1))},n.componentDidUpdate=function(){this._blockSelectEvents=!1,this._latestEditorState=this.props.editorState,this._latestCommittedEditorState=this.props.editorState},t}(y.Component);s(F,"defaultProps",{ariaDescribedBy:"{{editor_id_placeholder}}",blockRenderMap:c,blockRendererFn:function(){return null},blockStyleFn:function(){return""},keyBindingFn:E,readOnly:!1,spellCheck:!1,stripPastedStyles:!1}),e.exports=F},7159:(e,t,r)=>{"use strict";var n=r(2123);function i(){return i=n||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},i.apply(this,arguments)}var o=r(3586),a=r(4414),s=r(5043),l=r(5914),c=r(1614),u=r(5782),h=r(4669),d=r(7904),f=r(636),g=r(8349),p=r(5628),m=r(6415),v=r(9990),b=r(8691),y=function(e,t){return e.getAnchorKey()===t||e.getFocusKey()===t},w=function(e){var t,r;function n(){for(var t,r,n,i,o=arguments.length,a=new Array(o),s=0;s<o;s++)a[s]=arguments[s];return t=e.call.apply(e,[this].concat(a))||this,r=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(t),i=void 0,(n="_node")in r?Object.defineProperty(r,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):r[n]=i,t}r=e,(t=n).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var w=n.prototype;return w.shouldComponentUpdate=function(e){return this.props.block!==e.block||this.props.tree!==e.tree||this.props.direction!==e.direction||y(e.selection,e.block.getKey())&&e.forceSelection},w.componentDidMount=function(){if(!this.props.preventScroll){var e=this.props.selection,t=e.getEndKey();if(e.getHasFocus()&&t===this.props.block.getKey()){var r=this._node;if(null!=r){var n,i=c.getScrollParent(r),o=g(i);if(i===window){var a=f(r);(n=a.y+a.height-p().height)>0&&window.scrollTo(o.x,o.y+n+10)}else{v(r)||m(!1),(n=r.offsetHeight+r.offsetTop-(i.offsetTop+i.offsetHeight+o.y))>0&&l.setTop(i,l.getTop(i)+n+10)}}}}},w._renderChildren=function(){var e=this,t=this.props.block,r=t.getKey(),n=t.getText(),l=this.props.tree.size-1,c=y(this.props.selection,r);return this.props.tree.map((function(d,f){var g=d.get("leaves");if(0===g.size)return null;var p=g.size-1,m=g.map((function(i,u){var h=a.encode(r,f,u),d=i.get("start"),g=i.get("end");return s.createElement(o,{key:h,offsetKey:h,block:t,start:d,selection:c?e.props.selection:null,forceSelection:e.props.forceSelection,text:n.slice(d,g),styleSet:t.getInlineStyleAt(d),customStyleMap:e.props.customStyleMap,customStyleFn:e.props.customStyleFn,isLast:f===l&&u===p})})).toArray(),v=d.get("decoratorKey");if(null==v)return m;if(!e.props.decorator)return m;var y=b(e.props.decorator),w=y.getComponentForKey(v);if(!w)return m;var S=y.getPropsForKey(v),C=a.encode(r,f,0),k=g.first().get("start"),x=g.last().get("end"),E=n.slice(k,x),T=t.getEntityAt(d.get("start")),_=h.getHTMLDirIfDifferent(u.getDirection(E),e.props.direction),A={contentState:e.props.contentState,decoratedText:E,dir:_,start:k,end:x,blockKey:r,entityKey:T,offsetKey:C};return s.createElement(w,i({},S,A,{key:C}),m)})).toArray()},w.render=function(){var e=this,t=this.props,r=t.direction,n=t.offsetKey,i=d({"public/DraftStyleDefault/block":!0,"public/DraftStyleDefault/ltr":"LTR"===r,"public/DraftStyleDefault/rtl":"RTL"===r});return s.createElement("div",{"data-offset-key":n,className:i,ref:function(t){return e._node=t}},this._renderChildren())},n}(s.Component);e.exports=w},5103:(e,t,r)=>{"use strict";var n=r(2123);function i(){return i=n||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},i.apply(this,arguments)}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){a(e,t,r[t])}))}return e}function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var s=r(9358),l=r(4414),c=r(5043),u=r(5914),h=r(1614),d=r(636),f=r(8349),g=r(5628),p=r(4453),m=r(6415),v=r(9990),b=(p.List,function(e,t){return e.getAnchorKey()===t||e.getFocusKey()===t}),y=function(e,t){var r=t.get(e.getType())||t.get("unstyled"),n=r.wrapper;return{Element:r.element||t.get("unstyled").element,wrapperTemplate:n}},w=function(e,t){var r=t(e);return r?{CustomComponent:r.component,customProps:r.props,customEditable:r.editable}:{}},S=function(e,t,r,n,i,a){var s={"data-block":!0,"data-editor":t,"data-offset-key":r,key:e.getKey(),ref:a},l=n(e);return l&&(s.className=l),void 0!==i.customEditable&&(s=o({},s,{contentEditable:i.customEditable,suppressContentEditableWarning:!0})),s},C=function(e){var t,r;function n(){for(var t,r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return a(function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(t=e.call.apply(e,[this].concat(n))||this),"wrapperRef",c.createRef()),t}r=e,(t=n).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var p=n.prototype;return p.shouldComponentUpdate=function(e){var t=this.props,r=t.block,n=t.direction,i=t.tree,o=!r.getChildKeys().isEmpty(),a=r!==e.block||i!==e.tree||n!==e.direction||b(e.selection,e.block.getKey())&&e.forceSelection;return o||a},p.componentDidMount=function(){var e=this.props.selection,t=e.getEndKey();if(e.getHasFocus()&&t===this.props.block.getKey()){var r=this.wrapperRef.current;if(r){var n,i=h.getScrollParent(r),o=f(i);if(i===window){var a=d(r);(n=a.y+a.height-g().height)>0&&window.scrollTo(o.x,o.y+n+10)}else{v(r)||m(!1);var s=r;(n=s.offsetHeight+s.offsetTop-(i.offsetHeight+o.y))>0&&u.setTop(i,u.getTop(i)+n+10)}}}},p.render=function(){var e=this,t=this.props,r=t.block,a=t.blockRenderMap,u=t.blockRendererFn,h=t.blockStyleFn,d=t.contentState,f=t.decorator,g=t.editorKey,p=t.editorState,m=t.customStyleFn,v=t.customStyleMap,C=t.direction,k=t.forceSelection,x=t.selection,E=t.tree,T=null;r.children.size&&(T=r.children.reduce((function(t,r){var i=l.encode(r,0,0),s=d.getBlockForKey(r),f=w(s,u),m=f.CustomComponent||n,v=y(s,a),b=v.Element,C=v.wrapperTemplate,k=S(s,g,i,h,f,null),x=o({},e.props,{tree:p.getBlockTree(r),blockProps:f.customProps,offsetKey:i,block:s});return t.push(c.createElement(b,k,c.createElement(m,x))),!C||function(e,t){var r=e.getNextSiblingKey();return!!r&&t.getBlockForKey(r).getType()===e.getType()}(s,d)||function(e,t,r){var n=[],i=!0,o=!1,a=void 0;try{for(var s,u=r.reverse()[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var h=s.value;if(h.type!==t)break;n.push(h)}}catch(g){o=!0,a=g}finally{try{i||null==u.return||u.return()}finally{if(o)throw a}}r.splice(r.indexOf(n[0]),n.length+1);var d=n.reverse(),f=d[0].key;r.push(c.cloneElement(e,{key:"".concat(f,"-wrap"),"data-offset-key":l.encode(f,0,0)},d))}(C,b,t),t}),[]));var _=r.getKey(),A=l.encode(_,0,0),R=w(r,u),O=R.CustomComponent,M=null!=O?c.createElement(O,i({},this.props,{tree:p.getBlockTree(_),blockProps:R.customProps,offsetKey:A,block:r})):c.createElement(s,{block:r,children:T,contentState:d,customStyleFn:m,customStyleMap:v,decorator:f,direction:C,forceSelection:k,hasSelection:b(x,_),selection:x,tree:E});if(r.getParentKey())return M;var I=y(r,a).Element,P=S(r,g,A,h,R,this.wrapperRef);return c.createElement(I,P,M)},n}(c.Component);e.exports=C},5401:(e,t,r)=>{"use strict";var n=r(3935),i=r(5763),o=r(4414),a=r(6283),s=r(4923),l=r(6143),c=r(2124),u=r(4909),h=r(7809),d=r(5036),f=r(8691),g=l.isBrowser("IE"),p=!1,m=!1,v=null;var b={onCompositionStart:function(e){m=!0,function(e){v||(v=new n(u(e))).start()}(e)},onCompositionEnd:function(e){p=!1,m=!1,setTimeout((function(){p||b.resolveComposition(e)}),20)},onSelect:c,onKeyDown:function(e,t){if(!m)return b.resolveComposition(e),void e._onKeyDown(t);t.which!==s.RIGHT&&t.which!==s.LEFT||t.preventDefault()},onKeyPress:function(e,t){t.which===s.RETURN&&t.preventDefault()},resolveComposition:function(e){if(!m){var t=f(v).stopAndFlushMutations();v=null,p=!0;var r=a.set(e._latestEditorState,{inCompositionMode:!1});if(e.exitCurrentMode(),t.size){var n=r.getCurrentContent();t.forEach((function(e,t){var s=o.decode(t),l=s.blockKey,c=s.decoratorKey,u=s.leafKey,h=r.getBlockTree(l).getIn([c,"leaves",u]),f=h.start,g=h.end,p=r.getSelection().merge({anchorKey:l,focusKey:l,anchorOffset:f,focusOffset:g,isBackward:!1}),m=d(n,p),v=n.getBlockForKey(l).getInlineStyleAt(f);n=i.replaceText(n,p,e,v,m),r=a.set(r,{currentContent:n})}));var s=h(r,u(e)).selectionState;e.restoreEditorDOM();var l=g?a.forceSelection(r,s):a.acceptSelection(r,s);e.update(a.push(l,n,"insert-characters"))}else e.update(r)}}};e.exports=b},1984:(e,t,r)=>{"use strict";var n=r(2123);function i(){return i=n||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},i.apply(this,arguments)}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){a(e,t,r[t])}))}return e}function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var s=r(7159),l=r(4414),c=r(5043),u=r(7904),h=r(947),d=r(8691),f=function(e,t,r,n){return u({"public/DraftStyleDefault/unorderedListItem":"unordered-list-item"===e,"public/DraftStyleDefault/orderedListItem":"ordered-list-item"===e,"public/DraftStyleDefault/reset":r,"public/DraftStyleDefault/depth0":0===t,"public/DraftStyleDefault/depth1":1===t,"public/DraftStyleDefault/depth2":2===t,"public/DraftStyleDefault/depth3":3===t,"public/DraftStyleDefault/depth4":t>=4,"public/DraftStyleDefault/listLTR":"LTR"===n,"public/DraftStyleDefault/listRTL":"RTL"===n})},g=function(e){var t,r;function n(){return e.apply(this,arguments)||this}r=e,(t=n).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var a=n.prototype;return a.shouldComponentUpdate=function(e){var t=this.props.editorState,r=e.editorState;if(t.getDirectionMap()!==r.getDirectionMap())return!0;if(t.getSelection().getHasFocus()!==r.getSelection().getHasFocus())return!0;var n=r.getNativelyRenderedContent(),i=t.isInCompositionMode(),o=r.isInCompositionMode();if(t===r||null!==n&&r.getCurrentContent()===n||i&&o)return!1;var a=t.getCurrentContent(),s=r.getCurrentContent(),l=t.getDecorator(),c=r.getDecorator();return i!==o||a!==s||l!==c||r.mustForceSelection()},a.render=function(){for(var e=this.props,t=e.blockRenderMap,r=e.blockRendererFn,n=e.blockStyleFn,a=e.customStyleMap,u=e.customStyleFn,g=e.editorState,p=e.editorKey,m=e.preventScroll,v=e.textDirectionality,b=g.getCurrentContent(),y=g.getSelection(),w=g.mustForceSelection(),S=g.getDecorator(),C=d(g.getDirectionMap()),k=b.getBlocksAsArray(),x=[],E=null,T=null,_=0;_<k.length;_++){var A=k[_],R=A.getKey(),O=A.getType(),M=r(A),I=void 0,P=void 0,N=void 0;M&&(I=M.component,P=M.props,N=M.editable);var D=v||C.get(R),F=l.encode(R,0,0),L={contentState:b,block:A,blockProps:P,blockStyleFn:n,customStyleMap:a,customStyleFn:u,decorator:S,direction:D,forceSelection:w,offsetKey:F,preventScroll:m,selection:y,tree:g.getBlockTree(R)},H=t.get(O)||t.get("unstyled"),B=H.wrapper,U=H.element||t.get("unstyled").element,j=A.getDepth(),W="";if(n&&(W=n(A)),"li"===U)W=h(W,f(O,j,T!==B||null===E||j>E,D));var V=I||s,z={className:W,"data-block":!0,"data-editor":p,"data-offset-key":F,key:R};void 0!==N&&(z=o({},z,{contentEditable:N,suppressContentEditableWarning:!0}));var q=c.createElement(U,z,c.createElement(V,i({},L,{key:R})));x.push({block:q,wrapperTemplate:B,key:R,offsetKey:F}),E=B?A.getDepth():null,T=B}for(var G=[],$=0;$<x.length;){var K=x[$];if(K.wrapperTemplate){var Y=[];do{Y.push(x[$].block),$++}while($<x.length&&x[$].wrapperTemplate===K.wrapperTemplate);var X=c.cloneElement(K.wrapperTemplate,{key:K.key+"-wrap","data-offset-key":K.offsetKey},Y);G.push(X)}else G.push(K.block),$++}return c.createElement("div",{"data-contents":"true"},G)},n}(c.Component);e.exports=g},7996:(e,t,r)=>{"use strict";var n=r(8819)("draft_tree_data_support");e.exports=r(n?5714:1984)},5714:(e,t,r)=>{"use strict";var n=r(2123);function i(){return i=n||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},i.apply(this,arguments)}var o=r(5103),a=r(4414),s=r(5043),l=r(8691),c=function(e){var t,r;function n(){return e.apply(this,arguments)||this}r=e,(t=n).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var c=n.prototype;return c.shouldComponentUpdate=function(e){var t=this.props.editorState,r=e.editorState;if(t.getDirectionMap()!==r.getDirectionMap())return!0;if(t.getSelection().getHasFocus()!==r.getSelection().getHasFocus())return!0;var n=r.getNativelyRenderedContent(),i=t.isInCompositionMode(),o=r.isInCompositionMode();if(t===r||null!==n&&r.getCurrentContent()===n||i&&o)return!1;var a=t.getCurrentContent(),s=r.getCurrentContent(),l=t.getDecorator(),c=r.getDecorator();return i!==o||a!==s||l!==c||r.mustForceSelection()},c.render=function(){for(var e=this.props,t=e.blockRenderMap,r=e.blockRendererFn,n=e.blockStyleFn,c=e.customStyleMap,u=e.customStyleFn,h=e.editorState,d=e.editorKey,f=e.textDirectionality,g=h.getCurrentContent(),p=h.getSelection(),m=h.mustForceSelection(),v=h.getDecorator(),b=l(h.getDirectionMap()),y=[],w=g.getBlocksAsArray()[0];w;){var S=w.getKey(),C={blockRenderMap:t,blockRendererFn:r,blockStyleFn:n,contentState:g,customStyleFn:u,customStyleMap:c,decorator:v,editorKey:d,editorState:h,forceSelection:m,selection:p,block:w,direction:f||b.get(S),tree:h.getBlockTree(S)},k=(t.get(w.getType())||t.get("unstyled")).wrapper;y.push({block:s.createElement(o,i({key:S},C)),wrapperTemplate:k,key:S,offsetKey:a.encode(S,0,0)});var x=w.getNextSiblingKey();w=x?g.getBlockForKey(x):null}for(var E=[],T=0;T<y.length;){var _=y[T];if(_.wrapperTemplate){var A=[];do{A.push(y[T].block),T++}while(T<y.length&&y[T].wrapperTemplate===_.wrapperTemplate);var R=s.cloneElement(_.wrapperTemplate,{key:_.key+"-wrap","data-offset-key":_.offsetKey},A);E.push(R)}else E.push(_.block),T++}return s.createElement("div",{"data-contents":"true"},E)},n}(s.Component);e.exports=c},9523:(e,t,r)=>{"use strict";var n=r(2123);function i(){return i=n||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},i.apply(this,arguments)}var o=r(4414),a=r(5043),s=r(5782),l=r(4669),c=function(e){var t,r;function n(){return e.apply(this,arguments)||this}return r=e,(t=n).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r,n.prototype.render=function(){var e=this.props,t=e.block,r=e.children,n=e.contentState,c=e.decorator,u=e.decoratorKey,h=e.direction,d=e.leafSet,f=e.text,g=t.getKey(),p=d.get("leaves"),m=c.getComponentForKey(u),v=c.getPropsForKey(u),b=o.encode(g,parseInt(u,10),0),y=f.slice(p.first().get("start"),p.last().get("end")),w=l.getHTMLDirIfDifferent(s.getDirection(y),h);return a.createElement(m,i({},v,{contentState:n,decoratedText:y,dir:w,key:b,entityKey:t.getEntityAt(d.get("start")),offsetKey:b}),r)},n}(a.Component);e.exports=c},1609:(e,t,r)=>{"use strict";var n=r(6968),i=r(5763),o=r(6283),a=r(5037),s=r(8358),l=r(2962),c=r(4733),u=r(978),h=r(9303),d=r(8691);var f={onDragEnd:function(e){e.exitCurrentMode(),g(e)},onDrop:function(e,t){var r=new n(t.nativeEvent.dataTransfer),u=e._latestEditorState,f=function(e,t){var r=null,n=null,i=s(e.currentTarget);if("function"===typeof i.caretRangeFromPoint){var o=i.caretRangeFromPoint(e.x,e.y);r=o.startContainer,n=o.startOffset}else{if(!e.rangeParent)return null;r=e.rangeParent,n=e.rangeOffset}r=d(r),n=d(n);var l=d(a(r));return c(t,l,n,l,n)}(t.nativeEvent,u);if(t.preventDefault(),e._dragCount=0,e.exitCurrentMode(),null!=f){var m=r.getFiles();if(m.length>0){if(e.props.handleDroppedFiles&&h(e.props.handleDroppedFiles(f,m)))return;l(m,(function(t){t&&e.update(p(u,f,t))}))}else{var v=e._internalDrag?"internal":"external";e.props.handleDrop&&h(e.props.handleDrop(f,r,v))||(e._internalDrag?e.update(function(e,t){var r=i.moveText(e.getCurrentContent(),e.getSelection(),t);return o.push(e,r,"insert-fragment")}(u,f)):e.update(p(u,f,r.getText()))),g(e)}}}};function g(e){e._internalDrag=!1;var t=e.editorContainer;if(t){var r=new MouseEvent("mouseup",{view:u(t),bubbles:!0,cancelable:!0});t.dispatchEvent(r)}}function p(e,t,r){var n=i.insertText(e.getCurrentContent(),t,r,e.getCurrentInlineStyle());return o.push(e,n,"insert-fragment")}e.exports=f},6627:(e,t,r)=>{"use strict";var n=r(6143),i=r(1363),o=r(1933),a=r(9678),s=r(5169),l=r(6350),c=r(7660),u=r(8796),h=r(5722),d=r(78),f=r(617),g=r(7677),p=r(2124),m=n.isBrowser("Chrome"),v=n.isBrowser("Firefox"),b=m||v?p:function(e){},y={onBeforeInput:i,onBlur:o,onCompositionStart:a,onCopy:s,onCut:l,onDragOver:c,onDragStart:u,onFocus:h,onInput:d,onKeyDown:f,onPaste:g,onSelect:p,onMouseUp:b,onKeyUp:b};e.exports=y},8847:(e,t,r)=>{"use strict";var n=r(7950).unstable_flushControlled;e.exports=n},3586:(e,t,r)=>{"use strict";var n=r(2123);var i=r(317),o=r(5043),a=r(6415),s=r(5030),l=r(1981).setDraftEditorSelection,c=function(e){var t,r;function c(){for(var t,r,n,i,o=arguments.length,a=new Array(o),s=0;s<o;s++)a[s]=arguments[s];return t=e.call.apply(e,[this].concat(a))||this,r=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(t),i=void 0,(n="leaf")in r?Object.defineProperty(r,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):r[n]=i,t}r=e,(t=c).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var u=c.prototype;return u._setSelection=function(){var e=this.props.selection;if(null!=e&&e.getHasFocus()){var t=this.props,r=t.block,n=t.start,i=t.text,o=r.getKey(),c=n+i.length;if(e.hasEdgeWithin(o,n,c)){var u=this.leaf;u||a(!1);var h,d=u.firstChild;d||a(!1),d.nodeType===Node.TEXT_NODE?h=d:s(d)?h=u:(h=d.firstChild)||a(!1),l(e,h,o,n,c)}}},u.shouldComponentUpdate=function(e){var t=this.leaf;return t||a(!1),t.textContent!==e.text||e.styleSet!==this.props.styleSet||e.forceSelection},u.componentDidUpdate=function(){this._setSelection()},u.componentDidMount=function(){this._setSelection()},u.render=function(){var e=this,t=this.props.block,r=this.props.text;r.endsWith("\n")&&this.props.isLast&&(r+="\n");var a=this.props,s=a.customStyleMap,l=a.customStyleFn,c=a.offsetKey,u=a.styleSet,h=u.reduce((function(e,t){var r={},i=s[t];return void 0!==i&&e.textDecoration!==i.textDecoration&&(r.textDecoration=[e.textDecoration,i.textDecoration].join(" ").trim()),n(e,i,r)}),{});if(l){var d=l(u,t);h=n(h,d)}return o.createElement("span",{"data-offset-key":c,ref:function(t){return e.leaf=t},style:h},o.createElement(i,null,r))},c}(o.Component);e.exports=c},9358:(e,t,r)=>{"use strict";var n=r(9523),i=r(3586),o=r(4414),a=r(4453),s=r(5043),l=r(7904),c=(a.List,function(e){var t,r;function a(){return e.apply(this,arguments)||this}return r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r,a.prototype.render=function(){var e=this.props,t=e.block,r=e.contentState,a=e.customStyleFn,c=e.customStyleMap,u=e.decorator,h=e.direction,d=e.forceSelection,f=e.hasSelection,g=e.selection,p=e.tree,m=t.getKey(),v=t.getText(),b=p.size-1,y=this.props.children||p.map((function(e,l){var p=e.get("decoratorKey"),y=e.get("leaves"),w=y.size-1,S=y.map((function(e,r){var n=o.encode(m,l,r),u=e.get("start"),h=e.get("end");return s.createElement(i,{key:n,offsetKey:n,block:t,start:u,selection:f?g:null,forceSelection:d,text:v.slice(u,h),styleSet:t.getInlineStyleAt(u),customStyleMap:c,customStyleFn:a,isLast:p===b&&r===w})})).toArray();return p&&u?s.createElement(n,{block:t,children:S,contentState:r,decorator:u,decoratorKey:p,direction:h,leafSet:e,text:v,key:l}):S})).toArray();return s.createElement("div",{"data-offset-key":o.encode(m,0,0),className:l({"public/DraftStyleDefault/block":!0,"public/DraftStyleDefault/ltr":"LTR"===h,"public/DraftStyleDefault/rtl":"RTL"===h})},y)},a}(s.Component));e.exports=c},2251:(e,t,r)=>{"use strict";var n=r(5043),i=r(7904),o=function(e){var t,r;function o(){return e.apply(this,arguments)||this}r=e,(t=o).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var a=o.prototype;return a.shouldComponentUpdate=function(e){return this.props.text!==e.text||this.props.editorState.getSelection().getHasFocus()!==e.editorState.getSelection().getHasFocus()},a.render=function(){var e=this.props.editorState.getSelection().getHasFocus(),t=i({"public/DraftEditorPlaceholder/root":!0,"public/DraftEditorPlaceholder/hasFocus":e});return n.createElement("div",{className:t},n.createElement("div",{className:i("public/DraftEditorPlaceholder/inner"),id:this.props.accessibilityID,style:{whiteSpace:"pre-wrap"}},this.props.text))},o}(n.Component);e.exports=o},317:(e,t,r)=>{"use strict";function n(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var o=r(5043),a=r(6143),s=r(6415),l=r(7385),c=a.isBrowser("IE <= 11");var u=function(e){var t,r;function a(t){var r;return i(n(r=e.call(this,t)||this),"_forceFlag",void 0),i(n(r),"_node",void 0),r._forceFlag=!1,r}r=e,(t=a).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var u=a.prototype;return u.shouldComponentUpdate=function(e){var t=this._node,r=""===e.children;l(t)||s(!1);var n=t;return r?!function(e){return c?"\n"===e.textContent:"BR"===e.tagName}(n):n.textContent!==e.children},u.componentDidMount=function(){this._forceFlag=!this._forceFlag},u.componentDidUpdate=function(){this._forceFlag=!this._forceFlag},u.render=function(){var e,t=this;return""===this.props.children?this._forceFlag?(e=function(e){return t._node=e},c?o.createElement("span",{key:"A","data-text":"true",ref:e},"\n"):o.createElement("br",{key:"A","data-text":"true",ref:e})):function(e){return c?o.createElement("span",{key:"B","data-text":"true",ref:e},"\n"):o.createElement("br",{key:"B","data-text":"true",ref:e})}((function(e){return t._node=e})):o.createElement("span",{key:this._forceFlag?"A":"B","data-text":"true",ref:function(e){return t._node=e}},this.props.children)},a}(o.Component);e.exports=u},8250:e=>{"use strict";e.exports={initODS:function(){},handleExtensionCausedError:function(){}}},2593:(e,t,r)=>{"use strict";function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var i=r(186),o=r(4453),a=r(6415),s=r(6246),l=(0,o.Map)(),c=s();function u(e,t){console.warn("WARNING: "+e+' will be deprecated soon!\nPlease use "'+t+'" instead.')}var h={getLastCreatedEntityKey:function(){return u("DraftEntity.getLastCreatedEntityKey","contentState.getLastCreatedEntityKey"),h.__getLastCreatedEntityKey()},create:function(e,t,r){return u("DraftEntity.create","contentState.createEntity"),h.__create(e,t,r)},add:function(e){return u("DraftEntity.add","contentState.addEntity"),h.__add(e)},get:function(e){return u("DraftEntity.get","contentState.getEntity"),h.__get(e)},__getAll:function(){return l},__loadWithEntities:function(e){l=e,c=s()},mergeData:function(e,t){return u("DraftEntity.mergeData","contentState.mergeEntityData"),h.__mergeData(e,t)},replaceData:function(e,t){return u("DraftEntity.replaceData","contentState.replaceEntityData"),h.__replaceData(e,t)},__getLastCreatedEntityKey:function(){return c},__create:function(e,t,r){return h.__add(new i({type:e,mutability:t,data:r||{}}))},__add:function(e){return c=s(),l=l.set(c,e),c},__get:function(e){var t=l.get(e);return t||a(!1),t},__mergeData:function(e,t){var r=h.__get(e),i=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},i=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),i.forEach((function(t){n(e,t,r[t])}))}return e}({},r.getData(),t),o=r.set("data",i);return l=l.set(e,o),o},__replaceData:function(e,t){var r=h.__get(e).set("data",t);return l=l.set(e,r),r}};e.exports=h},186:(e,t,r)=>{"use strict";var n=function(e){var t,r;function n(){return e.apply(this,arguments)||this}r=e,(t=n).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var i=n.prototype;return i.getType=function(){return this.get("type")},i.getMutability=function(){return this.get("mutability")},i.getData=function(){return this.get("data")},n}((0,r(4453).Record)({type:"TOKEN",mutability:"IMMUTABLE",data:Object}));e.exports=n},7003:e=>{"use strict";e.exports={getRemovalRange:function(e,t,r,n,i){var o=r.split(" ");o=o.map((function(e,t){if("forward"===i){if(t>0)return" "+e}else if(t<o.length-1)return e+" ";return e}));for(var a,s=n,l=null,c=null,u=0;u<o.length;u++){if(e<(a=s+o[u].length)&&s<t)null!==l||(l=s),c=a;else if(null!==l)break;s=a}var h=n+r.length,d=l===n,f=c===h;return(!d&&f||d&&!f)&&("forward"===i?c!==h&&c++:l!==n&&l--),{start:l,end:c}}}},8645:e=>{"use strict";e.exports={logBlockedSelectionEvent:function(){return null},logSelectionStateFailure:function(){return null}}},5763:(e,t,r)=>{"use strict";var n=r(2367),i=r(1589),o=r(3633),a=r(9639),s=r(6935),l=r(4453),c=r(3384),u=r(5311),h=r(6415),d=r(1477),f=r(9529),g=r(5638),p=r(8701),m=l.OrderedSet,v={replaceText:function(e,t,r,i,o){var a=f(e,t),s=g(a,t),l=n.create({style:i||m(),entity:o||null});return u(s,s.getSelectionAfter(),r,l)},insertText:function(e,t,r,n,i){return t.isCollapsed()||h(!1),v.replaceText(e,t,r,n,i)},moveText:function(e,t,r){var n=s(e,t),i=v.removeRange(e,t,"backward");return v.replaceWithFragment(i,r,n)},replaceWithFragment:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"REPLACE_WITH_NEW_DATA",i=f(e,t),o=g(i,t);return c(o,o.getSelectionAfter(),r,n)},removeRange:function(e,t,r){var n,i,o,s;t.getIsBackward()&&(t=t.merge({anchorKey:t.getFocusKey(),anchorOffset:t.getFocusOffset(),focusKey:t.getAnchorKey(),focusOffset:t.getAnchorOffset(),isBackward:!1})),n=t.getAnchorKey(),i=t.getFocusKey(),o=e.getBlockForKey(n),s=e.getBlockForKey(i);var l=t.getStartOffset(),c=t.getEndOffset(),u=o.getEntityAt(l),h=s.getEntityAt(c-1);if(n===i&&u&&u===h){var d=a(e.getEntityMap(),o,s,t,r);return g(e,d)}var p=f(e,t);return g(p,t)},splitBlock:function(e,t){var r=f(e,t),n=g(r,t);return p(n,n.getSelectionAfter())},applyInlineStyle:function(e,t,r){return i.add(e,t,r)},removeInlineStyle:function(e,t,r){return i.remove(e,t,r)},setBlockType:function(e,t,r){return d(e,t,(function(e){return e.merge({type:r,depth:0})}))},setBlockData:function(e,t,r){return d(e,t,(function(e){return e.merge({data:r})}))},mergeBlockData:function(e,t,r){return d(e,t,(function(e){return e.merge({data:e.getData().merge(r)})}))},applyEntity:function(e,t,r){var n=f(e,t);return o(n,t,r)}};e.exports=v},4414:e=>{"use strict";var t="-",r={encode:function(e,r,n){return e+t+r+t+n},decode:function(e){var r=e.split(t).reverse(),n=r[0],i=r[1];return{blockKey:r.slice(2).reverse().join(t),decoratorKey:parseInt(i,10),leafKey:parseInt(n,10)}}};e.exports=r},6959:(e,t,r)=>{"use strict";function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var i=r(7707),o=r(6559),a=r(555),s=r(306),l=r(6357),c=r(8819),u=r(4453),h=r(3272),d=u.List,f=u.Repeat,g=c("draft_tree_data_support"),p=g?o:i,m={processHTML:function(e,t){return a(e,l,t)},processText:function(e,t,r){return e.reduce((function(e,i,o){i=h(i);var a=s(),l={key:a,type:r,text:i,characterList:d(f(t,i.length))};if(g&&0!==o){var c=o-1;l=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},i=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),i.forEach((function(t){n(e,t,r[t])}))}return e}({},l,{prevSibling:(e[c]=e[c].merge({nextSibling:a})).getKey()})}return e.push(new p(l)),e}),[])}};e.exports=m},4801:(e,t,r)=>{"use strict";var n="['\u2018\u2019]",i="\\s|(?![_])"+r(8978).getPunctuation(),o=new RegExp("^(?:"+i+")*(?:"+n+"|(?!"+i+").)*(?:(?!"+i+").)"),a=new RegExp("(?:(?!"+i+").)(?:"+n+"|(?!"+i+").)*(?:"+i+")*$");function s(e,t){var r=t?a.exec(e):o.exec(e);return r?r[0]:e}var l={getBackward:function(e){return s(e,!0)},getForward:function(e){return s(e,!1)}};e.exports=l},4088:e=>{"use strict";var t={stringify:function(e){return"_"+String(e)},unstringify:function(e){return e.slice(1)}};e.exports=t},7551:(e,t,r)=>{"use strict";function n(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){i(e,t,r[t])}))}return e}function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var o=r(306),a=r(6415),s=function(e){if(!e||!e.type)return!1;var t=e.type;return"unordered-list-item"===t||"ordered-list-item"===t},l={fromRawTreeStateToRawState:function(e){var t=e.blocks,r=[];return Array.isArray(t)||a(!1),Array.isArray(t)&&t.length?(function(e,t){for(var r=[].concat(e).reverse();r.length;){var n=r.pop();t(n);var i=n.children;Array.isArray(i)||a(!1),r=r.concat([].concat(i.reverse()))}}(t,(function(e){var t=n({},e);s(e)&&(t.depth=t.depth||0,function(e){Array.isArray(e.children)&&(e.children=e.children.map((function(t){return t.type===e.type?n({},t,{depth:(e.depth||0)+1}):t})))}(e),null!=e.children&&e.children.length>0)||(delete t.children,r.push(t))})),e.blocks=r,n({},e,{blocks:r})):e},fromRawStateToRawTreeState:function(e){var t=[],r=[];return e.blocks.forEach((function(e){var i=s(e),a=e.depth||0,l=n({},e,{children:[]});if(i){var c=r[0];if(null==c&&0===a)t.push(l);else if(null==c||c.depth<a-1){var u={key:o(),text:"",depth:a-1,type:e.type,children:[],entityRanges:[],inlineStyleRanges:[]};r.unshift(u),1===a?t.push(u):null!=c&&c.children.push(u),u.children.push(l)}else if(c.depth===a-1)c.children.push(l);else{for(;null!=c&&c.depth>=a;)r.shift(),c=r[0];a>0?c.children.push(l):t.push(l)}}else t.push(l)})),n({},e,{blocks:t})}};e.exports=l},4863:(e,t,r)=>{"use strict";r(7443);e.exports={isValidBlock:function(e,t){var r=e.getKey(),n=e.getParentKey();if(null!=n&&!t.get(n).getChildKeys().includes(r))return!1;if(!e.getChildKeys().map((function(e){return t.get(e)})).every((function(e){return e.getParentKey()===r})))return!1;var i=e.getPrevSiblingKey();if(null!=i&&t.get(i).getNextSiblingKey()!==r)return!1;var o=e.getNextSiblingKey();if(null!=o&&t.get(o).getPrevSiblingKey()!==r)return!1;return(null===o||null===i||i!==o)&&!(""!=e.text&&e.getChildKeys().size>0)},isConnectedTree:function(e){var t=e.toArray().filter((function(e){return null==e.getParentKey()&&null==e.getPrevSiblingKey()}));if(1!==t.length)return!1;for(var r=0,n=t.shift().getKey(),i=[];null!=n;){var o=e.get(n),a=o.getChildKeys(),s=o.getNextSiblingKey();if(a.size>0){null!=s&&i.unshift(s);var l=a.map((function(t){return e.get(t)})).find((function(e){return null==e.getPrevSiblingKey()}));if(null==l)return!1;n=l.getKey()}else n=null!=o.getNextSiblingKey()?o.getNextSiblingKey():i.shift();r++}return r===e.size},isValidTree:function(e){var t=this;return!!e.toArray().every((function(r){return t.isValidBlock(r,e)}))&&this.isConnectedTree(e)}}},995:(e,t,r)=>{"use strict";var n,i=r(88),o=r(4453),a=r(8691),s=o.OrderedMap,l={getDirectionMap:function(e,t){n?n.reset():n=new i;var r=e.getBlockMap(),l=r.valueSeq().map((function(e){return a(n).getDirection(e.getText())})),c=s(r.keySeq().zip(l));return null!=t&&o.is(t,c)?t:c}};e.exports=l},6283:(e,t,r)=>{"use strict";function n(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){i(e,t,r[t])}))}return e}function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var o=r(8208),a=r(4075),s=r(995),l=r(4666),c=r(4453),u=c.OrderedSet,h=c.Record,d=c.Stack,f=c.OrderedMap,g=c.List,p=h({allowUndo:!0,currentContent:null,decorator:null,directionMap:null,forceSelection:!1,inCompositionMode:!1,inlineStyleOverride:null,lastChangeType:null,nativelyRenderedContent:null,redoStack:d(),selection:null,treeMap:null,undoStack:d()}),m=function(){t.createEmpty=function(e){return this.createWithText("",e)},t.createWithText=function(e,r){return t.createWithContent(a.createFromText(e),r)},t.createWithContent=function(e,r){if(0===e.getBlockMap().count())return t.createEmpty(r);var n=e.getBlockMap().first().getKey();return t.create({currentContent:e,undoStack:d(),redoStack:d(),decorator:r||null,selection:l.createEmpty(n)})},t.create=function(e){var r=e.currentContent,i=n({},e,{treeMap:b(r,e.decorator),directionMap:s.getDirectionMap(r)});return new t(new p(i))},t.fromJS=function(e){return new t(new p(n({},e,{directionMap:null!=e.directionMap?f(e.directionMap):e.directionMap,inlineStyleOverride:null!=e.inlineStyleOverride?u(e.inlineStyleOverride):e.inlineStyleOverride,nativelyRenderedContent:null!=e.nativelyRenderedContent?a.fromJS(e.nativelyRenderedContent):e.nativelyRenderedContent,redoStack:null!=e.redoStack?d(e.redoStack.map((function(e){return a.fromJS(e)}))):e.redoStack,selection:null!=e.selection?new l(e.selection):e.selection,treeMap:null!=e.treeMap?f(e.treeMap).map((function(e){return g(e).map((function(e){return o.fromJS(e)}))})):e.treeMap,undoStack:null!=e.undoStack?d(e.undoStack.map((function(e){return a.fromJS(e)}))):e.undoStack,currentContent:a.fromJS(e.currentContent)})))},t.set=function(e,r){return new t(e.getImmutable().withMutations((function(t){var n=t.get("decorator"),i=n;null===r.decorator?i=null:r.decorator&&(i=r.decorator);var a=r.currentContent||e.getCurrentContent();if(i!==n){var s,l=t.get("treeMap");return s=i&&n?function(e,t,r,n,i){return r.merge(t.toSeq().filter((function(t){return n.getDecorations(t,e)!==i.getDecorations(t,e)})).map((function(t){return o.generate(e,t,n)})))}(a,a.getBlockMap(),l,i,n):b(a,i),void t.merge({decorator:i,treeMap:s,nativelyRenderedContent:null})}a!==e.getCurrentContent()&&t.set("treeMap",function(e,t,r,n){var i=e.getCurrentContent().set("entityMap",r),a=i.getBlockMap(),s=e.getImmutable().get("treeMap");return s.merge(t.toSeq().filter((function(e,t){return e!==a.get(t)})).map((function(e){return o.generate(i,e,n)})))}(e,a.getBlockMap(),a.getEntityMap(),i)),t.merge(r)})))};var e=t.prototype;function t(e){i(this,"_immutable",void 0),this._immutable=e}return e.toJS=function(){return this.getImmutable().toJS()},e.getAllowUndo=function(){return this.getImmutable().get("allowUndo")},e.getCurrentContent=function(){return this.getImmutable().get("currentContent")},e.getUndoStack=function(){return this.getImmutable().get("undoStack")},e.getRedoStack=function(){return this.getImmutable().get("redoStack")},e.getSelection=function(){return this.getImmutable().get("selection")},e.getDecorator=function(){return this.getImmutable().get("decorator")},e.isInCompositionMode=function(){return this.getImmutable().get("inCompositionMode")},e.mustForceSelection=function(){return this.getImmutable().get("forceSelection")},e.getNativelyRenderedContent=function(){return this.getImmutable().get("nativelyRenderedContent")},e.getLastChangeType=function(){return this.getImmutable().get("lastChangeType")},e.getInlineStyleOverride=function(){return this.getImmutable().get("inlineStyleOverride")},t.setInlineStyleOverride=function(e,r){return t.set(e,{inlineStyleOverride:r})},e.getCurrentInlineStyle=function(){var e=this.getInlineStyleOverride();if(null!=e)return e;var t=this.getCurrentContent(),r=this.getSelection();return r.isCollapsed()?function(e,t){var r=t.getStartKey(),n=t.getStartOffset(),i=e.getBlockForKey(r);if(n>0)return i.getInlineStyleAt(n-1);if(i.getLength())return i.getInlineStyleAt(0);return y(e,r)}(t,r):function(e,t){var r=t.getStartKey(),n=t.getStartOffset(),i=e.getBlockForKey(r);if(n<i.getLength())return i.getInlineStyleAt(n);if(n>0)return i.getInlineStyleAt(n-1);return y(e,r)}(t,r)},e.getBlockTree=function(e){return this.getImmutable().getIn(["treeMap",e])},e.isSelectionAtStartOfContent=function(){var e=this.getCurrentContent().getBlockMap().first().getKey();return this.getSelection().hasEdgeWithin(e,0,0)},e.isSelectionAtEndOfContent=function(){var e=this.getCurrentContent().getBlockMap().last(),t=e.getLength();return this.getSelection().hasEdgeWithin(e.getKey(),t,t)},e.getDirectionMap=function(){return this.getImmutable().get("directionMap")},t.acceptSelection=function(e,t){return v(e,t,!1)},t.forceSelection=function(e,t){return t.getHasFocus()||(t=t.set("hasFocus",!0)),v(e,t,!0)},t.moveSelectionToEnd=function(e){var r=e.getCurrentContent().getLastBlock(),n=r.getKey(),i=r.getLength();return t.acceptSelection(e,new l({anchorKey:n,anchorOffset:i,focusKey:n,focusOffset:i,isBackward:!1}))},t.moveFocusToEnd=function(e){var r=t.moveSelectionToEnd(e);return t.forceSelection(r,r.getSelection())},t.push=function(e,r,n){var i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(e.getCurrentContent()===r)return e;var o=s.getDirectionMap(r,e.getDirectionMap());if(!e.getAllowUndo())return t.set(e,{currentContent:r,directionMap:o,lastChangeType:n,selection:r.getSelectionAfter(),forceSelection:i,inlineStyleOverride:null});var a=e.getSelection(),l=e.getCurrentContent(),c=e.getUndoStack(),u=r;a!==l.getSelectionAfter()||function(e,t){var r=e.getLastChangeType();return t!==r||"insert-characters"!==t&&"backspace-character"!==t&&"delete-character"!==t}(e,n)?(c=c.push(l),u=u.set("selectionBefore",a)):"insert-characters"!==n&&"backspace-character"!==n&&"delete-character"!==n||(u=u.set("selectionBefore",l.getSelectionBefore()));var h=e.getInlineStyleOverride();-1===["adjust-depth","change-block-type","split-block"].indexOf(n)&&(h=null);var f={currentContent:u,directionMap:o,undoStack:c,redoStack:d(),lastChangeType:n,selection:r.getSelectionAfter(),forceSelection:i,inlineStyleOverride:h};return t.set(e,f)},t.undo=function(e){if(!e.getAllowUndo())return e;var r=e.getUndoStack(),n=r.peek();if(!n)return e;var i=e.getCurrentContent(),o=s.getDirectionMap(n,e.getDirectionMap());return t.set(e,{currentContent:n,directionMap:o,undoStack:r.shift(),redoStack:e.getRedoStack().push(i),forceSelection:!0,inlineStyleOverride:null,lastChangeType:"undo",nativelyRenderedContent:null,selection:i.getSelectionBefore()})},t.redo=function(e){if(!e.getAllowUndo())return e;var r=e.getRedoStack(),n=r.peek();if(!n)return e;var i=e.getCurrentContent(),o=s.getDirectionMap(n,e.getDirectionMap());return t.set(e,{currentContent:n,directionMap:o,undoStack:e.getUndoStack().push(i),redoStack:r.shift(),forceSelection:!0,inlineStyleOverride:null,lastChangeType:"redo",nativelyRenderedContent:null,selection:n.getSelectionAfter()})},e.getImmutable=function(){return this._immutable},t}();function v(e,t,r){return m.set(e,{selection:t,forceSelection:r,nativelyRenderedContent:null,inlineStyleOverride:null})}function b(e,t){return e.getBlockMap().map((function(r){return o.generate(e,r,t)})).toOrderedMap()}function y(e,t){var r=e.getBlockMap().reverse().skipUntil((function(e,r){return r===t})).skip(1).skipUntil((function(e,t){return e.getLength()})).first();return r?r.getInlineStyleAt(r.getLength()-1):u()}e.exports=m},2333:(e,t,r)=>{"use strict";var n=r(6143),i=r(2013),o=n.isPlatform("Mac OS X"),a={isCtrlKeyCommand:function(e){return!!e.ctrlKey&&!e.altKey},isOptionKeyCommand:function(e){return o&&e.altKey},usesMacOSHeuristics:function(){return o},hasCommandModifier:function(e){return o?!!e.metaKey&&!e.altKey:a.isCtrlKeyCommand(e)},isSoftNewlineEvent:i};e.exports=a},6966:()=>{},169:(e,t,r)=>{"use strict";var n=r(5763),i=r(6283),o=r(1275),a=r(8691),s={currentBlockContainsLink:function(e){var t=e.getSelection(),r=e.getCurrentContent(),n=r.getEntityMap();return r.getBlockForKey(t.getAnchorKey()).getCharacterList().slice(t.getStartOffset(),t.getEndOffset()).some((function(e){var t=e.getEntity();return!!t&&"LINK"===n.__get(t).getType()}))},getCurrentBlockType:function(e){var t=e.getSelection();return e.getCurrentContent().getBlockForKey(t.getStartKey()).getType()},getDataObjectForLinkURL:function(e){return{url:e.toString()}},handleKeyCommand:function(e,t,r){switch(t){case"bold":return s.toggleInlineStyle(e,"BOLD");case"italic":return s.toggleInlineStyle(e,"ITALIC");case"underline":return s.toggleInlineStyle(e,"UNDERLINE");case"code":return s.toggleCode(e);case"backspace":case"backspace-word":case"backspace-to-start-of-line":return s.onBackspace(e);case"delete":case"delete-word":case"delete-to-end-of-block":return s.onDelete(e);default:return null}},insertSoftNewline:function(e){var t=n.insertText(e.getCurrentContent(),e.getSelection(),"\n",e.getCurrentInlineStyle(),null),r=i.push(e,t,"insert-characters");return i.forceSelection(r,t.getSelectionAfter())},onBackspace:function(e){var t=e.getSelection();if(!t.isCollapsed()||t.getAnchorOffset()||t.getFocusOffset())return null;var r=e.getCurrentContent(),n=t.getStartKey(),o=r.getBlockBefore(n);if(o&&"atomic"===o.getType()){var a=r.getBlockMap().delete(o.getKey()),l=r.merge({blockMap:a,selectionAfter:t});if(l!==r)return i.push(e,l,"remove-range")}var c=s.tryToRemoveBlockStyle(e);return c?i.push(e,c,"change-block-type"):null},onDelete:function(e){var t=e.getSelection();if(!t.isCollapsed())return null;var r=e.getCurrentContent(),o=t.getStartKey(),a=r.getBlockForKey(o).getLength();if(t.getStartOffset()<a)return null;var s=r.getBlockAfter(o);if(!s||"atomic"!==s.getType())return null;var l=t.merge({focusKey:s.getKey(),focusOffset:s.getLength()}),c=n.removeRange(r,l,"forward");return c!==r?i.push(e,c,"remove-range"):null},onTab:function(e,t,r){var n=t.getSelection(),a=n.getAnchorKey();if(a!==n.getFocusKey())return t;var s=t.getCurrentContent(),l=s.getBlockForKey(a),c=l.getType();if("unordered-list-item"!==c&&"ordered-list-item"!==c)return t;e.preventDefault();var u=l.getDepth();if(!e.shiftKey&&u===r)return t;var h=o(s,n,e.shiftKey?-1:1,r);return i.push(t,h,"adjust-depth")},toggleBlockType:function(e,t){var r=e.getSelection(),o=r.getStartKey(),s=r.getEndKey(),l=e.getCurrentContent(),c=r;if(o!==s&&0===r.getEndOffset()){var u=a(l.getBlockBefore(s));s=u.getKey(),c=c.merge({anchorKey:o,anchorOffset:r.getStartOffset(),focusKey:s,focusOffset:u.getLength(),isBackward:!1})}if(l.getBlockMap().skipWhile((function(e,t){return t!==o})).reverse().skipWhile((function(e,t){return t!==s})).some((function(e){return"atomic"===e.getType()})))return e;var h=l.getBlockForKey(o).getType()===t?"unstyled":t;return i.push(e,n.setBlockType(l,c,h),"change-block-type")},toggleCode:function(e){var t=e.getSelection(),r=t.getAnchorKey(),n=t.getFocusKey();return t.isCollapsed()||r!==n?s.toggleBlockType(e,"code-block"):s.toggleInlineStyle(e,"CODE")},toggleInlineStyle:function(e,t){var r=e.getSelection(),o=e.getCurrentInlineStyle();if(r.isCollapsed())return i.setInlineStyleOverride(e,o.has(t)?o.remove(t):o.add(t));var a,s=e.getCurrentContent();return a=o.has(t)?n.removeInlineStyle(s,r,t):n.applyInlineStyle(s,r,t),i.push(e,a,"change-inline-style")},toggleLink:function(e,t,r){var o=n.applyEntity(e.getCurrentContent(),t,r);return i.push(e,o,"apply-entity")},tryToRemoveBlockStyle:function(e){var t=e.getSelection(),r=t.getAnchorOffset();if(t.isCollapsed()&&0===r){var i=t.getAnchorKey(),o=e.getCurrentContent(),a=o.getBlockForKey(i).getType(),s=o.getBlockBefore(i);if("code-block"===a&&s&&"code-block"===s.getType()&&0!==s.getLength())return null;if("unstyled"!==a)return n.setBlockType(o,t,"unstyled")}return null}};e.exports=s},9909:(e,t,r)=>{"use strict";var n=r(5763),i=r(6283),o=r(6935),a=r(8691),s=null,l={cut:function(e){var t=e.getCurrentContent(),r=e.getSelection(),l=null;if(r.isCollapsed()){var c=r.getAnchorKey(),u=t.getBlockForKey(c).getLength();if(u===r.getAnchorOffset()){var h=t.getKeyAfter(c);if(null==h)return e;l=r.set("focusKey",h).set("focusOffset",0)}else l=r.set("focusOffset",u)}else l=r;l=a(l),s=o(t,l);var d=n.removeRange(t,l,"forward");return d===t?e:i.push(e,d,"remove-range")},paste:function(e){if(!s)return e;var t=n.replaceWithFragment(e.getCurrentContent(),e.getSelection(),s);return i.push(e,t,"insert-fragment")}};e.exports=l},4666:(e,t,r)=>{"use strict";var n=function(e){var t,r;function n(){return e.apply(this,arguments)||this}r=e,(t=n).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var i=n.prototype;return i.serialize=function(){return"Anchor: "+this.getAnchorKey()+":"+this.getAnchorOffset()+", Focus: "+this.getFocusKey()+":"+this.getFocusOffset()+", Is Backward: "+String(this.getIsBackward())+", Has Focus: "+String(this.getHasFocus())},i.getAnchorKey=function(){return this.get("anchorKey")},i.getAnchorOffset=function(){return this.get("anchorOffset")},i.getFocusKey=function(){return this.get("focusKey")},i.getFocusOffset=function(){return this.get("focusOffset")},i.getIsBackward=function(){return this.get("isBackward")},i.getHasFocus=function(){return this.get("hasFocus")},i.hasEdgeWithin=function(e,t,r){var n=this.getAnchorKey(),i=this.getFocusKey();if(n===i&&n===e){var o=this.getStartOffset(),a=this.getEndOffset();return t<=o&&o<=r||t<=a&&a<=r}if(e!==n&&e!==i)return!1;var s=e===n?this.getAnchorOffset():this.getFocusOffset();return t<=s&&r>=s},i.isCollapsed=function(){return this.getAnchorKey()===this.getFocusKey()&&this.getAnchorOffset()===this.getFocusOffset()},i.getStartKey=function(){return this.getIsBackward()?this.getFocusKey():this.getAnchorKey()},i.getStartOffset=function(){return this.getIsBackward()?this.getFocusOffset():this.getAnchorOffset()},i.getEndKey=function(){return this.getIsBackward()?this.getAnchorKey():this.getFocusKey()},i.getEndOffset=function(){return this.getIsBackward()?this.getAnchorOffset():this.getFocusOffset()},n.createEmpty=function(e){return new n({anchorKey:e,anchorOffset:0,focusKey:e,focusOffset:0,isBackward:!1,hasFocus:!1})},n}((0,r(4453).Record)({anchorKey:"",anchorOffset:0,focusKey:"",focusOffset:0,isBackward:!1,hasFocus:!1}));e.exports=n},1275:e=>{"use strict";e.exports=function(e,t,r,n){var i=t.getStartKey(),o=t.getEndKey(),a=e.getBlockMap(),s=a.toSeq().skipUntil((function(e,t){return t===i})).takeUntil((function(e,t){return t===o})).concat([[o,a.get(o)]]).map((function(e){var t=e.getDepth()+r;return t=Math.max(0,Math.min(t,n)),e.set("depth",t)}));return a=a.merge(s),e.merge({blockMap:a,selectionBefore:t,selectionAfter:t})}},4701:(e,t,r)=>{"use strict";var n=r(2367);e.exports=function(e,t,r,i){for(var o=t,a=e.getCharacterList();o<r;)a=a.set(o,n.applyEntity(a.get(o),i)),o++;return e.set("characterList",a)}},3633:(e,t,r)=>{"use strict";var n=r(4701),i=r(4453);e.exports=function(e,t,r){var o=e.getBlockMap(),a=t.getStartKey(),s=t.getStartOffset(),l=t.getEndKey(),c=t.getEndOffset(),u=o.skipUntil((function(e,t){return t===a})).takeUntil((function(e,t){return t===l})).toOrderedMap().merge(i.OrderedMap([[l,o.get(l)]])).map((function(e,t){var i=t===a?s:0,o=t===l?c:e.getLength();return n(e,i,o,r)}));return e.merge({blockMap:o.merge(u),selectionBefore:t,selectionAfter:t})}},8421:(e,t,r)=>{"use strict";function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var i=r(7707),o=r(6559),a=r(4088),s=r(3226),l=r(1375),c=r(6415),u=function(e,t){return{key:e.getKey(),text:e.getText(),type:e.getType(),depth:e.getDepth(),inlineStyleRanges:l(e),entityRanges:s(e,t),data:e.getData().toObject()}},h=function(e,t,r,a){if(e instanceof i)r.push(u(e,t));else{e instanceof o||c(!1);var s=e.getParentKey(),l=a[e.getKey()]=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},i=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),i.forEach((function(t){n(e,t,r[t])}))}return e}({},u(e,t),{children:[]});s?a[s].children.push(l):r.push(l)}};e.exports=function(e){var t={entityMap:{},blocks:[]};return t=function(e,t){var r=t.entityMap,n=[],i={},o={},s=0;return e.getBlockMap().forEach((function(e){e.findEntityRanges((function(e){return null!==e.getEntity()}),(function(t){var n=e.getEntityAt(t),i=a.stringify(n);o[i]||(o[i]=n,r[i]="".concat(s),s++)})),h(e,r,n,i)})),{blocks:n,entityMap:r}}(e,t),t=function(e,t){var r=t.blocks,n=t.entityMap,i={};return Object.keys(n).forEach((function(t,r){var n=e.getEntity(a.unstringify(t));i[r]={type:n.getType(),mutability:n.getMutability(),data:n.getData()}})),{blocks:r,entityMap:i}}(e,t),t}},555:(e,t,r)=>{"use strict";var n;function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){o(e,t,r[t])}))}return e}function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var a=r(2367),s=r(7707),l=r(6559),c=r(1144),u=r(2593),h=r(9493),d=r(7904),f=r(306),g=r(6357),p=r(8819),m=r(4453),v=m.List,b=m.Map,y=m.OrderedSet,w=r(5941),S=r(5030),C=r(9990),k=r(1967),x=p("draft_tree_data_support"),E=new RegExp("\r","g"),T=new RegExp("\n","g"),_=new RegExp("^\n","g"),A=new RegExp("&nbsp;","g"),R=new RegExp("&#13;?","g"),O=new RegExp("&#8203;?","g"),M=["bold","bolder","500","600","700","800","900"],I=["light","lighter","normal","100","200","300","400"],P=["className","href","rel","target","title"],N=["alt","className","height","src","width"],D=(o(n={},d("public/DraftStyleDefault/depth0"),0),o(n,d("public/DraftStyleDefault/depth1"),1),o(n,d("public/DraftStyleDefault/depth2"),2),o(n,d("public/DraftStyleDefault/depth3"),3),o(n,d("public/DraftStyleDefault/depth4"),4),n),F=b({b:"BOLD",code:"CODE",del:"STRIKETHROUGH",em:"ITALIC",i:"ITALIC",s:"STRIKETHROUGH",strike:"STRIKETHROUGH",strong:"BOLD",u:"UNDERLINE",mark:"HIGHLIGHT"}),L=function(e){if(C(e)&&e.style.fontFamily.includes("monospace"))return"CODE";return null},H=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Object.keys(D).some((function(r){e.classList.contains(r)&&(t=D[r])})),t},B=function(e){if(!w(e))return!1;var t=e;if(!t.href||"http:"!==t.protocol&&"https:"!==t.protocol&&"mailto:"!==t.protocol&&"tel:"!==t.protocol)return!1;try{new h(t.href);return!0}catch(r){return!1}},U=function(e){if(!k(e))return!1;var t=e;return!(!t.attributes.getNamedItem("src")||!t.attributes.getNamedItem("src").value)},j=function(e,t){if(!C(e))return t;var r=e,n=r.style.fontWeight,i=r.style.fontStyle,o=r.style.textDecoration;return t.withMutations((function(e){M.indexOf(n)>=0?e.add("BOLD"):I.indexOf(n)>=0&&e.remove("BOLD"),"italic"===i?e.add("ITALIC"):"normal"===i&&e.remove("ITALIC"),"underline"===o&&e.add("UNDERLINE"),"line-through"===o&&e.add("STRIKETHROUGH"),"none"===o&&(e.remove("UNDERLINE"),e.remove("STRIKETHROUGH"))}))},W=function(e){return"ul"===e||"ol"===e},V=function(){function e(e,t){o(this,"characterList",v()),o(this,"currentBlockType","unstyled"),o(this,"currentDepth",0),o(this,"currentEntity",null),o(this,"currentText",""),o(this,"wrapper",null),o(this,"blockConfigs",[]),o(this,"contentBlocks",[]),o(this,"entityMap",u),o(this,"blockTypeMap",void 0),o(this,"disambiguate",void 0),this.clear(),this.blockTypeMap=e,this.disambiguate=t}var t=e.prototype;return t.clear=function(){this.characterList=v(),this.blockConfigs=[],this.currentBlockType="unstyled",this.currentDepth=0,this.currentEntity=null,this.currentText="",this.entityMap=u,this.wrapper=null,this.contentBlocks=[]},t.addDOMNode=function(e){var t;return this.contentBlocks=[],this.currentDepth=0,(t=this.blockConfigs).push.apply(t,this._toBlockConfigs([e],y())),this._trimCurrentText(),""!==this.currentText&&this.blockConfigs.push(this._makeBlockConfig()),this},t.getContentBlocks=function(){return 0===this.contentBlocks.length&&(x?this._toContentBlocks(this.blockConfigs):this._toFlatContentBlocks(this.blockConfigs)),{contentBlocks:this.contentBlocks,entityMap:this.entityMap}},t._makeBlockConfig=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=i({key:e.key||f(),type:this.currentBlockType,text:this.currentText,characterList:this.characterList,depth:this.currentDepth,parent:null,children:v(),prevSibling:null,nextSibling:null,childConfigs:[]},e);return this.characterList=v(),this.currentBlockType="unstyled",this.currentText="",t},t._toBlockConfigs=function(e,t){for(var r=[],n=0;n<e.length;n++){var i=e[n],o=i.nodeName.toLowerCase();if("body"===o||W(o)){this._trimCurrentText(),""!==this.currentText&&r.push(this._makeBlockConfig());var a=this.currentDepth,s=this.wrapper;W(o)&&(this.wrapper=o,W(s)&&this.currentDepth++),r.push.apply(r,this._toBlockConfigs(Array.from(i.childNodes),t)),this.currentDepth=a,this.wrapper=s}else{var l=this.blockTypeMap.get(o);if(void 0===l)if("#text"!==o)if("br"!==o)if(U(i))this._addImgNode(i,t);else if(B(i))this._addAnchorNode(i,r,t);else{var c=t;F.has(o)&&(c=c.add(F.get(o))),c=j(i,c);var u=L(i);null!=u&&(c=c.add(u)),r.push.apply(r,this._toBlockConfigs(Array.from(i.childNodes),c))}else this._addBreakNode(i,t);else this._addTextNode(i,t);else{this._trimCurrentText(),""!==this.currentText&&r.push(this._makeBlockConfig());var h=this.currentDepth,d=this.wrapper;if(this.wrapper="pre"===o?"pre":this.wrapper,"string"!==typeof l&&(l=this.disambiguate(o,this.wrapper)||l[0]||"unstyled"),!x&&C(i)&&("unordered-list-item"===l||"ordered-list-item"===l)){var g=i;this.currentDepth=H(g,this.currentDepth)}var p=f(),m=this._toBlockConfigs(Array.from(i.childNodes),t);this._trimCurrentText(),r.push(this._makeBlockConfig({key:p,childConfigs:m,type:l})),this.currentDepth=h,this.wrapper=d}}}return r},t._appendText=function(e,t){var r;this.currentText+=e;var n=a.create({style:t,entity:this.currentEntity});this.characterList=(r=this.characterList).push.apply(r,Array(e.length).fill(n))},t._trimCurrentText=function(){var e=this.currentText.length,t=e-this.currentText.trimLeft().length,r=this.currentText.trimRight().length,n=this.characterList.findEntry((function(e){return null!==e.getEntity()}));(t=void 0!==n?Math.min(t,n[0]):t)>(r=void 0!==(n=this.characterList.reverse().findEntry((function(e){return null!==e.getEntity()})))?Math.max(r,e-n[0]):r)?(this.currentText="",this.characterList=v()):(this.currentText=this.currentText.slice(t,r),this.characterList=this.characterList.slice(t,r))},t._addTextNode=function(e,t){var r=e.textContent;""===r.trim()&&"pre"!==this.wrapper&&(r=" "),"pre"!==this.wrapper&&(r=(r=r.replace(_,"")).replace(T," ")),this._appendText(r,t)},t._addBreakNode=function(e,t){S(e)&&this._appendText("\n",t)},t._addImgNode=function(e,t){if(k(e)){var r=e,n={};N.forEach((function(e){var t=r.getAttribute(e);t&&(n[e]=t)})),this.currentEntity=this.entityMap.__create("IMAGE","IMMUTABLE",n),p("draftjs_fix_paste_for_img")?"presentation"!==r.getAttribute("role")&&this._appendText("\ud83d\udcf7",t):this._appendText("\ud83d\udcf7",t),this.currentEntity=null}},t._addAnchorNode=function(e,t,r){if(w(e)){var n=e,i={};P.forEach((function(e){var t=n.getAttribute(e);t&&(i[e]=t)})),i.url=new h(n.href).toString(),this.currentEntity=this.entityMap.__create("LINK","MUTABLE",i||{}),t.push.apply(t,this._toBlockConfigs(Array.from(e.childNodes),r)),this.currentEntity=null}},t._toContentBlocks=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=e.length-1,n=0;n<=r;n++){var o=e[n];o.parent=t,o.prevSibling=n>0?e[n-1].key:null,o.nextSibling=n<r?e[n+1].key:null,o.children=v(o.childConfigs.map((function(e){return e.key}))),this.contentBlocks.push(new l(i({},o))),this._toContentBlocks(o.childConfigs,o.key)}},t._hoistContainersInBlockConfigs=function(e){var t=this;return v(e).flatMap((function(e){return"unstyled"!==e.type||""!==e.text?[e]:t._hoistContainersInBlockConfigs(e.childConfigs)}))},t._toFlatContentBlocks=function(e){var t=this;this._hoistContainersInBlockConfigs(e).forEach((function(e){var r=t._extractTextFromBlockConfigs(e.childConfigs),n=r.text,o=r.characterList;t.contentBlocks.push(new s(i({},e,{text:e.text+n,characterList:e.characterList.concat(o)})))}))},t._extractTextFromBlockConfigs=function(e){for(var t=e.length-1,r="",n=v(),i=0;i<=t;i++){var o=e[i];r+=o.text,n=n.concat(o.characterList),""!==r&&"unstyled"!==o.type&&(r+="\n",n=n.push(n.last()));var a=this._extractTextFromBlockConfigs(o.childConfigs);r+=a.text,n=n.concat(a.characterList)}return{text:r,characterList:n}},e}();e.exports=function(e){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:c,r=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:g)(e=e.trim().replace(E,"").replace(A," ").replace(R,"").replace(O,""));if(!r)return null;var n=function(e){var t={};return e.mapKeys((function(e,r){var n=[r.element];void 0!==r.aliasedElements&&n.push.apply(n,r.aliasedElements),n.forEach((function(r){void 0===t[r]?t[r]=e:"string"===typeof t[r]?t[r]=[t[r],e]:t[r].push(e)}))})),b(t)}(t);return new V(n,(function(e,t){return"li"===e?"ol"===t?"ordered-list-item":"unordered-list-item":null})).addDOMNode(r).getContentBlocks()}},3327:(e,t,r)=>{"use strict";function n(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){i(e,t,r[t])}))}return e}function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var o=r(7707),a=r(6559),s=r(4075),l=r(2593),c=r(7551),u=(r(4863),r(4666)),h=r(9806),d=r(1894),f=r(4155),g=r(306),p=r(8819),m=r(4453),v=r(6415),b=p("draft_tree_data_support"),y=m.List,w=m.Map,S=m.OrderedMap,C=function(e,t){var r=e.key,n=e.type,i=e.data;return{text:e.text,depth:e.depth||0,type:n||"unstyled",key:r||g(),data:w(i),characterList:k(e,t)}},k=function(e,t){var r=e.text,i=e.entityRanges,o=e.inlineStyleRanges,a=i||[];return h(f(r,o||[]),d(r,a.filter((function(e){return t.hasOwnProperty(e.key)})).map((function(e){return n({},e,{key:t[e.key]})}))))},x=function(e){return n({},e,{key:e.key||g()})},E=function(e,t,r){var i=t.map((function(e){return n({},e,{parentRef:r})}));return e.concat(i.reverse())},T=function(e,t){var r=e.blocks.find((function(e){return Array.isArray(e.children)&&e.children.length>0})),i=b&&!r?c.fromRawStateToRawTreeState(e).blocks:e.blocks;if(!b)return function(e,t){return S(e.map((function(e){var r=new o(C(e,t));return[r.getKey(),r]})))}(r?c.fromRawTreeStateToRawState(e).blocks:i,t);var s=function(e,t){return e.map(x).reduce((function(r,i,o){Array.isArray(i.children)||v(!1);var s=i.children.map(x),l=new a(n({},C(i,t),{prevSibling:0===o?null:e[o-1].key,nextSibling:o===e.length-1?null:e[o+1].key,children:y(s.map((function(e){return e.key})))}));r=r.set(l.getKey(),l);for(var c=E([],s,l);c.length>0;){var u=c.pop(),h=u.parentRef,d=h.getChildKeys(),f=d.indexOf(u.key),g=Array.isArray(u.children);if(!g){g||v(!1);break}var p=u.children.map(x),m=new a(n({},C(u,t),{parent:h.getKey(),children:y(p.map((function(e){return e.key}))),prevSibling:0===f?null:d.get(f-1),nextSibling:f===d.size-1?null:d.get(f+1)}));r=r.set(m.getKey(),m),c=E(c,p,m)}return r}),S())}(i,t);return s};e.exports=function(e){Array.isArray(e.blocks)||v(!1);var t=function(e){var t=e.entityMap,r={};return Object.keys(t).forEach((function(e){var n=t[e],i=n.type,o=n.mutability,a=n.data;r[e]=l.__create(i,o,a||{})})),r}(e),r=T(e,t),n=r.isEmpty()?new u:u.createEmpty(r.first().getKey());return new s({blockMap:r,entityMap:t,selectionBefore:n,selectionAfter:n})}},9806:(e,t,r)=>{"use strict";var n=r(2367),i=r(4453).List;e.exports=function(e,t){var r=e.map((function(e,r){var i=t[r];return n.create({style:e,entity:i})}));return i(r)}},1894:(e,t,r)=>{"use strict";var n=r(4939).substr;e.exports=function(e,t){var r=Array(e.length).fill(null);return t&&t.forEach((function(t){for(var i=n(e,0,t.offset).length,o=i+n(e,t.offset,t.length).length,a=i;a<o;a++)r[a]=t.key})),r}},4155:(e,t,r)=>{"use strict";var n=r(4939),i=r(4453).OrderedSet,o=n.substr,a=i();e.exports=function(e,t){var r=Array(e.length).fill(a);return t&&t.forEach((function(t){for(var n=o(e,0,t.offset).length,i=n+o(e,t.offset,t.length).length;n<i;)r[n]=r[n].add(t.style),n++})),r}},2934:e=>{"use strict";e.exports={notEmptyKey:function(e){return null!=e&&""!=e}}},1363:(e,t,r)=>{"use strict";var n=r(5763),i=r(6283),o=r(6143),a=r(5036),s=r(9303),l=r(1900),c=r(8691),u=r(9102),h="'",d="/",f=o.isBrowser("Firefox");function g(e,t,r,o,a){var s=n.replaceText(e.getCurrentContent(),e.getSelection(),t,r,o);return i.push(e,s,"insert-characters",a)}e.exports=function(e,t){void 0!==e._pendingStateFromBeforeInput&&(e.update(e._pendingStateFromBeforeInput),e._pendingStateFromBeforeInput=void 0);var r=e._latestEditorState,n=t.data;if(n)if(e.props.handleBeforeInput&&s(e.props.handleBeforeInput(n,r,t.timeStamp)))t.preventDefault();else{var o=r.getSelection(),p=o.getStartOffset(),m=o.getAnchorKey();if(!o.isCollapsed())return t.preventDefault(),void e.update(g(r,n,r.getCurrentInlineStyle(),a(r.getCurrentContent(),r.getSelection()),!0));var v,b=g(r,n,r.getCurrentInlineStyle(),a(r.getCurrentContent(),r.getSelection()),!1),y=!1;if(y||(y=l(e._latestCommittedEditorState)),!y){var w=r.getBlockTree(m),S=b.getBlockTree(m);y=w.size!==S.size||w.zip(S).some((function(e){var t=e[0],r=e[1],i=t.get("start"),o=i+(i>=p?n.length:0),a=t.get("end"),s=a+(a>=p?n.length:0),l=r.get("start"),c=r.get("end"),u=r.get("decoratorKey");return t.get("decoratorKey")!==u||t.get("leaves").size!==r.get("leaves").size||o!==l||s!==c||null!=u&&c-l!==a-i}))}if(y||(v=n,y=f&&(v==h||v==d)),y||(y=c(b.getDirectionMap()).get(m)!==c(r.getDirectionMap()).get(m)),y)return t.preventDefault(),b=i.set(b,{forceSelection:!0}),void e.update(b);b=i.set(b,{nativelyRenderedContent:b.getCurrentContent()}),e._pendingStateFromBeforeInput=b,u((function(){void 0!==e._pendingStateFromBeforeInput&&(e.update(e._pendingStateFromBeforeInput),e._pendingStateFromBeforeInput=void 0)}))}}},1933:(e,t,r)=>{"use strict";var n=r(6283),i=r(3922),o=r(5089);e.exports=function(e,t){var r=t.currentTarget.ownerDocument;if(!Boolean(e.props.preserveSelectionOnBlur)&&o(r)===r.body){var a=r.defaultView.getSelection(),s=e.editor;1===a.rangeCount&&i(s,a.anchorNode)&&i(s,a.focusNode)&&a.removeAllRanges()}var l=e._latestEditorState,c=l.getSelection();if(c.getHasFocus()){var u=c.set("hasFocus",!1);e.props.onBlur&&e.props.onBlur(t),e.update(n.acceptSelection(l,u))}}},9678:(e,t,r)=>{"use strict";var n=r(6283);e.exports=function(e,t){e.setMode("composite"),e.update(n.set(e._latestEditorState,{inCompositionMode:!0})),e._onCompositionStart(t)}},5169:(e,t,r)=>{"use strict";var n=r(6643);e.exports=function(e,t){e._latestEditorState.getSelection().isCollapsed()?t.preventDefault():e.setClipboard(n(e._latestEditorState))}},6350:(e,t,r)=>{"use strict";var n=r(5763),i=r(6283),o=r(1614),a=r(6643),s=r(8349),l=r(9167);e.exports=function(e,t){var r,c=e._latestEditorState,u=c.getSelection(),h=t.target;if(u.isCollapsed())t.preventDefault();else{if(l(h)){var d=h;r=s(o.getScrollParent(d))}var f=a(c);e.setClipboard(f),e.setMode("cut"),setTimeout((function(){e.restoreEditorDOM(r),e.exitCurrentMode(),e.update(function(e){var t=n.removeRange(e.getCurrentContent(),e.getSelection(),"forward");return i.push(e,t,"remove-range")}(c))}),0)}}},7660:e=>{"use strict";e.exports=function(e,t){e.setMode("drag"),t.preventDefault()}},8796:e=>{"use strict";e.exports=function(e){e._internalDrag=!0,e.setMode("drag")}},5722:(e,t,r)=>{"use strict";var n=r(6283),i=r(6143);e.exports=function(e,t){var r=e._latestEditorState,o=r.getSelection();if(!o.getHasFocus()){var a=o.set("hasFocus",!0);e.props.onFocus&&e.props.onFocus(t),i.isBrowser("Chrome < 60.0.3081.0")?e.update(n.forceSelection(r,a)):e.update(n.acceptSelection(r,a))}}},78:(e,t,r)=>{"use strict";var n=r(5763),i=r(4414),o=r(6283),a=r(6143),s=r(2934).notEmptyKey,l=r(5037),c=r(2002),u=r(8691),h=a.isEngine("Gecko");e.exports=function(e,t){void 0!==e._pendingStateFromBeforeInput&&(e.update(e._pendingStateFromBeforeInput),e._pendingStateFromBeforeInput=void 0);var r=e.editor.ownerDocument.defaultView.getSelection(),a=r.anchorNode,d=r.isCollapsed,f=(null===a||void 0===a?void 0:a.nodeType)!==Node.TEXT_NODE&&(null===a||void 0===a?void 0:a.nodeType)!==Node.ELEMENT_NODE;if(null!=a&&!f){if(a.nodeType===Node.TEXT_NODE&&(null!==a.previousSibling||null!==a.nextSibling)){var g=a.parentNode;if(null==g)return;a.nodeValue=g.textContent;for(var p=g.firstChild;null!=p;p=p.nextSibling)p!==a&&g.removeChild(p)}var m=a.textContent,v=e._latestEditorState,b=u(l(a)),y=i.decode(b),w=y.blockKey,S=y.decoratorKey,C=y.leafKey,k=v.getBlockTree(w).getIn([S,"leaves",C]),x=k.start,E=k.end,T=v.getCurrentContent(),_=T.getBlockForKey(w),A=_.getText().slice(x,E);if(m.endsWith("\n\n")&&(m=m.slice(0,-1)),m!==A){var R,O,M,I,P=v.getSelection(),N=P.merge({anchorOffset:x,focusOffset:E,isBackward:!1}),D=_.getEntityAt(x),F=s(D)?T.getEntity(D):null,L="MUTABLE"===(null!=F?F.getMutability():null),H=L?"spellcheck-change":"apply-entity",B=n.replaceText(T,N,m,_.getInlineStyleAt(x),L?_.getEntityAt(x):null);if(h)R=r.anchorOffset,O=r.focusOffset,I=(M=x+Math.min(R,O))+Math.abs(R-O),R=M,O=I;else{var U=m.length-A.length;M=P.getStartOffset(),I=P.getEndOffset(),R=d?I+U:M,O=I+U}var j=B.merge({selectionBefore:T.getSelectionAfter(),selectionAfter:P.merge({anchorOffset:R,focusOffset:O})});e.update(o.push(v,j,H))}else{var W=t.nativeEvent.inputType;if(W){var V=function(e,t){return"deleteContentBackward"===e?c(t):t}(W,v);if(V!==v)return e.restoreEditorDOM(),void e.update(V)}}}}},617:(e,t,r)=>{"use strict";var n=r(5763),i=r(6283),o=r(2333),a=r(4923),s=r(9909),l=r(6143),c=r(9303),u=r(9384),h=r(8502),d=r(6882),f=r(4454),g=r(8516),p=r(7603),m=r(2002),v=r(2198),b=r(9690),y=r(4059),w=o.isOptionKeyCommand,S=l.isBrowser("Chrome");e.exports=function(e,t){var r=t.which,o=e._latestEditorState;function l(r){var n=e.props[r];return!!n&&(n(t),!0)}switch(r){case a.RETURN:if(t.preventDefault(),e.props.handleReturn&&c(e.props.handleReturn(t,o)))return;break;case a.ESC:if(t.preventDefault(),l("onEscape"))return;break;case a.TAB:if(l("onTab"))return;break;case a.UP:if(l("onUpArrow"))return;break;case a.RIGHT:if(l("onRightArrow"))return;break;case a.DOWN:if(l("onDownArrow"))return;break;case a.LEFT:if(l("onLeftArrow"))return;break;case a.SPACE:S&&w(t)&&t.preventDefault()}var C=e.props.keyBindingFn(t);if(null!=C&&""!==C)if("undo"!==C){if(t.preventDefault(),!e.props.handleKeyCommand||!c(e.props.handleKeyCommand(C,o,t.timeStamp))){var k=function(e,t,r){switch(e){case"redo":return i.redo(t);case"delete":return v(t);case"delete-word":return d(t);case"backspace":return m(t);case"backspace-word":return h(t);case"backspace-to-start-of-line":return u(t,r);case"split-block":return f(t);case"transpose-characters":return b(t);case"move-selection-to-start-of-block":return p(t);case"move-selection-to-end-of-block":return g(t);case"secondary-cut":return s.cut(t);case"secondary-paste":return s.paste(t);default:return t}}(C,o,t);k!==o&&e.update(k)}}else y(t,o,e.update);else if(r===a.SPACE&&S&&w(t)){var x=n.replaceText(o.getCurrentContent(),o.getSelection(),"\xa0");e.update(i.push(o,x,"insert-characters"))}}},7677:(e,t,r)=>{"use strict";var n=r(3305),i=r(2367),o=r(6968),a=r(5763),s=r(6959),l=r(6283),c=r(169),u=r(5036),h=r(2962),d=r(9303),f=r(8009);function g(e,t,r){var n=a.replaceWithFragment(e.getCurrentContent(),e.getSelection(),t);return l.push(e,n.set("entityMap",r),"insert-fragment")}e.exports=function(e,t){t.preventDefault();var r=new o(t.clipboardData);if(!r.isRichText()){var p=r.getFiles(),m=r.getText();if(p.length>0){if(e.props.handlePastedFiles&&d(e.props.handlePastedFiles(p)))return;return void h(p,(function(t){if(t=t||m){var r=e._latestEditorState,o=f(t),h=i.create({style:r.getCurrentInlineStyle(),entity:u(r.getCurrentContent(),r.getSelection())}),d=c.getCurrentBlockType(r),g=s.processText(o,h,d),p=n.createFromArray(g),v=a.replaceWithFragment(r.getCurrentContent(),r.getSelection(),p);e.update(l.push(r,v,"insert-fragment"))}}))}}var v=[],b=r.getText(),y=r.getHTML(),w=e._latestEditorState;if(e.props.formatPastedText){var S=e.props.formatPastedText(b,y);b=S.text,y=S.html}if(!e.props.handlePastedText||!d(e.props.handlePastedText(b,y,w))){if(b&&(v=f(b)),!e.props.stripPastedStyles){var C,k=e.getClipboard();if(!e.props.formatPastedText&&r.isRichText()&&k){if(-1!==(null===(C=y)||void 0===C?void 0:C.indexOf(e.getEditorKey()))||1===v.length&&1===k.size&&k.first().getText()===b)return void e.update(g(e._latestEditorState,k))}else if(k&&r.types.includes("com.apple.webarchive")&&!r.types.includes("text/html")&&function(e,t){return e.length===t.size&&t.valueSeq().every((function(t,r){return t.getText()===e[r]}))}(v,k))return void e.update(g(e._latestEditorState,k));if(y){var x=s.processHTML(y,e.props.blockRenderMap);if(x){var E=x.contentBlocks,T=x.entityMap;if(E){var _=n.createFromArray(E);return void e.update(g(e._latestEditorState,_,T))}}}e.setClipboard(null)}if(v.length){var A=i.create({style:w.getCurrentInlineStyle(),entity:u(w.getCurrentContent(),w.getSelection())}),R=c.getCurrentBlockType(w),O=s.processText(v,A,R),M=n.createFromArray(O);e.update(g(e._latestEditorState,M))}}}},2124:(e,t,r)=>{"use strict";var n=r(8645),i=r(6283),o=r(4909),a=r(7809);e.exports=function(e){if(e._blockSelectEvents||e._latestEditorState!==e.props.editorState){if(e._blockSelectEvents){var t=e.props.editorState.getSelection();n.logBlockedSelectionEvent({anonymizedDom:"N/A",extraParams:JSON.stringify({stacktrace:(new Error).stack}),selectionState:JSON.stringify(t.toJS())})}}else{var r=e.props.editorState,s=a(r,o(e)),l=s.selectionState;l!==r.getSelection()&&(r=s.needsRecovery?i.forceSelection(r,l):i.acceptSelection(r,l),e.update(r))}}},3226:(e,t,r)=>{"use strict";var n=r(4088),i=r(4939).strlen;e.exports=function(e,t){var r=[];return e.findEntityRanges((function(e){return!!e.getEntity()}),(function(o,a){var s=e.getText(),l=e.getEntityAt(o);r.push({offset:i(s.slice(0,o)),length:i(s.slice(o,a)),key:Number(t[n.stringify(l)])})})),r}},1375:(e,t,r)=>{"use strict";var n=r(4939),i=r(8678),o=function(e,t){return e===t},a=function(e){return!!e},s=[];e.exports=function(e){var t=e.getCharacterList().map((function(e){return e.getStyle()})).toList(),r=t.flatten().toSet().map((function(r){return function(e,t,r){var s=[],l=t.map((function(e){return e.has(r)})).toList();return i(l,o,a,(function(t,i){var o=e.getText();s.push({offset:n.strlen(o.slice(0,t)),length:n.strlen(o.slice(t,i)),style:r})})),s}(e,t,r)}));return Array.prototype.concat.apply(s,r.toJS())}},5798:(e,t,r)=>{"use strict";var n=r(4939),i=r(8358),o=r(3e3),a=r(6415);function s(e,t){for(var r=1/0,n=1/0,i=-1/0,o=-1/0,a=0;a<e.length;a++){var s=e[a];0!==s.width&&1!==s.width&&(r=Math.min(r,s.top),n=Math.min(n,s.bottom),i=Math.max(i,s.top),o=Math.max(o,s.bottom))}return i<=n&&i-r<t&&o-n<t}function l(e){switch(e.nodeType){case Node.DOCUMENT_TYPE_NODE:return 0;case Node.TEXT_NODE:case Node.PROCESSING_INSTRUCTION_NODE:case Node.COMMENT_NODE:return e.length;default:return e.childNodes.length}}e.exports=function(e){e.collapsed||a(!1);var t=(e=e.cloneRange()).startContainer;1!==t.nodeType&&(t=t.parentNode);var r=function(e){var t=getComputedStyle(e),r=i(e),n=r.createElement("div");n.style.fontFamily=t.fontFamily,n.style.fontSize=t.fontSize,n.style.fontStyle=t.fontStyle,n.style.fontWeight=t.fontWeight,n.style.lineHeight=t.lineHeight,n.style.position="absolute",n.textContent="M";var o=r.body;o||a(!1),o.appendChild(n);var s=n.getBoundingClientRect();return o.removeChild(n),s.height}(t),c=e.endContainer,u=e.endOffset;for(e.setStart(e.startContainer,0);s(o(e),r)&&(c=e.startContainer,u=e.startOffset,c.parentNode||a(!1),e.setStartBefore(c),1!==c.nodeType||"inline"===getComputedStyle(c).display););for(var h=c,d=u-1;;){for(var f=h.nodeValue,g=d;g>=0;g--)if(!(null!=f&&g>0&&n.isSurrogatePair(f,g-1))){if(e.setStart(h,g),!s(o(e),r))break;c=h,u=g}if(-1===g||0===h.childNodes.length)break;d=l(h=h.childNodes[g])}return e.setStart(c,u),e}},5037:(e,t,r)=>{"use strict";var n=r(8358),i=r(8746);e.exports=function(e){for(var t=e;t&&t!==n(e).documentElement;){var r=i(t);if(null!=r)return r;t=t.parentNode}return null}},8678:e=>{"use strict";e.exports=function(e,t,r,n){if(e.size){var i=0;e.reduce((function(e,o,a){return t(e,o)||(r(e)&&n(i,a),i=a),o})),r(e.last())&&n(i,e.count())}}},306:e=>{"use strict";var t={},r=Math.pow(2,24);e.exports=function(){for(var e;void 0===e||t.hasOwnProperty(e)||!isNaN(+e);)e=Math.floor(Math.random()*r).toString(32);return t[e]=!0,e}},9639:(e,t,r)=>{"use strict";var n=r(7003),i=r(1306),o=r(6415);function a(e,t,r,a,s,l,c){var u=r.getStartOffset(),h=r.getEndOffset(),d=e.__get(s).getMutability(),f=c?u:h;if("MUTABLE"===d)return r;var g=i(t,s).filter((function(e){return f<=e.end&&f>=e.start}));1!=g.length&&o(!1);var p=g[0];if("IMMUTABLE"===d)return r.merge({anchorOffset:p.start,focusOffset:p.end,isBackward:!1});l||(c?h=p.end:u=p.start);var m=n.getRemovalRange(u,h,t.getText().slice(p.start,p.end),p.start,a);return r.merge({anchorOffset:m.start,focusOffset:m.end,isBackward:!1})}e.exports=function(e,t,r,n,i){var o=n.getStartOffset(),s=n.getEndOffset(),l=t.getEntityAt(o),c=r.getEntityAt(s-1);if(!l&&!c)return n;var u=n;if(l&&l===c)u=a(e,t,u,i,l,!0,!0);else if(l&&c){var h=a(e,t,u,i,l,!1,!0),d=a(e,r,u,i,c,!1,!1);u=u.merge({anchorOffset:h.getAnchorOffset(),focusOffset:d.getFocusOffset(),isBackward:!1})}else if(l){var f=a(e,t,u,i,l,!1,!0);u=u.merge({anchorOffset:f.getStartOffset(),isBackward:!1})}else if(c){var g=a(e,r,u,i,c,!1,!1);u=u.merge({focusOffset:g.getEndOffset(),isBackward:!1})}return u}},4909:(e,t,r)=>{"use strict";var n=r(6415),i=r(9990);e.exports=function(e){var t=e.editorContainer;return t||n(!1),i(t.firstChild)||n(!1),t.firstChild}},6935:(e,t,r)=>{"use strict";var n=r(1287),i=r(9529);e.exports=function(e,t){var r=t.getStartKey(),o=t.getStartOffset(),a=t.getEndKey(),s=t.getEndOffset(),l=i(e,t).getBlockMap(),c=l.keySeq(),u=c.indexOf(r),h=c.indexOf(a)+1;return n(l.slice(u,h).map((function(e,t){var n=e.getText(),i=e.getCharacterList();return r===a?e.merge({text:n.slice(o,s),characterList:i.slice(o,s)}):t===r?e.merge({text:n.slice(o),characterList:i.slice(o)}):t===a?e.merge({text:n.slice(0,s),characterList:i.slice(0,s)}):e})))}},8358:e=>{"use strict";e.exports=function(e){return e&&e.ownerDocument?e.ownerDocument:document}},9684:(e,t,r)=>{"use strict";var n=r(2333),i=r(4923),o=r(6143),a=o.isPlatform("Mac OS X"),s=a&&o.isBrowser("Firefox < 29"),l=n.hasCommandModifier,c=n.isCtrlKeyCommand;function u(e){return a&&e.altKey||c(e)}e.exports=function(e){switch(e.keyCode){case 66:return l(e)?"bold":null;case 68:return c(e)?"delete":null;case 72:return c(e)?"backspace":null;case 73:return l(e)?"italic":null;case 74:return l(e)?"code":null;case 75:return a&&c(e)?"secondary-cut":null;case 77:case 79:return c(e)?"split-block":null;case 84:return a&&c(e)?"transpose-characters":null;case 85:return l(e)?"underline":null;case 87:return a&&c(e)?"backspace-word":null;case 89:return c(e)?a?"secondary-paste":"redo":null;case 90:return function(e){return l(e)?e.shiftKey?"redo":"undo":null}(e)||null;case i.RETURN:return"split-block";case i.DELETE:return function(e){return!a&&e.shiftKey?null:u(e)?"delete-word":"delete"}(e);case i.BACKSPACE:return function(e){return l(e)&&a?"backspace-to-start-of-line":u(e)?"backspace-word":"backspace"}(e);case i.LEFT:return s&&l(e)?"move-selection-to-start-of-block":null;case i.RIGHT:return s&&l(e)?"move-selection-to-end-of-block":null;default:return null}}},7809:(e,t,r)=>{"use strict";var n=r(7404);e.exports=function(e,t){var r=t.ownerDocument.defaultView.getSelection(),i=r.anchorNode,o=r.anchorOffset,a=r.focusNode,s=r.focusOffset;return 0===r.rangeCount||null==i||null==a?{selectionState:e.getSelection().set("hasFocus",!1),needsRecovery:!1}:n(e,t,i,o,a,s)}},7404:(e,t,r)=>{"use strict";var n=r(5037),i=r(8746),o=r(4733),a=r(6415),s=r(7385),l=r(8691);function c(e,t,r){var o=t,c=n(o);(null!=c||e&&(e===o||e.firstChild===o)||a(!1),e===o)&&(o=o.firstChild,s(o)||a(!1),"true"!==(o=o).getAttribute("data-contents")&&a(!1),r>0&&(r=o.childNodes.length));if(0===r){var h=null;if(null!=c)h=c;else{var d=function(e){for(;e.firstChild&&(s(e.firstChild)&&"true"===e.firstChild.getAttribute("data-blocks")||i(e.firstChild));)e=e.firstChild;return e}(o);h=l(i(d))}return{key:h,offset:0}}var f=o.childNodes[r-1],g=null,p=null;if(i(f)){var m=function(e){for(;e.lastChild&&(s(e.lastChild)&&"true"===e.lastChild.getAttribute("data-blocks")||i(e.lastChild));)e=e.lastChild;return e}(f);g=l(i(m)),p=u(m)}else g=l(c),p=u(f);return{key:g,offset:p}}function u(e){var t=e.textContent;return"\n"===t?0:t.length}e.exports=function(e,t,r,i,a,s){var u=r.nodeType===Node.TEXT_NODE,h=a.nodeType===Node.TEXT_NODE;if(u&&h)return{selectionState:o(e,l(n(r)),i,l(n(a)),s),needsRecovery:!1};var d=null,f=null,g=!0;return u?(d={key:l(n(r)),offset:i},f=c(t,a,s)):h?(f={key:l(n(a)),offset:s},d=c(t,r,i)):(d=c(t,r,i),f=c(t,a,s),r===a&&i===s&&(g=!!r.firstChild&&"BR"!==r.firstChild.nodeName)),{selectionState:o(e,d.key,d.offset,f.key,f.offset),needsRecovery:g}}},5036:(e,t,r)=>{"use strict";var n=r(2934).notEmptyKey;function i(e,t){return n(t)&&"MUTABLE"===e.__get(t).getMutability()?t:null}e.exports=function(e,t){var r;if(t.isCollapsed()){var n=t.getAnchorKey(),o=t.getAnchorOffset();return o>0?(r=e.getBlockForKey(n).getEntityAt(o-1))!==e.getBlockForKey(n).getEntityAt(o)?null:i(e.getEntityMap(),r):null}var a=t.getStartKey(),s=t.getStartOffset(),l=e.getBlockForKey(a);return r=s===l.getLength()?null:l.getEntityAt(s),i(e.getEntityMap(),r)}},6643:(e,t,r)=>{"use strict";var n=r(6935);e.exports=function(e){var t=e.getSelection();return t.isCollapsed()?null:n(e.getCurrentContent(),t)}},5791:(e,t,r)=>{"use strict";var n=r(6559);e.exports=function(e,t){if(!(e instanceof n))return null;var r=e.getNextSiblingKey();if(r)return r;var i=e.getParentKey();if(!i)return null;for(var o=t.get(i);o&&!o.getNextSiblingKey();){var a=o.getParentKey();o=a?t.get(a):null}return o?o.getNextSiblingKey():null}},3112:e=>{"use strict";e.exports=function(e){return Object.keys(e).map((function(t){return e[t]}))}},9193:(e,t,r)=>{"use strict";var n=r(3e3);e.exports=function(e){var t=n(e),r=0,i=0,o=0,a=0;if(t.length){if(t.length>1&&0===t[0].width){var s=t[1];r=s.top,i=s.right,o=s.bottom,a=s.left}else{var l=t[0];r=l.top,i=l.right,o=l.bottom,a=l.left}for(var c=1;c<t.length;c++){var u=t[c];0!==u.height&&0!==u.width&&(r=Math.min(r,u.top),i=Math.max(i,u.right),o=Math.max(o,u.bottom),a=Math.min(a,u.left))}}return{top:r,right:i,bottom:o,left:a,width:i-a,height:o-r}}},3e3:(e,t,r)=>{"use strict";var n=r(6143),i=r(6415);var o=n.isBrowser("Chrome")?function(e){for(var t=e.cloneRange(),r=[],n=e.endContainer;null!=n;n=n.parentNode){var o=n===e.commonAncestorContainer;o?t.setStart(e.startContainer,e.startOffset):t.setStart(t.endContainer,0);var a,s=Array.from(t.getClientRects());if(r.push(s),o)return r.reverse(),(a=[]).concat.apply(a,r);t.setEndBefore(n)}i(!1)}:function(e){return Array.from(e.getClientRects())};e.exports=o},1306:(e,t,r)=>{"use strict";var n=r(6415);e.exports=function(e,t){var r=[];return e.findEntityRanges((function(e){return e.getEntity()===t}),(function(e,t){r.push({start:e,end:t})})),r.length||n(!1),r}},6357:(e,t,r)=>{"use strict";var n=r(6143),i=r(6415),o=n.isBrowser("IE <= 9");e.exports=function(e){var t,r=null;return!o&&document.implementation&&document.implementation.createHTMLDocument&&((t=document.implementation.createHTMLDocument("foo")).documentElement||i(!1),t.documentElement.innerHTML=e,r=t.getElementsByTagName("body")[0]),r}},8746:(e,t,r)=>{"use strict";var n=r(7385);e.exports=function e(t){if(n(t)){var r=t,i=r.getAttribute("data-offset-key");if(i)return i;for(var o=0;o<r.childNodes.length;o++){var a=e(r.childNodes[o]);if(a)return a}}return null}},2962:(e,t,r)=>{"use strict";var n=r(6415),i=/\.textClipping$/,o={"text/plain":!0,"text/html":!0,"text/rtf":!0};e.exports=function(e,t){var a=0,s=[];e.forEach((function(l){!function(e,t){if(!r.g.FileReader||e.type&&!(e.type in o))return void t("");if(""===e.type){var a="";return i.test(e.name)&&(a=e.name.replace(i,"")),void t(a)}var s=new FileReader;s.onload=function(){var e=s.result;"string"!==typeof e&&n(!1),t(e)},s.onerror=function(){t("")},s.readAsText(e)}(l,(function(r){a++,r&&s.push(r.slice(0,5e3)),a==e.length&&t(s.join("\r"))}))}))}},4733:(e,t,r)=>{"use strict";var n=r(4414),i=r(8691);e.exports=function(e,t,r,o,a){var s=i(e.getSelection());if(!t||!o)return s;var l=n.decode(t),c=l.blockKey,u=e.getBlockTree(c),h=u&&u.getIn([l.decoratorKey,"leaves",l.leafKey]),d=n.decode(o),f=d.blockKey,g=e.getBlockTree(f),p=g&&g.getIn([d.decoratorKey,"leaves",d.leafKey]);if(!h||!p)return s;var m=h.get("start"),v=p.get("start"),b=h?m+r:null,y=p?v+a:null;if(s.getAnchorKey()===c&&s.getAnchorOffset()===b&&s.getFocusKey()===f&&s.getFocusOffset()===y)return s;var w=!1;if(c===f){var S=h.get("end"),C=p.get("end");w=v===m&&C===S?a<r:v<m}else{w=e.getCurrentContent().getBlockMap().keySeq().skipUntil((function(e){return e===c||e===f})).first()===f}return s.merge({anchorKey:c,anchorOffset:b,focusKey:f,focusOffset:y,isBackward:w})}},4587:(e,t,r)=>{"use strict";var n=r(9193);e.exports=function(e){var t=e.getSelection();if(!t.rangeCount)return null;var r=t.getRangeAt(0),i=n(r),o=i.top,a=i.right,s=i.bottom,l=i.left;return 0===o&&0===a&&0===s&&0===l?null:i}},978:e=>{"use strict";e.exports=function(e){return e&&e.ownerDocument&&e.ownerDocument.defaultView?e.ownerDocument.defaultView:window}},8819:e=>{"use strict";e.exports=function(e){return!("undefined"===typeof window||!window.__DRAFT_GKX)&&!!window.__DRAFT_GKX[e]}},3384:(e,t,r)=>{"use strict";var n=r(3305),i=r(6559),o=r(4453),a=r(3422),s=r(6415),l=r(1287),c=o.List,u=function(e,t,r,o,a,s){var l=r.first()instanceof i,u=[],h=o.size,d=r.get(a),f=o.first(),g=o.last(),p=g.getLength(),m=g.getKey(),v=l&&(!d.getChildKeys().isEmpty()||!f.getChildKeys().isEmpty());r.forEach((function(e,t){t===a?(v?u.push(e):u.push(function(e,t,r){var n=e.getText(),i=e.getCharacterList(),o=n.slice(0,t),a=i.slice(0,t),s=r.first();return e.merge({text:o+s.getText(),characterList:a.concat(s.getCharacterList()),type:o?e.getType():s.getType(),data:s.getData()})}(e,s,o)),o.slice(v?0:1,h-1).forEach((function(e){return u.push(e)})),u.push(function(e,t,r){var n=e.getText(),i=e.getCharacterList(),o=n.length,a=n.slice(t,o),s=i.slice(t,o),l=r.last();return l.merge({text:l.getText()+a,characterList:l.getCharacterList().concat(s),data:l.getData()})}(e,s,o))):u.push(e)}));var b=n.createFromArray(u);return l&&(b=function(e,t,r,n){return e.withMutations((function(t){var i=r.getKey(),o=n.getKey(),a=r.getNextSiblingKey(),s=r.getParentKey(),l=function(e,t){var r=e.getKey(),n=e,i=[];for(t.get(r)&&i.push(r);n&&n.getNextSiblingKey();){var o=n.getNextSiblingKey();if(!o)break;i.push(o),n=t.get(o)}return i}(n,e),u=l[l.length-1];if(t.get(o)?(t.setIn([i,"nextSibling"],o),t.setIn([o,"prevSibling"],i)):(t.setIn([i,"nextSibling"],n.getNextSiblingKey()),t.setIn([n.getNextSiblingKey(),"prevSibling"],i)),t.setIn([u,"nextSibling"],a),a&&t.setIn([a,"prevSibling"],u),l.forEach((function(e){return t.setIn([e,"parent"],s)})),s){var h=e.get(s).getChildKeys(),d=h.indexOf(i)+1,f=h.toArray();f.splice.apply(f,[d,0].concat(l)),t.setIn([s,"children"],c(f))}}))}(b,0,d,f)),e.merge({blockMap:b,selectionBefore:t,selectionAfter:t.merge({anchorKey:m,anchorOffset:p,focusKey:m,focusOffset:p,isBackward:!1})})};e.exports=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"REPLACE_WITH_NEW_DATA";t.isCollapsed()||s(!1);var o=e.getBlockMap(),c=l(r),h=t.getStartKey(),d=t.getStartOffset(),f=o.get(h);return f instanceof i&&(f.getChildKeys().isEmpty()||s(!1)),1===c.size?function(e,t,r,n,i,o){var s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"REPLACE_WITH_NEW_DATA",l=r.get(i),c=l.getText(),u=l.getCharacterList(),h=i,d=o+n.getText().length,f=null;switch(s){case"MERGE_OLD_DATA_TO_NEW_DATA":f=n.getData().merge(l.getData());break;case"REPLACE_WITH_NEW_DATA":f=n.getData()}var g=l.getType();c&&"unstyled"===g&&(g=n.getType());var p=l.merge({text:c.slice(0,o)+n.getText()+c.slice(o),characterList:a(u,n.getCharacterList(),o),type:g,data:f});return e.merge({blockMap:r.set(i,p),selectionBefore:t,selectionAfter:t.merge({anchorKey:h,anchorOffset:d,focusKey:h,focusOffset:d,isBackward:!1})})}(e,t,o,c.first(),h,d,n):u(e,t,o,c,h,d)}},3422:e=>{"use strict";e.exports=function(e,t,r){var n=e;if(r===n.count())t.forEach((function(e){n=n.push(e)}));else if(0===r)t.reverse().forEach((function(e){n=n.unshift(e)}));else{var i=n.slice(0,r),o=n.slice(r);n=i.concat(t,o).toList()}return n}},5311:(e,t,r)=>{"use strict";var n=r(4453),i=r(3422),o=r(6415),a=n.Repeat;e.exports=function(e,t,r,n){t.isCollapsed()||o(!1);var s=null;if(null!=r&&(s=r.length),null==s||0===s)return e;var l=e.getBlockMap(),c=t.getStartKey(),u=t.getStartOffset(),h=l.get(c),d=h.getText(),f=h.merge({text:d.slice(0,u)+r+d.slice(u,h.getLength()),characterList:i(h.getCharacterList(),a(n,s).toList(),u)}),g=u+s;return e.merge({blockMap:l.set(c,f),selectionAfter:t.merge({anchorOffset:g,focusOffset:g})})}},7385:e=>{"use strict";e.exports=function(e){return!(!e||!e.ownerDocument)&&e.nodeType===Node.ELEMENT_NODE}},9303:e=>{"use strict";e.exports=function(e){return"handled"===e||!0===e}},5941:(e,t,r)=>{"use strict";var n=r(7385);e.exports=function(e){return!(!e||!e.ownerDocument)&&(n(e)&&"A"===e.nodeName)}},5030:(e,t,r)=>{"use strict";var n=r(7385);e.exports=function(e){return!(!e||!e.ownerDocument)&&(n(e)&&"BR"===e.nodeName)}},9990:e=>{"use strict";e.exports=function(e){return!(!e||!e.ownerDocument)&&(e.ownerDocument.defaultView?e instanceof e.ownerDocument.defaultView.HTMLElement:e instanceof HTMLElement)}},1967:(e,t,r)=>{"use strict";var n=r(7385);e.exports=function(e){return!(!e||!e.ownerDocument)&&(n(e)&&"IMG"===e.nodeName)}},9167:e=>{"use strict";e.exports=function(e){if(!e||!("ownerDocument"in e))return!1;if("ownerDocument"in e){var t=e;if(!t.ownerDocument.defaultView)return t instanceof Node;if(t instanceof t.ownerDocument.defaultView.Node)return!0}return!1}},1900:e=>{"use strict";e.exports=function(e){var t=e.getSelection(),r=t.getAnchorKey(),n=e.getBlockTree(r),i=t.getStartOffset(),o=!1;return n.some((function(e){return i===e.get("start")?(o=!0,!0):i<e.get("end")&&e.get("leaves").some((function(e){var t=e.get("start");return i===t&&(o=!0,!0)}))})),o}},2013:(e,t,r)=>{"use strict";var n=r(4923);e.exports=function(e){return e.which===n.RETURN&&(e.getModifierState("Shift")||e.getModifierState("Alt")||e.getModifierState("Control"))}},9384:(e,t,r)=>{"use strict";var n=r(6283),i=r(5798),o=r(7404),a=r(1873),s=r(3767);e.exports=function(e,t){var r=s(e,(function(e){var r=e.getSelection();if(r.isCollapsed()&&0===r.getAnchorOffset())return a(e,1);var n=t.currentTarget.ownerDocument.defaultView.getSelection().getRangeAt(0);return n=i(n),o(e,null,n.endContainer,n.endOffset,n.startContainer,n.startOffset).selectionState}),"backward");return r===e.getCurrentContent()?e:n.push(e,r,"remove-range")}},8502:(e,t,r)=>{"use strict";var n=r(4801),i=r(6283),o=r(1873),a=r(3767);e.exports=function(e){var t=a(e,(function(e){var t=e.getSelection(),r=t.getStartOffset();if(0===r)return o(e,1);var i=t.getStartKey(),a=e.getCurrentContent().getBlockForKey(i).getText().slice(0,r),s=n.getBackward(a);return o(e,s.length||1)}),"backward");return t===e.getCurrentContent()?e:i.push(e,t,"remove-range")}},6882:(e,t,r)=>{"use strict";var n=r(4801),i=r(6283),o=r(8799),a=r(3767);e.exports=function(e){var t=a(e,(function(e){var t=e.getSelection(),r=t.getStartOffset(),i=t.getStartKey(),a=e.getCurrentContent().getBlockForKey(i).getText().slice(r),s=n.getForward(a);return o(e,s.length||1)}),"forward");return t===e.getCurrentContent()?e:i.push(e,t,"remove-range")}},4454:(e,t,r)=>{"use strict";var n=r(5763),i=r(6283);e.exports=function(e){var t=n.splitBlock(e.getCurrentContent(),e.getSelection());return i.push(e,t,"split-block")}},8516:(e,t,r)=>{"use strict";var n=r(6283);e.exports=function(e){var t=e.getSelection(),r=t.getEndKey(),i=e.getCurrentContent().getBlockForKey(r).getLength();return n.set(e,{selection:t.merge({anchorKey:r,anchorOffset:i,focusKey:r,focusOffset:i,isBackward:!1}),forceSelection:!0})}},7603:(e,t,r)=>{"use strict";var n=r(6283);e.exports=function(e){var t=e.getSelection(),r=t.getStartKey();return n.set(e,{selection:t.merge({anchorKey:r,anchorOffset:0,focusKey:r,focusOffset:0,isBackward:!1}),forceSelection:!0})}},2002:(e,t,r)=>{"use strict";var n=r(6283),i=r(4939),o=r(1873),a=r(3767);e.exports=function(e){var t=a(e,(function(e){var t=e.getSelection(),r=e.getCurrentContent(),n=t.getAnchorKey(),a=t.getAnchorOffset(),s=r.getBlockForKey(n).getText()[a-1];return o(e,s?i.getUTF16Length(s,0):1)}),"backward");if(t===e.getCurrentContent())return e;var r=e.getSelection();return n.push(e,t.set("selectionBefore",r),r.isCollapsed()?"backspace-character":"remove-range")}},2198:(e,t,r)=>{"use strict";var n=r(6283),i=r(4939),o=r(8799),a=r(3767);e.exports=function(e){var t=a(e,(function(e){var t=e.getSelection(),r=e.getCurrentContent(),n=t.getAnchorKey(),a=t.getAnchorOffset(),s=r.getBlockForKey(n).getText()[a];return o(e,s?i.getUTF16Length(s,0):1)}),"forward");if(t===e.getCurrentContent())return e;var r=e.getSelection();return n.push(e,t.set("selectionBefore",r),r.isCollapsed()?"delete-character":"remove-range")}},9690:(e,t,r)=>{"use strict";var n=r(5763),i=r(6283),o=r(6935);e.exports=function(e){var t=e.getSelection();if(!t.isCollapsed())return e;var r=t.getAnchorOffset();if(0===r)return e;var a,s,l=t.getAnchorKey(),c=e.getCurrentContent(),u=c.getBlockForKey(l).getLength();if(u<=1)return e;r===u?(a=t.set("anchorOffset",r-1),s=t):s=(a=t.set("focusOffset",r+1)).set("anchorOffset",r+1);var h=o(c,a),d=n.removeRange(c,a,"backward"),f=d.getSelectionAfter(),g=f.getAnchorOffset()-1,p=f.merge({anchorOffset:g,focusOffset:g}),m=n.replaceWithFragment(d,p,h),v=i.push(e,m,"insert-fragment");return i.acceptSelection(v,s)}},4059:(e,t,r)=>{"use strict";var n=r(6283);e.exports=function(e,t,r){var i=n.undo(t);if("spellcheck-change"!==t.getLastChangeType())e.preventDefault(),t.getNativelyRenderedContent()?(r(n.set(t,{nativelyRenderedContent:null})),setTimeout((function(){r(i)}),0)):r(i);else{var o=i.getCurrentContent();r(n.set(i,{nativelyRenderedContent:o}))}}},1477:(e,t,r)=>{"use strict";var n=r(4453).Map;e.exports=function(e,t,r){var i=t.getStartKey(),o=t.getEndKey(),a=e.getBlockMap(),s=a.toSeq().skipUntil((function(e,t){return t===i})).takeUntil((function(e,t){return t===o})).concat(n([[o,a.get(o)]])).map(r);return e.merge({blockMap:a.merge(s),selectionBefore:t,selectionAfter:t})}},7414:(e,t,r)=>{"use strict";var n=r(6559),i=r(5791),o=r(4453),a=r(6415),s=o.OrderedMap,l=o.List,c=function(e,t,r){if(e){var n=t.get(e);n&&t.set(e,r(n))}},u=function(e,t,r,n,i){if(!i)return e;var o="after"===n,a=t.getKey(),s=r.getKey(),u=t.getParentKey(),h=t.getNextSiblingKey(),d=t.getPrevSiblingKey(),f=r.getParentKey(),g=o?r.getNextSiblingKey():s,p=o?s:r.getPrevSiblingKey();return e.withMutations((function(e){c(u,e,(function(e){var t=e.getChildKeys();return e.merge({children:t.delete(t.indexOf(a))})})),c(d,e,(function(e){return e.merge({nextSibling:h})})),c(h,e,(function(e){return e.merge({prevSibling:d})})),c(g,e,(function(e){return e.merge({prevSibling:a})})),c(p,e,(function(e){return e.merge({nextSibling:a})})),c(f,e,(function(e){var t=e.getChildKeys(),r=t.indexOf(s),n=o?r+1:0!==r?r-1:0,i=t.toArray();return i.splice(n,0,a),e.merge({children:l(i)})})),c(a,e,(function(e){return e.merge({nextSibling:g,prevSibling:p,parent:f})}))}))};e.exports=function(e,t,r,o){"replace"===o&&a(!1);var l=r.getKey(),c=t.getKey();c===l&&a(!1);var h=e.getBlockMap(),d=t instanceof n,f=[t],g=h.delete(c);d&&(f=[],g=h.withMutations((function(e){var r=t.getNextSiblingKey(),n=i(t,e);e.toSeq().skipUntil((function(e){return e.getKey()===c})).takeWhile((function(e){var t=e.getKey(),i=t===c,o=r&&t!==r,a=!r&&e.getParentKey()&&(!n||t!==n);return!!(i||o||a)})).forEach((function(t){f.push(t),e.delete(t.getKey())}))})));var p=g.toSeq().takeUntil((function(e){return e===r})),m=g.toSeq().skipUntil((function(e){return e===r})).skip(1),v=f.map((function(e){return[e.getKey(),e]})),b=s();if("before"===o){var y=e.getBlockBefore(l);y&&y.getKey()===t.getKey()&&a(!1),b=p.concat([].concat(v,[[l,r]]),m).toOrderedMap()}else if("after"===o){var w=e.getBlockAfter(l);w&&w.getKey()===c&&a(!1),b=p.concat([[l,r]].concat(v),m).toOrderedMap()}return e.merge({blockMap:u(b,t,r,o,d),selectionBefore:e.getSelectionAfter(),selectionAfter:e.getSelectionAfter().merge({anchorKey:c,focusKey:c})})}},1873:(e,t,r)=>{"use strict";r(7443);e.exports=function(e,t){var r=e.getSelection(),n=e.getCurrentContent(),i=r.getStartKey(),o=r.getStartOffset(),a=i,s=0;if(t>o){var l=n.getKeyBefore(i);if(null==l)a=i;else a=l,s=n.getBlockForKey(l).getText().length}else s=o-t;return r.merge({focusKey:a,focusOffset:s,isBackward:!0})}},8799:(e,t,r)=>{"use strict";r(7443);e.exports=function(e,t){var r,n=e.getSelection(),i=n.getStartKey(),o=n.getStartOffset(),a=e.getCurrentContent(),s=i;return t>a.getBlockForKey(i).getText().length-o?(s=a.getKeyAfter(i),r=0):r=o+t,n.merge({focusKey:s,focusOffset:r})}},1287:(e,t,r)=>{"use strict";var n=r(6559),i=r(306),o=r(4453).OrderedMap;e.exports=function(e){return e.first()instanceof n?function(e){var t,r={};return o(e.withMutations((function(e){e.forEach((function(n,o){var a=n.getKey(),s=n.getNextSiblingKey(),l=n.getPrevSiblingKey(),c=n.getChildKeys(),u=n.getParentKey(),h=i();if(r[a]=h,s&&(e.get(s)?e.setIn([s,"prevSibling"],h):e.setIn([a,"nextSibling"],null)),l&&(e.get(l)?e.setIn([l,"nextSibling"],h):e.setIn([a,"prevSibling"],null)),u&&e.get(u)){var d=e.get(u).getChildKeys();e.setIn([u,"children"],d.set(d.indexOf(n.getKey()),h))}else e.setIn([a,"parent"],null),t&&(e.setIn([t.getKey(),"nextSibling"],h),e.setIn([a,"prevSibling"],r[t.getKey()])),t=e.get(a);c.forEach((function(t){e.get(t)?e.setIn([t,"parent"],h):e.setIn([a,"children"],n.getChildKeys().filter((function(e){return e!==t})))}))}))})).toArray().map((function(e){return[r[e.getKey()],e.set("key",r[e.getKey()])]})))}(e):function(e){return o(e.toArray().map((function(e){var t=i();return[t,e.set("key",t)]})))}(e)}},9529:(e,t,r)=>{"use strict";var n=r(2367),i=r(8678),o=r(6415);function a(e,t,r){var a=t.getCharacterList(),s=r>0?a.get(r-1):void 0,l=r<a.count()?a.get(r):void 0,c=s?s.getEntity():void 0,u=l?l.getEntity():void 0;if(u&&u===c&&"MUTABLE"!==e.__get(u).getMutability()){for(var h,d=function(e,t,r){var n;return i(e,(function(e,t){return e.getEntity()===t.getEntity()}),(function(e){return e.getEntity()===t}),(function(e,t){e<=r&&t>=r&&(n={start:e,end:t})})),"object"!==typeof n&&o(!1),n}(a,u,r),f=d.start,g=d.end;f<g;)h=a.get(f),a=a.set(f,n.applyEntity(h,null)),f++;return t.set("characterList",a)}return t}e.exports=function(e,t){var r=e.getBlockMap(),n=e.getEntityMap(),i={},o=t.getStartKey(),s=t.getStartOffset(),l=r.get(o),c=a(n,l,s);c!==l&&(i[o]=c);var u=t.getEndKey(),h=t.getEndOffset(),d=r.get(u);o===u&&(d=c);var f=a(n,d,h);return f!==d&&(i[u]=f),Object.keys(i).length?e.merge({blockMap:r.merge(i),selectionAfter:t}):e.set("selectionAfter",t)}},5638:(e,t,r)=>{"use strict";var n=r(6559),i=r(5791),o=r(4453),a=(o.List,o.Map),s=function(e,t,r){if(e){var n=t.get(e);n&&t.set(e,r(n))}},l=function(e,t){var r=[];if(!e)return r;for(var n=t.get(e);n&&n.getParentKey();){var i=n.getParentKey();i&&r.push(i),n=i?t.get(i):null}return r},c=function(e,t,r){if(!e)return null;for(var n=r.get(e.getKey()).getNextSiblingKey();n&&!t.get(n);)n=r.get(n).getNextSiblingKey()||null;return n},u=function(e,t,r){if(!e)return null;for(var n=r.get(e.getKey()).getPrevSiblingKey();n&&!t.get(n);)n=r.get(n).getPrevSiblingKey()||null;return n},h=function(e,t,r,n){return e.withMutations((function(o){if(s(t.getKey(),o,(function(e){return e.merge({nextSibling:c(e,o,n),prevSibling:u(e,o,n)})})),s(r.getKey(),o,(function(e){return e.merge({nextSibling:c(e,o,n),prevSibling:u(e,o,n)})})),l(t.getKey(),n).forEach((function(e){return s(e,o,(function(e){return e.merge({children:e.getChildKeys().filter((function(e){return o.get(e)})),nextSibling:c(e,o,n),prevSibling:u(e,o,n)})}))})),s(t.getNextSiblingKey(),o,(function(e){return e.merge({prevSibling:t.getPrevSiblingKey()})})),s(t.getPrevSiblingKey(),o,(function(e){return e.merge({nextSibling:c(e,o,n)})})),s(r.getNextSiblingKey(),o,(function(e){return e.merge({prevSibling:u(e,o,n)})})),s(r.getPrevSiblingKey(),o,(function(e){return e.merge({nextSibling:r.getNextSiblingKey()})})),l(r.getKey(),n).forEach((function(e){s(e,o,(function(e){return e.merge({children:e.getChildKeys().filter((function(e){return o.get(e)})),nextSibling:c(e,o,n),prevSibling:u(e,o,n)})}))})),function(e,t){var r=[];if(!e)return r;for(var n=i(e,t);n&&t.get(n);){var o=t.get(n);r.push(n),n=o.getParentKey()?i(o,t):null}return r}(r,n).forEach((function(e){return s(e,o,(function(e){return e.merge({nextSibling:c(e,o,n),prevSibling:u(e,o,n)})}))})),null==e.get(t.getKey())&&null!=e.get(r.getKey())&&r.getParentKey()===t.getKey()&&null==r.getPrevSiblingKey()){var a=t.getPrevSiblingKey();s(r.getKey(),o,(function(e){return e.merge({prevSibling:a})})),s(a,o,(function(e){return e.merge({nextSibling:r.getKey()})}));var h=a?e.get(a):null,d=h?h.getParentKey():null;if(t.getChildKeys().forEach((function(e){s(e,o,(function(e){return e.merge({parent:d})}))})),null!=d){var f=e.get(d);s(d,o,(function(e){return e.merge({children:f.getChildKeys().concat(t.getChildKeys())})}))}s(t.getChildKeys().find((function(t){return null===e.get(t).getNextSiblingKey()})),o,(function(e){return e.merge({nextSibling:t.getNextSiblingKey()})}))}}))},d=function(e,t,r){if(0===t)for(;t<r;)e=e.shift(),t++;else if(r===e.count())for(;r>t;)e=e.pop(),r--;else{var n=e.slice(0,t),i=e.slice(r);e=n.concat(i).toList()}return e};e.exports=function(e,t){if(t.isCollapsed())return e;var r,o=e.getBlockMap(),s=t.getStartKey(),c=t.getStartOffset(),u=t.getEndKey(),f=t.getEndOffset(),g=o.get(s),p=o.get(u),m=g instanceof n,v=[];if(m){var b=p.getChildKeys(),y=l(u,o);p.getNextSiblingKey()&&(v=v.concat(y)),b.isEmpty()||(v=v.concat(y.concat([u]))),v=v.concat(l(i(p,o),o))}r=g===p?d(g.getCharacterList(),c,f):g.getCharacterList().slice(0,c).concat(p.getCharacterList().slice(f));var w=g.merge({text:g.getText().slice(0,c)+p.getText().slice(f),characterList:r}),S=m&&0===c&&0===f&&p.getParentKey()===s&&null==p.getPrevSiblingKey()?a([[s,null]]):o.toSeq().skipUntil((function(e,t){return t===s})).takeUntil((function(e,t){return t===u})).filter((function(e,t){return-1===v.indexOf(t)})).concat(a([[u,null]])).map((function(e,t){return t===s?w:null})),C=o.merge(S).filter((function(e){return!!e}));return m&&g!==p&&(C=h(C,g,p,o)),e.merge({blockMap:C,selectionBefore:t,selectionAfter:t.merge({anchorKey:s,anchorOffset:c,focusKey:s,focusOffset:c,isBackward:!1})})}},3767:(e,t,r)=>{"use strict";var n=r(5763),i=r(8819)("draft_tree_data_support");e.exports=function(e,t,r){var o=e.getSelection(),a=e.getCurrentContent(),s=o,l=o.getAnchorKey(),c=o.getFocusKey(),u=a.getBlockForKey(l);if(i&&"forward"===r&&l!==c)return a;if(o.isCollapsed()){if("forward"===r){if(e.isSelectionAtEndOfContent())return a;if(i)if(o.getAnchorOffset()===a.getBlockForKey(l).getLength()){var h=a.getBlockForKey(u.nextSibling);if(!h||0===h.getLength())return a}}else if(e.isSelectionAtStartOfContent())return a;if((s=t(e))===o)return a}return n.removeRange(a,s,r)}},3272:e=>{"use strict";var t=new RegExp("\r","g");e.exports=function(e){return e.replace(t,"")}},1981:(e,t,r)=>{"use strict";var n=r(8250),i=r(8645),o=r(6143),a=r(3922),s=r(5089),l=r(8358),c=r(6415),u=r(7385),h=o.isBrowser("IE");function d(e,t){if(!e)return"[empty]";var r=f(e,t);return r.nodeType===Node.TEXT_NODE?r.textContent:(u(r)||c(!1),r.outerHTML)}function f(e,t){var r=void 0!==t?t(e):[];if(e.nodeType===Node.TEXT_NODE){var n=e.textContent.length;return l(e).createTextNode("[text "+n+(r.length?" | "+r.join(", "):"")+"]")}var i=e.cloneNode();1===i.nodeType&&r.length&&i.setAttribute("data-labels",r.join(", "));for(var o=e.childNodes,a=0;a<o.length;a++)i.appendChild(f(o[a],t));return i}function g(e,t){for(var r=e,n=r;r;){if(u(r)&&n.hasAttribute("contenteditable"))return d(r,t);n=r=r.parentNode}return"Could not find contentEditable parent of node"}function p(e){return null===e.nodeValue?e.childNodes.length:e.nodeValue.length}function m(e,t,r,n){var o=s();if(e.extend&&null!=t&&a(o,t)){r>p(t)&&i.logSelectionStateFailure({anonymizedDom:g(t),extraParams:JSON.stringify({offset:r}),selectionState:JSON.stringify(n.toJS())});var l=t===e.focusNode;try{e.rangeCount>0&&e.extend&&e.extend(t,r)}catch(u){throw i.logSelectionStateFailure({anonymizedDom:g(t,(function(t){var r=[];return t===o&&r.push("active element"),t===e.anchorNode&&r.push("selection anchor node"),t===e.focusNode&&r.push("selection focus node"),r})),extraParams:JSON.stringify({activeElementName:o?o.nodeName:null,nodeIsFocus:t===e.focusNode,nodeWasFocus:l,selectionRangeCount:e.rangeCount,selectionAnchorNodeName:e.anchorNode?e.anchorNode.nodeName:null,selectionAnchorOffset:e.anchorOffset,selectionFocusNodeName:e.focusNode?e.focusNode.nodeName:null,selectionFocusOffset:e.focusOffset,message:u?""+u:null,offset:r},null,2),selectionState:JSON.stringify(n.toJS(),null,2)}),u}}else if(t&&e.rangeCount>0){var c=e.getRangeAt(0);c.setEnd(t,r),e.addRange(c.cloneRange())}}function v(e,t,r,o){var a=l(t).createRange();if(r>p(t)&&(i.logSelectionStateFailure({anonymizedDom:g(t),extraParams:JSON.stringify({offset:r}),selectionState:JSON.stringify(o.toJS())}),n.handleExtensionCausedError()),a.setStart(t,r),h)try{e.addRange(a)}catch(s){0}else e.addRange(a)}e.exports={setDraftEditorSelection:function(e,t,r,n,i){var o=l(t);if(a(o.documentElement,t)){var s=o.defaultView.getSelection(),c=e.getAnchorKey(),u=e.getAnchorOffset(),h=e.getFocusKey(),d=e.getFocusOffset(),f=e.getIsBackward();if(!s.extend&&f){var g=c,p=u;c=h,u=d,h=g,d=p,f=!1}var b=c===r&&n<=u&&i>=u,y=h===r&&n<=d&&i>=d;if(b&&y)return s.removeAllRanges(),v(s,t,u-n,e),void m(s,t,d-n,e);if(f){if(y&&(s.removeAllRanges(),v(s,t,d-n,e)),b){var w=s.focusNode,S=s.focusOffset;s.removeAllRanges(),v(s,t,u-n,e),m(s,w,S,e)}}else b&&(s.removeAllRanges(),v(s,t,u-n,e)),y&&m(s,t,d-n,e)}},addFocusToSelection:m}},8701:(e,t,r)=>{"use strict";var n=r(6559),i=r(306),o=r(4453),a=r(6415),s=r(1477),l=o.List,c=o.Map,u=function(e,t,r){if(e){var n=t.get(e);n&&t.set(e,r(n))}};e.exports=function(e,t){t.isCollapsed()||a(!1);var r=t.getAnchorKey(),o=e.getBlockMap(),h=o.get(r),d=h.getText();if(!d){var f=h.getType();if("unordered-list-item"===f||"ordered-list-item"===f)return s(e,t,(function(e){return e.merge({type:"unstyled",depth:0})}))}var g=t.getAnchorOffset(),p=h.getCharacterList(),m=i(),v=h instanceof n,b=h.merge({text:d.slice(0,g),characterList:p.slice(0,g)}),y=b.merge({key:m,text:d.slice(g),characterList:p.slice(g),data:c()}),w=o.toSeq().takeUntil((function(e){return e===h})),S=o.toSeq().skipUntil((function(e){return e===h})).rest(),C=w.concat([[r,b],[m,y]],S).toOrderedMap();return v&&(h.getChildKeys().isEmpty()||a(!1),C=function(e,t,r){return e.withMutations((function(e){var n=t.getKey(),i=r.getKey();u(t.getParentKey(),e,(function(e){var t=e.getChildKeys(),r=t.indexOf(n)+1,o=t.toArray();return o.splice(r,0,i),e.merge({children:l(o)})})),u(t.getNextSiblingKey(),e,(function(e){return e.merge({prevSibling:i})})),u(n,e,(function(e){return e.merge({nextSibling:i})})),u(i,e,(function(e){return e.merge({prevSibling:n})}))}))}(C,b,y)),e.merge({blockMap:C,selectionBefore:t,selectionAfter:t.merge({anchorKey:m,anchorOffset:0,focusKey:m,focusOffset:0,isBackward:!1})})}},8009:e=>{"use strict";var t=/\r\n?|\n/g;e.exports=function(e){return e.split(t)}},6246:e=>{"use strict";e.exports=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}))}},6968:(e,t,r)=>{"use strict";var n=r(5902),i=r(475),o=r(9534),a=new RegExp("\r\n","g"),s={"text/rtf":1,"text/html":1};function l(e){if("file"==e.kind)return e.getAsFile()}var c=function(){function e(e){this.data=e,this.types=e.types?i(e.types):[]}var t=e.prototype;return t.isRichText=function(){return!(!this.getHTML()||!this.getText())||!this.isImage()&&this.types.some((function(e){return s[e]}))},t.getText=function(){var e;return this.data.getData&&(this.types.length?-1!=this.types.indexOf("text/plain")&&(e=this.data.getData("text/plain")):e=this.data.getData("Text")),e?e.replace(a,"\n"):null},t.getHTML=function(){if(this.data.getData){if(!this.types.length)return this.data.getData("Text");if(-1!=this.types.indexOf("text/html"))return this.data.getData("text/html")}},t.isLink=function(){return this.types.some((function(e){return-1!=e.indexOf("Url")||-1!=e.indexOf("text/uri-list")||e.indexOf("text/x-moz-url")}))},t.getLink=function(){return this.data.getData?-1!=this.types.indexOf("text/x-moz-url")?this.data.getData("text/x-moz-url").split("\n")[0]:-1!=this.types.indexOf("text/uri-list")?this.data.getData("text/uri-list"):this.data.getData("url"):null},t.isImage=function(){var e=this.types.some((function(e){return-1!=e.indexOf("application/x-moz-file")}));if(e)return!0;for(var t=this.getFiles(),r=0;r<t.length;r++){var i=t[r].type;if(!n.isImage(i))return!1}return!0},t.getCount=function(){return this.data.hasOwnProperty("items")?this.data.items.length:this.data.hasOwnProperty("mozItemCount")?this.data.mozItemCount:this.data.files?this.data.files.length:null},t.getFiles=function(){return this.data.items?Array.prototype.slice.call(this.data.items).map(l).filter(o.thatReturnsArgument):this.data.files?Array.prototype.slice.call(this.data.files):[]},t.hasFiles=function(){return this.getFiles().length>0},e}();e.exports=c},4923:e=>{"use strict";e.exports={BACKSPACE:8,TAB:9,RETURN:13,ALT:18,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,DELETE:46,COMMA:188,PERIOD:190,A:65,Z:90,ZERO:48,NUMPAD_0:96,NUMPAD_9:105}},5902:e=>{"use strict";var t={isImage:function(e){return"image"===r(e)[0]},isJpeg:function(e){var n=r(e);return t.isImage(e)&&("jpeg"===n[1]||"pjpeg"===n[1])}};function r(e){return e.split("/")}e.exports=t},5914:e=>{"use strict";function t(e,t){return!!t&&(e===t.documentElement||e===t.body)}var r={getTop:function(e){var r=e.ownerDocument;return t(e,r)?r.body.scrollTop||r.documentElement.scrollTop:e.scrollTop},setTop:function(e,r){var n=e.ownerDocument;t(e,n)?n.body.scrollTop=n.documentElement.scrollTop=r:e.scrollTop=r},getLeft:function(e){var r=e.ownerDocument;return t(e,r)?r.body.scrollLeft||r.documentElement.scrollLeft:e.scrollLeft},setLeft:function(e,r){var n=e.ownerDocument;t(e,n)?n.body.scrollLeft=n.documentElement.scrollLeft=r:e.scrollLeft=r}};e.exports=r},1614:(e,t,r)=>{"use strict";function n(e,t){var r=i.get(e,t);return"auto"===r||"scroll"===r}var i={get:r(1075),getScrollParent:function(e){if(!e)return null;for(var t=e.ownerDocument;e&&e!==t.body;){if(n(e,"overflow")||n(e,"overflowY")||n(e,"overflowX"))return e;e=e.parentNode}return t.defaultView||t.parentWindow}};e.exports=i},8978:e=>{"use strict";e.exports={getPunctuation:function(){return"[.,+*?$|#{}()'\\^\\-\\[\\]\\\\\\/!@%\"~=<>_:;\u30fb\u3001\u3002\u3008-\u3011\u3014-\u301f\uff1a-\uff1f\uff01-\uff0f\uff3b-\uff40\uff5b-\uff65\u2e2e\u061f\u066a-\u066c\u061b\u060c\u060d\ufd3e\ufd3f\u1801\u0964\u104a\u104b\u2010-\u2027\u2030-\u205e\xa1-\xb1\xb4-\xb8\xba\xbb\xbf]"}}},9493:e=>{"use strict";var t=function(){function e(e){var t,r,n;n=void 0,(r="_uri")in(t=this)?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n,this._uri=e}return e.prototype.toString=function(){return this._uri},e}();e.exports=t},5782:(e,t,r)=>{"use strict";var n=r(4669),i=r(6415),o="\u0590\u05be\u05c0\u05c3\u05c6\u05c8-\u05cf\u05d0-\u05ea\u05eb-\u05ef\u05f0-\u05f2\u05f3-\u05f4\u05f5-\u05ff\u07c0-\u07c9\u07ca-\u07ea\u07f4-\u07f5\u07fa\u07fb-\u07ff\u0800-\u0815\u081a\u0824\u0828\u082e-\u082f\u0830-\u083e\u083f\u0840-\u0858\u085c-\u085d\u085e\u085f-\u089f\u200f\ufb1d\ufb1f-\ufb28\ufb2a-\ufb36\ufb37\ufb38-\ufb3c\ufb3d\ufb3e\ufb3f\ufb40-\ufb41\ufb42\ufb43-\ufb44\ufb45\ufb46-\ufb4f",a="\u0608\u060b\u060d\u061b\u061c\u061d\u061e-\u061f\u0620-\u063f\u0640\u0641-\u064a\u066d\u066e-\u066f\u0671-\u06d3\u06d4\u06d5\u06e5-\u06e6\u06ee-\u06ef\u06fa-\u06fc\u06fd-\u06fe\u06ff\u0700-\u070d\u070e\u070f\u0710\u0712-\u072f\u074b-\u074c\u074d-\u07a5\u07b1\u07b2-\u07bf\u08a0-\u08b2\u08b3-\u08e3\ufb50-\ufbb1\ufbb2-\ufbc1\ufbc2-\ufbd2\ufbd3-\ufd3d\ufd40-\ufd4f\ufd50-\ufd8f\ufd90-\ufd91\ufd92-\ufdc7\ufdc8-\ufdcf\ufdf0-\ufdfb\ufdfc\ufdfe-\ufdff\ufe70-\ufe74\ufe75\ufe76-\ufefc\ufefd-\ufefe",s=new RegExp("["+"A-Za-z\xaa\xb5\xba\xc0-\xd6\xd8-\xf6\xf8-\u01ba\u01bb\u01bc-\u01bf\u01c0-\u01c3\u01c4-\u0293\u0294\u0295-\u02af\u02b0-\u02b8\u02bb-\u02c1\u02d0-\u02d1\u02e0-\u02e4\u02ee\u0370-\u0373\u0376-\u0377\u037a\u037b-\u037d\u037f\u0386\u0388-\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u0482\u048a-\u052f\u0531-\u0556\u0559\u055a-\u055f\u0561-\u0587\u0589\u0903\u0904-\u0939\u093b\u093d\u093e-\u0940\u0949-\u094c\u094e-\u094f\u0950\u0958-\u0961\u0964-\u0965\u0966-\u096f\u0970\u0971\u0972-\u0980\u0982-\u0983\u0985-\u098c\u098f-\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bd\u09be-\u09c0\u09c7-\u09c8\u09cb-\u09cc\u09ce\u09d7\u09dc-\u09dd\u09df-\u09e1\u09e6-\u09ef\u09f0-\u09f1\u09f4-\u09f9\u09fa\u0a03\u0a05-\u0a0a\u0a0f-\u0a10\u0a13-\u0a28\u0a2a-\u0a30\u0a32-\u0a33\u0a35-\u0a36\u0a38-\u0a39\u0a3e-\u0a40\u0a59-\u0a5c\u0a5e\u0a66-\u0a6f\u0a72-\u0a74\u0a83\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2-\u0ab3\u0ab5-\u0ab9\u0abd\u0abe-\u0ac0\u0ac9\u0acb-\u0acc\u0ad0\u0ae0-\u0ae1\u0ae6-\u0aef\u0af0\u0b02-\u0b03\u0b05-\u0b0c\u0b0f-\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32-\u0b33\u0b35-\u0b39\u0b3d\u0b3e\u0b40\u0b47-\u0b48\u0b4b-\u0b4c\u0b57\u0b5c-\u0b5d\u0b5f-\u0b61\u0b66-\u0b6f\u0b70\u0b71\u0b72-\u0b77\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99-\u0b9a\u0b9c\u0b9e-\u0b9f\u0ba3-\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bbe-\u0bbf\u0bc1-\u0bc2\u0bc6-\u0bc8\u0bca-\u0bcc\u0bd0\u0bd7\u0be6-\u0bef\u0bf0-\u0bf2\u0c01-\u0c03\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c39\u0c3d\u0c41-\u0c44\u0c58-\u0c59\u0c60-\u0c61\u0c66-\u0c6f\u0c7f\u0c82-\u0c83\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbd\u0cbe\u0cbf\u0cc0-\u0cc4\u0cc6\u0cc7-\u0cc8\u0cca-\u0ccb\u0cd5-\u0cd6\u0cde\u0ce0-\u0ce1\u0ce6-\u0cef\u0cf1-\u0cf2\u0d02-\u0d03\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d3a\u0d3d\u0d3e-\u0d40\u0d46-\u0d48\u0d4a-\u0d4c\u0d4e\u0d57\u0d60-\u0d61\u0d66-\u0d6f\u0d70-\u0d75\u0d79\u0d7a-\u0d7f\u0d82-\u0d83\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0dcf-\u0dd1\u0dd8-\u0ddf\u0de6-\u0def\u0df2-\u0df3\u0df4\u0e01-\u0e30\u0e32-\u0e33\u0e40-\u0e45\u0e46\u0e4f\u0e50-\u0e59\u0e5a-\u0e5b\u0e81-\u0e82\u0e84\u0e87-\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa-\u0eab\u0ead-\u0eb0\u0eb2-\u0eb3\u0ebd\u0ec0-\u0ec4\u0ec6\u0ed0-\u0ed9\u0edc-\u0edf\u0f00\u0f01-\u0f03\u0f04-\u0f12\u0f13\u0f14\u0f15-\u0f17\u0f1a-\u0f1f\u0f20-\u0f29\u0f2a-\u0f33\u0f34\u0f36\u0f38\u0f3e-\u0f3f\u0f40-\u0f47\u0f49-\u0f6c\u0f7f\u0f85\u0f88-\u0f8c\u0fbe-\u0fc5\u0fc7-\u0fcc\u0fce-\u0fcf\u0fd0-\u0fd4\u0fd5-\u0fd8\u0fd9-\u0fda\u1000-\u102a\u102b-\u102c\u1031\u1038\u103b-\u103c\u103f\u1040-\u1049\u104a-\u104f\u1050-\u1055\u1056-\u1057\u105a-\u105d\u1061\u1062-\u1064\u1065-\u1066\u1067-\u106d\u106e-\u1070\u1075-\u1081\u1083-\u1084\u1087-\u108c\u108e\u108f\u1090-\u1099\u109a-\u109c\u109e-\u109f\u10a0-\u10c5\u10c7\u10cd\u10d0-\u10fa\u10fb\u10fc\u10fd-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u1360-\u1368\u1369-\u137c\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166d-\u166e\u166f-\u167f\u1681-\u169a\u16a0-\u16ea\u16eb-\u16ed\u16ee-\u16f0\u16f1-\u16f8\u1700-\u170c\u170e-\u1711\u1720-\u1731\u1735-\u1736\u1740-\u1751\u1760-\u176c\u176e-\u1770\u1780-\u17b3\u17b6\u17be-\u17c5\u17c7-\u17c8\u17d4-\u17d6\u17d7\u17d8-\u17da\u17dc\u17e0-\u17e9\u1810-\u1819\u1820-\u1842\u1843\u1844-\u1877\u1880-\u18a8\u18aa\u18b0-\u18f5\u1900-\u191e\u1923-\u1926\u1929-\u192b\u1930-\u1931\u1933-\u1938\u1946-\u194f\u1950-\u196d\u1970-\u1974\u1980-\u19ab\u19b0-\u19c0\u19c1-\u19c7\u19c8-\u19c9\u19d0-\u19d9\u19da\u1a00-\u1a16\u1a19-\u1a1a\u1a1e-\u1a1f\u1a20-\u1a54\u1a55\u1a57\u1a61\u1a63-\u1a64\u1a6d-\u1a72\u1a80-\u1a89\u1a90-\u1a99\u1aa0-\u1aa6\u1aa7\u1aa8-\u1aad\u1b04\u1b05-\u1b33\u1b35\u1b3b\u1b3d-\u1b41\u1b43-\u1b44\u1b45-\u1b4b\u1b50-\u1b59\u1b5a-\u1b60\u1b61-\u1b6a\u1b74-\u1b7c\u1b82\u1b83-\u1ba0\u1ba1\u1ba6-\u1ba7\u1baa\u1bae-\u1baf\u1bb0-\u1bb9\u1bba-\u1be5\u1be7\u1bea-\u1bec\u1bee\u1bf2-\u1bf3\u1bfc-\u1bff\u1c00-\u1c23\u1c24-\u1c2b\u1c34-\u1c35\u1c3b-\u1c3f\u1c40-\u1c49\u1c4d-\u1c4f\u1c50-\u1c59\u1c5a-\u1c77\u1c78-\u1c7d\u1c7e-\u1c7f\u1cc0-\u1cc7\u1cd3\u1ce1\u1ce9-\u1cec\u1cee-\u1cf1\u1cf2-\u1cf3\u1cf5-\u1cf6\u1d00-\u1d2b\u1d2c-\u1d6a\u1d6b-\u1d77\u1d78\u1d79-\u1d9a\u1d9b-\u1dbf\u1e00-\u1f15\u1f18-\u1f1d\u1f20-\u1f45\u1f48-\u1f4d\u1f50-\u1f57\u1f59\u1f5b\u1f5d\u1f5f-\u1f7d\u1f80-\u1fb4\u1fb6-\u1fbc\u1fbe\u1fc2-\u1fc4\u1fc6-\u1fcc\u1fd0-\u1fd3\u1fd6-\u1fdb\u1fe0-\u1fec\u1ff2-\u1ff4\u1ff6-\u1ffc\u200e\u2071\u207f\u2090-\u209c\u2102\u2107\u210a-\u2113\u2115\u2119-\u211d\u2124\u2126\u2128\u212a-\u212d\u212f-\u2134\u2135-\u2138\u2139\u213c-\u213f\u2145-\u2149\u214e\u214f\u2160-\u2182\u2183-\u2184\u2185-\u2188\u2336-\u237a\u2395\u249c-\u24e9\u26ac\u2800-\u28ff\u2c00-\u2c2e\u2c30-\u2c5e\u2c60-\u2c7b\u2c7c-\u2c7d\u2c7e-\u2ce4\u2ceb-\u2cee\u2cf2-\u2cf3\u2d00-\u2d25\u2d27\u2d2d\u2d30-\u2d67\u2d6f\u2d70\u2d80-\u2d96\u2da0-\u2da6\u2da8-\u2dae\u2db0-\u2db6\u2db8-\u2dbe\u2dc0-\u2dc6\u2dc8-\u2dce\u2dd0-\u2dd6\u2dd8-\u2dde\u3005\u3006\u3007\u3021-\u3029\u302e-\u302f\u3031-\u3035\u3038-\u303a\u303b\u303c\u3041-\u3096\u309d-\u309e\u309f\u30a1-\u30fa\u30fc-\u30fe\u30ff\u3105-\u312d\u3131-\u318e\u3190-\u3191\u3192-\u3195\u3196-\u319f\u31a0-\u31ba\u31f0-\u31ff\u3200-\u321c\u3220-\u3229\u322a-\u3247\u3248-\u324f\u3260-\u327b\u327f\u3280-\u3289\u328a-\u32b0\u32c0-\u32cb\u32d0-\u32fe\u3300-\u3376\u337b-\u33dd\u33e0-\u33fe\u3400-\u4db5\u4e00-\u9fcc\ua000-\ua014\ua015\ua016-\ua48c\ua4d0-\ua4f7\ua4f8-\ua4fd\ua4fe-\ua4ff\ua500-\ua60b\ua60c\ua610-\ua61f\ua620-\ua629\ua62a-\ua62b\ua640-\ua66d\ua66e\ua680-\ua69b\ua69c-\ua69d\ua6a0-\ua6e5\ua6e6-\ua6ef\ua6f2-\ua6f7\ua722-\ua76f\ua770\ua771-\ua787\ua789-\ua78a\ua78b-\ua78e\ua790-\ua7ad\ua7b0-\ua7b1\ua7f7\ua7f8-\ua7f9\ua7fa\ua7fb-\ua801\ua803-\ua805\ua807-\ua80a\ua80c-\ua822\ua823-\ua824\ua827\ua830-\ua835\ua836-\ua837\ua840-\ua873\ua880-\ua881\ua882-\ua8b3\ua8b4-\ua8c3\ua8ce-\ua8cf\ua8d0-\ua8d9\ua8f2-\ua8f7\ua8f8-\ua8fa\ua8fb\ua900-\ua909\ua90a-\ua925\ua92e-\ua92f\ua930-\ua946\ua952-\ua953\ua95f\ua960-\ua97c\ua983\ua984-\ua9b2\ua9b4-\ua9b5\ua9ba-\ua9bb\ua9bd-\ua9c0\ua9c1-\ua9cd\ua9cf\ua9d0-\ua9d9\ua9de-\ua9df\ua9e0-\ua9e4\ua9e6\ua9e7-\ua9ef\ua9f0-\ua9f9\ua9fa-\ua9fe\uaa00-\uaa28\uaa2f-\uaa30\uaa33-\uaa34\uaa40-\uaa42\uaa44-\uaa4b\uaa4d\uaa50-\uaa59\uaa5c-\uaa5f\uaa60-\uaa6f\uaa70\uaa71-\uaa76\uaa77-\uaa79\uaa7a\uaa7b\uaa7d\uaa7e-\uaaaf\uaab1\uaab5-\uaab6\uaab9-\uaabd\uaac0\uaac2\uaadb-\uaadc\uaadd\uaade-\uaadf\uaae0-\uaaea\uaaeb\uaaee-\uaaef\uaaf0-\uaaf1\uaaf2\uaaf3-\uaaf4\uaaf5\uab01-\uab06\uab09-\uab0e\uab11-\uab16\uab20-\uab26\uab28-\uab2e\uab30-\uab5a\uab5b\uab5c-\uab5f\uab64-\uab65\uabc0-\uabe2\uabe3-\uabe4\uabe6-\uabe7\uabe9-\uabea\uabeb\uabec\uabf0-\uabf9\uac00-\ud7a3\ud7b0-\ud7c6\ud7cb-\ud7fb\ue000-\uf8ff\uf900-\ufa6d\ufa70-\ufad9\ufb00-\ufb06\ufb13-\ufb17\uff21-\uff3a\uff41-\uff5a\uff66-\uff6f\uff70\uff71-\uff9d\uff9e-\uff9f\uffa0-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc"+o+a+"]"),l=new RegExp("["+o+a+"]");function c(e){var t=s.exec(e);return null==t?null:t[0]}function u(e){var t=c(e);return null==t?n.NEUTRAL:l.exec(t)?n.RTL:n.LTR}function h(e,t){if(t=t||n.NEUTRAL,!e.length)return t;var r=u(e);return r===n.NEUTRAL?t:r}function d(e,t){return t||(t=n.getGlobalDir()),n.isStrong(t)||i(!1),h(e,t)}var f={firstStrongChar:c,firstStrongCharDir:u,resolveBlockDir:h,getDirection:d,isDirectionLTR:function(e,t){return d(e,t)===n.LTR},isDirectionRTL:function(e,t){return d(e,t)===n.RTL}};e.exports=f},4669:(e,t,r)=>{"use strict";var n=r(6415),i="LTR",o="RTL",a=null;function s(e){return e===i||e===o}function l(e){return s(e)||n(!1),e===i?"ltr":"rtl"}function c(e){a=e}var u={NEUTRAL:"NEUTRAL",LTR:i,RTL:o,isStrong:s,getHTMLDir:l,getHTMLDirIfDifferent:function(e,t){return s(e)||n(!1),s(t)||n(!1),e===t?null:l(e)},setGlobalDir:c,initGlobalDir:function(){c(i)},getGlobalDir:function(){return a||this.initGlobalDir(),a||n(!1),a}};e.exports=u},88:(e,t,r)=>{"use strict";function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var i=r(5782),o=r(4669),a=r(6415),s=function(){function e(e){n(this,"_defaultDir",void 0),n(this,"_lastDir",void 0),e?o.isStrong(e)||a(!1):e=o.getGlobalDir(),this._defaultDir=e,this.reset()}var t=e.prototype;return t.reset=function(){this._lastDir=this._defaultDir},t.getDirection=function(e){return this._lastDir=i.getDirection(e,this._lastDir),this._lastDir},e}();e.exports=s},4939:(e,t,r)=>{"use strict";var n=r(6415),i=55296,o=57343,a=/[\uD800-\uDFFF]/;function s(e){return i<=e&&e<=o}function l(e){return a.test(e)}function c(e,t){return 1+s(e.charCodeAt(t))}function u(e,t,r){if(t=t||0,r=void 0===r?1/0:r||0,!l(e))return e.substr(t,r);var n=e.length;if(n<=0||t>n||r<=0)return"";var i=0;if(t>0){for(;t>0&&i<n;t--)i+=c(e,i);if(i>=n)return""}else if(t<0){for(i=n;t<0&&0<i;t++)i-=c(e,i-1);i<0&&(i=0)}var o=n;if(r<n)for(o=i;r>0&&o<n;r--)o+=c(e,o);return e.substring(i,o)}var h={getCodePoints:function(e){for(var t=[],r=0;r<e.length;r+=c(e,r))t.push(e.codePointAt(r));return t},getUTF16Length:c,hasSurrogateUnit:l,isCodeUnitInSurrogateRange:s,isSurrogatePair:function(e,t){if(0<=t&&t<e.length||n(!1),t+1===e.length)return!1;var r=e.charCodeAt(t),a=e.charCodeAt(t+1);return i<=r&&r<=56319&&56320<=a&&a<=o},strlen:function(e){if(!l(e))return e.length;for(var t=0,r=0;r<e.length;r+=c(e,r))t++;return t},substring:function(e,t,r){(t=t||0)<0&&(t=0),(r=void 0===r?1/0:r||0)<0&&(r=0);var n=Math.abs(r-t);return u(e,t=t<r?t:r,n)},substr:u};e.exports=h},6143:(e,t,r)=>{"use strict";var n=r(9399),i=r(5754),o=r(7014),a=r(8332);function s(e,t,r,n){if(e===r)return!0;if(!r.startsWith(e))return!1;var o=r.slice(e.length);return!!t&&(o=n?n(o):o,i.contains(o,t))}function l(e){return"Windows"===n.platformName?e.replace(/^\s*NT/,""):e}var c={isBrowser:function(e){return s(n.browserName,n.browserFullVersion,e)},isBrowserArchitecture:function(e){return s(n.browserArchitecture,null,e)},isDevice:function(e){return s(n.deviceName,null,e)},isEngine:function(e){return s(n.engineName,n.engineVersion,e)},isPlatform:function(e){return s(n.platformName,n.platformFullVersion,e,l)},isPlatformArchitecture:function(e){return s(n.platformArchitecture,null,e)}};e.exports=o(c,a)},9399:(e,t,r)=>{"use strict";var n=r(4121),i="Unknown",o={"Mac OS":"Mac OS X"};var a,s=(new n).getResult(),l=function(e){if(!e)return{major:"",minor:""};var t=e.split(".");return{major:t[0],minor:t[1]}}(s.browser.version),c={browserArchitecture:s.cpu.architecture||i,browserFullVersion:s.browser.version||i,browserMinorVersion:l.minor||i,browserName:s.browser.name||i,browserVersion:s.browser.major||i,deviceName:s.device.model||i,engineName:s.engine.name||i,engineVersion:s.engine.version||i,platformArchitecture:s.cpu.architecture||i,platformName:(a=s.os.name,o[a]||a||i),platformVersion:s.os.version||i,platformFullVersion:s.os.version||i};e.exports=c},5754:(e,t,r)=>{"use strict";var n=r(6415),i=/\./,o=/\|\|/,a=/\s+\-\s+/,s=/^(<=|<|=|>=|~>|~|>|)?\s*(.+)/,l=/^(\d*)(.*)/;function c(e,t){var r=e.split(o);return r.length>1?r.some((function(e){return w.contains(e,t)})):function(e,t){var r=e.split(a);if(r.length>0&&r.length<=2||n(!1),1===r.length)return u(r[0],t);var i=r[0],o=r[1];return p(i)&&p(o)||n(!1),u(">="+i,t)&&u("<="+o,t)}(e=r[0].trim(),t)}function u(e,t){if(""===(e=e.trim()))return!0;var r=t.split(i),n=f(e),o=n.modifier,a=n.rangeComponents;switch(o){case"<":return h(r,a);case"<=":return function(e,t){var r=y(e,t);return-1===r||0===r}(r,a);case">=":return d(r,a);case">":return 1===y(r,a);case"~":case"~>":return function(e,t){var r=t.slice(),n=t.slice();n.length>1&&n.pop();var i=n.length-1,o=parseInt(n[i],10);g(o)&&(n[i]=o+1+"");return d(e,r)&&h(e,n)}(r,a);default:return function(e,t){return 0===y(e,t)}(r,a)}}function h(e,t){return-1===y(e,t)}function d(e,t){var r=y(e,t);return 1===r||0===r}function f(e){var t=e.split(i),r=t[0].match(s);return r||n(!1),{modifier:r[1],rangeComponents:[r[2]].concat(t.slice(1))}}function g(e){return!isNaN(e)&&isFinite(e)}function p(e){return!f(e).modifier}function m(e,t){for(var r=e.length;r<t;r++)e[r]="0"}function v(e,t){var r=e.match(l)[1],n=t.match(l)[1],i=parseInt(r,10),o=parseInt(n,10);return g(i)&&g(o)&&i!==o?b(i,o):b(e,t)}function b(e,t){return typeof e!==typeof t&&n(!1),e>t?1:e<t?-1:0}function y(e,t){for(var r=function(e,t){m(e=e.slice(),(t=t.slice()).length);for(var r=0;r<t.length;r++){var n=t[r].match(/^[x*]$/i);if(n&&(t[r]=e[r]="0","*"===n[0]&&r===t.length-1))for(var i=r;i<e.length;i++)e[i]="0"}return m(t,e.length),[e,t]}(e,t),n=r[0],i=r[1],o=0;o<i.length;o++){var a=v(n[o],i[o]);if(a)return a}return 0}var w={contains:function(e,t){return c(e.trim(),t.trim())}};e.exports=w},8167:e=>{"use strict";var t=/-(.)/g;e.exports=function(e){return e.replace(t,(function(e,t){return t.toUpperCase()}))}},3922:(e,t,r)=>{"use strict";var n=r(6620);e.exports=function e(t,r){return!(!t||!r)&&(t===r||!n(t)&&(n(r)?e(t,r.parentNode):"contains"in t?t.contains(r):!!t.compareDocumentPosition&&!!(16&t.compareDocumentPosition(r))))}},475:(e,t,r)=>{"use strict";var n=r(6415);e.exports=function(e){return function(e){return!!e&&("object"==typeof e||"function"==typeof e)&&"length"in e&&!("setInterval"in e)&&"number"!=typeof e.nodeType&&(Array.isArray(e)||"callee"in e||"item"in e)}(e)?Array.isArray(e)?e.slice():function(e){var t=e.length;if((Array.isArray(e)||"object"!==typeof e&&"function"!==typeof e)&&n(!1),"number"!==typeof t&&n(!1),0===t||t-1 in e||n(!1),"function"===typeof e.callee&&n(!1),e.hasOwnProperty)try{return Array.prototype.slice.call(e)}catch(o){}for(var r=Array(t),i=0;i<t;i++)r[i]=e[i];return r}(e):[e]}},7904:e=>{"use strict";function t(e){return e.replace(/\//g,"-")}e.exports=function(e){return"object"==typeof e?Object.keys(e).filter((function(t){return e[t]})).map(t).join(" "):Array.prototype.map.call(arguments,t).join(" ")}},9534:e=>{"use strict";function t(e){return function(){return e}}var r=function(){};r.thatReturns=t,r.thatReturnsFalse=t(!1),r.thatReturnsTrue=t(!0),r.thatReturnsNull=t(null),r.thatReturnsThis=function(){return this},r.thatReturnsArgument=function(e){return e},e.exports=r},5089:e=>{"use strict";e.exports=function(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}},7691:e=>{"use strict";var t="undefined"!==typeof navigator&&navigator.userAgent.indexOf("AppleWebKit")>-1;e.exports=function(e){return(e=e||document).scrollingElement?e.scrollingElement:t||"CSS1Compat"!==e.compatMode?e.body:e.documentElement}},636:(e,t,r)=>{"use strict";var n=r(7709);e.exports=function(e){var t=n(e);return{x:t.left,y:t.top,width:t.right-t.left,height:t.bottom-t.top}}},7709:(e,t,r)=>{"use strict";var n=r(3922);e.exports=function(e){var t=e.ownerDocument.documentElement;if(!("getBoundingClientRect"in e)||!n(t,e))return{left:0,right:0,top:0,bottom:0};var r=e.getBoundingClientRect();return{left:Math.round(r.left)-t.clientLeft,right:Math.round(r.right)-t.clientLeft,top:Math.round(r.top)-t.clientTop,bottom:Math.round(r.bottom)-t.clientTop}}},8349:(e,t,r)=>{"use strict";var n=r(7691),i=r(93);e.exports=function(e){var t=n(e.ownerDocument||e.document);e.Window&&e instanceof e.Window&&(e=t);var r=i(e),o=e===t?e.ownerDocument.documentElement:e,a=e.scrollWidth-o.clientWidth,s=e.scrollHeight-o.clientHeight;return r.x=Math.max(0,Math.min(r.x,a)),r.y=Math.max(0,Math.min(r.y,s)),r}},1075:(e,t,r)=>{"use strict";var n=r(8167),i=r(899);function o(e){return null==e?e:String(e)}e.exports=function(e,t){var r;if(window.getComputedStyle&&(r=window.getComputedStyle(e,null)))return o(r.getPropertyValue(i(t)));if(document.defaultView&&document.defaultView.getComputedStyle){if(r=document.defaultView.getComputedStyle(e,null))return o(r.getPropertyValue(i(t)));if("display"===t)return"none"}return e.currentStyle?o("float"===t?e.currentStyle.cssFloat||e.currentStyle.styleFloat:e.currentStyle[n(t)]):o(e.style&&e.style[n(t)])}},93:e=>{"use strict";e.exports=function(e){return e.Window&&e instanceof e.Window?{x:e.pageXOffset||e.document.documentElement.scrollLeft,y:e.pageYOffset||e.document.documentElement.scrollTop}:{x:e.scrollLeft,y:e.scrollTop}}},5628:e=>{"use strict";function t(){var e;return document.documentElement&&(e=document.documentElement.clientWidth),!e&&document.body&&(e=document.body.clientWidth),e||0}function r(){var e;return document.documentElement&&(e=document.documentElement.clientHeight),!e&&document.body&&(e=document.body.clientHeight),e||0}function n(){return{width:window.innerWidth||t(),height:window.innerHeight||r()}}n.withoutScrollbars=function(){return{width:t(),height:r()}},e.exports=n},899:e=>{"use strict";var t=/([A-Z])/g;e.exports=function(e){return e.replace(t,"-$1").toLowerCase()}},6415:e=>{"use strict";var t=function(e){};e.exports=function(e,r){for(var n=arguments.length,i=new Array(n>2?n-2:0),o=2;o<n;o++)i[o-2]=arguments[o];if(t(r),!e){var a;if(void 0===r)a=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var s=0;(a=new Error(r.replace(/%s/g,(function(){return String(i[s++])})))).name="Invariant Violation"}throw a.framesToPop=1,a}}},4099:e=>{"use strict";e.exports=function(e){var t=(e?e.ownerDocument||e:document).defaultView||window;return!(!e||!("function"===typeof t.Node?e instanceof t.Node:"object"===typeof e&&"number"===typeof e.nodeType&&"string"===typeof e.nodeName))}},6620:(e,t,r)=>{"use strict";var n=r(4099);e.exports=function(e){return n(e)&&3==e.nodeType}},947:e=>{"use strict";e.exports=function(e){var t=e||"",r=arguments.length;if(r>1)for(var n=1;n<r;n++){var i=arguments[n];i&&(t=(t?t+" ":"")+i)}return t}},7014:e=>{"use strict";var t=Object.prototype.hasOwnProperty;e.exports=function(e,r,n){if(!e)return null;var i={};for(var o in e)t.call(e,o)&&(i[o]=r.call(n,e[o],o,e));return i}},8332:e=>{"use strict";e.exports=function(e){var t={};return function(r){return t.hasOwnProperty(r)||(t[r]=e.call(this,r)),t[r]}}},8691:e=>{"use strict";e.exports=function(e){if(null!=e)return e;throw new Error("Got unexpected null or undefined")}},9102:(e,t,r)=>{"use strict";r(4132),e.exports=r.g.setImmediate},7443:(e,t,r)=>{"use strict";var n=r(9534);e.exports=n},4453:function(e){e.exports=function(){"use strict";var e=Array.prototype.slice;function t(e,t){t&&(e.prototype=Object.create(t.prototype)),e.prototype.constructor=e}function r(e){return a(e)?e:$(e)}function n(e){return s(e)?e:K(e)}function i(e){return l(e)?e:Y(e)}function o(e){return a(e)&&!c(e)?e:X(e)}function a(e){return!(!e||!e[h])}function s(e){return!(!e||!e[d])}function l(e){return!(!e||!e[f])}function c(e){return s(e)||l(e)}function u(e){return!(!e||!e[g])}t(n,r),t(i,r),t(o,r),r.isIterable=a,r.isKeyed=s,r.isIndexed=l,r.isAssociative=c,r.isOrdered=u,r.Keyed=n,r.Indexed=i,r.Set=o;var h="@@__IMMUTABLE_ITERABLE__@@",d="@@__IMMUTABLE_KEYED__@@",f="@@__IMMUTABLE_INDEXED__@@",g="@@__IMMUTABLE_ORDERED__@@",p="delete",m=5,v=1<<m,b=v-1,y={},w={value:!1},S={value:!1};function C(e){return e.value=!1,e}function k(e){e&&(e.value=!0)}function x(){}function E(e,t){t=t||0;for(var r=Math.max(0,e.length-t),n=new Array(r),i=0;i<r;i++)n[i]=e[i+t];return n}function T(e){return void 0===e.size&&(e.size=e.__iterate(A)),e.size}function _(e,t){if("number"!==typeof t){var r=t>>>0;if(""+r!==t||4294967295===r)return NaN;t=r}return t<0?T(e)+t:t}function A(){return!0}function R(e,t,r){return(0===e||void 0!==r&&e<=-r)&&(void 0===t||void 0!==r&&t>=r)}function O(e,t){return I(e,t,0)}function M(e,t){return I(e,t,t)}function I(e,t,r){return void 0===e?r:e<0?Math.max(0,t+e):void 0===t?e:Math.min(t,e)}var P=0,N=1,D=2,F="function"===typeof Symbol&&Symbol.iterator,L="@@iterator",H=F||L;function B(e){this.next=e}function U(e,t,r,n){var i=0===e?t:1===e?r:[t,r];return n?n.value=i:n={value:i,done:!1},n}function j(){return{value:void 0,done:!0}}function W(e){return!!q(e)}function V(e){return e&&"function"===typeof e.next}function z(e){var t=q(e);return t&&t.call(e)}function q(e){var t=e&&(F&&e[F]||e[L]);if("function"===typeof t)return t}function G(e){return e&&"number"===typeof e.length}function $(e){return null===e||void 0===e?ae():a(e)?e.toSeq():ce(e)}function K(e){return null===e||void 0===e?ae().toKeyedSeq():a(e)?s(e)?e.toSeq():e.fromEntrySeq():se(e)}function Y(e){return null===e||void 0===e?ae():a(e)?s(e)?e.entrySeq():e.toIndexedSeq():le(e)}function X(e){return(null===e||void 0===e?ae():a(e)?s(e)?e.entrySeq():e:le(e)).toSetSeq()}B.prototype.toString=function(){return"[Iterator]"},B.KEYS=P,B.VALUES=N,B.ENTRIES=D,B.prototype.inspect=B.prototype.toSource=function(){return this.toString()},B.prototype[H]=function(){return this},t($,r),$.of=function(){return $(arguments)},$.prototype.toSeq=function(){return this},$.prototype.toString=function(){return this.__toString("Seq {","}")},$.prototype.cacheResult=function(){return!this._cache&&this.__iterateUncached&&(this._cache=this.entrySeq().toArray(),this.size=this._cache.length),this},$.prototype.__iterate=function(e,t){return he(this,e,t,!0)},$.prototype.__iterator=function(e,t){return de(this,e,t,!0)},t(K,$),K.prototype.toKeyedSeq=function(){return this},t(Y,$),Y.of=function(){return Y(arguments)},Y.prototype.toIndexedSeq=function(){return this},Y.prototype.toString=function(){return this.__toString("Seq [","]")},Y.prototype.__iterate=function(e,t){return he(this,e,t,!1)},Y.prototype.__iterator=function(e,t){return de(this,e,t,!1)},t(X,$),X.of=function(){return X(arguments)},X.prototype.toSetSeq=function(){return this},$.isSeq=oe,$.Keyed=K,$.Set=X,$.Indexed=Y;var J,Z,Q,ee="@@__IMMUTABLE_SEQ__@@";function te(e){this._array=e,this.size=e.length}function re(e){var t=Object.keys(e);this._object=e,this._keys=t,this.size=t.length}function ne(e){this._iterable=e,this.size=e.length||e.size}function ie(e){this._iterator=e,this._iteratorCache=[]}function oe(e){return!(!e||!e[ee])}function ae(){return J||(J=new te([]))}function se(e){var t=Array.isArray(e)?new te(e).fromEntrySeq():V(e)?new ie(e).fromEntrySeq():W(e)?new ne(e).fromEntrySeq():"object"===typeof e?new re(e):void 0;if(!t)throw new TypeError("Expected Array or iterable object of [k, v] entries, or keyed object: "+e);return t}function le(e){var t=ue(e);if(!t)throw new TypeError("Expected Array or iterable object of values: "+e);return t}function ce(e){var t=ue(e)||"object"===typeof e&&new re(e);if(!t)throw new TypeError("Expected Array or iterable object of values, or keyed object: "+e);return t}function ue(e){return G(e)?new te(e):V(e)?new ie(e):W(e)?new ne(e):void 0}function he(e,t,r,n){var i=e._cache;if(i){for(var o=i.length-1,a=0;a<=o;a++){var s=i[r?o-a:a];if(!1===t(s[1],n?s[0]:a,e))return a+1}return a}return e.__iterateUncached(t,r)}function de(e,t,r,n){var i=e._cache;if(i){var o=i.length-1,a=0;return new B((function(){var e=i[r?o-a:a];return a++>o?j():U(t,n?e[0]:a-1,e[1])}))}return e.__iteratorUncached(t,r)}function fe(e,t){return t?ge(t,e,"",{"":e}):pe(e)}function ge(e,t,r,n){return Array.isArray(t)?e.call(n,r,Y(t).map((function(r,n){return ge(e,r,n,t)}))):me(t)?e.call(n,r,K(t).map((function(r,n){return ge(e,r,n,t)}))):t}function pe(e){return Array.isArray(e)?Y(e).map(pe).toList():me(e)?K(e).map(pe).toMap():e}function me(e){return e&&(e.constructor===Object||void 0===e.constructor)}function ve(e,t){if(e===t||e!==e&&t!==t)return!0;if(!e||!t)return!1;if("function"===typeof e.valueOf&&"function"===typeof t.valueOf){if((e=e.valueOf())===(t=t.valueOf())||e!==e&&t!==t)return!0;if(!e||!t)return!1}return!("function"!==typeof e.equals||"function"!==typeof t.equals||!e.equals(t))}function be(e,t){if(e===t)return!0;if(!a(t)||void 0!==e.size&&void 0!==t.size&&e.size!==t.size||void 0!==e.__hash&&void 0!==t.__hash&&e.__hash!==t.__hash||s(e)!==s(t)||l(e)!==l(t)||u(e)!==u(t))return!1;if(0===e.size&&0===t.size)return!0;var r=!c(e);if(u(e)){var n=e.entries();return t.every((function(e,t){var i=n.next().value;return i&&ve(i[1],e)&&(r||ve(i[0],t))}))&&n.next().done}var i=!1;if(void 0===e.size)if(void 0===t.size)"function"===typeof e.cacheResult&&e.cacheResult();else{i=!0;var o=e;e=t,t=o}var h=!0,d=t.__iterate((function(t,n){if(r?!e.has(t):i?!ve(t,e.get(n,y)):!ve(e.get(n,y),t))return h=!1,!1}));return h&&e.size===d}function ye(e,t){if(!(this instanceof ye))return new ye(e,t);if(this._value=e,this.size=void 0===t?1/0:Math.max(0,t),0===this.size){if(Z)return Z;Z=this}}function we(e,t){if(!e)throw new Error(t)}function Se(e,t,r){if(!(this instanceof Se))return new Se(e,t,r);if(we(0!==r,"Cannot step a Range by 0"),e=e||0,void 0===t&&(t=1/0),r=void 0===r?1:Math.abs(r),t<e&&(r=-r),this._start=e,this._end=t,this._step=r,this.size=Math.max(0,Math.ceil((t-e)/r-1)+1),0===this.size){if(Q)return Q;Q=this}}function Ce(){throw TypeError("Abstract")}function ke(){}function xe(){}function Ee(){}$.prototype[ee]=!0,t(te,Y),te.prototype.get=function(e,t){return this.has(e)?this._array[_(this,e)]:t},te.prototype.__iterate=function(e,t){for(var r=this._array,n=r.length-1,i=0;i<=n;i++)if(!1===e(r[t?n-i:i],i,this))return i+1;return i},te.prototype.__iterator=function(e,t){var r=this._array,n=r.length-1,i=0;return new B((function(){return i>n?j():U(e,i,r[t?n-i++:i++])}))},t(re,K),re.prototype.get=function(e,t){return void 0===t||this.has(e)?this._object[e]:t},re.prototype.has=function(e){return this._object.hasOwnProperty(e)},re.prototype.__iterate=function(e,t){for(var r=this._object,n=this._keys,i=n.length-1,o=0;o<=i;o++){var a=n[t?i-o:o];if(!1===e(r[a],a,this))return o+1}return o},re.prototype.__iterator=function(e,t){var r=this._object,n=this._keys,i=n.length-1,o=0;return new B((function(){var a=n[t?i-o:o];return o++>i?j():U(e,a,r[a])}))},re.prototype[g]=!0,t(ne,Y),ne.prototype.__iterateUncached=function(e,t){if(t)return this.cacheResult().__iterate(e,t);var r=z(this._iterable),n=0;if(V(r))for(var i;!(i=r.next()).done&&!1!==e(i.value,n++,this););return n},ne.prototype.__iteratorUncached=function(e,t){if(t)return this.cacheResult().__iterator(e,t);var r=z(this._iterable);if(!V(r))return new B(j);var n=0;return new B((function(){var t=r.next();return t.done?t:U(e,n++,t.value)}))},t(ie,Y),ie.prototype.__iterateUncached=function(e,t){if(t)return this.cacheResult().__iterate(e,t);for(var r,n=this._iterator,i=this._iteratorCache,o=0;o<i.length;)if(!1===e(i[o],o++,this))return o;for(;!(r=n.next()).done;){var a=r.value;if(i[o]=a,!1===e(a,o++,this))break}return o},ie.prototype.__iteratorUncached=function(e,t){if(t)return this.cacheResult().__iterator(e,t);var r=this._iterator,n=this._iteratorCache,i=0;return new B((function(){if(i>=n.length){var t=r.next();if(t.done)return t;n[i]=t.value}return U(e,i,n[i++])}))},t(ye,Y),ye.prototype.toString=function(){return 0===this.size?"Repeat []":"Repeat [ "+this._value+" "+this.size+" times ]"},ye.prototype.get=function(e,t){return this.has(e)?this._value:t},ye.prototype.includes=function(e){return ve(this._value,e)},ye.prototype.slice=function(e,t){var r=this.size;return R(e,t,r)?this:new ye(this._value,M(t,r)-O(e,r))},ye.prototype.reverse=function(){return this},ye.prototype.indexOf=function(e){return ve(this._value,e)?0:-1},ye.prototype.lastIndexOf=function(e){return ve(this._value,e)?this.size:-1},ye.prototype.__iterate=function(e,t){for(var r=0;r<this.size;r++)if(!1===e(this._value,r,this))return r+1;return r},ye.prototype.__iterator=function(e,t){var r=this,n=0;return new B((function(){return n<r.size?U(e,n++,r._value):j()}))},ye.prototype.equals=function(e){return e instanceof ye?ve(this._value,e._value):be(e)},t(Se,Y),Se.prototype.toString=function(){return 0===this.size?"Range []":"Range [ "+this._start+"..."+this._end+(this._step>1?" by "+this._step:"")+" ]"},Se.prototype.get=function(e,t){return this.has(e)?this._start+_(this,e)*this._step:t},Se.prototype.includes=function(e){var t=(e-this._start)/this._step;return t>=0&&t<this.size&&t===Math.floor(t)},Se.prototype.slice=function(e,t){return R(e,t,this.size)?this:(e=O(e,this.size),(t=M(t,this.size))<=e?new Se(0,0):new Se(this.get(e,this._end),this.get(t,this._end),this._step))},Se.prototype.indexOf=function(e){var t=e-this._start;if(t%this._step===0){var r=t/this._step;if(r>=0&&r<this.size)return r}return-1},Se.prototype.lastIndexOf=function(e){return this.indexOf(e)},Se.prototype.__iterate=function(e,t){for(var r=this.size-1,n=this._step,i=t?this._start+r*n:this._start,o=0;o<=r;o++){if(!1===e(i,o,this))return o+1;i+=t?-n:n}return o},Se.prototype.__iterator=function(e,t){var r=this.size-1,n=this._step,i=t?this._start+r*n:this._start,o=0;return new B((function(){var a=i;return i+=t?-n:n,o>r?j():U(e,o++,a)}))},Se.prototype.equals=function(e){return e instanceof Se?this._start===e._start&&this._end===e._end&&this._step===e._step:be(this,e)},t(Ce,r),t(ke,Ce),t(xe,Ce),t(Ee,Ce),Ce.Keyed=ke,Ce.Indexed=xe,Ce.Set=Ee;var Te="function"===typeof Math.imul&&-2===Math.imul(4294967295,2)?Math.imul:function(e,t){var r=65535&(e|=0),n=65535&(t|=0);return r*n+((e>>>16)*n+r*(t>>>16)<<16>>>0)|0};function _e(e){return e>>>1&1073741824|3221225471&e}function Ae(e){if(!1===e||null===e||void 0===e)return 0;if("function"===typeof e.valueOf&&(!1===(e=e.valueOf())||null===e||void 0===e))return 0;if(!0===e)return 1;var t=typeof e;if("number"===t){var r=0|e;for(r!==e&&(r^=4294967295*e);e>4294967295;)r^=e/=4294967295;return _e(r)}if("string"===t)return e.length>Be?Re(e):Oe(e);if("function"===typeof e.hashCode)return e.hashCode();if("object"===t)return Me(e);if("function"===typeof e.toString)return Oe(e.toString());throw new Error("Value type "+t+" cannot be hashed.")}function Re(e){var t=We[e];return void 0===t&&(t=Oe(e),je===Ue&&(je=0,We={}),je++,We[e]=t),t}function Oe(e){for(var t=0,r=0;r<e.length;r++)t=31*t+e.charCodeAt(r)|0;return _e(t)}function Me(e){var t;if(Fe&&void 0!==(t=De.get(e)))return t;if(void 0!==(t=e[He]))return t;if(!Pe){if(void 0!==(t=e.propertyIsEnumerable&&e.propertyIsEnumerable[He]))return t;if(void 0!==(t=Ne(e)))return t}if(t=++Le,1073741824&Le&&(Le=0),Fe)De.set(e,t);else{if(void 0!==Ie&&!1===Ie(e))throw new Error("Non-extensible objects are not allowed as keys.");if(Pe)Object.defineProperty(e,He,{enumerable:!1,configurable:!1,writable:!1,value:t});else if(void 0!==e.propertyIsEnumerable&&e.propertyIsEnumerable===e.constructor.prototype.propertyIsEnumerable)e.propertyIsEnumerable=function(){return this.constructor.prototype.propertyIsEnumerable.apply(this,arguments)},e.propertyIsEnumerable[He]=t;else{if(void 0===e.nodeType)throw new Error("Unable to set a non-enumerable property on object.");e[He]=t}}return t}var Ie=Object.isExtensible,Pe=function(){try{return Object.defineProperty({},"@",{}),!0}catch(e){return!1}}();function Ne(e){if(e&&e.nodeType>0)switch(e.nodeType){case 1:return e.uniqueID;case 9:return e.documentElement&&e.documentElement.uniqueID}}var De,Fe="function"===typeof WeakMap;Fe&&(De=new WeakMap);var Le=0,He="__immutablehash__";"function"===typeof Symbol&&(He=Symbol(He));var Be=16,Ue=255,je=0,We={};function Ve(e){we(e!==1/0,"Cannot perform this action with an infinite size.")}function ze(e){return null===e||void 0===e?it():qe(e)&&!u(e)?e:it().withMutations((function(t){var r=n(e);Ve(r.size),r.forEach((function(e,r){return t.set(r,e)}))}))}function qe(e){return!(!e||!e[$e])}t(ze,ke),ze.prototype.toString=function(){return this.__toString("Map {","}")},ze.prototype.get=function(e,t){return this._root?this._root.get(0,void 0,e,t):t},ze.prototype.set=function(e,t){return ot(this,e,t)},ze.prototype.setIn=function(e,t){return this.updateIn(e,y,(function(){return t}))},ze.prototype.remove=function(e){return ot(this,e,y)},ze.prototype.deleteIn=function(e){return this.updateIn(e,(function(){return y}))},ze.prototype.update=function(e,t,r){return 1===arguments.length?e(this):this.updateIn([e],t,r)},ze.prototype.updateIn=function(e,t,r){r||(r=t,t=void 0);var n=mt(this,Sr(e),t,r);return n===y?void 0:n},ze.prototype.clear=function(){return 0===this.size?this:this.__ownerID?(this.size=0,this._root=null,this.__hash=void 0,this.__altered=!0,this):it()},ze.prototype.merge=function(){return dt(this,void 0,arguments)},ze.prototype.mergeWith=function(t){return dt(this,t,e.call(arguments,1))},ze.prototype.mergeIn=function(t){var r=e.call(arguments,1);return this.updateIn(t,it(),(function(e){return"function"===typeof e.merge?e.merge.apply(e,r):r[r.length-1]}))},ze.prototype.mergeDeep=function(){return dt(this,ft,arguments)},ze.prototype.mergeDeepWith=function(t){var r=e.call(arguments,1);return dt(this,gt(t),r)},ze.prototype.mergeDeepIn=function(t){var r=e.call(arguments,1);return this.updateIn(t,it(),(function(e){return"function"===typeof e.mergeDeep?e.mergeDeep.apply(e,r):r[r.length-1]}))},ze.prototype.sort=function(e){return Wt(ur(this,e))},ze.prototype.sortBy=function(e,t){return Wt(ur(this,t,e))},ze.prototype.withMutations=function(e){var t=this.asMutable();return e(t),t.wasAltered()?t.__ensureOwner(this.__ownerID):this},ze.prototype.asMutable=function(){return this.__ownerID?this:this.__ensureOwner(new x)},ze.prototype.asImmutable=function(){return this.__ensureOwner()},ze.prototype.wasAltered=function(){return this.__altered},ze.prototype.__iterator=function(e,t){return new et(this,e,t)},ze.prototype.__iterate=function(e,t){var r=this,n=0;return this._root&&this._root.iterate((function(t){return n++,e(t[1],t[0],r)}),t),n},ze.prototype.__ensureOwner=function(e){return e===this.__ownerID?this:e?nt(this.size,this._root,e,this.__hash):(this.__ownerID=e,this.__altered=!1,this)},ze.isMap=qe;var Ge,$e="@@__IMMUTABLE_MAP__@@",Ke=ze.prototype;function Ye(e,t){this.ownerID=e,this.entries=t}function Xe(e,t,r){this.ownerID=e,this.bitmap=t,this.nodes=r}function Je(e,t,r){this.ownerID=e,this.count=t,this.nodes=r}function Ze(e,t,r){this.ownerID=e,this.keyHash=t,this.entries=r}function Qe(e,t,r){this.ownerID=e,this.keyHash=t,this.entry=r}function et(e,t,r){this._type=t,this._reverse=r,this._stack=e._root&&rt(e._root)}function tt(e,t){return U(e,t[0],t[1])}function rt(e,t){return{node:e,index:0,__prev:t}}function nt(e,t,r,n){var i=Object.create(Ke);return i.size=e,i._root=t,i.__ownerID=r,i.__hash=n,i.__altered=!1,i}function it(){return Ge||(Ge=nt(0))}function ot(e,t,r){var n,i;if(e._root){var o=C(w),a=C(S);if(n=at(e._root,e.__ownerID,0,void 0,t,r,o,a),!a.value)return e;i=e.size+(o.value?r===y?-1:1:0)}else{if(r===y)return e;i=1,n=new Ye(e.__ownerID,[[t,r]])}return e.__ownerID?(e.size=i,e._root=n,e.__hash=void 0,e.__altered=!0,e):n?nt(i,n):it()}function at(e,t,r,n,i,o,a,s){return e?e.update(t,r,n,i,o,a,s):o===y?e:(k(s),k(a),new Qe(t,n,[i,o]))}function st(e){return e.constructor===Qe||e.constructor===Ze}function lt(e,t,r,n,i){if(e.keyHash===n)return new Ze(t,n,[e.entry,i]);var o,a=(0===r?e.keyHash:e.keyHash>>>r)&b,s=(0===r?n:n>>>r)&b;return new Xe(t,1<<a|1<<s,a===s?[lt(e,t,r+m,n,i)]:(o=new Qe(t,n,i),a<s?[e,o]:[o,e]))}function ct(e,t,r,n){e||(e=new x);for(var i=new Qe(e,Ae(r),[r,n]),o=0;o<t.length;o++){var a=t[o];i=i.update(e,0,void 0,a[0],a[1])}return i}function ut(e,t,r,n){for(var i=0,o=0,a=new Array(r),s=0,l=1,c=t.length;s<c;s++,l<<=1){var u=t[s];void 0!==u&&s!==n&&(i|=l,a[o++]=u)}return new Xe(e,i,a)}function ht(e,t,r,n,i){for(var o=0,a=new Array(v),s=0;0!==r;s++,r>>>=1)a[s]=1&r?t[o++]:void 0;return a[n]=i,new Je(e,o+1,a)}function dt(e,t,r){for(var i=[],o=0;o<r.length;o++){var s=r[o],l=n(s);a(s)||(l=l.map((function(e){return fe(e)}))),i.push(l)}return pt(e,t,i)}function ft(e,t,r){return e&&e.mergeDeep&&a(t)?e.mergeDeep(t):ve(e,t)?e:t}function gt(e){return function(t,r,n){if(t&&t.mergeDeepWith&&a(r))return t.mergeDeepWith(e,r);var i=e(t,r,n);return ve(t,i)?t:i}}function pt(e,t,r){return 0===(r=r.filter((function(e){return 0!==e.size}))).length?e:0!==e.size||e.__ownerID||1!==r.length?e.withMutations((function(e){for(var n=t?function(r,n){e.update(n,y,(function(e){return e===y?r:t(e,r,n)}))}:function(t,r){e.set(r,t)},i=0;i<r.length;i++)r[i].forEach(n)})):e.constructor(r[0])}function mt(e,t,r,n){var i=e===y,o=t.next();if(o.done){var a=i?r:e,s=n(a);return s===a?e:s}we(i||e&&e.set,"invalid keyPath");var l=o.value,c=i?y:e.get(l,y),u=mt(c,t,r,n);return u===c?e:u===y?e.remove(l):(i?it():e).set(l,u)}function vt(e){return e=(e=(858993459&(e-=e>>1&1431655765))+(e>>2&858993459))+(e>>4)&252645135,e+=e>>8,127&(e+=e>>16)}function bt(e,t,r,n){var i=n?e:E(e);return i[t]=r,i}function yt(e,t,r,n){var i=e.length+1;if(n&&t+1===i)return e[t]=r,e;for(var o=new Array(i),a=0,s=0;s<i;s++)s===t?(o[s]=r,a=-1):o[s]=e[s+a];return o}function wt(e,t,r){var n=e.length-1;if(r&&t===n)return e.pop(),e;for(var i=new Array(n),o=0,a=0;a<n;a++)a===t&&(o=1),i[a]=e[a+o];return i}Ke[$e]=!0,Ke[p]=Ke.remove,Ke.removeIn=Ke.deleteIn,Ye.prototype.get=function(e,t,r,n){for(var i=this.entries,o=0,a=i.length;o<a;o++)if(ve(r,i[o][0]))return i[o][1];return n},Ye.prototype.update=function(e,t,r,n,i,o,a){for(var s=i===y,l=this.entries,c=0,u=l.length;c<u&&!ve(n,l[c][0]);c++);var h=c<u;if(h?l[c][1]===i:s)return this;if(k(a),(s||!h)&&k(o),!s||1!==l.length){if(!h&&!s&&l.length>=St)return ct(e,l,n,i);var d=e&&e===this.ownerID,f=d?l:E(l);return h?s?c===u-1?f.pop():f[c]=f.pop():f[c]=[n,i]:f.push([n,i]),d?(this.entries=f,this):new Ye(e,f)}},Xe.prototype.get=function(e,t,r,n){void 0===t&&(t=Ae(r));var i=1<<((0===e?t:t>>>e)&b),o=this.bitmap;return 0===(o&i)?n:this.nodes[vt(o&i-1)].get(e+m,t,r,n)},Xe.prototype.update=function(e,t,r,n,i,o,a){void 0===r&&(r=Ae(n));var s=(0===t?r:r>>>t)&b,l=1<<s,c=this.bitmap,u=0!==(c&l);if(!u&&i===y)return this;var h=vt(c&l-1),d=this.nodes,f=u?d[h]:void 0,g=at(f,e,t+m,r,n,i,o,a);if(g===f)return this;if(!u&&g&&d.length>=Ct)return ht(e,d,c,s,g);if(u&&!g&&2===d.length&&st(d[1^h]))return d[1^h];if(u&&g&&1===d.length&&st(g))return g;var p=e&&e===this.ownerID,v=u?g?c:c^l:c|l,w=u?g?bt(d,h,g,p):wt(d,h,p):yt(d,h,g,p);return p?(this.bitmap=v,this.nodes=w,this):new Xe(e,v,w)},Je.prototype.get=function(e,t,r,n){void 0===t&&(t=Ae(r));var i=(0===e?t:t>>>e)&b,o=this.nodes[i];return o?o.get(e+m,t,r,n):n},Je.prototype.update=function(e,t,r,n,i,o,a){void 0===r&&(r=Ae(n));var s=(0===t?r:r>>>t)&b,l=i===y,c=this.nodes,u=c[s];if(l&&!u)return this;var h=at(u,e,t+m,r,n,i,o,a);if(h===u)return this;var d=this.count;if(u){if(!h&&--d<kt)return ut(e,c,d,s)}else d++;var f=e&&e===this.ownerID,g=bt(c,s,h,f);return f?(this.count=d,this.nodes=g,this):new Je(e,d,g)},Ze.prototype.get=function(e,t,r,n){for(var i=this.entries,o=0,a=i.length;o<a;o++)if(ve(r,i[o][0]))return i[o][1];return n},Ze.prototype.update=function(e,t,r,n,i,o,a){void 0===r&&(r=Ae(n));var s=i===y;if(r!==this.keyHash)return s?this:(k(a),k(o),lt(this,e,t,r,[n,i]));for(var l=this.entries,c=0,u=l.length;c<u&&!ve(n,l[c][0]);c++);var h=c<u;if(h?l[c][1]===i:s)return this;if(k(a),(s||!h)&&k(o),s&&2===u)return new Qe(e,this.keyHash,l[1^c]);var d=e&&e===this.ownerID,f=d?l:E(l);return h?s?c===u-1?f.pop():f[c]=f.pop():f[c]=[n,i]:f.push([n,i]),d?(this.entries=f,this):new Ze(e,this.keyHash,f)},Qe.prototype.get=function(e,t,r,n){return ve(r,this.entry[0])?this.entry[1]:n},Qe.prototype.update=function(e,t,r,n,i,o,a){var s=i===y,l=ve(n,this.entry[0]);return(l?i===this.entry[1]:s)?this:(k(a),s?void k(o):l?e&&e===this.ownerID?(this.entry[1]=i,this):new Qe(e,this.keyHash,[n,i]):(k(o),lt(this,e,t,Ae(n),[n,i])))},Ye.prototype.iterate=Ze.prototype.iterate=function(e,t){for(var r=this.entries,n=0,i=r.length-1;n<=i;n++)if(!1===e(r[t?i-n:n]))return!1},Xe.prototype.iterate=Je.prototype.iterate=function(e,t){for(var r=this.nodes,n=0,i=r.length-1;n<=i;n++){var o=r[t?i-n:n];if(o&&!1===o.iterate(e,t))return!1}},Qe.prototype.iterate=function(e,t){return e(this.entry)},t(et,B),et.prototype.next=function(){for(var e=this._type,t=this._stack;t;){var r,n=t.node,i=t.index++;if(n.entry){if(0===i)return tt(e,n.entry)}else if(n.entries){if(i<=(r=n.entries.length-1))return tt(e,n.entries[this._reverse?r-i:i])}else if(i<=(r=n.nodes.length-1)){var o=n.nodes[this._reverse?r-i:i];if(o){if(o.entry)return tt(e,o.entry);t=this._stack=rt(o,t)}continue}t=this._stack=this._stack.__prev}return j()};var St=v/4,Ct=v/2,kt=v/4;function xt(e){var t=Nt();if(null===e||void 0===e)return t;if(Et(e))return e;var r=i(e),n=r.size;return 0===n?t:(Ve(n),n>0&&n<v?Pt(0,n,m,null,new At(r.toArray())):t.withMutations((function(e){e.setSize(n),r.forEach((function(t,r){return e.set(r,t)}))})))}function Et(e){return!(!e||!e[Tt])}t(xt,xe),xt.of=function(){return this(arguments)},xt.prototype.toString=function(){return this.__toString("List [","]")},xt.prototype.get=function(e,t){if((e=_(this,e))>=0&&e<this.size){var r=Ht(this,e+=this._origin);return r&&r.array[e&b]}return t},xt.prototype.set=function(e,t){return Dt(this,e,t)},xt.prototype.remove=function(e){return this.has(e)?0===e?this.shift():e===this.size-1?this.pop():this.splice(e,1):this},xt.prototype.insert=function(e,t){return this.splice(e,0,t)},xt.prototype.clear=function(){return 0===this.size?this:this.__ownerID?(this.size=this._origin=this._capacity=0,this._level=m,this._root=this._tail=null,this.__hash=void 0,this.__altered=!0,this):Nt()},xt.prototype.push=function(){var e=arguments,t=this.size;return this.withMutations((function(r){Bt(r,0,t+e.length);for(var n=0;n<e.length;n++)r.set(t+n,e[n])}))},xt.prototype.pop=function(){return Bt(this,0,-1)},xt.prototype.unshift=function(){var e=arguments;return this.withMutations((function(t){Bt(t,-e.length);for(var r=0;r<e.length;r++)t.set(r,e[r])}))},xt.prototype.shift=function(){return Bt(this,1)},xt.prototype.merge=function(){return Ut(this,void 0,arguments)},xt.prototype.mergeWith=function(t){return Ut(this,t,e.call(arguments,1))},xt.prototype.mergeDeep=function(){return Ut(this,ft,arguments)},xt.prototype.mergeDeepWith=function(t){var r=e.call(arguments,1);return Ut(this,gt(t),r)},xt.prototype.setSize=function(e){return Bt(this,0,e)},xt.prototype.slice=function(e,t){var r=this.size;return R(e,t,r)?this:Bt(this,O(e,r),M(t,r))},xt.prototype.__iterator=function(e,t){var r=0,n=It(this,t);return new B((function(){var t=n();return t===Mt?j():U(e,r++,t)}))},xt.prototype.__iterate=function(e,t){for(var r,n=0,i=It(this,t);(r=i())!==Mt&&!1!==e(r,n++,this););return n},xt.prototype.__ensureOwner=function(e){return e===this.__ownerID?this:e?Pt(this._origin,this._capacity,this._level,this._root,this._tail,e,this.__hash):(this.__ownerID=e,this)},xt.isList=Et;var Tt="@@__IMMUTABLE_LIST__@@",_t=xt.prototype;function At(e,t){this.array=e,this.ownerID=t}_t[Tt]=!0,_t[p]=_t.remove,_t.setIn=Ke.setIn,_t.deleteIn=_t.removeIn=Ke.removeIn,_t.update=Ke.update,_t.updateIn=Ke.updateIn,_t.mergeIn=Ke.mergeIn,_t.mergeDeepIn=Ke.mergeDeepIn,_t.withMutations=Ke.withMutations,_t.asMutable=Ke.asMutable,_t.asImmutable=Ke.asImmutable,_t.wasAltered=Ke.wasAltered,At.prototype.removeBefore=function(e,t,r){if(r===t?1<<t:0===this.array.length)return this;var n=r>>>t&b;if(n>=this.array.length)return new At([],e);var i,o=0===n;if(t>0){var a=this.array[n];if((i=a&&a.removeBefore(e,t-m,r))===a&&o)return this}if(o&&!i)return this;var s=Lt(this,e);if(!o)for(var l=0;l<n;l++)s.array[l]=void 0;return i&&(s.array[n]=i),s},At.prototype.removeAfter=function(e,t,r){if(r===(t?1<<t:0)||0===this.array.length)return this;var n,i=r-1>>>t&b;if(i>=this.array.length)return this;if(t>0){var o=this.array[i];if((n=o&&o.removeAfter(e,t-m,r))===o&&i===this.array.length-1)return this}var a=Lt(this,e);return a.array.splice(i+1),n&&(a.array[i]=n),a};var Rt,Ot,Mt={};function It(e,t){var r=e._origin,n=e._capacity,i=jt(n),o=e._tail;return a(e._root,e._level,0);function a(e,t,r){return 0===t?s(e,r):l(e,t,r)}function s(e,a){var s=a===i?o&&o.array:e&&e.array,l=a>r?0:r-a,c=n-a;return c>v&&(c=v),function(){if(l===c)return Mt;var e=t?--c:l++;return s&&s[e]}}function l(e,i,o){var s,l=e&&e.array,c=o>r?0:r-o>>i,u=1+(n-o>>i);return u>v&&(u=v),function(){for(;;){if(s){var e=s();if(e!==Mt)return e;s=null}if(c===u)return Mt;var r=t?--u:c++;s=a(l&&l[r],i-m,o+(r<<i))}}}}function Pt(e,t,r,n,i,o,a){var s=Object.create(_t);return s.size=t-e,s._origin=e,s._capacity=t,s._level=r,s._root=n,s._tail=i,s.__ownerID=o,s.__hash=a,s.__altered=!1,s}function Nt(){return Rt||(Rt=Pt(0,0,m))}function Dt(e,t,r){if((t=_(e,t))!==t)return e;if(t>=e.size||t<0)return e.withMutations((function(e){t<0?Bt(e,t).set(0,r):Bt(e,0,t+1).set(t,r)}));t+=e._origin;var n=e._tail,i=e._root,o=C(S);return t>=jt(e._capacity)?n=Ft(n,e.__ownerID,0,t,r,o):i=Ft(i,e.__ownerID,e._level,t,r,o),o.value?e.__ownerID?(e._root=i,e._tail=n,e.__hash=void 0,e.__altered=!0,e):Pt(e._origin,e._capacity,e._level,i,n):e}function Ft(e,t,r,n,i,o){var a,s=n>>>r&b,l=e&&s<e.array.length;if(!l&&void 0===i)return e;if(r>0){var c=e&&e.array[s],u=Ft(c,t,r-m,n,i,o);return u===c?e:((a=Lt(e,t)).array[s]=u,a)}return l&&e.array[s]===i?e:(k(o),a=Lt(e,t),void 0===i&&s===a.array.length-1?a.array.pop():a.array[s]=i,a)}function Lt(e,t){return t&&e&&t===e.ownerID?e:new At(e?e.array.slice():[],t)}function Ht(e,t){if(t>=jt(e._capacity))return e._tail;if(t<1<<e._level+m){for(var r=e._root,n=e._level;r&&n>0;)r=r.array[t>>>n&b],n-=m;return r}}function Bt(e,t,r){void 0!==t&&(t|=0),void 0!==r&&(r|=0);var n=e.__ownerID||new x,i=e._origin,o=e._capacity,a=i+t,s=void 0===r?o:r<0?o+r:i+r;if(a===i&&s===o)return e;if(a>=s)return e.clear();for(var l=e._level,c=e._root,u=0;a+u<0;)c=new At(c&&c.array.length?[void 0,c]:[],n),u+=1<<(l+=m);u&&(a+=u,i+=u,s+=u,o+=u);for(var h=jt(o),d=jt(s);d>=1<<l+m;)c=new At(c&&c.array.length?[c]:[],n),l+=m;var f=e._tail,g=d<h?Ht(e,s-1):d>h?new At([],n):f;if(f&&d>h&&a<o&&f.array.length){for(var p=c=Lt(c,n),v=l;v>m;v-=m){var y=h>>>v&b;p=p.array[y]=Lt(p.array[y],n)}p.array[h>>>m&b]=f}if(s<o&&(g=g&&g.removeAfter(n,0,s)),a>=d)a-=d,s-=d,l=m,c=null,g=g&&g.removeBefore(n,0,a);else if(a>i||d<h){for(u=0;c;){var w=a>>>l&b;if(w!==d>>>l&b)break;w&&(u+=(1<<l)*w),l-=m,c=c.array[w]}c&&a>i&&(c=c.removeBefore(n,l,a-u)),c&&d<h&&(c=c.removeAfter(n,l,d-u)),u&&(a-=u,s-=u)}return e.__ownerID?(e.size=s-a,e._origin=a,e._capacity=s,e._level=l,e._root=c,e._tail=g,e.__hash=void 0,e.__altered=!0,e):Pt(a,s,l,c,g)}function Ut(e,t,r){for(var n=[],o=0,s=0;s<r.length;s++){var l=r[s],c=i(l);c.size>o&&(o=c.size),a(l)||(c=c.map((function(e){return fe(e)}))),n.push(c)}return o>e.size&&(e=e.setSize(o)),pt(e,t,n)}function jt(e){return e<v?0:e-1>>>m<<m}function Wt(e){return null===e||void 0===e?qt():Vt(e)?e:qt().withMutations((function(t){var r=n(e);Ve(r.size),r.forEach((function(e,r){return t.set(r,e)}))}))}function Vt(e){return qe(e)&&u(e)}function zt(e,t,r,n){var i=Object.create(Wt.prototype);return i.size=e?e.size:0,i._map=e,i._list=t,i.__ownerID=r,i.__hash=n,i}function qt(){return Ot||(Ot=zt(it(),Nt()))}function Gt(e,t,r){var n,i,o=e._map,a=e._list,s=o.get(t),l=void 0!==s;if(r===y){if(!l)return e;a.size>=v&&a.size>=2*o.size?(n=(i=a.filter((function(e,t){return void 0!==e&&s!==t}))).toKeyedSeq().map((function(e){return e[0]})).flip().toMap(),e.__ownerID&&(n.__ownerID=i.__ownerID=e.__ownerID)):(n=o.remove(t),i=s===a.size-1?a.pop():a.set(s,void 0))}else if(l){if(r===a.get(s)[1])return e;n=o,i=a.set(s,[t,r])}else n=o.set(t,a.size),i=a.set(a.size,[t,r]);return e.__ownerID?(e.size=n.size,e._map=n,e._list=i,e.__hash=void 0,e):zt(n,i)}function $t(e,t){this._iter=e,this._useKeys=t,this.size=e.size}function Kt(e){this._iter=e,this.size=e.size}function Yt(e){this._iter=e,this.size=e.size}function Xt(e){this._iter=e,this.size=e.size}function Jt(e){var t=br(e);return t._iter=e,t.size=e.size,t.flip=function(){return e},t.reverse=function(){var t=e.reverse.apply(this);return t.flip=function(){return e.reverse()},t},t.has=function(t){return e.includes(t)},t.includes=function(t){return e.has(t)},t.cacheResult=yr,t.__iterateUncached=function(t,r){var n=this;return e.__iterate((function(e,r){return!1!==t(r,e,n)}),r)},t.__iteratorUncached=function(t,r){if(t===D){var n=e.__iterator(t,r);return new B((function(){var e=n.next();if(!e.done){var t=e.value[0];e.value[0]=e.value[1],e.value[1]=t}return e}))}return e.__iterator(t===N?P:N,r)},t}function Zt(e,t,r){var n=br(e);return n.size=e.size,n.has=function(t){return e.has(t)},n.get=function(n,i){var o=e.get(n,y);return o===y?i:t.call(r,o,n,e)},n.__iterateUncached=function(n,i){var o=this;return e.__iterate((function(e,i,a){return!1!==n(t.call(r,e,i,a),i,o)}),i)},n.__iteratorUncached=function(n,i){var o=e.__iterator(D,i);return new B((function(){var i=o.next();if(i.done)return i;var a=i.value,s=a[0];return U(n,s,t.call(r,a[1],s,e),i)}))},n}function Qt(e,t){var r=br(e);return r._iter=e,r.size=e.size,r.reverse=function(){return e},e.flip&&(r.flip=function(){var t=Jt(e);return t.reverse=function(){return e.flip()},t}),r.get=function(r,n){return e.get(t?r:-1-r,n)},r.has=function(r){return e.has(t?r:-1-r)},r.includes=function(t){return e.includes(t)},r.cacheResult=yr,r.__iterate=function(t,r){var n=this;return e.__iterate((function(e,r){return t(e,r,n)}),!r)},r.__iterator=function(t,r){return e.__iterator(t,!r)},r}function er(e,t,r,n){var i=br(e);return n&&(i.has=function(n){var i=e.get(n,y);return i!==y&&!!t.call(r,i,n,e)},i.get=function(n,i){var o=e.get(n,y);return o!==y&&t.call(r,o,n,e)?o:i}),i.__iterateUncached=function(i,o){var a=this,s=0;return e.__iterate((function(e,o,l){if(t.call(r,e,o,l))return s++,i(e,n?o:s-1,a)}),o),s},i.__iteratorUncached=function(i,o){var a=e.__iterator(D,o),s=0;return new B((function(){for(;;){var o=a.next();if(o.done)return o;var l=o.value,c=l[0],u=l[1];if(t.call(r,u,c,e))return U(i,n?c:s++,u,o)}}))},i}function tr(e,t,r){var n=ze().asMutable();return e.__iterate((function(i,o){n.update(t.call(r,i,o,e),0,(function(e){return e+1}))})),n.asImmutable()}function rr(e,t,r){var n=s(e),i=(u(e)?Wt():ze()).asMutable();e.__iterate((function(o,a){i.update(t.call(r,o,a,e),(function(e){return(e=e||[]).push(n?[a,o]:o),e}))}));var o=vr(e);return i.map((function(t){return gr(e,o(t))}))}function nr(e,t,r,n){var i=e.size;if(void 0!==t&&(t|=0),void 0!==r&&(r|=0),R(t,r,i))return e;var o=O(t,i),a=M(r,i);if(o!==o||a!==a)return nr(e.toSeq().cacheResult(),t,r,n);var s,l=a-o;l===l&&(s=l<0?0:l);var c=br(e);return c.size=0===s?s:e.size&&s||void 0,!n&&oe(e)&&s>=0&&(c.get=function(t,r){return(t=_(this,t))>=0&&t<s?e.get(t+o,r):r}),c.__iterateUncached=function(t,r){var i=this;if(0===s)return 0;if(r)return this.cacheResult().__iterate(t,r);var a=0,l=!0,c=0;return e.__iterate((function(e,r){if(!l||!(l=a++<o))return c++,!1!==t(e,n?r:c-1,i)&&c!==s})),c},c.__iteratorUncached=function(t,r){if(0!==s&&r)return this.cacheResult().__iterator(t,r);var i=0!==s&&e.__iterator(t,r),a=0,l=0;return new B((function(){for(;a++<o;)i.next();if(++l>s)return j();var e=i.next();return n||t===N?e:U(t,l-1,t===P?void 0:e.value[1],e)}))},c}function ir(e,t,r){var n=br(e);return n.__iterateUncached=function(n,i){var o=this;if(i)return this.cacheResult().__iterate(n,i);var a=0;return e.__iterate((function(e,i,s){return t.call(r,e,i,s)&&++a&&n(e,i,o)})),a},n.__iteratorUncached=function(n,i){var o=this;if(i)return this.cacheResult().__iterator(n,i);var a=e.__iterator(D,i),s=!0;return new B((function(){if(!s)return j();var e=a.next();if(e.done)return e;var i=e.value,l=i[0],c=i[1];return t.call(r,c,l,o)?n===D?e:U(n,l,c,e):(s=!1,j())}))},n}function or(e,t,r,n){var i=br(e);return i.__iterateUncached=function(i,o){var a=this;if(o)return this.cacheResult().__iterate(i,o);var s=!0,l=0;return e.__iterate((function(e,o,c){if(!s||!(s=t.call(r,e,o,c)))return l++,i(e,n?o:l-1,a)})),l},i.__iteratorUncached=function(i,o){var a=this;if(o)return this.cacheResult().__iterator(i,o);var s=e.__iterator(D,o),l=!0,c=0;return new B((function(){var e,o,u;do{if((e=s.next()).done)return n||i===N?e:U(i,c++,i===P?void 0:e.value[1],e);var h=e.value;o=h[0],u=h[1],l&&(l=t.call(r,u,o,a))}while(l);return i===D?e:U(i,o,u,e)}))},i}function ar(e,t){var r=s(e),i=[e].concat(t).map((function(e){return a(e)?r&&(e=n(e)):e=r?se(e):le(Array.isArray(e)?e:[e]),e})).filter((function(e){return 0!==e.size}));if(0===i.length)return e;if(1===i.length){var o=i[0];if(o===e||r&&s(o)||l(e)&&l(o))return o}var c=new te(i);return r?c=c.toKeyedSeq():l(e)||(c=c.toSetSeq()),(c=c.flatten(!0)).size=i.reduce((function(e,t){if(void 0!==e){var r=t.size;if(void 0!==r)return e+r}}),0),c}function sr(e,t,r){var n=br(e);return n.__iterateUncached=function(n,i){var o=0,s=!1;function l(e,c){var u=this;e.__iterate((function(e,i){return(!t||c<t)&&a(e)?l(e,c+1):!1===n(e,r?i:o++,u)&&(s=!0),!s}),i)}return l(e,0),o},n.__iteratorUncached=function(n,i){var o=e.__iterator(n,i),s=[],l=0;return new B((function(){for(;o;){var e=o.next();if(!1===e.done){var c=e.value;if(n===D&&(c=c[1]),t&&!(s.length<t)||!a(c))return r?e:U(n,l++,c,e);s.push(o),o=c.__iterator(n,i)}else o=s.pop()}return j()}))},n}function lr(e,t,r){var n=vr(e);return e.toSeq().map((function(i,o){return n(t.call(r,i,o,e))})).flatten(!0)}function cr(e,t){var r=br(e);return r.size=e.size&&2*e.size-1,r.__iterateUncached=function(r,n){var i=this,o=0;return e.__iterate((function(e,n){return(!o||!1!==r(t,o++,i))&&!1!==r(e,o++,i)}),n),o},r.__iteratorUncached=function(r,n){var i,o=e.__iterator(N,n),a=0;return new B((function(){return(!i||a%2)&&(i=o.next()).done?i:a%2?U(r,a++,t):U(r,a++,i.value,i)}))},r}function ur(e,t,r){t||(t=wr);var n=s(e),i=0,o=e.toSeq().map((function(t,n){return[n,t,i++,r?r(t,n,e):t]})).toArray();return o.sort((function(e,r){return t(e[3],r[3])||e[2]-r[2]})).forEach(n?function(e,t){o[t].length=2}:function(e,t){o[t]=e[1]}),n?K(o):l(e)?Y(o):X(o)}function hr(e,t,r){if(t||(t=wr),r){var n=e.toSeq().map((function(t,n){return[t,r(t,n,e)]})).reduce((function(e,r){return dr(t,e[1],r[1])?r:e}));return n&&n[0]}return e.reduce((function(e,r){return dr(t,e,r)?r:e}))}function dr(e,t,r){var n=e(r,t);return 0===n&&r!==t&&(void 0===r||null===r||r!==r)||n>0}function fr(e,t,n){var i=br(e);return i.size=new te(n).map((function(e){return e.size})).min(),i.__iterate=function(e,t){for(var r,n=this.__iterator(N,t),i=0;!(r=n.next()).done&&!1!==e(r.value,i++,this););return i},i.__iteratorUncached=function(e,i){var o=n.map((function(e){return e=r(e),z(i?e.reverse():e)})),a=0,s=!1;return new B((function(){var r;return s||(r=o.map((function(e){return e.next()})),s=r.some((function(e){return e.done}))),s?j():U(e,a++,t.apply(null,r.map((function(e){return e.value}))))}))},i}function gr(e,t){return oe(e)?t:e.constructor(t)}function pr(e){if(e!==Object(e))throw new TypeError("Expected [K, V] tuple: "+e)}function mr(e){return Ve(e.size),T(e)}function vr(e){return s(e)?n:l(e)?i:o}function br(e){return Object.create((s(e)?K:l(e)?Y:X).prototype)}function yr(){return this._iter.cacheResult?(this._iter.cacheResult(),this.size=this._iter.size,this):$.prototype.cacheResult.call(this)}function wr(e,t){return e>t?1:e<t?-1:0}function Sr(e){var t=z(e);if(!t){if(!G(e))throw new TypeError("Expected iterable or array-like: "+e);t=z(r(e))}return t}function Cr(e,t){var r,n=function(o){if(o instanceof n)return o;if(!(this instanceof n))return new n(o);if(!r){r=!0;var a=Object.keys(e);Tr(i,a),i.size=a.length,i._name=t,i._keys=a,i._defaultValues=e}this._map=ze(o)},i=n.prototype=Object.create(kr);return i.constructor=n,n}t(Wt,ze),Wt.of=function(){return this(arguments)},Wt.prototype.toString=function(){return this.__toString("OrderedMap {","}")},Wt.prototype.get=function(e,t){var r=this._map.get(e);return void 0!==r?this._list.get(r)[1]:t},Wt.prototype.clear=function(){return 0===this.size?this:this.__ownerID?(this.size=0,this._map.clear(),this._list.clear(),this):qt()},Wt.prototype.set=function(e,t){return Gt(this,e,t)},Wt.prototype.remove=function(e){return Gt(this,e,y)},Wt.prototype.wasAltered=function(){return this._map.wasAltered()||this._list.wasAltered()},Wt.prototype.__iterate=function(e,t){var r=this;return this._list.__iterate((function(t){return t&&e(t[1],t[0],r)}),t)},Wt.prototype.__iterator=function(e,t){return this._list.fromEntrySeq().__iterator(e,t)},Wt.prototype.__ensureOwner=function(e){if(e===this.__ownerID)return this;var t=this._map.__ensureOwner(e),r=this._list.__ensureOwner(e);return e?zt(t,r,e,this.__hash):(this.__ownerID=e,this._map=t,this._list=r,this)},Wt.isOrderedMap=Vt,Wt.prototype[g]=!0,Wt.prototype[p]=Wt.prototype.remove,t($t,K),$t.prototype.get=function(e,t){return this._iter.get(e,t)},$t.prototype.has=function(e){return this._iter.has(e)},$t.prototype.valueSeq=function(){return this._iter.valueSeq()},$t.prototype.reverse=function(){var e=this,t=Qt(this,!0);return this._useKeys||(t.valueSeq=function(){return e._iter.toSeq().reverse()}),t},$t.prototype.map=function(e,t){var r=this,n=Zt(this,e,t);return this._useKeys||(n.valueSeq=function(){return r._iter.toSeq().map(e,t)}),n},$t.prototype.__iterate=function(e,t){var r,n=this;return this._iter.__iterate(this._useKeys?function(t,r){return e(t,r,n)}:(r=t?mr(this):0,function(i){return e(i,t?--r:r++,n)}),t)},$t.prototype.__iterator=function(e,t){if(this._useKeys)return this._iter.__iterator(e,t);var r=this._iter.__iterator(N,t),n=t?mr(this):0;return new B((function(){var i=r.next();return i.done?i:U(e,t?--n:n++,i.value,i)}))},$t.prototype[g]=!0,t(Kt,Y),Kt.prototype.includes=function(e){return this._iter.includes(e)},Kt.prototype.__iterate=function(e,t){var r=this,n=0;return this._iter.__iterate((function(t){return e(t,n++,r)}),t)},Kt.prototype.__iterator=function(e,t){var r=this._iter.__iterator(N,t),n=0;return new B((function(){var t=r.next();return t.done?t:U(e,n++,t.value,t)}))},t(Yt,X),Yt.prototype.has=function(e){return this._iter.includes(e)},Yt.prototype.__iterate=function(e,t){var r=this;return this._iter.__iterate((function(t){return e(t,t,r)}),t)},Yt.prototype.__iterator=function(e,t){var r=this._iter.__iterator(N,t);return new B((function(){var t=r.next();return t.done?t:U(e,t.value,t.value,t)}))},t(Xt,K),Xt.prototype.entrySeq=function(){return this._iter.toSeq()},Xt.prototype.__iterate=function(e,t){var r=this;return this._iter.__iterate((function(t){if(t){pr(t);var n=a(t);return e(n?t.get(1):t[1],n?t.get(0):t[0],r)}}),t)},Xt.prototype.__iterator=function(e,t){var r=this._iter.__iterator(N,t);return new B((function(){for(;;){var t=r.next();if(t.done)return t;var n=t.value;if(n){pr(n);var i=a(n);return U(e,i?n.get(0):n[0],i?n.get(1):n[1],t)}}}))},Kt.prototype.cacheResult=$t.prototype.cacheResult=Yt.prototype.cacheResult=Xt.prototype.cacheResult=yr,t(Cr,ke),Cr.prototype.toString=function(){return this.__toString(Er(this)+" {","}")},Cr.prototype.has=function(e){return this._defaultValues.hasOwnProperty(e)},Cr.prototype.get=function(e,t){if(!this.has(e))return t;var r=this._defaultValues[e];return this._map?this._map.get(e,r):r},Cr.prototype.clear=function(){if(this.__ownerID)return this._map&&this._map.clear(),this;var e=this.constructor;return e._empty||(e._empty=xr(this,it()))},Cr.prototype.set=function(e,t){if(!this.has(e))throw new Error('Cannot set unknown key "'+e+'" on '+Er(this));var r=this._map&&this._map.set(e,t);return this.__ownerID||r===this._map?this:xr(this,r)},Cr.prototype.remove=function(e){if(!this.has(e))return this;var t=this._map&&this._map.remove(e);return this.__ownerID||t===this._map?this:xr(this,t)},Cr.prototype.wasAltered=function(){return this._map.wasAltered()},Cr.prototype.__iterator=function(e,t){var r=this;return n(this._defaultValues).map((function(e,t){return r.get(t)})).__iterator(e,t)},Cr.prototype.__iterate=function(e,t){var r=this;return n(this._defaultValues).map((function(e,t){return r.get(t)})).__iterate(e,t)},Cr.prototype.__ensureOwner=function(e){if(e===this.__ownerID)return this;var t=this._map&&this._map.__ensureOwner(e);return e?xr(this,t,e):(this.__ownerID=e,this._map=t,this)};var kr=Cr.prototype;function xr(e,t,r){var n=Object.create(Object.getPrototypeOf(e));return n._map=t,n.__ownerID=r,n}function Er(e){return e._name||e.constructor.name||"Record"}function Tr(e,t){try{t.forEach(_r.bind(void 0,e))}catch(r){}}function _r(e,t){Object.defineProperty(e,t,{get:function(){return this.get(t)},set:function(e){we(this.__ownerID,"Cannot set on an immutable record."),this.set(t,e)}})}function Ar(e){return null===e||void 0===e?Dr():Rr(e)&&!u(e)?e:Dr().withMutations((function(t){var r=o(e);Ve(r.size),r.forEach((function(e){return t.add(e)}))}))}function Rr(e){return!(!e||!e[Mr])}kr[p]=kr.remove,kr.deleteIn=kr.removeIn=Ke.removeIn,kr.merge=Ke.merge,kr.mergeWith=Ke.mergeWith,kr.mergeIn=Ke.mergeIn,kr.mergeDeep=Ke.mergeDeep,kr.mergeDeepWith=Ke.mergeDeepWith,kr.mergeDeepIn=Ke.mergeDeepIn,kr.setIn=Ke.setIn,kr.update=Ke.update,kr.updateIn=Ke.updateIn,kr.withMutations=Ke.withMutations,kr.asMutable=Ke.asMutable,kr.asImmutable=Ke.asImmutable,t(Ar,Ee),Ar.of=function(){return this(arguments)},Ar.fromKeys=function(e){return this(n(e).keySeq())},Ar.prototype.toString=function(){return this.__toString("Set {","}")},Ar.prototype.has=function(e){return this._map.has(e)},Ar.prototype.add=function(e){return Pr(this,this._map.set(e,!0))},Ar.prototype.remove=function(e){return Pr(this,this._map.remove(e))},Ar.prototype.clear=function(){return Pr(this,this._map.clear())},Ar.prototype.union=function(){var t=e.call(arguments,0);return 0===(t=t.filter((function(e){return 0!==e.size}))).length?this:0!==this.size||this.__ownerID||1!==t.length?this.withMutations((function(e){for(var r=0;r<t.length;r++)o(t[r]).forEach((function(t){return e.add(t)}))})):this.constructor(t[0])},Ar.prototype.intersect=function(){var t=e.call(arguments,0);if(0===t.length)return this;t=t.map((function(e){return o(e)}));var r=this;return this.withMutations((function(e){r.forEach((function(r){t.every((function(e){return e.includes(r)}))||e.remove(r)}))}))},Ar.prototype.subtract=function(){var t=e.call(arguments,0);if(0===t.length)return this;t=t.map((function(e){return o(e)}));var r=this;return this.withMutations((function(e){r.forEach((function(r){t.some((function(e){return e.includes(r)}))&&e.remove(r)}))}))},Ar.prototype.merge=function(){return this.union.apply(this,arguments)},Ar.prototype.mergeWith=function(t){var r=e.call(arguments,1);return this.union.apply(this,r)},Ar.prototype.sort=function(e){return Fr(ur(this,e))},Ar.prototype.sortBy=function(e,t){return Fr(ur(this,t,e))},Ar.prototype.wasAltered=function(){return this._map.wasAltered()},Ar.prototype.__iterate=function(e,t){var r=this;return this._map.__iterate((function(t,n){return e(n,n,r)}),t)},Ar.prototype.__iterator=function(e,t){return this._map.map((function(e,t){return t})).__iterator(e,t)},Ar.prototype.__ensureOwner=function(e){if(e===this.__ownerID)return this;var t=this._map.__ensureOwner(e);return e?this.__make(t,e):(this.__ownerID=e,this._map=t,this)},Ar.isSet=Rr;var Or,Mr="@@__IMMUTABLE_SET__@@",Ir=Ar.prototype;function Pr(e,t){return e.__ownerID?(e.size=t.size,e._map=t,e):t===e._map?e:0===t.size?e.__empty():e.__make(t)}function Nr(e,t){var r=Object.create(Ir);return r.size=e?e.size:0,r._map=e,r.__ownerID=t,r}function Dr(){return Or||(Or=Nr(it()))}function Fr(e){return null===e||void 0===e?jr():Lr(e)?e:jr().withMutations((function(t){var r=o(e);Ve(r.size),r.forEach((function(e){return t.add(e)}))}))}function Lr(e){return Rr(e)&&u(e)}Ir[Mr]=!0,Ir[p]=Ir.remove,Ir.mergeDeep=Ir.merge,Ir.mergeDeepWith=Ir.mergeWith,Ir.withMutations=Ke.withMutations,Ir.asMutable=Ke.asMutable,Ir.asImmutable=Ke.asImmutable,Ir.__empty=Dr,Ir.__make=Nr,t(Fr,Ar),Fr.of=function(){return this(arguments)},Fr.fromKeys=function(e){return this(n(e).keySeq())},Fr.prototype.toString=function(){return this.__toString("OrderedSet {","}")},Fr.isOrderedSet=Lr;var Hr,Br=Fr.prototype;function Ur(e,t){var r=Object.create(Br);return r.size=e?e.size:0,r._map=e,r.__ownerID=t,r}function jr(){return Hr||(Hr=Ur(qt()))}function Wr(e){return null===e||void 0===e?Kr():Vr(e)?e:Kr().unshiftAll(e)}function Vr(e){return!(!e||!e[qr])}Br[g]=!0,Br.__empty=jr,Br.__make=Ur,t(Wr,xe),Wr.of=function(){return this(arguments)},Wr.prototype.toString=function(){return this.__toString("Stack [","]")},Wr.prototype.get=function(e,t){var r=this._head;for(e=_(this,e);r&&e--;)r=r.next;return r?r.value:t},Wr.prototype.peek=function(){return this._head&&this._head.value},Wr.prototype.push=function(){if(0===arguments.length)return this;for(var e=this.size+arguments.length,t=this._head,r=arguments.length-1;r>=0;r--)t={value:arguments[r],next:t};return this.__ownerID?(this.size=e,this._head=t,this.__hash=void 0,this.__altered=!0,this):$r(e,t)},Wr.prototype.pushAll=function(e){if(0===(e=i(e)).size)return this;Ve(e.size);var t=this.size,r=this._head;return e.reverse().forEach((function(e){t++,r={value:e,next:r}})),this.__ownerID?(this.size=t,this._head=r,this.__hash=void 0,this.__altered=!0,this):$r(t,r)},Wr.prototype.pop=function(){return this.slice(1)},Wr.prototype.unshift=function(){return this.push.apply(this,arguments)},Wr.prototype.unshiftAll=function(e){return this.pushAll(e)},Wr.prototype.shift=function(){return this.pop.apply(this,arguments)},Wr.prototype.clear=function(){return 0===this.size?this:this.__ownerID?(this.size=0,this._head=void 0,this.__hash=void 0,this.__altered=!0,this):Kr()},Wr.prototype.slice=function(e,t){if(R(e,t,this.size))return this;var r=O(e,this.size);if(M(t,this.size)!==this.size)return xe.prototype.slice.call(this,e,t);for(var n=this.size-r,i=this._head;r--;)i=i.next;return this.__ownerID?(this.size=n,this._head=i,this.__hash=void 0,this.__altered=!0,this):$r(n,i)},Wr.prototype.__ensureOwner=function(e){return e===this.__ownerID?this:e?$r(this.size,this._head,e,this.__hash):(this.__ownerID=e,this.__altered=!1,this)},Wr.prototype.__iterate=function(e,t){if(t)return this.reverse().__iterate(e);for(var r=0,n=this._head;n&&!1!==e(n.value,r++,this);)n=n.next;return r},Wr.prototype.__iterator=function(e,t){if(t)return this.reverse().__iterator(e);var r=0,n=this._head;return new B((function(){if(n){var t=n.value;return n=n.next,U(e,r++,t)}return j()}))},Wr.isStack=Vr;var zr,qr="@@__IMMUTABLE_STACK__@@",Gr=Wr.prototype;function $r(e,t,r,n){var i=Object.create(Gr);return i.size=e,i._head=t,i.__ownerID=r,i.__hash=n,i.__altered=!1,i}function Kr(){return zr||(zr=$r(0))}function Yr(e,t){var r=function(r){e.prototype[r]=t[r]};return Object.keys(t).forEach(r),Object.getOwnPropertySymbols&&Object.getOwnPropertySymbols(t).forEach(r),e}Gr[qr]=!0,Gr.withMutations=Ke.withMutations,Gr.asMutable=Ke.asMutable,Gr.asImmutable=Ke.asImmutable,Gr.wasAltered=Ke.wasAltered,r.Iterator=B,Yr(r,{toArray:function(){Ve(this.size);var e=new Array(this.size||0);return this.valueSeq().__iterate((function(t,r){e[r]=t})),e},toIndexedSeq:function(){return new Kt(this)},toJS:function(){return this.toSeq().map((function(e){return e&&"function"===typeof e.toJS?e.toJS():e})).__toJS()},toJSON:function(){return this.toSeq().map((function(e){return e&&"function"===typeof e.toJSON?e.toJSON():e})).__toJS()},toKeyedSeq:function(){return new $t(this,!0)},toMap:function(){return ze(this.toKeyedSeq())},toObject:function(){Ve(this.size);var e={};return this.__iterate((function(t,r){e[r]=t})),e},toOrderedMap:function(){return Wt(this.toKeyedSeq())},toOrderedSet:function(){return Fr(s(this)?this.valueSeq():this)},toSet:function(){return Ar(s(this)?this.valueSeq():this)},toSetSeq:function(){return new Yt(this)},toSeq:function(){return l(this)?this.toIndexedSeq():s(this)?this.toKeyedSeq():this.toSetSeq()},toStack:function(){return Wr(s(this)?this.valueSeq():this)},toList:function(){return xt(s(this)?this.valueSeq():this)},toString:function(){return"[Iterable]"},__toString:function(e,t){return 0===this.size?e+t:e+" "+this.toSeq().map(this.__toStringMapper).join(", ")+" "+t},concat:function(){return gr(this,ar(this,e.call(arguments,0)))},includes:function(e){return this.some((function(t){return ve(t,e)}))},entries:function(){return this.__iterator(D)},every:function(e,t){Ve(this.size);var r=!0;return this.__iterate((function(n,i,o){if(!e.call(t,n,i,o))return r=!1,!1})),r},filter:function(e,t){return gr(this,er(this,e,t,!0))},find:function(e,t,r){var n=this.findEntry(e,t);return n?n[1]:r},findEntry:function(e,t){var r;return this.__iterate((function(n,i,o){if(e.call(t,n,i,o))return r=[i,n],!1})),r},findLastEntry:function(e,t){return this.toSeq().reverse().findEntry(e,t)},forEach:function(e,t){return Ve(this.size),this.__iterate(t?e.bind(t):e)},join:function(e){Ve(this.size),e=void 0!==e?""+e:",";var t="",r=!0;return this.__iterate((function(n){r?r=!1:t+=e,t+=null!==n&&void 0!==n?n.toString():""})),t},keys:function(){return this.__iterator(P)},map:function(e,t){return gr(this,Zt(this,e,t))},reduce:function(e,t,r){var n,i;return Ve(this.size),arguments.length<2?i=!0:n=t,this.__iterate((function(t,o,a){i?(i=!1,n=t):n=e.call(r,n,t,o,a)})),n},reduceRight:function(e,t,r){var n=this.toKeyedSeq().reverse();return n.reduce.apply(n,arguments)},reverse:function(){return gr(this,Qt(this,!0))},slice:function(e,t){return gr(this,nr(this,e,t,!0))},some:function(e,t){return!this.every(en(e),t)},sort:function(e){return gr(this,ur(this,e))},values:function(){return this.__iterator(N)},butLast:function(){return this.slice(0,-1)},isEmpty:function(){return void 0!==this.size?0===this.size:!this.some((function(){return!0}))},count:function(e,t){return T(e?this.toSeq().filter(e,t):this)},countBy:function(e,t){return tr(this,e,t)},equals:function(e){return be(this,e)},entrySeq:function(){var e=this;if(e._cache)return new te(e._cache);var t=e.toSeq().map(Qr).toIndexedSeq();return t.fromEntrySeq=function(){return e.toSeq()},t},filterNot:function(e,t){return this.filter(en(e),t)},findLast:function(e,t,r){return this.toKeyedSeq().reverse().find(e,t,r)},first:function(){return this.find(A)},flatMap:function(e,t){return gr(this,lr(this,e,t))},flatten:function(e){return gr(this,sr(this,e,!0))},fromEntrySeq:function(){return new Xt(this)},get:function(e,t){return this.find((function(t,r){return ve(r,e)}),void 0,t)},getIn:function(e,t){for(var r,n=this,i=Sr(e);!(r=i.next()).done;){var o=r.value;if((n=n&&n.get?n.get(o,y):y)===y)return t}return n},groupBy:function(e,t){return rr(this,e,t)},has:function(e){return this.get(e,y)!==y},hasIn:function(e){return this.getIn(e,y)!==y},isSubset:function(e){return e="function"===typeof e.includes?e:r(e),this.every((function(t){return e.includes(t)}))},isSuperset:function(e){return(e="function"===typeof e.isSubset?e:r(e)).isSubset(this)},keySeq:function(){return this.toSeq().map(Zr).toIndexedSeq()},last:function(){return this.toSeq().reverse().first()},max:function(e){return hr(this,e)},maxBy:function(e,t){return hr(this,t,e)},min:function(e){return hr(this,e?tn(e):on)},minBy:function(e,t){return hr(this,t?tn(t):on,e)},rest:function(){return this.slice(1)},skip:function(e){return this.slice(Math.max(0,e))},skipLast:function(e){return gr(this,this.toSeq().reverse().skip(e).reverse())},skipWhile:function(e,t){return gr(this,or(this,e,t,!0))},skipUntil:function(e,t){return this.skipWhile(en(e),t)},sortBy:function(e,t){return gr(this,ur(this,t,e))},take:function(e){return this.slice(0,Math.max(0,e))},takeLast:function(e){return gr(this,this.toSeq().reverse().take(e).reverse())},takeWhile:function(e,t){return gr(this,ir(this,e,t))},takeUntil:function(e,t){return this.takeWhile(en(e),t)},valueSeq:function(){return this.toIndexedSeq()},hashCode:function(){return this.__hash||(this.__hash=an(this))}});var Xr=r.prototype;Xr[h]=!0,Xr[H]=Xr.values,Xr.__toJS=Xr.toArray,Xr.__toStringMapper=rn,Xr.inspect=Xr.toSource=function(){return this.toString()},Xr.chain=Xr.flatMap,Xr.contains=Xr.includes,function(){try{Object.defineProperty(Xr,"length",{get:function(){if(!r.noLengthWarning){var e;try{throw new Error}catch(t){e=t.stack}if(-1===e.indexOf("_wrapObject"))return console&&console.warn&&console.warn("iterable.length has been deprecated, use iterable.size or iterable.count(). This warning will become a silent error in a future version. "+e),this.size}}})}catch(e){}}(),Yr(n,{flip:function(){return gr(this,Jt(this))},findKey:function(e,t){var r=this.findEntry(e,t);return r&&r[0]},findLastKey:function(e,t){return this.toSeq().reverse().findKey(e,t)},keyOf:function(e){return this.findKey((function(t){return ve(t,e)}))},lastKeyOf:function(e){return this.findLastKey((function(t){return ve(t,e)}))},mapEntries:function(e,t){var r=this,n=0;return gr(this,this.toSeq().map((function(i,o){return e.call(t,[o,i],n++,r)})).fromEntrySeq())},mapKeys:function(e,t){var r=this;return gr(this,this.toSeq().flip().map((function(n,i){return e.call(t,n,i,r)})).flip())}});var Jr=n.prototype;function Zr(e,t){return t}function Qr(e,t){return[t,e]}function en(e){return function(){return!e.apply(this,arguments)}}function tn(e){return function(){return-e.apply(this,arguments)}}function rn(e){return"string"===typeof e?JSON.stringify(e):e}function nn(){return E(arguments)}function on(e,t){return e<t?1:e>t?-1:0}function an(e){if(e.size===1/0)return 0;var t=u(e),r=s(e),n=t?1:0;return sn(e.__iterate(r?t?function(e,t){n=31*n+ln(Ae(e),Ae(t))|0}:function(e,t){n=n+ln(Ae(e),Ae(t))|0}:t?function(e){n=31*n+Ae(e)|0}:function(e){n=n+Ae(e)|0}),n)}function sn(e,t){return t=Te(t,3432918353),t=Te(t<<15|t>>>-15,461845907),t=Te(t<<13|t>>>-13,5),t=Te((t=t+3864292196^e)^t>>>16,2246822507),t=_e((t=Te(t^t>>>13,3266489909))^t>>>16)}function ln(e,t){return e^t+2654435769+(e<<6)+(e>>2)}return Jr[d]=!0,Jr[H]=Xr.entries,Jr.__toJS=Xr.toObject,Jr.__toStringMapper=function(e,t){return JSON.stringify(t)+": "+rn(e)},Yr(i,{toKeyedSeq:function(){return new $t(this,!1)},filter:function(e,t){return gr(this,er(this,e,t,!1))},findIndex:function(e,t){var r=this.findEntry(e,t);return r?r[0]:-1},indexOf:function(e){var t=this.toKeyedSeq().keyOf(e);return void 0===t?-1:t},lastIndexOf:function(e){var t=this.toKeyedSeq().reverse().keyOf(e);return void 0===t?-1:t},reverse:function(){return gr(this,Qt(this,!1))},slice:function(e,t){return gr(this,nr(this,e,t,!1))},splice:function(e,t){var r=arguments.length;if(t=Math.max(0|t,0),0===r||2===r&&!t)return this;e=O(e,e<0?this.count():this.size);var n=this.slice(0,e);return gr(this,1===r?n:n.concat(E(arguments,2),this.slice(e+t)))},findLastIndex:function(e,t){var r=this.toKeyedSeq().findLastKey(e,t);return void 0===r?-1:r},first:function(){return this.get(0)},flatten:function(e){return gr(this,sr(this,e,!1))},get:function(e,t){return(e=_(this,e))<0||this.size===1/0||void 0!==this.size&&e>this.size?t:this.find((function(t,r){return r===e}),void 0,t)},has:function(e){return(e=_(this,e))>=0&&(void 0!==this.size?this.size===1/0||e<this.size:-1!==this.indexOf(e))},interpose:function(e){return gr(this,cr(this,e))},interleave:function(){var e=[this].concat(E(arguments)),t=fr(this.toSeq(),Y.of,e),r=t.flatten(!0);return t.size&&(r.size=t.size*e.length),gr(this,r)},last:function(){return this.get(-1)},skipWhile:function(e,t){return gr(this,or(this,e,t,!1))},zip:function(){return gr(this,fr(this,nn,[this].concat(E(arguments))))},zipWith:function(e){var t=E(arguments);return t[0]=this,gr(this,fr(this,e,t))}}),i.prototype[f]=!0,i.prototype[g]=!0,Yr(o,{get:function(e,t){return this.has(e)?e:t},includes:function(e){return this.has(e)},keySeq:function(){return this.valueSeq()}}),o.prototype.has=Xr.includes,Yr(K,n.prototype),Yr(Y,i.prototype),Yr(X,o.prototype),Yr(ke,n.prototype),Yr(xe,i.prototype),Yr(Ee,o.prototype),{Iterable:r,Seq:$,Collection:Ce,Map:ze,OrderedMap:Wt,List:xt,Stack:Wr,Set:Ar,OrderedSet:Fr,Record:Cr,Range:Se,Repeat:ye,is:ve,fromJS:fe}}()},6178:function(e,t,r){(e=r.nmd(e)).exports=function(){"use strict";var t,r;function n(){return t.apply(null,arguments)}function i(e){t=e}function o(e){return e instanceof Array||"[object Array]"===Object.prototype.toString.call(e)}function a(e){return null!=e&&"[object Object]"===Object.prototype.toString.call(e)}function s(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function l(e){if(Object.getOwnPropertyNames)return 0===Object.getOwnPropertyNames(e).length;var t;for(t in e)if(s(e,t))return!1;return!0}function c(e){return void 0===e}function u(e){return"number"===typeof e||"[object Number]"===Object.prototype.toString.call(e)}function h(e){return e instanceof Date||"[object Date]"===Object.prototype.toString.call(e)}function d(e,t){var r,n=[],i=e.length;for(r=0;r<i;++r)n.push(t(e[r],r));return n}function f(e,t){for(var r in t)s(t,r)&&(e[r]=t[r]);return s(t,"toString")&&(e.toString=t.toString),s(t,"valueOf")&&(e.valueOf=t.valueOf),e}function g(e,t,r,n){return $r(e,t,r,n,!0).utc()}function p(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function m(e){return null==e._pf&&(e._pf=p()),e._pf}function v(e){var t=null,n=!1,i=e._d&&!isNaN(e._d.getTime());return i&&(t=m(e),n=r.call(t.parsedDateParts,(function(e){return null!=e})),i=t.overflow<0&&!t.empty&&!t.invalidEra&&!t.invalidMonth&&!t.invalidWeekday&&!t.weekdayMismatch&&!t.nullInput&&!t.invalidFormat&&!t.userInvalidated&&(!t.meridiem||t.meridiem&&n),e._strict&&(i=i&&0===t.charsLeftOver&&0===t.unusedTokens.length&&void 0===t.bigHour)),null!=Object.isFrozen&&Object.isFrozen(e)?i:(e._isValid=i,e._isValid)}function b(e){var t=g(NaN);return null!=e?f(m(t),e):m(t).userInvalidated=!0,t}r=Array.prototype.some?Array.prototype.some:function(e){var t,r=Object(this),n=r.length>>>0;for(t=0;t<n;t++)if(t in r&&e.call(this,r[t],t,r))return!0;return!1};var y=n.momentProperties=[],w=!1;function S(e,t){var r,n,i,o=y.length;if(c(t._isAMomentObject)||(e._isAMomentObject=t._isAMomentObject),c(t._i)||(e._i=t._i),c(t._f)||(e._f=t._f),c(t._l)||(e._l=t._l),c(t._strict)||(e._strict=t._strict),c(t._tzm)||(e._tzm=t._tzm),c(t._isUTC)||(e._isUTC=t._isUTC),c(t._offset)||(e._offset=t._offset),c(t._pf)||(e._pf=m(t)),c(t._locale)||(e._locale=t._locale),o>0)for(r=0;r<o;r++)c(i=t[n=y[r]])||(e[n]=i);return e}function C(e){S(this,e),this._d=new Date(null!=e._d?e._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),!1===w&&(w=!0,n.updateOffset(this),w=!1)}function k(e){return e instanceof C||null!=e&&null!=e._isAMomentObject}function x(e){!1===n.suppressDeprecationWarnings&&"undefined"!==typeof console&&console.warn&&console.warn("Deprecation warning: "+e)}function E(e,t){var r=!0;return f((function(){if(null!=n.deprecationHandler&&n.deprecationHandler(null,e),r){var i,o,a,l=[],c=arguments.length;for(o=0;o<c;o++){if(i="","object"===typeof arguments[o]){for(a in i+="\n["+o+"] ",arguments[0])s(arguments[0],a)&&(i+=a+": "+arguments[0][a]+", ");i=i.slice(0,-2)}else i=arguments[o];l.push(i)}x(e+"\nArguments: "+Array.prototype.slice.call(l).join("")+"\n"+(new Error).stack),r=!1}return t.apply(this,arguments)}),t)}var T,_={};function A(e,t){null!=n.deprecationHandler&&n.deprecationHandler(e,t),_[e]||(x(t),_[e]=!0)}function R(e){return"undefined"!==typeof Function&&e instanceof Function||"[object Function]"===Object.prototype.toString.call(e)}function O(e){var t,r;for(r in e)s(e,r)&&(R(t=e[r])?this[r]=t:this["_"+r]=t);this._config=e,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function M(e,t){var r,n=f({},e);for(r in t)s(t,r)&&(a(e[r])&&a(t[r])?(n[r]={},f(n[r],e[r]),f(n[r],t[r])):null!=t[r]?n[r]=t[r]:delete n[r]);for(r in e)s(e,r)&&!s(t,r)&&a(e[r])&&(n[r]=f({},n[r]));return n}function I(e){null!=e&&this.set(e)}n.suppressDeprecationWarnings=!1,n.deprecationHandler=null,T=Object.keys?Object.keys:function(e){var t,r=[];for(t in e)s(e,t)&&r.push(t);return r};var P={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function N(e,t,r){var n=this._calendar[e]||this._calendar.sameElse;return R(n)?n.call(t,r):n}function D(e,t,r){var n=""+Math.abs(e),i=t-n.length;return(e>=0?r?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+n}var F=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,L=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,H={},B={};function U(e,t,r,n){var i=n;"string"===typeof n&&(i=function(){return this[n]()}),e&&(B[e]=i),t&&(B[t[0]]=function(){return D(i.apply(this,arguments),t[1],t[2])}),r&&(B[r]=function(){return this.localeData().ordinal(i.apply(this,arguments),e)})}function j(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function W(e){var t,r,n=e.match(F);for(t=0,r=n.length;t<r;t++)B[n[t]]?n[t]=B[n[t]]:n[t]=j(n[t]);return function(t){var i,o="";for(i=0;i<r;i++)o+=R(n[i])?n[i].call(t,e):n[i];return o}}function V(e,t){return e.isValid()?(t=z(t,e.localeData()),H[t]=H[t]||W(t),H[t](e)):e.localeData().invalidDate()}function z(e,t){var r=5;function n(e){return t.longDateFormat(e)||e}for(L.lastIndex=0;r>=0&&L.test(e);)e=e.replace(L,n),L.lastIndex=0,r-=1;return e}var q={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function G(e){var t=this._longDateFormat[e],r=this._longDateFormat[e.toUpperCase()];return t||!r?t:(this._longDateFormat[e]=r.match(F).map((function(e){return"MMMM"===e||"MM"===e||"DD"===e||"dddd"===e?e.slice(1):e})).join(""),this._longDateFormat[e])}var $="Invalid date";function K(){return this._invalidDate}var Y="%d",X=/\d{1,2}/;function J(e){return this._ordinal.replace("%d",e)}var Z={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function Q(e,t,r,n){var i=this._relativeTime[r];return R(i)?i(e,t,r,n):i.replace(/%d/i,e)}function ee(e,t){var r=this._relativeTime[e>0?"future":"past"];return R(r)?r(t):r.replace(/%s/i,t)}var te={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function re(e){return"string"===typeof e?te[e]||te[e.toLowerCase()]:void 0}function ne(e){var t,r,n={};for(r in e)s(e,r)&&(t=re(r))&&(n[t]=e[r]);return n}var ie={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};function oe(e){var t,r=[];for(t in e)s(e,t)&&r.push({unit:t,priority:ie[t]});return r.sort((function(e,t){return e.priority-t.priority})),r}var ae,se=/\d/,le=/\d\d/,ce=/\d{3}/,ue=/\d{4}/,he=/[+-]?\d{6}/,de=/\d\d?/,fe=/\d\d\d\d?/,ge=/\d\d\d\d\d\d?/,pe=/\d{1,3}/,me=/\d{1,4}/,ve=/[+-]?\d{1,6}/,be=/\d+/,ye=/[+-]?\d+/,we=/Z|[+-]\d\d:?\d\d/gi,Se=/Z|[+-]\d\d(?::?\d\d)?/gi,Ce=/[+-]?\d+(\.\d{1,3})?/,ke=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,xe=/^[1-9]\d?/,Ee=/^([1-9]\d|\d)/;function Te(e,t,r){ae[e]=R(t)?t:function(e,n){return e&&r?r:t}}function _e(e,t){return s(ae,e)?ae[e](t._strict,t._locale):new RegExp(Ae(e))}function Ae(e){return Re(e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,(function(e,t,r,n,i){return t||r||n||i})))}function Re(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function Oe(e){return e<0?Math.ceil(e)||0:Math.floor(e)}function Me(e){var t=+e,r=0;return 0!==t&&isFinite(t)&&(r=Oe(t)),r}ae={};var Ie={};function Pe(e,t){var r,n,i=t;for("string"===typeof e&&(e=[e]),u(t)&&(i=function(e,r){r[t]=Me(e)}),n=e.length,r=0;r<n;r++)Ie[e[r]]=i}function Ne(e,t){Pe(e,(function(e,r,n,i){n._w=n._w||{},t(e,n._w,n,i)}))}function De(e,t,r){null!=t&&s(Ie,e)&&Ie[e](t,r._a,r,e)}function Fe(e){return e%4===0&&e%100!==0||e%400===0}var Le=0,He=1,Be=2,Ue=3,je=4,We=5,Ve=6,ze=7,qe=8;function Ge(e){return Fe(e)?366:365}U("Y",0,0,(function(){var e=this.year();return e<=9999?D(e,4):"+"+e})),U(0,["YY",2],0,(function(){return this.year()%100})),U(0,["YYYY",4],0,"year"),U(0,["YYYYY",5],0,"year"),U(0,["YYYYYY",6,!0],0,"year"),Te("Y",ye),Te("YY",de,le),Te("YYYY",me,ue),Te("YYYYY",ve,he),Te("YYYYYY",ve,he),Pe(["YYYYY","YYYYYY"],Le),Pe("YYYY",(function(e,t){t[Le]=2===e.length?n.parseTwoDigitYear(e):Me(e)})),Pe("YY",(function(e,t){t[Le]=n.parseTwoDigitYear(e)})),Pe("Y",(function(e,t){t[Le]=parseInt(e,10)})),n.parseTwoDigitYear=function(e){return Me(e)+(Me(e)>68?1900:2e3)};var $e,Ke=Xe("FullYear",!0);function Ye(){return Fe(this.year())}function Xe(e,t){return function(r){return null!=r?(Ze(this,e,r),n.updateOffset(this,t),this):Je(this,e)}}function Je(e,t){if(!e.isValid())return NaN;var r=e._d,n=e._isUTC;switch(t){case"Milliseconds":return n?r.getUTCMilliseconds():r.getMilliseconds();case"Seconds":return n?r.getUTCSeconds():r.getSeconds();case"Minutes":return n?r.getUTCMinutes():r.getMinutes();case"Hours":return n?r.getUTCHours():r.getHours();case"Date":return n?r.getUTCDate():r.getDate();case"Day":return n?r.getUTCDay():r.getDay();case"Month":return n?r.getUTCMonth():r.getMonth();case"FullYear":return n?r.getUTCFullYear():r.getFullYear();default:return NaN}}function Ze(e,t,r){var n,i,o,a,s;if(e.isValid()&&!isNaN(r)){switch(n=e._d,i=e._isUTC,t){case"Milliseconds":return void(i?n.setUTCMilliseconds(r):n.setMilliseconds(r));case"Seconds":return void(i?n.setUTCSeconds(r):n.setSeconds(r));case"Minutes":return void(i?n.setUTCMinutes(r):n.setMinutes(r));case"Hours":return void(i?n.setUTCHours(r):n.setHours(r));case"Date":return void(i?n.setUTCDate(r):n.setDate(r));case"FullYear":break;default:return}o=r,a=e.month(),s=29!==(s=e.date())||1!==a||Fe(o)?s:28,i?n.setUTCFullYear(o,a,s):n.setFullYear(o,a,s)}}function Qe(e){return R(this[e=re(e)])?this[e]():this}function et(e,t){if("object"===typeof e){var r,n=oe(e=ne(e)),i=n.length;for(r=0;r<i;r++)this[n[r].unit](e[n[r].unit])}else if(R(this[e=re(e)]))return this[e](t);return this}function tt(e,t){return(e%t+t)%t}function rt(e,t){if(isNaN(e)||isNaN(t))return NaN;var r=tt(t,12);return e+=(t-r)/12,1===r?Fe(e)?29:28:31-r%7%2}$e=Array.prototype.indexOf?Array.prototype.indexOf:function(e){var t;for(t=0;t<this.length;++t)if(this[t]===e)return t;return-1},U("M",["MM",2],"Mo",(function(){return this.month()+1})),U("MMM",0,0,(function(e){return this.localeData().monthsShort(this,e)})),U("MMMM",0,0,(function(e){return this.localeData().months(this,e)})),Te("M",de,xe),Te("MM",de,le),Te("MMM",(function(e,t){return t.monthsShortRegex(e)})),Te("MMMM",(function(e,t){return t.monthsRegex(e)})),Pe(["M","MM"],(function(e,t){t[He]=Me(e)-1})),Pe(["MMM","MMMM"],(function(e,t,r,n){var i=r._locale.monthsParse(e,n,r._strict);null!=i?t[He]=i:m(r).invalidMonth=e}));var nt="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),it="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),ot=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,at=ke,st=ke;function lt(e,t){return e?o(this._months)?this._months[e.month()]:this._months[(this._months.isFormat||ot).test(t)?"format":"standalone"][e.month()]:o(this._months)?this._months:this._months.standalone}function ct(e,t){return e?o(this._monthsShort)?this._monthsShort[e.month()]:this._monthsShort[ot.test(t)?"format":"standalone"][e.month()]:o(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function ut(e,t,r){var n,i,o,a=e.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],n=0;n<12;++n)o=g([2e3,n]),this._shortMonthsParse[n]=this.monthsShort(o,"").toLocaleLowerCase(),this._longMonthsParse[n]=this.months(o,"").toLocaleLowerCase();return r?"MMM"===t?-1!==(i=$e.call(this._shortMonthsParse,a))?i:null:-1!==(i=$e.call(this._longMonthsParse,a))?i:null:"MMM"===t?-1!==(i=$e.call(this._shortMonthsParse,a))||-1!==(i=$e.call(this._longMonthsParse,a))?i:null:-1!==(i=$e.call(this._longMonthsParse,a))||-1!==(i=$e.call(this._shortMonthsParse,a))?i:null}function ht(e,t,r){var n,i,o;if(this._monthsParseExact)return ut.call(this,e,t,r);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),n=0;n<12;n++){if(i=g([2e3,n]),r&&!this._longMonthsParse[n]&&(this._longMonthsParse[n]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[n]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),r||this._monthsParse[n]||(o="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[n]=new RegExp(o.replace(".",""),"i")),r&&"MMMM"===t&&this._longMonthsParse[n].test(e))return n;if(r&&"MMM"===t&&this._shortMonthsParse[n].test(e))return n;if(!r&&this._monthsParse[n].test(e))return n}}function dt(e,t){if(!e.isValid())return e;if("string"===typeof t)if(/^\d+$/.test(t))t=Me(t);else if(!u(t=e.localeData().monthsParse(t)))return e;var r=t,n=e.date();return n=n<29?n:Math.min(n,rt(e.year(),r)),e._isUTC?e._d.setUTCMonth(r,n):e._d.setMonth(r,n),e}function ft(e){return null!=e?(dt(this,e),n.updateOffset(this,!0),this):Je(this,"Month")}function gt(){return rt(this.year(),this.month())}function pt(e){return this._monthsParseExact?(s(this,"_monthsRegex")||vt.call(this),e?this._monthsShortStrictRegex:this._monthsShortRegex):(s(this,"_monthsShortRegex")||(this._monthsShortRegex=at),this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex)}function mt(e){return this._monthsParseExact?(s(this,"_monthsRegex")||vt.call(this),e?this._monthsStrictRegex:this._monthsRegex):(s(this,"_monthsRegex")||(this._monthsRegex=st),this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex)}function vt(){function e(e,t){return t.length-e.length}var t,r,n,i,o=[],a=[],s=[];for(t=0;t<12;t++)r=g([2e3,t]),n=Re(this.monthsShort(r,"")),i=Re(this.months(r,"")),o.push(n),a.push(i),s.push(i),s.push(n);o.sort(e),a.sort(e),s.sort(e),this._monthsRegex=new RegExp("^("+s.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+a.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+o.join("|")+")","i")}function bt(e,t,r,n,i,o,a){var s;return e<100&&e>=0?(s=new Date(e+400,t,r,n,i,o,a),isFinite(s.getFullYear())&&s.setFullYear(e)):s=new Date(e,t,r,n,i,o,a),s}function yt(e){var t,r;return e<100&&e>=0?((r=Array.prototype.slice.call(arguments))[0]=e+400,t=new Date(Date.UTC.apply(null,r)),isFinite(t.getUTCFullYear())&&t.setUTCFullYear(e)):t=new Date(Date.UTC.apply(null,arguments)),t}function wt(e,t,r){var n=7+t-r;return-(7+yt(e,0,n).getUTCDay()-t)%7+n-1}function St(e,t,r,n,i){var o,a,s=1+7*(t-1)+(7+r-n)%7+wt(e,n,i);return s<=0?a=Ge(o=e-1)+s:s>Ge(e)?(o=e+1,a=s-Ge(e)):(o=e,a=s),{year:o,dayOfYear:a}}function Ct(e,t,r){var n,i,o=wt(e.year(),t,r),a=Math.floor((e.dayOfYear()-o-1)/7)+1;return a<1?n=a+kt(i=e.year()-1,t,r):a>kt(e.year(),t,r)?(n=a-kt(e.year(),t,r),i=e.year()+1):(i=e.year(),n=a),{week:n,year:i}}function kt(e,t,r){var n=wt(e,t,r),i=wt(e+1,t,r);return(Ge(e)-n+i)/7}function xt(e){return Ct(e,this._week.dow,this._week.doy).week}U("w",["ww",2],"wo","week"),U("W",["WW",2],"Wo","isoWeek"),Te("w",de,xe),Te("ww",de,le),Te("W",de,xe),Te("WW",de,le),Ne(["w","ww","W","WW"],(function(e,t,r,n){t[n.substr(0,1)]=Me(e)}));var Et={dow:0,doy:6};function Tt(){return this._week.dow}function _t(){return this._week.doy}function At(e){var t=this.localeData().week(this);return null==e?t:this.add(7*(e-t),"d")}function Rt(e){var t=Ct(this,1,4).week;return null==e?t:this.add(7*(e-t),"d")}function Ot(e,t){return"string"!==typeof e?e:isNaN(e)?"number"===typeof(e=t.weekdaysParse(e))?e:null:parseInt(e,10)}function Mt(e,t){return"string"===typeof e?t.weekdaysParse(e)%7||7:isNaN(e)?null:e}function It(e,t){return e.slice(t,7).concat(e.slice(0,t))}U("d",0,"do","day"),U("dd",0,0,(function(e){return this.localeData().weekdaysMin(this,e)})),U("ddd",0,0,(function(e){return this.localeData().weekdaysShort(this,e)})),U("dddd",0,0,(function(e){return this.localeData().weekdays(this,e)})),U("e",0,0,"weekday"),U("E",0,0,"isoWeekday"),Te("d",de),Te("e",de),Te("E",de),Te("dd",(function(e,t){return t.weekdaysMinRegex(e)})),Te("ddd",(function(e,t){return t.weekdaysShortRegex(e)})),Te("dddd",(function(e,t){return t.weekdaysRegex(e)})),Ne(["dd","ddd","dddd"],(function(e,t,r,n){var i=r._locale.weekdaysParse(e,n,r._strict);null!=i?t.d=i:m(r).invalidWeekday=e})),Ne(["d","e","E"],(function(e,t,r,n){t[n]=Me(e)}));var Pt="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),Nt="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),Dt="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),Ft=ke,Lt=ke,Ht=ke;function Bt(e,t){var r=o(this._weekdays)?this._weekdays:this._weekdays[e&&!0!==e&&this._weekdays.isFormat.test(t)?"format":"standalone"];return!0===e?It(r,this._week.dow):e?r[e.day()]:r}function Ut(e){return!0===e?It(this._weekdaysShort,this._week.dow):e?this._weekdaysShort[e.day()]:this._weekdaysShort}function jt(e){return!0===e?It(this._weekdaysMin,this._week.dow):e?this._weekdaysMin[e.day()]:this._weekdaysMin}function Wt(e,t,r){var n,i,o,a=e.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],n=0;n<7;++n)o=g([2e3,1]).day(n),this._minWeekdaysParse[n]=this.weekdaysMin(o,"").toLocaleLowerCase(),this._shortWeekdaysParse[n]=this.weekdaysShort(o,"").toLocaleLowerCase(),this._weekdaysParse[n]=this.weekdays(o,"").toLocaleLowerCase();return r?"dddd"===t?-1!==(i=$e.call(this._weekdaysParse,a))?i:null:"ddd"===t?-1!==(i=$e.call(this._shortWeekdaysParse,a))?i:null:-1!==(i=$e.call(this._minWeekdaysParse,a))?i:null:"dddd"===t?-1!==(i=$e.call(this._weekdaysParse,a))||-1!==(i=$e.call(this._shortWeekdaysParse,a))||-1!==(i=$e.call(this._minWeekdaysParse,a))?i:null:"ddd"===t?-1!==(i=$e.call(this._shortWeekdaysParse,a))||-1!==(i=$e.call(this._weekdaysParse,a))||-1!==(i=$e.call(this._minWeekdaysParse,a))?i:null:-1!==(i=$e.call(this._minWeekdaysParse,a))||-1!==(i=$e.call(this._weekdaysParse,a))||-1!==(i=$e.call(this._shortWeekdaysParse,a))?i:null}function Vt(e,t,r){var n,i,o;if(this._weekdaysParseExact)return Wt.call(this,e,t,r);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),n=0;n<7;n++){if(i=g([2e3,1]).day(n),r&&!this._fullWeekdaysParse[n]&&(this._fullWeekdaysParse[n]=new RegExp("^"+this.weekdays(i,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[n]=new RegExp("^"+this.weekdaysShort(i,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[n]=new RegExp("^"+this.weekdaysMin(i,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[n]||(o="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[n]=new RegExp(o.replace(".",""),"i")),r&&"dddd"===t&&this._fullWeekdaysParse[n].test(e))return n;if(r&&"ddd"===t&&this._shortWeekdaysParse[n].test(e))return n;if(r&&"dd"===t&&this._minWeekdaysParse[n].test(e))return n;if(!r&&this._weekdaysParse[n].test(e))return n}}function zt(e){if(!this.isValid())return null!=e?this:NaN;var t=Je(this,"Day");return null!=e?(e=Ot(e,this.localeData()),this.add(e-t,"d")):t}function qt(e){if(!this.isValid())return null!=e?this:NaN;var t=(this.day()+7-this.localeData()._week.dow)%7;return null==e?t:this.add(e-t,"d")}function Gt(e){if(!this.isValid())return null!=e?this:NaN;if(null!=e){var t=Mt(e,this.localeData());return this.day(this.day()%7?t:t-7)}return this.day()||7}function $t(e){return this._weekdaysParseExact?(s(this,"_weekdaysRegex")||Xt.call(this),e?this._weekdaysStrictRegex:this._weekdaysRegex):(s(this,"_weekdaysRegex")||(this._weekdaysRegex=Ft),this._weekdaysStrictRegex&&e?this._weekdaysStrictRegex:this._weekdaysRegex)}function Kt(e){return this._weekdaysParseExact?(s(this,"_weekdaysRegex")||Xt.call(this),e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(s(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=Lt),this._weekdaysShortStrictRegex&&e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function Yt(e){return this._weekdaysParseExact?(s(this,"_weekdaysRegex")||Xt.call(this),e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(s(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=Ht),this._weekdaysMinStrictRegex&&e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function Xt(){function e(e,t){return t.length-e.length}var t,r,n,i,o,a=[],s=[],l=[],c=[];for(t=0;t<7;t++)r=g([2e3,1]).day(t),n=Re(this.weekdaysMin(r,"")),i=Re(this.weekdaysShort(r,"")),o=Re(this.weekdays(r,"")),a.push(n),s.push(i),l.push(o),c.push(n),c.push(i),c.push(o);a.sort(e),s.sort(e),l.sort(e),c.sort(e),this._weekdaysRegex=new RegExp("^("+c.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+l.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+s.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+a.join("|")+")","i")}function Jt(){return this.hours()%12||12}function Zt(){return this.hours()||24}function Qt(e,t){U(e,0,0,(function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)}))}function er(e,t){return t._meridiemParse}function tr(e){return"p"===(e+"").toLowerCase().charAt(0)}U("H",["HH",2],0,"hour"),U("h",["hh",2],0,Jt),U("k",["kk",2],0,Zt),U("hmm",0,0,(function(){return""+Jt.apply(this)+D(this.minutes(),2)})),U("hmmss",0,0,(function(){return""+Jt.apply(this)+D(this.minutes(),2)+D(this.seconds(),2)})),U("Hmm",0,0,(function(){return""+this.hours()+D(this.minutes(),2)})),U("Hmmss",0,0,(function(){return""+this.hours()+D(this.minutes(),2)+D(this.seconds(),2)})),Qt("a",!0),Qt("A",!1),Te("a",er),Te("A",er),Te("H",de,Ee),Te("h",de,xe),Te("k",de,xe),Te("HH",de,le),Te("hh",de,le),Te("kk",de,le),Te("hmm",fe),Te("hmmss",ge),Te("Hmm",fe),Te("Hmmss",ge),Pe(["H","HH"],Ue),Pe(["k","kk"],(function(e,t,r){var n=Me(e);t[Ue]=24===n?0:n})),Pe(["a","A"],(function(e,t,r){r._isPm=r._locale.isPM(e),r._meridiem=e})),Pe(["h","hh"],(function(e,t,r){t[Ue]=Me(e),m(r).bigHour=!0})),Pe("hmm",(function(e,t,r){var n=e.length-2;t[Ue]=Me(e.substr(0,n)),t[je]=Me(e.substr(n)),m(r).bigHour=!0})),Pe("hmmss",(function(e,t,r){var n=e.length-4,i=e.length-2;t[Ue]=Me(e.substr(0,n)),t[je]=Me(e.substr(n,2)),t[We]=Me(e.substr(i)),m(r).bigHour=!0})),Pe("Hmm",(function(e,t,r){var n=e.length-2;t[Ue]=Me(e.substr(0,n)),t[je]=Me(e.substr(n))})),Pe("Hmmss",(function(e,t,r){var n=e.length-4,i=e.length-2;t[Ue]=Me(e.substr(0,n)),t[je]=Me(e.substr(n,2)),t[We]=Me(e.substr(i))}));var rr=/[ap]\.?m?\.?/i,nr=Xe("Hours",!0);function ir(e,t,r){return e>11?r?"pm":"PM":r?"am":"AM"}var or,ar={calendar:P,longDateFormat:q,invalidDate:$,ordinal:Y,dayOfMonthOrdinalParse:X,relativeTime:Z,months:nt,monthsShort:it,week:Et,weekdays:Pt,weekdaysMin:Dt,weekdaysShort:Nt,meridiemParse:rr},sr={},lr={};function cr(e,t){var r,n=Math.min(e.length,t.length);for(r=0;r<n;r+=1)if(e[r]!==t[r])return r;return n}function ur(e){return e?e.toLowerCase().replace("_","-"):e}function hr(e){for(var t,r,n,i,o=0;o<e.length;){for(t=(i=ur(e[o]).split("-")).length,r=(r=ur(e[o+1]))?r.split("-"):null;t>0;){if(n=fr(i.slice(0,t).join("-")))return n;if(r&&r.length>=t&&cr(i,r)>=t-1)break;t--}o++}return or}function dr(e){return!(!e||!e.match("^[^/\\\\]*$"))}function fr(t){var r=null;if(void 0===sr[t]&&e&&e.exports&&dr(t))try{r=or._abbr,Object(function(){var e=new Error("Cannot find module 'undefined'");throw e.code="MODULE_NOT_FOUND",e}()),gr(r)}catch(n){sr[t]=null}return sr[t]}function gr(e,t){var r;return e&&((r=c(t)?vr(e):pr(e,t))?or=r:"undefined"!==typeof console&&console.warn&&console.warn("Locale "+e+" not found. Did you forget to load it?")),or._abbr}function pr(e,t){if(null!==t){var r,n=ar;if(t.abbr=e,null!=sr[e])A("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),n=sr[e]._config;else if(null!=t.parentLocale)if(null!=sr[t.parentLocale])n=sr[t.parentLocale]._config;else{if(null==(r=fr(t.parentLocale)))return lr[t.parentLocale]||(lr[t.parentLocale]=[]),lr[t.parentLocale].push({name:e,config:t}),null;n=r._config}return sr[e]=new I(M(n,t)),lr[e]&&lr[e].forEach((function(e){pr(e.name,e.config)})),gr(e),sr[e]}return delete sr[e],null}function mr(e,t){if(null!=t){var r,n,i=ar;null!=sr[e]&&null!=sr[e].parentLocale?sr[e].set(M(sr[e]._config,t)):(null!=(n=fr(e))&&(i=n._config),t=M(i,t),null==n&&(t.abbr=e),(r=new I(t)).parentLocale=sr[e],sr[e]=r),gr(e)}else null!=sr[e]&&(null!=sr[e].parentLocale?(sr[e]=sr[e].parentLocale,e===gr()&&gr(e)):null!=sr[e]&&delete sr[e]);return sr[e]}function vr(e){var t;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return or;if(!o(e)){if(t=fr(e))return t;e=[e]}return hr(e)}function br(){return T(sr)}function yr(e){var t,r=e._a;return r&&-2===m(e).overflow&&(t=r[He]<0||r[He]>11?He:r[Be]<1||r[Be]>rt(r[Le],r[He])?Be:r[Ue]<0||r[Ue]>24||24===r[Ue]&&(0!==r[je]||0!==r[We]||0!==r[Ve])?Ue:r[je]<0||r[je]>59?je:r[We]<0||r[We]>59?We:r[Ve]<0||r[Ve]>999?Ve:-1,m(e)._overflowDayOfYear&&(t<Le||t>Be)&&(t=Be),m(e)._overflowWeeks&&-1===t&&(t=ze),m(e)._overflowWeekday&&-1===t&&(t=qe),m(e).overflow=t),e}var wr=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Sr=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Cr=/Z|[+-]\d\d(?::?\d\d)?/,kr=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],xr=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],Er=/^\/?Date\((-?\d+)/i,Tr=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,_r={UT:0,GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};function Ar(e){var t,r,n,i,o,a,s=e._i,l=wr.exec(s)||Sr.exec(s),c=kr.length,u=xr.length;if(l){for(m(e).iso=!0,t=0,r=c;t<r;t++)if(kr[t][1].exec(l[1])){i=kr[t][0],n=!1!==kr[t][2];break}if(null==i)return void(e._isValid=!1);if(l[3]){for(t=0,r=u;t<r;t++)if(xr[t][1].exec(l[3])){o=(l[2]||" ")+xr[t][0];break}if(null==o)return void(e._isValid=!1)}if(!n&&null!=o)return void(e._isValid=!1);if(l[4]){if(!Cr.exec(l[4]))return void(e._isValid=!1);a="Z"}e._f=i+(o||"")+(a||""),Ur(e)}else e._isValid=!1}function Rr(e,t,r,n,i,o){var a=[Or(e),it.indexOf(t),parseInt(r,10),parseInt(n,10),parseInt(i,10)];return o&&a.push(parseInt(o,10)),a}function Or(e){var t=parseInt(e,10);return t<=49?2e3+t:t<=999?1900+t:t}function Mr(e){return e.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function Ir(e,t,r){return!e||Nt.indexOf(e)===new Date(t[0],t[1],t[2]).getDay()||(m(r).weekdayMismatch=!0,r._isValid=!1,!1)}function Pr(e,t,r){if(e)return _r[e];if(t)return 0;var n=parseInt(r,10),i=n%100;return(n-i)/100*60+i}function Nr(e){var t,r=Tr.exec(Mr(e._i));if(r){if(t=Rr(r[4],r[3],r[2],r[5],r[6],r[7]),!Ir(r[1],t,e))return;e._a=t,e._tzm=Pr(r[8],r[9],r[10]),e._d=yt.apply(null,e._a),e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),m(e).rfc2822=!0}else e._isValid=!1}function Dr(e){var t=Er.exec(e._i);null===t?(Ar(e),!1===e._isValid&&(delete e._isValid,Nr(e),!1===e._isValid&&(delete e._isValid,e._strict?e._isValid=!1:n.createFromInputFallback(e)))):e._d=new Date(+t[1])}function Fr(e,t,r){return null!=e?e:null!=t?t:r}function Lr(e){var t=new Date(n.now());return e._useUTC?[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]:[t.getFullYear(),t.getMonth(),t.getDate()]}function Hr(e){var t,r,n,i,o,a=[];if(!e._d){for(n=Lr(e),e._w&&null==e._a[Be]&&null==e._a[He]&&Br(e),null!=e._dayOfYear&&(o=Fr(e._a[Le],n[Le]),(e._dayOfYear>Ge(o)||0===e._dayOfYear)&&(m(e)._overflowDayOfYear=!0),r=yt(o,0,e._dayOfYear),e._a[He]=r.getUTCMonth(),e._a[Be]=r.getUTCDate()),t=0;t<3&&null==e._a[t];++t)e._a[t]=a[t]=n[t];for(;t<7;t++)e._a[t]=a[t]=null==e._a[t]?2===t?1:0:e._a[t];24===e._a[Ue]&&0===e._a[je]&&0===e._a[We]&&0===e._a[Ve]&&(e._nextDay=!0,e._a[Ue]=0),e._d=(e._useUTC?yt:bt).apply(null,a),i=e._useUTC?e._d.getUTCDay():e._d.getDay(),null!=e._tzm&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[Ue]=24),e._w&&"undefined"!==typeof e._w.d&&e._w.d!==i&&(m(e).weekdayMismatch=!0)}}function Br(e){var t,r,n,i,o,a,s,l,c;null!=(t=e._w).GG||null!=t.W||null!=t.E?(o=1,a=4,r=Fr(t.GG,e._a[Le],Ct(Kr(),1,4).year),n=Fr(t.W,1),((i=Fr(t.E,1))<1||i>7)&&(l=!0)):(o=e._locale._week.dow,a=e._locale._week.doy,c=Ct(Kr(),o,a),r=Fr(t.gg,e._a[Le],c.year),n=Fr(t.w,c.week),null!=t.d?((i=t.d)<0||i>6)&&(l=!0):null!=t.e?(i=t.e+o,(t.e<0||t.e>6)&&(l=!0)):i=o),n<1||n>kt(r,o,a)?m(e)._overflowWeeks=!0:null!=l?m(e)._overflowWeekday=!0:(s=St(r,n,i,o,a),e._a[Le]=s.year,e._dayOfYear=s.dayOfYear)}function Ur(e){if(e._f!==n.ISO_8601)if(e._f!==n.RFC_2822){e._a=[],m(e).empty=!0;var t,r,i,o,a,s,l,c=""+e._i,u=c.length,h=0;for(l=(i=z(e._f,e._locale).match(F)||[]).length,t=0;t<l;t++)o=i[t],(r=(c.match(_e(o,e))||[])[0])&&((a=c.substr(0,c.indexOf(r))).length>0&&m(e).unusedInput.push(a),c=c.slice(c.indexOf(r)+r.length),h+=r.length),B[o]?(r?m(e).empty=!1:m(e).unusedTokens.push(o),De(o,r,e)):e._strict&&!r&&m(e).unusedTokens.push(o);m(e).charsLeftOver=u-h,c.length>0&&m(e).unusedInput.push(c),e._a[Ue]<=12&&!0===m(e).bigHour&&e._a[Ue]>0&&(m(e).bigHour=void 0),m(e).parsedDateParts=e._a.slice(0),m(e).meridiem=e._meridiem,e._a[Ue]=jr(e._locale,e._a[Ue],e._meridiem),null!==(s=m(e).era)&&(e._a[Le]=e._locale.erasConvertYear(s,e._a[Le])),Hr(e),yr(e)}else Nr(e);else Ar(e)}function jr(e,t,r){var n;return null==r?t:null!=e.meridiemHour?e.meridiemHour(t,r):null!=e.isPM?((n=e.isPM(r))&&t<12&&(t+=12),n||12!==t||(t=0),t):t}function Wr(e){var t,r,n,i,o,a,s=!1,l=e._f.length;if(0===l)return m(e).invalidFormat=!0,void(e._d=new Date(NaN));for(i=0;i<l;i++)o=0,a=!1,t=S({},e),null!=e._useUTC&&(t._useUTC=e._useUTC),t._f=e._f[i],Ur(t),v(t)&&(a=!0),o+=m(t).charsLeftOver,o+=10*m(t).unusedTokens.length,m(t).score=o,s?o<n&&(n=o,r=t):(null==n||o<n||a)&&(n=o,r=t,a&&(s=!0));f(e,r||t)}function Vr(e){if(!e._d){var t=ne(e._i),r=void 0===t.day?t.date:t.day;e._a=d([t.year,t.month,r,t.hour,t.minute,t.second,t.millisecond],(function(e){return e&&parseInt(e,10)})),Hr(e)}}function zr(e){var t=new C(yr(qr(e)));return t._nextDay&&(t.add(1,"d"),t._nextDay=void 0),t}function qr(e){var t=e._i,r=e._f;return e._locale=e._locale||vr(e._l),null===t||void 0===r&&""===t?b({nullInput:!0}):("string"===typeof t&&(e._i=t=e._locale.preparse(t)),k(t)?new C(yr(t)):(h(t)?e._d=t:o(r)?Wr(e):r?Ur(e):Gr(e),v(e)||(e._d=null),e))}function Gr(e){var t=e._i;c(t)?e._d=new Date(n.now()):h(t)?e._d=new Date(t.valueOf()):"string"===typeof t?Dr(e):o(t)?(e._a=d(t.slice(0),(function(e){return parseInt(e,10)})),Hr(e)):a(t)?Vr(e):u(t)?e._d=new Date(t):n.createFromInputFallback(e)}function $r(e,t,r,n,i){var s={};return!0!==t&&!1!==t||(n=t,t=void 0),!0!==r&&!1!==r||(n=r,r=void 0),(a(e)&&l(e)||o(e)&&0===e.length)&&(e=void 0),s._isAMomentObject=!0,s._useUTC=s._isUTC=i,s._l=r,s._i=e,s._f=t,s._strict=n,zr(s)}function Kr(e,t,r,n){return $r(e,t,r,n,!1)}n.createFromInputFallback=E("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",(function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))})),n.ISO_8601=function(){},n.RFC_2822=function(){};var Yr=E("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",(function(){var e=Kr.apply(null,arguments);return this.isValid()&&e.isValid()?e<this?this:e:b()})),Xr=E("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",(function(){var e=Kr.apply(null,arguments);return this.isValid()&&e.isValid()?e>this?this:e:b()}));function Jr(e,t){var r,n;if(1===t.length&&o(t[0])&&(t=t[0]),!t.length)return Kr();for(r=t[0],n=1;n<t.length;++n)t[n].isValid()&&!t[n][e](r)||(r=t[n]);return r}function Zr(){return Jr("isBefore",[].slice.call(arguments,0))}function Qr(){return Jr("isAfter",[].slice.call(arguments,0))}var en=function(){return Date.now?Date.now():+new Date},tn=["year","quarter","month","week","day","hour","minute","second","millisecond"];function rn(e){var t,r,n=!1,i=tn.length;for(t in e)if(s(e,t)&&(-1===$e.call(tn,t)||null!=e[t]&&isNaN(e[t])))return!1;for(r=0;r<i;++r)if(e[tn[r]]){if(n)return!1;parseFloat(e[tn[r]])!==Me(e[tn[r]])&&(n=!0)}return!0}function nn(){return this._isValid}function on(){return An(NaN)}function an(e){var t=ne(e),r=t.year||0,n=t.quarter||0,i=t.month||0,o=t.week||t.isoWeek||0,a=t.day||0,s=t.hour||0,l=t.minute||0,c=t.second||0,u=t.millisecond||0;this._isValid=rn(t),this._milliseconds=+u+1e3*c+6e4*l+1e3*s*60*60,this._days=+a+7*o,this._months=+i+3*n+12*r,this._data={},this._locale=vr(),this._bubble()}function sn(e){return e instanceof an}function ln(e){return e<0?-1*Math.round(-1*e):Math.round(e)}function cn(e,t,r){var n,i=Math.min(e.length,t.length),o=Math.abs(e.length-t.length),a=0;for(n=0;n<i;n++)(r&&e[n]!==t[n]||!r&&Me(e[n])!==Me(t[n]))&&a++;return a+o}function un(e,t){U(e,0,0,(function(){var e=this.utcOffset(),r="+";return e<0&&(e=-e,r="-"),r+D(~~(e/60),2)+t+D(~~e%60,2)}))}un("Z",":"),un("ZZ",""),Te("Z",Se),Te("ZZ",Se),Pe(["Z","ZZ"],(function(e,t,r){r._useUTC=!0,r._tzm=dn(Se,e)}));var hn=/([\+\-]|\d\d)/gi;function dn(e,t){var r,n,i=(t||"").match(e);return null===i?null:0===(n=60*(r=((i[i.length-1]||[])+"").match(hn)||["-",0,0])[1]+Me(r[2]))?0:"+"===r[0]?n:-n}function fn(e,t){var r,i;return t._isUTC?(r=t.clone(),i=(k(e)||h(e)?e.valueOf():Kr(e).valueOf())-r.valueOf(),r._d.setTime(r._d.valueOf()+i),n.updateOffset(r,!1),r):Kr(e).local()}function gn(e){return-Math.round(e._d.getTimezoneOffset())}function pn(e,t,r){var i,o=this._offset||0;if(!this.isValid())return null!=e?this:NaN;if(null!=e){if("string"===typeof e){if(null===(e=dn(Se,e)))return this}else Math.abs(e)<16&&!r&&(e*=60);return!this._isUTC&&t&&(i=gn(this)),this._offset=e,this._isUTC=!0,null!=i&&this.add(i,"m"),o!==e&&(!t||this._changeInProgress?Pn(this,An(e-o,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,n.updateOffset(this,!0),this._changeInProgress=null)),this}return this._isUTC?o:gn(this)}function mn(e,t){return null!=e?("string"!==typeof e&&(e=-e),this.utcOffset(e,t),this):-this.utcOffset()}function vn(e){return this.utcOffset(0,e)}function bn(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(gn(this),"m")),this}function yn(){if(null!=this._tzm)this.utcOffset(this._tzm,!1,!0);else if("string"===typeof this._i){var e=dn(we,this._i);null!=e?this.utcOffset(e):this.utcOffset(0,!0)}return this}function wn(e){return!!this.isValid()&&(e=e?Kr(e).utcOffset():0,(this.utcOffset()-e)%60===0)}function Sn(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function Cn(){if(!c(this._isDSTShifted))return this._isDSTShifted;var e,t={};return S(t,this),(t=qr(t))._a?(e=t._isUTC?g(t._a):Kr(t._a),this._isDSTShifted=this.isValid()&&cn(t._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function kn(){return!!this.isValid()&&!this._isUTC}function xn(){return!!this.isValid()&&this._isUTC}function En(){return!!this.isValid()&&this._isUTC&&0===this._offset}n.updateOffset=function(){};var Tn=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,_n=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function An(e,t){var r,n,i,o=e,a=null;return sn(e)?o={ms:e._milliseconds,d:e._days,M:e._months}:u(e)||!isNaN(+e)?(o={},t?o[t]=+e:o.milliseconds=+e):(a=Tn.exec(e))?(r="-"===a[1]?-1:1,o={y:0,d:Me(a[Be])*r,h:Me(a[Ue])*r,m:Me(a[je])*r,s:Me(a[We])*r,ms:Me(ln(1e3*a[Ve]))*r}):(a=_n.exec(e))?(r="-"===a[1]?-1:1,o={y:Rn(a[2],r),M:Rn(a[3],r),w:Rn(a[4],r),d:Rn(a[5],r),h:Rn(a[6],r),m:Rn(a[7],r),s:Rn(a[8],r)}):null==o?o={}:"object"===typeof o&&("from"in o||"to"in o)&&(i=Mn(Kr(o.from),Kr(o.to)),(o={}).ms=i.milliseconds,o.M=i.months),n=new an(o),sn(e)&&s(e,"_locale")&&(n._locale=e._locale),sn(e)&&s(e,"_isValid")&&(n._isValid=e._isValid),n}function Rn(e,t){var r=e&&parseFloat(e.replace(",","."));return(isNaN(r)?0:r)*t}function On(e,t){var r={};return r.months=t.month()-e.month()+12*(t.year()-e.year()),e.clone().add(r.months,"M").isAfter(t)&&--r.months,r.milliseconds=+t-+e.clone().add(r.months,"M"),r}function Mn(e,t){var r;return e.isValid()&&t.isValid()?(t=fn(t,e),e.isBefore(t)?r=On(e,t):((r=On(t,e)).milliseconds=-r.milliseconds,r.months=-r.months),r):{milliseconds:0,months:0}}function In(e,t){return function(r,n){var i;return null===n||isNaN(+n)||(A(t,"moment()."+t+"(period, number) is deprecated. Please use moment()."+t+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),i=r,r=n,n=i),Pn(this,An(r,n),e),this}}function Pn(e,t,r,i){var o=t._milliseconds,a=ln(t._days),s=ln(t._months);e.isValid()&&(i=null==i||i,s&&dt(e,Je(e,"Month")+s*r),a&&Ze(e,"Date",Je(e,"Date")+a*r),o&&e._d.setTime(e._d.valueOf()+o*r),i&&n.updateOffset(e,a||s))}An.fn=an.prototype,An.invalid=on;var Nn=In(1,"add"),Dn=In(-1,"subtract");function Fn(e){return"string"===typeof e||e instanceof String}function Ln(e){return k(e)||h(e)||Fn(e)||u(e)||Bn(e)||Hn(e)||null===e||void 0===e}function Hn(e){var t,r,n=a(e)&&!l(e),i=!1,o=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],c=o.length;for(t=0;t<c;t+=1)r=o[t],i=i||s(e,r);return n&&i}function Bn(e){var t=o(e),r=!1;return t&&(r=0===e.filter((function(t){return!u(t)&&Fn(e)})).length),t&&r}function Un(e){var t,r,n=a(e)&&!l(e),i=!1,o=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"];for(t=0;t<o.length;t+=1)r=o[t],i=i||s(e,r);return n&&i}function jn(e,t){var r=e.diff(t,"days",!0);return r<-6?"sameElse":r<-1?"lastWeek":r<0?"lastDay":r<1?"sameDay":r<2?"nextDay":r<7?"nextWeek":"sameElse"}function Wn(e,t){1===arguments.length&&(arguments[0]?Ln(arguments[0])?(e=arguments[0],t=void 0):Un(arguments[0])&&(t=arguments[0],e=void 0):(e=void 0,t=void 0));var r=e||Kr(),i=fn(r,this).startOf("day"),o=n.calendarFormat(this,i)||"sameElse",a=t&&(R(t[o])?t[o].call(this,r):t[o]);return this.format(a||this.localeData().calendar(o,this,Kr(r)))}function Vn(){return new C(this)}function zn(e,t){var r=k(e)?e:Kr(e);return!(!this.isValid()||!r.isValid())&&("millisecond"===(t=re(t)||"millisecond")?this.valueOf()>r.valueOf():r.valueOf()<this.clone().startOf(t).valueOf())}function qn(e,t){var r=k(e)?e:Kr(e);return!(!this.isValid()||!r.isValid())&&("millisecond"===(t=re(t)||"millisecond")?this.valueOf()<r.valueOf():this.clone().endOf(t).valueOf()<r.valueOf())}function Gn(e,t,r,n){var i=k(e)?e:Kr(e),o=k(t)?t:Kr(t);return!!(this.isValid()&&i.isValid()&&o.isValid())&&("("===(n=n||"()")[0]?this.isAfter(i,r):!this.isBefore(i,r))&&(")"===n[1]?this.isBefore(o,r):!this.isAfter(o,r))}function $n(e,t){var r,n=k(e)?e:Kr(e);return!(!this.isValid()||!n.isValid())&&("millisecond"===(t=re(t)||"millisecond")?this.valueOf()===n.valueOf():(r=n.valueOf(),this.clone().startOf(t).valueOf()<=r&&r<=this.clone().endOf(t).valueOf()))}function Kn(e,t){return this.isSame(e,t)||this.isAfter(e,t)}function Yn(e,t){return this.isSame(e,t)||this.isBefore(e,t)}function Xn(e,t,r){var n,i,o;if(!this.isValid())return NaN;if(!(n=fn(e,this)).isValid())return NaN;switch(i=6e4*(n.utcOffset()-this.utcOffset()),t=re(t)){case"year":o=Jn(this,n)/12;break;case"month":o=Jn(this,n);break;case"quarter":o=Jn(this,n)/3;break;case"second":o=(this-n)/1e3;break;case"minute":o=(this-n)/6e4;break;case"hour":o=(this-n)/36e5;break;case"day":o=(this-n-i)/864e5;break;case"week":o=(this-n-i)/6048e5;break;default:o=this-n}return r?o:Oe(o)}function Jn(e,t){if(e.date()<t.date())return-Jn(t,e);var r=12*(t.year()-e.year())+(t.month()-e.month()),n=e.clone().add(r,"months");return-(r+(t-n<0?(t-n)/(n-e.clone().add(r-1,"months")):(t-n)/(e.clone().add(r+1,"months")-n)))||0}function Zn(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function Qn(e){if(!this.isValid())return null;var t=!0!==e,r=t?this.clone().utc():this;return r.year()<0||r.year()>9999?V(r,t?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):R(Date.prototype.toISOString)?t?this.toDate().toISOString():new Date(this.valueOf()+60*this.utcOffset()*1e3).toISOString().replace("Z",V(r,"Z")):V(r,t?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function ei(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var e,t,r,n,i="moment",o="";return this.isLocal()||(i=0===this.utcOffset()?"moment.utc":"moment.parseZone",o="Z"),e="["+i+'("]',t=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",r="-MM-DD[T]HH:mm:ss.SSS",n=o+'[")]',this.format(e+t+r+n)}function ti(e){e||(e=this.isUtc()?n.defaultFormatUtc:n.defaultFormat);var t=V(this,e);return this.localeData().postformat(t)}function ri(e,t){return this.isValid()&&(k(e)&&e.isValid()||Kr(e).isValid())?An({to:this,from:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function ni(e){return this.from(Kr(),e)}function ii(e,t){return this.isValid()&&(k(e)&&e.isValid()||Kr(e).isValid())?An({from:this,to:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function oi(e){return this.to(Kr(),e)}function ai(e){var t;return void 0===e?this._locale._abbr:(null!=(t=vr(e))&&(this._locale=t),this)}n.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",n.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";var si=E("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",(function(e){return void 0===e?this.localeData():this.locale(e)}));function li(){return this._locale}var ci=1e3,ui=60*ci,hi=60*ui,di=3506328*hi;function fi(e,t){return(e%t+t)%t}function gi(e,t,r){return e<100&&e>=0?new Date(e+400,t,r)-di:new Date(e,t,r).valueOf()}function pi(e,t,r){return e<100&&e>=0?Date.UTC(e+400,t,r)-di:Date.UTC(e,t,r)}function mi(e){var t,r;if(void 0===(e=re(e))||"millisecond"===e||!this.isValid())return this;switch(r=this._isUTC?pi:gi,e){case"year":t=r(this.year(),0,1);break;case"quarter":t=r(this.year(),this.month()-this.month()%3,1);break;case"month":t=r(this.year(),this.month(),1);break;case"week":t=r(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":t=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":t=r(this.year(),this.month(),this.date());break;case"hour":t=this._d.valueOf(),t-=fi(t+(this._isUTC?0:this.utcOffset()*ui),hi);break;case"minute":t=this._d.valueOf(),t-=fi(t,ui);break;case"second":t=this._d.valueOf(),t-=fi(t,ci)}return this._d.setTime(t),n.updateOffset(this,!0),this}function vi(e){var t,r;if(void 0===(e=re(e))||"millisecond"===e||!this.isValid())return this;switch(r=this._isUTC?pi:gi,e){case"year":t=r(this.year()+1,0,1)-1;break;case"quarter":t=r(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":t=r(this.year(),this.month()+1,1)-1;break;case"week":t=r(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":t=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":t=r(this.year(),this.month(),this.date()+1)-1;break;case"hour":t=this._d.valueOf(),t+=hi-fi(t+(this._isUTC?0:this.utcOffset()*ui),hi)-1;break;case"minute":t=this._d.valueOf(),t+=ui-fi(t,ui)-1;break;case"second":t=this._d.valueOf(),t+=ci-fi(t,ci)-1}return this._d.setTime(t),n.updateOffset(this,!0),this}function bi(){return this._d.valueOf()-6e4*(this._offset||0)}function yi(){return Math.floor(this.valueOf()/1e3)}function wi(){return new Date(this.valueOf())}function Si(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]}function Ci(){var e=this;return{years:e.year(),months:e.month(),date:e.date(),hours:e.hours(),minutes:e.minutes(),seconds:e.seconds(),milliseconds:e.milliseconds()}}function ki(){return this.isValid()?this.toISOString():null}function xi(){return v(this)}function Ei(){return f({},m(this))}function Ti(){return m(this).overflow}function _i(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}function Ai(e,t){var r,i,o,a=this._eras||vr("en")._eras;for(r=0,i=a.length;r<i;++r)switch("string"===typeof a[r].since&&(o=n(a[r].since).startOf("day"),a[r].since=o.valueOf()),typeof a[r].until){case"undefined":a[r].until=1/0;break;case"string":o=n(a[r].until).startOf("day").valueOf(),a[r].until=o.valueOf()}return a}function Ri(e,t,r){var n,i,o,a,s,l=this.eras();for(e=e.toUpperCase(),n=0,i=l.length;n<i;++n)if(o=l[n].name.toUpperCase(),a=l[n].abbr.toUpperCase(),s=l[n].narrow.toUpperCase(),r)switch(t){case"N":case"NN":case"NNN":if(a===e)return l[n];break;case"NNNN":if(o===e)return l[n];break;case"NNNNN":if(s===e)return l[n]}else if([o,a,s].indexOf(e)>=0)return l[n]}function Oi(e,t){var r=e.since<=e.until?1:-1;return void 0===t?n(e.since).year():n(e.since).year()+(t-e.offset)*r}function Mi(){var e,t,r,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e){if(r=this.clone().startOf("day").valueOf(),n[e].since<=r&&r<=n[e].until)return n[e].name;if(n[e].until<=r&&r<=n[e].since)return n[e].name}return""}function Ii(){var e,t,r,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e){if(r=this.clone().startOf("day").valueOf(),n[e].since<=r&&r<=n[e].until)return n[e].narrow;if(n[e].until<=r&&r<=n[e].since)return n[e].narrow}return""}function Pi(){var e,t,r,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e){if(r=this.clone().startOf("day").valueOf(),n[e].since<=r&&r<=n[e].until)return n[e].abbr;if(n[e].until<=r&&r<=n[e].since)return n[e].abbr}return""}function Ni(){var e,t,r,i,o=this.localeData().eras();for(e=0,t=o.length;e<t;++e)if(r=o[e].since<=o[e].until?1:-1,i=this.clone().startOf("day").valueOf(),o[e].since<=i&&i<=o[e].until||o[e].until<=i&&i<=o[e].since)return(this.year()-n(o[e].since).year())*r+o[e].offset;return this.year()}function Di(e){return s(this,"_erasNameRegex")||Wi.call(this),e?this._erasNameRegex:this._erasRegex}function Fi(e){return s(this,"_erasAbbrRegex")||Wi.call(this),e?this._erasAbbrRegex:this._erasRegex}function Li(e){return s(this,"_erasNarrowRegex")||Wi.call(this),e?this._erasNarrowRegex:this._erasRegex}function Hi(e,t){return t.erasAbbrRegex(e)}function Bi(e,t){return t.erasNameRegex(e)}function Ui(e,t){return t.erasNarrowRegex(e)}function ji(e,t){return t._eraYearOrdinalRegex||be}function Wi(){var e,t,r,n,i,o=[],a=[],s=[],l=[],c=this.eras();for(e=0,t=c.length;e<t;++e)r=Re(c[e].name),n=Re(c[e].abbr),i=Re(c[e].narrow),a.push(r),o.push(n),s.push(i),l.push(r),l.push(n),l.push(i);this._erasRegex=new RegExp("^("+l.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+a.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+o.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+s.join("|")+")","i")}function Vi(e,t){U(0,[e,e.length],0,t)}function zi(e){return Xi.call(this,e,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)}function qi(e){return Xi.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)}function Gi(){return kt(this.year(),1,4)}function $i(){return kt(this.isoWeekYear(),1,4)}function Ki(){var e=this.localeData()._week;return kt(this.year(),e.dow,e.doy)}function Yi(){var e=this.localeData()._week;return kt(this.weekYear(),e.dow,e.doy)}function Xi(e,t,r,n,i){var o;return null==e?Ct(this,n,i).year:(t>(o=kt(e,n,i))&&(t=o),Ji.call(this,e,t,r,n,i))}function Ji(e,t,r,n,i){var o=St(e,t,r,n,i),a=yt(o.year,0,o.dayOfYear);return this.year(a.getUTCFullYear()),this.month(a.getUTCMonth()),this.date(a.getUTCDate()),this}function Zi(e){return null==e?Math.ceil((this.month()+1)/3):this.month(3*(e-1)+this.month()%3)}U("N",0,0,"eraAbbr"),U("NN",0,0,"eraAbbr"),U("NNN",0,0,"eraAbbr"),U("NNNN",0,0,"eraName"),U("NNNNN",0,0,"eraNarrow"),U("y",["y",1],"yo","eraYear"),U("y",["yy",2],0,"eraYear"),U("y",["yyy",3],0,"eraYear"),U("y",["yyyy",4],0,"eraYear"),Te("N",Hi),Te("NN",Hi),Te("NNN",Hi),Te("NNNN",Bi),Te("NNNNN",Ui),Pe(["N","NN","NNN","NNNN","NNNNN"],(function(e,t,r,n){var i=r._locale.erasParse(e,n,r._strict);i?m(r).era=i:m(r).invalidEra=e})),Te("y",be),Te("yy",be),Te("yyy",be),Te("yyyy",be),Te("yo",ji),Pe(["y","yy","yyy","yyyy"],Le),Pe(["yo"],(function(e,t,r,n){var i;r._locale._eraYearOrdinalRegex&&(i=e.match(r._locale._eraYearOrdinalRegex)),r._locale.eraYearOrdinalParse?t[Le]=r._locale.eraYearOrdinalParse(e,i):t[Le]=parseInt(e,10)})),U(0,["gg",2],0,(function(){return this.weekYear()%100})),U(0,["GG",2],0,(function(){return this.isoWeekYear()%100})),Vi("gggg","weekYear"),Vi("ggggg","weekYear"),Vi("GGGG","isoWeekYear"),Vi("GGGGG","isoWeekYear"),Te("G",ye),Te("g",ye),Te("GG",de,le),Te("gg",de,le),Te("GGGG",me,ue),Te("gggg",me,ue),Te("GGGGG",ve,he),Te("ggggg",ve,he),Ne(["gggg","ggggg","GGGG","GGGGG"],(function(e,t,r,n){t[n.substr(0,2)]=Me(e)})),Ne(["gg","GG"],(function(e,t,r,i){t[i]=n.parseTwoDigitYear(e)})),U("Q",0,"Qo","quarter"),Te("Q",se),Pe("Q",(function(e,t){t[He]=3*(Me(e)-1)})),U("D",["DD",2],"Do","date"),Te("D",de,xe),Te("DD",de,le),Te("Do",(function(e,t){return e?t._dayOfMonthOrdinalParse||t._ordinalParse:t._dayOfMonthOrdinalParseLenient})),Pe(["D","DD"],Be),Pe("Do",(function(e,t){t[Be]=Me(e.match(de)[0])}));var Qi=Xe("Date",!0);function eo(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return null==e?t:this.add(e-t,"d")}U("DDD",["DDDD",3],"DDDo","dayOfYear"),Te("DDD",pe),Te("DDDD",ce),Pe(["DDD","DDDD"],(function(e,t,r){r._dayOfYear=Me(e)})),U("m",["mm",2],0,"minute"),Te("m",de,Ee),Te("mm",de,le),Pe(["m","mm"],je);var to=Xe("Minutes",!1);U("s",["ss",2],0,"second"),Te("s",de,Ee),Te("ss",de,le),Pe(["s","ss"],We);var ro,no,io=Xe("Seconds",!1);for(U("S",0,0,(function(){return~~(this.millisecond()/100)})),U(0,["SS",2],0,(function(){return~~(this.millisecond()/10)})),U(0,["SSS",3],0,"millisecond"),U(0,["SSSS",4],0,(function(){return 10*this.millisecond()})),U(0,["SSSSS",5],0,(function(){return 100*this.millisecond()})),U(0,["SSSSSS",6],0,(function(){return 1e3*this.millisecond()})),U(0,["SSSSSSS",7],0,(function(){return 1e4*this.millisecond()})),U(0,["SSSSSSSS",8],0,(function(){return 1e5*this.millisecond()})),U(0,["SSSSSSSSS",9],0,(function(){return 1e6*this.millisecond()})),Te("S",pe,se),Te("SS",pe,le),Te("SSS",pe,ce),ro="SSSS";ro.length<=9;ro+="S")Te(ro,be);function oo(e,t){t[Ve]=Me(1e3*("0."+e))}for(ro="S";ro.length<=9;ro+="S")Pe(ro,oo);function ao(){return this._isUTC?"UTC":""}function so(){return this._isUTC?"Coordinated Universal Time":""}no=Xe("Milliseconds",!1),U("z",0,0,"zoneAbbr"),U("zz",0,0,"zoneName");var lo=C.prototype;function co(e){return Kr(1e3*e)}function uo(){return Kr.apply(null,arguments).parseZone()}function ho(e){return e}lo.add=Nn,lo.calendar=Wn,lo.clone=Vn,lo.diff=Xn,lo.endOf=vi,lo.format=ti,lo.from=ri,lo.fromNow=ni,lo.to=ii,lo.toNow=oi,lo.get=Qe,lo.invalidAt=Ti,lo.isAfter=zn,lo.isBefore=qn,lo.isBetween=Gn,lo.isSame=$n,lo.isSameOrAfter=Kn,lo.isSameOrBefore=Yn,lo.isValid=xi,lo.lang=si,lo.locale=ai,lo.localeData=li,lo.max=Xr,lo.min=Yr,lo.parsingFlags=Ei,lo.set=et,lo.startOf=mi,lo.subtract=Dn,lo.toArray=Si,lo.toObject=Ci,lo.toDate=wi,lo.toISOString=Qn,lo.inspect=ei,"undefined"!==typeof Symbol&&null!=Symbol.for&&(lo[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"}),lo.toJSON=ki,lo.toString=Zn,lo.unix=yi,lo.valueOf=bi,lo.creationData=_i,lo.eraName=Mi,lo.eraNarrow=Ii,lo.eraAbbr=Pi,lo.eraYear=Ni,lo.year=Ke,lo.isLeapYear=Ye,lo.weekYear=zi,lo.isoWeekYear=qi,lo.quarter=lo.quarters=Zi,lo.month=ft,lo.daysInMonth=gt,lo.week=lo.weeks=At,lo.isoWeek=lo.isoWeeks=Rt,lo.weeksInYear=Ki,lo.weeksInWeekYear=Yi,lo.isoWeeksInYear=Gi,lo.isoWeeksInISOWeekYear=$i,lo.date=Qi,lo.day=lo.days=zt,lo.weekday=qt,lo.isoWeekday=Gt,lo.dayOfYear=eo,lo.hour=lo.hours=nr,lo.minute=lo.minutes=to,lo.second=lo.seconds=io,lo.millisecond=lo.milliseconds=no,lo.utcOffset=pn,lo.utc=vn,lo.local=bn,lo.parseZone=yn,lo.hasAlignedHourOffset=wn,lo.isDST=Sn,lo.isLocal=kn,lo.isUtcOffset=xn,lo.isUtc=En,lo.isUTC=En,lo.zoneAbbr=ao,lo.zoneName=so,lo.dates=E("dates accessor is deprecated. Use date instead.",Qi),lo.months=E("months accessor is deprecated. Use month instead",ft),lo.years=E("years accessor is deprecated. Use year instead",Ke),lo.zone=E("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",mn),lo.isDSTShifted=E("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",Cn);var fo=I.prototype;function go(e,t,r,n){var i=vr(),o=g().set(n,t);return i[r](o,e)}function po(e,t,r){if(u(e)&&(t=e,e=void 0),e=e||"",null!=t)return go(e,t,r,"month");var n,i=[];for(n=0;n<12;n++)i[n]=go(e,n,r,"month");return i}function mo(e,t,r,n){"boolean"===typeof e?(u(t)&&(r=t,t=void 0),t=t||""):(r=t=e,e=!1,u(t)&&(r=t,t=void 0),t=t||"");var i,o=vr(),a=e?o._week.dow:0,s=[];if(null!=r)return go(t,(r+a)%7,n,"day");for(i=0;i<7;i++)s[i]=go(t,(i+a)%7,n,"day");return s}function vo(e,t){return po(e,t,"months")}function bo(e,t){return po(e,t,"monthsShort")}function yo(e,t,r){return mo(e,t,r,"weekdays")}function wo(e,t,r){return mo(e,t,r,"weekdaysShort")}function So(e,t,r){return mo(e,t,r,"weekdaysMin")}fo.calendar=N,fo.longDateFormat=G,fo.invalidDate=K,fo.ordinal=J,fo.preparse=ho,fo.postformat=ho,fo.relativeTime=Q,fo.pastFuture=ee,fo.set=O,fo.eras=Ai,fo.erasParse=Ri,fo.erasConvertYear=Oi,fo.erasAbbrRegex=Fi,fo.erasNameRegex=Di,fo.erasNarrowRegex=Li,fo.months=lt,fo.monthsShort=ct,fo.monthsParse=ht,fo.monthsRegex=mt,fo.monthsShortRegex=pt,fo.week=xt,fo.firstDayOfYear=_t,fo.firstDayOfWeek=Tt,fo.weekdays=Bt,fo.weekdaysMin=jt,fo.weekdaysShort=Ut,fo.weekdaysParse=Vt,fo.weekdaysRegex=$t,fo.weekdaysShortRegex=Kt,fo.weekdaysMinRegex=Yt,fo.isPM=tr,fo.meridiem=ir,gr("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10;return e+(1===Me(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th")}}),n.lang=E("moment.lang is deprecated. Use moment.locale instead.",gr),n.langData=E("moment.langData is deprecated. Use moment.localeData instead.",vr);var Co=Math.abs;function ko(){var e=this._data;return this._milliseconds=Co(this._milliseconds),this._days=Co(this._days),this._months=Co(this._months),e.milliseconds=Co(e.milliseconds),e.seconds=Co(e.seconds),e.minutes=Co(e.minutes),e.hours=Co(e.hours),e.months=Co(e.months),e.years=Co(e.years),this}function xo(e,t,r,n){var i=An(t,r);return e._milliseconds+=n*i._milliseconds,e._days+=n*i._days,e._months+=n*i._months,e._bubble()}function Eo(e,t){return xo(this,e,t,1)}function To(e,t){return xo(this,e,t,-1)}function _o(e){return e<0?Math.floor(e):Math.ceil(e)}function Ao(){var e,t,r,n,i,o=this._milliseconds,a=this._days,s=this._months,l=this._data;return o>=0&&a>=0&&s>=0||o<=0&&a<=0&&s<=0||(o+=864e5*_o(Oo(s)+a),a=0,s=0),l.milliseconds=o%1e3,e=Oe(o/1e3),l.seconds=e%60,t=Oe(e/60),l.minutes=t%60,r=Oe(t/60),l.hours=r%24,a+=Oe(r/24),s+=i=Oe(Ro(a)),a-=_o(Oo(i)),n=Oe(s/12),s%=12,l.days=a,l.months=s,l.years=n,this}function Ro(e){return 4800*e/146097}function Oo(e){return 146097*e/4800}function Mo(e){if(!this.isValid())return NaN;var t,r,n=this._milliseconds;if("month"===(e=re(e))||"quarter"===e||"year"===e)switch(t=this._days+n/864e5,r=this._months+Ro(t),e){case"month":return r;case"quarter":return r/3;case"year":return r/12}else switch(t=this._days+Math.round(Oo(this._months)),e){case"week":return t/7+n/6048e5;case"day":return t+n/864e5;case"hour":return 24*t+n/36e5;case"minute":return 1440*t+n/6e4;case"second":return 86400*t+n/1e3;case"millisecond":return Math.floor(864e5*t)+n;default:throw new Error("Unknown unit "+e)}}function Io(e){return function(){return this.as(e)}}var Po=Io("ms"),No=Io("s"),Do=Io("m"),Fo=Io("h"),Lo=Io("d"),Ho=Io("w"),Bo=Io("M"),Uo=Io("Q"),jo=Io("y"),Wo=Po;function Vo(){return An(this)}function zo(e){return e=re(e),this.isValid()?this[e+"s"]():NaN}function qo(e){return function(){return this.isValid()?this._data[e]:NaN}}var Go=qo("milliseconds"),$o=qo("seconds"),Ko=qo("minutes"),Yo=qo("hours"),Xo=qo("days"),Jo=qo("months"),Zo=qo("years");function Qo(){return Oe(this.days()/7)}var ea=Math.round,ta={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function ra(e,t,r,n,i){return i.relativeTime(t||1,!!r,e,n)}function na(e,t,r,n){var i=An(e).abs(),o=ea(i.as("s")),a=ea(i.as("m")),s=ea(i.as("h")),l=ea(i.as("d")),c=ea(i.as("M")),u=ea(i.as("w")),h=ea(i.as("y")),d=o<=r.ss&&["s",o]||o<r.s&&["ss",o]||a<=1&&["m"]||a<r.m&&["mm",a]||s<=1&&["h"]||s<r.h&&["hh",s]||l<=1&&["d"]||l<r.d&&["dd",l];return null!=r.w&&(d=d||u<=1&&["w"]||u<r.w&&["ww",u]),(d=d||c<=1&&["M"]||c<r.M&&["MM",c]||h<=1&&["y"]||["yy",h])[2]=t,d[3]=+e>0,d[4]=n,ra.apply(null,d)}function ia(e){return void 0===e?ea:"function"===typeof e&&(ea=e,!0)}function oa(e,t){return void 0!==ta[e]&&(void 0===t?ta[e]:(ta[e]=t,"s"===e&&(ta.ss=t-1),!0))}function aa(e,t){if(!this.isValid())return this.localeData().invalidDate();var r,n,i=!1,o=ta;return"object"===typeof e&&(t=e,e=!1),"boolean"===typeof e&&(i=e),"object"===typeof t&&(o=Object.assign({},ta,t),null!=t.s&&null==t.ss&&(o.ss=t.s-1)),n=na(this,!i,o,r=this.localeData()),i&&(n=r.pastFuture(+this,n)),r.postformat(n)}var sa=Math.abs;function la(e){return(e>0)-(e<0)||+e}function ca(){if(!this.isValid())return this.localeData().invalidDate();var e,t,r,n,i,o,a,s,l=sa(this._milliseconds)/1e3,c=sa(this._days),u=sa(this._months),h=this.asSeconds();return h?(e=Oe(l/60),t=Oe(e/60),l%=60,e%=60,r=Oe(u/12),u%=12,n=l?l.toFixed(3).replace(/\.?0+$/,""):"",i=h<0?"-":"",o=la(this._months)!==la(h)?"-":"",a=la(this._days)!==la(h)?"-":"",s=la(this._milliseconds)!==la(h)?"-":"",i+"P"+(r?o+r+"Y":"")+(u?o+u+"M":"")+(c?a+c+"D":"")+(t||e||l?"T":"")+(t?s+t+"H":"")+(e?s+e+"M":"")+(l?s+n+"S":"")):"P0D"}var ua=an.prototype;return ua.isValid=nn,ua.abs=ko,ua.add=Eo,ua.subtract=To,ua.as=Mo,ua.asMilliseconds=Po,ua.asSeconds=No,ua.asMinutes=Do,ua.asHours=Fo,ua.asDays=Lo,ua.asWeeks=Ho,ua.asMonths=Bo,ua.asQuarters=Uo,ua.asYears=jo,ua.valueOf=Wo,ua._bubble=Ao,ua.clone=Vo,ua.get=zo,ua.milliseconds=Go,ua.seconds=$o,ua.minutes=Ko,ua.hours=Yo,ua.days=Xo,ua.weeks=Qo,ua.months=Jo,ua.years=Zo,ua.humanize=aa,ua.toISOString=ca,ua.toString=ca,ua.toJSON=ca,ua.locale=ai,ua.localeData=li,ua.toIsoString=E("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",ca),ua.lang=si,U("X",0,0,"unix"),U("x",0,0,"valueOf"),Te("x",ye),Te("X",Ce),Pe("X",(function(e,t,r){r._d=new Date(1e3*parseFloat(e))})),Pe("x",(function(e,t,r){r._d=new Date(Me(e))})),n.version="2.30.1",i(Kr),n.fn=lo,n.min=Zr,n.max=Qr,n.now=en,n.utc=g,n.unix=co,n.months=vo,n.isDate=h,n.locale=gr,n.invalid=b,n.duration=An,n.isMoment=k,n.weekdays=yo,n.parseZone=uo,n.localeData=vr,n.isDuration=sn,n.monthsShort=bo,n.weekdaysMin=So,n.defineLocale=pr,n.updateLocale=mr,n.locales=br,n.weekdaysShort=wo,n.normalizeUnits=re,n.relativeTimeRounding=ia,n.relativeTimeThreshold=oa,n.calendarFormat=jn,n.prototype=lo,n.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"},n}()},407:e=>{e.exports=function e(t,r,n){function i(a,s){if(!r[a]){if(!t[a]){if(o)return o(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var c=r[a]={exports:{}};t[a][0].call(c.exports,(function(e){return i(t[a][1][e]||e)}),c,c.exports,e,t,r,n)}return r[a].exports}for(var o=void 0,a=0;a<n.length;a++)i(n[a]);return i}({1:[function(e,t,r){!function(e){"use strict";var r,n=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,i=Math.ceil,o=Math.floor,a="[BigNumber Error] ",s=a+"Number primitive has more than 15 significant digits: ",l=1e14,c=14,u=9007199254740991,h=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],d=1e7,f=1e9;function g(e){var t=0|e;return 0<e||e===t?t:t-1}function p(e){for(var t,r,n=1,i=e.length,o=e[0]+"";n<i;){for(t=e[n++]+"",r=c-t.length;r--;t="0"+t);o+=t}for(i=o.length;48===o.charCodeAt(--i););return o.slice(0,i+1||1)}function m(e,t){var r,n,i=e.c,o=t.c,a=e.s,s=t.s,l=e.e,c=t.e;if(!a||!s)return null;if(r=i&&!i[0],n=o&&!o[0],r||n)return r?n?0:-s:a;if(a!=s)return a;if(r=a<0,n=l==c,!i||!o)return n?0:!i^r?1:-1;if(!n)return c<l^r?1:-1;for(s=(l=i.length)<(c=o.length)?l:c,a=0;a<s;a++)if(i[a]!=o[a])return i[a]>o[a]^r?1:-1;return l==c?0:c<l^r?1:-1}function v(e,t,r,n){if(e<t||r<e||e!==(e<0?i(e):o(e)))throw Error(a+(n||"Argument")+("number"==typeof e?e<t||r<e?" out of range: ":" not an integer: ":" not a primitive number: ")+String(e))}function b(e){var t=e.c.length-1;return g(e.e/c)==t&&e.c[t]%2!=0}function y(e,t){return(1<e.length?e.charAt(0)+"."+e.slice(1):e)+(t<0?"e":"e+")+t}function w(e,t,r){var n,i;if(t<0){for(i=r+".";++t;i+=r);e=i+e}else if(++t>(n=e.length)){for(i=r,t-=n;--t;i+=r);e+=i}else t<n&&(e=e.slice(0,t)+"."+e.slice(t));return e}(r=function e(t){var r,S,C,k,x,E,T,_,A,R,O=V.prototype={constructor:V,toString:null,valueOf:null},M=new V(1),I=20,P=4,N=-7,D=21,F=-1e7,L=1e7,H=!1,B=1,U=0,j={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"\xa0",suffix:""},W="0123456789abcdefghijklmnopqrstuvwxyz";function V(e,t){var r,i,a,l,h,d,f,g,p=this;if(!(p instanceof V))return new V(e,t);if(null==t){if(e instanceof V)return p.s=e.s,p.e=e.e,void(p.c=(e=e.c)?e.slice():e);if((d="number"==typeof e)&&0*e==0){if(p.s=1/e<0?(e=-e,-1):1,e===~~e){for(l=0,h=e;10<=h;h/=10,l++);return p.e=l,void(p.c=[e])}g=String(e)}else{if(g=String(e),!n.test(g))return C(p,g,d);p.s=45==g.charCodeAt(0)?(g=g.slice(1),-1):1}-1<(l=g.indexOf("."))&&(g=g.replace(".","")),0<(h=g.search(/e/i))?(l<0&&(l=h),l+=+g.slice(h+1),g=g.substring(0,h)):l<0&&(l=g.length)}else{if(v(t,2,W.length,"Base"),g=String(e),10==t)return $(p=new V(e instanceof V?e:g),I+p.e+1,P);if(d="number"==typeof e){if(0*e!=0)return C(p,g,d,t);if(p.s=1/e<0?(g=g.slice(1),-1):1,V.DEBUG&&15<g.replace(/^0\.0*|\./,"").length)throw Error(s+e);d=!1}else p.s=45===g.charCodeAt(0)?(g=g.slice(1),-1):1;for(r=W.slice(0,t),l=h=0,f=g.length;h<f;h++)if(r.indexOf(i=g.charAt(h))<0){if("."==i){if(l<h){l=f;continue}}else if(!a&&(g==g.toUpperCase()&&(g=g.toLowerCase())||g==g.toLowerCase()&&(g=g.toUpperCase()))){a=!0,h=-1,l=0;continue}return C(p,String(e),d,t)}-1<(l=(g=S(g,t,10,p.s)).indexOf("."))?g=g.replace(".",""):l=g.length}for(h=0;48===g.charCodeAt(h);h++);for(f=g.length;48===g.charCodeAt(--f););if(g=g.slice(h,++f)){if(f-=h,d&&V.DEBUG&&15<f&&(u<e||e!==o(e)))throw Error(s+p.s*e);if(L<(l=l-h-1))p.c=p.e=null;else if(l<F)p.c=[p.e=0];else{if(p.e=l,p.c=[],h=(l+1)%c,l<0&&(h+=c),h<f){for(h&&p.c.push(+g.slice(0,h)),f-=c;h<f;)p.c.push(+g.slice(h,h+=c));g=g.slice(h),h=c-g.length}else h-=f;for(;h--;g+="0");p.c.push(+g)}}else p.c=[p.e=0]}function z(e,t,r,n){var i,o,a,s,l;if(null==r?r=P:v(r,0,8),!e.c)return e.toString();if(i=e.c[0],a=e.e,null==t)l=p(e.c),l=1==n||2==n&&(a<=N||D<=a)?y(l,a):w(l,a,"0");else if(o=(e=$(new V(e),t,r)).e,s=(l=p(e.c)).length,1==n||2==n&&(t<=o||o<=N)){for(;s<t;l+="0",s++);l=y(l,o)}else if(t-=a,l=w(l,o,"0"),s<o+1){if(0<--t)for(l+=".";t--;l+="0");}else if(0<(t+=o-s))for(o+1==s&&(l+=".");t--;l+="0");return e.s<0&&i?"-"+l:l}function q(e,t){for(var r,n=1,i=new V(e[0]);n<e.length;n++){if(!(r=new V(e[n])).s){i=r;break}t.call(i,r)&&(i=r)}return i}function G(e,t,r){for(var n=1,i=t.length;!t[--i];t.pop());for(i=t[0];10<=i;i/=10,n++);return(r=n+r*c-1)>L?e.c=e.e=null:e.c=r<F?[e.e=0]:(e.e=r,t),e}function $(e,t,r,n){var a,s,u,d,f,g,p,m=e.c,v=h;if(m){e:{for(a=1,d=m[0];10<=d;d/=10,a++);if((s=t-a)<0)s+=c,u=t,p=(f=m[g=0])/v[a-u-1]%10|0;else if((g=i((s+1)/c))>=m.length){if(!n)break e;for(;m.length<=g;m.push(0));f=p=0,u=(s%=c)-c+(a=1)}else{for(f=d=m[g],a=1;10<=d;d/=10,a++);p=(u=(s%=c)-c+a)<0?0:f/v[a-u-1]%10|0}if(n=n||t<0||null!=m[g+1]||(u<0?f:f%v[a-u-1]),n=r<4?(p||n)&&(0==r||r==(e.s<0?3:2)):5<p||5==p&&(4==r||n||6==r&&(0<s?0<u?f/v[a-u]:0:m[g-1])%10&1||r==(e.s<0?8:7)),t<1||!m[0])return m.length=0,n?(t-=e.e+1,m[0]=v[(c-t%c)%c],e.e=-t||0):m[0]=e.e=0,e;if(0==s?(m.length=g,d=1,g--):(m.length=g+1,d=v[c-s],m[g]=0<u?o(f/v[a-u]%v[u])*d:0),n)for(;;){if(0==g){for(s=1,u=m[0];10<=u;u/=10,s++);for(u=m[0]+=d,d=1;10<=u;u/=10,d++);s!=d&&(e.e++,m[0]==l&&(m[0]=1));break}if(m[g]+=d,m[g]!=l)break;m[g--]=0,d=1}for(s=m.length;0===m[--s];m.pop());}e.e>L?e.c=e.e=null:e.e<F&&(e.c=[e.e=0])}return e}function K(e){var t,r=e.e;return null===r?e.toString():(t=p(e.c),t=r<=N||D<=r?y(t,r):w(t,r,"0"),e.s<0?"-"+t:t)}return V.clone=e,V.ROUND_UP=0,V.ROUND_DOWN=1,V.ROUND_CEIL=2,V.ROUND_FLOOR=3,V.ROUND_HALF_UP=4,V.ROUND_HALF_DOWN=5,V.ROUND_HALF_EVEN=6,V.ROUND_HALF_CEIL=7,V.ROUND_HALF_FLOOR=8,V.EUCLID=9,V.config=V.set=function(e){var t,r;if(null!=e){if("object"!=typeof e)throw Error(a+"Object expected: "+e);if(e.hasOwnProperty(t="DECIMAL_PLACES")&&(v(r=e[t],0,f,t),I=r),e.hasOwnProperty(t="ROUNDING_MODE")&&(v(r=e[t],0,8,t),P=r),e.hasOwnProperty(t="EXPONENTIAL_AT")&&((r=e[t])&&r.pop?(v(r[0],-f,0,t),v(r[1],0,f,t),N=r[0],D=r[1]):(v(r,-f,f,t),N=-(D=r<0?-r:r))),e.hasOwnProperty(t="RANGE"))if((r=e[t])&&r.pop)v(r[0],-f,-1,t),v(r[1],1,f,t),F=r[0],L=r[1];else{if(v(r,-f,f,t),!r)throw Error(a+t+" cannot be zero: "+r);F=-(L=r<0?-r:r)}if(e.hasOwnProperty(t="CRYPTO")){if((r=e[t])!==!!r)throw Error(a+t+" not true or false: "+r);if(r){if("undefined"==typeof crypto||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw H=!r,Error(a+"crypto unavailable");H=r}else H=r}if(e.hasOwnProperty(t="MODULO_MODE")&&(v(r=e[t],0,9,t),B=r),e.hasOwnProperty(t="POW_PRECISION")&&(v(r=e[t],0,f,t),U=r),e.hasOwnProperty(t="FORMAT")){if("object"!=typeof(r=e[t]))throw Error(a+t+" not an object: "+r);j=r}if(e.hasOwnProperty(t="ALPHABET")){if("string"!=typeof(r=e[t])||/^.$|[+-.\s]|(.).*\1/.test(r))throw Error(a+t+" invalid: "+r);W=r}}return{DECIMAL_PLACES:I,ROUNDING_MODE:P,EXPONENTIAL_AT:[N,D],RANGE:[F,L],CRYPTO:H,MODULO_MODE:B,POW_PRECISION:U,FORMAT:j,ALPHABET:W}},V.isBigNumber=function(e){return e instanceof V||e&&!0===e._isBigNumber||!1},V.maximum=V.max=function(){return q(arguments,O.lt)},V.minimum=V.min=function(){return q(arguments,O.gt)},V.random=(k=9007199254740992,x=Math.random()*k&2097151?function(){return o(Math.random()*k)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(e){var t,r,n,s,l,u=0,d=[],g=new V(M);if(null==e?e=I:v(e,0,f),s=i(e/c),H)if(crypto.getRandomValues){for(t=crypto.getRandomValues(new Uint32Array(s*=2));u<s;)9e15<=(l=131072*t[u]+(t[u+1]>>>11))?(r=crypto.getRandomValues(new Uint32Array(2)),t[u]=r[0],t[u+1]=r[1]):(d.push(l%1e14),u+=2);u=s/2}else{if(!crypto.randomBytes)throw H=!1,Error(a+"crypto unavailable");for(t=crypto.randomBytes(s*=7);u<s;)9e15<=(l=281474976710656*(31&t[u])+1099511627776*t[u+1]+4294967296*t[u+2]+16777216*t[u+3]+(t[u+4]<<16)+(t[u+5]<<8)+t[u+6])?crypto.randomBytes(7).copy(t,u):(d.push(l%1e14),u+=7);u=s/7}if(!H)for(;u<s;)(l=x())<9e15&&(d[u++]=l%1e14);for(s=d[--u],e%=c,s&&e&&(l=h[c-e],d[u]=o(s/l)*l);0===d[u];d.pop(),u--);if(u<0)d=[n=0];else{for(n=-1;0===d[0];d.splice(0,1),n-=c);for(u=1,l=d[0];10<=l;l/=10,u++);u<c&&(n-=c-u)}return g.e=n,g.c=d,g}),V.sum=function(){for(var e=1,t=arguments,r=new V(t[0]);e<t.length;)r=r.plus(t[e++]);return r},S=function(){var e="0123456789";function t(e,t,r,n){for(var i,o,a=[0],s=0,l=e.length;s<l;){for(o=a.length;o--;a[o]*=t);for(a[0]+=n.indexOf(e.charAt(s++)),i=0;i<a.length;i++)a[i]>r-1&&(null==a[i+1]&&(a[i+1]=0),a[i+1]+=a[i]/r|0,a[i]%=r)}return a.reverse()}return function(n,i,o,a,s){var l,c,u,h,d,f,g,m,v=n.indexOf("."),b=I,y=P;for(0<=v&&(h=U,U=0,n=n.replace(".",""),f=(m=new V(i)).pow(n.length-v),U=h,m.c=t(w(p(f.c),f.e,"0"),10,o,e),m.e=m.c.length),u=h=(g=t(n,i,o,s?(l=W,e):(l=e,W))).length;0==g[--h];g.pop());if(!g[0])return l.charAt(0);if(v<0?--u:(f.c=g,f.e=u,f.s=a,g=(f=r(f,m,b,y,o)).c,d=f.r,u=f.e),v=g[c=u+b+1],h=o/2,d=d||c<0||null!=g[c+1],d=y<4?(null!=v||d)&&(0==y||y==(f.s<0?3:2)):h<v||v==h&&(4==y||d||6==y&&1&g[c-1]||y==(f.s<0?8:7)),c<1||!g[0])n=d?w(l.charAt(1),-b,l.charAt(0)):l.charAt(0);else{if(g.length=c,d)for(--o;++g[--c]>o;)g[c]=0,c||(++u,g=[1].concat(g));for(h=g.length;!g[--h];);for(v=0,n="";v<=h;n+=l.charAt(g[v++]));n=w(n,u,l.charAt(0))}return n}}(),r=function(){function e(e,t,r){var n,i,o,a,s=0,l=e.length,c=t%d,u=t/d|0;for(e=e.slice();l--;)s=((i=c*(o=e[l]%d)+(n=u*o+(a=e[l]/d|0)*c)%d*d+s)/r|0)+(n/d|0)+u*a,e[l]=i%r;return s&&(e=[s].concat(e)),e}function t(e,t,r,n){var i,o;if(r!=n)o=n<r?1:-1;else for(i=o=0;i<r;i++)if(e[i]!=t[i]){o=e[i]>t[i]?1:-1;break}return o}function r(e,t,r,n){for(var i=0;r--;)e[r]-=i,i=e[r]<t[r]?1:0,e[r]=i*n+e[r]-t[r];for(;!e[0]&&1<e.length;e.splice(0,1));}return function(n,i,a,s,u){var h,d,f,p,m,v,b,y,w,S,C,k,x,E,T,_,A,R=n.s==i.s?1:-1,O=n.c,M=i.c;if(!(O&&O[0]&&M&&M[0]))return new V(n.s&&i.s&&(O?!M||O[0]!=M[0]:M)?O&&0==O[0]||!M?0*R:R/0:NaN);for(w=(y=new V(R)).c=[],R=a+(d=n.e-i.e)+1,u||(u=l,d=g(n.e/c)-g(i.e/c),R=R/c|0),f=0;M[f]==(O[f]||0);f++);if(M[f]>(O[f]||0)&&d--,R<0)w.push(1),p=!0;else{for(E=O.length,_=M.length,R+=2,1<(m=o(u/(M[f=0]+1)))&&(M=e(M,m,u),O=e(O,m,u),_=M.length,E=O.length),x=_,C=(S=O.slice(0,_)).length;C<_;S[C++]=0);A=M.slice(),A=[0].concat(A),T=M[0],M[1]>=u/2&&T++;do{if(m=0,(h=t(M,S,_,C))<0){if(k=S[0],_!=C&&(k=k*u+(S[1]||0)),1<(m=o(k/T)))for(u<=m&&(m=u-1),b=(v=e(M,m,u)).length,C=S.length;1==t(v,S,b,C);)m--,r(v,_<b?A:M,b,u),b=v.length,h=1;else 0==m&&(h=m=1),b=(v=M.slice()).length;if(b<C&&(v=[0].concat(v)),r(S,v,C,u),C=S.length,-1==h)for(;t(M,S,_,C)<1;)m++,r(S,_<C?A:M,C,u),C=S.length}else 0===h&&(m++,S=[0]);w[f++]=m,S[0]?S[C++]=O[x]||0:(S=[O[x]],C=1)}while((x++<E||null!=S[0])&&R--);p=null!=S[0],w[0]||w.splice(0,1)}if(u==l){for(f=1,R=w[0];10<=R;R/=10,f++);$(y,a+(y.e=f+d*c-1)+1,s,p)}else y.e=d,y.r=+p;return y}}(),E=/^(-?)0([xbo])(?=\w[\w.]*$)/i,T=/^([^.]+)\.$/,_=/^\.([^.]+)$/,A=/^-?(Infinity|NaN)$/,R=/^\s*\+(?=[\w.])|^\s+|\s+$/g,C=function(e,t,r,n){var i,o=r?t:t.replace(R,"");if(A.test(o))e.s=isNaN(o)?null:o<0?-1:1,e.c=e.e=null;else{if(!r&&(o=o.replace(E,(function(e,t,r){return i="x"==(r=r.toLowerCase())?16:"b"==r?2:8,n&&n!=i?e:t})),n&&(i=n,o=o.replace(T,"$1").replace(_,"0.$1")),t!=o))return new V(o,i);if(V.DEBUG)throw Error(a+"Not a"+(n?" base "+n:"")+" number: "+t);e.c=e.e=e.s=null}},O.absoluteValue=O.abs=function(){var e=new V(this);return e.s<0&&(e.s=1),e},O.comparedTo=function(e,t){return m(this,new V(e,t))},O.decimalPlaces=O.dp=function(e,t){var r,n,i;if(null!=e)return v(e,0,f),null==t?t=P:v(t,0,8),$(new V(this),e+this.e+1,t);if(!(r=this.c))return null;if(n=((i=r.length-1)-g(this.e/c))*c,i=r[i])for(;i%10==0;i/=10,n--);return n<0&&(n=0),n},O.dividedBy=O.div=function(e,t){return r(this,new V(e,t),I,P)},O.dividedToIntegerBy=O.idiv=function(e,t){return r(this,new V(e,t),0,1)},O.exponentiatedBy=O.pow=function(e,t){var r,n,s,l,u,h,d,f,g=this;if((e=new V(e)).c&&!e.isInteger())throw Error(a+"Exponent not an integer: "+K(e));if(null!=t&&(t=new V(t)),u=14<e.e,!g.c||!g.c[0]||1==g.c[0]&&!g.e&&1==g.c.length||!e.c||!e.c[0])return f=new V(Math.pow(+K(g),u?2-b(e):+K(e))),t?f.mod(t):f;if(h=e.s<0,t){if(t.c?!t.c[0]:!t.s)return new V(NaN);(n=!h&&g.isInteger()&&t.isInteger())&&(g=g.mod(t))}else{if(9<e.e&&(0<g.e||g.e<-1||(0==g.e?1<g.c[0]||u&&24e7<=g.c[1]:g.c[0]<8e13||u&&g.c[0]<=9999975e7)))return l=g.s<0&&b(e)?-0:0,-1<g.e&&(l=1/l),new V(h?1/l:l);U&&(l=i(U/c+2))}for(d=u?(r=new V(.5),h&&(e.s=1),b(e)):(s=Math.abs(+K(e)))%2,f=new V(M);;){if(d){if(!(f=f.times(g)).c)break;l?f.c.length>l&&(f.c.length=l):n&&(f=f.mod(t))}if(s){if(0===(s=o(s/2)))break;d=s%2}else if($(e=e.times(r),e.e+1,1),14<e.e)d=b(e);else{if(0==(s=+K(e)))break;d=s%2}g=g.times(g),l?g.c&&g.c.length>l&&(g.c.length=l):n&&(g=g.mod(t))}return n?f:(h&&(f=M.div(f)),t?f.mod(t):l?$(f,U,P,void 0):f)},O.integerValue=function(e){var t=new V(this);return null==e?e=P:v(e,0,8),$(t,t.e+1,e)},O.isEqualTo=O.eq=function(e,t){return 0===m(this,new V(e,t))},O.isFinite=function(){return!!this.c},O.isGreaterThan=O.gt=function(e,t){return 0<m(this,new V(e,t))},O.isGreaterThanOrEqualTo=O.gte=function(e,t){return 1===(t=m(this,new V(e,t)))||0===t},O.isInteger=function(){return!!this.c&&g(this.e/c)>this.c.length-2},O.isLessThan=O.lt=function(e,t){return m(this,new V(e,t))<0},O.isLessThanOrEqualTo=O.lte=function(e,t){return-1===(t=m(this,new V(e,t)))||0===t},O.isNaN=function(){return!this.s},O.isNegative=function(){return this.s<0},O.isPositive=function(){return 0<this.s},O.isZero=function(){return!!this.c&&0==this.c[0]},O.minus=function(e,t){var r,n,i,o,a=this,s=a.s;if(t=(e=new V(e,t)).s,!s||!t)return new V(NaN);if(s!=t)return e.s=-t,a.plus(e);var u=a.e/c,h=e.e/c,d=a.c,f=e.c;if(!u||!h){if(!d||!f)return d?(e.s=-t,e):new V(f?a:NaN);if(!d[0]||!f[0])return f[0]?(e.s=-t,e):new V(d[0]?a:3==P?-0:0)}if(u=g(u),h=g(h),d=d.slice(),s=u-h){for((i=(o=s<0)?(s=-s,d):(h=u,f)).reverse(),t=s;t--;i.push(0));i.reverse()}else for(n=(o=(s=d.length)<(t=f.length))?s:t,s=t=0;t<n;t++)if(d[t]!=f[t]){o=d[t]<f[t];break}if(o&&(i=d,d=f,f=i,e.s=-e.s),0<(t=(n=f.length)-(r=d.length)))for(;t--;d[r++]=0);for(t=l-1;s<n;){if(d[--n]<f[n]){for(r=n;r&&!d[--r];d[r]=t);--d[r],d[n]+=l}d[n]-=f[n]}for(;0==d[0];d.splice(0,1),--h);return d[0]?G(e,d,h):(e.s=3==P?-1:1,e.c=[e.e=0],e)},O.modulo=O.mod=function(e,t){var n,i,o=this;return e=new V(e,t),!o.c||!e.s||e.c&&!e.c[0]?new V(NaN):!e.c||o.c&&!o.c[0]?new V(o):(9==B?(i=e.s,e.s=1,n=r(o,e,0,3),e.s=i,n.s*=i):n=r(o,e,0,B),(e=o.minus(n.times(e))).c[0]||1!=B||(e.s=o.s),e)},O.multipliedBy=O.times=function(e,t){var r,n,i,o,a,s,u,h,f,p,m,v,b,y,w,S=this,C=S.c,k=(e=new V(e,t)).c;if(!(C&&k&&C[0]&&k[0]))return!S.s||!e.s||C&&!C[0]&&!k||k&&!k[0]&&!C?e.c=e.e=e.s=null:(e.s*=S.s,C&&k?(e.c=[0],e.e=0):e.c=e.e=null),e;for(n=g(S.e/c)+g(e.e/c),e.s*=S.s,(u=C.length)<(p=k.length)&&(b=C,C=k,k=b,i=u,u=p,p=i),i=u+p,b=[];i--;b.push(0));for(y=l,w=d,i=p;0<=--i;){for(r=0,m=k[i]%w,v=k[i]/w|0,o=i+(a=u);i<o;)r=((h=m*(h=C[--a]%w)+(s=v*h+(f=C[a]/w|0)*m)%w*w+b[o]+r)/y|0)+(s/w|0)+v*f,b[o--]=h%y;b[o]=r}return r?++n:b.splice(0,1),G(e,b,n)},O.negated=function(){var e=new V(this);return e.s=-e.s||null,e},O.plus=function(e,t){var r,n=this,i=n.s;if(t=(e=new V(e,t)).s,!i||!t)return new V(NaN);if(i!=t)return e.s=-t,n.minus(e);var o=n.e/c,a=e.e/c,s=n.c,u=e.c;if(!o||!a){if(!s||!u)return new V(i/0);if(!s[0]||!u[0])return u[0]?e:new V(s[0]?n:0*i)}if(o=g(o),a=g(a),s=s.slice(),i=o-a){for((r=0<i?(a=o,u):(i=-i,s)).reverse();i--;r.push(0));r.reverse()}for((i=s.length)-(t=u.length)<0&&(r=u,u=s,s=r,t=i),i=0;t;)i=(s[--t]=s[t]+u[t]+i)/l|0,s[t]=l===s[t]?0:s[t]%l;return i&&(s=[i].concat(s),++a),G(e,s,a)},O.precision=O.sd=function(e,t){var r,n,i;if(null!=e&&e!==!!e)return v(e,1,f),null==t?t=P:v(t,0,8),$(new V(this),e,t);if(!(r=this.c))return null;if(n=(i=r.length-1)*c+1,i=r[i]){for(;i%10==0;i/=10,n--);for(i=r[0];10<=i;i/=10,n++);}return e&&this.e+1>n&&(n=this.e+1),n},O.shiftedBy=function(e){return v(e,-u,u),this.times("1e"+e)},O.squareRoot=O.sqrt=function(){var e,t,n,i,o,a=this,s=a.c,l=a.s,c=a.e,u=I+4,h=new V("0.5");if(1!==l||!s||!s[0])return new V(!l||l<0&&(!s||s[0])?NaN:s?a:1/0);if((n=0==(l=Math.sqrt(+K(a)))||l==1/0?(((t=p(s)).length+c)%2==0&&(t+="0"),l=Math.sqrt(+t),c=g((c+1)/2)-(c<0||c%2),new V(t=l==1/0?"1e"+c:(t=l.toExponential()).slice(0,t.indexOf("e")+1)+c)):new V(l+"")).c[0])for((l=(c=n.e)+u)<3&&(l=0);;)if(o=n,n=h.times(o.plus(r(a,o,u,1))),p(o.c).slice(0,l)===(t=p(n.c)).slice(0,l)){if(n.e<c&&--l,"9999"!=(t=t.slice(l-3,l+1))&&(i||"4999"!=t)){+t&&(+t.slice(1)||"5"!=t.charAt(0))||($(n,n.e+I+2,1),e=!n.times(n).eq(a));break}if(!i&&($(o,o.e+I+2,0),o.times(o).eq(a))){n=o;break}u+=4,l+=4,i=1}return $(n,n.e+I+1,P,e)},O.toExponential=function(e,t){return null!=e&&(v(e,0,f),e++),z(this,e,t,1)},O.toFixed=function(e,t){return null!=e&&(v(e,0,f),e=e+this.e+1),z(this,e,t)},O.toFormat=function(e,t,r){var n;if(null==r)null!=e&&t&&"object"==typeof t?(r=t,t=null):e&&"object"==typeof e?(r=e,e=t=null):r=j;else if("object"!=typeof r)throw Error(a+"Argument not an object: "+r);if(n=this.toFixed(e,t),this.c){var i,o=n.split("."),s=+r.groupSize,l=+r.secondaryGroupSize,c=r.groupSeparator||"",u=o[0],h=o[1],d=this.s<0,f=d?u.slice(1):u,g=f.length;if(l&&(i=s,s=l,g-=l=i),0<s&&0<g){for(i=g%s||s,u=f.substr(0,i);i<g;i+=s)u+=c+f.substr(i,s);0<l&&(u+=c+f.slice(i)),d&&(u="-"+u)}n=h?u+(r.decimalSeparator||"")+((l=+r.fractionGroupSize)?h.replace(new RegExp("\\d{"+l+"}\\B","g"),"$&"+(r.fractionGroupSeparator||"")):h):u}return(r.prefix||"")+n+(r.suffix||"")},O.toFraction=function(e){var t,n,i,o,s,l,u,d,f,g,m,v,b=this,y=b.c;if(null!=e&&(!(u=new V(e)).isInteger()&&(u.c||1!==u.s)||u.lt(M)))throw Error(a+"Argument "+(u.isInteger()?"out of range: ":"not an integer: ")+K(u));if(!y)return new V(b);for(t=new V(M),f=n=new V(M),i=d=new V(M),v=p(y),s=t.e=v.length-b.e-1,t.c[0]=h[(l=s%c)<0?c+l:l],e=!e||0<u.comparedTo(t)?0<s?t:f:u,l=L,L=1/0,u=new V(v),d.c[0]=0;g=r(u,t,0,1),1!=(o=n.plus(g.times(i))).comparedTo(e);)n=i,i=o,f=d.plus(g.times(o=f)),d=o,t=u.minus(g.times(o=t)),u=o;return o=r(e.minus(n),i,0,1),d=d.plus(o.times(f)),n=n.plus(o.times(i)),d.s=f.s=b.s,m=r(f,i,s*=2,P).minus(b).abs().comparedTo(r(d,n,s,P).minus(b).abs())<1?[f,i]:[d,n],L=l,m},O.toNumber=function(){return+K(this)},O.toPrecision=function(e,t){return null!=e&&v(e,1,f),z(this,e,t,2)},O.toString=function(e){var t,r=this,n=r.s,i=r.e;return null===i?n?(t="Infinity",n<0&&(t="-"+t)):t="NaN":(t=null==e?i<=N||D<=i?y(p(r.c),i):w(p(r.c),i,"0"):10===e?w(p((r=$(new V(r),I+i+1,P)).c),r.e,"0"):(v(e,2,W.length,"Base"),S(w(p(r.c),i,"0"),10,e,n,!0)),n<0&&r.c[0]&&(t="-"+t)),t},O.valueOf=O.toJSON=function(){return K(this)},O._isBigNumber=!0,"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator&&(O[Symbol.toStringTag]="BigNumber",O[Symbol.for("nodejs.util.inspect.custom")]=O.valueOf),null!=t&&V.set(t),V}()).default=r.BigNumber=r,void 0!==t&&t.exports?t.exports=r:(e||(e="undefined"!=typeof self&&self?self:window),e.BigNumber=r)}(this)},{}],2:[function(e,t,r){"use strict";t.exports={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(e){var t=e%10;return 1==~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th"},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}},{}],3:[function(e,t,r){"use strict";function n(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=[],n=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){i=!0,o=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw o}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var i=e("./globalState"),o=e("./validating"),a=e("./parsing"),s=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],l={general:{scale:1024,suffixes:s,marker:"bd"},binary:{scale:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],marker:"b"},decimal:{scale:1e3,suffixes:s,marker:"d"}},c={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1};function u(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=2<arguments.length?arguments[2]:void 0;if("string"==typeof t&&(t=a.parseFormat(t)),!o.validateFormat(t))return"ERROR: invalid format";var n=t.prefix||"",s=t.postfix||"",u=function(e,t,r){switch(t.output){case"currency":return function(e,t,r){var n=r.currentCurrency(),i=Object.assign({},c,t),o=void 0,a="",s=!!i.totalLength||!!i.forceAverage||i.average,l=t.currencyPosition||n.position,u=t.currencySymbol||n.symbol;i.spaceSeparated&&(a=" "),"infix"===l&&(o=a+u+a);var h=g({instance:e,providedFormat:t,state:r,decimalSeparator:o});return"prefix"===l&&(h=e._value<0&&"sign"===i.negative?"-".concat(a).concat(u).concat(h.slice(1)):u+a+h),l&&"postfix"!==l||(h=h+(a=s?"":a)+u),h}(e,t=p(t,i.currentCurrencyDefaultFormat()),i);case"percent":return function(e,t,r,n){var i=t.prefixSymbol,o=g({instance:n(100*e._value),providedFormat:t,state:r}),a=Object.assign({},c,t);return i?"%".concat(a.spaceSeparated?" ":"").concat(o):"".concat(o).concat(a.spaceSeparated?" ":"","%")}(e,t=p(t,i.currentPercentageDefaultFormat()),i,r);case"byte":return t=p(t,i.currentByteDefaultFormat()),w=e,C=i,k=r,x=(S=t).base||"binary",E=l[x],_=(T=h(w._value,E.suffixes,E.scale)).value,A=T.suffix,R=g({instance:k(_),providedFormat:S,state:C,defaults:C.currentByteDefaultFormat()}),O=C.currentAbbreviations(),"".concat(R).concat(O.spaced?" ":"").concat(A);case"time":return t=p(t,i.currentTimeDefaultFormat()),m=e,v=Math.floor(m._value/60/60),b=Math.floor((m._value-60*v*60)/60),y=Math.round(m._value-60*v*60-60*b),"".concat(v,":").concat(b<10?"0":"").concat(b,":").concat(y<10?"0":"").concat(y);case"ordinal":return n=e,o=t=p(t,i.currentOrdinalDefaultFormat()),s=(a=i).currentOrdinal(),u=Object.assign({},c,o),d=g({instance:n,providedFormat:o,state:a}),f=s(n._value),"".concat(d).concat(u.spaceSeparated?" ":"").concat(f);default:return g({instance:e,providedFormat:t,numbro:r})}var n,o,a,s,u,d,f,m,v,b,y,w,S,C,k,x,E,T,_,A,R,O}(e,t,r);return(u=n+u)+s}function h(e,t,r){var n=t[0],i=Math.abs(e);if(r<=i){for(var o=1;o<t.length;++o){var a=Math.pow(r,o),s=Math.pow(r,o+1);if(a<=i&&i<s){n=t[o],e/=a;break}}n===t[0]&&(e/=Math.pow(r,t.length-1),n=t[t.length-1])}return{value:e,suffix:n}}function d(e){for(var t="",r=0;r<e;r++)t+="0";return t}function f(e,t){return-1!==e.toString().indexOf("e")?function(e,t){var r=e.toString(),i=n(r.split("e"),2),o=i[0],a=i[1],s=n(o.split("."),2),l=s[0],c=s[1],u=void 0===c?"":c;if(0<+a)r=l+u+d(a-u.length);else{var h=".";h=+l<0?"-0".concat(h):"0".concat(h);var f=(d(-a-1)+Math.abs(l)+u).substr(0,t);f.length<t&&(f+=d(t-f.length)),r=h+f}return 0<+a&&0<t&&(r+=".".concat(d(t))),r}(e,t):(Math.round(+"".concat(e,"e+").concat(t))/Math.pow(10,t)).toFixed(t)}function g(e){var t=e.instance,r=e.providedFormat,o=e.state,a=void 0===o?i:o,s=e.decimalSeparator,l=e.defaults,u=void 0===l?a.currentDefaults():l,h=t._value;if(0===h&&a.hasZeroFormat())return a.getZeroFormat();if(!isFinite(h))return h.toString();var d,g,p,m,v,b,y,w,S=Object.assign({},c,u,r),C=S.totalLength,k=C?0:S.characteristic,x=S.optionalCharacteristic,E=S.forceAverage,T=!!C||!!E||S.average,_=C?-1:T&&void 0===r.mantissa?0:S.mantissa,A=!C&&(void 0===r.optionalMantissa?-1===_:S.optionalMantissa),R=S.trimMantissa,O=S.thousandSeparated,M=S.spaceSeparated,I=S.negative,P=S.forceSign,N=S.exponential,D="";if(T){var F=function(e){var t=e.value,r=e.forceAverage,n=e.abbreviations,i=e.spaceSeparated,o=void 0!==i&&i,a=e.totalLength,s=void 0===a?0:a,l="",c=Math.abs(t),u=-1;if(c>=Math.pow(10,12)&&!r||"trillion"===r?(l=n.trillion,t/=Math.pow(10,12)):c<Math.pow(10,12)&&c>=Math.pow(10,9)&&!r||"billion"===r?(l=n.billion,t/=Math.pow(10,9)):c<Math.pow(10,9)&&c>=Math.pow(10,6)&&!r||"million"===r?(l=n.million,t/=Math.pow(10,6)):(c<Math.pow(10,6)&&c>=Math.pow(10,3)&&!r||"thousand"===r)&&(l=n.thousand,t/=Math.pow(10,3)),l&&(l=(o?" ":"")+l),s){var h=t.toString().split(".")[0];u=Math.max(s-h.length,0)}return{value:t,abbreviation:l,mantissaPrecision:u}}({value:h,forceAverage:E,abbreviations:a.currentAbbreviations(),spaceSeparated:M,totalLength:C});h=F.value,D+=F.abbreviation,C&&(_=F.mantissaPrecision)}if(N){var L=(g=(d={value:h,characteristicPrecision:k}).value,m=void 0===(p=d.characteristicPrecision)?0:p,b=(v=n(g.toExponential().split("e"),2))[0],y=v[1],w=+b,m&&1<m&&(w*=Math.pow(10,m-1),y=0<=(y=+y-(m-1))?"+".concat(y):y),{value:w,abbreviation:"e".concat(y)});h=L.value,D=L.abbreviation+D}var H,B,U,j=function(e,t,r,i,o){if(-1===i)return e;var a=f(t,i),s=n(a.toString().split("."),2),l=s[0],c=s[1],u=void 0===c?"":c;if(u.match(/^0+$/)&&(r||o))return l;var h=u.match(/0+$/);return o&&h?"".concat(l,".").concat(u.toString().slice(0,h.index)):a.toString()}(h.toString(),h,A,_,R);return j=function(e,t,r,n,i){var o=n.currentDelimiters(),a=o.thousands;i=i||o.decimal;var s=o.thousandsSize||3,l=e.toString(),c=l.split(".")[0],u=l.split(".")[1];return r&&(t<0&&(c=c.slice(1)),function(e,t){for(var r=[],n=0,i=e;0<i;i--)n===t&&(r.unshift(i),n=0),n++;return r}(c.length,s).forEach((function(e,t){c=c.slice(0,e+t)+a+c.slice(e+t)})),t<0&&(c="-".concat(c))),u?c+i+u:c}(j=function(e,t,r,i){var o=e,a=n(o.toString().split("."),2),s=a[0],l=a[1];if(s.match(/^-?0$/)&&r)return l?"".concat(s.replace("0",""),".").concat(l):s.replace("0","");if(s.length<i)for(var c=i-s.length,u=0;u<c;u++)o="0".concat(o);return o.toString()}(j,0,x,k),h,O,a,s),(T||N)&&(j+=D),(P||h<0)&&(H=j,U=I,j=0===(B=h)?H:0==+H?H.replace("-",""):0<B?"+".concat(H):"sign"===U?H:"(".concat(H.replace("-",""),")")),j}function p(e,t){if(!e)return t;var r=Object.keys(e);return 1===r.length&&"output"===r[0]?t:e}t.exports=function(e){return{format:function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return u.apply(void 0,r.concat([e]))},getByteUnit:function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return function(e){var t=l.general;return h(e._value,t.suffixes,t.scale).suffix}.apply(void 0,r.concat([e]))},getBinaryByteUnit:function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return function(e){var t=l.binary;return h(e._value,t.suffixes,t.scale).suffix}.apply(void 0,r.concat([e]))},getDecimalByteUnit:function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return function(e){var t=l.decimal;return h(e._value,t.suffixes,t.scale).suffix}.apply(void 0,r.concat([e]))},formatOrDefault:p}}},{"./globalState":4,"./parsing":8,"./validating":10}],4:[function(e,t,r){"use strict";var n=e("./en-US"),i=e("./validating"),o=e("./parsing"),a={},s=void 0,l={},c=null,u={};function h(e){s=e}function d(){return l[s]}a.languages=function(){return Object.assign({},l)},a.currentLanguage=function(){return s},a.currentCurrency=function(){return d().currency},a.currentAbbreviations=function(){return d().abbreviations},a.currentDelimiters=function(){return d().delimiters},a.currentOrdinal=function(){return d().ordinal},a.currentDefaults=function(){return Object.assign({},d().defaults,u)},a.currentOrdinalDefaultFormat=function(){return Object.assign({},a.currentDefaults(),d().ordinalFormat)},a.currentByteDefaultFormat=function(){return Object.assign({},a.currentDefaults(),d().byteFormat)},a.currentPercentageDefaultFormat=function(){return Object.assign({},a.currentDefaults(),d().percentageFormat)},a.currentCurrencyDefaultFormat=function(){return Object.assign({},a.currentDefaults(),d().currencyFormat)},a.currentTimeDefaultFormat=function(){return Object.assign({},a.currentDefaults(),d().timeFormat)},a.setDefaults=function(e){e=o.parseFormat(e),i.validateFormat(e)&&(u=e)},a.getZeroFormat=function(){return c},a.setZeroFormat=function(e){return c="string"==typeof e?e:null},a.hasZeroFormat=function(){return null!==c},a.languageData=function(e){if(e){if(l[e])return l[e];throw new Error('Unknown tag "'.concat(e,'"'))}return d()},a.registerLanguage=function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];if(!i.validateLanguage(e))throw new Error("Invalid language data");l[e.languageTag]=e,t&&h(e.languageTag)},a.setLanguage=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:n.languageTag;if(!l[e]){var r=e.split("-")[0],i=Object.keys(l).find((function(e){return e.split("-")[0]===r}));return l[i]?void h(i):void h(t)}h(e)},a.registerLanguage(n),s=n.languageTag,t.exports=a},{"./en-US":2,"./parsing":8,"./validating":10}],5:[function(e,t,r){"use strict";t.exports=function(t){return{loadLanguagesInNode:function(r){return n=t,void r.forEach((function(t){var r=void 0;try{r=e("../languages/".concat(t))}catch(r){console.error('Unable to load "'.concat(t,'". No matching language file found.'))}r&&n.registerLanguage(r)}));var n}}}},{}],6:[function(e,t,r){"use strict";var n=e("bignumber.js");function i(e,t,r){var i=new n(e._value),o=t;return r.isNumbro(t)&&(o=t._value),o=new n(o),e._value=i.minus(o).toNumber(),e}t.exports=function(e){return{add:function(t,r){return o=r,a=e,s=new n((i=t)._value),l=o,a.isNumbro(o)&&(l=o._value),l=new n(l),i._value=s.plus(l).toNumber(),i;var i,o,a,s,l},subtract:function(t,r){return i(t,r,e)},multiply:function(t,r){return o=r,a=e,s=new n((i=t)._value),l=o,a.isNumbro(o)&&(l=o._value),l=new n(l),i._value=s.times(l).toNumber(),i;var i,o,a,s,l},divide:function(t,r){return o=r,a=e,s=new n((i=t)._value),l=o,a.isNumbro(o)&&(l=o._value),l=new n(l),i._value=s.dividedBy(l).toNumber(),i;var i,o,a,s,l},set:function(t,r){return n=t,o=i=r,e.isNumbro(i)&&(o=i._value),n._value=o,n;var n,i,o},difference:function(t,r){return n=r,i(a=(o=e)(t._value),n,o),Math.abs(a._value);var n,o,a}}}},{"bignumber.js":1}],7:[function(e,t,r){"use strict";function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var i=e("./globalState"),o=e("./validating"),a=e("./loading")(f),s=e("./unformatting"),l=e("./formatting")(f),c=e("./manipulating")(f),u=e("./parsing"),h=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._value=t}var t,r,o;return t=e,(r=[{key:"clone",value:function(){return f(this._value)}},{key:"format",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return l.format(this,e)}},{key:"formatCurrency",value:function(e){return"string"==typeof e&&(e=u.parseFormat(e)),(e=l.formatOrDefault(e,i.currentCurrencyDefaultFormat())).output="currency",l.format(this,e)}},{key:"formatTime",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return e.output="time",l.format(this,e)}},{key:"binaryByteUnits",value:function(){return l.getBinaryByteUnit(this)}},{key:"decimalByteUnits",value:function(){return l.getDecimalByteUnit(this)}},{key:"byteUnits",value:function(){return l.getByteUnit(this)}},{key:"difference",value:function(e){return c.difference(this,e)}},{key:"add",value:function(e){return c.add(this,e)}},{key:"subtract",value:function(e){return c.subtract(this,e)}},{key:"multiply",value:function(e){return c.multiply(this,e)}},{key:"divide",value:function(e){return c.divide(this,e)}},{key:"set",value:function(e){return c.set(this,d(e))}},{key:"value",value:function(){return this._value}},{key:"valueOf",value:function(){return this._value}}])&&n(t.prototype,r),o&&n(t,o),e}();function d(e){var t=e;return f.isNumbro(e)?t=e._value:"string"==typeof e?t=f.unformat(e):isNaN(e)&&(t=NaN),t}function f(e){return new h(d(e))}f.version="2.1.2",f.isNumbro=function(e){return e instanceof h},f.language=i.currentLanguage,f.registerLanguage=i.registerLanguage,f.setLanguage=i.setLanguage,f.languages=i.languages,f.languageData=i.languageData,f.zeroFormat=i.setZeroFormat,f.defaultFormat=i.currentDefaults,f.setDefaults=i.setDefaults,f.defaultCurrencyFormat=i.currentCurrencyDefaultFormat,f.validate=o.validate,f.loadLanguagesInNode=a.loadLanguagesInNode,f.unformat=s.unformat,t.exports=f},{"./formatting":3,"./globalState":4,"./loading":5,"./manipulating":6,"./parsing":8,"./unformatting":9,"./validating":10}],8:[function(e,t,r){"use strict";t.exports={parseFormat:function(e){var t,r,n,i,o,a,s,l,c,u,h,d,f,g,p,m,v,b,y,w,S=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return"string"!=typeof e?e:(r=S,o=S,function(e,t){if(-1===e.indexOf("$")){if(-1===e.indexOf("%"))return-1!==e.indexOf("bd")?(t.output="byte",t.base="general"):-1!==e.indexOf("b")?(t.output="byte",t.base="binary"):-1!==e.indexOf("d")?(t.output="byte",t.base="decimal"):-1===e.indexOf(":")?-1!==e.indexOf("o")&&(t.output="ordinal"):t.output="time";t.output="percent"}else t.output="currency"}(e=(a=(i=e=(n=(t=e).match(/^{([^}]*)}/))?(r.prefix=n[1],t.slice(n[0].length)):t).match(/{([^}]*)}$/))?(o.postfix=a[1],i.slice(0,-a[0].length)):i,S),s=S,(l=e.match(/[1-9]+[0-9]*/))&&(s.totalLength=+l[0]),c=S,(u=e.split(".")[0].match(/0+/))&&(c.characteristic=u[0].length),function(e,t){if(-1!==e.indexOf(".")){var r=e.split(".")[0];t.optionalCharacteristic=-1===r.indexOf("0")}}(e,S),h=S,-1!==e.indexOf("a")&&(h.average=!0),f=S,-1!==(d=e).indexOf("K")?f.forceAverage="thousand":-1!==d.indexOf("M")?f.forceAverage="million":-1!==d.indexOf("B")?f.forceAverage="billion":-1!==d.indexOf("T")&&(f.forceAverage="trillion"),function(e,t){var r=e.split(".")[1];if(r){var n=r.match(/0+/);n&&(t.mantissa=n[0].length)}}(e,S),p=S,(g=e).match(/\[\.]/)?p.optionalMantissa=!0:g.match(/\./)&&(p.optionalMantissa=!1),m=S,-1!==e.indexOf(",")&&(m.thousandSeparated=!0),v=S,-1!==e.indexOf(" ")&&(v.spaceSeparated=!0),y=S,(b=e).match(/^\+?\([^)]*\)$/)&&(y.negative="parenthesis"),b.match(/^\+?-/)&&(y.negative="sign"),w=S,e.match(/^\+/)&&(w.forceSign=!0),S)}}},{}],9:[function(e,t,r){"use strict";var n=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function i(e){return e.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function o(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"",o=3<arguments.length?arguments[3]:void 0,a=4<arguments.length?arguments[4]:void 0,s=5<arguments.length?arguments[5]:void 0,l=6<arguments.length?arguments[6]:void 0;if(""!==e)return e===a?0:function e(t,r){var o=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"",a=3<arguments.length?arguments[3]:void 0,s=4<arguments.length?arguments[4]:void 0,l=5<arguments.length?arguments[5]:void 0,c=6<arguments.length?arguments[6]:void 0;if(!isNaN(+t))return+t;var u="",h=t.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(h!==t)return-1*e(h,r,o,a,s,l,c);for(var d=0;d<n.length;d++){var f=n[d];if((u=t.replace(f.key,""))!==t)return e(u,r,o,a,s,l,c)*f.factor}if((u=t.replace("%",""))!==t)return e(u,r,o,a,s,l,c)/100;var g=parseFloat(t);if(!isNaN(g)){var p=a(g);if(p&&"."!==p&&(u=t.replace(new RegExp("".concat(i(p),"$")),""))!==t)return e(u,r,o,a,s,l,c);var m={};Object.keys(l).forEach((function(e){m[l[e]]=e}));for(var v=Object.keys(m).sort().reverse(),b=v.length,y=0;y<b;y++){var w=v[y],S=m[w];if((u=t.replace(w,""))!==t){var C=void 0;switch(S){case"thousand":C=Math.pow(10,3);break;case"million":C=Math.pow(10,6);break;case"billion":C=Math.pow(10,9);break;case"trillion":C=Math.pow(10,12)}return e(u,r,o,a,s,l,c)*C}}}}(function(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"",n=e.replace(r,"");return(n=n.replace(new RegExp("([0-9])".concat(i(t.thousands),"([0-9])"),"g"),"$1$2")).replace(t.decimal,".")}(e,t,r),t,r,o,a,s,l)}t.exports={unformat:function(t,r){var n,i,a,s=e("./globalState"),l=s.currentDelimiters(),c=s.currentCurrency().symbol,u=s.currentOrdinal(),h=s.getZeroFormat(),d=s.currentAbbreviations(),f=void 0;if("string"==typeof t)f=function(e,t){if(!e.indexOf(":")||":"===t.thousands)return!1;var r=e.split(":");if(3!==r.length)return!1;var n=+r[0],i=+r[1],o=+r[2];return!isNaN(n)&&!isNaN(i)&&!isNaN(o)}(t,l)?(i=+(n=t.split(":"))[0],a=+n[1],+n[2]+60*a+3600*i):o(t,l,c,u,h,d,r);else{if("number"!=typeof t)return;f=t}if(void 0!==f)return f}}},{"./globalState":4}],10:[function(e,t,r){"use strict";function n(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var o=e("./unformatting"),a=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,s={output:{type:"string",validValues:["currency","percent","byte","time","ordinal","number"]},base:{type:"string",validValues:["decimal","binary","general"],restriction:function(e,t){return"byte"===t.output},message:"`base` must be provided only when the output is `byte`",mandatory:function(e){return"byte"===e.output}},characteristic:{type:"number",restriction:function(e){return 0<=e},message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:["trillion","billion","million","thousand"]},average:"boolean",currencyPosition:{type:"string",validValues:["prefix","infix","postfix"]},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:function(e){return 0<=e},message:"value must be positive"},{restriction:function(e,t){return!t.exponential},message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:function(e){return 0<=e},message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:["sign","parenthesis"]},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:function(e,t){return"percent"===t.output},message:"`prefixSymbol` can be provided only when the output is `percent`"}},l={languageTag:{type:"string",mandatory:!0,restriction:function(e){return e.match(a)},message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:{type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},spaceSeparated:"boolean",ordinal:{type:"function",mandatory:!0},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function c(e){return!!o.unformat(e)}function u(e,t,r){var o=3<arguments.length&&void 0!==arguments[3]&&arguments[3],a=Object.keys(e).map((function(n){if(!t[n])return console.error("".concat(r," Invalid key: ").concat(n)),!1;var o=e[n],a=t[n];if("string"==typeof a&&(a={type:a}),"format"===a.type){if(!u(o,s,"[Validate ".concat(n,"]"),!0))return!1}else if(i(o)!==a.type)return console.error("".concat(r," ").concat(n,' type mismatched: "').concat(a.type,'" expected, "').concat(i(o),'" provided')),!1;if(a.restrictions&&a.restrictions.length)for(var l=a.restrictions.length,c=0;c<l;c++){var h=a.restrictions[c],d=h.restriction,f=h.message;if(!d(o,e))return console.error("".concat(r," ").concat(n," invalid value: ").concat(f)),!1}return a.restriction&&!a.restriction(o,e)?(console.error("".concat(r," ").concat(n," invalid value: ").concat(a.message)),!1):a.validValues&&-1===a.validValues.indexOf(o)?(console.error("".concat(r," ").concat(n," invalid value: must be among ").concat(JSON.stringify(a.validValues),', "').concat(o,'" provided')),!1):!(a.children&&!u(o,a.children,"[Validate ".concat(n,"]")))}));return o||a.push.apply(a,n(Object.keys(t).map((function(n){var i=t[n];if("string"==typeof i&&(i={type:i}),i.mandatory){var o=i.mandatory;if("function"==typeof o&&(o=o(e)),o&&void 0===e[n])return console.error("".concat(r,' Missing mandatory key "').concat(n,'"')),!1}return!0})))),a.reduce((function(e,t){return e&&t}),!0)}function h(e){return u(e,s,"[Validate format]")}t.exports={validate:function(e,t){var r=c(e),n=h(t);return r&&n},validateFormat:h,validateInput:c,validateLanguage:function(e){return u(e,l,"[Validate language]")}}},{"./unformatting":9}]},{},[7])(7)},2123:e=>{"use strict";var t=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable;e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},r=0;r<10;r++)t["_"+String.fromCharCode(r)]=r;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var n={};return"abcdefghijklmnopqrst".split("").forEach((function(e){n[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},n)).join("")}catch(i){return!1}}()?Object.assign:function(e,i){for(var o,a,s=function(e){if(null===e||void 0===e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}(e),l=1;l<arguments.length;l++){for(var c in o=Object(arguments[l]))r.call(o,c)&&(s[c]=o[c]);if(t){a=t(o);for(var u=0;u<a.length;u++)n.call(o,a[u])&&(s[a[u]]=o[a[u]])}}return s}},1497:(e,t,r)=>{"use strict";var n=r(3218);function i(){}function o(){}o.resetWarningCache=i,e.exports=function(){function e(e,t,r,i,o,a){if(a!==n){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function t(){return e}e.isRequired=e;var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:o,resetWarningCache:i};return r.PropTypes=r,r}},5173:(e,t,r)=>{e.exports=r(1497)()},3218:e=>{"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},2730:(e,t,r)=>{"use strict";var n=r(5043),i=r(8853);function o(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a=new Set,s={};function l(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(s[e]=t,e=0;e<t.length;e++)a.add(t[e])}var u=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),h=Object.prototype.hasOwnProperty,d=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},g={};function p(e,t,r,n,i,o,a){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=o,this.removeEmptyString=a}var m={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){m[e]=new p(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];m[t]=new p(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){m[e]=new p(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){m[e]=new p(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){m[e]=new p(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){m[e]=new p(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){m[e]=new p(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){m[e]=new p(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){m[e]=new p(e,5,!1,e.toLowerCase(),null,!1,!1)}));var v=/[\-:]([a-z])/g;function b(e){return e[1].toUpperCase()}function y(e,t,r,n){var i=m.hasOwnProperty(t)?m[t]:null;(null!==i?0!==i.type:n||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,r,n){if(null===t||"undefined"===typeof t||function(e,t,r,n){if(null!==r&&0===r.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!n&&(null!==r?!r.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,r,n))return!0;if(n)return!1;if(null!==r)switch(r.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,r,i,n)&&(r=null),n||null===i?function(e){return!!h.call(g,e)||!h.call(f,e)&&(d.test(e)?g[e]=!0:(f[e]=!0,!1))}(t)&&(null===r?e.removeAttribute(t):e.setAttribute(t,""+r)):i.mustUseProperty?e[i.propertyName]=null===r?3!==i.type&&"":r:(t=i.attributeName,n=i.attributeNamespace,null===r?e.removeAttribute(t):(r=3===(i=i.type)||4===i&&!0===r?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(v,b);m[t]=new p(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(v,b);m[t]=new p(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(v,b);m[t]=new p(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){m[e]=new p(e,1,!1,e.toLowerCase(),null,!1,!1)})),m.xlinkHref=new p("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){m[e]=new p(e,1,!1,e.toLowerCase(),null,!0,!0)}));var w=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,S=Symbol.for("react.element"),C=Symbol.for("react.portal"),k=Symbol.for("react.fragment"),x=Symbol.for("react.strict_mode"),E=Symbol.for("react.profiler"),T=Symbol.for("react.provider"),_=Symbol.for("react.context"),A=Symbol.for("react.forward_ref"),R=Symbol.for("react.suspense"),O=Symbol.for("react.suspense_list"),M=Symbol.for("react.memo"),I=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var P=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var N=Symbol.iterator;function D(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=N&&e[N]||e["@@iterator"])?e:null}var F,L=Object.assign;function H(e){if(void 0===F)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);F=t&&t[1]||""}return"\n"+F+e}var B=!1;function U(e,t){if(!e||B)return"";B=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var n=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){n=c}e.call(t.prototype)}else{try{throw Error()}catch(c){n=c}e()}}catch(c){if(c&&n&&"string"===typeof c.stack){for(var i=c.stack.split("\n"),o=n.stack.split("\n"),a=i.length-1,s=o.length-1;1<=a&&0<=s&&i[a]!==o[s];)s--;for(;1<=a&&0<=s;a--,s--)if(i[a]!==o[s]){if(1!==a||1!==s)do{if(a--,0>--s||i[a]!==o[s]){var l="\n"+i[a].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=a&&0<=s);break}}}finally{B=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?H(e):""}function j(e){switch(e.tag){case 5:return H(e.type);case 16:return H("Lazy");case 13:return H("Suspense");case 19:return H("SuspenseList");case 0:case 2:case 15:return e=U(e.type,!1);case 11:return e=U(e.type.render,!1);case 1:return e=U(e.type,!0);default:return""}}function W(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case k:return"Fragment";case C:return"Portal";case E:return"Profiler";case x:return"StrictMode";case R:return"Suspense";case O:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case _:return(e.displayName||"Context")+".Consumer";case T:return(e._context.displayName||"Context")+".Provider";case A:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case M:return null!==(t=e.displayName||null)?t:W(e.type)||"Memo";case I:t=e._payload,e=e._init;try{return W(e(t))}catch(r){}}return null}function V(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return W(t);case 8:return t===x?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function z(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function q(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function G(e){e._valueTracker||(e._valueTracker=function(e){var t=q(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof r&&"function"===typeof r.get&&"function"===typeof r.set){var i=r.get,o=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){n=""+e,o.call(this,e)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(e){n=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function $(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=q(e)?e.checked?"true":"false":e.value),(e=n)!==r&&(t.setValue(e),!0)}function K(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function Y(e,t){var r=t.checked;return L({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=r?r:e._wrapperState.initialChecked})}function X(e,t){var r=null==t.defaultValue?"":t.defaultValue,n=null!=t.checked?t.checked:t.defaultChecked;r=z(null!=t.value?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function J(e,t){null!=(t=t.checked)&&y(e,"checked",t,!1)}function Z(e,t){J(e,t);var r=z(t.value),n=t.type;if(null!=r)"number"===n?(0===r&&""===e.value||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if("submit"===n||"reset"===n)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,r):t.hasOwnProperty("defaultValue")&&ee(e,t.type,z(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Q(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!("submit"!==n&&"reset"!==n||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}""!==(r=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==r&&(e.name=r)}function ee(e,t,r){"number"===t&&K(e.ownerDocument)===e||(null==r?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var te=Array.isArray;function re(e,t,r,n){if(e=e.options,t){t={};for(var i=0;i<r.length;i++)t["$"+r[i]]=!0;for(r=0;r<e.length;r++)i=t.hasOwnProperty("$"+e[r].value),e[r].selected!==i&&(e[r].selected=i),i&&n&&(e[r].defaultSelected=!0)}else{for(r=""+z(r),t=null,i=0;i<e.length;i++){if(e[i].value===r)return e[i].selected=!0,void(n&&(e[i].defaultSelected=!0));null!==t||e[i].disabled||(t=e[i])}null!==t&&(t.selected=!0)}}function ne(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(o(91));return L({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ie(e,t){var r=t.value;if(null==r){if(r=t.children,t=t.defaultValue,null!=r){if(null!=t)throw Error(o(92));if(te(r)){if(1<r.length)throw Error(o(93));r=r[0]}t=r}null==t&&(t=""),r=t}e._wrapperState={initialValue:z(r)}}function oe(e,t){var r=z(t.value),n=z(t.defaultValue);null!=r&&((r=""+r)!==e.value&&(e.value=r),null==t.defaultValue&&e.defaultValue!==r&&(e.defaultValue=r)),null!=n&&(e.defaultValue=""+n)}function ae(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function se(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?se(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,ue,he=(ue=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,r,n){MSApp.execUnsafeLocalFunction((function(){return ue(e,t)}))}:ue);function de(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&3===r.nodeType)return void(r.nodeValue=t)}e.textContent=t}var fe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ge=["Webkit","ms","Moz","O"];function pe(e,t,r){return null==t||"boolean"===typeof t||""===t?"":r||"number"!==typeof t||0===t||fe.hasOwnProperty(e)&&fe[e]?(""+t).trim():t+"px"}function me(e,t){for(var r in e=e.style,t)if(t.hasOwnProperty(r)){var n=0===r.indexOf("--"),i=pe(r,t[r],n);"float"===r&&(r="cssFloat"),n?e.setProperty(r,i):e[r]=i}}Object.keys(fe).forEach((function(e){ge.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),fe[t]=fe[e]}))}));var ve=L({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function be(e,t){if(t){if(ve[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(o(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(o(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(o(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(o(62))}}function ye(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var we=null;function Se(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Ce=null,ke=null,xe=null;function Ee(e){if(e=yi(e)){if("function"!==typeof Ce)throw Error(o(280));var t=e.stateNode;t&&(t=Si(t),Ce(e.stateNode,e.type,t))}}function Te(e){ke?xe?xe.push(e):xe=[e]:ke=e}function _e(){if(ke){var e=ke,t=xe;if(xe=ke=null,Ee(e),t)for(e=0;e<t.length;e++)Ee(t[e])}}function Ae(e,t){return e(t)}function Re(){}var Oe=!1;function Me(e,t,r){if(Oe)return e(t,r);Oe=!0;try{return Ae(e,t,r)}finally{Oe=!1,(null!==ke||null!==xe)&&(Re(),_e())}}function Ie(e,t){var r=e.stateNode;if(null===r)return null;var n=Si(r);if(null===n)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(n=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!n;break e;default:e=!1}if(e)return null;if(r&&"function"!==typeof r)throw Error(o(231,t,typeof r));return r}var Pe=!1;if(u)try{var Ne={};Object.defineProperty(Ne,"passive",{get:function(){Pe=!0}}),window.addEventListener("test",Ne,Ne),window.removeEventListener("test",Ne,Ne)}catch(ue){Pe=!1}function De(e,t,r,n,i,o,a,s,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(r,c)}catch(u){this.onError(u)}}var Fe=!1,Le=null,He=!1,Be=null,Ue={onError:function(e){Fe=!0,Le=e}};function je(e,t,r,n,i,o,a,s,l){Fe=!1,Le=null,De.apply(Ue,arguments)}function We(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(r=t.return),e=t.return}while(e)}return 3===t.tag?r:null}function Ve(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function ze(e){if(We(e)!==e)throw Error(o(188))}function qe(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=We(e)))throw Error(o(188));return t!==e?null:e}for(var r=e,n=t;;){var i=r.return;if(null===i)break;var a=i.alternate;if(null===a){if(null!==(n=i.return)){r=n;continue}break}if(i.child===a.child){for(a=i.child;a;){if(a===r)return ze(i),e;if(a===n)return ze(i),t;a=a.sibling}throw Error(o(188))}if(r.return!==n.return)r=i,n=a;else{for(var s=!1,l=i.child;l;){if(l===r){s=!0,r=i,n=a;break}if(l===n){s=!0,n=i,r=a;break}l=l.sibling}if(!s){for(l=a.child;l;){if(l===r){s=!0,r=a,n=i;break}if(l===n){s=!0,n=a,r=i;break}l=l.sibling}if(!s)throw Error(o(189))}}if(r.alternate!==n)throw Error(o(190))}if(3!==r.tag)throw Error(o(188));return r.stateNode.current===r?e:t}(e))?Ge(e):null}function Ge(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=Ge(e);if(null!==t)return t;e=e.sibling}return null}var $e=i.unstable_scheduleCallback,Ke=i.unstable_cancelCallback,Ye=i.unstable_shouldYield,Xe=i.unstable_requestPaint,Je=i.unstable_now,Ze=i.unstable_getCurrentPriorityLevel,Qe=i.unstable_ImmediatePriority,et=i.unstable_UserBlockingPriority,tt=i.unstable_NormalPriority,rt=i.unstable_LowPriority,nt=i.unstable_IdlePriority,it=null,ot=null;var at=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(st(e)/lt|0)|0},st=Math.log,lt=Math.LN2;var ct=64,ut=4194304;function ht(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function dt(e,t){var r=e.pendingLanes;if(0===r)return 0;var n=0,i=e.suspendedLanes,o=e.pingedLanes,a=268435455&r;if(0!==a){var s=a&~i;0!==s?n=ht(s):0!==(o&=a)&&(n=ht(o))}else 0!==(a=r&~i)?n=ht(a):0!==o&&(n=ht(o));if(0===n)return 0;if(0!==t&&t!==n&&0===(t&i)&&((i=n&-n)>=(o=t&-t)||16===i&&0!==(4194240&o)))return t;if(0!==(4&n)&&(n|=16&r),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=n;0<t;)i=1<<(r=31-at(t)),n|=e[r],t&=~i;return n}function ft(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function gt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function pt(){var e=ct;return 0===(4194240&(ct<<=1))&&(ct=64),e}function mt(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function vt(e,t,r){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-at(t)]=r}function bt(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-at(r),i=1<<n;i&t|e[n]&t&&(e[n]|=t),r&=~i}}var yt=0;function wt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var St,Ct,kt,xt,Et,Tt=!1,_t=[],At=null,Rt=null,Ot=null,Mt=new Map,It=new Map,Pt=[],Nt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Dt(e,t){switch(e){case"focusin":case"focusout":At=null;break;case"dragenter":case"dragleave":Rt=null;break;case"mouseover":case"mouseout":Ot=null;break;case"pointerover":case"pointerout":Mt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":It.delete(t.pointerId)}}function Ft(e,t,r,n,i,o){return null===e||e.nativeEvent!==o?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:o,targetContainers:[i]},null!==t&&(null!==(t=yi(t))&&Ct(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,null!==i&&-1===t.indexOf(i)&&t.push(i),e)}function Lt(e){var t=bi(e.target);if(null!==t){var r=We(t);if(null!==r)if(13===(t=r.tag)){if(null!==(t=Ve(r)))return e.blockedOn=t,void Et(e.priority,(function(){kt(r)}))}else if(3===t&&r.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===r.tag?r.stateNode.containerInfo:null)}e.blockedOn=null}function Ht(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var r=Yt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==r)return null!==(t=yi(r))&&Ct(t),e.blockedOn=r,!1;var n=new(r=e.nativeEvent).constructor(r.type,r);we=n,r.target.dispatchEvent(n),we=null,t.shift()}return!0}function Bt(e,t,r){Ht(e)&&r.delete(t)}function Ut(){Tt=!1,null!==At&&Ht(At)&&(At=null),null!==Rt&&Ht(Rt)&&(Rt=null),null!==Ot&&Ht(Ot)&&(Ot=null),Mt.forEach(Bt),It.forEach(Bt)}function jt(e,t){e.blockedOn===t&&(e.blockedOn=null,Tt||(Tt=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,Ut)))}function Wt(e){function t(t){return jt(t,e)}if(0<_t.length){jt(_t[0],e);for(var r=1;r<_t.length;r++){var n=_t[r];n.blockedOn===e&&(n.blockedOn=null)}}for(null!==At&&jt(At,e),null!==Rt&&jt(Rt,e),null!==Ot&&jt(Ot,e),Mt.forEach(t),It.forEach(t),r=0;r<Pt.length;r++)(n=Pt[r]).blockedOn===e&&(n.blockedOn=null);for(;0<Pt.length&&null===(r=Pt[0]).blockedOn;)Lt(r),null===r.blockedOn&&Pt.shift()}var Vt=w.ReactCurrentBatchConfig,zt=!0;function qt(e,t,r,n){var i=yt,o=Vt.transition;Vt.transition=null;try{yt=1,$t(e,t,r,n)}finally{yt=i,Vt.transition=o}}function Gt(e,t,r,n){var i=yt,o=Vt.transition;Vt.transition=null;try{yt=4,$t(e,t,r,n)}finally{yt=i,Vt.transition=o}}function $t(e,t,r,n){if(zt){var i=Yt(e,t,r,n);if(null===i)zn(e,t,n,Kt,r),Dt(e,n);else if(function(e,t,r,n,i){switch(t){case"focusin":return At=Ft(At,e,t,r,n,i),!0;case"dragenter":return Rt=Ft(Rt,e,t,r,n,i),!0;case"mouseover":return Ot=Ft(Ot,e,t,r,n,i),!0;case"pointerover":var o=i.pointerId;return Mt.set(o,Ft(Mt.get(o)||null,e,t,r,n,i)),!0;case"gotpointercapture":return o=i.pointerId,It.set(o,Ft(It.get(o)||null,e,t,r,n,i)),!0}return!1}(i,e,t,r,n))n.stopPropagation();else if(Dt(e,n),4&t&&-1<Nt.indexOf(e)){for(;null!==i;){var o=yi(i);if(null!==o&&St(o),null===(o=Yt(e,t,r,n))&&zn(e,t,n,Kt,r),o===i)break;i=o}null!==i&&n.stopPropagation()}else zn(e,t,n,null,r)}}var Kt=null;function Yt(e,t,r,n){if(Kt=null,null!==(e=bi(e=Se(n))))if(null===(t=We(e)))e=null;else if(13===(r=t.tag)){if(null!==(e=Ve(t)))return e;e=null}else if(3===r){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Kt=e,null}function Xt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Ze()){case Qe:return 1;case et:return 4;case tt:case rt:return 16;case nt:return 536870912;default:return 16}default:return 16}}var Jt=null,Zt=null,Qt=null;function er(){if(Qt)return Qt;var e,t,r=Zt,n=r.length,i="value"in Jt?Jt.value:Jt.textContent,o=i.length;for(e=0;e<n&&r[e]===i[e];e++);var a=n-e;for(t=1;t<=a&&r[n-t]===i[o-t];t++);return Qt=i.slice(e,1<t?1-t:void 0)}function tr(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function rr(){return!0}function nr(){return!1}function ir(e){function t(t,r,n,i,o){for(var a in this._reactName=t,this._targetInst=n,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null,e)e.hasOwnProperty(a)&&(t=e[a],this[a]=t?t(i):i[a]);return this.isDefaultPrevented=(null!=i.defaultPrevented?i.defaultPrevented:!1===i.returnValue)?rr:nr,this.isPropagationStopped=nr,this}return L(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=rr)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=rr)},persist:function(){},isPersistent:rr}),t}var or,ar,sr,lr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},cr=ir(lr),ur=L({},lr,{view:0,detail:0}),hr=ir(ur),dr=L({},ur,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:xr,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==sr&&(sr&&"mousemove"===e.type?(or=e.screenX-sr.screenX,ar=e.screenY-sr.screenY):ar=or=0,sr=e),or)},movementY:function(e){return"movementY"in e?e.movementY:ar}}),fr=ir(dr),gr=ir(L({},dr,{dataTransfer:0})),pr=ir(L({},ur,{relatedTarget:0})),mr=ir(L({},lr,{animationName:0,elapsedTime:0,pseudoElement:0})),vr=L({},lr,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),br=ir(vr),yr=ir(L({},lr,{data:0})),wr={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Sr={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Cr={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function kr(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Cr[e])&&!!t[e]}function xr(){return kr}var Er=L({},ur,{key:function(e){if(e.key){var t=wr[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tr(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?Sr[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:xr,charCode:function(e){return"keypress"===e.type?tr(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tr(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Tr=ir(Er),_r=ir(L({},dr,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Ar=ir(L({},ur,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:xr})),Rr=ir(L({},lr,{propertyName:0,elapsedTime:0,pseudoElement:0})),Or=L({},dr,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Mr=ir(Or),Ir=[9,13,27,32],Pr=u&&"CompositionEvent"in window,Nr=null;u&&"documentMode"in document&&(Nr=document.documentMode);var Dr=u&&"TextEvent"in window&&!Nr,Fr=u&&(!Pr||Nr&&8<Nr&&11>=Nr),Lr=String.fromCharCode(32),Hr=!1;function Br(e,t){switch(e){case"keyup":return-1!==Ir.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ur(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var jr=!1;var Wr={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Vr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Wr[e.type]:"textarea"===t}function zr(e,t,r,n){Te(n),0<(t=Gn(t,"onChange")).length&&(r=new cr("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var qr=null,Gr=null;function $r(e){Hn(e,0)}function Kr(e){if($(wi(e)))return e}function Yr(e,t){if("change"===e)return t}var Xr=!1;if(u){var Jr;if(u){var Zr="oninput"in document;if(!Zr){var Qr=document.createElement("div");Qr.setAttribute("oninput","return;"),Zr="function"===typeof Qr.oninput}Jr=Zr}else Jr=!1;Xr=Jr&&(!document.documentMode||9<document.documentMode)}function en(){qr&&(qr.detachEvent("onpropertychange",tn),Gr=qr=null)}function tn(e){if("value"===e.propertyName&&Kr(Gr)){var t=[];zr(t,Gr,e,Se(e)),Me($r,t)}}function rn(e,t,r){"focusin"===e?(en(),Gr=r,(qr=t).attachEvent("onpropertychange",tn)):"focusout"===e&&en()}function nn(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Kr(Gr)}function on(e,t){if("click"===e)return Kr(t)}function an(e,t){if("input"===e||"change"===e)return Kr(t)}var sn="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function ln(e,t){if(sn(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!h.call(t,i)||!sn(e[i],t[i]))return!1}return!0}function cn(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function un(e,t){var r,n=cn(e);for(e=0;n;){if(3===n.nodeType){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=cn(n)}}function hn(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?hn(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function dn(){for(var e=window,t=K();t instanceof e.HTMLIFrameElement;){try{var r="string"===typeof t.contentWindow.location.href}catch(n){r=!1}if(!r)break;t=K((e=t.contentWindow).document)}return t}function fn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function gn(e){var t=dn(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&hn(r.ownerDocument.documentElement,r)){if(null!==n&&fn(r))if(t=n.start,void 0===(e=n.end)&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if((e=(t=r.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var i=r.textContent.length,o=Math.min(n.start,i);n=void 0===n.end?o:Math.min(n.end,i),!e.extend&&o>n&&(i=n,n=o,o=i),i=un(r,o);var a=un(r,n);i&&a&&(1!==e.rangeCount||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&((t=t.createRange()).setStart(i.node,i.offset),e.removeAllRanges(),o>n?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}for(t=[],e=r;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof r.focus&&r.focus(),r=0;r<t.length;r++)(e=t[r]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var pn=u&&"documentMode"in document&&11>=document.documentMode,mn=null,vn=null,bn=null,yn=!1;function wn(e,t,r){var n=r.window===r?r.document:9===r.nodeType?r:r.ownerDocument;yn||null==mn||mn!==K(n)||("selectionStart"in(n=mn)&&fn(n)?n={start:n.selectionStart,end:n.selectionEnd}:n={anchorNode:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset},bn&&ln(bn,n)||(bn=n,0<(n=Gn(vn,"onSelect")).length&&(t=new cr("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=mn)))}function Sn(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Cn={animationend:Sn("Animation","AnimationEnd"),animationiteration:Sn("Animation","AnimationIteration"),animationstart:Sn("Animation","AnimationStart"),transitionend:Sn("Transition","TransitionEnd")},kn={},xn={};function En(e){if(kn[e])return kn[e];if(!Cn[e])return e;var t,r=Cn[e];for(t in r)if(r.hasOwnProperty(t)&&t in xn)return kn[e]=r[t];return e}u&&(xn=document.createElement("div").style,"AnimationEvent"in window||(delete Cn.animationend.animation,delete Cn.animationiteration.animation,delete Cn.animationstart.animation),"TransitionEvent"in window||delete Cn.transitionend.transition);var Tn=En("animationend"),_n=En("animationiteration"),An=En("animationstart"),Rn=En("transitionend"),On=new Map,Mn="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function In(e,t){On.set(e,t),l(t,[e])}for(var Pn=0;Pn<Mn.length;Pn++){var Nn=Mn[Pn];In(Nn.toLowerCase(),"on"+(Nn[0].toUpperCase()+Nn.slice(1)))}In(Tn,"onAnimationEnd"),In(_n,"onAnimationIteration"),In(An,"onAnimationStart"),In("dblclick","onDoubleClick"),In("focusin","onFocus"),In("focusout","onBlur"),In(Rn,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Dn="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Fn=new Set("cancel close invalid load scroll toggle".split(" ").concat(Dn));function Ln(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,function(e,t,r,n,i,a,s,l,c){if(je.apply(this,arguments),Fe){if(!Fe)throw Error(o(198));var u=Le;Fe=!1,Le=null,He||(He=!0,Be=u)}}(n,t,void 0,e),e.currentTarget=null}function Hn(e,t){t=0!==(4&t);for(var r=0;r<e.length;r++){var n=e[r],i=n.event;n=n.listeners;e:{var o=void 0;if(t)for(var a=n.length-1;0<=a;a--){var s=n[a],l=s.instance,c=s.currentTarget;if(s=s.listener,l!==o&&i.isPropagationStopped())break e;Ln(i,s,c),o=l}else for(a=0;a<n.length;a++){if(l=(s=n[a]).instance,c=s.currentTarget,s=s.listener,l!==o&&i.isPropagationStopped())break e;Ln(i,s,c),o=l}}}if(He)throw e=Be,He=!1,Be=null,e}function Bn(e,t){var r=t[pi];void 0===r&&(r=t[pi]=new Set);var n=e+"__bubble";r.has(n)||(Vn(t,e,2,!1),r.add(n))}function Un(e,t,r){var n=0;t&&(n|=4),Vn(r,e,n,t)}var jn="_reactListening"+Math.random().toString(36).slice(2);function Wn(e){if(!e[jn]){e[jn]=!0,a.forEach((function(t){"selectionchange"!==t&&(Fn.has(t)||Un(t,!1,e),Un(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[jn]||(t[jn]=!0,Un("selectionchange",!1,t))}}function Vn(e,t,r,n){switch(Xt(t)){case 1:var i=qt;break;case 4:i=Gt;break;default:i=$t}r=i.bind(null,t,r,e),i=void 0,!Pe||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(i=!0),n?void 0!==i?e.addEventListener(t,r,{capture:!0,passive:i}):e.addEventListener(t,r,!0):void 0!==i?e.addEventListener(t,r,{passive:i}):e.addEventListener(t,r,!1)}function zn(e,t,r,n,i){var o=n;if(0===(1&t)&&0===(2&t)&&null!==n)e:for(;;){if(null===n)return;var a=n.tag;if(3===a||4===a){var s=n.stateNode.containerInfo;if(s===i||8===s.nodeType&&s.parentNode===i)break;if(4===a)for(a=n.return;null!==a;){var l=a.tag;if((3===l||4===l)&&((l=a.stateNode.containerInfo)===i||8===l.nodeType&&l.parentNode===i))return;a=a.return}for(;null!==s;){if(null===(a=bi(s)))return;if(5===(l=a.tag)||6===l){n=o=a;continue e}s=s.parentNode}}n=n.return}Me((function(){var n=o,i=Se(r),a=[];e:{var s=On.get(e);if(void 0!==s){var l=cr,c=e;switch(e){case"keypress":if(0===tr(r))break e;case"keydown":case"keyup":l=Tr;break;case"focusin":c="focus",l=pr;break;case"focusout":c="blur",l=pr;break;case"beforeblur":case"afterblur":l=pr;break;case"click":if(2===r.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=fr;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=gr;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=Ar;break;case Tn:case _n:case An:l=mr;break;case Rn:l=Rr;break;case"scroll":l=hr;break;case"wheel":l=Mr;break;case"copy":case"cut":case"paste":l=br;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=_r}var u=0!==(4&t),h=!u&&"scroll"===e,d=u?null!==s?s+"Capture":null:s;u=[];for(var f,g=n;null!==g;){var p=(f=g).stateNode;if(5===f.tag&&null!==p&&(f=p,null!==d&&(null!=(p=Ie(g,d))&&u.push(qn(g,p,f)))),h)break;g=g.return}0<u.length&&(s=new l(s,c,null,r,i),a.push({event:s,listeners:u}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(s="mouseover"===e||"pointerover"===e)||r===we||!(c=r.relatedTarget||r.fromElement)||!bi(c)&&!c[gi])&&(l||s)&&(s=i.window===i?i:(s=i.ownerDocument)?s.defaultView||s.parentWindow:window,l?(l=n,null!==(c=(c=r.relatedTarget||r.toElement)?bi(c):null)&&(c!==(h=We(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=n),l!==c)){if(u=fr,p="onMouseLeave",d="onMouseEnter",g="mouse","pointerout"!==e&&"pointerover"!==e||(u=_r,p="onPointerLeave",d="onPointerEnter",g="pointer"),h=null==l?s:wi(l),f=null==c?s:wi(c),(s=new u(p,g+"leave",l,r,i)).target=h,s.relatedTarget=f,p=null,bi(i)===n&&((u=new u(d,g+"enter",c,r,i)).target=f,u.relatedTarget=h,p=u),h=p,l&&c)e:{for(d=c,g=0,f=u=l;f;f=$n(f))g++;for(f=0,p=d;p;p=$n(p))f++;for(;0<g-f;)u=$n(u),g--;for(;0<f-g;)d=$n(d),f--;for(;g--;){if(u===d||null!==d&&u===d.alternate)break e;u=$n(u),d=$n(d)}u=null}else u=null;null!==l&&Kn(a,s,l,u,!1),null!==c&&null!==h&&Kn(a,h,c,u,!0)}if("select"===(l=(s=n?wi(n):window).nodeName&&s.nodeName.toLowerCase())||"input"===l&&"file"===s.type)var m=Yr;else if(Vr(s))if(Xr)m=an;else{m=nn;var v=rn}else(l=s.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===s.type||"radio"===s.type)&&(m=on);switch(m&&(m=m(e,n))?zr(a,m,r,i):(v&&v(e,s,n),"focusout"===e&&(v=s._wrapperState)&&v.controlled&&"number"===s.type&&ee(s,"number",s.value)),v=n?wi(n):window,e){case"focusin":(Vr(v)||"true"===v.contentEditable)&&(mn=v,vn=n,bn=null);break;case"focusout":bn=vn=mn=null;break;case"mousedown":yn=!0;break;case"contextmenu":case"mouseup":case"dragend":yn=!1,wn(a,r,i);break;case"selectionchange":if(pn)break;case"keydown":case"keyup":wn(a,r,i)}var b;if(Pr)e:{switch(e){case"compositionstart":var y="onCompositionStart";break e;case"compositionend":y="onCompositionEnd";break e;case"compositionupdate":y="onCompositionUpdate";break e}y=void 0}else jr?Br(e,r)&&(y="onCompositionEnd"):"keydown"===e&&229===r.keyCode&&(y="onCompositionStart");y&&(Fr&&"ko"!==r.locale&&(jr||"onCompositionStart"!==y?"onCompositionEnd"===y&&jr&&(b=er()):(Zt="value"in(Jt=i)?Jt.value:Jt.textContent,jr=!0)),0<(v=Gn(n,y)).length&&(y=new yr(y,e,null,r,i),a.push({event:y,listeners:v}),b?y.data=b:null!==(b=Ur(r))&&(y.data=b))),(b=Dr?function(e,t){switch(e){case"compositionend":return Ur(t);case"keypress":return 32!==t.which?null:(Hr=!0,Lr);case"textInput":return(e=t.data)===Lr&&Hr?null:e;default:return null}}(e,r):function(e,t){if(jr)return"compositionend"===e||!Pr&&Br(e,t)?(e=er(),Qt=Zt=Jt=null,jr=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Fr&&"ko"!==t.locale?null:t.data}}(e,r))&&(0<(n=Gn(n,"onBeforeInput")).length&&(i=new yr("onBeforeInput","beforeinput",null,r,i),a.push({event:i,listeners:n}),i.data=b))}Hn(a,t)}))}function qn(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Gn(e,t){for(var r=t+"Capture",n=[];null!==e;){var i=e,o=i.stateNode;5===i.tag&&null!==o&&(i=o,null!=(o=Ie(e,r))&&n.unshift(qn(e,o,i)),null!=(o=Ie(e,t))&&n.push(qn(e,o,i))),e=e.return}return n}function $n(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Kn(e,t,r,n,i){for(var o=t._reactName,a=[];null!==r&&r!==n;){var s=r,l=s.alternate,c=s.stateNode;if(null!==l&&l===n)break;5===s.tag&&null!==c&&(s=c,i?null!=(l=Ie(r,o))&&a.unshift(qn(r,l,s)):i||null!=(l=Ie(r,o))&&a.push(qn(r,l,s))),r=r.return}0!==a.length&&e.push({event:t,listeners:a})}var Yn=/\r\n?/g,Xn=/\u0000|\uFFFD/g;function Jn(e){return("string"===typeof e?e:""+e).replace(Yn,"\n").replace(Xn,"")}function Zn(e,t,r){if(t=Jn(t),Jn(e)!==t&&r)throw Error(o(425))}function Qn(){}var ei=null,ti=null;function ri(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ni="function"===typeof setTimeout?setTimeout:void 0,ii="function"===typeof clearTimeout?clearTimeout:void 0,oi="function"===typeof Promise?Promise:void 0,ai="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof oi?function(e){return oi.resolve(null).then(e).catch(si)}:ni;function si(e){setTimeout((function(){throw e}))}function li(e,t){var r=t,n=0;do{var i=r.nextSibling;if(e.removeChild(r),i&&8===i.nodeType)if("/$"===(r=i.data)){if(0===n)return e.removeChild(i),void Wt(t);n--}else"$"!==r&&"$?"!==r&&"$!"!==r||n++;r=i}while(r);Wt(t)}function ci(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function ui(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var r=e.data;if("$"===r||"$!"===r||"$?"===r){if(0===t)return e;t--}else"/$"===r&&t++}e=e.previousSibling}return null}var hi=Math.random().toString(36).slice(2),di="__reactFiber$"+hi,fi="__reactProps$"+hi,gi="__reactContainer$"+hi,pi="__reactEvents$"+hi,mi="__reactListeners$"+hi,vi="__reactHandles$"+hi;function bi(e){var t=e[di];if(t)return t;for(var r=e.parentNode;r;){if(t=r[gi]||r[di]){if(r=t.alternate,null!==t.child||null!==r&&null!==r.child)for(e=ui(e);null!==e;){if(r=e[di])return r;e=ui(e)}return t}r=(e=r).parentNode}return null}function yi(e){return!(e=e[di]||e[gi])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function wi(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(o(33))}function Si(e){return e[fi]||null}var Ci=[],ki=-1;function xi(e){return{current:e}}function Ei(e){0>ki||(e.current=Ci[ki],Ci[ki]=null,ki--)}function Ti(e,t){ki++,Ci[ki]=e.current,e.current=t}var _i={},Ai=xi(_i),Ri=xi(!1),Oi=_i;function Mi(e,t){var r=e.type.contextTypes;if(!r)return _i;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var i,o={};for(i in r)o[i]=t[i];return n&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=o),o}function Ii(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Pi(){Ei(Ri),Ei(Ai)}function Ni(e,t,r){if(Ai.current!==_i)throw Error(o(168));Ti(Ai,t),Ti(Ri,r)}function Di(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,"function"!==typeof n.getChildContext)return r;for(var i in n=n.getChildContext())if(!(i in t))throw Error(o(108,V(e)||"Unknown",i));return L({},r,n)}function Fi(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||_i,Oi=Ai.current,Ti(Ai,e),Ti(Ri,Ri.current),!0}function Li(e,t,r){var n=e.stateNode;if(!n)throw Error(o(169));r?(e=Di(e,t,Oi),n.__reactInternalMemoizedMergedChildContext=e,Ei(Ri),Ei(Ai),Ti(Ai,e)):Ei(Ri),Ti(Ri,r)}var Hi=null,Bi=!1,Ui=!1;function ji(e){null===Hi?Hi=[e]:Hi.push(e)}function Wi(){if(!Ui&&null!==Hi){Ui=!0;var e=0,t=yt;try{var r=Hi;for(yt=1;e<r.length;e++){var n=r[e];do{n=n(!0)}while(null!==n)}Hi=null,Bi=!1}catch(i){throw null!==Hi&&(Hi=Hi.slice(e+1)),$e(Qe,Wi),i}finally{yt=t,Ui=!1}}return null}var Vi=[],zi=0,qi=null,Gi=0,$i=[],Ki=0,Yi=null,Xi=1,Ji="";function Zi(e,t){Vi[zi++]=Gi,Vi[zi++]=qi,qi=e,Gi=t}function Qi(e,t,r){$i[Ki++]=Xi,$i[Ki++]=Ji,$i[Ki++]=Yi,Yi=e;var n=Xi;e=Ji;var i=32-at(n)-1;n&=~(1<<i),r+=1;var o=32-at(t)+i;if(30<o){var a=i-i%5;o=(n&(1<<a)-1).toString(32),n>>=a,i-=a,Xi=1<<32-at(t)+i|r<<i|n,Ji=o+e}else Xi=1<<o|r<<i|n,Ji=e}function eo(e){null!==e.return&&(Zi(e,1),Qi(e,1,0))}function to(e){for(;e===qi;)qi=Vi[--zi],Vi[zi]=null,Gi=Vi[--zi],Vi[zi]=null;for(;e===Yi;)Yi=$i[--Ki],$i[Ki]=null,Ji=$i[--Ki],$i[Ki]=null,Xi=$i[--Ki],$i[Ki]=null}var ro=null,no=null,io=!1,oo=null;function ao(e,t){var r=Mc(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,null===(t=e.deletions)?(e.deletions=[r],e.flags|=16):t.push(r)}function so(e,t){switch(e.tag){case 5:var r=e.type;return null!==(t=1!==t.nodeType||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,ro=e,no=ci(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,ro=e,no=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(r=null!==Yi?{id:Xi,overflow:Ji}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},(r=Mc(18,null,null,0)).stateNode=t,r.return=e,e.child=r,ro=e,no=null,!0);default:return!1}}function lo(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function co(e){if(io){var t=no;if(t){var r=t;if(!so(e,t)){if(lo(e))throw Error(o(418));t=ci(r.nextSibling);var n=ro;t&&so(e,t)?ao(n,r):(e.flags=-4097&e.flags|2,io=!1,ro=e)}}else{if(lo(e))throw Error(o(418));e.flags=-4097&e.flags|2,io=!1,ro=e}}}function uo(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;ro=e}function ho(e){if(e!==ro)return!1;if(!io)return uo(e),io=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!ri(e.type,e.memoizedProps)),t&&(t=no)){if(lo(e))throw fo(),Error(o(418));for(;t;)ao(e,t),t=ci(t.nextSibling)}if(uo(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(o(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var r=e.data;if("/$"===r){if(0===t){no=ci(e.nextSibling);break e}t--}else"$"!==r&&"$!"!==r&&"$?"!==r||t++}e=e.nextSibling}no=null}}else no=ro?ci(e.stateNode.nextSibling):null;return!0}function fo(){for(var e=no;e;)e=ci(e.nextSibling)}function go(){no=ro=null,io=!1}function po(e){null===oo?oo=[e]:oo.push(e)}var mo=w.ReactCurrentBatchConfig;function vo(e,t,r){if(null!==(e=r.ref)&&"function"!==typeof e&&"object"!==typeof e){if(r._owner){if(r=r._owner){if(1!==r.tag)throw Error(o(309));var n=r.stateNode}if(!n)throw Error(o(147,e));var i=n,a=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===a?t.ref:(t=function(e){var t=i.refs;null===e?delete t[a]:t[a]=e},t._stringRef=a,t)}if("string"!==typeof e)throw Error(o(284));if(!r._owner)throw Error(o(290,e))}return e}function bo(e,t){throw e=Object.prototype.toString.call(t),Error(o(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function yo(e){return(0,e._init)(e._payload)}function wo(e){function t(t,r){if(e){var n=t.deletions;null===n?(t.deletions=[r],t.flags|=16):n.push(r)}}function r(r,n){if(!e)return null;for(;null!==n;)t(r,n),n=n.sibling;return null}function n(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function i(e,t){return(e=Pc(e,t)).index=0,e.sibling=null,e}function a(t,r,n){return t.index=n,e?null!==(n=t.alternate)?(n=n.index)<r?(t.flags|=2,r):n:(t.flags|=2,r):(t.flags|=1048576,r)}function s(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,r,n){return null===t||6!==t.tag?((t=Lc(r,e.mode,n)).return=e,t):((t=i(t,r)).return=e,t)}function c(e,t,r,n){var o=r.type;return o===k?h(e,t,r.props.children,n,r.key):null!==t&&(t.elementType===o||"object"===typeof o&&null!==o&&o.$$typeof===I&&yo(o)===t.type)?((n=i(t,r.props)).ref=vo(e,t,r),n.return=e,n):((n=Nc(r.type,r.key,r.props,null,e.mode,n)).ref=vo(e,t,r),n.return=e,n)}function u(e,t,r,n){return null===t||4!==t.tag||t.stateNode.containerInfo!==r.containerInfo||t.stateNode.implementation!==r.implementation?((t=Hc(r,e.mode,n)).return=e,t):((t=i(t,r.children||[])).return=e,t)}function h(e,t,r,n,o){return null===t||7!==t.tag?((t=Dc(r,e.mode,n,o)).return=e,t):((t=i(t,r)).return=e,t)}function d(e,t,r){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Lc(""+t,e.mode,r)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case S:return(r=Nc(t.type,t.key,t.props,null,e.mode,r)).ref=vo(e,null,t),r.return=e,r;case C:return(t=Hc(t,e.mode,r)).return=e,t;case I:return d(e,(0,t._init)(t._payload),r)}if(te(t)||D(t))return(t=Dc(t,e.mode,r,null)).return=e,t;bo(e,t)}return null}function f(e,t,r,n){var i=null!==t?t.key:null;if("string"===typeof r&&""!==r||"number"===typeof r)return null!==i?null:l(e,t,""+r,n);if("object"===typeof r&&null!==r){switch(r.$$typeof){case S:return r.key===i?c(e,t,r,n):null;case C:return r.key===i?u(e,t,r,n):null;case I:return f(e,t,(i=r._init)(r._payload),n)}if(te(r)||D(r))return null!==i?null:h(e,t,r,n,null);bo(e,r)}return null}function g(e,t,r,n,i){if("string"===typeof n&&""!==n||"number"===typeof n)return l(t,e=e.get(r)||null,""+n,i);if("object"===typeof n&&null!==n){switch(n.$$typeof){case S:return c(t,e=e.get(null===n.key?r:n.key)||null,n,i);case C:return u(t,e=e.get(null===n.key?r:n.key)||null,n,i);case I:return g(e,t,r,(0,n._init)(n._payload),i)}if(te(n)||D(n))return h(t,e=e.get(r)||null,n,i,null);bo(t,n)}return null}function p(i,o,s,l){for(var c=null,u=null,h=o,p=o=0,m=null;null!==h&&p<s.length;p++){h.index>p?(m=h,h=null):m=h.sibling;var v=f(i,h,s[p],l);if(null===v){null===h&&(h=m);break}e&&h&&null===v.alternate&&t(i,h),o=a(v,o,p),null===u?c=v:u.sibling=v,u=v,h=m}if(p===s.length)return r(i,h),io&&Zi(i,p),c;if(null===h){for(;p<s.length;p++)null!==(h=d(i,s[p],l))&&(o=a(h,o,p),null===u?c=h:u.sibling=h,u=h);return io&&Zi(i,p),c}for(h=n(i,h);p<s.length;p++)null!==(m=g(h,i,p,s[p],l))&&(e&&null!==m.alternate&&h.delete(null===m.key?p:m.key),o=a(m,o,p),null===u?c=m:u.sibling=m,u=m);return e&&h.forEach((function(e){return t(i,e)})),io&&Zi(i,p),c}function m(i,s,l,c){var u=D(l);if("function"!==typeof u)throw Error(o(150));if(null==(l=u.call(l)))throw Error(o(151));for(var h=u=null,p=s,m=s=0,v=null,b=l.next();null!==p&&!b.done;m++,b=l.next()){p.index>m?(v=p,p=null):v=p.sibling;var y=f(i,p,b.value,c);if(null===y){null===p&&(p=v);break}e&&p&&null===y.alternate&&t(i,p),s=a(y,s,m),null===h?u=y:h.sibling=y,h=y,p=v}if(b.done)return r(i,p),io&&Zi(i,m),u;if(null===p){for(;!b.done;m++,b=l.next())null!==(b=d(i,b.value,c))&&(s=a(b,s,m),null===h?u=b:h.sibling=b,h=b);return io&&Zi(i,m),u}for(p=n(i,p);!b.done;m++,b=l.next())null!==(b=g(p,i,m,b.value,c))&&(e&&null!==b.alternate&&p.delete(null===b.key?m:b.key),s=a(b,s,m),null===h?u=b:h.sibling=b,h=b);return e&&p.forEach((function(e){return t(i,e)})),io&&Zi(i,m),u}return function e(n,o,a,l){if("object"===typeof a&&null!==a&&a.type===k&&null===a.key&&(a=a.props.children),"object"===typeof a&&null!==a){switch(a.$$typeof){case S:e:{for(var c=a.key,u=o;null!==u;){if(u.key===c){if((c=a.type)===k){if(7===u.tag){r(n,u.sibling),(o=i(u,a.props.children)).return=n,n=o;break e}}else if(u.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===I&&yo(c)===u.type){r(n,u.sibling),(o=i(u,a.props)).ref=vo(n,u,a),o.return=n,n=o;break e}r(n,u);break}t(n,u),u=u.sibling}a.type===k?((o=Dc(a.props.children,n.mode,l,a.key)).return=n,n=o):((l=Nc(a.type,a.key,a.props,null,n.mode,l)).ref=vo(n,o,a),l.return=n,n=l)}return s(n);case C:e:{for(u=a.key;null!==o;){if(o.key===u){if(4===o.tag&&o.stateNode.containerInfo===a.containerInfo&&o.stateNode.implementation===a.implementation){r(n,o.sibling),(o=i(o,a.children||[])).return=n,n=o;break e}r(n,o);break}t(n,o),o=o.sibling}(o=Hc(a,n.mode,l)).return=n,n=o}return s(n);case I:return e(n,o,(u=a._init)(a._payload),l)}if(te(a))return p(n,o,a,l);if(D(a))return m(n,o,a,l);bo(n,a)}return"string"===typeof a&&""!==a||"number"===typeof a?(a=""+a,null!==o&&6===o.tag?(r(n,o.sibling),(o=i(o,a)).return=n,n=o):(r(n,o),(o=Lc(a,n.mode,l)).return=n,n=o),s(n)):r(n,o)}}var So=wo(!0),Co=wo(!1),ko=xi(null),xo=null,Eo=null,To=null;function _o(){To=Eo=xo=null}function Ao(e){var t=ko.current;Ei(ko),e._currentValue=t}function Ro(e,t,r){for(;null!==e;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==n&&(n.childLanes|=t)):null!==n&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function Oo(e,t){xo=e,To=Eo=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(ys=!0),e.firstContext=null)}function Mo(e){var t=e._currentValue;if(To!==e)if(e={context:e,memoizedValue:t,next:null},null===Eo){if(null===xo)throw Error(o(308));Eo=e,xo.dependencies={lanes:0,firstContext:e}}else Eo=Eo.next=e;return t}var Io=null;function Po(e){null===Io?Io=[e]:Io.push(e)}function No(e,t,r,n){var i=t.interleaved;return null===i?(r.next=r,Po(t)):(r.next=i.next,i.next=r),t.interleaved=r,Do(e,n)}function Do(e,t){e.lanes|=t;var r=e.alternate;for(null!==r&&(r.lanes|=t),r=e,e=e.return;null!==e;)e.childLanes|=t,null!==(r=e.alternate)&&(r.childLanes|=t),r=e,e=e.return;return 3===r.tag?r.stateNode:null}var Fo=!1;function Lo(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ho(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Bo(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Uo(e,t,r){var n=e.updateQueue;if(null===n)return null;if(n=n.shared,0!==(2&Al)){var i=n.pending;return null===i?t.next=t:(t.next=i.next,i.next=t),n.pending=t,Do(e,r)}return null===(i=n.interleaved)?(t.next=t,Po(n)):(t.next=i.next,i.next=t),n.interleaved=t,Do(e,r)}function jo(e,t,r){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&r))){var n=t.lanes;r|=n&=e.pendingLanes,t.lanes=r,bt(e,r)}}function Wo(e,t){var r=e.updateQueue,n=e.alternate;if(null!==n&&r===(n=n.updateQueue)){var i=null,o=null;if(null!==(r=r.firstBaseUpdate)){do{var a={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};null===o?i=o=a:o=o.next=a,r=r.next}while(null!==r);null===o?i=o=t:o=o.next=t}else i=o=t;return r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:o,shared:n.shared,effects:n.effects},void(e.updateQueue=r)}null===(e=r.lastBaseUpdate)?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Vo(e,t,r,n){var i=e.updateQueue;Fo=!1;var o=i.firstBaseUpdate,a=i.lastBaseUpdate,s=i.shared.pending;if(null!==s){i.shared.pending=null;var l=s,c=l.next;l.next=null,null===a?o=c:a.next=c,a=l;var u=e.alternate;null!==u&&((s=(u=u.updateQueue).lastBaseUpdate)!==a&&(null===s?u.firstBaseUpdate=c:s.next=c,u.lastBaseUpdate=l))}if(null!==o){var h=i.baseState;for(a=0,u=c=l=null,s=o;;){var d=s.lane,f=s.eventTime;if((n&d)===d){null!==u&&(u=u.next={eventTime:f,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var g=e,p=s;switch(d=t,f=r,p.tag){case 1:if("function"===typeof(g=p.payload)){h=g.call(f,h,d);break e}h=g;break e;case 3:g.flags=-65537&g.flags|128;case 0:if(null===(d="function"===typeof(g=p.payload)?g.call(f,h,d):g)||void 0===d)break e;h=L({},h,d);break e;case 2:Fo=!0}}null!==s.callback&&0!==s.lane&&(e.flags|=64,null===(d=i.effects)?i.effects=[s]:d.push(s))}else f={eventTime:f,lane:d,tag:s.tag,payload:s.payload,callback:s.callback,next:null},null===u?(c=u=f,l=h):u=u.next=f,a|=d;if(null===(s=s.next)){if(null===(s=i.shared.pending))break;s=(d=s).next,d.next=null,i.lastBaseUpdate=d,i.shared.pending=null}}if(null===u&&(l=h),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=u,null!==(t=i.shared.interleaved)){i=t;do{a|=i.lane,i=i.next}while(i!==t)}else null===o&&(i.shared.lanes=0);Fl|=a,e.lanes=a,e.memoizedState=h}}function zo(e,t,r){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var n=e[t],i=n.callback;if(null!==i){if(n.callback=null,n=r,"function"!==typeof i)throw Error(o(191,i));i.call(n)}}}var qo={},Go=xi(qo),$o=xi(qo),Ko=xi(qo);function Yo(e){if(e===qo)throw Error(o(174));return e}function Xo(e,t){switch(Ti(Ko,t),Ti($o,e),Ti(Go,qo),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Ei(Go),Ti(Go,t)}function Jo(){Ei(Go),Ei($o),Ei(Ko)}function Zo(e){Yo(Ko.current);var t=Yo(Go.current),r=le(t,e.type);t!==r&&(Ti($o,e),Ti(Go,r))}function Qo(e){$o.current===e&&(Ei(Go),Ei($o))}var ea=xi(0);function ta(e){for(var t=e;null!==t;){if(13===t.tag){var r=t.memoizedState;if(null!==r&&(null===(r=r.dehydrated)||"$?"===r.data||"$!"===r.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ra=[];function na(){for(var e=0;e<ra.length;e++)ra[e]._workInProgressVersionPrimary=null;ra.length=0}var ia=w.ReactCurrentDispatcher,oa=w.ReactCurrentBatchConfig,aa=0,sa=null,la=null,ca=null,ua=!1,ha=!1,da=0,fa=0;function ga(){throw Error(o(321))}function pa(e,t){if(null===t)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!sn(e[r],t[r]))return!1;return!0}function ma(e,t,r,n,i,a){if(aa=a,sa=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ia.current=null===e||null===e.memoizedState?Qa:es,e=r(n,i),ha){a=0;do{if(ha=!1,da=0,25<=a)throw Error(o(301));a+=1,ca=la=null,t.updateQueue=null,ia.current=ts,e=r(n,i)}while(ha)}if(ia.current=Za,t=null!==la&&null!==la.next,aa=0,ca=la=sa=null,ua=!1,t)throw Error(o(300));return e}function va(){var e=0!==da;return da=0,e}function ba(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===ca?sa.memoizedState=ca=e:ca=ca.next=e,ca}function ya(){if(null===la){var e=sa.alternate;e=null!==e?e.memoizedState:null}else e=la.next;var t=null===ca?sa.memoizedState:ca.next;if(null!==t)ca=t,la=e;else{if(null===e)throw Error(o(310));e={memoizedState:(la=e).memoizedState,baseState:la.baseState,baseQueue:la.baseQueue,queue:la.queue,next:null},null===ca?sa.memoizedState=ca=e:ca=ca.next=e}return ca}function wa(e,t){return"function"===typeof t?t(e):t}function Sa(e){var t=ya(),r=t.queue;if(null===r)throw Error(o(311));r.lastRenderedReducer=e;var n=la,i=n.baseQueue,a=r.pending;if(null!==a){if(null!==i){var s=i.next;i.next=a.next,a.next=s}n.baseQueue=i=a,r.pending=null}if(null!==i){a=i.next,n=n.baseState;var l=s=null,c=null,u=a;do{var h=u.lane;if((aa&h)===h)null!==c&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:e(n,u.action);else{var d={lane:h,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===c?(l=c=d,s=n):c=c.next=d,sa.lanes|=h,Fl|=h}u=u.next}while(null!==u&&u!==a);null===c?s=n:c.next=l,sn(n,t.memoizedState)||(ys=!0),t.memoizedState=n,t.baseState=s,t.baseQueue=c,r.lastRenderedState=n}if(null!==(e=r.interleaved)){i=e;do{a=i.lane,sa.lanes|=a,Fl|=a,i=i.next}while(i!==e)}else null===i&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Ca(e){var t=ya(),r=t.queue;if(null===r)throw Error(o(311));r.lastRenderedReducer=e;var n=r.dispatch,i=r.pending,a=t.memoizedState;if(null!==i){r.pending=null;var s=i=i.next;do{a=e(a,s.action),s=s.next}while(s!==i);sn(a,t.memoizedState)||(ys=!0),t.memoizedState=a,null===t.baseQueue&&(t.baseState=a),r.lastRenderedState=a}return[a,n]}function ka(){}function xa(e,t){var r=sa,n=ya(),i=t(),a=!sn(n.memoizedState,i);if(a&&(n.memoizedState=i,ys=!0),n=n.queue,Fa(_a.bind(null,r,n,e),[e]),n.getSnapshot!==t||a||null!==ca&&1&ca.memoizedState.tag){if(r.flags|=2048,Ma(9,Ta.bind(null,r,n,i,t),void 0,null),null===Rl)throw Error(o(349));0!==(30&aa)||Ea(r,t,i)}return i}function Ea(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},null===(t=sa.updateQueue)?(t={lastEffect:null,stores:null},sa.updateQueue=t,t.stores=[e]):null===(r=t.stores)?t.stores=[e]:r.push(e)}function Ta(e,t,r,n){t.value=r,t.getSnapshot=n,Aa(t)&&Ra(e)}function _a(e,t,r){return r((function(){Aa(t)&&Ra(e)}))}function Aa(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!sn(e,r)}catch(n){return!0}}function Ra(e){var t=Do(e,1);null!==t&&rc(t,e,1,-1)}function Oa(e){var t=ba();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:wa,lastRenderedState:e},t.queue=e,e=e.dispatch=Ka.bind(null,sa,e),[t.memoizedState,e]}function Ma(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},null===(t=sa.updateQueue)?(t={lastEffect:null,stores:null},sa.updateQueue=t,t.lastEffect=e.next=e):null===(r=t.lastEffect)?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e),e}function Ia(){return ya().memoizedState}function Pa(e,t,r,n){var i=ba();sa.flags|=e,i.memoizedState=Ma(1|t,r,void 0,void 0===n?null:n)}function Na(e,t,r,n){var i=ya();n=void 0===n?null:n;var o=void 0;if(null!==la){var a=la.memoizedState;if(o=a.destroy,null!==n&&pa(n,a.deps))return void(i.memoizedState=Ma(t,r,o,n))}sa.flags|=e,i.memoizedState=Ma(1|t,r,o,n)}function Da(e,t){return Pa(8390656,8,e,t)}function Fa(e,t){return Na(2048,8,e,t)}function La(e,t){return Na(4,2,e,t)}function Ha(e,t){return Na(4,4,e,t)}function Ba(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Ua(e,t,r){return r=null!==r&&void 0!==r?r.concat([e]):null,Na(4,4,Ba.bind(null,t,e),r)}function ja(){}function Wa(e,t){var r=ya();t=void 0===t?null:t;var n=r.memoizedState;return null!==n&&null!==t&&pa(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function Va(e,t){var r=ya();t=void 0===t?null:t;var n=r.memoizedState;return null!==n&&null!==t&&pa(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function za(e,t,r){return 0===(21&aa)?(e.baseState&&(e.baseState=!1,ys=!0),e.memoizedState=r):(sn(r,t)||(r=pt(),sa.lanes|=r,Fl|=r,e.baseState=!0),t)}function qa(e,t){var r=yt;yt=0!==r&&4>r?r:4,e(!0);var n=oa.transition;oa.transition={};try{e(!1),t()}finally{yt=r,oa.transition=n}}function Ga(){return ya().memoizedState}function $a(e,t,r){var n=tc(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},Ya(e))Xa(t,r);else if(null!==(r=No(e,t,r,n))){rc(r,e,n,ec()),Ja(r,t,n)}}function Ka(e,t,r){var n=tc(e),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(Ya(e))Xa(t,i);else{var o=e.alternate;if(0===e.lanes&&(null===o||0===o.lanes)&&null!==(o=t.lastRenderedReducer))try{var a=t.lastRenderedState,s=o(a,r);if(i.hasEagerState=!0,i.eagerState=s,sn(s,a)){var l=t.interleaved;return null===l?(i.next=i,Po(t)):(i.next=l.next,l.next=i),void(t.interleaved=i)}}catch(c){}null!==(r=No(e,t,i,n))&&(rc(r,e,n,i=ec()),Ja(r,t,n))}}function Ya(e){var t=e.alternate;return e===sa||null!==t&&t===sa}function Xa(e,t){ha=ua=!0;var r=e.pending;null===r?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function Ja(e,t,r){if(0!==(4194240&r)){var n=t.lanes;r|=n&=e.pendingLanes,t.lanes=r,bt(e,r)}}var Za={readContext:Mo,useCallback:ga,useContext:ga,useEffect:ga,useImperativeHandle:ga,useInsertionEffect:ga,useLayoutEffect:ga,useMemo:ga,useReducer:ga,useRef:ga,useState:ga,useDebugValue:ga,useDeferredValue:ga,useTransition:ga,useMutableSource:ga,useSyncExternalStore:ga,useId:ga,unstable_isNewReconciler:!1},Qa={readContext:Mo,useCallback:function(e,t){return ba().memoizedState=[e,void 0===t?null:t],e},useContext:Mo,useEffect:Da,useImperativeHandle:function(e,t,r){return r=null!==r&&void 0!==r?r.concat([e]):null,Pa(4194308,4,Ba.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Pa(4194308,4,e,t)},useInsertionEffect:function(e,t){return Pa(4,2,e,t)},useMemo:function(e,t){var r=ba();return t=void 0===t?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=ba();return t=void 0!==r?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=$a.bind(null,sa,e),[n.memoizedState,e]},useRef:function(e){return e={current:e},ba().memoizedState=e},useState:Oa,useDebugValue:ja,useDeferredValue:function(e){return ba().memoizedState=e},useTransition:function(){var e=Oa(!1),t=e[0];return e=qa.bind(null,e[1]),ba().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=sa,i=ba();if(io){if(void 0===r)throw Error(o(407));r=r()}else{if(r=t(),null===Rl)throw Error(o(349));0!==(30&aa)||Ea(n,t,r)}i.memoizedState=r;var a={value:r,getSnapshot:t};return i.queue=a,Da(_a.bind(null,n,a,e),[e]),n.flags|=2048,Ma(9,Ta.bind(null,n,a,r,t),void 0,null),r},useId:function(){var e=ba(),t=Rl.identifierPrefix;if(io){var r=Ji;t=":"+t+"R"+(r=(Xi&~(1<<32-at(Xi)-1)).toString(32)+r),0<(r=da++)&&(t+="H"+r.toString(32)),t+=":"}else t=":"+t+"r"+(r=fa++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},es={readContext:Mo,useCallback:Wa,useContext:Mo,useEffect:Fa,useImperativeHandle:Ua,useInsertionEffect:La,useLayoutEffect:Ha,useMemo:Va,useReducer:Sa,useRef:Ia,useState:function(){return Sa(wa)},useDebugValue:ja,useDeferredValue:function(e){return za(ya(),la.memoizedState,e)},useTransition:function(){return[Sa(wa)[0],ya().memoizedState]},useMutableSource:ka,useSyncExternalStore:xa,useId:Ga,unstable_isNewReconciler:!1},ts={readContext:Mo,useCallback:Wa,useContext:Mo,useEffect:Fa,useImperativeHandle:Ua,useInsertionEffect:La,useLayoutEffect:Ha,useMemo:Va,useReducer:Ca,useRef:Ia,useState:function(){return Ca(wa)},useDebugValue:ja,useDeferredValue:function(e){var t=ya();return null===la?t.memoizedState=e:za(t,la.memoizedState,e)},useTransition:function(){return[Ca(wa)[0],ya().memoizedState]},useMutableSource:ka,useSyncExternalStore:xa,useId:Ga,unstable_isNewReconciler:!1};function rs(e,t){if(e&&e.defaultProps){for(var r in t=L({},t),e=e.defaultProps)void 0===t[r]&&(t[r]=e[r]);return t}return t}function ns(e,t,r,n){r=null===(r=r(n,t=e.memoizedState))||void 0===r?t:L({},t,r),e.memoizedState=r,0===e.lanes&&(e.updateQueue.baseState=r)}var is={isMounted:function(e){return!!(e=e._reactInternals)&&We(e)===e},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=ec(),i=tc(e),o=Bo(n,i);o.payload=t,void 0!==r&&null!==r&&(o.callback=r),null!==(t=Uo(e,o,i))&&(rc(t,e,i,n),jo(t,e,i))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=ec(),i=tc(e),o=Bo(n,i);o.tag=1,o.payload=t,void 0!==r&&null!==r&&(o.callback=r),null!==(t=Uo(e,o,i))&&(rc(t,e,i,n),jo(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=ec(),n=tc(e),i=Bo(r,n);i.tag=2,void 0!==t&&null!==t&&(i.callback=t),null!==(t=Uo(e,i,n))&&(rc(t,e,n,r),jo(t,e,n))}};function os(e,t,r,n,i,o,a){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(n,o,a):!t.prototype||!t.prototype.isPureReactComponent||(!ln(r,n)||!ln(i,o))}function as(e,t,r){var n=!1,i=_i,o=t.contextType;return"object"===typeof o&&null!==o?o=Mo(o):(i=Ii(t)?Oi:Ai.current,o=(n=null!==(n=t.contextTypes)&&void 0!==n)?Mi(e,i):_i),t=new t(r,o),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=is,e.stateNode=t,t._reactInternals=e,n&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=o),t}function ss(e,t,r,n){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(r,n),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&is.enqueueReplaceState(t,t.state,null)}function ls(e,t,r,n){var i=e.stateNode;i.props=r,i.state=e.memoizedState,i.refs={},Lo(e);var o=t.contextType;"object"===typeof o&&null!==o?i.context=Mo(o):(o=Ii(t)?Oi:Ai.current,i.context=Mi(e,o)),i.state=e.memoizedState,"function"===typeof(o=t.getDerivedStateFromProps)&&(ns(e,t,o,r),i.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof i.getSnapshotBeforeUpdate||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||(t=i.state,"function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),t!==i.state&&is.enqueueReplaceState(i,i.state,null),Vo(e,r,i,n),i.state=e.memoizedState),"function"===typeof i.componentDidMount&&(e.flags|=4194308)}function cs(e,t){try{var r="",n=t;do{r+=j(n),n=n.return}while(n);var i=r}catch(o){i="\nError generating stack: "+o.message+"\n"+o.stack}return{value:e,source:t,stack:i,digest:null}}function us(e,t,r){return{value:e,source:null,stack:null!=r?r:null,digest:null!=t?t:null}}function hs(e,t){try{console.error(t.value)}catch(r){setTimeout((function(){throw r}))}}var ds="function"===typeof WeakMap?WeakMap:Map;function fs(e,t,r){(r=Bo(-1,r)).tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){zl||(zl=!0,ql=n),hs(0,t)},r}function gs(e,t,r){(r=Bo(-1,r)).tag=3;var n=e.type.getDerivedStateFromError;if("function"===typeof n){var i=t.value;r.payload=function(){return n(i)},r.callback=function(){hs(0,t)}}var o=e.stateNode;return null!==o&&"function"===typeof o.componentDidCatch&&(r.callback=function(){hs(0,t),"function"!==typeof n&&(null===Gl?Gl=new Set([this]):Gl.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),r}function ps(e,t,r){var n=e.pingCache;if(null===n){n=e.pingCache=new ds;var i=new Set;n.set(t,i)}else void 0===(i=n.get(t))&&(i=new Set,n.set(t,i));i.has(r)||(i.add(r),e=Ec.bind(null,e,t,r),t.then(e,e))}function ms(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function vs(e,t,r,n,i){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,1===r.tag&&(null===r.alternate?r.tag=17:((t=Bo(-1,1)).tag=2,Uo(r,t,1))),r.lanes|=1),e):(e.flags|=65536,e.lanes=i,e)}var bs=w.ReactCurrentOwner,ys=!1;function ws(e,t,r,n){t.child=null===e?Co(t,null,r,n):So(t,e.child,r,n)}function Ss(e,t,r,n,i){r=r.render;var o=t.ref;return Oo(t,i),n=ma(e,t,r,n,o,i),r=va(),null===e||ys?(io&&r&&eo(t),t.flags|=1,ws(e,t,n,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,zs(e,t,i))}function Cs(e,t,r,n,i){if(null===e){var o=r.type;return"function"!==typeof o||Ic(o)||void 0!==o.defaultProps||null!==r.compare||void 0!==r.defaultProps?((e=Nc(r.type,null,n,t,t.mode,i)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=o,ks(e,t,o,n,i))}if(o=e.child,0===(e.lanes&i)){var a=o.memoizedProps;if((r=null!==(r=r.compare)?r:ln)(a,n)&&e.ref===t.ref)return zs(e,t,i)}return t.flags|=1,(e=Pc(o,n)).ref=t.ref,e.return=t,t.child=e}function ks(e,t,r,n,i){if(null!==e){var o=e.memoizedProps;if(ln(o,n)&&e.ref===t.ref){if(ys=!1,t.pendingProps=n=o,0===(e.lanes&i))return t.lanes=e.lanes,zs(e,t,i);0!==(131072&e.flags)&&(ys=!0)}}return Ts(e,t,r,n,i)}function xs(e,t,r){var n=t.pendingProps,i=n.children,o=null!==e?e.memoizedState:null;if("hidden"===n.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ti(Pl,Il),Il|=r;else{if(0===(1073741824&r))return e=null!==o?o.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ti(Pl,Il),Il|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=null!==o?o.baseLanes:r,Ti(Pl,Il),Il|=n}else null!==o?(n=o.baseLanes|r,t.memoizedState=null):n=r,Ti(Pl,Il),Il|=n;return ws(e,t,i,r),t.child}function Es(e,t){var r=t.ref;(null===e&&null!==r||null!==e&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function Ts(e,t,r,n,i){var o=Ii(r)?Oi:Ai.current;return o=Mi(t,o),Oo(t,i),r=ma(e,t,r,n,o,i),n=va(),null===e||ys?(io&&n&&eo(t),t.flags|=1,ws(e,t,r,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,zs(e,t,i))}function _s(e,t,r,n,i){if(Ii(r)){var o=!0;Fi(t)}else o=!1;if(Oo(t,i),null===t.stateNode)Vs(e,t),as(t,r,n),ls(t,r,n,i),n=!0;else if(null===e){var a=t.stateNode,s=t.memoizedProps;a.props=s;var l=a.context,c=r.contextType;"object"===typeof c&&null!==c?c=Mo(c):c=Mi(t,c=Ii(r)?Oi:Ai.current);var u=r.getDerivedStateFromProps,h="function"===typeof u||"function"===typeof a.getSnapshotBeforeUpdate;h||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(s!==n||l!==c)&&ss(t,a,n,c),Fo=!1;var d=t.memoizedState;a.state=d,Vo(t,n,a,i),l=t.memoizedState,s!==n||d!==l||Ri.current||Fo?("function"===typeof u&&(ns(t,r,u,n),l=t.memoizedState),(s=Fo||os(t,r,s,n,d,l,c))?(h||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||("function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount()),"function"===typeof a.componentDidMount&&(t.flags|=4194308)):("function"===typeof a.componentDidMount&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=l),a.props=n,a.state=l,a.context=c,n=s):("function"===typeof a.componentDidMount&&(t.flags|=4194308),n=!1)}else{a=t.stateNode,Ho(e,t),s=t.memoizedProps,c=t.type===t.elementType?s:rs(t.type,s),a.props=c,h=t.pendingProps,d=a.context,"object"===typeof(l=r.contextType)&&null!==l?l=Mo(l):l=Mi(t,l=Ii(r)?Oi:Ai.current);var f=r.getDerivedStateFromProps;(u="function"===typeof f||"function"===typeof a.getSnapshotBeforeUpdate)||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(s!==h||d!==l)&&ss(t,a,n,l),Fo=!1,d=t.memoizedState,a.state=d,Vo(t,n,a,i);var g=t.memoizedState;s!==h||d!==g||Ri.current||Fo?("function"===typeof f&&(ns(t,r,f,n),g=t.memoizedState),(c=Fo||os(t,r,c,n,d,g,l)||!1)?(u||"function"!==typeof a.UNSAFE_componentWillUpdate&&"function"!==typeof a.componentWillUpdate||("function"===typeof a.componentWillUpdate&&a.componentWillUpdate(n,g,l),"function"===typeof a.UNSAFE_componentWillUpdate&&a.UNSAFE_componentWillUpdate(n,g,l)),"function"===typeof a.componentDidUpdate&&(t.flags|=4),"function"===typeof a.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof a.componentDidUpdate||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=g),a.props=n,a.state=g,a.context=l,n=c):("function"!==typeof a.componentDidUpdate||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||s===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),n=!1)}return As(e,t,r,n,o,i)}function As(e,t,r,n,i,o){Es(e,t);var a=0!==(128&t.flags);if(!n&&!a)return i&&Li(t,r,!1),zs(e,t,o);n=t.stateNode,bs.current=t;var s=a&&"function"!==typeof r.getDerivedStateFromError?null:n.render();return t.flags|=1,null!==e&&a?(t.child=So(t,e.child,null,o),t.child=So(t,null,s,o)):ws(e,t,s,o),t.memoizedState=n.state,i&&Li(t,r,!0),t.child}function Rs(e){var t=e.stateNode;t.pendingContext?Ni(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Ni(0,t.context,!1),Xo(e,t.containerInfo)}function Os(e,t,r,n,i){return go(),po(i),t.flags|=256,ws(e,t,r,n),t.child}var Ms,Is,Ps,Ns,Ds={dehydrated:null,treeContext:null,retryLane:0};function Fs(e){return{baseLanes:e,cachePool:null,transitions:null}}function Ls(e,t,r){var n,i=t.pendingProps,a=ea.current,s=!1,l=0!==(128&t.flags);if((n=l)||(n=(null===e||null!==e.memoizedState)&&0!==(2&a)),n?(s=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(a|=1),Ti(ea,1&a),null===e)return co(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=i.children,e=i.fallback,s?(i=t.mode,s=t.child,l={mode:"hidden",children:l},0===(1&i)&&null!==s?(s.childLanes=0,s.pendingProps=l):s=Fc(l,i,0,null),e=Dc(e,i,r,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=Fs(r),t.memoizedState=Ds,e):Hs(t,l));if(null!==(a=e.memoizedState)&&null!==(n=a.dehydrated))return function(e,t,r,n,i,a,s){if(r)return 256&t.flags?(t.flags&=-257,Bs(e,t,s,n=us(Error(o(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(a=n.fallback,i=t.mode,n=Fc({mode:"visible",children:n.children},i,0,null),(a=Dc(a,i,s,null)).flags|=2,n.return=t,a.return=t,n.sibling=a,t.child=n,0!==(1&t.mode)&&So(t,e.child,null,s),t.child.memoizedState=Fs(s),t.memoizedState=Ds,a);if(0===(1&t.mode))return Bs(e,t,s,null);if("$!"===i.data){if(n=i.nextSibling&&i.nextSibling.dataset)var l=n.dgst;return n=l,Bs(e,t,s,n=us(a=Error(o(419)),n,void 0))}if(l=0!==(s&e.childLanes),ys||l){if(null!==(n=Rl)){switch(s&-s){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}0!==(i=0!==(i&(n.suspendedLanes|s))?0:i)&&i!==a.retryLane&&(a.retryLane=i,Do(e,i),rc(n,e,i,-1))}return pc(),Bs(e,t,s,n=us(Error(o(421))))}return"$?"===i.data?(t.flags|=128,t.child=e.child,t=_c.bind(null,e),i._reactRetry=t,null):(e=a.treeContext,no=ci(i.nextSibling),ro=t,io=!0,oo=null,null!==e&&($i[Ki++]=Xi,$i[Ki++]=Ji,$i[Ki++]=Yi,Xi=e.id,Ji=e.overflow,Yi=t),t=Hs(t,n.children),t.flags|=4096,t)}(e,t,l,i,n,a,r);if(s){s=i.fallback,l=t.mode,n=(a=e.child).sibling;var c={mode:"hidden",children:i.children};return 0===(1&l)&&t.child!==a?((i=t.child).childLanes=0,i.pendingProps=c,t.deletions=null):(i=Pc(a,c)).subtreeFlags=14680064&a.subtreeFlags,null!==n?s=Pc(n,s):(s=Dc(s,l,r,null)).flags|=2,s.return=t,i.return=t,i.sibling=s,t.child=i,i=s,s=t.child,l=null===(l=e.child.memoizedState)?Fs(r):{baseLanes:l.baseLanes|r,cachePool:null,transitions:l.transitions},s.memoizedState=l,s.childLanes=e.childLanes&~r,t.memoizedState=Ds,i}return e=(s=e.child).sibling,i=Pc(s,{mode:"visible",children:i.children}),0===(1&t.mode)&&(i.lanes=r),i.return=t,i.sibling=null,null!==e&&(null===(r=t.deletions)?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=i,t.memoizedState=null,i}function Hs(e,t){return(t=Fc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Bs(e,t,r,n){return null!==n&&po(n),So(t,e.child,null,r),(e=Hs(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Us(e,t,r){e.lanes|=t;var n=e.alternate;null!==n&&(n.lanes|=t),Ro(e.return,t,r)}function js(e,t,r,n,i){var o=e.memoizedState;null===o?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=n,o.tail=r,o.tailMode=i)}function Ws(e,t,r){var n=t.pendingProps,i=n.revealOrder,o=n.tail;if(ws(e,t,n.children,r),0!==(2&(n=ea.current)))n=1&n|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Us(e,r,t);else if(19===e.tag)Us(e,r,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(Ti(ea,n),0===(1&t.mode))t.memoizedState=null;else switch(i){case"forwards":for(r=t.child,i=null;null!==r;)null!==(e=r.alternate)&&null===ta(e)&&(i=r),r=r.sibling;null===(r=i)?(i=t.child,t.child=null):(i=r.sibling,r.sibling=null),js(t,!1,i,r,o);break;case"backwards":for(r=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===ta(e)){t.child=i;break}e=i.sibling,i.sibling=r,r=i,i=e}js(t,!0,r,null,o);break;case"together":js(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Vs(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function zs(e,t,r){if(null!==e&&(t.dependencies=e.dependencies),Fl|=t.lanes,0===(r&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(o(153));if(null!==t.child){for(r=Pc(e=t.child,e.pendingProps),t.child=r,r.return=t;null!==e.sibling;)e=e.sibling,(r=r.sibling=Pc(e,e.pendingProps)).return=t;r.sibling=null}return t.child}function qs(e,t){if(!io)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;null!==t;)null!==t.alternate&&(r=t),t=t.sibling;null===r?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;null!==r;)null!==r.alternate&&(n=r),r=r.sibling;null===n?t||null===e.tail?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Gs(e){var t=null!==e.alternate&&e.alternate.child===e.child,r=0,n=0;if(t)for(var i=e.child;null!==i;)r|=i.lanes|i.childLanes,n|=14680064&i.subtreeFlags,n|=14680064&i.flags,i.return=e,i=i.sibling;else for(i=e.child;null!==i;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function $s(e,t,r){var n=t.pendingProps;switch(to(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Gs(t),null;case 1:case 17:return Ii(t.type)&&Pi(),Gs(t),null;case 3:return n=t.stateNode,Jo(),Ei(Ri),Ei(Ai),na(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==e&&null!==e.child||(ho(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==oo&&(ac(oo),oo=null))),Is(e,t),Gs(t),null;case 5:Qo(t);var i=Yo(Ko.current);if(r=t.type,null!==e&&null!=t.stateNode)Ps(e,t,r,n,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(null===t.stateNode)throw Error(o(166));return Gs(t),null}if(e=Yo(Go.current),ho(t)){n=t.stateNode,r=t.type;var a=t.memoizedProps;switch(n[di]=t,n[fi]=a,e=0!==(1&t.mode),r){case"dialog":Bn("cancel",n),Bn("close",n);break;case"iframe":case"object":case"embed":Bn("load",n);break;case"video":case"audio":for(i=0;i<Dn.length;i++)Bn(Dn[i],n);break;case"source":Bn("error",n);break;case"img":case"image":case"link":Bn("error",n),Bn("load",n);break;case"details":Bn("toggle",n);break;case"input":X(n,a),Bn("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!a.multiple},Bn("invalid",n);break;case"textarea":ie(n,a),Bn("invalid",n)}for(var l in be(r,a),i=null,a)if(a.hasOwnProperty(l)){var c=a[l];"children"===l?"string"===typeof c?n.textContent!==c&&(!0!==a.suppressHydrationWarning&&Zn(n.textContent,c,e),i=["children",c]):"number"===typeof c&&n.textContent!==""+c&&(!0!==a.suppressHydrationWarning&&Zn(n.textContent,c,e),i=["children",""+c]):s.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&Bn("scroll",n)}switch(r){case"input":G(n),Q(n,a,!0);break;case"textarea":G(n),ae(n);break;case"select":case"option":break;default:"function"===typeof a.onClick&&(n.onclick=Qn)}n=i,t.updateQueue=n,null!==n&&(t.flags|=4)}else{l=9===i.nodeType?i:i.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=se(r)),"http://www.w3.org/1999/xhtml"===e?"script"===r?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof n.is?e=l.createElement(r,{is:n.is}):(e=l.createElement(r),"select"===r&&(l=e,n.multiple?l.multiple=!0:n.size&&(l.size=n.size))):e=l.createElementNS(e,r),e[di]=t,e[fi]=n,Ms(e,t,!1,!1),t.stateNode=e;e:{switch(l=ye(r,n),r){case"dialog":Bn("cancel",e),Bn("close",e),i=n;break;case"iframe":case"object":case"embed":Bn("load",e),i=n;break;case"video":case"audio":for(i=0;i<Dn.length;i++)Bn(Dn[i],e);i=n;break;case"source":Bn("error",e),i=n;break;case"img":case"image":case"link":Bn("error",e),Bn("load",e),i=n;break;case"details":Bn("toggle",e),i=n;break;case"input":X(e,n),i=Y(e,n),Bn("invalid",e);break;case"option":default:i=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},i=L({},n,{value:void 0}),Bn("invalid",e);break;case"textarea":ie(e,n),i=ne(e,n),Bn("invalid",e)}for(a in be(r,i),c=i)if(c.hasOwnProperty(a)){var u=c[a];"style"===a?me(e,u):"dangerouslySetInnerHTML"===a?null!=(u=u?u.__html:void 0)&&he(e,u):"children"===a?"string"===typeof u?("textarea"!==r||""!==u)&&de(e,u):"number"===typeof u&&de(e,""+u):"suppressContentEditableWarning"!==a&&"suppressHydrationWarning"!==a&&"autoFocus"!==a&&(s.hasOwnProperty(a)?null!=u&&"onScroll"===a&&Bn("scroll",e):null!=u&&y(e,a,u,l))}switch(r){case"input":G(e),Q(e,n,!1);break;case"textarea":G(e),ae(e);break;case"option":null!=n.value&&e.setAttribute("value",""+z(n.value));break;case"select":e.multiple=!!n.multiple,null!=(a=n.value)?re(e,!!n.multiple,a,!1):null!=n.defaultValue&&re(e,!!n.multiple,n.defaultValue,!0);break;default:"function"===typeof i.onClick&&(e.onclick=Qn)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Gs(t),null;case 6:if(e&&null!=t.stateNode)Ns(e,t,e.memoizedProps,n);else{if("string"!==typeof n&&null===t.stateNode)throw Error(o(166));if(r=Yo(Ko.current),Yo(Go.current),ho(t)){if(n=t.stateNode,r=t.memoizedProps,n[di]=t,(a=n.nodeValue!==r)&&null!==(e=ro))switch(e.tag){case 3:Zn(n.nodeValue,r,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Zn(n.nodeValue,r,0!==(1&e.mode))}a&&(t.flags|=4)}else(n=(9===r.nodeType?r:r.ownerDocument).createTextNode(n))[di]=t,t.stateNode=n}return Gs(t),null;case 13:if(Ei(ea),n=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(io&&null!==no&&0!==(1&t.mode)&&0===(128&t.flags))fo(),go(),t.flags|=98560,a=!1;else if(a=ho(t),null!==n&&null!==n.dehydrated){if(null===e){if(!a)throw Error(o(318));if(!(a=null!==(a=t.memoizedState)?a.dehydrated:null))throw Error(o(317));a[di]=t}else go(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Gs(t),a=!1}else null!==oo&&(ac(oo),oo=null),a=!0;if(!a)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=r,t):((n=null!==n)!==(null!==e&&null!==e.memoizedState)&&n&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&ea.current)?0===Nl&&(Nl=3):pc())),null!==t.updateQueue&&(t.flags|=4),Gs(t),null);case 4:return Jo(),Is(e,t),null===e&&Wn(t.stateNode.containerInfo),Gs(t),null;case 10:return Ao(t.type._context),Gs(t),null;case 19:if(Ei(ea),null===(a=t.memoizedState))return Gs(t),null;if(n=0!==(128&t.flags),null===(l=a.rendering))if(n)qs(a,!1);else{if(0!==Nl||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(l=ta(e))){for(t.flags|=128,qs(a,!1),null!==(n=l.updateQueue)&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;null!==r;)e=n,(a=r).flags&=14680066,null===(l=a.alternate)?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=l.childLanes,a.lanes=l.lanes,a.child=l.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=l.memoizedProps,a.memoizedState=l.memoizedState,a.updateQueue=l.updateQueue,a.type=l.type,e=l.dependencies,a.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return Ti(ea,1&ea.current|2),t.child}e=e.sibling}null!==a.tail&&Je()>Wl&&(t.flags|=128,n=!0,qs(a,!1),t.lanes=4194304)}else{if(!n)if(null!==(e=ta(l))){if(t.flags|=128,n=!0,null!==(r=e.updateQueue)&&(t.updateQueue=r,t.flags|=4),qs(a,!0),null===a.tail&&"hidden"===a.tailMode&&!l.alternate&&!io)return Gs(t),null}else 2*Je()-a.renderingStartTime>Wl&&1073741824!==r&&(t.flags|=128,n=!0,qs(a,!1),t.lanes=4194304);a.isBackwards?(l.sibling=t.child,t.child=l):(null!==(r=a.last)?r.sibling=l:t.child=l,a.last=l)}return null!==a.tail?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=Je(),t.sibling=null,r=ea.current,Ti(ea,n?1&r|2:1&r),t):(Gs(t),null);case 22:case 23:return hc(),n=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==n&&(t.flags|=8192),n&&0!==(1&t.mode)?0!==(1073741824&Il)&&(Gs(t),6&t.subtreeFlags&&(t.flags|=8192)):Gs(t),null;case 24:case 25:return null}throw Error(o(156,t.tag))}function Ks(e,t){switch(to(t),t.tag){case 1:return Ii(t.type)&&Pi(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Jo(),Ei(Ri),Ei(Ai),na(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return Qo(t),null;case 13:if(Ei(ea),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(o(340));go()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Ei(ea),null;case 4:return Jo(),null;case 10:return Ao(t.type._context),null;case 22:case 23:return hc(),null;default:return null}}Ms=function(e,t){for(var r=t.child;null!==r;){if(5===r.tag||6===r.tag)e.appendChild(r.stateNode);else if(4!==r.tag&&null!==r.child){r.child.return=r,r=r.child;continue}if(r===t)break;for(;null===r.sibling;){if(null===r.return||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}},Is=function(){},Ps=function(e,t,r,n){var i=e.memoizedProps;if(i!==n){e=t.stateNode,Yo(Go.current);var o,a=null;switch(r){case"input":i=Y(e,i),n=Y(e,n),a=[];break;case"select":i=L({},i,{value:void 0}),n=L({},n,{value:void 0}),a=[];break;case"textarea":i=ne(e,i),n=ne(e,n),a=[];break;default:"function"!==typeof i.onClick&&"function"===typeof n.onClick&&(e.onclick=Qn)}for(u in be(r,n),r=null,i)if(!n.hasOwnProperty(u)&&i.hasOwnProperty(u)&&null!=i[u])if("style"===u){var l=i[u];for(o in l)l.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(s.hasOwnProperty(u)?a||(a=[]):(a=a||[]).push(u,null));for(u in n){var c=n[u];if(l=null!=i?i[u]:void 0,n.hasOwnProperty(u)&&c!==l&&(null!=c||null!=l))if("style"===u)if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(r||(r={}),r[o]=c[o])}else r||(a||(a=[]),a.push(u,r)),r=c;else"dangerouslySetInnerHTML"===u?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(a=a||[]).push(u,c)):"children"===u?"string"!==typeof c&&"number"!==typeof c||(a=a||[]).push(u,""+c):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(s.hasOwnProperty(u)?(null!=c&&"onScroll"===u&&Bn("scroll",e),a||l===c||(a=[])):(a=a||[]).push(u,c))}r&&(a=a||[]).push("style",r);var u=a;(t.updateQueue=u)&&(t.flags|=4)}},Ns=function(e,t,r,n){r!==n&&(t.flags|=4)};var Ys=!1,Xs=!1,Js="function"===typeof WeakSet?WeakSet:Set,Zs=null;function Qs(e,t){var r=e.ref;if(null!==r)if("function"===typeof r)try{r(null)}catch(n){xc(e,t,n)}else r.current=null}function el(e,t,r){try{r()}catch(n){xc(e,t,n)}}var tl=!1;function rl(e,t,r){var n=t.updateQueue;if(null!==(n=null!==n?n.lastEffect:null)){var i=n=n.next;do{if((i.tag&e)===e){var o=i.destroy;i.destroy=void 0,void 0!==o&&el(t,r,o)}i=i.next}while(i!==n)}}function nl(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function il(e){var t=e.ref;if(null!==t){var r=e.stateNode;e.tag,e=r,"function"===typeof t?t(e):t.current=e}}function ol(e){var t=e.alternate;null!==t&&(e.alternate=null,ol(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[di],delete t[fi],delete t[pi],delete t[mi],delete t[vi])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function al(e){return 5===e.tag||3===e.tag||4===e.tag}function sl(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||al(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function ll(e,t,r){var n=e.tag;if(5===n||6===n)e=e.stateNode,t?8===r.nodeType?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(8===r.nodeType?(t=r.parentNode).insertBefore(e,r):(t=r).appendChild(e),null!==(r=r._reactRootContainer)&&void 0!==r||null!==t.onclick||(t.onclick=Qn));else if(4!==n&&null!==(e=e.child))for(ll(e,t,r),e=e.sibling;null!==e;)ll(e,t,r),e=e.sibling}function cl(e,t,r){var n=e.tag;if(5===n||6===n)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(4!==n&&null!==(e=e.child))for(cl(e,t,r),e=e.sibling;null!==e;)cl(e,t,r),e=e.sibling}var ul=null,hl=!1;function dl(e,t,r){for(r=r.child;null!==r;)fl(e,t,r),r=r.sibling}function fl(e,t,r){if(ot&&"function"===typeof ot.onCommitFiberUnmount)try{ot.onCommitFiberUnmount(it,r)}catch(s){}switch(r.tag){case 5:Xs||Qs(r,t);case 6:var n=ul,i=hl;ul=null,dl(e,t,r),hl=i,null!==(ul=n)&&(hl?(e=ul,r=r.stateNode,8===e.nodeType?e.parentNode.removeChild(r):e.removeChild(r)):ul.removeChild(r.stateNode));break;case 18:null!==ul&&(hl?(e=ul,r=r.stateNode,8===e.nodeType?li(e.parentNode,r):1===e.nodeType&&li(e,r),Wt(e)):li(ul,r.stateNode));break;case 4:n=ul,i=hl,ul=r.stateNode.containerInfo,hl=!0,dl(e,t,r),ul=n,hl=i;break;case 0:case 11:case 14:case 15:if(!Xs&&(null!==(n=r.updateQueue)&&null!==(n=n.lastEffect))){i=n=n.next;do{var o=i,a=o.destroy;o=o.tag,void 0!==a&&(0!==(2&o)||0!==(4&o))&&el(r,t,a),i=i.next}while(i!==n)}dl(e,t,r);break;case 1:if(!Xs&&(Qs(r,t),"function"===typeof(n=r.stateNode).componentWillUnmount))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(s){xc(r,t,s)}dl(e,t,r);break;case 21:dl(e,t,r);break;case 22:1&r.mode?(Xs=(n=Xs)||null!==r.memoizedState,dl(e,t,r),Xs=n):dl(e,t,r);break;default:dl(e,t,r)}}function gl(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var r=e.stateNode;null===r&&(r=e.stateNode=new Js),t.forEach((function(t){var n=Ac.bind(null,e,t);r.has(t)||(r.add(t),t.then(n,n))}))}}function pl(e,t){var r=t.deletions;if(null!==r)for(var n=0;n<r.length;n++){var i=r[n];try{var a=e,s=t,l=s;e:for(;null!==l;){switch(l.tag){case 5:ul=l.stateNode,hl=!1;break e;case 3:case 4:ul=l.stateNode.containerInfo,hl=!0;break e}l=l.return}if(null===ul)throw Error(o(160));fl(a,s,i),ul=null,hl=!1;var c=i.alternate;null!==c&&(c.return=null),i.return=null}catch(u){xc(i,t,u)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)ml(t,e),t=t.sibling}function ml(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(pl(t,e),vl(e),4&n){try{rl(3,e,e.return),nl(3,e)}catch(m){xc(e,e.return,m)}try{rl(5,e,e.return)}catch(m){xc(e,e.return,m)}}break;case 1:pl(t,e),vl(e),512&n&&null!==r&&Qs(r,r.return);break;case 5:if(pl(t,e),vl(e),512&n&&null!==r&&Qs(r,r.return),32&e.flags){var i=e.stateNode;try{de(i,"")}catch(m){xc(e,e.return,m)}}if(4&n&&null!=(i=e.stateNode)){var a=e.memoizedProps,s=null!==r?r.memoizedProps:a,l=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===l&&"radio"===a.type&&null!=a.name&&J(i,a),ye(l,s);var u=ye(l,a);for(s=0;s<c.length;s+=2){var h=c[s],d=c[s+1];"style"===h?me(i,d):"dangerouslySetInnerHTML"===h?he(i,d):"children"===h?de(i,d):y(i,h,d,u)}switch(l){case"input":Z(i,a);break;case"textarea":oe(i,a);break;case"select":var f=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!a.multiple;var g=a.value;null!=g?re(i,!!a.multiple,g,!1):f!==!!a.multiple&&(null!=a.defaultValue?re(i,!!a.multiple,a.defaultValue,!0):re(i,!!a.multiple,a.multiple?[]:"",!1))}i[fi]=a}catch(m){xc(e,e.return,m)}}break;case 6:if(pl(t,e),vl(e),4&n){if(null===e.stateNode)throw Error(o(162));i=e.stateNode,a=e.memoizedProps;try{i.nodeValue=a}catch(m){xc(e,e.return,m)}}break;case 3:if(pl(t,e),vl(e),4&n&&null!==r&&r.memoizedState.isDehydrated)try{Wt(t.containerInfo)}catch(m){xc(e,e.return,m)}break;case 4:default:pl(t,e),vl(e);break;case 13:pl(t,e),vl(e),8192&(i=e.child).flags&&(a=null!==i.memoizedState,i.stateNode.isHidden=a,!a||null!==i.alternate&&null!==i.alternate.memoizedState||(jl=Je())),4&n&&gl(e);break;case 22:if(h=null!==r&&null!==r.memoizedState,1&e.mode?(Xs=(u=Xs)||h,pl(t,e),Xs=u):pl(t,e),vl(e),8192&n){if(u=null!==e.memoizedState,(e.stateNode.isHidden=u)&&!h&&0!==(1&e.mode))for(Zs=e,h=e.child;null!==h;){for(d=Zs=h;null!==Zs;){switch(g=(f=Zs).child,f.tag){case 0:case 11:case 14:case 15:rl(4,f,f.return);break;case 1:Qs(f,f.return);var p=f.stateNode;if("function"===typeof p.componentWillUnmount){n=f,r=f.return;try{t=n,p.props=t.memoizedProps,p.state=t.memoizedState,p.componentWillUnmount()}catch(m){xc(n,r,m)}}break;case 5:Qs(f,f.return);break;case 22:if(null!==f.memoizedState){Sl(d);continue}}null!==g?(g.return=f,Zs=g):Sl(d)}h=h.sibling}e:for(h=null,d=e;;){if(5===d.tag){if(null===h){h=d;try{i=d.stateNode,u?"function"===typeof(a=i.style).setProperty?a.setProperty("display","none","important"):a.display="none":(l=d.stateNode,s=void 0!==(c=d.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,l.style.display=pe("display",s))}catch(m){xc(e,e.return,m)}}}else if(6===d.tag){if(null===h)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(m){xc(e,e.return,m)}}else if((22!==d.tag&&23!==d.tag||null===d.memoizedState||d===e)&&null!==d.child){d.child.return=d,d=d.child;continue}if(d===e)break e;for(;null===d.sibling;){if(null===d.return||d.return===e)break e;h===d&&(h=null),d=d.return}h===d&&(h=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:pl(t,e),vl(e),4&n&&gl(e);case 21:}}function vl(e){var t=e.flags;if(2&t){try{e:{for(var r=e.return;null!==r;){if(al(r)){var n=r;break e}r=r.return}throw Error(o(160))}switch(n.tag){case 5:var i=n.stateNode;32&n.flags&&(de(i,""),n.flags&=-33),cl(e,sl(e),i);break;case 3:case 4:var a=n.stateNode.containerInfo;ll(e,sl(e),a);break;default:throw Error(o(161))}}catch(s){xc(e,e.return,s)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function bl(e,t,r){Zs=e,yl(e,t,r)}function yl(e,t,r){for(var n=0!==(1&e.mode);null!==Zs;){var i=Zs,o=i.child;if(22===i.tag&&n){var a=null!==i.memoizedState||Ys;if(!a){var s=i.alternate,l=null!==s&&null!==s.memoizedState||Xs;s=Ys;var c=Xs;if(Ys=a,(Xs=l)&&!c)for(Zs=i;null!==Zs;)l=(a=Zs).child,22===a.tag&&null!==a.memoizedState?Cl(i):null!==l?(l.return=a,Zs=l):Cl(i);for(;null!==o;)Zs=o,yl(o,t,r),o=o.sibling;Zs=i,Ys=s,Xs=c}wl(e)}else 0!==(8772&i.subtreeFlags)&&null!==o?(o.return=i,Zs=o):wl(e)}}function wl(e){for(;null!==Zs;){var t=Zs;if(0!==(8772&t.flags)){var r=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Xs||nl(5,t);break;case 1:var n=t.stateNode;if(4&t.flags&&!Xs)if(null===r)n.componentDidMount();else{var i=t.elementType===t.type?r.memoizedProps:rs(t.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;null!==a&&zo(t,a,n);break;case 3:var s=t.updateQueue;if(null!==s){if(r=null,null!==t.child)switch(t.child.tag){case 5:case 1:r=t.child.stateNode}zo(t,s,r)}break;case 5:var l=t.stateNode;if(null===r&&4&t.flags){r=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var u=t.alternate;if(null!==u){var h=u.memoizedState;if(null!==h){var d=h.dehydrated;null!==d&&Wt(d)}}}break;default:throw Error(o(163))}Xs||512&t.flags&&il(t)}catch(f){xc(t,t.return,f)}}if(t===e){Zs=null;break}if(null!==(r=t.sibling)){r.return=t.return,Zs=r;break}Zs=t.return}}function Sl(e){for(;null!==Zs;){var t=Zs;if(t===e){Zs=null;break}var r=t.sibling;if(null!==r){r.return=t.return,Zs=r;break}Zs=t.return}}function Cl(e){for(;null!==Zs;){var t=Zs;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{nl(4,t)}catch(l){xc(t,r,l)}break;case 1:var n=t.stateNode;if("function"===typeof n.componentDidMount){var i=t.return;try{n.componentDidMount()}catch(l){xc(t,i,l)}}var o=t.return;try{il(t)}catch(l){xc(t,o,l)}break;case 5:var a=t.return;try{il(t)}catch(l){xc(t,a,l)}}}catch(l){xc(t,t.return,l)}if(t===e){Zs=null;break}var s=t.sibling;if(null!==s){s.return=t.return,Zs=s;break}Zs=t.return}}var kl,xl=Math.ceil,El=w.ReactCurrentDispatcher,Tl=w.ReactCurrentOwner,_l=w.ReactCurrentBatchConfig,Al=0,Rl=null,Ol=null,Ml=0,Il=0,Pl=xi(0),Nl=0,Dl=null,Fl=0,Ll=0,Hl=0,Bl=null,Ul=null,jl=0,Wl=1/0,Vl=null,zl=!1,ql=null,Gl=null,$l=!1,Kl=null,Yl=0,Xl=0,Jl=null,Zl=-1,Ql=0;function ec(){return 0!==(6&Al)?Je():-1!==Zl?Zl:Zl=Je()}function tc(e){return 0===(1&e.mode)?1:0!==(2&Al)&&0!==Ml?Ml&-Ml:null!==mo.transition?(0===Ql&&(Ql=pt()),Ql):0!==(e=yt)?e:e=void 0===(e=window.event)?16:Xt(e.type)}function rc(e,t,r,n){if(50<Xl)throw Xl=0,Jl=null,Error(o(185));vt(e,r,n),0!==(2&Al)&&e===Rl||(e===Rl&&(0===(2&Al)&&(Ll|=r),4===Nl&&sc(e,Ml)),nc(e,n),1===r&&0===Al&&0===(1&t.mode)&&(Wl=Je()+500,Bi&&Wi()))}function nc(e,t){var r=e.callbackNode;!function(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,i=e.expirationTimes,o=e.pendingLanes;0<o;){var a=31-at(o),s=1<<a,l=i[a];-1===l?0!==(s&r)&&0===(s&n)||(i[a]=ft(s,t)):l<=t&&(e.expiredLanes|=s),o&=~s}}(e,t);var n=dt(e,e===Rl?Ml:0);if(0===n)null!==r&&Ke(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(null!=r&&Ke(r),1===t)0===e.tag?function(e){Bi=!0,ji(e)}(lc.bind(null,e)):ji(lc.bind(null,e)),ai((function(){0===(6&Al)&&Wi()})),r=null;else{switch(wt(n)){case 1:r=Qe;break;case 4:r=et;break;case 16:default:r=tt;break;case 536870912:r=nt}r=Rc(r,ic.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function ic(e,t){if(Zl=-1,Ql=0,0!==(6&Al))throw Error(o(327));var r=e.callbackNode;if(Cc()&&e.callbackNode!==r)return null;var n=dt(e,e===Rl?Ml:0);if(0===n)return null;if(0!==(30&n)||0!==(n&e.expiredLanes)||t)t=mc(e,n);else{t=n;var i=Al;Al|=2;var a=gc();for(Rl===e&&Ml===t||(Vl=null,Wl=Je()+500,dc(e,t));;)try{bc();break}catch(l){fc(e,l)}_o(),El.current=a,Al=i,null!==Ol?t=0:(Rl=null,Ml=0,t=Nl)}if(0!==t){if(2===t&&(0!==(i=gt(e))&&(n=i,t=oc(e,i))),1===t)throw r=Dl,dc(e,0),sc(e,n),nc(e,Je()),r;if(6===t)sc(e,n);else{if(i=e.current.alternate,0===(30&n)&&!function(e){for(var t=e;;){if(16384&t.flags){var r=t.updateQueue;if(null!==r&&null!==(r=r.stores))for(var n=0;n<r.length;n++){var i=r[n],o=i.getSnapshot;i=i.value;try{if(!sn(o(),i))return!1}catch(s){return!1}}}if(r=t.child,16384&t.subtreeFlags&&null!==r)r.return=t,t=r;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(i)&&(2===(t=mc(e,n))&&(0!==(a=gt(e))&&(n=a,t=oc(e,a))),1===t))throw r=Dl,dc(e,0),sc(e,n),nc(e,Je()),r;switch(e.finishedWork=i,e.finishedLanes=n,t){case 0:case 1:throw Error(o(345));case 2:case 5:Sc(e,Ul,Vl);break;case 3:if(sc(e,n),(130023424&n)===n&&10<(t=jl+500-Je())){if(0!==dt(e,0))break;if(((i=e.suspendedLanes)&n)!==n){ec(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=ni(Sc.bind(null,e,Ul,Vl),t);break}Sc(e,Ul,Vl);break;case 4:if(sc(e,n),(4194240&n)===n)break;for(t=e.eventTimes,i=-1;0<n;){var s=31-at(n);a=1<<s,(s=t[s])>i&&(i=s),n&=~a}if(n=i,10<(n=(120>(n=Je()-n)?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*xl(n/1960))-n)){e.timeoutHandle=ni(Sc.bind(null,e,Ul,Vl),n);break}Sc(e,Ul,Vl);break;default:throw Error(o(329))}}}return nc(e,Je()),e.callbackNode===r?ic.bind(null,e):null}function oc(e,t){var r=Bl;return e.current.memoizedState.isDehydrated&&(dc(e,t).flags|=256),2!==(e=mc(e,t))&&(t=Ul,Ul=r,null!==t&&ac(t)),e}function ac(e){null===Ul?Ul=e:Ul.push.apply(Ul,e)}function sc(e,t){for(t&=~Hl,t&=~Ll,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-at(t),n=1<<r;e[r]=-1,t&=~n}}function lc(e){if(0!==(6&Al))throw Error(o(327));Cc();var t=dt(e,0);if(0===(1&t))return nc(e,Je()),null;var r=mc(e,t);if(0!==e.tag&&2===r){var n=gt(e);0!==n&&(t=n,r=oc(e,n))}if(1===r)throw r=Dl,dc(e,0),sc(e,t),nc(e,Je()),r;if(6===r)throw Error(o(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Sc(e,Ul,Vl),nc(e,Je()),null}function cc(e,t){var r=Al;Al|=1;try{return e(t)}finally{0===(Al=r)&&(Wl=Je()+500,Bi&&Wi())}}function uc(e){null!==Kl&&0===Kl.tag&&0===(6&Al)&&Cc();var t=Al;Al|=1;var r=_l.transition,n=yt;try{if(_l.transition=null,yt=1,e)return e()}finally{yt=n,_l.transition=r,0===(6&(Al=t))&&Wi()}}function hc(){Il=Pl.current,Ei(Pl)}function dc(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(-1!==r&&(e.timeoutHandle=-1,ii(r)),null!==Ol)for(r=Ol.return;null!==r;){var n=r;switch(to(n),n.tag){case 1:null!==(n=n.type.childContextTypes)&&void 0!==n&&Pi();break;case 3:Jo(),Ei(Ri),Ei(Ai),na();break;case 5:Qo(n);break;case 4:Jo();break;case 13:case 19:Ei(ea);break;case 10:Ao(n.type._context);break;case 22:case 23:hc()}r=r.return}if(Rl=e,Ol=e=Pc(e.current,null),Ml=Il=t,Nl=0,Dl=null,Hl=Ll=Fl=0,Ul=Bl=null,null!==Io){for(t=0;t<Io.length;t++)if(null!==(n=(r=Io[t]).interleaved)){r.interleaved=null;var i=n.next,o=r.pending;if(null!==o){var a=o.next;o.next=i,n.next=a}r.pending=n}Io=null}return e}function fc(e,t){for(;;){var r=Ol;try{if(_o(),ia.current=Za,ua){for(var n=sa.memoizedState;null!==n;){var i=n.queue;null!==i&&(i.pending=null),n=n.next}ua=!1}if(aa=0,ca=la=sa=null,ha=!1,da=0,Tl.current=null,null===r||null===r.return){Nl=1,Dl=t,Ol=null;break}e:{var a=e,s=r.return,l=r,c=t;if(t=Ml,l.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var u=c,h=l,d=h.tag;if(0===(1&h.mode)&&(0===d||11===d||15===d)){var f=h.alternate;f?(h.updateQueue=f.updateQueue,h.memoizedState=f.memoizedState,h.lanes=f.lanes):(h.updateQueue=null,h.memoizedState=null)}var g=ms(s);if(null!==g){g.flags&=-257,vs(g,s,l,0,t),1&g.mode&&ps(a,u,t),c=u;var p=(t=g).updateQueue;if(null===p){var m=new Set;m.add(c),t.updateQueue=m}else p.add(c);break e}if(0===(1&t)){ps(a,u,t),pc();break e}c=Error(o(426))}else if(io&&1&l.mode){var v=ms(s);if(null!==v){0===(65536&v.flags)&&(v.flags|=256),vs(v,s,l,0,t),po(cs(c,l));break e}}a=c=cs(c,l),4!==Nl&&(Nl=2),null===Bl?Bl=[a]:Bl.push(a),a=s;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t,Wo(a,fs(0,c,t));break e;case 1:l=c;var b=a.type,y=a.stateNode;if(0===(128&a.flags)&&("function"===typeof b.getDerivedStateFromError||null!==y&&"function"===typeof y.componentDidCatch&&(null===Gl||!Gl.has(y)))){a.flags|=65536,t&=-t,a.lanes|=t,Wo(a,gs(a,l,t));break e}}a=a.return}while(null!==a)}wc(r)}catch(w){t=w,Ol===r&&null!==r&&(Ol=r=r.return);continue}break}}function gc(){var e=El.current;return El.current=Za,null===e?Za:e}function pc(){0!==Nl&&3!==Nl&&2!==Nl||(Nl=4),null===Rl||0===(268435455&Fl)&&0===(268435455&Ll)||sc(Rl,Ml)}function mc(e,t){var r=Al;Al|=2;var n=gc();for(Rl===e&&Ml===t||(Vl=null,dc(e,t));;)try{vc();break}catch(i){fc(e,i)}if(_o(),Al=r,El.current=n,null!==Ol)throw Error(o(261));return Rl=null,Ml=0,Nl}function vc(){for(;null!==Ol;)yc(Ol)}function bc(){for(;null!==Ol&&!Ye();)yc(Ol)}function yc(e){var t=kl(e.alternate,e,Il);e.memoizedProps=e.pendingProps,null===t?wc(e):Ol=t,Tl.current=null}function wc(e){var t=e;do{var r=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(r=$s(r,t,Il)))return void(Ol=r)}else{if(null!==(r=Ks(r,t)))return r.flags&=32767,void(Ol=r);if(null===e)return Nl=6,void(Ol=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Ol=t);Ol=t=e}while(null!==t);0===Nl&&(Nl=5)}function Sc(e,t,r){var n=yt,i=_l.transition;try{_l.transition=null,yt=1,function(e,t,r,n){do{Cc()}while(null!==Kl);if(0!==(6&Al))throw Error(o(327));r=e.finishedWork;var i=e.finishedLanes;if(null===r)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(o(177));e.callbackNode=null,e.callbackPriority=0;var a=r.lanes|r.childLanes;if(function(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var i=31-at(r),o=1<<i;t[i]=0,n[i]=-1,e[i]=-1,r&=~o}}(e,a),e===Rl&&(Ol=Rl=null,Ml=0),0===(2064&r.subtreeFlags)&&0===(2064&r.flags)||$l||($l=!0,Rc(tt,(function(){return Cc(),null}))),a=0!==(15990&r.flags),0!==(15990&r.subtreeFlags)||a){a=_l.transition,_l.transition=null;var s=yt;yt=1;var l=Al;Al|=4,Tl.current=null,function(e,t){if(ei=zt,fn(e=dn())){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{var n=(r=(r=e.ownerDocument)&&r.defaultView||window).getSelection&&r.getSelection();if(n&&0!==n.rangeCount){r=n.anchorNode;var i=n.anchorOffset,a=n.focusNode;n=n.focusOffset;try{r.nodeType,a.nodeType}catch(S){r=null;break e}var s=0,l=-1,c=-1,u=0,h=0,d=e,f=null;t:for(;;){for(var g;d!==r||0!==i&&3!==d.nodeType||(l=s+i),d!==a||0!==n&&3!==d.nodeType||(c=s+n),3===d.nodeType&&(s+=d.nodeValue.length),null!==(g=d.firstChild);)f=d,d=g;for(;;){if(d===e)break t;if(f===r&&++u===i&&(l=s),f===a&&++h===n&&(c=s),null!==(g=d.nextSibling))break;f=(d=f).parentNode}d=g}r=-1===l||-1===c?null:{start:l,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(ti={focusedElem:e,selectionRange:r},zt=!1,Zs=t;null!==Zs;)if(e=(t=Zs).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Zs=e;else for(;null!==Zs;){t=Zs;try{var p=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==p){var m=p.memoizedProps,v=p.memoizedState,b=t.stateNode,y=b.getSnapshotBeforeUpdate(t.elementType===t.type?m:rs(t.type,m),v);b.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var w=t.stateNode.containerInfo;1===w.nodeType?w.textContent="":9===w.nodeType&&w.documentElement&&w.removeChild(w.documentElement);break;default:throw Error(o(163))}}catch(S){xc(t,t.return,S)}if(null!==(e=t.sibling)){e.return=t.return,Zs=e;break}Zs=t.return}p=tl,tl=!1}(e,r),ml(r,e),gn(ti),zt=!!ei,ti=ei=null,e.current=r,bl(r,e,i),Xe(),Al=l,yt=s,_l.transition=a}else e.current=r;if($l&&($l=!1,Kl=e,Yl=i),a=e.pendingLanes,0===a&&(Gl=null),function(e){if(ot&&"function"===typeof ot.onCommitFiberRoot)try{ot.onCommitFiberRoot(it,e,void 0,128===(128&e.current.flags))}catch(t){}}(r.stateNode),nc(e,Je()),null!==t)for(n=e.onRecoverableError,r=0;r<t.length;r++)i=t[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(zl)throw zl=!1,e=ql,ql=null,e;0!==(1&Yl)&&0!==e.tag&&Cc(),a=e.pendingLanes,0!==(1&a)?e===Jl?Xl++:(Xl=0,Jl=e):Xl=0,Wi()}(e,t,r,n)}finally{_l.transition=i,yt=n}return null}function Cc(){if(null!==Kl){var e=wt(Yl),t=_l.transition,r=yt;try{if(_l.transition=null,yt=16>e?16:e,null===Kl)var n=!1;else{if(e=Kl,Kl=null,Yl=0,0!==(6&Al))throw Error(o(331));var i=Al;for(Al|=4,Zs=e.current;null!==Zs;){var a=Zs,s=a.child;if(0!==(16&Zs.flags)){var l=a.deletions;if(null!==l){for(var c=0;c<l.length;c++){var u=l[c];for(Zs=u;null!==Zs;){var h=Zs;switch(h.tag){case 0:case 11:case 15:rl(8,h,a)}var d=h.child;if(null!==d)d.return=h,Zs=d;else for(;null!==Zs;){var f=(h=Zs).sibling,g=h.return;if(ol(h),h===u){Zs=null;break}if(null!==f){f.return=g,Zs=f;break}Zs=g}}}var p=a.alternate;if(null!==p){var m=p.child;if(null!==m){p.child=null;do{var v=m.sibling;m.sibling=null,m=v}while(null!==m)}}Zs=a}}if(0!==(2064&a.subtreeFlags)&&null!==s)s.return=a,Zs=s;else e:for(;null!==Zs;){if(0!==(2048&(a=Zs).flags))switch(a.tag){case 0:case 11:case 15:rl(9,a,a.return)}var b=a.sibling;if(null!==b){b.return=a.return,Zs=b;break e}Zs=a.return}}var y=e.current;for(Zs=y;null!==Zs;){var w=(s=Zs).child;if(0!==(2064&s.subtreeFlags)&&null!==w)w.return=s,Zs=w;else e:for(s=y;null!==Zs;){if(0!==(2048&(l=Zs).flags))try{switch(l.tag){case 0:case 11:case 15:nl(9,l)}}catch(C){xc(l,l.return,C)}if(l===s){Zs=null;break e}var S=l.sibling;if(null!==S){S.return=l.return,Zs=S;break e}Zs=l.return}}if(Al=i,Wi(),ot&&"function"===typeof ot.onPostCommitFiberRoot)try{ot.onPostCommitFiberRoot(it,e)}catch(C){}n=!0}return n}finally{yt=r,_l.transition=t}}return!1}function kc(e,t,r){e=Uo(e,t=fs(0,t=cs(r,t),1),1),t=ec(),null!==e&&(vt(e,1,t),nc(e,t))}function xc(e,t,r){if(3===e.tag)kc(e,e,r);else for(;null!==t;){if(3===t.tag){kc(t,e,r);break}if(1===t.tag){var n=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof n.componentDidCatch&&(null===Gl||!Gl.has(n))){t=Uo(t,e=gs(t,e=cs(r,e),1),1),e=ec(),null!==t&&(vt(t,1,e),nc(t,e));break}}t=t.return}}function Ec(e,t,r){var n=e.pingCache;null!==n&&n.delete(t),t=ec(),e.pingedLanes|=e.suspendedLanes&r,Rl===e&&(Ml&r)===r&&(4===Nl||3===Nl&&(130023424&Ml)===Ml&&500>Je()-jl?dc(e,0):Hl|=r),nc(e,t)}function Tc(e,t){0===t&&(0===(1&e.mode)?t=1:(t=ut,0===(130023424&(ut<<=1))&&(ut=4194304)));var r=ec();null!==(e=Do(e,t))&&(vt(e,t,r),nc(e,r))}function _c(e){var t=e.memoizedState,r=0;null!==t&&(r=t.retryLane),Tc(e,r)}function Ac(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,i=e.memoizedState;null!==i&&(r=i.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(o(314))}null!==n&&n.delete(t),Tc(e,r)}function Rc(e,t){return $e(e,t)}function Oc(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Mc(e,t,r,n){return new Oc(e,t,r,n)}function Ic(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Pc(e,t){var r=e.alternate;return null===r?((r=Mc(e.tag,t,e.key,e.mode)).elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=14680064&e.flags,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Nc(e,t,r,n,i,a){var s=2;if(n=e,"function"===typeof e)Ic(e)&&(s=1);else if("string"===typeof e)s=5;else e:switch(e){case k:return Dc(r.children,i,a,t);case x:s=8,i|=8;break;case E:return(e=Mc(12,r,t,2|i)).elementType=E,e.lanes=a,e;case R:return(e=Mc(13,r,t,i)).elementType=R,e.lanes=a,e;case O:return(e=Mc(19,r,t,i)).elementType=O,e.lanes=a,e;case P:return Fc(r,i,a,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case T:s=10;break e;case _:s=9;break e;case A:s=11;break e;case M:s=14;break e;case I:s=16,n=null;break e}throw Error(o(130,null==e?e:typeof e,""))}return(t=Mc(s,r,t,i)).elementType=e,t.type=n,t.lanes=a,t}function Dc(e,t,r,n){return(e=Mc(7,e,n,t)).lanes=r,e}function Fc(e,t,r,n){return(e=Mc(22,e,n,t)).elementType=P,e.lanes=r,e.stateNode={isHidden:!1},e}function Lc(e,t,r){return(e=Mc(6,e,null,t)).lanes=r,e}function Hc(e,t,r){return(t=Mc(4,null!==e.children?e.children:[],e.key,t)).lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Bc(e,t,r,n,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=mt(0),this.expirationTimes=mt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=mt(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Uc(e,t,r,n,i,o,a,s,l){return e=new Bc(e,t,r,s,l),1===t?(t=1,!0===o&&(t|=8)):t=0,o=Mc(3,null,null,t),e.current=o,o.stateNode=e,o.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Lo(o),e}function jc(e){if(!e)return _i;e:{if(We(e=e._reactInternals)!==e||1!==e.tag)throw Error(o(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Ii(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(o(171))}if(1===e.tag){var r=e.type;if(Ii(r))return Di(e,r,t)}return t}function Wc(e,t,r,n,i,o,a,s,l){return(e=Uc(r,n,!0,e,0,o,0,s,l)).context=jc(null),r=e.current,(o=Bo(n=ec(),i=tc(r))).callback=void 0!==t&&null!==t?t:null,Uo(r,o,i),e.current.lanes=i,vt(e,i,n),nc(e,n),e}function Vc(e,t,r,n){var i=t.current,o=ec(),a=tc(i);return r=jc(r),null===t.context?t.context=r:t.pendingContext=r,(t=Bo(o,a)).payload={element:e},null!==(n=void 0===n?null:n)&&(t.callback=n),null!==(e=Uo(i,t,a))&&(rc(e,i,a,o),jo(e,i,a)),a}function zc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function qc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var r=e.retryLane;e.retryLane=0!==r&&r<t?r:t}}function Gc(e,t){qc(e,t),(e=e.alternate)&&qc(e,t)}kl=function(e,t,r){if(null!==e)if(e.memoizedProps!==t.pendingProps||Ri.current)ys=!0;else{if(0===(e.lanes&r)&&0===(128&t.flags))return ys=!1,function(e,t,r){switch(t.tag){case 3:Rs(t),go();break;case 5:Zo(t);break;case 1:Ii(t.type)&&Fi(t);break;case 4:Xo(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,i=t.memoizedProps.value;Ti(ko,n._currentValue),n._currentValue=i;break;case 13:if(null!==(n=t.memoizedState))return null!==n.dehydrated?(Ti(ea,1&ea.current),t.flags|=128,null):0!==(r&t.child.childLanes)?Ls(e,t,r):(Ti(ea,1&ea.current),null!==(e=zs(e,t,r))?e.sibling:null);Ti(ea,1&ea.current);break;case 19:if(n=0!==(r&t.childLanes),0!==(128&e.flags)){if(n)return Ws(e,t,r);t.flags|=128}if(null!==(i=t.memoizedState)&&(i.rendering=null,i.tail=null,i.lastEffect=null),Ti(ea,ea.current),n)break;return null;case 22:case 23:return t.lanes=0,xs(e,t,r)}return zs(e,t,r)}(e,t,r);ys=0!==(131072&e.flags)}else ys=!1,io&&0!==(1048576&t.flags)&&Qi(t,Gi,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;Vs(e,t),e=t.pendingProps;var i=Mi(t,Ai.current);Oo(t,r),i=ma(null,t,n,e,i,r);var a=va();return t.flags|=1,"object"===typeof i&&null!==i&&"function"===typeof i.render&&void 0===i.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Ii(n)?(a=!0,Fi(t)):a=!1,t.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,Lo(t),i.updater=is,t.stateNode=i,i._reactInternals=t,ls(t,n,e,r),t=As(null,t,n,!0,a,r)):(t.tag=0,io&&a&&eo(t),ws(null,t,i,r),t=t.child),t;case 16:n=t.elementType;e:{switch(Vs(e,t),e=t.pendingProps,n=(i=n._init)(n._payload),t.type=n,i=t.tag=function(e){if("function"===typeof e)return Ic(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===A)return 11;if(e===M)return 14}return 2}(n),e=rs(n,e),i){case 0:t=Ts(null,t,n,e,r);break e;case 1:t=_s(null,t,n,e,r);break e;case 11:t=Ss(null,t,n,e,r);break e;case 14:t=Cs(null,t,n,rs(n.type,e),r);break e}throw Error(o(306,n,""))}return t;case 0:return n=t.type,i=t.pendingProps,Ts(e,t,n,i=t.elementType===n?i:rs(n,i),r);case 1:return n=t.type,i=t.pendingProps,_s(e,t,n,i=t.elementType===n?i:rs(n,i),r);case 3:e:{if(Rs(t),null===e)throw Error(o(387));n=t.pendingProps,i=(a=t.memoizedState).element,Ho(e,t),Vo(t,n,null,r);var s=t.memoizedState;if(n=s.element,a.isDehydrated){if(a={element:n,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},t.updateQueue.baseState=a,t.memoizedState=a,256&t.flags){t=Os(e,t,n,r,i=cs(Error(o(423)),t));break e}if(n!==i){t=Os(e,t,n,r,i=cs(Error(o(424)),t));break e}for(no=ci(t.stateNode.containerInfo.firstChild),ro=t,io=!0,oo=null,r=Co(t,null,n,r),t.child=r;r;)r.flags=-3&r.flags|4096,r=r.sibling}else{if(go(),n===i){t=zs(e,t,r);break e}ws(e,t,n,r)}t=t.child}return t;case 5:return Zo(t),null===e&&co(t),n=t.type,i=t.pendingProps,a=null!==e?e.memoizedProps:null,s=i.children,ri(n,i)?s=null:null!==a&&ri(n,a)&&(t.flags|=32),Es(e,t),ws(e,t,s,r),t.child;case 6:return null===e&&co(t),null;case 13:return Ls(e,t,r);case 4:return Xo(t,t.stateNode.containerInfo),n=t.pendingProps,null===e?t.child=So(t,null,n,r):ws(e,t,n,r),t.child;case 11:return n=t.type,i=t.pendingProps,Ss(e,t,n,i=t.elementType===n?i:rs(n,i),r);case 7:return ws(e,t,t.pendingProps,r),t.child;case 8:case 12:return ws(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,i=t.pendingProps,a=t.memoizedProps,s=i.value,Ti(ko,n._currentValue),n._currentValue=s,null!==a)if(sn(a.value,s)){if(a.children===i.children&&!Ri.current){t=zs(e,t,r);break e}}else for(null!==(a=t.child)&&(a.return=t);null!==a;){var l=a.dependencies;if(null!==l){s=a.child;for(var c=l.firstContext;null!==c;){if(c.context===n){if(1===a.tag){(c=Bo(-1,r&-r)).tag=2;var u=a.updateQueue;if(null!==u){var h=(u=u.shared).pending;null===h?c.next=c:(c.next=h.next,h.next=c),u.pending=c}}a.lanes|=r,null!==(c=a.alternate)&&(c.lanes|=r),Ro(a.return,r,t),l.lanes|=r;break}c=c.next}}else if(10===a.tag)s=a.type===t.type?null:a.child;else if(18===a.tag){if(null===(s=a.return))throw Error(o(341));s.lanes|=r,null!==(l=s.alternate)&&(l.lanes|=r),Ro(s,r,t),s=a.sibling}else s=a.child;if(null!==s)s.return=a;else for(s=a;null!==s;){if(s===t){s=null;break}if(null!==(a=s.sibling)){a.return=s.return,s=a;break}s=s.return}a=s}ws(e,t,i.children,r),t=t.child}return t;case 9:return i=t.type,n=t.pendingProps.children,Oo(t,r),n=n(i=Mo(i)),t.flags|=1,ws(e,t,n,r),t.child;case 14:return i=rs(n=t.type,t.pendingProps),Cs(e,t,n,i=rs(n.type,i),r);case 15:return ks(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:rs(n,i),Vs(e,t),t.tag=1,Ii(n)?(e=!0,Fi(t)):e=!1,Oo(t,r),as(t,n,i),ls(t,n,i,r),As(null,t,n,!0,e,r);case 19:return Ws(e,t,r);case 22:return xs(e,t,r)}throw Error(o(156,t.tag))};var $c="function"===typeof reportError?reportError:function(e){console.error(e)};function Kc(e){this._internalRoot=e}function Yc(e){this._internalRoot=e}function Xc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Jc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Zc(){}function Qc(e,t,r,n,i){var o=r._reactRootContainer;if(o){var a=o;if("function"===typeof i){var s=i;i=function(){var e=zc(a);s.call(e)}}Vc(t,a,e,i)}else a=function(e,t,r,n,i){if(i){if("function"===typeof n){var o=n;n=function(){var e=zc(a);o.call(e)}}var a=Wc(t,n,e,0,null,!1,0,"",Zc);return e._reactRootContainer=a,e[gi]=a.current,Wn(8===e.nodeType?e.parentNode:e),uc(),a}for(;i=e.lastChild;)e.removeChild(i);if("function"===typeof n){var s=n;n=function(){var e=zc(l);s.call(e)}}var l=Uc(e,0,!1,null,0,!1,0,"",Zc);return e._reactRootContainer=l,e[gi]=l.current,Wn(8===e.nodeType?e.parentNode:e),uc((function(){Vc(t,l,r,n)})),l}(r,t,e,i,n);return zc(a)}Yc.prototype.render=Kc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(o(409));Vc(e,t,null,null)},Yc.prototype.unmount=Kc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;uc((function(){Vc(null,e,null,null)})),t[gi]=null}},Yc.prototype.unstable_scheduleHydration=function(e){if(e){var t=xt();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Pt.length&&0!==t&&t<Pt[r].priority;r++);Pt.splice(r,0,e),0===r&&Lt(e)}},St=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=ht(t.pendingLanes);0!==r&&(bt(t,1|r),nc(t,Je()),0===(6&Al)&&(Wl=Je()+500,Wi()))}break;case 13:uc((function(){var t=Do(e,1);if(null!==t){var r=ec();rc(t,e,1,r)}})),Gc(e,1)}},Ct=function(e){if(13===e.tag){var t=Do(e,134217728);if(null!==t)rc(t,e,134217728,ec());Gc(e,134217728)}},kt=function(e){if(13===e.tag){var t=tc(e),r=Do(e,t);if(null!==r)rc(r,e,t,ec());Gc(e,t)}},xt=function(){return yt},Et=function(e,t){var r=yt;try{return yt=e,t()}finally{yt=r}},Ce=function(e,t,r){switch(t){case"input":if(Z(e,r),t=r.name,"radio"===r.type&&null!=t){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var i=Si(n);if(!i)throw Error(o(90));$(n),Z(n,i)}}}break;case"textarea":oe(e,r);break;case"select":null!=(t=r.value)&&re(e,!!r.multiple,t,!1)}},Ae=cc,Re=uc;var eu={usingClientEntryPoint:!1,Events:[yi,wi,Si,Te,_e,cc]},tu={findFiberByHostInstance:bi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},ru={bundleType:tu.bundleType,version:tu.version,rendererPackageName:tu.rendererPackageName,rendererConfig:tu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:w.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=qe(e))?null:e.stateNode},findFiberByHostInstance:tu.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var nu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!nu.isDisabled&&nu.supportsFiber)try{it=nu.inject(ru),ot=nu}catch(ue){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=eu,t.createPortal=function(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Xc(t))throw Error(o(200));return function(e,t,r){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:C,key:null==n?null:""+n,children:e,containerInfo:t,implementation:r}}(e,t,null,r)},t.createRoot=function(e,t){if(!Xc(e))throw Error(o(299));var r=!1,n="",i=$c;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(r=!0),void 0!==t.identifierPrefix&&(n=t.identifierPrefix),void 0!==t.onRecoverableError&&(i=t.onRecoverableError)),t=Uc(e,1,!1,null,0,r,0,n,i),e[gi]=t.current,Wn(8===e.nodeType?e.parentNode:e),new Kc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(o(188));throw e=Object.keys(e).join(","),Error(o(268,e))}return e=null===(e=qe(t))?null:e.stateNode},t.flushSync=function(e){return uc(e)},t.hydrate=function(e,t,r){if(!Jc(t))throw Error(o(200));return Qc(null,e,t,!0,r)},t.hydrateRoot=function(e,t,r){if(!Xc(e))throw Error(o(405));var n=null!=r&&r.hydratedSources||null,i=!1,a="",s=$c;if(null!==r&&void 0!==r&&(!0===r.unstable_strictMode&&(i=!0),void 0!==r.identifierPrefix&&(a=r.identifierPrefix),void 0!==r.onRecoverableError&&(s=r.onRecoverableError)),t=Wc(t,null,e,1,null!=r?r:null,i,0,a,s),e[gi]=t.current,Wn(e),n)for(e=0;e<n.length;e++)i=(i=(r=n[e])._getVersion)(r._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[r,i]:t.mutableSourceEagerHydrationData.push(r,i);return new Yc(t)},t.render=function(e,t,r){if(!Jc(t))throw Error(o(200));return Qc(null,e,t,!1,r)},t.unmountComponentAtNode=function(e){if(!Jc(e))throw Error(o(40));return!!e._reactRootContainer&&(uc((function(){Qc(null,null,e,!1,(function(){e._reactRootContainer=null,e[gi]=null}))})),!0)},t.unstable_batchedUpdates=cc,t.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!Jc(r))throw Error(o(200));if(null==e||void 0===e._reactInternals)throw Error(o(38));return Qc(e,t,r,!1,n)},t.version="18.3.1-next-f1338f8080-20240426"},4391:(e,t,r)=>{"use strict";var n=r(7950);t.H=n.createRoot,n.hydrateRoot},7950:(e,t,r)=>{"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=r(2730)},1153:(e,t,r)=>{"use strict";var n=r(5043),i=Symbol.for("react.element"),o=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,s=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,r){var n,o={},c=null,u=null;for(n in void 0!==r&&(c=""+r),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(u=t.ref),t)a.call(t,n)&&!l.hasOwnProperty(n)&&(o[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps)void 0===o[n]&&(o[n]=t[n]);return{$$typeof:i,type:e,key:c,ref:u,props:o,_owner:s.current}}t.Fragment=o,t.jsx=c,t.jsxs=c},4202:(e,t)=>{"use strict";var r=Symbol.for("react.element"),n=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),f=Symbol.iterator;var g={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},p=Object.assign,m={};function v(e,t,r){this.props=e,this.context=t,this.refs=m,this.updater=r||g}function b(){}function y(e,t,r){this.props=e,this.context=t,this.refs=m,this.updater=r||g}v.prototype.isReactComponent={},v.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},v.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},b.prototype=v.prototype;var w=y.prototype=new b;w.constructor=y,p(w,v.prototype),w.isPureReactComponent=!0;var S=Array.isArray,C=Object.prototype.hasOwnProperty,k={current:null},x={key:!0,ref:!0,__self:!0,__source:!0};function E(e,t,n){var i,o={},a=null,s=null;if(null!=t)for(i in void 0!==t.ref&&(s=t.ref),void 0!==t.key&&(a=""+t.key),t)C.call(t,i)&&!x.hasOwnProperty(i)&&(o[i]=t[i]);var l=arguments.length-2;if(1===l)o.children=n;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];o.children=c}if(e&&e.defaultProps)for(i in l=e.defaultProps)void 0===o[i]&&(o[i]=l[i]);return{$$typeof:r,type:e,key:a,ref:s,props:o,_owner:k.current}}function T(e){return"object"===typeof e&&null!==e&&e.$$typeof===r}var _=/\/+/g;function A(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function R(e,t,i,o,a){var s=typeof e;"undefined"!==s&&"boolean"!==s||(e=null);var l=!1;if(null===e)l=!0;else switch(s){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case r:case n:l=!0}}if(l)return a=a(l=e),e=""===o?"."+A(l,0):o,S(a)?(i="",null!=e&&(i=e.replace(_,"$&/")+"/"),R(a,t,i,"",(function(e){return e}))):null!=a&&(T(a)&&(a=function(e,t){return{$$typeof:r,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(a,i+(!a.key||l&&l.key===a.key?"":(""+a.key).replace(_,"$&/")+"/")+e)),t.push(a)),1;if(l=0,o=""===o?".":o+":",S(e))for(var c=0;c<e.length;c++){var u=o+A(s=e[c],c);l+=R(s,t,i,u,a)}else if(u=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=f&&e[f]||e["@@iterator"])?e:null}(e),"function"===typeof u)for(e=u.call(e),c=0;!(s=e.next()).done;)l+=R(s=s.value,t,i,u=o+A(s,c++),a);else if("object"===s)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function O(e,t,r){if(null==e)return e;var n=[],i=0;return R(e,n,"","",(function(e){return t.call(r,e,i++)})),n}function M(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var I={current:null},P={transition:null},N={ReactCurrentDispatcher:I,ReactCurrentBatchConfig:P,ReactCurrentOwner:k};function D(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:O,forEach:function(e,t,r){O(e,(function(){t.apply(this,arguments)}),r)},count:function(e){var t=0;return O(e,(function(){t++})),t},toArray:function(e){return O(e,(function(e){return e}))||[]},only:function(e){if(!T(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=v,t.Fragment=i,t.Profiler=a,t.PureComponent=y,t.StrictMode=o,t.Suspense=u,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=N,t.act=D,t.cloneElement=function(e,t,n){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var i=p({},e.props),o=e.key,a=e.ref,s=e._owner;if(null!=t){if(void 0!==t.ref&&(a=t.ref,s=k.current),void 0!==t.key&&(o=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)C.call(t,c)&&!x.hasOwnProperty(c)&&(i[c]=void 0===t[c]&&void 0!==l?l[c]:t[c])}var c=arguments.length-2;if(1===c)i.children=n;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];i.children=l}return{$$typeof:r,type:e.type,key:o,ref:a,props:i,_owner:s}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:s,_context:e},e.Consumer=e},t.createElement=E,t.createFactory=function(e){var t=E.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=T,t.lazy=function(e){return{$$typeof:d,_payload:{_status:-1,_result:e},_init:M}},t.memo=function(e,t){return{$$typeof:h,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=P.transition;P.transition={};try{e()}finally{P.transition=t}},t.unstable_act=D,t.useCallback=function(e,t){return I.current.useCallback(e,t)},t.useContext=function(e){return I.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return I.current.useDeferredValue(e)},t.useEffect=function(e,t){return I.current.useEffect(e,t)},t.useId=function(){return I.current.useId()},t.useImperativeHandle=function(e,t,r){return I.current.useImperativeHandle(e,t,r)},t.useInsertionEffect=function(e,t){return I.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return I.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return I.current.useMemo(e,t)},t.useReducer=function(e,t,r){return I.current.useReducer(e,t,r)},t.useRef=function(e){return I.current.useRef(e)},t.useState=function(e){return I.current.useState(e)},t.useSyncExternalStore=function(e,t,r){return I.current.useSyncExternalStore(e,t,r)},t.useTransition=function(){return I.current.useTransition()},t.version="18.3.1"},5043:(e,t,r)=>{"use strict";e.exports=r(4202)},579:(e,t,r)=>{"use strict";e.exports=r(1153)},7234:(e,t)=>{"use strict";function r(e,t){var r=e.length;e.push(t);e:for(;0<r;){var n=r-1>>>1,i=e[n];if(!(0<o(i,t)))break e;e[n]=t,e[r]=i,r=n}}function n(e){return 0===e.length?null:e[0]}function i(e){if(0===e.length)return null;var t=e[0],r=e.pop();if(r!==t){e[0]=r;e:for(var n=0,i=e.length,a=i>>>1;n<a;){var s=2*(n+1)-1,l=e[s],c=s+1,u=e[c];if(0>o(l,r))c<i&&0>o(u,l)?(e[n]=u,e[c]=r,n=c):(e[n]=l,e[s]=r,n=s);else{if(!(c<i&&0>o(u,r)))break e;e[n]=u,e[c]=r,n=c}}}return t}function o(e,t){var r=e.sortIndex-t.sortIndex;return 0!==r?r:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var a=performance;t.unstable_now=function(){return a.now()}}else{var s=Date,l=s.now();t.unstable_now=function(){return s.now()-l}}var c=[],u=[],h=1,d=null,f=3,g=!1,p=!1,m=!1,v="function"===typeof setTimeout?setTimeout:null,b="function"===typeof clearTimeout?clearTimeout:null,y="undefined"!==typeof setImmediate?setImmediate:null;function w(e){for(var t=n(u);null!==t;){if(null===t.callback)i(u);else{if(!(t.startTime<=e))break;i(u),t.sortIndex=t.expirationTime,r(c,t)}t=n(u)}}function S(e){if(m=!1,w(e),!p)if(null!==n(c))p=!0,P(C);else{var t=n(u);null!==t&&N(S,t.startTime-e)}}function C(e,r){p=!1,m&&(m=!1,b(T),T=-1),g=!0;var o=f;try{for(w(r),d=n(c);null!==d&&(!(d.expirationTime>r)||e&&!R());){var a=d.callback;if("function"===typeof a){d.callback=null,f=d.priorityLevel;var s=a(d.expirationTime<=r);r=t.unstable_now(),"function"===typeof s?d.callback=s:d===n(c)&&i(c),w(r)}else i(c);d=n(c)}if(null!==d)var l=!0;else{var h=n(u);null!==h&&N(S,h.startTime-r),l=!1}return l}finally{d=null,f=o,g=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var k,x=!1,E=null,T=-1,_=5,A=-1;function R(){return!(t.unstable_now()-A<_)}function O(){if(null!==E){var e=t.unstable_now();A=e;var r=!0;try{r=E(!0,e)}finally{r?k():(x=!1,E=null)}}else x=!1}if("function"===typeof y)k=function(){y(O)};else if("undefined"!==typeof MessageChannel){var M=new MessageChannel,I=M.port2;M.port1.onmessage=O,k=function(){I.postMessage(null)}}else k=function(){v(O,0)};function P(e){E=e,x||(x=!0,k())}function N(e,r){T=v((function(){e(t.unstable_now())}),r)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){p||g||(p=!0,P(C))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):_=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function(e){switch(f){case 1:case 2:case 3:var t=3;break;default:t=f}var r=f;f=t;try{return e()}finally{f=r}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var r=f;f=e;try{return t()}finally{f=r}},t.unstable_scheduleCallback=function(e,i,o){var a=t.unstable_now();switch("object"===typeof o&&null!==o?o="number"===typeof(o=o.delay)&&0<o?a+o:a:o=a,e){case 1:var s=-1;break;case 2:s=250;break;case 5:s=1073741823;break;case 4:s=1e4;break;default:s=5e3}return e={id:h++,callback:i,priorityLevel:e,startTime:o,expirationTime:s=o+s,sortIndex:-1},o>a?(e.sortIndex=o,r(u,e),null===n(c)&&e===n(u)&&(m?(b(T),T=-1):m=!0,N(S,o-a))):(e.sortIndex=s,r(c,e),p||g||(p=!0,P(C))),e},t.unstable_shouldYield=R,t.unstable_wrapCallback=function(e){var t=f;return function(){var r=f;f=t;try{return e.apply(this,arguments)}finally{f=r}}}},8853:(e,t,r)=>{"use strict";e.exports=r(7234)},4132:function(e,t,r){!function(e,t){"use strict";if(!e.setImmediate){var r,n=1,i={},o=!1,a=e.document,s=Object.getPrototypeOf&&Object.getPrototypeOf(e);s=s&&s.setTimeout?s:e,"[object process]"==={}.toString.call(e.process)?r=function(e){process.nextTick((function(){c(e)}))}:function(){if(e.postMessage&&!e.importScripts){var t=!0,r=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=r,t}}()?function(){var t="setImmediate$"+Math.random()+"$",n=function(r){r.source===e&&"string"===typeof r.data&&0===r.data.indexOf(t)&&c(+r.data.slice(t.length))};e.addEventListener?e.addEventListener("message",n,!1):e.attachEvent("onmessage",n),r=function(r){e.postMessage(t+r,"*")}}():e.MessageChannel?function(){var e=new MessageChannel;e.port1.onmessage=function(e){c(e.data)},r=function(t){e.port2.postMessage(t)}}():a&&"onreadystatechange"in a.createElement("script")?function(){var e=a.documentElement;r=function(t){var r=a.createElement("script");r.onreadystatechange=function(){c(t),r.onreadystatechange=null,e.removeChild(r),r=null},e.appendChild(r)}}():r=function(e){setTimeout(c,0,e)},s.setImmediate=function(e){"function"!==typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),o=0;o<t.length;o++)t[o]=arguments[o+1];var a={callback:e,args:t};return i[n]=a,r(n),n++},s.clearImmediate=l}function l(e){delete i[e]}function c(e){if(o)setTimeout(c,0,e);else{var r=i[e];if(r){o=!0;try{!function(e){var r=e.callback,n=e.args;switch(n.length){case 0:r();break;case 1:r(n[0]);break;case 2:r(n[0],n[1]);break;case 3:r(n[0],n[1],n[2]);break;default:r.apply(t,n)}}(r)}finally{l(e),o=!1}}}}}("undefined"===typeof self?"undefined"===typeof r.g?this:r.g:self)},4121:function(e,t,r){var n;!function(i,o){"use strict";var a="function",s="undefined",l="object",c="string",u="major",h="model",d="name",f="type",g="vendor",p="version",m="architecture",v="console",b="mobile",y="tablet",w="smarttv",S="wearable",C="embedded",k="Amazon",x="Apple",E="ASUS",T="BlackBerry",_="Browser",A="Chrome",R="Firefox",O="Google",M="Huawei",I="LG",P="Microsoft",N="Motorola",D="Opera",F="Samsung",L="Sharp",H="Sony",B="Xiaomi",U="Zebra",j="Facebook",W="Chromium OS",V="Mac OS",z=function(e){for(var t={},r=0;r<e.length;r++)t[e[r].toUpperCase()]=e[r];return t},q=function(e,t){return typeof e===c&&-1!==G(t).indexOf(G(e))},G=function(e){return e.toLowerCase()},$=function(e,t){if(typeof e===c)return e=e.replace(/^\s\s*/,""),typeof t===s?e:e.substring(0,500)},K=function(e,t){for(var r,n,i,s,c,u,h=0;h<t.length&&!c;){var d=t[h],f=t[h+1];for(r=n=0;r<d.length&&!c&&d[r];)if(c=d[r++].exec(e))for(i=0;i<f.length;i++)u=c[++n],typeof(s=f[i])===l&&s.length>0?2===s.length?typeof s[1]==a?this[s[0]]=s[1].call(this,u):this[s[0]]=s[1]:3===s.length?typeof s[1]!==a||s[1].exec&&s[1].test?this[s[0]]=u?u.replace(s[1],s[2]):o:this[s[0]]=u?s[1].call(this,u,s[2]):o:4===s.length&&(this[s[0]]=u?s[3].call(this,u.replace(s[1],s[2])):o):this[s]=u||o;h+=2}},Y=function(e,t){for(var r in t)if(typeof t[r]===l&&t[r].length>0){for(var n=0;n<t[r].length;n++)if(q(t[r][n],e))return"?"===r?o:r}else if(q(t[r],e))return"?"===r?o:r;return e},X={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},J={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[p,[d,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[p,[d,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[d,p],[/opios[\/ ]+([\w\.]+)/i],[p,[d,D+" Mini"]],[/\bop(?:rg)?x\/([\w\.]+)/i],[p,[d,D+" GX"]],[/\bopr\/([\w\.]+)/i],[p,[d,D]],[/\bb[ai]*d(?:uhd|[ub]*[aekoprswx]{5,6})[\/ ]?([\w\.]+)/i],[p,[d,"Baidu"]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant|iemobile|slim)\s?(?:browser)?[\/ ]?([\w\.]*)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|qq|duckduckgo)\/([-\w\.]+)/i,/(heytap|ovi)browser\/([\d\.]+)/i,/(weibo)__([\d\.]+)/i],[d,p],[/\bddg\/([\w\.]+)/i],[p,[d,"DuckDuckGo"]],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[p,[d,"UC"+_]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i,/micromessenger\/([\w\.]+)/i],[p,[d,"WeChat"]],[/konqueror\/([\w\.]+)/i],[p,[d,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[p,[d,"IE"]],[/ya(?:search)?browser\/([\w\.]+)/i],[p,[d,"Yandex"]],[/slbrowser\/([\w\.]+)/i],[p,[d,"Smart Lenovo "+_]],[/(avast|avg)\/([\w\.]+)/i],[[d,/(.+)/,"$1 Secure "+_],p],[/\bfocus\/([\w\.]+)/i],[p,[d,R+" Focus"]],[/\bopt\/([\w\.]+)/i],[p,[d,D+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[p,[d,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[p,[d,"Dolphin"]],[/coast\/([\w\.]+)/i],[p,[d,D+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[p,[d,"MIUI "+_]],[/fxios\/([-\w\.]+)/i],[p,[d,R]],[/\bqihu|(qi?ho?o?|360)browser/i],[[d,"360 "+_]],[/(oculus|sailfish|huawei|vivo)browser\/([\w\.]+)/i],[[d,/(.+)/,"$1 "+_],p],[/samsungbrowser\/([\w\.]+)/i],[p,[d,F+" Internet"]],[/(comodo_dragon)\/([\w\.]+)/i],[[d,/_/g," "],p],[/metasr[\/ ]?([\d\.]+)/i],[p,[d,"Sogou Explorer"]],[/(sogou)mo\w+\/([\d\.]+)/i],[[d,"Sogou Mobile"],p],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|2345Explorer)[\/ ]?([\w\.]+)/i],[d,p],[/(lbbrowser)/i,/\[(linkedin)app\]/i],[d],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[d,j],p],[/(Klarna)\/([\w\.]+)/i,/(kakao(?:talk|story))[\/ ]([\w\.]+)/i,/(naver)\(.*?(\d+\.[\w\.]+).*\)/i,/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(alipay)client\/([\w\.]+)/i,/(twitter)(?:and| f.+e\/([\w\.]+))/i,/(chromium|instagram|snapchat)[\/ ]([-\w\.]+)/i],[d,p],[/\bgsa\/([\w\.]+) .*safari\//i],[p,[d,"GSA"]],[/musical_ly(?:.+app_?version\/|_)([\w\.]+)/i],[p,[d,"TikTok"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[p,[d,A+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[d,A+" WebView"],p],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[p,[d,"Android "+_]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[d,p],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[p,[d,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[p,d],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[d,[p,Y,{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(webkit|khtml)\/([\w\.]+)/i],[d,p],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[d,"Netscape"],p],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[p,[d,R+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i,/panasonic;(viera)/i],[d,p],[/(cobalt)\/([\w\.]+)/i],[d,[p,/master.|lts./,""]]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[m,"amd64"]],[/(ia32(?=;))/i],[[m,G]],[/((?:i[346]|x)86)[;\)]/i],[[m,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[m,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[m,"armhf"]],[/windows (ce|mobile); ppc;/i],[[m,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[m,/ower/,"",G]],[/(sun4\w)[;\)]/i],[[m,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[m,G]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[h,[g,F],[f,y]],[/\b((?:s[cgp]h|gt|sm)-\w+|sc[g-]?[\d]+a?|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[h,[g,F],[f,b]],[/(?:\/|\()(ip(?:hone|od)[\w, ]*)(?:\/|;)/i],[h,[g,x],[f,b]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[h,[g,x],[f,y]],[/(macintosh);/i],[h,[g,x]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[h,[g,L],[f,b]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[h,[g,M],[f,y]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[h,[g,M],[f,b]],[/\b(poco[\w ]+|m2\d{3}j\d\d[a-z]{2})(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/oid[^\)]+; (m?[12][0-389][01]\w{3,6}[c-y])( bui|; wv|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[h,/_/g," "],[g,B],[f,b]],[/oid[^\)]+; (2\d{4}(283|rpbf)[cgl])( bui|\))/i,/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[h,/_/g," "],[g,B],[f,y]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[h,[g,"OPPO"],[f,b]],[/\b(opd2\d{3}a?) bui/i],[h,[g,"OPPO"],[f,y]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[h,[g,"Vivo"],[f,b]],[/\b(rmx[1-3]\d{3})(?: bui|;|\))/i],[h,[g,"Realme"],[f,b]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[h,[g,N],[f,b]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[h,[g,N],[f,y]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[h,[g,I],[f,y]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[h,[g,I],[f,b]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[h,[g,"Lenovo"],[f,y]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[h,/_/g," "],[g,"Nokia"],[f,b]],[/(pixel c)\b/i],[h,[g,O],[f,y]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[h,[g,O],[f,b]],[/droid.+ (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[h,[g,H],[f,b]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[h,"Xperia Tablet"],[g,H],[f,y]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[h,[g,"OnePlus"],[f,b]],[/(alexa)webm/i,/(kf[a-z]{2}wi|aeo[c-r]{2})( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[h,[g,k],[f,y]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[h,/(.+)/g,"Fire Phone $1"],[g,k],[f,b]],[/(playbook);[-\w\),; ]+(rim)/i],[h,g,[f,y]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[h,[g,T],[f,b]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[h,[g,E],[f,y]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[h,[g,E],[f,b]],[/(nexus 9)/i],[h,[g,"HTC"],[f,y]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\.))|sony(?!-bra))[-_ ]?([-\w]*)/i],[g,[h,/_/g," "],[f,b]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[h,[g,"Acer"],[f,y]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[h,[g,"Meizu"],[f,b]],[/; ((?:power )?armor(?:[\w ]{0,8}))(?: bui|\))/i],[h,[g,"Ulefone"],[f,b]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron|infinix|tecno)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[g,h,[f,b]],[/(kobo)\s(ereader|touch)/i,/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[g,h,[f,y]],[/(surface duo)/i],[h,[g,P],[f,y]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[h,[g,"Fairphone"],[f,b]],[/(u304aa)/i],[h,[g,"AT&T"],[f,b]],[/\bsie-(\w*)/i],[h,[g,"Siemens"],[f,b]],[/\b(rct\w+) b/i],[h,[g,"RCA"],[f,y]],[/\b(venue[\d ]{2,7}) b/i],[h,[g,"Dell"],[f,y]],[/\b(q(?:mv|ta)\w+) b/i],[h,[g,"Verizon"],[f,y]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[h,[g,"Barnes & Noble"],[f,y]],[/\b(tm\d{3}\w+) b/i],[h,[g,"NuVision"],[f,y]],[/\b(k88) b/i],[h,[g,"ZTE"],[f,y]],[/\b(nx\d{3}j) b/i],[h,[g,"ZTE"],[f,b]],[/\b(gen\d{3}) b.+49h/i],[h,[g,"Swiss"],[f,b]],[/\b(zur\d{3}) b/i],[h,[g,"Swiss"],[f,y]],[/\b((zeki)?tb.*\b) b/i],[h,[g,"Zeki"],[f,y]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[g,"Dragon Touch"],h,[f,y]],[/\b(ns-?\w{0,9}) b/i],[h,[g,"Insignia"],[f,y]],[/\b((nxa|next)-?\w{0,9}) b/i],[h,[g,"NextBook"],[f,y]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[g,"Voice"],h,[f,b]],[/\b(lvtel\-)?(v1[12]) b/i],[[g,"LvTel"],h,[f,b]],[/\b(ph-1) /i],[h,[g,"Essential"],[f,b]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[h,[g,"Envizen"],[f,y]],[/\b(trio[-\w\. ]+) b/i],[h,[g,"MachSpeed"],[f,y]],[/\btu_(1491) b/i],[h,[g,"Rotor"],[f,y]],[/(shield[\w ]+) b/i],[h,[g,"Nvidia"],[f,y]],[/(sprint) (\w+)/i],[g,h,[f,b]],[/(kin\.[onetw]{3})/i],[[h,/\./g," "],[g,P],[f,b]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[h,[g,U],[f,y]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[h,[g,U],[f,b]],[/smart-tv.+(samsung)/i],[g,[f,w]],[/hbbtv.+maple;(\d+)/i],[[h,/^/,"SmartTV"],[g,F],[f,w]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[g,I],[f,w]],[/(apple) ?tv/i],[g,[h,x+" TV"],[f,w]],[/crkey/i],[[h,A+"cast"],[g,O],[f,w]],[/droid.+aft(\w+)( bui|\))/i],[h,[g,k],[f,w]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[h,[g,L],[f,w]],[/(bravia[\w ]+)( bui|\))/i],[h,[g,H],[f,w]],[/(mitv-\w{5}) bui/i],[h,[g,B],[f,w]],[/Hbbtv.*(technisat) (.*);/i],[g,h,[f,w]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w\+ ]*; *([\w\d][^;]*);([^;]*)/i],[[g,$],[h,$],[f,w]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[f,w]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[g,h,[f,v]],[/droid.+; (shield) bui/i],[h,[g,"Nvidia"],[f,v]],[/(playstation [345portablevi]+)/i],[h,[g,H],[f,v]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[h,[g,P],[f,v]],[/((pebble))app/i],[g,h,[f,S]],[/(watch)(?: ?os[,\/]|\d,\d\/)[\d\.]+/i],[h,[g,x],[f,S]],[/droid.+; (glass) \d/i],[h,[g,O],[f,S]],[/droid.+; (wt63?0{2,3})\)/i],[h,[g,U],[f,S]],[/(quest( \d| pro)?)/i],[h,[g,j],[f,S]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[g,[f,C]],[/(aeobc)\b/i],[h,[g,k],[f,C]],[/droid .+?; ([^;]+?)(?: bui|; wv\)|\) applew).+? mobile safari/i],[h,[f,b]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[h,[f,y]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[f,y]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[f,b]],[/(android[-\w\. ]{0,9});.+buil/i],[h,[g,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[p,[d,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[p,[d,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i,/\b(libweb)/i],[d,p],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[p,d]],os:[[/microsoft (windows) (vista|xp)/i],[d,p],[/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i],[d,[p,Y,X]],[/windows nt 6\.2; (arm)/i,/windows[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i,/(?:win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[p,Y,X],[d,"Windows"]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/(?:ios;fbsv\/|iphone.+ios[\/ ])([\d\.]+)/i,/cfnetwork\/.+darwin/i],[[p,/_/g,"."],[d,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[d,V],[p,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[p,d],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[d,p],[/\(bb(10);/i],[p,[d,T]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[p,[d,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[p,[d,R+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[p,[d,"webOS"]],[/watch(?: ?os[,\/]|\d,\d\/)([\d\.]+)/i],[p,[d,"watchOS"]],[/crkey\/([\d\.]+)/i],[p,[d,A+"cast"]],[/(cros) [\w]+(?:\)| ([\w\.]+)\b)/i],[[d,W],p],[/panasonic;(viera)/i,/(netrange)mmh/i,/(nettv)\/(\d+\.[\w\.]+)/i,/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[d,p],[/(sunos) ?([\w\.\d]*)/i],[[d,"Solaris"],p],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux|serenityos)/i,/(unix) ?([\w\.]*)/i],[d,p]]},Z=function(e,t){if(typeof e===l&&(t=e,e=o),!(this instanceof Z))return new Z(e,t).getResult();var r=typeof i!==s&&i.navigator?i.navigator:o,n=e||(r&&r.userAgent?r.userAgent:""),v=r&&r.userAgentData?r.userAgentData:o,w=t?function(e,t){var r={};for(var n in e)t[n]&&t[n].length%2===0?r[n]=t[n].concat(e[n]):r[n]=e[n];return r}(J,t):J,S=r&&r.userAgent==n;return this.getBrowser=function(){var e,t={};return t[d]=o,t[p]=o,K.call(t,n,w.browser),t[u]=typeof(e=t[p])===c?e.replace(/[^\d\.]/g,"").split(".")[0]:o,S&&r&&r.brave&&typeof r.brave.isBrave==a&&(t[d]="Brave"),t},this.getCPU=function(){var e={};return e[m]=o,K.call(e,n,w.cpu),e},this.getDevice=function(){var e={};return e[g]=o,e[h]=o,e[f]=o,K.call(e,n,w.device),S&&!e[f]&&v&&v.mobile&&(e[f]=b),S&&"Macintosh"==e[h]&&r&&typeof r.standalone!==s&&r.maxTouchPoints&&r.maxTouchPoints>2&&(e[h]="iPad",e[f]=y),e},this.getEngine=function(){var e={};return e[d]=o,e[p]=o,K.call(e,n,w.engine),e},this.getOS=function(){var e={};return e[d]=o,e[p]=o,K.call(e,n,w.os),S&&!e[d]&&v&&v.platform&&"Unknown"!=v.platform&&(e[d]=v.platform.replace(/chrome os/i,W).replace(/macos/i,V)),e},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return n},this.setUA=function(e){return n=typeof e===c&&e.length>500?$(e,500):e,this},this.setUA(n),this};Z.VERSION="0.7.38",Z.BROWSER=z([d,p,u]),Z.CPU=z([m]),Z.DEVICE=z([h,g,f,v,b,w,y,S,C]),Z.ENGINE=Z.OS=z([d,p]),typeof t!==s?(e.exports&&(t=e.exports=Z),t.UAParser=Z):r.amdO?(n=function(){return Z}.call(t,r,t,e))===o||(e.exports=n):typeof i!==s&&(i.UAParser=Z);var Q=typeof i!==s&&(i.jQuery||i.Zepto);if(Q&&!Q.ua){var ee=new Z;Q.ua=ee.getResult(),Q.ua.get=function(){return ee.getUA()},Q.ua.set=function(e){ee.setUA(e);var t=ee.getResult();for(var r in t)Q.ua[r]=t[r]}}}("object"===typeof window?window:this)},1672:(e,t,r)=>{var n;!function(){function i(e,t,r){return e.call.apply(e.bind,arguments)}function o(e,t,r){if(!e)throw Error();if(2<arguments.length){var n=Array.prototype.slice.call(arguments,2);return function(){var r=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(r,n),e.apply(t,r)}}return function(){return e.apply(t,arguments)}}function a(e,t,r){return(a=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?i:o).apply(null,arguments)}var s=Date.now||function(){return+new Date};function l(e,t){this.a=e,this.o=t||e,this.c=this.o.document}var c=!!window.FontFace;function u(e,t,r,n){if(t=e.c.createElement(t),r)for(var i in r)r.hasOwnProperty(i)&&("style"==i?t.style.cssText=r[i]:t.setAttribute(i,r[i]));return n&&t.appendChild(e.c.createTextNode(n)),t}function h(e,t,r){(e=e.c.getElementsByTagName(t)[0])||(e=document.documentElement),e.insertBefore(r,e.lastChild)}function d(e){e.parentNode&&e.parentNode.removeChild(e)}function f(e,t,r){t=t||[],r=r||[];for(var n=e.className.split(/\s+/),i=0;i<t.length;i+=1){for(var o=!1,a=0;a<n.length;a+=1)if(t[i]===n[a]){o=!0;break}o||n.push(t[i])}for(t=[],i=0;i<n.length;i+=1){for(o=!1,a=0;a<r.length;a+=1)if(n[i]===r[a]){o=!0;break}o||t.push(n[i])}e.className=t.join(" ").replace(/\s+/g," ").replace(/^\s+|\s+$/,"")}function g(e,t){for(var r=e.className.split(/\s+/),n=0,i=r.length;n<i;n++)if(r[n]==t)return!0;return!1}function p(e,t,r){function n(){s&&i&&o&&(s(a),s=null)}t=u(e,"link",{rel:"stylesheet",href:t,media:"all"});var i=!1,o=!0,a=null,s=r||null;c?(t.onload=function(){i=!0,n()},t.onerror=function(){i=!0,a=Error("Stylesheet failed to load"),n()}):setTimeout((function(){i=!0,n()}),0),h(e,"head",t)}function m(e,t,r,n){var i=e.c.getElementsByTagName("head")[0];if(i){var o=u(e,"script",{src:t}),a=!1;return o.onload=o.onreadystatechange=function(){a||this.readyState&&"loaded"!=this.readyState&&"complete"!=this.readyState||(a=!0,r&&r(null),o.onload=o.onreadystatechange=null,"HEAD"==o.parentNode.tagName&&i.removeChild(o))},i.appendChild(o),setTimeout((function(){a||(a=!0,r&&r(Error("Script load timeout")))}),n||5e3),o}return null}function v(){this.a=0,this.c=null}function b(e){return e.a++,function(){e.a--,w(e)}}function y(e,t){e.c=t,w(e)}function w(e){0==e.a&&e.c&&(e.c(),e.c=null)}function S(e){this.a=e||"-"}function C(e,t){this.c=e,this.f=4,this.a="n";var r=(t||"n4").match(/^([nio])([1-9])$/i);r&&(this.a=r[1],this.f=parseInt(r[2],10))}function k(e){var t=[];e=e.split(/,\s*/);for(var r=0;r<e.length;r++){var n=e[r].replace(/['"]/g,"");-1!=n.indexOf(" ")||/^\d/.test(n)?t.push("'"+n+"'"):t.push(n)}return t.join(",")}function x(e){return e.a+e.f}function E(e){var t="normal";return"o"===e.a?t="oblique":"i"===e.a&&(t="italic"),t}function T(e){var t=4,r="n",n=null;return e&&((n=e.match(/(normal|oblique|italic)/i))&&n[1]&&(r=n[1].substr(0,1).toLowerCase()),(n=e.match(/([1-9]00|normal|bold)/i))&&n[1]&&(/bold/i.test(n[1])?t=7:/[1-9]00/.test(n[1])&&(t=parseInt(n[1].substr(0,1),10)))),r+t}function _(e,t){this.c=e,this.f=e.o.document.documentElement,this.h=t,this.a=new S("-"),this.j=!1!==t.events,this.g=!1!==t.classes}function A(e){if(e.g){var t=g(e.f,e.a.c("wf","active")),r=[],n=[e.a.c("wf","loading")];t||r.push(e.a.c("wf","inactive")),f(e.f,r,n)}R(e,"inactive")}function R(e,t,r){e.j&&e.h[t]&&(r?e.h[t](r.c,x(r)):e.h[t]())}function O(){this.c={}}function M(e,t){this.c=e,this.f=t,this.a=u(this.c,"span",{"aria-hidden":"true"},this.f)}function I(e){h(e.c,"body",e.a)}function P(e){return"display:block;position:absolute;top:-9999px;left:-9999px;font-size:300px;width:auto;height:auto;line-height:normal;margin:0;padding:0;font-variant:normal;white-space:nowrap;font-family:"+k(e.c)+";font-style:"+E(e)+";font-weight:"+e.f+"00;"}function N(e,t,r,n,i,o){this.g=e,this.j=t,this.a=n,this.c=r,this.f=i||3e3,this.h=o||void 0}function D(e,t,r,n,i,o,a){this.v=e,this.B=t,this.c=r,this.a=n,this.s=a||"BESbswy",this.f={},this.w=i||3e3,this.u=o||null,this.m=this.j=this.h=this.g=null,this.g=new M(this.c,this.s),this.h=new M(this.c,this.s),this.j=new M(this.c,this.s),this.m=new M(this.c,this.s),e=P(e=new C(this.a.c+",serif",x(this.a))),this.g.a.style.cssText=e,e=P(e=new C(this.a.c+",sans-serif",x(this.a))),this.h.a.style.cssText=e,e=P(e=new C("serif",x(this.a))),this.j.a.style.cssText=e,e=P(e=new C("sans-serif",x(this.a))),this.m.a.style.cssText=e,I(this.g),I(this.h),I(this.j),I(this.m)}S.prototype.c=function(e){for(var t=[],r=0;r<arguments.length;r++)t.push(arguments[r].replace(/[\W_]+/g,"").toLowerCase());return t.join(this.a)},N.prototype.start=function(){var e=this.c.o.document,t=this,r=s(),n=new Promise((function(n,i){!function o(){s()-r>=t.f?i():e.fonts.load(function(e){return E(e)+" "+e.f+"00 300px "+k(e.c)}(t.a),t.h).then((function(e){1<=e.length?n():setTimeout(o,25)}),(function(){i()}))}()})),i=null,o=new Promise((function(e,r){i=setTimeout(r,t.f)}));Promise.race([o,n]).then((function(){i&&(clearTimeout(i),i=null),t.g(t.a)}),(function(){t.j(t.a)}))};var F={D:"serif",C:"sans-serif"},L=null;function H(){if(null===L){var e=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))/.exec(window.navigator.userAgent);L=!!e&&(536>parseInt(e[1],10)||536===parseInt(e[1],10)&&11>=parseInt(e[2],10))}return L}function B(e,t,r){for(var n in F)if(F.hasOwnProperty(n)&&t===e.f[F[n]]&&r===e.f[F[n]])return!0;return!1}function U(e){var t,r=e.g.a.offsetWidth,n=e.h.a.offsetWidth;(t=r===e.f.serif&&n===e.f["sans-serif"])||(t=H()&&B(e,r,n)),t?s()-e.A>=e.w?H()&&B(e,r,n)&&(null===e.u||e.u.hasOwnProperty(e.a.c))?j(e,e.v):j(e,e.B):function(e){setTimeout(a((function(){U(this)}),e),50)}(e):j(e,e.v)}function j(e,t){setTimeout(a((function(){d(this.g.a),d(this.h.a),d(this.j.a),d(this.m.a),t(this.a)}),e),0)}function W(e,t,r){this.c=e,this.a=t,this.f=0,this.m=this.j=!1,this.s=r}D.prototype.start=function(){this.f.serif=this.j.a.offsetWidth,this.f["sans-serif"]=this.m.a.offsetWidth,this.A=s(),U(this)};var V=null;function z(e){0==--e.f&&e.j&&(e.m?((e=e.a).g&&f(e.f,[e.a.c("wf","active")],[e.a.c("wf","loading"),e.a.c("wf","inactive")]),R(e,"active")):A(e.a))}function q(e){this.j=e,this.a=new O,this.h=0,this.f=this.g=!0}function G(e,t,r,n,i){var o=0==--e.h;(e.f||e.g)&&setTimeout((function(){var e=i||null,s=n||{};if(0===r.length&&o)A(t.a);else{t.f+=r.length,o&&(t.j=o);var l,c=[];for(l=0;l<r.length;l++){var u=r[l],h=s[u.c],d=t.a,g=u;if(d.g&&f(d.f,[d.a.c("wf",g.c,x(g).toString(),"loading")]),R(d,"fontloading",g),d=null,null===V)if(window.FontFace){g=/Gecko.*Firefox\/(\d+)/.exec(window.navigator.userAgent);var p=/OS X.*Version\/10\..*Safari/.exec(window.navigator.userAgent)&&/Apple/.exec(window.navigator.vendor);V=g?42<parseInt(g[1],10):!p}else V=!1;d=V?new N(a(t.g,t),a(t.h,t),t.c,u,t.s,h):new D(a(t.g,t),a(t.h,t),t.c,u,t.s,e,h),c.push(d)}for(l=0;l<c.length;l++)c[l].start()}}),0)}function $(e,t){this.c=e,this.a=t}function K(e,t){this.c=e,this.a=t}function Y(e,t){this.c=e||X,this.a=[],this.f=[],this.g=t||""}W.prototype.g=function(e){var t=this.a;t.g&&f(t.f,[t.a.c("wf",e.c,x(e).toString(),"active")],[t.a.c("wf",e.c,x(e).toString(),"loading"),t.a.c("wf",e.c,x(e).toString(),"inactive")]),R(t,"fontactive",e),this.m=!0,z(this)},W.prototype.h=function(e){var t=this.a;if(t.g){var r=g(t.f,t.a.c("wf",e.c,x(e).toString(),"active")),n=[],i=[t.a.c("wf",e.c,x(e).toString(),"loading")];r||n.push(t.a.c("wf",e.c,x(e).toString(),"inactive")),f(t.f,n,i)}R(t,"fontinactive",e),z(this)},q.prototype.load=function(e){this.c=new l(this.j,e.context||this.j),this.g=!1!==e.events,this.f=!1!==e.classes,function(e,t,r){var n=[],i=r.timeout;!function(e){e.g&&f(e.f,[e.a.c("wf","loading")]),R(e,"loading")}(t);n=function(e,t,r){var n,i=[];for(n in t)if(t.hasOwnProperty(n)){var o=e.c[n];o&&i.push(o(t[n],r))}return i}(e.a,r,e.c);var o=new W(e.c,t,i);for(e.h=n.length,t=0,r=n.length;t<r;t++)n[t].load((function(t,r,n){G(e,o,t,r,n)}))}(this,new _(this.c,e),e)},$.prototype.load=function(e){function t(){if(o["__mti_fntLst"+n]){var r,i=o["__mti_fntLst"+n](),a=[];if(i)for(var s=0;s<i.length;s++){var l=i[s].fontfamily;void 0!=i[s].fontStyle&&void 0!=i[s].fontWeight?(r=i[s].fontStyle+i[s].fontWeight,a.push(new C(l,r))):a.push(new C(l))}e(a)}else setTimeout((function(){t()}),50)}var r=this,n=r.a.projectId,i=r.a.version;if(n){var o=r.c.o;m(this.c,(r.a.api||"https://fast.fonts.net/jsapi")+"/"+n+".js"+(i?"?v="+i:""),(function(i){i?e([]):(o["__MonotypeConfiguration__"+n]=function(){return r.a},t())})).id="__MonotypeAPIScript__"+n}else e([])},K.prototype.load=function(e){var t,r,n=this.a.urls||[],i=this.a.families||[],o=this.a.testStrings||{},a=new v;for(t=0,r=n.length;t<r;t++)p(this.c,n[t],b(a));var s=[];for(t=0,r=i.length;t<r;t++)if((n=i[t].split(":"))[1])for(var l=n[1].split(","),c=0;c<l.length;c+=1)s.push(new C(n[0],l[c]));else s.push(new C(n[0]));y(a,(function(){e(s,o)}))};var X="https://fonts.googleapis.com/css";function J(e){this.f=e,this.a=[],this.c={}}var Z={latin:"BESbswy","latin-ext":"\xe7\xf6\xfc\u011f\u015f",cyrillic:"\u0439\u044f\u0416",greek:"\u03b1\u03b2\u03a3",khmer:"\u1780\u1781\u1782",Hanuman:"\u1780\u1781\u1782"},Q={thin:"1",extralight:"2","extra-light":"2",ultralight:"2","ultra-light":"2",light:"3",regular:"4",book:"4",medium:"5","semi-bold":"6",semibold:"6","demi-bold":"6",demibold:"6",bold:"7","extra-bold":"8",extrabold:"8","ultra-bold":"8",ultrabold:"8",black:"9",heavy:"9",l:"3",r:"4",b:"7"},ee={i:"i",italic:"i",n:"n",normal:"n"},te=/^(thin|(?:(?:extra|ultra)-?)?light|regular|book|medium|(?:(?:semi|demi|extra|ultra)-?)?bold|black|heavy|l|r|b|[1-9]00)?(n|i|normal|italic)?$/;function re(e,t){this.c=e,this.a=t}var ne={Arimo:!0,Cousine:!0,Tinos:!0};function ie(e,t){this.c=e,this.a=t}function oe(e,t){this.c=e,this.f=t,this.a=[]}re.prototype.load=function(e){var t=new v,r=this.c,n=new Y(this.a.api,this.a.text),i=this.a.families;!function(e,t){for(var r=t.length,n=0;n<r;n++){var i=t[n].split(":");3==i.length&&e.f.push(i.pop());var o="";2==i.length&&""!=i[1]&&(o=":"),e.a.push(i.join(o))}}(n,i);var o=new J(i);!function(e){for(var t=e.f.length,r=0;r<t;r++){var n=e.f[r].split(":"),i=n[0].replace(/\+/g," "),o=["n4"];if(2<=n.length){var a;if(a=[],s=n[1])for(var s,l=(s=s.split(",")).length,c=0;c<l;c++){var u;if((u=s[c]).match(/^[\w-]+$/))if(null==(h=te.exec(u.toLowerCase())))u="";else{if(u=null==(u=h[2])||""==u?"n":ee[u],null==(h=h[1])||""==h)h="4";else var h=Q[h]||(isNaN(h)?"4":h.substr(0,1));u=[u,h].join("")}else u="";u&&a.push(u)}0<a.length&&(o=a),3==n.length&&(a=[],0<(n=(n=n[2])?n.split(","):a).length&&(n=Z[n[0]])&&(e.c[i]=n))}for(e.c[i]||(n=Z[i])&&(e.c[i]=n),n=0;n<o.length;n+=1)e.a.push(new C(i,o[n]))}}(o),p(r,function(e){if(0==e.a.length)throw Error("No fonts to load!");if(-1!=e.c.indexOf("kit="))return e.c;for(var t=e.a.length,r=[],n=0;n<t;n++)r.push(e.a[n].replace(/ /g,"+"));return t=e.c+"?family="+r.join("%7C"),0<e.f.length&&(t+="&subset="+e.f.join(",")),0<e.g.length&&(t+="&text="+encodeURIComponent(e.g)),t}(n),b(t)),y(t,(function(){e(o.a,o.c,ne)}))},ie.prototype.load=function(e){var t=this.a.id,r=this.c.o;t?m(this.c,(this.a.api||"https://use.typekit.net")+"/"+t+".js",(function(t){if(t)e([]);else if(r.Typekit&&r.Typekit.config&&r.Typekit.config.fn){t=r.Typekit.config.fn;for(var n=[],i=0;i<t.length;i+=2)for(var o=t[i],a=t[i+1],s=0;s<a.length;s++)n.push(new C(o,a[s]));try{r.Typekit.load({events:!1,classes:!1,async:!0})}catch(l){}e(n)}}),2e3):e([])},oe.prototype.load=function(e){var t=this.f.id,r=this.c.o,n=this;t?(r.__webfontfontdeckmodule__||(r.__webfontfontdeckmodule__={}),r.__webfontfontdeckmodule__[t]=function(t,r){for(var i=0,o=r.fonts.length;i<o;++i){var a=r.fonts[i];n.a.push(new C(a.name,T("font-weight:"+a.weight+";font-style:"+a.style)))}e(n.a)},m(this.c,(this.f.api||"https://f.fontdeck.com/s/css/js/")+function(e){return e.o.location.hostname||e.a.location.hostname}(this.c)+"/"+t+".js",(function(t){t&&e([])}))):e([])};var ae=new q(window);ae.a.c.custom=function(e,t){return new K(t,e)},ae.a.c.fontdeck=function(e,t){return new oe(t,e)},ae.a.c.monotype=function(e,t){return new $(t,e)},ae.a.c.typekit=function(e,t){return new ie(t,e)},ae.a.c.google=function(e,t){return new re(t,e)};var se={load:a(ae.load,ae)};void 0===(n=function(){return se}.call(t,r,t,e))||(e.exports=n)}()},6457:()=>{},5536:()=>{},1061:()=>{},9988:()=>{},1760:()=>{},6282:()=>{},1239:(e,t,r)=>{"use strict";var n=r(4706),i=r(5464),o=TypeError;e.exports=function(e){if(n(e))return e;throw new o(i(e)+" is not a function")}},1608:(e,t,r)=>{"use strict";var n=r(6821),i=String,o=TypeError;e.exports=function(e){if(n(e))return e;throw new o(i(e)+" is not an object")}},972:(e,t,r)=>{"use strict";var n=r(6774),i=r(2201),o=r(1591),a=function(e){return function(t,r,a){var s=n(t),l=o(s);if(0===l)return!e&&-1;var c,u=i(a,l);if(e&&r!==r){for(;l>u;)if((c=s[u++])!==c)return!0}else for(;l>u;u++)if((e||u in s)&&s[u]===r)return e||u||0;return!e&&-1}};e.exports={includes:a(!0),indexOf:a(!1)}},1659:(e,t,r)=>{"use strict";var n=r(2945);e.exports=n([].slice)},5687:(e,t,r)=>{"use strict";var n=r(2945),i=n({}.toString),o=n("".slice);e.exports=function(e){return o(i(e),8,-1)}},5555:(e,t,r)=>{"use strict";var n=r(6164),i=r(2682),o=r(5214),a=r(3572);e.exports=function(e,t,r){for(var s=i(t),l=a.f,c=o.f,u=0;u<s.length;u++){var h=s[u];n(e,h)||r&&n(r,h)||l(e,h,c(t,h))}}},9266:(e,t,r)=>{"use strict";var n=r(9519),i=r(3572),o=r(6369);e.exports=n?function(e,t,r){return i.f(e,t,o(1,r))}:function(e,t,r){return e[t]=r,e}},6369:e=>{"use strict";e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},5551:(e,t,r)=>{"use strict";var n=r(4706),i=r(3572),o=r(4416),a=r(3036);e.exports=function(e,t,r,s){s||(s={});var l=s.enumerable,c=void 0!==s.name?s.name:t;if(n(r)&&o(r,c,s),s.global)l?e[t]=r:a(t,r);else{try{s.unsafe?e[t]&&(l=!0):delete e[t]}catch(u){}l?e[t]=r:i.f(e,t,{value:r,enumerable:!1,configurable:!s.nonConfigurable,writable:!s.nonWritable})}return e}},3036:(e,t,r)=>{"use strict";var n=r(4823),i=Object.defineProperty;e.exports=function(e,t){try{i(n,e,{value:t,configurable:!0,writable:!0})}catch(r){n[e]=t}return t}},9519:(e,t,r)=>{"use strict";var n=r(8084);e.exports=!n((function(){return 7!==Object.defineProperty({},1,{get:function(){return 7}})[1]}))},2760:(e,t,r)=>{"use strict";var n=r(4823),i=r(6821),o=n.document,a=i(o)&&i(o.createElement);e.exports=function(e){return a?o.createElement(e):{}}},6672:e=>{"use strict";e.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},8973:(e,t,r)=>{"use strict";var n=r(498);e.exports=/(?:ipad|iphone|ipod).*applewebkit/i.test(n)},4234:(e,t,r)=>{"use strict";var n=r(7192);e.exports="NODE"===n},498:(e,t,r)=>{"use strict";var n=r(4823).navigator,i=n&&n.userAgent;e.exports=i?String(i):""},166:(e,t,r)=>{"use strict";var n,i,o=r(4823),a=r(498),s=o.process,l=o.Deno,c=s&&s.versions||l&&l.version,u=c&&c.v8;u&&(i=(n=u.split("."))[0]>0&&n[0]<4?1:+(n[0]+n[1])),!i&&a&&(!(n=a.match(/Edge\/(\d+)/))||n[1]>=74)&&(n=a.match(/Chrome\/(\d+)/))&&(i=+n[1]),e.exports=i},7192:(e,t,r)=>{"use strict";var n=r(4823),i=r(498),o=r(5687),a=function(e){return i.slice(0,e.length)===e};e.exports=a("Bun/")?"BUN":a("Cloudflare-Workers")?"CLOUDFLARE":a("Deno/")?"DENO":a("Node.js/")?"NODE":n.Bun&&"string"==typeof Bun.version?"BUN":n.Deno&&"object"==typeof Deno.version?"DENO":"process"===o(n.process)?"NODE":n.window&&n.document?"BROWSER":"REST"},6715:(e,t,r)=>{"use strict";var n=r(4823),i=r(5214).f,o=r(9266),a=r(5551),s=r(3036),l=r(5555),c=r(6079);e.exports=function(e,t){var r,u,h,d,f,g=e.target,p=e.global,m=e.stat;if(r=p?n:m?n[g]||s(g,{}):n[g]&&n[g].prototype)for(u in t){if(d=t[u],h=e.dontCallGetSet?(f=i(r,u))&&f.value:r[u],!c(p?u:g+(m?".":"#")+u,e.forced)&&void 0!==h){if(typeof d==typeof h)continue;l(d,h)}(e.sham||h&&h.sham)&&o(d,"sham",!0),a(r,u,d,e)}}},8084:e=>{"use strict";e.exports=function(e){try{return!!e()}catch(t){return!0}}},6464:(e,t,r)=>{"use strict";var n=r(5897),i=Function.prototype,o=i.apply,a=i.call;e.exports="object"==typeof Reflect&&Reflect.apply||(n?a.bind(o):function(){return a.apply(o,arguments)})},9055:(e,t,r)=>{"use strict";var n=r(8097),i=r(1239),o=r(5897),a=n(n.bind);e.exports=function(e,t){return i(e),void 0===t?e:o?a(e,t):function(){return e.apply(t,arguments)}}},5897:(e,t,r)=>{"use strict";var n=r(8084);e.exports=!n((function(){var e=function(){}.bind();return"function"!=typeof e||e.hasOwnProperty("prototype")}))},4850:(e,t,r)=>{"use strict";var n=r(5897),i=Function.prototype.call;e.exports=n?i.bind(i):function(){return i.apply(i,arguments)}},2345:(e,t,r)=>{"use strict";var n=r(9519),i=r(6164),o=Function.prototype,a=n&&Object.getOwnPropertyDescriptor,s=i(o,"name"),l=s&&"something"===function(){}.name,c=s&&(!n||n&&a(o,"name").configurable);e.exports={EXISTS:s,PROPER:l,CONFIGURABLE:c}},8097:(e,t,r)=>{"use strict";var n=r(5687),i=r(2945);e.exports=function(e){if("Function"===n(e))return i(e)}},2945:(e,t,r)=>{"use strict";var n=r(5897),i=Function.prototype,o=i.call,a=n&&i.bind.bind(o,o);e.exports=n?a:function(e){return function(){return o.apply(e,arguments)}}},3542:(e,t,r)=>{"use strict";var n=r(4823),i=r(4706);e.exports=function(e,t){return arguments.length<2?(r=n[e],i(r)?r:void 0):n[e]&&n[e][t];var r}},7151:(e,t,r)=>{"use strict";var n=r(1239),i=r(3192);e.exports=function(e,t){var r=e[t];return i(r)?void 0:n(r)}},4823:function(e,t,r){"use strict";var n=function(e){return e&&e.Math===Math&&e};e.exports=n("object"==typeof globalThis&&globalThis)||n("object"==typeof window&&window)||n("object"==typeof self&&self)||n("object"==typeof r.g&&r.g)||n("object"==typeof this&&this)||function(){return this}()||Function("return this")()},6164:(e,t,r)=>{"use strict";var n=r(2945),i=r(2522),o=n({}.hasOwnProperty);e.exports=Object.hasOwn||function(e,t){return o(i(e),t)}},3114:e=>{"use strict";e.exports={}},904:(e,t,r)=>{"use strict";var n=r(3542);e.exports=n("document","documentElement")},9704:(e,t,r)=>{"use strict";var n=r(9519),i=r(8084),o=r(2760);e.exports=!n&&!i((function(){return 7!==Object.defineProperty(o("div"),"a",{get:function(){return 7}}).a}))},1178:(e,t,r)=>{"use strict";var n=r(2945),i=r(8084),o=r(5687),a=Object,s=n("".split);e.exports=i((function(){return!a("z").propertyIsEnumerable(0)}))?function(e){return"String"===o(e)?s(e,""):a(e)}:a},5167:(e,t,r)=>{"use strict";var n=r(2945),i=r(4706),o=r(5704),a=n(Function.toString);i(o.inspectSource)||(o.inspectSource=function(e){return a(e)}),e.exports=o.inspectSource},2428:(e,t,r)=>{"use strict";var n,i,o,a=r(9279),s=r(4823),l=r(6821),c=r(9266),u=r(6164),h=r(5704),d=r(4658),f=r(3114),g="Object already initialized",p=s.TypeError,m=s.WeakMap;if(a||h.state){var v=h.state||(h.state=new m);v.get=v.get,v.has=v.has,v.set=v.set,n=function(e,t){if(v.has(e))throw new p(g);return t.facade=e,v.set(e,t),t},i=function(e){return v.get(e)||{}},o=function(e){return v.has(e)}}else{var b=d("state");f[b]=!0,n=function(e,t){if(u(e,b))throw new p(g);return t.facade=e,c(e,b,t),t},i=function(e){return u(e,b)?e[b]:{}},o=function(e){return u(e,b)}}e.exports={set:n,get:i,has:o,enforce:function(e){return o(e)?i(e):n(e,{})},getterFor:function(e){return function(t){var r;if(!l(t)||(r=i(t)).type!==e)throw new p("Incompatible receiver, "+e+" required");return r}}}},4706:e=>{"use strict";var t="object"==typeof document&&document.all;e.exports="undefined"==typeof t&&void 0!==t?function(e){return"function"==typeof e||e===t}:function(e){return"function"==typeof e}},6079:(e,t,r)=>{"use strict";var n=r(8084),i=r(4706),o=/#|\.prototype\./,a=function(e,t){var r=l[s(e)];return r===u||r!==c&&(i(t)?n(t):!!t)},s=a.normalize=function(e){return String(e).replace(o,".").toLowerCase()},l=a.data={},c=a.NATIVE="N",u=a.POLYFILL="P";e.exports=a},3192:e=>{"use strict";e.exports=function(e){return null===e||void 0===e}},6821:(e,t,r)=>{"use strict";var n=r(4706);e.exports=function(e){return"object"==typeof e?null!==e:n(e)}},7592:e=>{"use strict";e.exports=!1},7970:(e,t,r)=>{"use strict";var n=r(3542),i=r(4706),o=r(6864),a=r(4111),s=Object;e.exports=a?function(e){return"symbol"==typeof e}:function(e){var t=n("Symbol");return i(t)&&o(t.prototype,s(e))}},1591:(e,t,r)=>{"use strict";var n=r(8249);e.exports=function(e){return n(e.length)}},4416:(e,t,r)=>{"use strict";var n=r(2945),i=r(8084),o=r(4706),a=r(6164),s=r(9519),l=r(2345).CONFIGURABLE,c=r(5167),u=r(2428),h=u.enforce,d=u.get,f=String,g=Object.defineProperty,p=n("".slice),m=n("".replace),v=n([].join),b=s&&!i((function(){return 8!==g((function(){}),"length",{value:8}).length})),y=String(String).split("String"),w=e.exports=function(e,t,r){"Symbol("===p(f(t),0,7)&&(t="["+m(f(t),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),r&&r.getter&&(t="get "+t),r&&r.setter&&(t="set "+t),(!a(e,"name")||l&&e.name!==t)&&(s?g(e,"name",{value:t,configurable:!0}):e.name=t),b&&r&&a(r,"arity")&&e.length!==r.arity&&g(e,"length",{value:r.arity});try{r&&a(r,"constructor")&&r.constructor?s&&g(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch(i){}var n=h(e);return a(n,"source")||(n.source=v(y,"string"==typeof t?t:"")),e};Function.prototype.toString=w((function(){return o(this)&&d(this).source||c(this)}),"toString")},9344:e=>{"use strict";var t=Math.ceil,r=Math.floor;e.exports=Math.trunc||function(e){var n=+e;return(n>0?r:t)(n)}},3572:(e,t,r)=>{"use strict";var n=r(9519),i=r(9704),o=r(253),a=r(1608),s=r(3326),l=TypeError,c=Object.defineProperty,u=Object.getOwnPropertyDescriptor,h="enumerable",d="configurable",f="writable";t.f=n?o?function(e,t,r){if(a(e),t=s(t),a(r),"function"===typeof e&&"prototype"===t&&"value"in r&&f in r&&!r[f]){var n=u(e,t);n&&n[f]&&(e[t]=r.value,r={configurable:d in r?r[d]:n[d],enumerable:h in r?r[h]:n[h],writable:!1})}return c(e,t,r)}:c:function(e,t,r){if(a(e),t=s(t),a(r),i)try{return c(e,t,r)}catch(n){}if("get"in r||"set"in r)throw new l("Accessors not supported");return"value"in r&&(e[t]=r.value),e}},5214:(e,t,r)=>{"use strict";var n=r(9519),i=r(4850),o=r(4022),a=r(6369),s=r(6774),l=r(3326),c=r(6164),u=r(9704),h=Object.getOwnPropertyDescriptor;t.f=n?h:function(e,t){if(e=s(e),t=l(t),u)try{return h(e,t)}catch(r){}if(c(e,t))return a(!i(o.f,e,t),e[t])}},7251:(e,t,r)=>{"use strict";var n=r(4061),i=r(6672).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return n(e,i)}},6842:(e,t)=>{"use strict";t.f=Object.getOwnPropertySymbols},6864:(e,t,r)=>{"use strict";var n=r(2945);e.exports=n({}.isPrototypeOf)},4061:(e,t,r)=>{"use strict";var n=r(2945),i=r(6164),o=r(6774),a=r(972).indexOf,s=r(3114),l=n([].push);e.exports=function(e,t){var r,n=o(e),c=0,u=[];for(r in n)!i(s,r)&&i(n,r)&&l(u,r);for(;t.length>c;)i(n,r=t[c++])&&(~a(u,r)||l(u,r));return u}},4022:(e,t)=>{"use strict";var r={}.propertyIsEnumerable,n=Object.getOwnPropertyDescriptor,i=n&&!r.call({1:2},1);t.f=i?function(e){var t=n(this,e);return!!t&&t.enumerable}:r},2509:(e,t,r)=>{"use strict";var n=r(4850),i=r(4706),o=r(6821),a=TypeError;e.exports=function(e,t){var r,s;if("string"===t&&i(r=e.toString)&&!o(s=n(r,e)))return s;if(i(r=e.valueOf)&&!o(s=n(r,e)))return s;if("string"!==t&&i(r=e.toString)&&!o(s=n(r,e)))return s;throw new a("Can't convert object to primitive value")}},2682:(e,t,r)=>{"use strict";var n=r(3542),i=r(2945),o=r(7251),a=r(6842),s=r(1608),l=i([].concat);e.exports=n("Reflect","ownKeys")||function(e){var t=o.f(s(e)),r=a.f;return r?l(t,r(e)):t}},327:(e,t,r)=>{"use strict";var n=r(3192),i=TypeError;e.exports=function(e){if(n(e))throw new i("Can't call method on "+e);return e}},1709:(e,t,r)=>{"use strict";var n=r(4823),i=r(6464),o=r(4706),a=r(7192),s=r(498),l=r(1659),c=r(155),u=n.Function,h=/MSIE .\./.test(s)||"BUN"===a&&function(){var e=n.Bun.version.split(".");return e.length<3||"0"===e[0]&&(e[1]<3||"3"===e[1]&&"0"===e[2])}();e.exports=function(e,t){var r=t?2:1;return h?function(n,a){var s=c(arguments.length,1)>r,h=o(n)?n:u(n),d=s?l(arguments,r):[],f=s?function(){i(h,this,d)}:h;return t?e(f,a):e(f)}:e}},4658:(e,t,r)=>{"use strict";var n=r(816),i=r(7899),o=n("keys");e.exports=function(e){return o[e]||(o[e]=i(e))}},5704:(e,t,r)=>{"use strict";var n=r(7592),i=r(4823),o=r(3036),a="__core-js_shared__",s=e.exports=i[a]||o(a,{});(s.versions||(s.versions=[])).push({version:"3.38.0",mode:n?"pure":"global",copyright:"\xa9 2014-2024 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.38.0/LICENSE",source:"https://github.com/zloirock/core-js"})},816:(e,t,r)=>{"use strict";var n=r(5704);e.exports=function(e,t){return n[e]||(n[e]=t||{})}},4030:(e,t,r)=>{"use strict";var n=r(166),i=r(8084),o=r(4823).String;e.exports=!!Object.getOwnPropertySymbols&&!i((function(){var e=Symbol("symbol detection");return!o(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&n&&n<41}))},9464:(e,t,r)=>{"use strict";var n,i,o,a,s=r(4823),l=r(6464),c=r(9055),u=r(4706),h=r(6164),d=r(8084),f=r(904),g=r(1659),p=r(2760),m=r(155),v=r(8973),b=r(4234),y=s.setImmediate,w=s.clearImmediate,S=s.process,C=s.Dispatch,k=s.Function,x=s.MessageChannel,E=s.String,T=0,_={},A="onreadystatechange";d((function(){n=s.location}));var R=function(e){if(h(_,e)){var t=_[e];delete _[e],t()}},O=function(e){return function(){R(e)}},M=function(e){R(e.data)},I=function(e){s.postMessage(E(e),n.protocol+"//"+n.host)};y&&w||(y=function(e){m(arguments.length,1);var t=u(e)?e:k(e),r=g(arguments,1);return _[++T]=function(){l(t,void 0,r)},i(T),T},w=function(e){delete _[e]},b?i=function(e){S.nextTick(O(e))}:C&&C.now?i=function(e){C.now(O(e))}:x&&!v?(a=(o=new x).port2,o.port1.onmessage=M,i=c(a.postMessage,a)):s.addEventListener&&u(s.postMessage)&&!s.importScripts&&n&&"file:"!==n.protocol&&!d(I)?(i=I,s.addEventListener("message",M,!1)):i=A in p("script")?function(e){f.appendChild(p("script"))[A]=function(){f.removeChild(this),R(e)}}:function(e){setTimeout(O(e),0)}),e.exports={set:y,clear:w}},2201:(e,t,r)=>{"use strict";var n=r(466),i=Math.max,o=Math.min;e.exports=function(e,t){var r=n(e);return r<0?i(r+t,0):o(r,t)}},6774:(e,t,r)=>{"use strict";var n=r(1178),i=r(327);e.exports=function(e){return n(i(e))}},466:(e,t,r)=>{"use strict";var n=r(9344);e.exports=function(e){var t=+e;return t!==t||0===t?0:n(t)}},8249:(e,t,r)=>{"use strict";var n=r(466),i=Math.min;e.exports=function(e){var t=n(e);return t>0?i(t,9007199254740991):0}},2522:(e,t,r)=>{"use strict";var n=r(327),i=Object;e.exports=function(e){return i(n(e))}},9140:(e,t,r)=>{"use strict";var n=r(4850),i=r(6821),o=r(7970),a=r(7151),s=r(2509),l=r(4352),c=TypeError,u=l("toPrimitive");e.exports=function(e,t){if(!i(e)||o(e))return e;var r,l=a(e,u);if(l){if(void 0===t&&(t="default"),r=n(l,e,t),!i(r)||o(r))return r;throw new c("Can't convert object to primitive value")}return void 0===t&&(t="number"),s(e,t)}},3326:(e,t,r)=>{"use strict";var n=r(9140),i=r(7970);e.exports=function(e){var t=n(e,"string");return i(t)?t:t+""}},5464:e=>{"use strict";var t=String;e.exports=function(e){try{return t(e)}catch(r){return"Object"}}},7899:(e,t,r)=>{"use strict";var n=r(2945),i=0,o=Math.random(),a=n(1..toString);e.exports=function(e){return"Symbol("+(void 0===e?"":e)+")_"+a(++i+o,36)}},4111:(e,t,r)=>{"use strict";var n=r(4030);e.exports=n&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},253:(e,t,r)=>{"use strict";var n=r(9519),i=r(8084);e.exports=n&&i((function(){return 42!==Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype}))},155:e=>{"use strict";var t=TypeError;e.exports=function(e,r){if(e<r)throw new t("Not enough arguments");return e}},9279:(e,t,r)=>{"use strict";var n=r(4823),i=r(4706),o=n.WeakMap;e.exports=i(o)&&/native code/.test(String(o))},4352:(e,t,r)=>{"use strict";var n=r(4823),i=r(816),o=r(6164),a=r(7899),s=r(4030),l=r(4111),c=n.Symbol,u=i("wks"),h=l?c.for||c:c&&c.withoutSetter||a;e.exports=function(e){return o(u,e)||(u[e]=s&&o(c,e)?c[e]:h("Symbol."+e)),u[e]}},6023:(e,t,r)=>{"use strict";var n=r(6715),i=r(4823),o=r(9464).clear;n({global:!0,bind:!0,enumerable:!0,forced:i.clearImmediate!==o},{clearImmediate:o})},4647:(e,t,r)=>{"use strict";r(6023),r(9286)},9286:(e,t,r)=>{"use strict";var n=r(6715),i=r(4823),o=r(9464).set,a=r(1709),s=i.setImmediate?a(o,!1):o;n({global:!0,bind:!0,enumerable:!0,forced:i.setImmediate!==s},{setImmediate:s})}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var r=__webpack_module_cache__[e]={id:e,loaded:!1,exports:{}};return __webpack_modules__[e].call(r.exports,r,r.exports,__webpack_require__),r.loaded=!0,r.exports}__webpack_require__.amdO={},__webpack_require__.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return __webpack_require__.d(t,{a:t}),t},__webpack_require__.d=(e,t)=>{for(var r in t)__webpack_require__.o(t,r)&&!__webpack_require__.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},__webpack_require__.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),__webpack_require__.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},__webpack_require__.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),__webpack_require__.p="./";var __webpack_exports__={};(()=>{"use strict";var e={};__webpack_require__.r(e),__webpack_require__.d(e,{CHECKBOX_CHECKED:()=>Ff,CHECKBOX_RENDERER_NAMESPACE:()=>Df,CHECKBOX_UNCHECKED:()=>Lf,CONTEXTMENU_ITEMS_ADD_COMMENT:()=>Rd,CONTEXTMENU_ITEMS_ALIGNMENT:()=>Pd,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:()=>Ud,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:()=>Dd,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:()=>Ld,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:()=>Nd,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:()=>Bd,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:()=>Fd,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:()=>Hd,CONTEXTMENU_ITEMS_BORDERS:()=>jd,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:()=>zd,CONTEXTMENU_ITEMS_BORDERS_LEFT:()=>qd,CONTEXTMENU_ITEMS_BORDERS_RIGHT:()=>Vd,CONTEXTMENU_ITEMS_BORDERS_TOP:()=>Wd,CONTEXTMENU_ITEMS_CLEAR_COLUMN:()=>yd,CONTEXTMENU_ITEMS_COPY:()=>wd,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:()=>kd,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:()=>Cd,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:()=>Sd,CONTEXTMENU_ITEMS_CUT:()=>xd,CONTEXTMENU_ITEMS_EDIT_COMMENT:()=>Od,CONTEXTMENU_ITEMS_FREEZE_COLUMN:()=>Ed,CONTEXTMENU_ITEMS_HIDE_COLUMN:()=>Yd,CONTEXTMENU_ITEMS_HIDE_ROW:()=>Jd,CONTEXTMENU_ITEMS_INSERT_LEFT:()=>dd,CONTEXTMENU_ITEMS_INSERT_RIGHT:()=>fd,CONTEXTMENU_ITEMS_MERGE_CELLS:()=>_d,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:()=>Kd,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:()=>$d,CONTEXTMENU_ITEMS_NO_ITEMS:()=>cd,CONTEXTMENU_ITEMS_READ_ONLY:()=>bd,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:()=>Id,CONTEXTMENU_ITEMS_REDO:()=>vd,CONTEXTMENU_ITEMS_REMOVE_BORDERS:()=>Gd,CONTEXTMENU_ITEMS_REMOVE_COLUMN:()=>pd,CONTEXTMENU_ITEMS_REMOVE_COMMENT:()=>Md,CONTEXTMENU_ITEMS_REMOVE_ROW:()=>gd,CONTEXTMENU_ITEMS_ROW_ABOVE:()=>ud,CONTEXTMENU_ITEMS_ROW_BELOW:()=>hd,CONTEXTMENU_ITEMS_SHOW_COLUMN:()=>Xd,CONTEXTMENU_ITEMS_SHOW_ROW:()=>Zd,CONTEXTMENU_ITEMS_UNDO:()=>md,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:()=>Td,CONTEXTMENU_ITEMS_UNMERGE_CELLS:()=>Ad,CONTEXT_MENU_ITEMS_NAMESPACE:()=>ld,FILTERS_BUTTONS_CANCEL:()=>Mf,FILTERS_BUTTONS_CLEAR:()=>Rf,FILTERS_BUTTONS_OK:()=>Of,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:()=>If,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:()=>Nf,FILTERS_BUTTONS_PLACEHOLDER_VALUE:()=>Pf,FILTERS_BUTTONS_SELECT_ALL:()=>Af,FILTERS_CONDITIONS_AFTER:()=>bf,FILTERS_CONDITIONS_BEFORE:()=>yf,FILTERS_CONDITIONS_BEGINS_WITH:()=>sf,FILTERS_CONDITIONS_BETWEEN:()=>mf,FILTERS_CONDITIONS_BY_VALUE:()=>hf,FILTERS_CONDITIONS_CONTAINS:()=>cf,FILTERS_CONDITIONS_EMPTY:()=>rf,FILTERS_CONDITIONS_ENDS_WITH:()=>lf,FILTERS_CONDITIONS_EQUAL:()=>of,FILTERS_CONDITIONS_GREATER_THAN:()=>df,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:()=>ff,FILTERS_CONDITIONS_LESS_THAN:()=>gf,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:()=>pf,FILTERS_CONDITIONS_NAMESPACE:()=>ef,FILTERS_CONDITIONS_NONE:()=>tf,FILTERS_CONDITIONS_NOT_BETWEEN:()=>vf,FILTERS_CONDITIONS_NOT_CONTAIN:()=>uf,FILTERS_CONDITIONS_NOT_EMPTY:()=>nf,FILTERS_CONDITIONS_NOT_EQUAL:()=>af,FILTERS_CONDITIONS_TODAY:()=>wf,FILTERS_CONDITIONS_TOMORROW:()=>Sf,FILTERS_CONDITIONS_YESTERDAY:()=>Cf,FILTERS_DIVS_FILTER_BY_CONDITION:()=>kf,FILTERS_DIVS_FILTER_BY_VALUE:()=>xf,FILTERS_LABELS_CONJUNCTION:()=>Ef,FILTERS_LABELS_DISJUNCTION:()=>Tf,FILTERS_NAMESPACE:()=>Qd,FILTERS_VALUES_BLANK_CELLS:()=>_f});var t=__webpack_require__(5043),r=__webpack_require__(7950),n=__webpack_require__(4391),i=__webpack_require__(4410);const o=0,a=1,s=-1,l=-4,c={all:{AF707:{fields:["S2DutyTitleDesc","S4Assessment","S5Assessment","S6Assessment"],likelyWidth:"201.041mm"},AF1206:{fields:["specificAccomplishments","p2SpecificAccomplishments"],likelyWidth:"202.321mm"},AF910:{fields:["KeyDuties","IIIComments","IVComments","VComments","VIIIComments","IXComments"],likelyWidth:"202.321mm"},AF911:{fields:["KeyDuties","IIIComments","IVComments","VIIComments","VIIIComments","IXComments"],likelyWidth:"202.321mm"}}};c.all.DAF707=c.all.AF707,c.all.DAF1206=c.all.AF1206,c.all.DAF910=c.all.AF910,c.all.DAF911=c.all.AF911;const u=e=>e.split(/[\s]+/),h=(e,t,r)=>{e.match("\n")&&console.error("renderBulletText expects a single line of text");const n=t(e.trimEnd());if(""===e)return{textLines:[],fullWidth:0,lines:0,overflow:0-r};if(n<r)return{textLines:[e],fullWidth:n,lines:1,overflow:n-r};{const i=(e=>e.split(/([\u2004\u2009\u2006\s?/|\-%!])(?=[a-zA-Z0-9+\\])/).filter(Boolean))(e);if(t(i[0].trimEnd())<r){let o=0;for(let e=1;e<=i.length;e++){if(t(i.slice(0,e).join("").trimEnd())>r){o=e-1;break}}const a=i.slice(o,i.length).join("");if(a===e)return console.warn("Can't fit \""+e+'" on a single line\n',{text:e,width:r,fullWidth:n}),{textLines:[e],fullWidth:n,lines:1,overflow:n-r};{const e=h(a,t,r);return{textLines:[i.slice(0,o).join(""),...e.textLines],fullWidth:n,lines:1+e.lines,overflow:n-r}}}{const i=n/e.length,o=parseInt(r/i),a=t(e.substring(0,o));let s=o;if(a>r)for(let n=o-1;n>0;n--){if(t(e.substring(0,n))<r){s=n;break}}else if(a<r)for(let n=o;n<=e.length;n++){if(t(e.substring(0,n))>r){s=n-1;break}}const l=e.substring(s,e.length);if(l===e)return console.warn("Can't fit \""+e+'" on a single line\n',{text:e,width:r,fullWidth:n}),{textLines:[e],fullWidth:n,lines:1,overflow:n-r};{const i=h(l,t,r);return{textLines:[e.substring(0,s),...i.textLines],fullWidth:n,lines:1+i.lines,overflow:n-r}}}}};var d=__webpack_require__(579);const f=function(e){let{text:r="",widthPx:n=500,enableOptim:i=!1,height:c,onHighlight:f}=e;const g=(0,t.useRef)(null),[p,m]=(0,t.useState)((()=>[" "])),[v,b]=(0,t.useState)("inherit"),[y,w]=(0,t.useState)(!1),[S,C]=(0,t.useState)(s),[k,x]=(0,t.useState)({textLines:[""]}),E=n<75?75:n+.55;function T(e,t){const r=t.getContext("2d");return r.font="12pt Times New Roman",r.textAlign="left",r.measureText(e).width}return(0,t.useEffect)((()=>{x(h(r,(e=>T(e,g.current)),E))}),[r,E,i]),(0,t.useEffect)((()=>{if(w(!0),m(k.textLines),i){const e=((e,t)=>{const r="\u2004";let n=u(e.trimEnd());const i=t(e);if(0===i.overflow)return{status:o,rendering:i};let c=i,h=i;const d=i.overflow>=0?"\u2006":r;let f=s;const g=t(n[0]+" "+n.slice(1).join(d));if("\u2006"===d&&g.overflow>0||d===r&&g.overflow<l)return{status:a,rendering:g};for(;;){let e=(p=n.join(""),m=n.length-1-1,Math.floor(Math.abs(Math.floor(9*(e=>{let t,r,n=0;if(0===e.length)return n;for(t=0;t<e.length;t++)r=e.charCodeAt(t),n=(n<<5)-n+r,n|=0;return n})(p)+5)%1e5/1e5)*Math.floor(m))+1);n.splice(e,2,n.slice(e,e+2).join(d));let i=t(n.join(" "));if(d===r&&i.overflow>0){h=c,f=o;break}if("\u2006"===d&&i.overflow<=0){h=i,f=o;break}if(n.length<=2){h=i,f=d===r&&h.overflow>l?o:a;break}c=i}var p,m;return{status:f,rendering:h}})(r,(e=>h(e,(e=>T(e,g.current)),E)));w(!1),C(e.status),m(e.rendering.textLines)}else k.overflow<l||k.overflow>0?C(a):C(o),m(k.textLines),w(!1)}),[k,i,r,E]),(0,t.useEffect)((()=>{b(y?"silver":S===a?"red":"black")}),[y,p,S]),(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("canvas",{ref:g,style:{visibility:"hidden",position:"absolute",top:"-1000px",left:"-1000px"}}),(0,d.jsx)("div",{style:{minHeight:c,color:v,display:"flex",flexDirection:"column"},onMouseUp:f,children:p.map((e=>(0,d.jsx)("span",{style:{whiteSpace:"pre"},children:e},e)))})]})},g=96/25.4;function p(e){let{editorState:r,setEditorState:n,width:o,onSelect:a,abbrReplacer:s,enableOptim:l,enableHighlight:c,onHighlightChange:u}=e;const h="bulletOutput",[p,v]=(0,t.useState)(new Map);return(0,t.useEffect)((()=>{let e=new Map;for(let t of r.getCurrentContent().getBlockMap().keys()){const r=document.querySelector(`div[data-offset-key="${t}-0-0"]`);r&&e.set(t,r.getBoundingClientRect().height)}v(e)}),[r]),(0,d.jsxs)("div",{className:"bullets columns is-multiline",children:[(0,d.jsxs)("div",{className:"column",style:{},children:[(0,d.jsx)("h2",{className:"subtitle",children:"Input Bullets Here:"}),(0,d.jsx)("div",{className:"border",style:{width:o+1+"mm"},children:(0,d.jsx)(i.Editor,{editorState:r,onChange:e=>{if(r.getCurrentContent()!==e.getCurrentContent()){const t=e.getCurrentContent();if(!0===c){let o=e=>e.filter(((t,r)=>e.indexOf(t)!==r&&t.length>1)),s=o(t.getPlainText().split(/\s|;|--|\//));function l(e){let t=document.getElementsByClassName("yellow-highlight");console.log(t),console.log(e.target);for(let r of t)e.target.innerText==r.outerText&&("yellow"==r.style.background?r.style.background="LawnGreen":r.style.background="yellow")}s=[...new Set(s)];const u=e=>{let{children:t}=e;return(0,d.jsx)("span",{className:"yellow-highlight",onClick:l,style:{background:"yellow",cursor:"pointer"},children:t})};function h(e,t,r){const n=t.getText();e.forEach((e=>{[...n.matchAll(e)].forEach((e=>r(e.index,e.index+e[0].length)))}))}function f(e,t){h(s,e,t)}const g=()=>new i.CompositeDecorator([{strategy:f,component:u}]),{selectedText:p}=m(e);a&&""!==p&&a(p),n(i.EditorState.set(e,{decorator:g()}))}else{const{selectedText:v}=m(e);a&&""!==v&&a(v),n(i.EditorState.set(e,{decorator:null}))}}else{n(e);const{selectedText:b}=m(e);a&&""!==b&&a(b)}},handleKeyCommand:(e,t)=>{const r=i.RichUtils.handleKeyCommand(t,e);return r?(n(r),"handled"):"not-handled"},stripPastedStyles:!0,spellCheck:!0,autoCorrect:"off",enableHighlight:c,onHighlightChange:u})})]}),(0,d.jsxs)("div",{className:"column",children:[(0,d.jsx)("h2",{className:"subtitle",children:"View Output Here:"}),(0,d.jsx)("div",{className:"border",id:h,style:{width:o+1+"mm"},onMouseUp:e=>{const t=window.getSelection().toString();""!==t&&a(t)},onKeyDown:function(e){if(e.ctrlKey&&65===e.keyCode&&(e.preventDefault(),e.target.id.match(new RegExp(h)))){const t=document.createRange();t.selectNode(e.target),window.getSelection().removeAllRanges(),window.getSelection().addRange(t)}},tabIndex:"0",children:Array.from(r.getCurrentContent().getBlockMap(),(e=>{let[t,r]=e,n=r.getText();return s&&(n=s(n)),(0,d.jsx)(f,{text:n,widthPx:o*g,height:p.get(t),enableOptim:l},t)}))})]})]})}const m=e=>{const t=e.getSelection(),r=t.getAnchorKey(),n=e.getCurrentContent().getBlockForKey(r),i=t.getStartOffset(),o=t.getEndOffset(),a=n.getText().slice(i,o);return{selectionState:t,anchorKey:r,contentBlock:n,start:i,end:o,selectedText:a}},v=()=>{};let b={},y={},w=null,S={mark:v,measure:v};try{"undefined"!==typeof window&&(b=window),"undefined"!==typeof document&&(y=document),"undefined"!==typeof MutationObserver&&(w=MutationObserver),"undefined"!==typeof performance&&(S=performance)}catch(oJ){}const{userAgent:C=""}=b.navigator||{},k=b,x=y,E=w,T=S,_=(k.document,!!x.documentElement&&!!x.head&&"function"===typeof x.addEventListener&&"function"===typeof x.createElement),A=~C.indexOf("MSIE")||~C.indexOf("Trident/");var R="classic",O="duotone",M="sharp",I="sharp-duotone",P=[R,O,M,I],N={fak:"kit","fa-kit":"kit"},D={fakd:"kit-duotone","fa-kit-duotone":"kit-duotone"},F={classic:{fa:"solid",fas:"solid","fa-solid":"solid",far:"regular","fa-regular":"regular",fal:"light","fa-light":"light",fat:"thin","fa-thin":"thin",fad:"duotone","fa-duotone":"duotone",fab:"brands","fa-brands":"brands"},sharp:{fa:"solid",fass:"solid","fa-solid":"solid",fasr:"regular","fa-regular":"regular",fasl:"light","fa-light":"light",fast:"thin","fa-thin":"thin"},"sharp-duotone":{fa:"solid",fasds:"solid","fa-solid":"solid"}},L=[1,2,3,4,5,6,7,8,9,10],H=L.concat([11,12,13,14,15,16,17,18,19,20]),B={GROUP:"duotone-group",SWAP_OPACITY:"swap-opacity",PRIMARY:"primary",SECONDARY:"secondary"},U=[...Object.keys({classic:["fas","far","fal","fat"],sharp:["fass","fasr","fasl","fast"],"sharp-duotone":["fasds"]}),"solid","regular","light","thin","duotone","brands","2xs","xs","sm","lg","xl","2xl","beat","border","fade","beat-fade","bounce","flip-both","flip-horizontal","flip-vertical","flip","fw","inverse","layers-counter","layers-text","layers","li","pull-left","pull-right","pulse","rotate-180","rotate-270","rotate-90","rotate-by","shake","spin-pulse","spin-reverse","spin","stack-1x","stack-2x","stack","ul",B.GROUP,B.SWAP_OPACITY,B.PRIMARY,B.SECONDARY].concat(L.map((e=>"".concat(e,"x")))).concat(H.map((e=>"w-".concat(e)))),j={kit:"fak"},W={"kit-duotone":"fakd"};const V="___FONT_AWESOME___",z=16,q="fa",G="svg-inline--fa",K="data-fa-i2svg",Y="data-fa-pseudo-element",X="data-fa-pseudo-element-pending",J="data-prefix",Z="data-icon",Q="fontawesome-i2svg",ee="async",te=["HTML","HEAD","STYLE","SCRIPT"],re=(()=>{try{return!0}catch(e){return!1}})(),ne=[R,M,I];function ie(e){return new Proxy(e,{get:(e,t)=>t in e?e[t]:e[R]})}const oe={...F};oe[R]={...F[R],...N,...D};const ae=ie(oe),se={classic:{solid:"fas",regular:"far",light:"fal",thin:"fat",duotone:"fad",brands:"fab"},sharp:{solid:"fass",regular:"fasr",light:"fasl",thin:"fast"},"sharp-duotone":{solid:"fasds"}};se[R]={...se[R],...j,...W};const le=ie(se),ce={classic:{fab:"fa-brands",fad:"fa-duotone",fal:"fa-light",far:"fa-regular",fas:"fa-solid",fat:"fa-thin"},sharp:{fass:"fa-solid",fasr:"fa-regular",fasl:"fa-light",fast:"fa-thin"},"sharp-duotone":{fasds:"fa-solid"}};ce[R]={...ce[R],fak:"fa-kit"};const ue=ie(ce),he={classic:{"fa-brands":"fab","fa-duotone":"fad","fa-light":"fal","fa-regular":"far","fa-solid":"fas","fa-thin":"fat"},sharp:{"fa-solid":"fass","fa-regular":"fasr","fa-light":"fasl","fa-thin":"fast"},"sharp-duotone":{"fa-solid":"fasds"}};he[R]={...he[R],"fa-kit":"fak"};const de=ie(he),fe=/fa(s|r|l|t|d|b|k|kd|ss|sr|sl|st|sds)?[\-\ ]/,ge="fa-layers-text",pe=/Font ?Awesome ?([56 ]*)(Solid|Regular|Light|Thin|Duotone|Brands|Free|Pro|Sharp Duotone|Sharp|Kit)?.*/i,me=(ie({classic:{900:"fas",400:"far",normal:"far",300:"fal",100:"fat"},sharp:{900:"fass",400:"fasr",300:"fasl",100:"fast"},"sharp-duotone":{900:"fasds"}}),["class","data-prefix","data-icon","data-fa-transform","data-fa-mask"]),ve=B,be=new Set;Object.keys(le[R]).map(be.add.bind(be)),Object.keys(le[M]).map(be.add.bind(be)),Object.keys(le[I]).map(be.add.bind(be));const ye=["kit",...U],we=k.FontAwesomeConfig||{};if(x&&"function"===typeof x.querySelector){[["data-family-prefix","familyPrefix"],["data-css-prefix","cssPrefix"],["data-family-default","familyDefault"],["data-style-default","styleDefault"],["data-replacement-class","replacementClass"],["data-auto-replace-svg","autoReplaceSvg"],["data-auto-add-css","autoAddCss"],["data-auto-a11y","autoA11y"],["data-search-pseudo-elements","searchPseudoElements"],["data-observe-mutations","observeMutations"],["data-mutate-approach","mutateApproach"],["data-keep-original-source","keepOriginalSource"],["data-measure-performance","measurePerformance"],["data-show-missing-icons","showMissingIcons"]].forEach((e=>{let[t,r]=e;const n=function(e){return""===e||"false"!==e&&("true"===e||e)}(function(e){var t=x.querySelector("script["+e+"]");if(t)return t.getAttribute(e)}(t));void 0!==n&&null!==n&&(we[r]=n)}))}const Se={styleDefault:"solid",familyDefault:"classic",cssPrefix:q,replacementClass:G,autoReplaceSvg:!0,autoAddCss:!0,autoA11y:!0,searchPseudoElements:!1,observeMutations:!0,mutateApproach:"async",keepOriginalSource:!0,measurePerformance:!1,showMissingIcons:!0};we.familyPrefix&&(we.cssPrefix=we.familyPrefix);const Ce={...Se,...we};Ce.autoReplaceSvg||(Ce.observeMutations=!1);const ke={};Object.keys(Se).forEach((e=>{Object.defineProperty(ke,e,{enumerable:!0,set:function(t){Ce[e]=t,xe.forEach((e=>e(ke)))},get:function(){return Ce[e]}})})),Object.defineProperty(ke,"familyPrefix",{enumerable:!0,set:function(e){Ce.cssPrefix=e,xe.forEach((e=>e(ke)))},get:function(){return Ce.cssPrefix}}),k.FontAwesomeConfig=ke;const xe=[];const Ee=z,Te={size:16,x:0,y:0,rotate:0,flipX:!1,flipY:!1};const _e="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";function Ae(){let e=12,t="";for(;e-- >0;)t+=_e[62*Math.random()|0];return t}function Re(e){const t=[];for(let r=(e||[]).length>>>0;r--;)t[r]=e[r];return t}function Oe(e){return e.classList?Re(e.classList):(e.getAttribute("class")||"").split(" ").filter((e=>e))}function Me(e){return"".concat(e).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function Ie(e){return Object.keys(e||{}).reduce(((t,r)=>t+"".concat(r,": ").concat(e[r].trim(),";")),"")}function Pe(e){return e.size!==Te.size||e.x!==Te.x||e.y!==Te.y||e.rotate!==Te.rotate||e.flipX||e.flipY}var Ne=':root, :host {\n  --fa-font-solid: normal 900 1em/1 "Font Awesome 6 Free";\n  --fa-font-regular: normal 400 1em/1 "Font Awesome 6 Free";\n  --fa-font-light: normal 300 1em/1 "Font Awesome 6 Pro";\n  --fa-font-thin: normal 100 1em/1 "Font Awesome 6 Pro";\n  --fa-font-duotone: normal 900 1em/1 "Font Awesome 6 Duotone";\n  --fa-font-brands: normal 400 1em/1 "Font Awesome 6 Brands";\n  --fa-font-sharp-solid: normal 900 1em/1 "Font Awesome 6 Sharp";\n  --fa-font-sharp-regular: normal 400 1em/1 "Font Awesome 6 Sharp";\n  --fa-font-sharp-light: normal 300 1em/1 "Font Awesome 6 Sharp";\n  --fa-font-sharp-thin: normal 100 1em/1 "Font Awesome 6 Sharp";\n  --fa-font-sharp-duotone-solid: normal 900 1em/1 "Font Awesome 6 Sharp Duotone";\n}\n\nsvg:not(:root).svg-inline--fa, svg:not(:host).svg-inline--fa {\n  overflow: visible;\n  box-sizing: content-box;\n}\n\n.svg-inline--fa {\n  display: var(--fa-display, inline-block);\n  height: 1em;\n  overflow: visible;\n  vertical-align: -0.125em;\n}\n.svg-inline--fa.fa-2xs {\n  vertical-align: 0.1em;\n}\n.svg-inline--fa.fa-xs {\n  vertical-align: 0em;\n}\n.svg-inline--fa.fa-sm {\n  vertical-align: -0.0714285705em;\n}\n.svg-inline--fa.fa-lg {\n  vertical-align: -0.2em;\n}\n.svg-inline--fa.fa-xl {\n  vertical-align: -0.25em;\n}\n.svg-inline--fa.fa-2xl {\n  vertical-align: -0.3125em;\n}\n.svg-inline--fa.fa-pull-left {\n  margin-right: var(--fa-pull-margin, 0.3em);\n  width: auto;\n}\n.svg-inline--fa.fa-pull-right {\n  margin-left: var(--fa-pull-margin, 0.3em);\n  width: auto;\n}\n.svg-inline--fa.fa-li {\n  width: var(--fa-li-width, 2em);\n  top: 0.25em;\n}\n.svg-inline--fa.fa-fw {\n  width: var(--fa-fw-width, 1.25em);\n}\n\n.fa-layers svg.svg-inline--fa {\n  bottom: 0;\n  left: 0;\n  margin: auto;\n  position: absolute;\n  right: 0;\n  top: 0;\n}\n\n.fa-layers-counter, .fa-layers-text {\n  display: inline-block;\n  position: absolute;\n  text-align: center;\n}\n\n.fa-layers {\n  display: inline-block;\n  height: 1em;\n  position: relative;\n  text-align: center;\n  vertical-align: -0.125em;\n  width: 1em;\n}\n.fa-layers svg.svg-inline--fa {\n  transform-origin: center center;\n}\n\n.fa-layers-text {\n  left: 50%;\n  top: 50%;\n  transform: translate(-50%, -50%);\n  transform-origin: center center;\n}\n\n.fa-layers-counter {\n  background-color: var(--fa-counter-background-color, #ff253a);\n  border-radius: var(--fa-counter-border-radius, 1em);\n  box-sizing: border-box;\n  color: var(--fa-inverse, #fff);\n  line-height: var(--fa-counter-line-height, 1);\n  max-width: var(--fa-counter-max-width, 5em);\n  min-width: var(--fa-counter-min-width, 1.5em);\n  overflow: hidden;\n  padding: var(--fa-counter-padding, 0.25em 0.5em);\n  right: var(--fa-right, 0);\n  text-overflow: ellipsis;\n  top: var(--fa-top, 0);\n  transform: scale(var(--fa-counter-scale, 0.25));\n  transform-origin: top right;\n}\n\n.fa-layers-bottom-right {\n  bottom: var(--fa-bottom, 0);\n  right: var(--fa-right, 0);\n  top: auto;\n  transform: scale(var(--fa-layers-scale, 0.25));\n  transform-origin: bottom right;\n}\n\n.fa-layers-bottom-left {\n  bottom: var(--fa-bottom, 0);\n  left: var(--fa-left, 0);\n  right: auto;\n  top: auto;\n  transform: scale(var(--fa-layers-scale, 0.25));\n  transform-origin: bottom left;\n}\n\n.fa-layers-top-right {\n  top: var(--fa-top, 0);\n  right: var(--fa-right, 0);\n  transform: scale(var(--fa-layers-scale, 0.25));\n  transform-origin: top right;\n}\n\n.fa-layers-top-left {\n  left: var(--fa-left, 0);\n  right: auto;\n  top: var(--fa-top, 0);\n  transform: scale(var(--fa-layers-scale, 0.25));\n  transform-origin: top left;\n}\n\n.fa-1x {\n  font-size: 1em;\n}\n\n.fa-2x {\n  font-size: 2em;\n}\n\n.fa-3x {\n  font-size: 3em;\n}\n\n.fa-4x {\n  font-size: 4em;\n}\n\n.fa-5x {\n  font-size: 5em;\n}\n\n.fa-6x {\n  font-size: 6em;\n}\n\n.fa-7x {\n  font-size: 7em;\n}\n\n.fa-8x {\n  font-size: 8em;\n}\n\n.fa-9x {\n  font-size: 9em;\n}\n\n.fa-10x {\n  font-size: 10em;\n}\n\n.fa-2xs {\n  font-size: 0.625em;\n  line-height: 0.1em;\n  vertical-align: 0.225em;\n}\n\n.fa-xs {\n  font-size: 0.75em;\n  line-height: 0.0833333337em;\n  vertical-align: 0.125em;\n}\n\n.fa-sm {\n  font-size: 0.875em;\n  line-height: 0.0714285718em;\n  vertical-align: 0.0535714295em;\n}\n\n.fa-lg {\n  font-size: 1.25em;\n  line-height: 0.05em;\n  vertical-align: -0.075em;\n}\n\n.fa-xl {\n  font-size: 1.5em;\n  line-height: 0.0416666682em;\n  vertical-align: -0.125em;\n}\n\n.fa-2xl {\n  font-size: 2em;\n  line-height: 0.03125em;\n  vertical-align: -0.1875em;\n}\n\n.fa-fw {\n  text-align: center;\n  width: 1.25em;\n}\n\n.fa-ul {\n  list-style-type: none;\n  margin-left: var(--fa-li-margin, 2.5em);\n  padding-left: 0;\n}\n.fa-ul > li {\n  position: relative;\n}\n\n.fa-li {\n  left: calc(-1 * var(--fa-li-width, 2em));\n  position: absolute;\n  text-align: center;\n  width: var(--fa-li-width, 2em);\n  line-height: inherit;\n}\n\n.fa-border {\n  border-color: var(--fa-border-color, #eee);\n  border-radius: var(--fa-border-radius, 0.1em);\n  border-style: var(--fa-border-style, solid);\n  border-width: var(--fa-border-width, 0.08em);\n  padding: var(--fa-border-padding, 0.2em 0.25em 0.15em);\n}\n\n.fa-pull-left {\n  float: left;\n  margin-right: var(--fa-pull-margin, 0.3em);\n}\n\n.fa-pull-right {\n  float: right;\n  margin-left: var(--fa-pull-margin, 0.3em);\n}\n\n.fa-beat {\n  animation-name: fa-beat;\n  animation-delay: var(--fa-animation-delay, 0s);\n  animation-direction: var(--fa-animation-direction, normal);\n  animation-duration: var(--fa-animation-duration, 1s);\n  animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  animation-timing-function: var(--fa-animation-timing, ease-in-out);\n}\n\n.fa-bounce {\n  animation-name: fa-bounce;\n  animation-delay: var(--fa-animation-delay, 0s);\n  animation-direction: var(--fa-animation-direction, normal);\n  animation-duration: var(--fa-animation-duration, 1s);\n  animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.28, 0.84, 0.42, 1));\n}\n\n.fa-fade {\n  animation-name: fa-fade;\n  animation-delay: var(--fa-animation-delay, 0s);\n  animation-direction: var(--fa-animation-direction, normal);\n  animation-duration: var(--fa-animation-duration, 1s);\n  animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));\n}\n\n.fa-beat-fade {\n  animation-name: fa-beat-fade;\n  animation-delay: var(--fa-animation-delay, 0s);\n  animation-direction: var(--fa-animation-direction, normal);\n  animation-duration: var(--fa-animation-duration, 1s);\n  animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  animation-timing-function: var(--fa-animation-timing, cubic-bezier(0.4, 0, 0.6, 1));\n}\n\n.fa-flip {\n  animation-name: fa-flip;\n  animation-delay: var(--fa-animation-delay, 0s);\n  animation-direction: var(--fa-animation-direction, normal);\n  animation-duration: var(--fa-animation-duration, 1s);\n  animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  animation-timing-function: var(--fa-animation-timing, ease-in-out);\n}\n\n.fa-shake {\n  animation-name: fa-shake;\n  animation-delay: var(--fa-animation-delay, 0s);\n  animation-direction: var(--fa-animation-direction, normal);\n  animation-duration: var(--fa-animation-duration, 1s);\n  animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  animation-timing-function: var(--fa-animation-timing, linear);\n}\n\n.fa-spin {\n  animation-name: fa-spin;\n  animation-delay: var(--fa-animation-delay, 0s);\n  animation-direction: var(--fa-animation-direction, normal);\n  animation-duration: var(--fa-animation-duration, 2s);\n  animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  animation-timing-function: var(--fa-animation-timing, linear);\n}\n\n.fa-spin-reverse {\n  --fa-animation-direction: reverse;\n}\n\n.fa-pulse,\n.fa-spin-pulse {\n  animation-name: fa-spin;\n  animation-direction: var(--fa-animation-direction, normal);\n  animation-duration: var(--fa-animation-duration, 1s);\n  animation-iteration-count: var(--fa-animation-iteration-count, infinite);\n  animation-timing-function: var(--fa-animation-timing, steps(8));\n}\n\n@media (prefers-reduced-motion: reduce) {\n  .fa-beat,\n.fa-bounce,\n.fa-fade,\n.fa-beat-fade,\n.fa-flip,\n.fa-pulse,\n.fa-shake,\n.fa-spin,\n.fa-spin-pulse {\n    animation-delay: -1ms;\n    animation-duration: 1ms;\n    animation-iteration-count: 1;\n    transition-delay: 0s;\n    transition-duration: 0s;\n  }\n}\n@keyframes fa-beat {\n  0%, 90% {\n    transform: scale(1);\n  }\n  45% {\n    transform: scale(var(--fa-beat-scale, 1.25));\n  }\n}\n@keyframes fa-bounce {\n  0% {\n    transform: scale(1, 1) translateY(0);\n  }\n  10% {\n    transform: scale(var(--fa-bounce-start-scale-x, 1.1), var(--fa-bounce-start-scale-y, 0.9)) translateY(0);\n  }\n  30% {\n    transform: scale(var(--fa-bounce-jump-scale-x, 0.9), var(--fa-bounce-jump-scale-y, 1.1)) translateY(var(--fa-bounce-height, -0.5em));\n  }\n  50% {\n    transform: scale(var(--fa-bounce-land-scale-x, 1.05), var(--fa-bounce-land-scale-y, 0.95)) translateY(0);\n  }\n  57% {\n    transform: scale(1, 1) translateY(var(--fa-bounce-rebound, -0.125em));\n  }\n  64% {\n    transform: scale(1, 1) translateY(0);\n  }\n  100% {\n    transform: scale(1, 1) translateY(0);\n  }\n}\n@keyframes fa-fade {\n  50% {\n    opacity: var(--fa-fade-opacity, 0.4);\n  }\n}\n@keyframes fa-beat-fade {\n  0%, 100% {\n    opacity: var(--fa-beat-fade-opacity, 0.4);\n    transform: scale(1);\n  }\n  50% {\n    opacity: 1;\n    transform: scale(var(--fa-beat-fade-scale, 1.125));\n  }\n}\n@keyframes fa-flip {\n  50% {\n    transform: rotate3d(var(--fa-flip-x, 0), var(--fa-flip-y, 1), var(--fa-flip-z, 0), var(--fa-flip-angle, -180deg));\n  }\n}\n@keyframes fa-shake {\n  0% {\n    transform: rotate(-15deg);\n  }\n  4% {\n    transform: rotate(15deg);\n  }\n  8%, 24% {\n    transform: rotate(-18deg);\n  }\n  12%, 28% {\n    transform: rotate(18deg);\n  }\n  16% {\n    transform: rotate(-22deg);\n  }\n  20% {\n    transform: rotate(22deg);\n  }\n  32% {\n    transform: rotate(-12deg);\n  }\n  36% {\n    transform: rotate(12deg);\n  }\n  40%, 100% {\n    transform: rotate(0deg);\n  }\n}\n@keyframes fa-spin {\n  0% {\n    transform: rotate(0deg);\n  }\n  100% {\n    transform: rotate(360deg);\n  }\n}\n.fa-rotate-90 {\n  transform: rotate(90deg);\n}\n\n.fa-rotate-180 {\n  transform: rotate(180deg);\n}\n\n.fa-rotate-270 {\n  transform: rotate(270deg);\n}\n\n.fa-flip-horizontal {\n  transform: scale(-1, 1);\n}\n\n.fa-flip-vertical {\n  transform: scale(1, -1);\n}\n\n.fa-flip-both,\n.fa-flip-horizontal.fa-flip-vertical {\n  transform: scale(-1, -1);\n}\n\n.fa-rotate-by {\n  transform: rotate(var(--fa-rotate-angle, 0));\n}\n\n.fa-stack {\n  display: inline-block;\n  vertical-align: middle;\n  height: 2em;\n  position: relative;\n  width: 2.5em;\n}\n\n.fa-stack-1x,\n.fa-stack-2x {\n  bottom: 0;\n  left: 0;\n  margin: auto;\n  position: absolute;\n  right: 0;\n  top: 0;\n  z-index: var(--fa-stack-z-index, auto);\n}\n\n.svg-inline--fa.fa-stack-1x {\n  height: 1em;\n  width: 1.25em;\n}\n.svg-inline--fa.fa-stack-2x {\n  height: 2em;\n  width: 2.5em;\n}\n\n.fa-inverse {\n  color: var(--fa-inverse, #fff);\n}\n\n.sr-only,\n.fa-sr-only {\n  position: absolute;\n  width: 1px;\n  height: 1px;\n  padding: 0;\n  margin: -1px;\n  overflow: hidden;\n  clip: rect(0, 0, 0, 0);\n  white-space: nowrap;\n  border-width: 0;\n}\n\n.sr-only-focusable:not(:focus),\n.fa-sr-only-focusable:not(:focus) {\n  position: absolute;\n  width: 1px;\n  height: 1px;\n  padding: 0;\n  margin: -1px;\n  overflow: hidden;\n  clip: rect(0, 0, 0, 0);\n  white-space: nowrap;\n  border-width: 0;\n}\n\n.svg-inline--fa .fa-primary {\n  fill: var(--fa-primary-color, currentColor);\n  opacity: var(--fa-primary-opacity, 1);\n}\n\n.svg-inline--fa .fa-secondary {\n  fill: var(--fa-secondary-color, currentColor);\n  opacity: var(--fa-secondary-opacity, 0.4);\n}\n\n.svg-inline--fa.fa-swap-opacity .fa-primary {\n  opacity: var(--fa-secondary-opacity, 0.4);\n}\n\n.svg-inline--fa.fa-swap-opacity .fa-secondary {\n  opacity: var(--fa-primary-opacity, 1);\n}\n\n.svg-inline--fa mask .fa-primary,\n.svg-inline--fa mask .fa-secondary {\n  fill: black;\n}\n\n.fad.fa-inverse,\n.fa-duotone.fa-inverse {\n  color: var(--fa-inverse, #fff);\n}';function De(){const e=q,t=G,r=ke.cssPrefix,n=ke.replacementClass;let i=Ne;if(r!==e||n!==t){const o=new RegExp("\\.".concat(e,"\\-"),"g"),a=new RegExp("\\--".concat(e,"\\-"),"g"),s=new RegExp("\\.".concat(t),"g");i=i.replace(o,".".concat(r,"-")).replace(a,"--".concat(r,"-")).replace(s,".".concat(n))}return i}let Fe=!1;function Le(){ke.autoAddCss&&!Fe&&(!function(e){if(!e||!_)return;const t=x.createElement("style");t.setAttribute("type","text/css"),t.innerHTML=e;const r=x.head.childNodes;let n=null;for(let i=r.length-1;i>-1;i--){const e=r[i],t=(e.tagName||"").toUpperCase();["STYLE","LINK"].indexOf(t)>-1&&(n=e)}x.head.insertBefore(t,n)}(De()),Fe=!0)}var He={mixout:()=>({dom:{css:De,insertCss:Le}}),hooks:()=>({beforeDOMElementCreation(){Le()},beforeI2svg(){Le()}})};const Be=k||{};Be[V]||(Be[V]={}),Be[V].styles||(Be[V].styles={}),Be[V].hooks||(Be[V].hooks={}),Be[V].shims||(Be[V].shims=[]);var Ue=Be[V];const je=[],We=function(){x.removeEventListener("DOMContentLoaded",We),Ve=1,je.map((e=>e()))};let Ve=!1;function ze(e){const{tag:t,attributes:r={},children:n=[]}=e;return"string"===typeof e?Me(e):"<".concat(t," ").concat(function(e){return Object.keys(e||{}).reduce(((t,r)=>t+"".concat(r,'="').concat(Me(e[r]),'" ')),"").trim()}(r),">").concat(n.map(ze).join(""),"</").concat(t,">")}function qe(e,t,r){if(e&&e[t]&&e[t][r])return{prefix:t,iconName:r,icon:e[t][r]}}_&&(Ve=(x.documentElement.doScroll?/^loaded|^c/:/^loaded|^i|^c/).test(x.readyState),Ve||x.addEventListener("DOMContentLoaded",We));var Ge=function(e,t,r,n){var i,o,a,s=Object.keys(e),l=s.length,c=void 0!==n?function(e,t){return function(r,n,i,o){return e.call(t,r,n,i,o)}}(t,n):t;for(void 0===r?(i=1,a=e[s[0]]):(i=0,a=r);i<l;i++)a=c(a,e[o=s[i]],o,e);return a};function $e(e){const t=function(e){const t=[];let r=0;const n=e.length;for(;r<n;){const i=e.charCodeAt(r++);if(i>=55296&&i<=56319&&r<n){const n=e.charCodeAt(r++);56320==(64512&n)?t.push(((1023&i)<<10)+(1023&n)+65536):(t.push(i),r--)}else t.push(i)}return t}(e);return 1===t.length?t[0].toString(16):null}function Ke(e){return Object.keys(e).reduce(((t,r)=>{const n=e[r];return!!n.icon?t[n.iconName]=n.icon:t[r]=n,t}),{})}function Ye(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{skipHooks:n=!1}=r,i=Ke(t);"function"!==typeof Ue.hooks.addPack||n?Ue.styles[e]={...Ue.styles[e]||{},...i}:Ue.hooks.addPack(e,Ke(t)),"fas"===e&&Ye("fa",t)}const{styles:Xe,shims:Je}=Ue,Ze={[R]:Object.values(ue[R]),[M]:Object.values(ue[M]),[I]:Object.values(ue[I])};let Qe=null,et={},tt={},rt={},nt={},it={};const ot={[R]:Object.keys(ae[R]),[M]:Object.keys(ae[M]),[I]:Object.keys(ae[I])};function at(e,t){const r=t.split("-"),n=r[0],i=r.slice(1).join("-");return n!==e||""===i||(o=i,~ye.indexOf(o))?null:i;var o}const st=()=>{const e=e=>Ge(Xe,((t,r,n)=>(t[n]=Ge(r,e,{}),t)),{});et=e(((e,t,r)=>{if(t[3]&&(e[t[3]]=r),t[2]){t[2].filter((e=>"number"===typeof e)).forEach((t=>{e[t.toString(16)]=r}))}return e})),tt=e(((e,t,r)=>{if(e[r]=r,t[2]){t[2].filter((e=>"string"===typeof e)).forEach((t=>{e[t]=r}))}return e})),it=e(((e,t,r)=>{const n=t[2];return e[r]=r,n.forEach((t=>{e[t]=r})),e}));const t="far"in Xe||ke.autoFetchSvg,r=Ge(Je,((e,r)=>{const n=r[0];let i=r[1];const o=r[2];return"far"!==i||t||(i="fas"),"string"===typeof n&&(e.names[n]={prefix:i,iconName:o}),"number"===typeof n&&(e.unicodes[n.toString(16)]={prefix:i,iconName:o}),e}),{names:{},unicodes:{}});rt=r.names,nt=r.unicodes,Qe=gt(ke.styleDefault,{family:ke.familyDefault})};var lt;function ct(e,t){return(et[e]||{})[t]}function ut(e,t){return(it[e]||{})[t]}function ht(e){return rt[e]||{prefix:null,iconName:null}}function dt(){return Qe}lt=e=>{Qe=gt(e.styleDefault,{family:ke.familyDefault})},xe.push(lt),st();const ft=()=>({prefix:null,iconName:null,rest:[]});function gt(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{family:r=R}=t,n=ae[r][e],i=le[r][e]||le[r][n],o=e in Ue.styles?e:null;return i||o||null}const pt={[R]:Object.keys(ue[R]),[M]:Object.keys(ue[M]),[I]:Object.keys(ue[I])};function mt(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{skipLookups:r=!1}=t,n={[R]:"".concat(ke.cssPrefix,"-").concat(R),[M]:"".concat(ke.cssPrefix,"-").concat(M),[I]:"".concat(ke.cssPrefix,"-").concat(I)};let i=null,o=R;const a=P.filter((e=>e!==O));a.forEach((t=>{(e.includes(n[t])||e.some((e=>pt[t].includes(e))))&&(o=t)}));const s=e.reduce(((e,t)=>{const s=at(ke.cssPrefix,t);if(Xe[t]?(t=Ze[o].includes(t)?de[o][t]:t,i=t,e.prefix=t):ot[o].indexOf(t)>-1?(i=t,e.prefix=gt(t,{family:o})):s?e.iconName=s:t===ke.replacementClass||a.some((e=>t===n[e]))||e.rest.push(t),!r&&e.prefix&&e.iconName){const t="fa"===i?ht(e.iconName):{},r=ut(e.prefix,e.iconName);t.prefix&&(i=null),e.iconName=t.iconName||r||e.iconName,e.prefix=t.prefix||e.prefix,"far"!==e.prefix||Xe.far||!Xe.fas||ke.autoFetchSvg||(e.prefix="fas")}return e}),ft());return(e.includes("fa-brands")||e.includes("fab"))&&(s.prefix="fab"),(e.includes("fa-duotone")||e.includes("fad"))&&(s.prefix="fad"),s.prefix||o!==M||!Xe.fass&&!ke.autoFetchSvg||(s.prefix="fass",s.iconName=ut(s.prefix,s.iconName)||s.iconName),s.prefix||o!==I||!Xe.fasds&&!ke.autoFetchSvg||(s.prefix="fasds",s.iconName=ut(s.prefix,s.iconName)||s.iconName),"fa"!==s.prefix&&"fa"!==i||(s.prefix=dt()||"fas"),s}let vt=[],bt={};const yt={},wt=Object.keys(yt);function St(e,t){for(var r=arguments.length,n=new Array(r>2?r-2:0),i=2;i<r;i++)n[i-2]=arguments[i];return(bt[e]||[]).forEach((e=>{t=e.apply(null,[t,...n])})),t}function Ct(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];(bt[e]||[]).forEach((e=>{e.apply(null,r)}))}function kt(){const e=arguments[0],t=Array.prototype.slice.call(arguments,1);return yt[e]?yt[e].apply(null,t):void 0}function xt(e){"fa"===e.prefix&&(e.prefix="fas");let{iconName:t}=e;const r=e.prefix||dt();if(t)return t=ut(r,t)||t,qe(Et.definitions,r,t)||qe(Ue.styles,r,t)}const Et=new class{constructor(){this.definitions={}}add(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];const n=t.reduce(this._pullDefinitions,{});Object.keys(n).forEach((e=>{this.definitions[e]={...this.definitions[e]||{},...n[e]},Ye(e,n[e]);const t=ue[R][e];t&&Ye(t,n[e]),st()}))}reset(){this.definitions={}}_pullDefinitions(e,t){const r=t.prefix&&t.iconName&&t.icon?{0:t}:t;return Object.keys(r).map((t=>{const{prefix:n,iconName:i,icon:o}=r[t],a=o[2];e[n]||(e[n]={}),a.length>0&&a.forEach((t=>{"string"===typeof t&&(e[n][t]=o)})),e[n][i]=o})),e}},Tt={i2svg:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return _?(Ct("beforeI2svg",e),kt("pseudoElements2svg",e),kt("i2svg",e)):Promise.reject(new Error("Operation requires a DOM of some kind."))},watch:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{autoReplaceSvgRoot:t}=e;var r;!1===ke.autoReplaceSvg&&(ke.autoReplaceSvg=!0),ke.observeMutations=!0,r=()=>{Rt({autoReplaceSvgRoot:t}),Ct("watch",e)},_&&(Ve?setTimeout(r,0):je.push(r))}},_t={icon:e=>{if(null===e)return null;if("object"===typeof e&&e.prefix&&e.iconName)return{prefix:e.prefix,iconName:ut(e.prefix,e.iconName)||e.iconName};if(Array.isArray(e)&&2===e.length){const t=0===e[1].indexOf("fa-")?e[1].slice(3):e[1],r=gt(e[0]);return{prefix:r,iconName:ut(r,t)||t}}if("string"===typeof e&&(e.indexOf("".concat(ke.cssPrefix,"-"))>-1||e.match(fe))){const t=mt(e.split(" "),{skipLookups:!0});return{prefix:t.prefix||dt(),iconName:ut(t.prefix,t.iconName)||t.iconName}}if("string"===typeof e){const t=dt();return{prefix:t,iconName:ut(t,e)||e}}}},At={noAuto:()=>{ke.autoReplaceSvg=!1,ke.observeMutations=!1,Ct("noAuto")},config:ke,dom:Tt,parse:_t,library:Et,findIconDefinition:xt,toHtml:ze},Rt=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{autoReplaceSvgRoot:t=x}=e;(Object.keys(Ue.styles).length>0||ke.autoFetchSvg)&&_&&ke.autoReplaceSvg&&At.dom.i2svg({node:t})};function Ot(e,t){return Object.defineProperty(e,"abstract",{get:t}),Object.defineProperty(e,"html",{get:function(){return e.abstract.map((e=>ze(e)))}}),Object.defineProperty(e,"node",{get:function(){if(!_)return;const t=x.createElement("div");return t.innerHTML=e.html,t.children}}),e}function Mt(e){const{icons:{main:t,mask:r},prefix:n,iconName:i,transform:o,symbol:a,title:s,maskId:l,titleId:c,extra:u,watchable:h=!1}=e,{width:d,height:f}=r.found?r:t,g="fak"===n,p=[ke.replacementClass,i?"".concat(ke.cssPrefix,"-").concat(i):""].filter((e=>-1===u.classes.indexOf(e))).filter((e=>""!==e||!!e)).concat(u.classes).join(" ");let m={children:[],attributes:{...u.attributes,"data-prefix":n,"data-icon":i,class:p,role:u.attributes.role||"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 ".concat(d," ").concat(f)}};const v=g&&!~u.classes.indexOf("fa-fw")?{width:"".concat(d/f*16*.0625,"em")}:{};h&&(m.attributes[K]=""),s&&(m.children.push({tag:"title",attributes:{id:m.attributes["aria-labelledby"]||"title-".concat(c||Ae())},children:[s]}),delete m.attributes.title);const b={...m,prefix:n,iconName:i,main:t,mask:r,maskId:l,transform:o,symbol:a,styles:{...v,...u.styles}},{children:y,attributes:w}=r.found&&t.found?kt("generateAbstractMask",b)||{children:[],attributes:{}}:kt("generateAbstractIcon",b)||{children:[],attributes:{}};return b.children=y,b.attributes=w,a?function(e){let{prefix:t,iconName:r,children:n,attributes:i,symbol:o}=e;return[{tag:"svg",attributes:{style:"display: none;"},children:[{tag:"symbol",attributes:{...i,id:!0===o?"".concat(t,"-").concat(ke.cssPrefix,"-").concat(r):o},children:n}]}]}(b):function(e){let{children:t,main:r,mask:n,attributes:i,styles:o,transform:a}=e;if(Pe(a)&&r.found&&!n.found){const{width:e,height:t}=r,n={x:e/t/2,y:.5};i.style=Ie({...o,"transform-origin":"".concat(n.x+a.x/16,"em ").concat(n.y+a.y/16,"em")})}return[{tag:"svg",attributes:i,children:t}]}(b)}function It(e){const{content:t,width:r,height:n,transform:i,title:o,extra:a,watchable:s=!1}=e,l={...a.attributes,...o?{title:o}:{},class:a.classes.join(" ")};s&&(l[K]="");const c={...a.styles};Pe(i)&&(c.transform=function(e){let{transform:t,width:r=z,height:n=z,startCentered:i=!1}=e,o="";return o+=i&&A?"translate(".concat(t.x/Ee-r/2,"em, ").concat(t.y/Ee-n/2,"em) "):i?"translate(calc(-50% + ".concat(t.x/Ee,"em), calc(-50% + ").concat(t.y/Ee,"em)) "):"translate(".concat(t.x/Ee,"em, ").concat(t.y/Ee,"em) "),o+="scale(".concat(t.size/Ee*(t.flipX?-1:1),", ").concat(t.size/Ee*(t.flipY?-1:1),") "),o+="rotate(".concat(t.rotate,"deg) "),o}({transform:i,startCentered:!0,width:r,height:n}),c["-webkit-transform"]=c.transform);const u=Ie(c);u.length>0&&(l.style=u);const h=[];return h.push({tag:"span",attributes:l,children:[t]}),o&&h.push({tag:"span",attributes:{class:"sr-only"},children:[o]}),h}const{styles:Pt}=Ue;function Nt(e){const t=e[0],r=e[1],[n]=e.slice(4);let i=null;return i=Array.isArray(n)?{tag:"g",attributes:{class:"".concat(ke.cssPrefix,"-").concat(ve.GROUP)},children:[{tag:"path",attributes:{class:"".concat(ke.cssPrefix,"-").concat(ve.SECONDARY),fill:"currentColor",d:n[0]}},{tag:"path",attributes:{class:"".concat(ke.cssPrefix,"-").concat(ve.PRIMARY),fill:"currentColor",d:n[1]}}]}:{tag:"path",attributes:{fill:"currentColor",d:n}},{found:!0,width:t,height:r,icon:i}}const Dt={found:!1,width:512,height:512};function Ft(e,t){let r=t;return"fa"===t&&null!==ke.styleDefault&&(t=dt()),new Promise(((n,i)=>{if("fa"===r){const r=ht(e)||{};e=r.iconName||e,t=r.prefix||t}if(e&&t&&Pt[t]&&Pt[t][e]){return n(Nt(Pt[t][e]))}!function(e,t){re||ke.showMissingIcons||!e||console.error('Icon with name "'.concat(e,'" and prefix "').concat(t,'" is missing.'))}(e,t),n({...Dt,icon:ke.showMissingIcons&&e&&kt("missingIconAbstract")||{}})}))}const Lt=()=>{},Ht=ke.measurePerformance&&T&&T.mark&&T.measure?T:{mark:Lt,measure:Lt},Bt='FA "6.6.0"',Ut=e=>{Ht.mark("".concat(Bt," ").concat(e," ends")),Ht.measure("".concat(Bt," ").concat(e),"".concat(Bt," ").concat(e," begins"),"".concat(Bt," ").concat(e," ends"))};var jt={begin:e=>(Ht.mark("".concat(Bt," ").concat(e," begins")),()=>Ut(e)),end:Ut};const Wt=()=>{};function Vt(e){return"string"===typeof(e.getAttribute?e.getAttribute(K):null)}function zt(e){return x.createElementNS("http://www.w3.org/2000/svg",e)}function qt(e){return x.createElement(e)}function Gt(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{ceFn:r=("svg"===e.tag?zt:qt)}=t;if("string"===typeof e)return x.createTextNode(e);const n=r(e.tag);Object.keys(e.attributes||[]).forEach((function(t){n.setAttribute(t,e.attributes[t])}));return(e.children||[]).forEach((function(e){n.appendChild(Gt(e,{ceFn:r}))})),n}const $t={replace:function(e){const t=e[0];if(t.parentNode)if(e[1].forEach((e=>{t.parentNode.insertBefore(Gt(e),t)})),null===t.getAttribute(K)&&ke.keepOriginalSource){let e=x.createComment(function(e){let t=" ".concat(e.outerHTML," ");return t="".concat(t,"Font Awesome fontawesome.com "),t}(t));t.parentNode.replaceChild(e,t)}else t.remove()},nest:function(e){const t=e[0],r=e[1];if(~Oe(t).indexOf(ke.replacementClass))return $t.replace(e);const n=new RegExp("".concat(ke.cssPrefix,"-.*"));if(delete r[0].attributes.id,r[0].attributes.class){const e=r[0].attributes.class.split(" ").reduce(((e,t)=>(t===ke.replacementClass||t.match(n)?e.toSvg.push(t):e.toNode.push(t),e)),{toNode:[],toSvg:[]});r[0].attributes.class=e.toSvg.join(" "),0===e.toNode.length?t.removeAttribute("class"):t.setAttribute("class",e.toNode.join(" "))}const i=r.map((e=>ze(e))).join("\n");t.setAttribute(K,""),t.innerHTML=i}};function Kt(e){e()}function Yt(e,t){const r="function"===typeof t?t:Wt;if(0===e.length)r();else{let t=Kt;ke.mutateApproach===ee&&(t=k.requestAnimationFrame||Kt),t((()=>{const t=!0===ke.autoReplaceSvg?$t.replace:$t[ke.autoReplaceSvg]||$t.replace,n=jt.begin("mutate");e.map(t),n(),r()}))}}let Xt=!1;function Jt(){Xt=!0}function Zt(){Xt=!1}let Qt=null;function er(e){if(!E)return;if(!ke.observeMutations)return;const{treeCallback:t=Wt,nodeCallback:r=Wt,pseudoElementsCallback:n=Wt,observeMutationsRoot:i=x}=e;Qt=new E((e=>{if(Xt)return;const i=dt();Re(e).forEach((e=>{if("childList"===e.type&&e.addedNodes.length>0&&!Vt(e.addedNodes[0])&&(ke.searchPseudoElements&&n(e.target),t(e.target)),"attributes"===e.type&&e.target.parentNode&&ke.searchPseudoElements&&n(e.target.parentNode),"attributes"===e.type&&Vt(e.target)&&~me.indexOf(e.attributeName))if("class"===e.attributeName&&function(e){const t=e.getAttribute?e.getAttribute(J):null,r=e.getAttribute?e.getAttribute(Z):null;return t&&r}(e.target)){const{prefix:t,iconName:r}=mt(Oe(e.target));e.target.setAttribute(J,t||i),r&&e.target.setAttribute(Z,r)}else(o=e.target)&&o.classList&&o.classList.contains&&o.classList.contains(ke.replacementClass)&&r(e.target);var o}))})),_&&Qt.observe(i,{childList:!0,attributes:!0,characterData:!0,subtree:!0})}function tr(e){const t=e.getAttribute("data-prefix"),r=e.getAttribute("data-icon"),n=void 0!==e.innerText?e.innerText.trim():"";let i=mt(Oe(e));return i.prefix||(i.prefix=dt()),t&&r&&(i.prefix=t,i.iconName=r),i.iconName&&i.prefix||(i.prefix&&n.length>0&&(i.iconName=function(e,t){return(tt[e]||{})[t]}(i.prefix,e.innerText)||ct(i.prefix,$e(e.innerText))),!i.iconName&&ke.autoFetchSvg&&e.firstChild&&e.firstChild.nodeType===Node.TEXT_NODE&&(i.iconName=e.firstChild.data)),i}function rr(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{styleParser:!0};const{iconName:r,prefix:n,rest:i}=tr(e),o=function(e){const t=Re(e.attributes).reduce(((e,t)=>("class"!==e.name&&"style"!==e.name&&(e[t.name]=t.value),e)),{}),r=e.getAttribute("title"),n=e.getAttribute("data-fa-title-id");return ke.autoA11y&&(r?t["aria-labelledby"]="".concat(ke.replacementClass,"-title-").concat(n||Ae()):(t["aria-hidden"]="true",t.focusable="false")),t}(e),a=St("parseNodeAttributes",{},e);let s=t.styleParser?function(e){const t=e.getAttribute("style");let r=[];return t&&(r=t.split(";").reduce(((e,t)=>{const r=t.split(":"),n=r[0],i=r.slice(1);return n&&i.length>0&&(e[n]=i.join(":").trim()),e}),{})),r}(e):[];return{iconName:r,title:e.getAttribute("title"),titleId:e.getAttribute("data-fa-title-id"),prefix:n,transform:Te,mask:{iconName:null,prefix:null,rest:[]},maskId:null,symbol:!1,extra:{classes:i,styles:s,attributes:o},...a}}const{styles:nr}=Ue;function ir(e){const t="nest"===ke.autoReplaceSvg?rr(e,{styleParser:!1}):rr(e);return~t.extra.classes.indexOf(ge)?kt("generateLayersText",e,t):kt("generateSvgReplacementMutation",e,t)}let or=new Set;function ar(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!_)return Promise.resolve();const r=x.documentElement.classList,n=e=>r.add("".concat(Q,"-").concat(e)),i=e=>r.remove("".concat(Q,"-").concat(e)),o=ke.autoFetchSvg?or:ne.map((e=>"fa-".concat(e))).concat(Object.keys(nr));o.includes("fa")||o.push("fa");const a=[".".concat(ge,":not([").concat(K,"])")].concat(o.map((e=>".".concat(e,":not([").concat(K,"])")))).join(", ");if(0===a.length)return Promise.resolve();let s=[];try{s=Re(e.querySelectorAll(a))}catch(u){}if(!(s.length>0))return Promise.resolve();n("pending"),i("complete");const l=jt.begin("onTree"),c=s.reduce(((e,t)=>{try{const r=ir(t);r&&e.push(r)}catch(u){re||"MissingIcon"===u.name&&console.error(u)}return e}),[]);return new Promise(((e,r)=>{Promise.all(c).then((r=>{Yt(r,(()=>{n("active"),n("complete"),i("pending"),"function"===typeof t&&t(),l(),e()}))})).catch((e=>{l(),r(e)}))}))}function sr(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;ir(e).then((e=>{e&&Yt([e],t)}))}ne.map((e=>{or.add("fa-".concat(e))})),Object.keys(ae[R]).map(or.add.bind(or)),Object.keys(ae[M]).map(or.add.bind(or)),Object.keys(ae[I]).map(or.add.bind(or)),or=[...or];const lr=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{transform:r=Te,symbol:n=!1,mask:i=null,maskId:o=null,title:a=null,titleId:s=null,classes:l=[],attributes:c={},styles:u={}}=t;if(!e)return;const{prefix:h,iconName:d,icon:f}=e;return Ot({type:"icon",...e},(()=>(Ct("beforeDOMElementCreation",{iconDefinition:e,params:t}),ke.autoA11y&&(a?c["aria-labelledby"]="".concat(ke.replacementClass,"-title-").concat(s||Ae()):(c["aria-hidden"]="true",c.focusable="false")),Mt({icons:{main:Nt(f),mask:i?Nt(i.icon):{found:!1,width:null,height:null,icon:{}}},prefix:h,iconName:d,transform:{...Te,...r},symbol:n,title:a,maskId:o,titleId:s,extra:{attributes:c,styles:u,classes:l}}))))};var cr={mixout(){return{icon:(e=lr,function(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=(t||{}).icon?t:xt(t||{});let{mask:i}=r;return i&&(i=(i||{}).icon?i:xt(i||{})),e(n,{...r,mask:i})})};var e},hooks:()=>({mutationObserverCallbacks:e=>(e.treeCallback=ar,e.nodeCallback=sr,e)}),provides(e){e.i2svg=function(e){const{node:t=x,callback:r=()=>{}}=e;return ar(t,r)},e.generateSvgReplacementMutation=function(e,t){const{iconName:r,title:n,titleId:i,prefix:o,transform:a,symbol:s,mask:l,maskId:c,extra:u}=t;return new Promise(((t,h)=>{Promise.all([Ft(r,o),l.iconName?Ft(l.iconName,l.prefix):Promise.resolve({found:!1,width:512,height:512,icon:{}})]).then((l=>{let[h,d]=l;t([e,Mt({icons:{main:h,mask:d},prefix:o,iconName:r,transform:a,symbol:s,maskId:c,title:n,titleId:i,extra:u,watchable:!0})])})).catch(h)}))},e.generateAbstractIcon=function(e){let{children:t,attributes:r,main:n,transform:i,styles:o}=e;const a=Ie(o);let s;return a.length>0&&(r.style=a),Pe(i)&&(s=kt("generateAbstractTransformGrouping",{main:n,transform:i,containerWidth:n.width,iconWidth:n.width})),t.push(s||n.icon),{children:t,attributes:r}}}},ur={mixout:()=>({layer(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{classes:r=[]}=t;return Ot({type:"layer"},(()=>{Ct("beforeDOMElementCreation",{assembler:e,params:t});let n=[];return e((e=>{Array.isArray(e)?e.map((e=>{n=n.concat(e.abstract)})):n=n.concat(e.abstract)})),[{tag:"span",attributes:{class:["".concat(ke.cssPrefix,"-layers"),...r].join(" ")},children:n}]}))}})},hr={mixout:()=>({counter(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{title:r=null,classes:n=[],attributes:i={},styles:o={}}=t;return Ot({type:"counter",content:e},(()=>(Ct("beforeDOMElementCreation",{content:e,params:t}),function(e){const{content:t,title:r,extra:n}=e,i={...n.attributes,...r?{title:r}:{},class:n.classes.join(" ")},o=Ie(n.styles);o.length>0&&(i.style=o);const a=[];return a.push({tag:"span",attributes:i,children:[t]}),r&&a.push({tag:"span",attributes:{class:"sr-only"},children:[r]}),a}({content:e.toString(),title:r,extra:{attributes:i,styles:o,classes:["".concat(ke.cssPrefix,"-layers-counter"),...n]}}))))}})},dr={mixout:()=>({text(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{transform:r=Te,title:n=null,classes:i=[],attributes:o={},styles:a={}}=t;return Ot({type:"text",content:e},(()=>(Ct("beforeDOMElementCreation",{content:e,params:t}),It({content:e,transform:{...Te,...r},title:n,extra:{attributes:o,styles:a,classes:["".concat(ke.cssPrefix,"-layers-text"),...i]}}))))}}),provides(e){e.generateLayersText=function(e,t){const{title:r,transform:n,extra:i}=t;let o=null,a=null;if(A){const t=parseInt(getComputedStyle(e).fontSize,10),r=e.getBoundingClientRect();o=r.width/t,a=r.height/t}return ke.autoA11y&&!r&&(i.attributes["aria-hidden"]="true"),Promise.resolve([e,It({content:e.innerHTML,width:o,height:a,transform:n,title:r,extra:i,watchable:!0})])}}};const fr=new RegExp('"',"ug"),gr=[1105920,1112319],pr={FontAwesome:{normal:"fas",400:"fas"},"Font Awesome 6 Free":{900:"fas",400:"far"},"Font Awesome 6 Pro":{900:"fas",400:"far",normal:"far",300:"fal",100:"fat"},"Font Awesome 6 Brands":{400:"fab",normal:"fab"},"Font Awesome 6 Duotone":{900:"fad"},"Font Awesome 6 Sharp":{900:"fass",400:"fasr",normal:"fasr",300:"fasl",100:"fast"},"Font Awesome 6 Sharp Duotone":{900:"fasds"},"Font Awesome 5 Free":{900:"fas",400:"far"},"Font Awesome 5 Pro":{900:"fas",400:"far",normal:"far",300:"fal"},"Font Awesome 5 Brands":{400:"fab",normal:"fab"},"Font Awesome 5 Duotone":{900:"fad"},"Font Awesome Kit":{400:"fak",normal:"fak"},"Font Awesome Kit Duotone":{400:"fakd",normal:"fakd"}},mr=Object.keys(pr).reduce(((e,t)=>(e[t.toLowerCase()]=pr[t],e)),{}),vr=Object.keys(mr).reduce(((e,t)=>{const r=mr[t];return e[t]=r[900]||[...Object.entries(r)][0][1],e}),{});function br(e,t){const r="".concat(X).concat(t.replace(":","-"));return new Promise(((n,i)=>{if(null!==e.getAttribute(r))return n();const o=Re(e.children).filter((e=>e.getAttribute(Y)===t))[0],a=k.getComputedStyle(e,t),s=a.getPropertyValue("font-family"),l=s.match(pe),c=a.getPropertyValue("font-weight"),u=a.getPropertyValue("content");if(o&&!l)return e.removeChild(o),n();if(l&&"none"!==u&&""!==u){const u=a.getPropertyValue("content");let h=function(e,t){const r=e.replace(/^['"]|['"]$/g,"").toLowerCase(),n=parseInt(t),i=isNaN(n)?"normal":n;return(mr[r]||{})[i]||vr[r]}(s,c);const{value:d,isSecondary:f}=function(e){const t=e.replace(fr,""),r=function(e,t){const r=e.length;let n,i=e.charCodeAt(t);return i>=55296&&i<=56319&&r>t+1&&(n=e.charCodeAt(t+1),n>=56320&&n<=57343)?1024*(i-55296)+n-56320+65536:i}(t,0),n=r>=gr[0]&&r<=gr[1],i=2===t.length&&t[0]===t[1];return{value:$e(i?t[0]:t),isSecondary:n||i}}(u),g=l[0].startsWith("FontAwesome");let p=ct(h,d),m=p;if(g){const e=function(e){const t=nt[e],r=ct("fas",e);return t||(r?{prefix:"fas",iconName:r}:null)||{prefix:null,iconName:null}}(d);e.iconName&&e.prefix&&(p=e.iconName,h=e.prefix)}if(!p||f||o&&o.getAttribute(J)===h&&o.getAttribute(Z)===m)n();else{e.setAttribute(r,m),o&&e.removeChild(o);const a={iconName:null,title:null,titleId:null,prefix:null,transform:Te,symbol:!1,mask:{iconName:null,prefix:null,rest:[]},maskId:null,extra:{classes:[],styles:{},attributes:{}}},{extra:s}=a;s.attributes[Y]=t,Ft(p,h).then((i=>{const o=Mt({...a,icons:{main:i,mask:ft()},prefix:h,iconName:m,extra:s,watchable:!0}),l=x.createElementNS("http://www.w3.org/2000/svg","svg");"::before"===t?e.insertBefore(l,e.firstChild):e.appendChild(l),l.outerHTML=o.map((e=>ze(e))).join("\n"),e.removeAttribute(r),n()})).catch(i)}}else n()}))}function yr(e){return Promise.all([br(e,"::before"),br(e,"::after")])}function wr(e){return e.parentNode!==document.head&&!~te.indexOf(e.tagName.toUpperCase())&&!e.getAttribute(Y)&&(!e.parentNode||"svg"!==e.parentNode.tagName)}function Sr(e){if(_)return new Promise(((t,r)=>{const n=Re(e.querySelectorAll("*")).filter(wr).map(yr),i=jt.begin("searchPseudoElements");Jt(),Promise.all(n).then((()=>{i(),Zt(),t()})).catch((()=>{i(),Zt(),r()}))}))}var Cr={hooks:()=>({mutationObserverCallbacks:e=>(e.pseudoElementsCallback=Sr,e)}),provides(e){e.pseudoElements2svg=function(e){const{node:t=x}=e;ke.searchPseudoElements&&Sr(t)}}};let kr=!1;var xr={mixout:()=>({dom:{unwatch(){Jt(),kr=!0}}}),hooks:()=>({bootstrap(){er(St("mutationObserverCallbacks",{}))},noAuto(){Qt&&Qt.disconnect()},watch(e){const{observeMutationsRoot:t}=e;kr?Zt():er(St("mutationObserverCallbacks",{observeMutationsRoot:t}))}})};const Er=e=>e.toLowerCase().split(" ").reduce(((e,t)=>{const r=t.toLowerCase().split("-"),n=r[0];let i=r.slice(1).join("-");if(n&&"h"===i)return e.flipX=!0,e;if(n&&"v"===i)return e.flipY=!0,e;if(i=parseFloat(i),isNaN(i))return e;switch(n){case"grow":e.size=e.size+i;break;case"shrink":e.size=e.size-i;break;case"left":e.x=e.x-i;break;case"right":e.x=e.x+i;break;case"up":e.y=e.y-i;break;case"down":e.y=e.y+i;break;case"rotate":e.rotate=e.rotate+i}return e}),{size:16,x:0,y:0,flipX:!1,flipY:!1,rotate:0});var Tr={mixout:()=>({parse:{transform:e=>Er(e)}}),hooks:()=>({parseNodeAttributes(e,t){const r=t.getAttribute("data-fa-transform");return r&&(e.transform=Er(r)),e}}),provides(e){e.generateAbstractTransformGrouping=function(e){let{main:t,transform:r,containerWidth:n,iconWidth:i}=e;const o={transform:"translate(".concat(n/2," 256)")},a="translate(".concat(32*r.x,", ").concat(32*r.y,") "),s="scale(".concat(r.size/16*(r.flipX?-1:1),", ").concat(r.size/16*(r.flipY?-1:1),") "),l="rotate(".concat(r.rotate," 0 0)"),c={transform:"".concat(a," ").concat(s," ").concat(l)},u={transform:"translate(".concat(i/2*-1," -256)")};return{tag:"g",attributes:{...o},children:[{tag:"g",attributes:{...c},children:[{tag:t.icon.tag,children:t.icon.children,attributes:{...t.icon.attributes,...u}}]}]}}}};const _r={x:0,y:0,width:"100%",height:"100%"};function Ar(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return e.attributes&&(e.attributes.fill||t)&&(e.attributes.fill="black"),e}var Rr={hooks:()=>({parseNodeAttributes(e,t){const r=t.getAttribute("data-fa-mask"),n=r?mt(r.split(" ").map((e=>e.trim()))):ft();return n.prefix||(n.prefix=dt()),e.mask=n,e.maskId=t.getAttribute("data-fa-mask-id"),e}}),provides(e){e.generateAbstractMask=function(e){let{children:t,attributes:r,main:n,mask:i,maskId:o,transform:a}=e;const{width:s,icon:l}=n,{width:c,icon:u}=i,h=function(e){let{transform:t,containerWidth:r,iconWidth:n}=e;const i={transform:"translate(".concat(r/2," 256)")},o="translate(".concat(32*t.x,", ").concat(32*t.y,") "),a="scale(".concat(t.size/16*(t.flipX?-1:1),", ").concat(t.size/16*(t.flipY?-1:1),") "),s="rotate(".concat(t.rotate," 0 0)");return{outer:i,inner:{transform:"".concat(o," ").concat(a," ").concat(s)},path:{transform:"translate(".concat(n/2*-1," -256)")}}}({transform:a,containerWidth:c,iconWidth:s}),d={tag:"rect",attributes:{..._r,fill:"white"}},f=l.children?{children:l.children.map(Ar)}:{},g={tag:"g",attributes:{...h.inner},children:[Ar({tag:l.tag,attributes:{...l.attributes,...h.path},...f})]},p={tag:"g",attributes:{...h.outer},children:[g]},m="mask-".concat(o||Ae()),v="clip-".concat(o||Ae()),b={tag:"mask",attributes:{..._r,id:m,maskUnits:"userSpaceOnUse",maskContentUnits:"userSpaceOnUse"},children:[d,p]},y={tag:"defs",children:[{tag:"clipPath",attributes:{id:v},children:(w=u,"g"===w.tag?w.children:[w])},b]};var w;return t.push(y,{tag:"rect",attributes:{fill:"currentColor","clip-path":"url(#".concat(v,")"),mask:"url(#".concat(m,")"),..._r}}),{children:t,attributes:r}}}},Or={provides(e){let t=!1;k.matchMedia&&(t=k.matchMedia("(prefers-reduced-motion: reduce)").matches),e.missingIconAbstract=function(){const e=[],r={fill:"currentColor"},n={attributeType:"XML",repeatCount:"indefinite",dur:"2s"};e.push({tag:"path",attributes:{...r,d:"M156.5,447.7l-12.6,29.5c-18.7-9.5-35.9-21.2-51.5-34.9l22.7-22.7C127.6,430.5,141.5,440,156.5,447.7z M40.6,272H8.5 c1.4,21.2,5.4,41.7,11.7,61.1L50,321.2C45.1,305.5,41.8,289,40.6,272z M40.6,240c1.4-18.8,5.2-37,11.1-54.1l-29.5-12.6 C14.7,194.3,10,216.7,8.5,240H40.6z M64.3,156.5c7.8-14.9,17.2-28.8,28.1-41.5L69.7,92.3c-13.7,15.6-25.5,32.8-34.9,51.5 L64.3,156.5z M397,419.6c-13.9,12-29.4,22.3-46.1,30.4l11.9,29.8c20.7-9.9,39.8-22.6,56.9-37.6L397,419.6z M115,92.4 c13.9-12,29.4-22.3,46.1-30.4l-11.9-29.8c-20.7,9.9-39.8,22.6-56.8,37.6L115,92.4z M447.7,355.5c-7.8,14.9-17.2,28.8-28.1,41.5 l22.7,22.7c13.7-15.6,25.5-32.9,34.9-51.5L447.7,355.5z M471.4,272c-1.4,18.8-5.2,37-11.1,54.1l29.5,12.6 c7.5-21.1,12.2-43.5,13.6-66.8H471.4z M321.2,462c-15.7,5-32.2,8.2-49.2,9.4v32.1c21.2-1.4,41.7-5.4,61.1-11.7L321.2,462z M240,471.4c-18.8-1.4-37-5.2-54.1-11.1l-12.6,29.5c21.1,7.5,43.5,12.2,66.8,13.6V471.4z M462,190.8c5,15.7,8.2,32.2,9.4,49.2h32.1 c-1.4-21.2-5.4-41.7-11.7-61.1L462,190.8z M92.4,397c-12-13.9-22.3-29.4-30.4-46.1l-29.8,11.9c9.9,20.7,22.6,39.8,37.6,56.9 L92.4,397z M272,40.6c18.8,1.4,36.9,5.2,54.1,11.1l12.6-29.5C317.7,14.7,295.3,10,272,8.5V40.6z M190.8,50 c15.7-5,32.2-8.2,49.2-9.4V8.5c-21.2,1.4-41.7,5.4-61.1,11.7L190.8,50z M442.3,92.3L419.6,115c12,13.9,22.3,29.4,30.5,46.1 l29.8-11.9C470,128.5,457.3,109.4,442.3,92.3z M397,92.4l22.7-22.7c-15.6-13.7-32.8-25.5-51.5-34.9l-12.6,29.5 C370.4,72.1,384.4,81.5,397,92.4z"}});const i={...n,attributeName:"opacity"},o={tag:"circle",attributes:{...r,cx:"256",cy:"364",r:"28"},children:[]};return t||o.children.push({tag:"animate",attributes:{...n,attributeName:"r",values:"28;14;28;28;14;28;"}},{tag:"animate",attributes:{...i,values:"1;0;1;1;0;1;"}}),e.push(o),e.push({tag:"path",attributes:{...r,opacity:"1",d:"M263.7,312h-16c-6.6,0-12-5.4-12-12c0-71,77.4-63.9,77.4-107.8c0-20-17.8-40.2-57.4-40.2c-29.1,0-44.3,9.6-59.2,28.7 c-3.9,5-11.1,6-16.2,2.4l-13.1-9.2c-5.6-3.9-6.9-11.8-2.6-17.2c21.2-27.2,46.4-44.7,91.2-44.7c52.3,0,97.4,29.8,97.4,80.2 c0,67.6-77.4,63.5-77.4,107.8C275.7,306.6,270.3,312,263.7,312z"},children:t?[]:[{tag:"animate",attributes:{...i,values:"1;0;0;0;0;1;"}}]}),t||e.push({tag:"path",attributes:{...r,opacity:"0",d:"M232.5,134.5l7,168c0.3,6.4,5.6,11.5,12,11.5h9c6.4,0,11.7-5.1,12-11.5l7-168c0.3-6.8-5.2-12.5-12-12.5h-23 C237.7,122,232.2,127.7,232.5,134.5z"},children:[{tag:"animate",attributes:{...i,values:"0;0;1;1;0;0;"}}]}),{tag:"g",attributes:{class:"missing"},children:e}}}};!function(e,t){let{mixoutsTo:r}=t;vt=e,bt={},Object.keys(yt).forEach((e=>{-1===wt.indexOf(e)&&delete yt[e]})),vt.forEach((e=>{const t=e.mixout?e.mixout():{};if(Object.keys(t).forEach((e=>{"function"===typeof t[e]&&(r[e]=t[e]),"object"===typeof t[e]&&Object.keys(t[e]).forEach((n=>{r[e]||(r[e]={}),r[e][n]=t[e][n]}))})),e.hooks){const t=e.hooks();Object.keys(t).forEach((e=>{bt[e]||(bt[e]=[]),bt[e].push(t[e])}))}e.provides&&e.provides(yt)}))}([He,cr,ur,hr,dr,Cr,xr,Tr,Rr,Or,{hooks:()=>({parseNodeAttributes(e,t){const r=t.getAttribute("data-fa-symbol"),n=null!==r&&(""===r||r);return e.symbol=n,e}})}],{mixoutsTo:At});const Mr=At.parse,Ir=At.icon;var Pr=__webpack_require__(5173),Nr=__webpack_require__.n(Pr);function Dr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Fr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Dr(Object(r),!0).forEach((function(t){Hr(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Dr(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Lr(e){return Lr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Lr(e)}function Hr(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Br(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function Ur(e){return function(e){if(Array.isArray(e))return jr(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"===typeof e)return jr(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return jr(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function jr(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Wr(e){return t=e,(t-=0)===t?e:(e=e.replace(/[\-_\s]+(.)?/g,(function(e,t){return t?t.toUpperCase():""}))).substr(0,1).toLowerCase()+e.substr(1);var t}var Vr=["style"];var zr=!1;try{zr=!0}catch(oJ){}function qr(e){return e&&"object"===Lr(e)&&e.prefix&&e.iconName&&e.icon?e:Mr.icon?Mr.icon(e):null===e?null:e&&"object"===Lr(e)&&e.prefix&&e.iconName?e:Array.isArray(e)&&2===e.length?{prefix:e[0],iconName:e[1]}:"string"===typeof e?{prefix:"fas",iconName:e}:void 0}function Gr(e,t){return Array.isArray(t)&&t.length>0||!Array.isArray(t)&&t?Hr({},e,t):{}}var $r={border:!1,className:"",mask:null,maskId:null,fixedWidth:!1,inverse:!1,flip:!1,icon:null,listItem:!1,pull:null,pulse:!1,rotation:null,size:null,spin:!1,spinPulse:!1,spinReverse:!1,beat:!1,fade:!1,beatFade:!1,bounce:!1,shake:!1,symbol:!1,title:"",titleId:null,transform:null,swapOpacity:!1},Kr=t.forwardRef((function(e,t){var r=Fr(Fr({},$r),e),n=r.icon,i=r.mask,o=r.symbol,a=r.className,s=r.title,l=r.titleId,c=r.maskId,u=qr(n),h=Gr("classes",[].concat(Ur(function(e){var t,r=e.beat,n=e.fade,i=e.beatFade,o=e.bounce,a=e.shake,s=e.flash,l=e.spin,c=e.spinPulse,u=e.spinReverse,h=e.pulse,d=e.fixedWidth,f=e.inverse,g=e.border,p=e.listItem,m=e.flip,v=e.size,b=e.rotation,y=e.pull,w=(Hr(t={"fa-beat":r,"fa-fade":n,"fa-beat-fade":i,"fa-bounce":o,"fa-shake":a,"fa-flash":s,"fa-spin":l,"fa-spin-reverse":u,"fa-spin-pulse":c,"fa-pulse":h,"fa-fw":d,"fa-inverse":f,"fa-border":g,"fa-li":p,"fa-flip":!0===m,"fa-flip-horizontal":"horizontal"===m||"both"===m,"fa-flip-vertical":"vertical"===m||"both"===m},"fa-".concat(v),"undefined"!==typeof v&&null!==v),Hr(t,"fa-rotate-".concat(b),"undefined"!==typeof b&&null!==b&&0!==b),Hr(t,"fa-pull-".concat(y),"undefined"!==typeof y&&null!==y),Hr(t,"fa-swap-opacity",e.swapOpacity),t);return Object.keys(w).map((function(e){return w[e]?e:null})).filter((function(e){return e}))}(r)),Ur((a||"").split(" ")))),d=Gr("transform","string"===typeof r.transform?Mr.transform(r.transform):r.transform),f=Gr("mask",qr(i)),g=Ir(u,Fr(Fr(Fr(Fr({},h),d),f),{},{symbol:o,title:s,titleId:l,maskId:c}));if(!g)return function(){var e;!zr&&console&&"function"===typeof console.error&&(e=console).error.apply(e,arguments)}("Could not find icon",u),null;var p=g.abstract,m={ref:t};return Object.keys(r).forEach((function(e){$r.hasOwnProperty(e)||(m[e]=r[e])})),Yr(p[0],m)}));Kr.displayName="FontAwesomeIcon",Kr.propTypes={beat:Nr().bool,border:Nr().bool,beatFade:Nr().bool,bounce:Nr().bool,className:Nr().string,fade:Nr().bool,flash:Nr().bool,mask:Nr().oneOfType([Nr().object,Nr().array,Nr().string]),maskId:Nr().string,fixedWidth:Nr().bool,inverse:Nr().bool,flip:Nr().oneOf([!0,!1,"horizontal","vertical","both"]),icon:Nr().oneOfType([Nr().object,Nr().array,Nr().string]),listItem:Nr().bool,pull:Nr().oneOf(["right","left"]),pulse:Nr().bool,rotation:Nr().oneOf([0,90,180,270]),shake:Nr().bool,size:Nr().oneOf(["2xs","xs","sm","lg","xl","2xl","1x","2x","3x","4x","5x","6x","7x","8x","9x","10x"]),spin:Nr().bool,spinPulse:Nr().bool,spinReverse:Nr().bool,symbol:Nr().oneOfType([Nr().bool,Nr().string]),title:Nr().string,titleId:Nr().string,transform:Nr().oneOfType([Nr().string,Nr().object]),swapOpacity:Nr().bool};var Yr=function e(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if("string"===typeof r)return r;var i=(r.children||[]).map((function(r){return e(t,r)})),o=Object.keys(r.attributes||{}).reduce((function(e,t){var n=r.attributes[t];switch(t){case"class":e.attrs.className=n,delete r.attributes.class;break;case"style":e.attrs.style=n.split(";").map((function(e){return e.trim()})).filter((function(e){return e})).reduce((function(e,t){var r,n=t.indexOf(":"),i=Wr(t.slice(0,n)),o=t.slice(n+1).trim();return i.startsWith("webkit")?e[(r=i,r.charAt(0).toUpperCase()+r.slice(1))]=o:e[i]=o,e}),{});break;default:0===t.indexOf("aria-")||0===t.indexOf("data-")?e.attrs[t.toLowerCase()]=n:e.attrs[Wr(t)]=n}return e}),{attrs:{}}),a=n.style,s=void 0===a?{}:a,l=Br(n,Vr);return o.attrs.style=Fr(Fr({},o.attrs.style),s),t.apply(void 0,[r.tag,Fr(Fr({},o.attrs),l)].concat(Ur(i)))}.bind(null,t.createElement);const Xr={prefix:"fas",iconName:"angle-down",icon:[448,512,[8964],"f107","M201.4 374.6c12.5 12.5 32.8 12.5 45.3 0l160-160c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L224 306.7 86.6 169.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l160 160z"]},Jr={prefix:"fas",iconName:"plus",icon:[448,512,[10133,61543,"add"],"2b","M256 80c0-17.7-14.3-32-32-32s-32 14.3-32 32l0 144L48 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l144 0 0 144c0 17.7 14.3 32 32 32s32-14.3 32-32l0-144 144 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-144 0 0-144z"]};const Zr=__webpack_require__(8394),Qr=__webpack_require__(1542);function en(e){return Promise.resolve(async function(e){const t=await e.arrayBuffer().then((e=>{const t=new Uint8Array(e);return Zr.getDocument({data:t}).promise})),r=await t.getXFA(),n=await t.getMetadata().then((function(e){return e.info.Custom["Short Title - Prefix"]+""+e.info.Custom["Short Title - Number"]})),i=function(e,t){const r=e.replace(/&#xD;/g,"\n"),n=(new DOMParser).parseFromString(r,"text/xml");let i="";for(let o of c.all[t].fields){i+=n.querySelector(o).innerHTML+"\n"}return i}(r.datasets,n),o=function(e,t){const r=(new DOMParser).parseFromString(e,"text/xml");let n=[],i=[],o=[],a=0;for(let s of c.all[t].fields){const e=r.querySelector("field[name='"+s+"'");n[a]=e.querySelector("font").getAttribute("typeface"),i[a]=e.querySelector("font").getAttribute("size"),o[a]=e.getAttribute("w"),a+=1}for(let s of n)if(s!==n[0]){console.log("warning: not all grabbed sections have the same font type");break}for(let s of i)if(s!==i[0]){console.log("warning: not all grabbed sections have the same font size");break}for(let s of o)if(s!==o[0]){console.log("warning: not all grabbed sections have the same width");break}return{font:n[0],fontSize:i[0],width:o[0]}}(r.template,n);return{bulletText:i,pageInfo:o}}(e)).then((e=>{let{bulletText:t,pageInfo:r}=e;const n=(new DOMParser).parseFromString(t,"text/html").documentElement.textContent;return{width:parseFloat(r.width),bullets:n}}))}function tn(e){let{onTextUpdate:r,onWidthUpdate:n,onJSONImport:i}=e;const o=(0,t.useRef)(),[a,s]=(0,t.useState)(""),[l,c]=(0,t.useState)(!1),u=l?"is-active":"";return(0,d.jsxs)("div",{className:"dropdown "+u,children:[(0,d.jsx)("input",{type:"file",onChange:e=>{if(o.current.value){const e=o.current.files[0];"pdf"===a?en(e).then((e=>{let{width:t,bullets:i}=e;n(t),r(i)})):"json"===a&&function(e){return new Promise(((t,r)=>{const n=new FileReader;n.onload=e=>{const r=JSON.parse(e.target.result);t(r)},n.onerror=r,n.readAsText(e)}))}(e).then((e=>i(e))),o.current.value=""}else console.log("no file picked")},style:{display:"none"},ref:o}),(0,d.jsx)("div",{className:"dropdown-trigger",children:(0,d.jsxs)("div",{className:"buttons has-addons",children:[(0,d.jsx)("button",{className:"button",onClick:()=>{s("pdf"),o.current.click()},children:"Import"}),(0,d.jsx)("button",{className:"button",onClick:()=>c(!l),"aria-haspopup":"true","aria-controls":"import-menu",children:(0,d.jsx)("span",{className:"icon",children:(0,d.jsx)(Kr,{icon:Xr})})})]})}),(0,d.jsx)("div",{className:"dropdown-menu",id:"import-menu",role:"menu",onMouseLeave:()=>c(!1),children:(0,d.jsxs)("div",{className:"dropdown-content",children:[(0,d.jsx)("a",{href:"?#",className:"dropdown-item",onClick:()=>{s("pdf"),o.current.click()},children:"PDF"}),(0,d.jsx)("a",{href:"?#",className:"dropdown-item",onClick:()=>{s("json"),o.current.click()},children:"JSON"})]})})]})}function rn(e){let{getSavedSettings:r}=e;const[n,i]=(0,t.useState)(!1),o=(0,t.useRef)(),a=n?"is-active":"",s=()=>{const e=r(),t=JSON.stringify([e]);try{localStorage.setItem("bullet-settings",t),console.log("saved settings/data to local storage with character length "+t.length)}catch(n){if("SecurityError"!==n.name)throw n;alert("Sorry, saving to cookies does not work using the file:// interface and/or your browser's privacy settings")}};return(0,d.jsxs)("div",{className:"dropdown "+a,children:[(0,d.jsx)("div",{className:"dropdown-trigger",children:(0,d.jsxs)("div",{className:"buttons has-addons",children:[(0,d.jsxs)("button",{className:"button",onClick:s,children:["Save"," "]}),(0,d.jsx)("button",{className:"button","aria-haspopup":"true","aria-controls":"save-menu",children:(0,d.jsx)("span",{className:"icon",onClick:()=>i(!n),children:(0,d.jsx)(Kr,{icon:Xr})})})]})}),(0,d.jsx)("div",{className:"dropdown-menu",id:"save-menu",role:"menu",onMouseLeave:()=>i(!1),children:(0,d.jsxs)("div",{className:"dropdown-content",children:[(0,d.jsx)("a",{href:"?#",className:"dropdown-item",onClick:s,children:"Cookie"}),(0,d.jsx)("a",{href:"?#",className:"dropdown-item",onClick:()=>{const e=r(),t=JSON.stringify([e]),n="data:application/JSON;charset=utf-8,"+encodeURIComponent(t);o.current.href=n,o.current.click(),console.log("exported settings/data to JSON file with character length "+t.length)},children:"JSON"})]})}),(0,d.jsx)("a",{href:"?#",style:{display:"none"},download:"settings.json",ref:o})]})}function nn(e){let{onOptimChange:t,enableOptim:r,onWidthUpdate:n,width:i,onHighlightChange:o,handleEnableHighlight:a,enableHighlight:s}=e;const l=202.321,c=202.321,u=201.041;return(0,d.jsxs)("div",{className:"field is-grouped",children:[(0,d.jsxs)("div",{className:"control field has-addons",children:[(0,d.jsxs)("div",{className:"control has-icons-right",children:[(0,d.jsx)("input",{className:"input",id:"widthInput",type:"number",min:"100",max:"500",step:".001",value:i,onChange:e=>n(parseFloat(e.target.value))}),(0,d.jsx)("span",{className:"icon is-right",children:"mm"})]}),(0,d.jsxs)("div",{className:"control buttons has-addons",children:[(0,d.jsx)("a",{className:"button is-primary "+(i===l?"":"is-outlined"),onClick:()=>n(l),children:"AWD"}),(0,d.jsx)("a",{className:"button is-success "+(i===c?"":"is-outlined"),onClick:()=>n(c),children:"EPR"}),(0,d.jsx)("a",{className:"button is-link "+(i===u?"":"is-outlined"),onClick:()=>n(u),children:"OPR"})]})]}),(0,d.jsx)("a",{className:"control button is-dark"+(r?"":"is-outlined"),onClick:t,id:"enableOptim",children:"Auto-Space"}),(0,d.jsx)("a",{className:"control button is-dark"+(s?"is-success":"is-outlined"),onClick:()=>{o(),a()},id:"enableHighlight",children:"Show Duplicates"})]})}function on(e){let{onTextNorm:t}=e;return(0,d.jsx)("button",{className:"button",onClick:t,children:"Renormalize Input Spacing"})}function an(){return(0,d.jsxs)("h1",{className:"title",children:[(0,d.jsx)("span",{className:"logo",children:"AF "}),(0,d.jsx)("span",{className:"logo",children:"Bull"}),"et",(0,d.jsx)("span",{className:"logo",children:" Sh"}),"aping &",(0,d.jsx)("span",{className:"logo",children:" i"}),"teration",(0,d.jsx)("span",{className:"logo",children:" t"}),"ool"]})}function sn(e){let{onHide:t}=e;return(0,d.jsxs)("a",{className:"button",onClick:t,"aria-haspopup":"true","aria-controls":"thesaurus-menu",children:[(0,d.jsx)("span",{children:"Thesaurus"}),(0,d.jsx)("span",{className:"icon",children:(0,d.jsx)(Kr,{icon:Xr})})]})}function ln(e){return(0,d.jsx)("nav",{className:"navbar",role:"navigation","aria-label":"main navigation",children:(0,d.jsxs)("div",{className:"navbar-start",children:[(0,d.jsx)("div",{className:"navbar-item",children:(0,d.jsx)(rn,{getSavedSettings:e.getSavedSettings})}),(0,d.jsx)("div",{className:"navbar-item",children:(0,d.jsx)(tn,{onJSONImport:e.onJSONImport,onTextUpdate:e.onTextUpdate,onWidthUpdate:e.onWidthUpdate})}),(0,d.jsx)("div",{className:"navbar-item",children:(0,d.jsx)(nn,{enableOptim:e.enableOptim,onOptimChange:e.onOptimChange,width:e.width,onWidthUpdate:e.onWidthUpdate,onHighlightChange:e.onHighlightChange,handleEnableHighlight:e.handleEnableHighlight,enableHighlight:e.enableHighlight})}),(0,d.jsx)("div",{className:"navbar-item",children:(0,d.jsx)(on,{onTextNorm:e.onTextNorm})}),(0,d.jsx)("div",{className:"navbar-item",children:(0,d.jsx)(sn,{onHide:e.onThesaurusHide})})]})})}Zr.GlobalWorkerOptions.workerSrc=Qr;__webpack_require__(4647);var cn=__webpack_require__(6213);function un(e){return e[0].toUpperCase()+e.substr(1)}function hn(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+e()+e()}function dn(e){return/^([0-9][0-9]?%$)|(^100%$)/.test(e)}function fn(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return`${e}`.replace(/(?:\\)?\[([^[\]]+)]/g,((e,r)=>"\\"===e.charAt(0)?e.substr(1,e.length-1):void 0===t[r]?"":t[r]))}function gn(e){return pn(`${e}`,{ALLOWED_TAGS:[]})}function pn(e,t){return cn.sanitize(e,t)}const mn=e=>["tabindex",e],vn=()=>["role","presentation"],bn=()=>["role","checkbox"],yn=e=>["aria-label",e],wn=()=>["aria-hidden","true"],Sn=e=>["aria-haspopup",e],Cn=e=>["aria-rowcount",e],kn=e=>["aria-colcount",e],xn=e=>["aria-rowindex",e],En=e=>["aria-colindex",e],Tn=e=>["aria-expanded",e],_n=()=>["aria-readonly","true"],An=()=>["aria-invalid","true"],Rn=e=>["aria-checked",e],On=e=>["aria-relevant",e],Mn=e=>["aria-posinset",e];function In(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=-1,n=null,i=e;for(;null!==i;){if(r===t){n=i;break}i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:(r+=1,i=i.parentNode)}return n}function Pn(e){return function(e){return Object.getPrototypeOf(e.parent)&&e.frameElement}(e)&&e.parent}function Nn(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:n,DOCUMENT_FRAGMENT_NODE:i}=Node;let o=e;for(;null!==o&&void 0!==o&&o!==r;){const{nodeType:e,nodeName:r}=o;if(e===n&&(t.includes(r)||t.includes(o)))return o;const{host:a}=o;o=a&&e===i?a:o.parentNode}return null}function Dn(e,t,r){const n=[];let i=e;for(;i&&(i=Nn(i,t,r),i&&(!r||r.contains(i)));)n.push(i),i=i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i.host:i.parentNode;const o=n.length;return o?n[o-1]:null}function Fn(e,t){let r=e.parentNode,n=[];for("string"===typeof t?n=e.defaultView?Array.prototype.slice.call(e.querySelectorAll(t),0):Array.prototype.slice.call(e.ownerDocument.querySelectorAll(t),0):n.push(t);null!==r;){if(n.indexOf(r)>-1)return!0;r=r.parentNode}return!1}function Ln(e,t,r){const n=r.parentElement.querySelector(`.ht_clone_${e}`);return n?n.contains(t):null}function Hn(e){return e&&e.length?e.filter((e=>!!e)):[]}function Bn(e,t){if(!e||!e.length)return t?{regexFree:[],regexes:[]}:[];const r=[],n=[];return n.push(...e.filter((e=>{const n=e instanceof RegExp;return n&&t&&r.push(e),!n}))),t?{regexFree:n,regexes:r}:n}function Un(e,t){return void 0!==e.classList&&"string"===typeof t&&""!==t&&e.classList.contains(t)}function jn(e,t){"string"===typeof t&&(t=t.split(" ")),(t=Hn(t)).length>0&&e.classList.add(...t)}function Wn(e,t){"string"===typeof t?t=t.split(" "):t instanceof RegExp&&(t=[t]);let{regexFree:r,regexes:n}=Bn(t,!0);r=Hn(r),r.length>0&&e.classList.remove(...r),n.forEach((t=>{e.classList.forEach((r=>{t.test(r)&&e.classList.remove(r)}))}))}function Vn(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0;Array.isArray(t)||(t=[[t,r]]),t.forEach((t=>{Array.isArray(t)&&""!==t[0]&&e.setAttribute(...t)}))}function zn(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];"string"===typeof t?t=t.split(" "):t instanceof RegExp&&(t=[t]);const{regexFree:r,regexes:n}=Bn(t,!0);r.forEach((t=>{""!==t&&e.removeAttribute(t)})),n.forEach((t=>{e.getAttributeNames().forEach((r=>{t.test(r)&&e.removeAttribute(r)}))}))}function qn(e){if(3===e.nodeType)e.parentNode.removeChild(e);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(e.nodeName)>-1){const t=e.childNodes;for(let e=t.length-1;e>=0;e--)qn(t[e])}}function Gn(e){let t;for(;t=e.lastChild;)e.removeChild(t)}const $n=/(<(.*)>|&(.*);)/;function Kn(e,t){let r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];$n.test(t)?e.innerHTML=r?pn(t):t:Yn(e,t)}function Yn(e,t){const r=e.firstChild;r&&3===r.nodeType&&null===r.nextSibling?r.textContent=t:(Gn(e),e.appendChild(e.ownerDocument.createTextNode(t)))}function Xn(e){const t=e.ownerDocument.documentElement;let r=e;for(;r!==t;){if(null===r)return!1;if(r.nodeType===Node.DOCUMENT_FRAGMENT_NODE){if(r.host){if(r.host.impl)return Xn(r.host.impl);if(r.host)return Xn(r.host);throw new Error("Lost in Web Components world")}return!1}if("none"===oi(r).display)return!1;r=r.parentNode}return!0}function Jn(e){const t=e.ownerDocument,r=t.defaultView,n=t.documentElement;let i,o,a,s=e;for(i=s.offsetLeft,o=s.offsetTop,a=s;(s=s.offsetParent)&&s!==t.body&&"offsetLeft"in s;)i+=s.offsetLeft,o+=s.offsetTop,a=s;return a&&"fixed"===a.style.position&&(i+=r.pageXOffset||n.scrollLeft,o+=r.pageYOffset||n.scrollTop),{left:i,top:o}}function Zn(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:window).scrollY}function Qn(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:window).scrollX}function ei(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return e===t?Zn(t):e.scrollTop}function ti(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return e===t?Qn(t):e.scrollLeft}function ri(e){let t=e.ownerDocument,r=t?t.defaultView:void 0;t||(t=e.document?e.document:e,r=t.defaultView);const n=["auto","scroll"];let i=e.parentNode;for(;i&&i.style&&t.body!==i;){let{overflow:e,overflowX:t,overflowY:o}=i.style;if([e,t,o].includes("scroll"))return i;if(({overflow:e,overflowX:t,overflowY:o}=r.getComputedStyle(i)),n.includes(e)||n.includes(t)||n.includes(o))return i;if(i.clientHeight<=i.scrollHeight+1&&(n.includes(o)||n.includes(e)))return i;if(i.clientWidth<=i.scrollWidth+1&&(n.includes(t)||n.includes(e)))return i;i=i.parentNode}return r}function ni(e){const t=e.ownerDocument,r=t.defaultView;let n=e.parentNode;for(;n&&n.style&&t.body!==n;){if("visible"!==n.style.overflow&&""!==n.style.overflow)return n;const e=oi(n,r),t=["scroll","hidden","auto"],i=e.getPropertyValue("overflow"),o=e.getPropertyValue("overflow-y"),a=e.getPropertyValue("overflow-x");if(t.includes(i)||t.includes(o)||t.includes(a))return n;n=n.parentNode}return r}function ii(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window;if(!e)return;if(e===r)return"width"===t?`${r.innerWidth}px`:"height"===t?`${r.innerHeight}px`:void 0;const n=e.style[t];if(""!==n&&void 0!==n)return n;const i=oi(e,r);return""!==i[t]&&void 0!==i[t]?i[t]:void 0}function oi(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return e.currentStyle||t.getComputedStyle(e)}function ai(e){return e.offsetWidth}function si(e){return e.offsetHeight}function li(e){return e.clientHeight||e.innerHeight}function ci(e){return e.clientWidth||e.innerWidth}function ui(e){return e.selectionStart?e.selectionStart:0}function hi(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window;e.getSelection&&(e.getSelection().empty?e.getSelection().empty():e.getSelection().removeAllRanges&&e.getSelection().removeAllRanges())}function di(e,t,r){if(void 0===r&&(r=t),e.setSelectionRange){e.focus();try{e.setSelectionRange(t,r)}catch(n){const i=e.parentNode,o=i.style.display;i.style.display="block",e.setSelectionRange(t,r),i.style.display=o}}}let fi;function gi(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;return void 0===fi&&(fi=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;const t=e.createElement("div");t.style.height="200px",t.style.width="100%";const r=e.createElement("div");r.style.boxSizing="content-box",r.style.height="150px",r.style.left="0px",r.style.overflow="hidden",r.style.position="absolute",r.style.top="0px",r.style.width="200px",r.style.visibility="hidden",r.appendChild(t),(e.body||e.documentElement).appendChild(r);const n=t.offsetWidth;r.style.overflow="scroll";let i=t.offsetWidth;return n===i&&(i=r.clientWidth),(e.body||e.documentElement).removeChild(r),n-i}(e)),fi}function pi(e,t,r){e.style.transform=`translate3d(${t},${r},0)`}function mi(e){e.style.transform&&""!==e.style.transform&&(e.style.transform="")}function vi(e){return e&&(["INPUT","SELECT","TEXTAREA"].indexOf(e.nodeName)>-1||"true"===e.contentEditable)}function bi(e){return vi(e)&&!1===e.hasAttribute("data-hot-input")}function yi(e){return!e.parentNode}function wi(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const n=e.ownerDocument,i=n.createRange(),o=n.defaultView.getSelection();Vn(e,"contenteditable",!0),r&&Vn(e,...wn()),t&&jn(e,"invisibleSelection"),i.selectNodeContents(e),o.removeAllRanges(),o.addRange(i)}function Si(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const r=e.ownerDocument.defaultView.getSelection();e.hasAttribute("aria-hidden")&&e.removeAttribute("aria-hidden"),r.removeAllRanges(),t&&Wn(e,"invisibleSelection"),e.removeAttribute("contenteditable")}var Ci=__webpack_require__(6178);function ki(e,t){const r=t.length;let n=0;for(;n<r;)e.push(t[n]),n+=1}function xi(e){const t=[];if(!e||0===e.length||!e[0]||0===e[0].length)return t;const r=e.length,n=e[0].length;for(let i=0;i<r;i++)for(let r=0;r<n;r++)t[r]||(t[r]=[]),t[r][i]=e[i][r];return t}function Ei(e,t,r,n){let i=-1,o=e,a=r;Array.isArray(e)||(o=Array.from(e));const s=o.length;for(n&&s&&(i+=1,a=o[i]),i+=1;i<s;)a=t(a,o[i],i,o),i+=1;return a}function Ti(e,t){let r=0,n=e;Array.isArray(e)||(n=Array.from(e));const i=n.length,o=[];let a=-1;for(;r<i;){const e=n[r];t(e,r,n)&&(a+=1,o[a]=e),r+=1}return o}function _i(e,t){let r=0,n=e;Array.isArray(e)||(n=Array.from(e));const i=n.length,o=[];let a=-1;for(;r<i;){const e=n[r];a+=1,o[a]=t(e,r,n),r+=1}return o}function Ai(e,t){let r=0,n=e;Array.isArray(e)||(n=Array.from(e));const i=n.length;for(;r<i&&!1!==t(n[r],r,n);)r+=1;return e}function Ri(e){const t=[];return Ai(e,(e=>{-1===t.indexOf(e)&&t.push(e)})),t}function Oi(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];const[n,...i]=[...t];let o=n;return Ai(i,(e=>{o=o.filter((t=>!e.includes(t)))})),o}function Mi(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:" ";return e.split(t)}function Ii(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];const i=Ei(e,((e,t,n)=>e+t.replace(/\r?\n\s*/g,"")+(r[n]?r[n]:"")),"");return i.trim()}function Pi(e){let t;switch(typeof e){case"string":case"number":t=`${e}`;break;case"object":t=null===e?"":e.toString();break;case"undefined":t="";break;default:t=e.toString()}return t}function Ni(e){return"undefined"!==typeof e}function Di(e){return"undefined"===typeof e}function Fi(e){return null===e||""===e||Di(e)}const Li="length",Hi=e=>parseInt(e,16),Bi=e=>parseInt(e,10),Ui=(e,t,r)=>e.substr(t,r),ji=e=>e.codePointAt(0)-65,Wi=e=>`${e}`.replace(/\-/g,""),Vi=e=>Hi(Ui(Wi(e),Hi("12"),ji("F")))/(Hi(Ui(Wi(e),ji("B"),~~![][Li]))||9),zi=()=>"undefined"!==typeof location&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let qi=!1;const Gi={invalid:()=>Ii`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:e=>{let{keyValidityDate:t,hotVersion:r}=e;return Ii`
    The license key for Handsontable expired on ${t}, and is not valid for the installed\x20
    version ${r}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${t}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>Ii`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},$i={invalid:()=>Ii`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:e=>{let{keyValidityDate:t,hotVersion:r}=e;return Ii`
    The license key for Handsontable expired on ${t}, and is not valid for the installed\x20
    version ${r}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${t}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>Ii`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function Ki(e,t){const r=!Fi(e),n="string"===typeof e&&"non-commercial-and-evaluation"===e.toLowerCase(),i="14.5.0";let o,a="invalid",s="invalid";const l=function(e){let t=[][Li],r=t;if(e[Li]!==ji("Z"))return!1;for(let n="",i="B<H4P+".split(""),o=ji(i.shift());o;o=ji(i.shift()||"A"))--o<""[Li]?r|=(Bi(`${Bi(Hi(n)+(Hi(Ui(e,Math.abs(o),2))+[]).padStart(2,"0"))}`)%97||2)>>1:n=Ui(e,o,o?1===i[Li]?9:8:6);return r===t}(e=Wi(e||""));if(r||n||l)if(l){const t=Ci("30/07/2024","DD/MM/YYYY"),r=Math.floor(t.toDate().getTime()/864e5),n=Vi(e);o=Ci(864e5*(n+1),"x").format("MMMM DD, YYYY"),r>n?(a="expired",s="expired"):(a="valid",s="valid")}else n?(a="non_commercial",s="valid"):(a="invalid",s="invalid");else a="missing",s="missing";if(zi()&&(a="valid",s="valid"),!qi&&"valid"!==a){Gi[a]({keyValidityDate:o,hotVersion:i})&&console["non_commercial"===a?"info":"warn"](Gi[a]({keyValidityDate:o,hotVersion:i})),qi=!0}if("valid"!==s&&t.parentNode){if($i[s]({keyValidityDate:o,hotVersion:i})){const e=document.createElement("div");e.className="hot-display-license-info",e.innerHTML=$i[s]({keyValidityDate:o,hotVersion:i}),t.parentNode.insertBefore(e,t.nextSibling)}}}function Yi(e){return"function"===typeof e}function Xi(e){let t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,n=null;return function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return n&&clearTimeout(n),n=setTimeout((()=>{t=e.apply(this,o)}),r),t}}function Ji(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return e.apply(this,r.concat(n))}}function Zi(e,t,r,n,i,o,a,s){return Ni(s)?e.call(t,r,n,i,o,a,s):Ni(a)?e.call(t,r,n,i,o,a):Ni(o)?e.call(t,r,n,i,o):Ni(i)?e.call(t,r,n,i):Ni(n)?e.call(t,r,n):Ni(r)?e.call(t,r):e.call(t)}function Qi(e){let t;return Array.isArray(e)?t=e.length?new Array(e.length).fill(null):[]:(t={},co(e,((e,r)=>{"__children"!==r&&(e&&"object"===typeof e&&!Array.isArray(e)?t[r]=Qi(e):Array.isArray(e)?e.length&&"object"===typeof e[0]&&!Array.isArray(e[0])?t[r]=[Qi(e[0])]:t[r]=[]:t[r]=null)}))),t}function eo(e,t){return t.prototype.constructor=t,e.prototype=new t,e.prototype.constructor=e,e}function to(e,t,r){const n=Array.isArray(r);return co(t,((t,i)=>{(!1===n||r.includes(i))&&(e[i]=t)})),e}function ro(e,t){co(t,((r,n)=>{t[n]&&"object"===typeof t[n]?(e[n]||(Array.isArray(t[n])?e[n]=[]:"[object Date]"===Object.prototype.toString.call(t[n])?e[n]=t[n]:e[n]={}),ro(e[n],t[n])):e[n]=t[n]}))}function no(e){return"object"===typeof e?JSON.parse(JSON.stringify(e)):e}function io(e){const t={};return co(e,((e,r)=>{t[r]=e})),t}function oo(e){e.MIXINS||(e.MIXINS=[]);for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return Ai(r,(t=>{e.MIXINS.push(t.MIXIN_NAME),co(t,((t,r)=>{if(void 0!==e.prototype[r])throw new Error(`Mixin conflict. Property '${r}' already exist and cannot be overwritten.`);if("function"===typeof t)e.prototype[r]=t;else{const n=function(e,t){const r=`_${e}`;return function(){return void 0===this[r]&&(this[r]=(e=>{let t=e;return(Array.isArray(t)||so(t))&&(t=no(t)),t})(t)),this[r]}},i=function(e){const t=`_${e}`;return function(e){this[t]=e}};Object.defineProperty(e.prototype,r,{get:n(r,t),set:i(r),configurable:!0})}}))})),e}function ao(e,t){return JSON.stringify(e)===JSON.stringify(t)}function so(e){return"[object Object]"===Object.prototype.toString.call(e)}function lo(e,t,r,n){n.value=r,n.writable=!1!==n.writable,n.enumerable=!1!==n.enumerable,n.configurable=!1!==n.configurable,Object.defineProperty(e,t,n)}function co(e,t){for(const r in e)if((!e.hasOwnProperty||e.hasOwnProperty&&Object.prototype.hasOwnProperty.call(e,r))&&!1===t(e[r],r,e))break;return e}function uo(e,t,r){const n=t.split(".");let i=e;n.forEach(((e,t)=>{t!==n.length-1?(go(i,e)||(i[e]={}),i=i[e]):i[e]=r}))}function ho(e){if(!so(e))return 0;const t=function(e){let r=0;return so(e)?co(e,((e,n)=>{"__children"!==n&&(r+=t(e))})):r+=1,r};return t(e)}function fo(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"value";const r=`_${t}`,n={_touched:!1,[r]:e,isTouched(){return this._touched}};return Object.defineProperty(n,t,{get(){return this[r]},set(e){this._touched=!0,this[r]=e},enumerable:!0,configurable:!0}),n}function go(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function po(e){return window.requestAnimationFrame(e)}function mo(e){window.cancelAnimationFrame(e)}function vo(){return"ontouchstart"in window}let bo;const yo=e=>{const t={value:!1,test:(r,n)=>{t.value=e(r,n)}};return t},wo={chrome:yo(((e,t)=>/Chrome/.test(e)&&/Google/.test(t))),chromeWebKit:yo((e=>/CriOS/.test(e))),edge:yo((e=>/Edge/.test(e))),edgeWebKit:yo((e=>/EdgiOS/.test(e))),firefox:yo((e=>/Firefox/.test(e))),firefoxWebKit:yo((e=>/FxiOS/.test(e))),mobile:yo((e=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(e))),safari:yo(((e,t)=>/Safari/.test(e)&&/Apple Computer/.test(t)))},So={mac:yo((e=>/^Mac/.test(e))),win:yo((e=>/^Win/.test(e))),linux:yo((e=>/^Linux/.test(e))),ios:yo((e=>/iPhone|iPad|iPod/i.test(e)))};function Co(){return wo.chrome.value}function ko(){return wo.firefox.value}function xo(){return wo.safari.value}function Eo(){return wo.mobile.value}function To(){return So.ios.value}function _o(){let{maxTouchPoints:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:navigator;return e>2&&So.mac.value}function Ao(){return So.win.value}function Ro(){return So.mac.value}"undefined"!==typeof window&&(function(){let{userAgent:e=navigator.userAgent,vendor:t=navigator.vendor}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};co(wo,(r=>{let{test:n}=r;n(e,t)}))}(),function(){let{platform:e=navigator.platform}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};co(So,(t=>{let{test:r}=t;r(e)}))}());const Oo={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:ko()?182:174,AUDIO_MUTE:ko()?181:173,AUDIO_UP:ko()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},Mo=[Oo.ALT,Oo.ARROW_DOWN,Oo.ARROW_LEFT,Oo.ARROW_RIGHT,Oo.ARROW_UP,Oo.AUDIO_DOWN,Oo.AUDIO_MUTE,Oo.AUDIO_UP,Oo.BACKSPACE,Oo.CAPS_LOCK,Oo.DELETE,Oo.END,Oo.ENTER,Oo.ESCAPE,Oo.F1,Oo.F2,Oo.F3,Oo.F4,Oo.F5,Oo.F6,Oo.F7,Oo.F8,Oo.F9,Oo.F10,Oo.F11,Oo.F12,Oo.F13,Oo.F14,Oo.F15,Oo.F16,Oo.F17,Oo.F18,Oo.F19,Oo.HOME,Oo.INSERT,Oo.MEDIA_NEXT,Oo.MEDIA_PLAY_PAUSE,Oo.MEDIA_PREV,Oo.MEDIA_STOP,Oo.NULL,Oo.NUM_LOCK,Oo.PAGE_DOWN,Oo.PAGE_UP,Oo.PAUSE,Oo.SCROLL_LOCK,Oo.SHIFT,Oo.TAB];function Io(e){return Mo.includes(e)}function Po(e,t){const r=t.split("|");let n=!1;return Ai(r,(t=>{if(e===Oo[t])return n=!0,!1})),n}function No(e){e.isImmediatePropagationEnabled=!1,e.cancelBubble=!0}function Do(e){return!1===e.isImmediatePropagationEnabled}function Fo(e){return 2===e.button}function Lo(e){return 0===e.button}function Ho(){Ni(console)&&console.warn(...arguments)}function Bo(){Ni(console)&&console.error(...arguments)}function Uo(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const jo=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSelectionFocusSet","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSelectionFocusSet","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFiltersMultiSelectValue","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyRowHeightByOverlayName","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformFocus","modifyTransformStart","modifyTransformEnd","afterModifyTransformFocus","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","beforeBeginEditing","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],Wo=Ii`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`,Vo=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),zo=new Map([[]]),qo=new WeakMap;class Go{static getSingleton(){return $o}constructor(){Uo(this,"globalBucket",void 0),this.globalBucket=this.createEmptyBucket()}createEmptyBucket(){const e=Object.create(null);return Ai(jo,(t=>{e[t]=[],this.initOrderMap(e,t)})),e}getBucket(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=this.createEmptyBucket()),e.pluginHookBucket):this.globalBucket}add(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3?arguments[3]:void 0;if(Array.isArray(t))Ai(t,(t=>this.add(e,t,r)));else{Vo.has(e)&&Ho(fn(Wo,{hookName:e,removedInVersion:Vo.get(e)})),zo.has(e)&&Ho(zo.get(e));const i=this.getBucket(r);if("undefined"===typeof i[e]&&(this.register(e),i[e]=[],this.initOrderMap(i,e)),t.skip=!1,-1===i[e].indexOf(t)){let r=!1;t.initialHook&&Ai(i[e],((n,o)=>{if(n.initialHook)return i[e][o]=t,r=!0,!1})),r||i[e].push(t)}this.setCallbackOrderIndex(i,e,t,n),this.orderBucketByOrderIndex(i,e)}return this}once(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3?arguments[3]:void 0;Array.isArray(t)?Ai(t,(t=>this.once(e,t,r))):(t.runOnce=!0,this.add(e,t,r,n))}remove(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const n=this.getBucket(r);return"undefined"!==typeof n[e]&&n[e].indexOf(t)>=0&&(t.skip=!0,!0)}has(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const r=this.getBucket(t);return!(void 0===r[e]||!r[e].length)}run(e,t,r,n,i,o,a,s){{const l=this.globalBucket[t],c=l?l.length:0;let u=0;if(c)for(;u<c;){if(!l[u]||l[u].skip){u+=1;continue}const c=Zi(l[u],e,r,n,i,o,a,s);void 0!==c&&(r=c),l[u]&&l[u].runOnce&&this.remove(t,l[u]),u+=1}}{const l=this.getBucket(e)[t],c=l?l.length:0;let u=0;if(c)for(;u<c;){if(!l[u]||l[u].skip){u+=1;continue}const c=Zi(l[u],e,r,n,i,o,a,s);void 0!==c&&(r=c),l[u]&&l[u].runOnce&&this.remove(t,l[u],e),u+=1}}return r}destroy(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;co(this.getBucket(e),((e,t,r)=>r[t].length=0))}register(e){this.isRegistered(e)||jo.push(e)}deregister(e){this.isRegistered(e)&&jo.splice(jo.indexOf(e),1)}isDeprecated(e){return zo.has(e)||Vo.has(e)}isRegistered(e){return jo.indexOf(e)>=0}getRegistered(){return jo}setCallbackOrderIndex(e,t,r,n){const i=Number.isInteger(n)?n:0,o=this.getCallbackOrderMap(e,t);o.set(i,[...o.get(i)||[],r])}orderBucketByOrderIndex(e,t){const r=this.getCallbackOrderMap(e,t);void 0===r||0===r.size||1===r.size&&r.has(0)||(e[t]=[...r].sort(((e,t)=>e[0]-t[0])).flatMap((e=>{let[,t]=e;return t})))}initOrderMap(e,t){qo.has(e)||qo.set(e,[]),qo.get(e)[t]=new Map}getCallbackOrderMap(e,t){return qo.get(e)[t]}}const $o=new Go;const Ko=Go,Yo=new Map;function Xo(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"common";Yo.has(e)||Yo.set(e,new Map);const t=Yo.get(e);return{register:function(e,r){t.set(e,r)},getItem:function(e){return t.get(e)},hasItem:function(e){return t.has(e)},getNames:function(){return[...t.keys()]},getValues:function(){return[...t.values()]}}}const Jo=new WeakMap,{register:Zo,getItem:Qo,hasItem:ea,getNames:ta,getValues:ra}=Xo("editors");function na(e){const t={},r=e;this.getConstructor=function(){return e},this.getInstance=function(e){return e.guid in t||(t[e.guid]=new r(e)),t[e.guid]},Ko.getSingleton().add("afterDestroy",(function(){t[this.guid]=null}))}function ia(e,t){let r;if("function"===typeof e)Jo.get(e)||aa(null,e),r=Jo.get(e);else{if("string"!==typeof e)throw Error('Only strings and functions can be passed as "editor" parameter');r=Qo(e)}if(!r)throw Error(`No editor registered under name "${e}"`);return r.getInstance(t)}function oa(e){if("function"===typeof e)return e;if(!ea(e))throw Error(`No registered editor found under "${e}" name`);return Qo(e).getConstructor()}function aa(e,t){e&&"string"!==typeof e&&(e=(t=e).EDITOR_TYPE);const r=new na(t);"string"===typeof e&&Zo(e,r),Jo.set(t,r)}function sa(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}let la=0;const ca=class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;sa(this,"context",void 0),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];function i(e){r.call(this,function(e){const t=e.stopImmediatePropagation;return e.stopImmediatePropagation=function(){t.apply(this),No(this)},e}(e))}return this.context.eventListeners.push({element:e,event:t,callback:r,callbackProxy:i,options:n,eventManager:this}),e.addEventListener(t,i,n),la+=1,()=>{this.removeEventListener(e,t,r)}}removeEventListener(e,t,r){let n,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=this.context.eventListeners.length;for(;o;)if(o-=1,n=this.context.eventListeners[o],n.event===t&&n.element===e){if(r&&r!==n.callback)continue;if(i&&n.eventManager!==this)continue;this.context.eventListeners.splice(o,1),n.element.removeEventListener(n.event,n.callbackProxy,n.options),la-=1}}clearEvents(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.context)return;let t=this.context.eventListeners.length;for(;t;){t-=1;const r=this.context.eventListeners[t];e&&r.eventManager!==this||(this.context.eventListeners.splice(t,1),r.element.removeEventListener(r.event,r.callbackProxy,r.options),la-=1)}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,t){let r=e.document,n=e;r||(r=e.ownerDocument?e.ownerDocument:e,n=r.defaultView);const i={bubbles:!0,cancelable:"mousemove"!==t,view:n,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0};let o;r.createEvent?(o=r.createEvent("MouseEvents"),o.initMouseEvent(t,i.bubbles,i.cancelable,i.view,i.detail,i.screenX,i.screenY,i.clientX,i.clientY,i.ctrlKey,i.altKey,i.shiftKey,i.metaKey,i.button,i.relatedTarget||r.body.parentNode)):o=r.createEventObject(),e.dispatchEvent?e.dispatchEvent(o):e.fireEvent(`on${t}`,o)}};function ua(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function ha(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function da(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var fa=new WeakSet;class ga{constructor(e,t,r){ua(this,fa),ha(this,"hot",void 0),ha(this,"tableMeta",void 0),ha(this,"selection",void 0),ha(this,"eventManager",void 0),ha(this,"destroyed",!1),ha(this,"activeEditor",void 0),ha(this,"cellProperties",void 0),this.hot=e,this.tableMeta=t,this.selection=r,this.eventManager=new ca(e),this.hot.addHook("afterDocumentKeyDown",(e=>da(fa,this,pa).call(this,e))),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"compositionstart",(e=>{!this.destroyed&&this.hot.isListening()&&this.openEditor("",e)})),this.hot.view._wt.update("onCellDblClick",((e,t,r)=>da(fa,this,ma).call(this,e,t,r)))}getActiveEditor(){return this.activeEditor}prepareEditor(){var e;if(this.activeEditor&&this.activeEditor.isWaiting())return void this.closeEditor(!1,!1,(e=>{e&&this.prepareEditor()}));const t=null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.highlight;if(!t||t.isHeader())return;const{row:r,col:n}=t,i=this.hot.runHooks("modifyGetCellCoords",r,n);let o=r,a=n;if(Array.isArray(i)&&([o,a]=i),this.cellProperties=this.hot.getCellMeta(o,a),!this.isCellEditable())return void this.clearActiveEditor();const s=this.hot.getCell(r,n,!0);if(s){const e=this.hot.getCellEditor(this.cellProperties),t=this.hot.colToProp(a),i=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(o),a);this.activeEditor=ia(e,this.hot),this.activeEditor.prepare(r,n,t,s,i,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!this.isCellEditable())return void this.clearActiveEditor();const n=this.hot.getSelectedRangeLast();let i=this.hot.runHooks("beforeBeginEditing",n.highlight.row,n.highlight.col,e,t,r);t instanceof MouseEvent&&"boolean"!==typeof i&&(i=0===this.hot.selection.getLayerLevel()&&n.isSingle()),!1!==i?(this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(r&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,t))):this.clearActiveEditor()}closeEditor(e,t,r){this.activeEditor?this.activeEditor.finishEditing(e,t,r):r&&r(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const e=this.hot.getSelectedRangeLast();if(!e)return!1;const t=this.hot.getCellEditor(this.cellProperties),{row:r,col:n}=e.highlight,{rowIndexMapper:i,columnIndexMapper:o}=this.hot,a=i.isHidden(this.hot.toPhysicalRow(r))||o.isHidden(this.hot.toPhysicalColumn(n));return!(this.cellProperties.readOnly||!t||a)}moveSelectionAfterEnter(e){const t={..."function"===typeof this.tableMeta.enterMoves?this.tableMeta.enterMoves(e):this.tableMeta.enterMoves};e.shiftKey&&(t.row=-t.row,t.col=-t.col),this.hot.selection.isMultiple()?this.selection.transformFocus(t.row,t.col):this.selection.transformStart(t.row,t.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function pa(e){const t=this.hot.getSelectedRangeLast();if(!this.hot.isListening()||!t||t.highlight.isHeader()||Do(e))return;const{keyCode:r}=e,n=(e.ctrlKey||e.metaKey)&&!e.altKey;(!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&(Io(r)||function(e){return[Oo.CONTROL,Oo.COMMAND_LEFT,Oo.COMMAND_RIGHT,Oo.COMMAND_FIREFOX].includes(e)}(r)||n||this.isEditorOpened()||this.openEditor("",e))}function ma(e,t){t.isCell()&&this.openEditor(null,e,!0)}const va=new WeakMap;ga.getInstance=function(e,t,r){let n=va.get(e);return n||(n=new ga(e,t,r),va.set(e,n)),n};const ba=ga;function ya(e,t,r){wa(e,t),t.set(e,r)}function wa(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Sa(e,t){return e.get(ka(e,t))}function Ca(e,t,r){return e.set(ka(e,t),r),r}function ka(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}const xa=Object.freeze({CELL:"cell",MIXED:"mixed"});var Ea=new WeakMap,Ta=new WeakMap,_a=new WeakMap,Aa=new WeakMap,Ra=new WeakMap,Oa=new WeakSet;class Ma{constructor(e){var t=this;!function(e,t){wa(e,t),t.add(e)}(this,Oa),ya(this,Ea,void 0),ya(this,Ta,void 0),ya(this,_a,1),ya(this,Aa,null),ya(this,Ra,new Map);const r=e.getSettings();Ca(Ea,this,e),Ca(Ta,this,r.imeFastEdit?xa.MIXED:xa.CELL),Sa(Ea,this).addHook("afterUpdateSettings",(function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return ka(Oa,t,Da).call(t,...r)})),Sa(Ea,this).addHook("afterSelection",(function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return ka(Oa,t,Pa).call(t,...r)})),Sa(Ea,this).addHook("afterSelectionFocusSet",(function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return ka(Oa,t,Pa).call(t,...r)})),Sa(Ea,this).addHook("afterSelectionEnd",(function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return ka(Oa,t,Na).call(t,...r)}))}getFocusMode(){return Sa(Ta,this)}setFocusMode(e){Object.values(xa).includes(e)?Ca(Ta,this,e):Ho(`"${e}" is not a valid focus mode.`)}getRefocusDelay(){return Sa(_a,this)}setRefocusDelay(e){Ca(_a,this,e)}setRefocusElementGetter(e){Ca(Aa,this,e)}getRefocusElement(){return"function"===typeof Sa(Aa,this)?Sa(Aa,this).call(this):null===(e=Sa(Ea,this).getActiveEditor())||void 0===e?void 0:e.TEXTAREA;var e}focusOnHighlightedCell(e){const t=e=>{var t,r;const n=null===(t=Sa(Ea,this).getSelectedRangeLast())||void 0===t?void 0:t.highlight;if(!n)return;let i=Sa(Ea,this).runHooks("modifyFocusedElement",n.row,n.col,e);i instanceof HTMLElement||(i=e),!i||null!==(r=Sa(Ea,this).getActiveEditor())&&void 0!==r&&r.isOpened()||i.focus({preventScroll:!0})};e?t(e):ka(Oa,this,Ia).call(this,(e=>t(e)))}refocusToEditorTextarea(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Sa(_a,this);const r=this.getRefocusElement();!Sa(Ea,this).getSettings().imeFastEdit||null!==(e=Sa(Ea,this).getActiveEditor())&&void 0!==e&&e.isOpened()||!r||(Sa(Ra,this).has(t)||Sa(Ra,this).set(t,Xi((()=>{r.select()}),t)),Sa(Ra,this).get(t)())}}function Ia(e){var t;const r=null===(t=Sa(Ea,this).getSelectedRangeLast())||void 0===t?void 0:t.highlight;if(!r||!Sa(Ea,this).selection.isCellVisible(r))return void e(null);const n=Sa(Ea,this).getCell(r.row,r.col,!0);null===n?Sa(Ea,this).addHookOnce("afterScroll",(()=>{e(Sa(Ea,this).getCell(r.row,r.col,!0))})):e(n)}function Pa(){ka(Oa,this,Ia).call(this,(e=>{const{activeElement:t}=Sa(Ea,this).rootDocument;t&&bi(t)&&t.blur(),this.focusOnHighlightedCell(e)}))}function Na(){ka(Oa,this,Ia).call(this,(e=>{this.getFocusMode()===xa.MIXED&&"TD"===e.nodeName&&this.refocusToEditorTextarea()}))}function Da(e){"boolean"===typeof e.imeFastEdit&&this.setFocusMode(e.imeFastEdit?xa.MIXED:xa.CELL)}const Fa={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},La=new RegExp(Object.keys(Fa).map((e=>`(${e})`)).join("|"),"gi");function Ha(e){const t=e.hasColHeaders(),r=e.hasRowHeaders(),n=[t?-1:0,r?-1:0,e.countRows()-1,e.countCols()-1],i=e.getData(...n),o=i.length,a=o>0?i[0].length:0,s=["<table>","</table>"],l=t?["<thead>","</thead>"]:[],c=["<tbody>","</tbody>"],u=r?1:0,h=t?1:0;for(let d=0;d<o;d+=1){const n=t&&0===d,o=[];for(let t=0;t<a;t+=1){const a=!n&&r&&0===t;let s="";if(n)s=`<th>${e.getColHeader(t-u)}</th>`;else if(a)s=`<th>${e.getRowHeader(d-h)}</th>`;else{const r=i[d][t],{hidden:n,rowspan:o,colspan:a}=e.getCellMeta(d-h,t-u);if(!n){const e=[];if(o&&e.push(`rowspan="${o}"`),a&&e.push(`colspan="${a}"`),Fi(r))s=`<td ${e.join(" ")}></td>`;else{const t=r.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,"<br>\r\n").replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");s=`<td ${e.join(" ")}>${t}</td>`}}}o.push(s)}const s=["<tr>",...o,"</tr>"].join("");n?l.splice(1,0,s):c.splice(-1,0,s)}return s.splice(1,0,l.join(""),c.join("")),s.join("")}function Ba(e){const t=e.length,r=["<table>"];for(let n=0;n<t;n+=1){const i=e[n],o=i.length,a=[];0===n&&r.push("<tbody>");for(let e=0;e<o;e+=1){const t=i[e],r=Fi(t)?"":t.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,"<br>\r\n").replace(/\x20{2,}/gi,(e=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(e.length-1)} </span>`)).replace(/\t/gi,"&#9;");a.push(`<td>${r}</td>`)}r.push("<tr>",...a,"</tr>"),n+1===t&&r.push("</tbody>")}return r.push("</table>"),r.join("")}function Ua(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const r=typeof e;if("number"===r)return!isNaN(e)&&isFinite(e);if("string"===r){if(0===e.length)return!1;if(1===e.length)return/\d/.test(e);const r=Array.from(new Set([".",...t])).map((e=>`\\${e}`)).join("|");return new RegExp(`^[+-]?(((${r})?\\d+((${r})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(e.trim())}return"object"===r&&(!!e&&"number"===typeof e.valueOf()&&!(e instanceof Date))}function ja(e,t,r){let n=-1;for("function"===typeof t?(r=t,t=e):n=e-1;++n<=t&&!1!==r(n););}function Wa(e,t,r){let n=e+1;for("function"===typeof t&&(r=t,t=0);--n>=t&&!1!==r(n););}function Va(e,t){return t=parseInt(t.toString().replace("%",""),10),t=isNaN(t)?0:t,parseInt(e*t/100,10)}function za(e,t,r){return Math.min(e,t)===e?t:Math.max(e,r)===e?r:e}const qa="asc",Ga=new Map([[qa,[-1,1]],["desc",[1,-1]]]),$a=e=>`The priority '${e}' is already declared in a map.`,Ka=e=>`The priority '${e}' is not a number.`;const Ya=e=>`The id '${e}' is already declared in a map.`;function Xa(){let{errorIdExists:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=new Map;function r(){return[...t]}function n(e){return t.has(e)}return e=Yi(e)?e:Ya,{addItem:function(r,i){if(n(r))throw new Error(e(r));t.set(r,i)},clear:function(){t.clear()},getId:function(e){const[t]=r().find((t=>{let[r,n]=t;return e===n&&r}))||[null];return t},getItem:function(e){return t.get(e)},getItems:r,hasItem:n,removeItem:function(e){return t.delete(e)}}}const Ja=e=>`'${e}' value is already declared in a unique set.`;const Za=e=>`There is already registered "${e}" plugin.`,Qa=function(){let{errorPriorityExists:e,errorPriorityNaN:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const r=new Map;return e=Yi(e)?e:$a,t=Yi(t)?t:Ka,{addItem:function(n,i){if(!Ua(n))throw new Error(t(n));if(r.has(n))throw new Error(e(n));r.set(n,i)},getItems:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:qa;const[t,n]=Ga.get(e)||Ga.get(qa);return[...r].sort(((e,r)=>e[0]<r[0]?t:n)).map((e=>e[1]))}}}({errorPriorityExists:e=>`There is already registered plugin on priority "${e}".`,errorPriorityNaN:e=>`The priority "${e}" is not a number.`}),es=function(){let{errorItemExists:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=new Set;return e=Yi(e)?e:Ja,{addItem:function(r){if(t.has(r))throw new Error(e(r));t.add(r)},clear:function(){t.clear()},getItems:function(){return[...t]}}}({errorItemExists:Za}),ts=Xa({errorIdExists:Za});function rs(){return[...Qa.getItems(),...es.getItems()]}function ns(e){const t=un(e);return ts.getItem(t)}function is(e,t,r){[e,t,r]=function(e,t,r){"function"===typeof e&&(e=(t=e).PLUGIN_KEY,r=t.PLUGIN_PRIORITY);return[e,t,r]}(e,t,r),void 0===ns(e)&&function(e,t,r){const n=un(e);if(ts.hasItem(n))throw new Error(Za(n));void 0===r?es.addItem(n):Qa.addItem(r,n);ts.addItem(n,t)}(e,t,r)}const{register:os,getItem:as,hasItem:ss,getNames:ls,getValues:cs}=Xo("renderers");function us(e){if("function"===typeof e)return e;if(!ss(e))throw Error(`No registered renderer found under "${e}" name`);return as(e)}function hs(e,t){"string"!==typeof e&&(e=(t=e).RENDERER_TYPE),os(e,t)}const{register:ds,getItem:fs,hasItem:gs,getNames:ps,getValues:ms}=Xo("validators");function vs(e,t){"string"!==typeof e&&(e=(t=e).VALIDATOR_TYPE),ds(e,t)}function bs(e,t,r){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,r)}function ys(e,t){return e.get(Ss(e,t))}function ws(e,t,r){return e.set(Ss(e,t),r),r}function Ss(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var Cs=new WeakMap,ks=new WeakMap,xs=new WeakMap,Es=new WeakMap,Ts=new WeakMap,_s=new WeakMap,As=new WeakMap,Rs=new WeakMap,Os=new WeakMap,Ms=new WeakMap;const Is=class{constructor(e,t,r,n,i,o){let a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;bs(this,Cs,void 0),bs(this,ks,void 0),bs(this,xs,void 0),bs(this,Es,void 0),bs(this,Ts,void 0),bs(this,_s,void 0),bs(this,As,void 0),bs(this,Rs,void 0),bs(this,Os,[null,null]),bs(this,Ms,[null,null]),ws(Cs,this,r),ws(ks,this,t),ws(xs,this,i),ws(Es,this,o),ws(Ts,this,a),ws(_s,this,n),ws(As,this,e),this.registerEvents()}registerEvents(){ys(_s,this).addEventListener(ys(xs,this).holder,"contextmenu",(e=>this.onContextMenu(e))),ys(_s,this).addEventListener(ys(xs,this).TABLE,"mouseover",(e=>this.onMouseOver(e))),ys(_s,this).addEventListener(ys(xs,this).TABLE,"mouseout",(e=>this.onMouseOut(e)));const e=()=>{ys(_s,this).addEventListener(ys(xs,this).holder,"touchstart",(e=>this.onTouchStart(e))),ys(_s,this).addEventListener(ys(xs,this).holder,"touchend",(e=>this.onTouchEnd(e))),this.momentumScrolling||(this.momentumScrolling={}),ys(_s,this).addEventListener(ys(xs,this).holder,"scroll",(()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||ys(Cs,this).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout((()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,ys(Cs,this).getSetting("onAfterMomentumScroll"))}),200)}))},t=()=>{ys(_s,this).addEventListener(ys(xs,this).holder,"mouseup",(e=>this.onMouseUp(e))),ys(_s,this).addEventListener(ys(xs,this).holder,"mousedown",(e=>this.onMouseDown(e)))};Eo()?e():(vo()&&e(),t())}selectedCellWasTouched(e){const t=this.parentCell(e).coords;if(ys(Rs,this)&&t){const[e,r]=[t.row,ys(Rs,this).from.row],[n,i]=[t.col,ys(Rs,this).from.col];return e===r&&n===i}return!1}parentCell(e){const t={},r=Dn(e,["TD","TH"],ys(xs,this).TABLE);return r?(t.coords=ys(xs,this).getCoords(r),t.TD=r):Un(e,"wtBorder")&&Un(e,"current")?(t.coords=ys(Es,this).getFocusSelection().cellRange.highlight,t.TD=ys(xs,this).getCell(t.coords)):Un(e,"wtBorder")&&Un(e,"area")&&ys(Es,this).getAreaSelection().cellRange&&(t.coords=ys(Es,this).getAreaSelection().cellRange.to,t.TD=ys(xs,this).getCell(t.coords)),t}onMouseDown(e){const t=ys(ks,this).rootDocument.activeElement,r=Ji(In,e.target),n=e.target;if(!["TD","TH"].includes(t.nodeName)&&(n===t||r(0)===t||r(1)===t))return;const i=this.parentCell(n);Un(n,"corner")?ys(Cs,this).getSetting("onCellCornerMouseDown",e,n):i.TD&&ys(Cs,this).has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,i.coords,i.TD),(0===e.button||this.touchApplied)&&i.TD&&(ys(Ms,this)[0]=i.TD,clearTimeout(ys(Os,this)[0]),ys(Os,this)[0]=setTimeout((()=>{ys(Ms,this)[0]=null}),1e3))}onContextMenu(e){if(ys(Cs,this).has("onCellContextMenu")){const t=this.parentCell(e.target);t.TD&&this.callListener("onCellContextMenu",e,t.coords,t.TD)}}onMouseOver(e){if(!ys(Cs,this).has("onCellMouseOver"))return;const t=ys(xs,this).TABLE,r=Dn(e.target,["TD","TH"],t),n=ys(Ts,this)||this;r&&r!==n.lastMouseOver&&Fn(r,t)&&(n.lastMouseOver=r,this.callListener("onCellMouseOver",e,ys(xs,this).getCoords(r),r))}onMouseOut(e){if(!ys(Cs,this).has("onCellMouseOut"))return;const t=ys(xs,this).TABLE,r=Dn(e.target,["TD","TH"],t),n=Dn(e.relatedTarget,["TD","TH"],t),i=ys(Ts,this)||this;r&&r!==n&&Fn(r,t)&&(this.callListener("onCellMouseOut",e,ys(xs,this).getCoords(r),r),null===n&&(i.lastMouseOver=null))}onMouseUp(e){const t=this.parentCell(e.target);t.TD&&ys(Cs,this).has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,t.coords,t.TD),(0===e.button||this.touchApplied)&&(t.TD===ys(Ms,this)[0]&&t.TD===ys(Ms,this)[1]?(Un(e.target,"corner")?this.callListener("onCellCornerDblClick",e,t.coords,t.TD):this.callListener("onCellDblClick",e,t.coords,t.TD),ys(Ms,this)[0]=null,ys(Ms,this)[1]=null):t.TD===ys(Ms,this)[0]&&(ys(Ms,this)[1]=t.TD,clearTimeout(ys(Os,this)[1]),ys(Os,this)[1]=setTimeout((()=>{ys(Ms,this)[1]=null}),500)))}onTouchStart(e){ws(Rs,this,ys(Es,this).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var t;const r=e.target,n=null===(t=this.parentCell(r))||void 0===t?void 0:t.coords,i=Ni(n)&&n.row>=0&&n.col>=0;if(e.cancelable&&i&&ys(Cs,this).getSetting("isDataViewInstance")){const t=["A","BUTTON","INPUT"];To()&&(wo.chromeWebKit.value||wo.firefoxWebKit.value)&&this.selectedCellWasTouched(r)&&!t.includes(r.tagName)?e.preventDefault():this.selectedCellWasTouched(r)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,t,r,n){const i=ys(Cs,this).getSettingPure(e);i&&i(t,r,n,ys(As,this).call(this))}destroy(){clearTimeout(ys(Os,this)[0]),clearTimeout(ys(Os,this)[1]),ys(_s,this).destroy()}};function Ps(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const Ns=class{constructor(e,t,r){Ps(this,"offset",void 0),Ps(this,"total",void 0),Ps(this,"countTH",void 0),this.offset=e,this.total=t,this.countTH=r}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}};function Ds(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const Fs=class{constructor(e,t,r){Ds(this,"offset",void 0),Ds(this,"total",void 0),Ds(this,"countTH",void 0),this.offset=e,this.total=t,this.countTH=r}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}};function Ls(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Hs{constructor(){Ls(this,"currentSize",0),Ls(this,"nextSize",0),Ls(this,"currentOffset",0),Ls(this,"nextOffset",0)}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}function Bs(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Us{constructor(){Bs(this,"size",new Hs),Bs(this,"workingSpace",0),Bs(this,"sharedSize",null)}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize instanceof Hs}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=1,e.workingSpace=2,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=2,e.workingSpace=1,this.sharedSize=e.getViewSize()}}function js(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Ws{constructor(e,t,r){js(this,"rootNode",void 0),js(this,"nodesPool",void 0),js(this,"sizeSet",new Us),js(this,"childNodeType",void 0),js(this,"visualIndex",0),js(this,"collectedNodes",[]),this.rootNode=e,this.nodesPool=t,this.childNodeType=r.toUpperCase()}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){const e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}getRenderedChildCount(){const{rootNode:e,sizeSet:t}=this;let r=0;if(this.isSharedViewSet()){let n=e.firstElementChild;for(;n;){if(n.tagName===this.childNodeType)r+=1;else if(t.isPlaceOn(1))break;n=n.nextElementSibling}}else r=e.childElementCount;return r}start(){this.collectedNodes.length=0,this.visualIndex=0;const{rootNode:e,sizeSet:t}=this,r=this.isSharedViewSet(),{nextSize:n}=t.getViewSize();let i=this.getRenderedChildCount();for(;i<n;){const n=this.nodesPool();!r||r&&t.isPlaceOn(2)?e.appendChild(n):e.insertBefore(n,e.firstChild),i+=1}const o=r&&t.isPlaceOn(1);for(;i>n;)e.removeChild(o?e.firstChild:e.lastChild),i-=1}render(){const{rootNode:e,sizeSet:t}=this;let r=this.visualIndex;this.isSharedViewSet()&&t.isPlaceOn(2)&&(r+=t.sharedSize.nextSize);let n=e.childNodes[r];if(n.tagName!==this.childNodeType){const t=this.nodesPool();e.replaceChild(t,n),n=t}this.collectedNodes.push(n),this.visualIndex+=1}end(){}}class Vs extends Ws{prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}function zs(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class qs{constructor(e){zs(this,"nodeType",void 0),this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(){return this.rootDocument.createElement(this.nodeType)}}function Gs(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class $s{constructor(e,t){Gs(this,"nodesPool",null),Gs(this,"nodeType",void 0),Gs(this,"rootNode",void 0),Gs(this,"table",null),Gs(this,"renderedNodes",0),this.nodesPool="string"===typeof e?new qs(e):null,this.nodeType=e,this.rootNode=t}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}}function Ks(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Ys extends $s{constructor(){super("TH"),Ks(this,"orderViews",new WeakMap),Ks(this,"sourceRowIndex",0)}obtainOrderView(e){let t;return this.orderViews.has(e)?t=this.orderViews.get(e):(t=new Vs(e,(e=>this.nodesPool.obtain(this.sourceRowIndex,e)),this.nodeType),this.orderViews.set(e,t)),t}render(){const{rowsToRender:e,rowHeaderFunctions:t,rowHeadersCount:r,rows:n,cells:i}=this.table;for(let o=0;o<e;o++){const e=this.table.renderedRowToSource(o),a=n.getRenderedNode(o);this.sourceRowIndex=e;const s=this.obtainOrderView(a),l=i.obtainOrderView(a);s.appendView(l).setSize(r).setOffset(this.table.renderedColumnToSource(0)).start();for(let n=0;n<r;n++){s.render();const r=s.getCurrentNode();r.className="",r.removeAttribute("style"),zn(r,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Vn(r,[["role","rowheader"],["scope","row"],En(n+1),mn(-1)]),t[n](e,r,n)}s.end()}}}class Xs extends $s{constructor(e){super(null,e)}adjust(){const{columnHeadersCount:e,rowHeadersCount:t}=this.table;let r=this.rootNode.firstChild;if(e){const{columnsToRender:n}=this.table,i=n+t;for(let t=0,a=e;t<a;t++){for(r=this.rootNode.childNodes[t],r||(r=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(r)),this.renderedNodes=r.childNodes.length;this.renderedNodes<i;)r.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>i;)r.removeChild(r.lastChild),this.renderedNodes-=1}const o=this.rootNode.childNodes.length;if(o>e)for(let t=e;t<o;t++)this.rootNode.removeChild(this.rootNode.lastChild)}else r&&Gn(r)}render(){const{columnHeadersCount:e}=this.table;this.table.isAriaEnabled()&&Vn(this.rootNode,[["role","rowgroup"]]);for(let t=0;t<e;t+=1){const{columnHeaderFunctions:e,columnsToRender:r,rowHeadersCount:n}=this.table,i=this.rootNode.childNodes[t];this.table.isAriaEnabled()&&Vn(i,[["role","row"],xn(t+1)]);for(let o=-1*n;o<r;o+=1){const r=this.table.renderedColumnToSource(o),a=i.childNodes[o+n];a.className="",a.removeAttribute("style"),zn(a,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&Vn(a,[En(o+1+this.table.rowHeadersCount),mn(-1),["role","columnheader"],...o>=0?[["scope","col"]]:[["role","row"]]]),e[t](r,a,t)}}}}let Js=!1;class Zs extends $s{constructor(e){super(null,e)}adjust(){const{columnsToRender:e,rowHeadersCount:t}=this.table,r=e+t;for(;this.renderedNodes<r;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>r;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:e,rowHeadersCount:t}=this.table;!Js&&e>1e3&&(Js=!0,Ho(Ii`Performance tip: Handsontable rendered more than 1000 visible columns.\x20
        Consider limiting the number of rendered columns by specifying the table width and/or\x20
        turning off the "renderAllColumns" option.`));for(let n=0;n<t;n++){const e=this.table.renderedColumnToSource(n),t=this.table.columnUtils.getHeaderWidth(e);this.rootNode.childNodes[n].style.width=`${t}px`}for(let n=0;n<e;n++){const e=this.table.renderedColumnToSource(n),r=this.table.columnUtils.getStretchedColumnWidth(e);this.rootNode.childNodes[n+t].style.width=`${r}px`}const r=this.rootNode.firstChild;r&&jn(r,"rowHeader")}}function Qs(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}let el=!1;class tl extends $s{constructor(e){super("TR",e),Qs(this,"orderView",void 0),this.orderView=new Ws(e,(e=>this.nodesPool.obtain(e)),this.nodeType)}getRenderedNode(e){return this.orderView.getNode(e)}render(){const{rowsToRender:e}=this.table;!el&&e>1e3&&(el=!0,Ho(Ii`Performance tip: Handsontable rendered more than 1000 visible rows.\x20
        Consider limiting the number of rendered rows by specifying the table height and/or\x20
        turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&Vn(this.rootNode,[["role","rowgroup"]]),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let n=0;n<e;n++){this.orderView.render();const e=this.orderView.getCurrentNode(),i=this.table.renderedRowToSource(n);var t,r;if(this.table.isAriaEnabled())Vn(e,[["role","row"],xn(i+(null!==(t=null===(r=this.table.rowUtils)||void 0===r||null===(r=r.dataAccessObject)||void 0===r?void 0:r.columnHeaders.length)&&void 0!==t?t:0)+1)])}this.orderView.end()}}function rl(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class nl extends $s{constructor(){super("TD"),rl(this,"orderViews",new WeakMap),rl(this,"sourceRowIndex",0)}obtainOrderView(e){let t;return this.orderViews.has(e)?t=this.orderViews.get(e):(t=new Vs(e,(e=>this.nodesPool.obtain(this.sourceRowIndex,e)),this.nodeType),this.orderViews.set(e,t)),t}render(){const{rowsToRender:e,columnsToRender:t,rows:r,rowHeaders:n}=this.table;for(let a=0;a<e;a++){const e=this.table.renderedRowToSource(a),s=r.getRenderedNode(a);this.sourceRowIndex=e;const l=this.obtainOrderView(s),c=n.obtainOrderView(s);l.prependView(c).setSize(t).setOffset(this.table.renderedColumnToSource(0)).start();for(let r=0;r<t;r++){l.render();const t=l.getCurrentNode(),n=this.table.renderedColumnToSource(r);var i,o;if(Un(t,"hide")||(t.className=""),t.removeAttribute("style"),t.removeAttribute("dir"),zn(t,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(e,n,t),this.table.isAriaEnabled())Vn(t,[...t.hasAttribute("role")?[]:[["role","gridcell"]],mn(-1),En(n+(null!==(i=null===(o=this.table.rowUtils)||void 0===o||null===(o=o.dataAccessObject)||void 0===o?void 0:o.rowHeaders.length)&&void 0!==i?i:0)+1)])}l.end()}}}function il(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class ol{constructor(e){let{cellRenderer:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};il(this,"rootNode",void 0),il(this,"rootDocument",void 0),il(this,"rowHeaders",null),il(this,"columnHeaders",null),il(this,"colGroup",null),il(this,"rows",null),il(this,"cells",null),il(this,"rowFilter",null),il(this,"columnFilter",null),il(this,"rowUtils",null),il(this,"columnUtils",null),il(this,"rowsToRender",0),il(this,"columnsToRender",0),il(this,"rowHeaderFunctions",[]),il(this,"rowHeadersCount",0),il(this,"columnHeaderFunctions",[]),il(this,"columnHeadersCount",0),il(this,"cellRenderer",void 0),il(this,"activeOverlayName",void 0),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=t}setActiveOverlayName(e){this.activeOverlayName=e}setAxisUtils(e,t){this.rowUtils=e,this.columnUtils=t}setViewportSize(e,t){this.rowsToRender=e,this.columnsToRender=t}setFilters(e,t){this.rowFilter=e,this.columnFilter=t}setHeaderContentRenderers(e,t){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=t,this.columnHeadersCount=t.length}setRenderers(){let{rowHeaders:e,columnHeaders:t,colGroup:r,rows:n,cells:i}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.setTable(this),t.setTable(this),r.setTable(this),n.setTable(this),i.setTable(this),this.rowHeaders=e,this.columnHeaders=t,this.colGroup=r,this.rows=n,this.cells=i}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:e,rows:t}=this;for(let r=0;r<e;r++){const e=t.getRenderedNode(r);if(e.firstChild){const t=this.renderedRowToSource(r),n=this.rowUtils.getHeightByOverlayName(t,this.activeOverlayName);e.firstChild.style.height=n?n-1+"px":""}}}}class al{constructor(){let{TABLE:e,THEAD:t,COLGROUP:r,TBODY:n,rowUtils:i,columnUtils:o,cellRenderer:a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.renderer=new ol(e,{cellRenderer:a}),this.renderer.setRenderers({rowHeaders:new Ys,columnHeaders:new Xs(t),colGroup:new Zs(r),rows:new tl(n),cells:new nl}),this.renderer.setAxisUtils(i,o)}setActiveOverlayName(e){return this.renderer.setActiveOverlayName(e),this}setFilters(e,t){return this.renderer.setFilters(e,t),this}setViewportSize(e,t){return this.renderer.setViewportSize(e,t),this}setHeaderContentRenderers(e,t){return this.renderer.setHeaderContentRenderers(e,t),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function sl(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class ll{constructor(e){sl(this,"calculationTypes",[]),sl(this,"calculationResults",new Map),this.calculationTypes=e}_initialize(e){this.calculationTypes.forEach((t=>{let[r,n]=t;this.calculationResults.set(r,n),n.initialize(e)}))}_process(e,t){this.calculationTypes.forEach((r=>{let[,n]=r;return n.process(e,t)}))}_finalize(e){this.calculationTypes.forEach((t=>{let[,r]=t;return r.finalize(e)}))}getResultsFor(e){return this.calculationResults.get(e)}}function cl(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const ul=50;class hl extends ll{constructor(e){let{calculationTypes:t,viewportWidth:r,scrollOffset:n,totalColumns:i,columnWidthFn:o,overrideFn:a,inlineStartOffset:s}=e;super(t),cl(this,"viewportWidth",0),cl(this,"scrollOffset",0),cl(this,"zeroBasedScrollOffset",0),cl(this,"totalColumns",0),cl(this,"columnWidthFn",null),cl(this,"columnWidth",0),cl(this,"overrideFn",null),cl(this,"inlineStartOffset",0),cl(this,"totalCalculatedWidth",0),cl(this,"startPositions",[]),cl(this,"needReverse",!0),this.viewportWidth=r,this.scrollOffset=n,this.zeroBasedScrollOffset=Math.max(n,0),this.totalColumns=i,this.columnWidthFn=o,this.overrideFn=a,this.inlineStartOffset=s,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalColumns;e++)if(this.columnWidth=this.getColumnWidth(e),this._process(e,this),this.startPositions.push(this.totalCalculatedWidth),this.totalCalculatedWidth+=this.columnWidth,this.totalCalculatedWidth>=this.zeroBasedScrollOffset+this.viewportWidth){this.needReverse=!1;break}this._finalize(this)}getColumnWidth(e){const t=this.columnWidthFn(e);return isNaN(t)?ul:t}}function dl(e,t,r){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,r)}function fl(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function gl(e,t){return e.get(ml(e,t))}function pl(e,t,r){return e.set(ml(e,t),r),r}function ml(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var vl=new WeakMap,bl=new WeakMap,yl=new WeakMap,wl=new WeakMap,Sl=new WeakMap;class Cl{constructor(e){let{totalColumns:t,stretchMode:r,stretchingColumnWidthFn:n,columnWidthFn:i}=e;fl(this,"stretchAllRatio",0),fl(this,"stretchLastWidth",0),fl(this,"stretchAllColumnsWidth",[]),dl(this,vl,0),fl(this,"needVerifyLastColumnWidth",!0),dl(this,bl,(()=>0)),dl(this,yl,(e=>e)),dl(this,wl,(e=>e)),dl(this,Sl,(()=>"none")),pl(bl,this,t),pl(Sl,this,r),pl(yl,this,null!==n&&void 0!==n?n:gl(yl,this)),pl(wl,this,null!==i&&void 0!==i?i:gl(wl,this))}refreshStretching(e){if("none"===gl(Sl,this).call(this))return;this.stretchAllRatio=0,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0,this.stretchLastWidth=0,pl(vl,this,e);let t=0;for(let n=0;n<gl(bl,this).call(this);n++){const r=this._getColumnWidth(n),i=gl(yl,this).call(this,void 0,n);"number"===typeof i?e-=i:t+=r}const r=e-t;if("all"===gl(Sl,this).call(this)&&r>0)this.stretchAllRatio=e/t,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if("last"===gl(Sl,this).call(this)&&e!==1/0){const e=this._getColumnWidth(gl(bl,this).call(this)-1),t=r+e;this.stretchLastWidth=t>=0?t:e}}getStretchedColumnWidth(e,t){let r=null;return"all"===gl(Sl,this).call(this)&&0!==this.stretchAllRatio?r=this._getStretchedAllColumnWidth(e,t):"last"===gl(Sl,this).call(this)&&0!==this.stretchLastWidth&&(r=this._getStretchedLastColumnWidth(e)),r}_getStretchedAllColumnWidth(e,t){let r=0;if(!this.stretchAllColumnsWidth[e]){const r=Math.round(t*this.stretchAllRatio),n=gl(yl,this).call(this,r,e);this.stretchAllColumnsWidth[e]=void 0===n?r:isNaN(n)?this._getColumnWidth(e):n}if(this.stretchAllColumnsWidth.length===gl(bl,this).call(this)&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(let e=0;e<this.stretchAllColumnsWidth.length;e++)r+=this.stretchAllColumnsWidth[e];r!==gl(vl,this)&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=gl(vl,this)-r)}return this.stretchAllColumnsWidth[e]}_getStretchedLastColumnWidth(e){return e===gl(bl,this).call(this)-1?this.stretchLastWidth:null}_getColumnWidth(e){let t=gl(wl,this).call(this,e);return isNaN(t)&&(t=ul),t}}function kl(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class xl{constructor(e,t){kl(this,"dataAccessObject",void 0),kl(this,"wtSettings",void 0),kl(this,"headerWidths",new Map),kl(this,"stretching",void 0),this.dataAccessObject=e,this.wtSettings=t,this.stretching=new Cl({totalColumns:()=>this.wtSettings.getSetting("totalColumns"),stretchMode:()=>this.wtSettings.getSetting("stretchH"),stretchingColumnWidthFn:(e,t)=>this.wtSettings.getSetting("onBeforeStretchingColumnWidth",e,t),columnWidthFn:e=>this.dataAccessObject.wtTable.getColumnWidth(e)})}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getStretchedColumnWidth(e){let t=this.getWidth(e);const r=this.stretching.getStretchedColumnWidth(e,t);return r&&(t=r),t}getHeaderHeight(e){let t=this.wtSettings.getSetting("defaultRowHeight");const r=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return void 0!==r&&(t=t?Math.max(t,r):r),t}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}refreshStretching(){const{wtTable:e,wtViewport:t,cloneSource:r}=this.dataAccessObject,n=r?r.wtTable.holder:e.holder,i=n.offsetHeight<n.scrollHeight?gi():0;this.stretching.refreshStretching(t.getViewportWidth()-i)}calculateWidths(){const{wtSettings:e}=this;let t=e.getSetting("rowHeaderWidth");if(this.refreshStretching(),t=e.getSetting("onModifyRowHeaderWidth",t),null!==t&&void 0!==t){const r=e.getSetting("rowHeaders").length,n=e.getSetting("defaultColumnWidth");for(let e=0;e<r;e++){let r=Array.isArray(t)?t[e]:t;r=null===r||void 0===r?n:r,this.headerWidths.set(e,r)}}}}function El(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Tl{constructor(e,t){El(this,"dataAccessObject",void 0),El(this,"wtSettings",void 0),this.dataAccessObject=e,this.wtSettings=t}getHeight(e){let t=this.wtSettings.getSetting("rowHeight",e);const r=this.dataAccessObject.wtViewport.oversizedRows[e];return void 0!==r&&(t=void 0===t?r:Math.max(t,r)),t}getHeightByOverlayName(e,t){let r=this.wtSettings.getSetting("rowHeightByOverlayName",e,t);const n=this.dataAccessObject.wtViewport.oversizedRows[e];return void 0!==n&&(r=void 0===r?n:Math.max(r,n)),r}}const _l="top",Al="bottom",Rl="inline_start",Ol="top_inline_start_corner",Ml="bottom_inline_start_corner",Il=[_l,Al,Rl,Ol,Ml],Pl=new Map([[_l,`ht_clone_${_l}`],[Al,`ht_clone_${Al}`],[Rl,`ht_clone_${Rl} ht_clone_left`],[Ol,`ht_clone_${Ol} ht_clone_top_left_corner`],[Ml,`ht_clone_${Ml} ht_clone_bottom_left_corner`]]);function Nl(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const Dl=class{constructor(e,t,r,n,i){Nl(this,"wtSettings",null),Nl(this,"domBindings",void 0),Nl(this,"TBODY",null),Nl(this,"THEAD",null),Nl(this,"COLGROUP",null),Nl(this,"hasTableHeight",!0),Nl(this,"hasTableWidth",!0),Nl(this,"isTableVisible",!1),Nl(this,"tableOffset",0),Nl(this,"holderOffset",0),this.domBindings=r,this.isMaster="master"===i,this.name=i,this.dataAccessObject=e,this.facadeGetter=t,this.wtSettings=n,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=r.rootTable,qn(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const o=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",(()=>this._modifyRowHeaderWidth(o))),this.rowUtils=new Tl(this.dataAccessObject,this.wtSettings),this.columnUtils=new xl(this.dataAccessObject,this.wtSettings),this.tableRenderer=new al({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer")})}is(e){return this.name===e}fixTableDomTree(){const e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){const t=e.parentNode;let r;return t&&t.nodeType===Node.ELEMENT_NODE&&Un(t,"wtHolder")||(r=this.domBindings.rootDocument.createElement("div"),r.className="wtSpreader",t&&t.insertBefore(r,e),r.appendChild(e)),r.style.position="relative",this.wtSettings.getSetting("ariaTags")&&Vn(r,[vn()]),r}createHider(e){const t=e.parentNode;let r;return t&&t.nodeType===Node.ELEMENT_NODE&&Un(t,"wtHolder")||(r=this.domBindings.rootDocument.createElement("div"),r.className="wtHider",t&&t.insertBefore(r,e),r.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&Vn(r,[vn()]),r}createHolder(e){const t=e.parentNode;let r;return t&&t.nodeType===Node.ELEMENT_NODE&&Un(t,"wtHolder")||(r=this.domBindings.rootDocument.createElement("div"),r.style.position="relative",r.className="wtHolder",t&&t.insertBefore(r,e),this.isMaster&&(r.parentNode.className+="ht_master handsontable",r.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&Vn(r.parentNode,[vn()])),r.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&Vn(r,[vn()]),r}draw(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const{wtSettings:t}=this,{wtOverlays:r,wtViewport:n}=this.dataAccessObject,i=t.getSetting("totalRows"),o=t.getSetting("totalColumns"),a=t.getSetting("rowHeaders"),s=a.length,l=t.getSetting("columnHeaders"),c=l.length;let u=e;if(this.isMaster&&(r.beforeDraw(),this.holderOffset=Jn(this.holder),u=n.createCalculators(u),s&&!t.getSetting("fixedColumnsStart"))){const e=r.inlineStartOverlay.getScrollPosition(),t=this.correctHeaderWidth;this.correctHeaderWidth=0!==e,t!==this.correctHeaderWidth&&(u=!1)}if(u)this.isMaster&&r.refresh(!0);else{this.isMaster?this.tableOffset=Jn(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const e=i>0?this.getFirstRenderedRow():0,t=o>0?this.getFirstRenderedColumn():0;this.rowFilter=new Fs(e,i,c),this.columnFilter=new Ns(t,o,s);let u=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const e={};this.wtSettings.getSetting("beforeDraw",!0,e),u=!0!==e.skipRender}if(u){let e;if(this.tableRenderer.setHeaderContentRenderers(a,l),(this.is(Al)||this.is(Ml))&&this.tableRenderer.setHeaderContentRenderers(a,[]),this.resetOversizedRows(),this.tableRenderer.setActiveOverlayName(this.name).setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),this.isMaster&&(e=this.dataAccessObject.workspaceWidth,n.containerWidth=null,this.markOversizedColumnHeaders()),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(Al))&&this.markOversizedRows(),this.isMaster){this.wtSettings.getSetting("externalRowCalculator")||n.createVisibleCalculators(),r.refresh(!1),r.applyToDOM();const t=ai(this.hider),i=ai(this.TABLE);0!==t&&i!==t&&(this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),e!==n.getWorkspaceWidth()&&(n.containerWidth=null,this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),this.wtSettings.getSetting("onDraw",!0)}else this.is(Al)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize()}}let h=!1;return this.isMaster&&(h=r.topOverlay.resetFixedPosition(),r.bottomOverlay.clone&&(h=r.bottomOverlay.resetFixedPosition()||h),h=r.inlineStartOverlay.resetFixedPosition()||h,r.topInlineStartCornerOverlay&&r.topInlineStartCornerOverlay.resetFixedPosition(),r.bottomInlineStartCornerOverlay&&r.bottomInlineStartCornerOverlay.clone&&r.bottomInlineStartCornerOverlay.resetFixedPosition()),h?(r.refreshAll(),r.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(u),this.isMaster&&r.afterDraw(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){const t=this.columnFilter.renderedToSource(e);let r=this.wtSettings.getSetting("columnHeaders").length;const n=this.wtSettings.getSetting("defaultRowHeight");let i,o,a;const s=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;r;)r-=1,i=this.getColumnHeaderHeight(r),o=this.getColumnHeader(t,r),o&&(a=li(o),(!i&&n<a||i<a)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=a),Array.isArray(s)?null!==s[r]&&void 0!==s[r]&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=s[r]):isNaN(s)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=s),this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]<(s[r]||s)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[r]=s[r]||s))}adjustColumnHeaderHeights(){const{wtSettings:e}=this,t=this.THEAD.childNodes,r=this.dataAccessObject.wtViewport.oversizedColumnHeaders;for(let n=0,i=e.getSetting("columnHeaders").length;n<i;n++)if(r[n]){if(!t[n]||0===t[n].childNodes.length)return;t[n].childNodes[0].style.height=`${r[n]}px`}}resetOversizedRows(){const{wtSettings:e}=this,{wtViewport:t}=this.dataAccessObject;if((this.isMaster||this.is(Al))&&!e.getSetting("externalRowCalculator")){const e=this.getRenderedRowsCount();for(let r=0;r<e;r++){const e=this.rowFilter.renderedToSource(r);t.oversizedRows&&t.oversizedRows[e]&&(t.oversizedRows[e]=void 0)}}}getCell(e){let t=e.row,r=e.col;const n=this.wtSettings.getSetting("onModifyGetCellCoords",t,r);if(n&&Array.isArray(n)&&([t,r]=n),this.isRowBeforeRenderedRows(t))return-1;if(this.isRowAfterRenderedRows(t))return-2;if(this.isColumnBeforeRenderedColumns(r))return-3;if(this.isColumnAfterRenderedColumns(r))return-4;const i=this.getRow(t);if(!i&&t>=0)throw new Error("TR was expected to be rendered but is not");const o=i.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r)];if(!o&&r>=0)throw new Error("TD or TH was expected to be rendered but is not");return o}getRow(e){let t=null,r=null;var n,i;e<0?(t=null===(n=this.rowFilter)||void 0===n?void 0:n.sourceRowToVisibleColHeadedRow(e),r=this.THEAD):(t=null===(i=this.rowFilter)||void 0===i?void 0:i.sourceToRendered(e),r=this.TBODY);return void 0!==t&&void 0!==r&&(!(r.childNodes.length<t+1)&&r.childNodes[t])}getColumnHeader(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const r=this.THEAD.childNodes[t];return null===r||void 0===r?void 0:r.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){const t=[],r=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach((e=>{const n=e.childNodes[r];n&&t.push(n)})),t}getRowHeader(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(t>=this.wtSettings.getSetting("rowHeaders").length)return;const r=this.rowFilter.sourceToRendered(e),n=r<0?this.rowFilter.sourceRowToVisibleColHeadedRow(e):r,i=(r<0?this.THEAD:this.TBODY).childNodes[n];return null===i||void 0===i?void 0:i.childNodes[t]}getRowHeaders(e){const t=[],r=this.wtSettings.getSetting("rowHeaders").length;for(let n=0;n<r;n++){const r=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],i=null===r||void 0===r?void 0:r.childNodes[n];i&&t.push(i)}return t}getCoords(e){let t=e;if("TD"!==t.nodeName&&"TH"!==t.nodeName&&(t=Nn(t,["TD","TH"])),null===t)return null;const r=t.parentNode,n=r.parentNode;let i=function(e){let t=0,r=e;if(r.previousSibling)for(;r=r.previousSibling;)t+=1;return t}(r),o=t.cellIndex;if(Ln(Ol,t,this.wtRootElement)||Ln(_l,t,this.wtRootElement))"THEAD"===n.nodeName&&(i-=n.childNodes.length);else if(Ln(Ml,t,this.wtRootElement)||Ln(Al,t,this.wtRootElement)){i=this.wtSettings.getSetting("totalRows")-n.childNodes.length+i}else i=n===this.THEAD?this.rowFilter.visibleColHeadedRowToSourceRow(i):this.rowFilter.renderedToSource(i);return o=Ln(Ol,t,this.wtRootElement)||Ln(Rl,t,this.wtRootElement)||Ln(Ml,t,this.wtRootElement)?this.columnFilter.offsettedTH(o):this.columnFilter.visibleRowHeadedColumnToSourceColumn(o),this.wot.createCellCoords(i,o)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length;let t,r,n,i,o;if(e*this.wtSettings.getSetting("defaultRowHeight")!==li(this.TBODY)-1||this.wtSettings.getSetting("fixedRowsBottom"))for(;e;)e-=1,n=this.rowFilter.renderedToSource(e),t=this.getRowHeight(n),i=this.getTrForRow(n),o=i.querySelector("th"),r=o?li(o):li(i)-1,(!t&&this.wtSettings.getSetting("defaultRowHeight")<r||t<r)&&(r+=1,this.dataAccessObject.wtViewport.oversizedRows[n]=r)}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;const t=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=t}isRowHeaderRendered(e){if(e>=0)return!1;const t=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=t}isRowBeforeRenderedRows(e){const t=this.getFirstRenderedRow();return e<0&&t<=0?!this.isRowHeaderRendered(e):e<t}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){const t=this.getFirstRenderedColumn();return e<0&&t<=0?!this.isColumnHeaderRendered(e):e<t}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}getStretchedColumnWidth(e){return this.columnUtils.getStretchedColumnWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return ai(this.TABLE)}getHeight(){return si(this.TABLE)}getTotalWidth(){const e=ai(this.hider);return 0!==e?e:this.getWidth()}getTotalHeight(){const e=si(this.hider);return 0!==e?e:this.getHeight()}isVisible(){return Xn(this.TABLE)}_modifyRowHeaderWidth(e){let t=Yi(e)?e():null;return Array.isArray(t)?(t=[...t],t[t.length-1]=this._correctRowHeaderWidth(t[t.length-1])):t=this._correctRowHeaderWidth(t),t}_correctRowHeaderWidth(e){let t=e;return"number"!==typeof e&&(t=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(t+=1),t}},Fl={getFirstRenderedRow(){return 0===this.wtSettings.getSetting("totalRows")?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const e=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),e)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};lo(Fl,"MIXIN_NAME","stickyRowsTop",{writable:!1,enumerable:!1});const Ll=Fl,Hl={getFirstRenderedColumn(){const e=this.dataAccessObject.startColumnRendered;return null===e?-1:e},getFirstVisibleColumn(){const e=this.dataAccessObject.startColumnVisible;return null===e?-1:e},getFirstPartiallyVisibleColumn(){const e=this.dataAccessObject.startColumnPartiallyVisible;return null===e?-1:e},getLastRenderedColumn(){const e=this.dataAccessObject.endColumnRendered;return null===e?-1:e},getLastVisibleColumn(){const e=this.dataAccessObject.endColumnVisible;return null===e?-1:e},getLastPartiallyVisibleColumn(){const e=this.dataAccessObject.endColumnPartiallyVisible;return null===e?-1:e},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};lo(Hl,"MIXIN_NAME","calculatedColumns",{writable:!1,enumerable:!1});const Bl=Hl;class Ul extends Dl{constructor(e,t,r,n){super(e,t,r,n,_l)}}oo(Ul,Ll),oo(Ul,Bl);const jl=Ul;function Wl(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function Vl(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function zl(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var ql=new WeakSet;function Gl(e){const{wtSettings:t,inlineStartOverlay:r,wtTable:n,wtViewport:i,totalColumns:o,rootWindow:a}=this.dataAccessObject;if(r.mainTableScrollableElement===a){let s=null;if(t.getSetting("rtlMode")){const e=n.TABLE.getBoundingClientRect(),t=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;s=Math.abs(e.right-t)}else{s=Jn(n.wtRootElement).left}const l=Math.abs(ti(a,a));if(s>l){const t=ci(a);let n=i.getRowHeaderWidth();for(let i=1;i<=o;i++)if(n+=r.sumCellSizes(i-1,i),s+n-l>=t){e=i-2;break}}}return e}function $l(e){const{topOverlay:t,wtTable:r,wtViewport:n,totalRows:i,rootWindow:o}=this.dataAccessObject;if(t.mainTableScrollableElement===o){const a=Jn(r.wtRootElement),s=ei(o,o);if(a.top>s){const r=li(o);let l=n.getColumnHeaderHeight();for(let n=1;n<=i;n++)if(l+=t.sumCellSizes(n-1,n),a.top+l-s>=r){e=n-2;break}}}return e}const Kl=class{constructor(e){Wl(this,ql),Vl(this,"dataAccessObject",void 0),this.dataAccessObject=e}scrollViewport(e,t,r,n,i){const o=this.scrollViewportHorizontally(e.col,r,i),a=this.scrollViewportVertically(e.row,t,n);return o||a}scrollViewportHorizontally(e,t,r){const{drawn:n,totalColumns:i}=this.dataAccessObject;if(!n||!Number.isInteger(e)||e<0||e>i)return!1;const o=void 0===t&&void 0===r,{fixedColumnsStart:a,inlineStartOverlay:s}=this.dataAccessObject;if(o&&e<a)return!1;if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",e),!Number.isInteger(e)||e<0||e>i)return!1;const l=this.getFirstVisibleColumn(),c=this.getLastVisibleColumn();let u=!1;return(o&&(e<l||e>c)||!o)&&(u=s.scrollTo(e,o?e>=this.getLastPartiallyVisibleColumn():t)),u}scrollViewportVertically(e,t,r){const{drawn:n,totalRows:i}=this.dataAccessObject;if(!n||!Number.isInteger(e)||e<0||e>i)return!1;const o=void 0===t&&void 0===r,{fixedRowsBottom:a,fixedRowsTop:s,topOverlay:l}=this.dataAccessObject;if(o&&(e<s||e>i-a-1))return!1;if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",e),!Number.isInteger(e)||e<0||e>i)return!1;const c=this.getFirstVisibleRow(),u=this.getLastVisibleRow();let h=!1;return(o&&(e<c||e>u)||!o)&&(h=l.scrollTo(e,o?e>=this.getLastPartiallyVisibleRow():r)),h}getFirstVisibleRow(){return this.dataAccessObject.wtTable.getFirstVisibleRow()}getLastVisibleRow(){return zl(ql,this,$l).call(this,this.dataAccessObject.wtTable.getLastVisibleRow())}getFirstPartiallyVisibleRow(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleRow()}getLastPartiallyVisibleRow(){return zl(ql,this,$l).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleRow())}getFirstVisibleColumn(){return this.dataAccessObject.wtTable.getFirstVisibleColumn()}getLastVisibleColumn(){return zl(ql,this,Gl).call(this,this.dataAccessObject.wtTable.getLastVisibleColumn())}getFirstPartiallyVisibleColumn(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleColumn()}getLastPartiallyVisibleColumn(){return zl(ql,this,Gl).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleColumn())}};function Yl(e,t,r){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,r)}function Xl(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Jl(e,t){return e.get(Ql(e,t))}function Zl(e,t,r){return e.set(Ql(e,t),r),r}function Ql(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var ec=new WeakMap;class tc{constructor(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];Xl(this,"row",null),Xl(this,"col",null),Yl(this,ec,!1),Zl(ec,this,r),"undefined"!==typeof e&&"undefined"!==typeof t&&(this.row=e,this.col=t)}isValid(e){const{countRows:t,countCols:r,countRowHeaders:n,countColHeaders:i}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...e};return!(!Number.isInteger(this.row)||!Number.isInteger(this.col))&&(!(this.row<-i||this.col<-n)&&!(this.row>=t||this.col>=r))}isEqual(e){return e===this||this.row===e.row&&this.col===e.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return Jl(ec,this)}isSouthEastOf(e){return this.row>=e.row&&(Jl(ec,this)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&(Jl(ec,this)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&(Jl(ec,this)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&(Jl(ec,this)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=null===this.row?this.row:Math.max(this.row,0),this.col=null===this.col?this.col:Math.max(this.col,0),this}assign(e){return Number.isInteger(null===e||void 0===e?void 0:e.row)&&(this.row=e.row),Number.isInteger(null===e||void 0===e?void 0:e.col)&&(this.col=e.col),e instanceof tc&&Zl(ec,this,e.isRtl()),this}clone(){return new tc(this.row,this.col,Jl(ec,this))}toObject(){return{row:this.row,col:this.col}}}const rc=tc;function nc(e,t,r){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,r)}function ic(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function oc(e,t){return e.get(ac(e,t))}function ac(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var sc=new WeakMap;class lc{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];ic(this,"highlight",null),ic(this,"from",null),ic(this,"to",null),nc(this,sc,!1),this.highlight=e.clone(),this.from=t.clone(),this.to=r.clone(),function(e,t,r){e.set(ac(e,t),r)}(sc,this,n)}setHighlight(e){return this.highlight=e.clone(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}isHeader(){return!(!this.from.isHeader()||!this.to.isHeader())||(this.from.col<0&&this.to.col<0||this.from.row<0&&this.to.row<0)}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const e=Math.max(this.from.row,0),t=Math.max(this.to.row,0);return Math.max(e,t)-Math.min(e,t)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const e=Math.max(this.from.col,0),t=Math.max(this.to.col,0);return Math.max(e,t)-Math.min(e,t)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){const{row:t,col:r}=e,n=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner();return n.row<=t&&i.row>=t&&n.col<=r&&i.col>=r}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopEndCorner().col>=e.getOuterTopStartCorner().col&&this.getOuterTopEndCorner().col<=e.getOuterTopEndCorner().col||this.getOuterTopStartCorner().col<=e.getOuterTopEndCorner().col&&this.getOuterTopStartCorner().col>=e.getOuterTopStartCorner().col}isOverlappingVertically(e){return this.getOuterBottomStartCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomStartCorner().row<=e.getOuterBottomStartCorner().row||this.getOuterTopEndCorner().row<=e.getOuterBottomStartCorner().row&&this.getOuterTopEndCorner().row>=e.getOuterTopRightCorner().row}expand(e){const t=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();return(e.row<t.row||e.col<t.col||e.row>r.row||e.col>r.col)&&(this.from=this._createCellCoords(Math.min(t.row,e.row),Math.min(t.col,e.col)),this.to=this._createCellCoords(Math.max(r.row,e.row),Math.max(r.col,e.col)),!0)}expandByRange(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.includesRange(e)||!this.overlaps(e))return!1;const r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),i=this.getDirection(),o=e.getOuterTopStartCorner(),a=e.getOuterBottomEndCorner(),s=Math.min(r.row,o.row),l=Math.min(r.col,o.col),c=Math.max(n.row,a.row),u=Math.max(n.col,a.col),h=this._createCellCoords(s,l),d=this._createCellCoords(c,u);return this.from=h,this.to=d,this.setDirection(i),t&&(this.highlight.row===this.getOuterBottomRightCorner().row&&"N-S"===this.getVerticalDirection()&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&"W-E"===this.getHorizontalDirection()&&this.flipDirectionHorizontally()),!0}getDirection(){return this.from.isNorthWestOf(this.to)?"NW-SE":this.from.isNorthEastOf(this.to)?"NE-SW":this.from.isSouthEastOf(this.to)?"SE-NW":this.from.isSouthWestOf(this.to)?"SW-NE":void 0}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()]}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE")}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW")}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return oc(sc,this)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return oc(sc,this)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return oc(sc,this)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return oc(sc,this)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return oc(sc,this)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return oc(sc,this)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return oc(sc,this)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return oc(sc,this)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e){return e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e){return e instanceof rc&&(e.isEqual(this.getOuterBottomEndCorner())?this.getOuterTopStartCorner():e.isEqual(this.getOuterTopStartCorner())?this.getOuterBottomEndCorner():e.isEqual(this.getOuterTopEndCorner())?this.getOuterBottomStartCorner():e.isEqual(this.getOuterBottomStartCorner())?this.getOuterTopEndCorner():void 0)}getBordersSharedWith(e){if(!this.includesRange(e))return[];const t=Math.min(this.from.row,this.to.row),r=Math.max(this.from.row,this.to.row),n=Math.min(this.from.col,this.to.col),i=Math.max(this.from.col,this.to.col),o=Math.min(e.from.row,e.to.row),a=Math.max(e.from.row,e.to.row),s=Math.min(e.from.col,e.to.col),l=Math.max(e.from.col,e.to.col),c=[];return t===o&&c.push("top"),i===l&&c.push(oc(sc,this)?"left":"right"),r===a&&c.push("bottom"),n===s&&c.push(oc(sc,this)?"right":"left"),c}getInner(){const e=this.getOuterTopStartCorner(),t=this.getOuterBottomEndCorner(),r=[];for(let n=e.row;n<=t.row;n++)for(let i=e.col;i<=t.col;i++)this.from.row===n&&this.from.col===i||this.to.row===n&&this.to.col===i||r.push(this._createCellCoords(n,i));return r}getAll(){const e=this.getOuterTopStartCorner(),t=this.getOuterBottomEndCorner(),r=[];for(let n=e.row;n<=t.row;n++)for(let i=e.col;i<=t.col;i++)e.row===n&&e.col===i?r.push(e):t.row===n&&t.col===i?r.push(t):r.push(this._createCellCoords(n,i));return r}forAll(e){const t=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner();for(let n=t.row;n<=r.row;n++)for(let i=t.col;i<=r.col;i++){if(!1===e(n,i))return}}clone(){return new lc(this.highlight,this.from,this.to,oc(sc,this))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,t){return new rc(e,t,oc(sc,this))}}const cc=lc;function uc(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class hc{get eventManager(){return new ca(this)}constructor(e,t){uc(this,"wtTable",void 0),uc(this,"wtScroll",void 0),uc(this,"wtViewport",void 0),uc(this,"wtOverlays",void 0),uc(this,"selectionManager",void 0),uc(this,"wtEvent",void 0),uc(this,"guid",`wt_${hn()}`),uc(this,"drawInterrupted",!1),uc(this,"drawn",!1),uc(this,"domBindings",void 0),uc(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=t,this.wtScroll=new Kl(this.createScrollDao())}findOriginalHeaders(){const e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let t=0,r=this.wtTable.THEAD.childNodes[0].childNodes.length;t<r;t++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[t].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(t,r){Yn(r,e[t])}])}}createCellCoords(e,t){return new rc(e,t,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,t,r){return new cc(e,t,r,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.drawInterrupted=!1,this.wtTable.isVisible()?this.wtTable.draw(e):this.drawInterrupted=!0,this}getCell(e){if(!(arguments.length>1&&void 0!==arguments[1]&&arguments[1]))return this.wtTable.getCell(e);const t=this.wtSettings.getSetting("totalRows"),r=this.wtSettings.getSetting("fixedRowsTop"),n=this.wtSettings.getSetting("fixedRowsBottom"),i=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<r&&e.col<i)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<r)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<i&&e.row>=t-n){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<i)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<t&&e.row>=t-n&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,t,r,n,i){return!(e.col<0||e.row<0)&&this.wtScroll.scrollViewport(e,t,r,n,i)}scrollViewportHorizontally(e,t,r){return!(e<0)&&this.wtScroll.scrollViewportHorizontally(e,t,r)}scrollViewportVertically(e,t,r){return!(e<0)&&this.wtScroll.scrollViewportVertically(e,t,r)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selectionManager(){return e.selectionManager},get drawn(){return e.drawn},set drawn(t){e.drawn=t},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get startColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get endColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get startRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get endRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return e.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return e.wtSettings.getSetting("rowHeaders")}}}}function dc(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class fc extends hc{constructor(e,t,r){super(e,t),dc(this,"cloneSource",void 0),dc(this,"cloneOverlay",void 0);const n=this.wtSettings.getSetting("facade",this);this.cloneSource=r.source,this.cloneOverlay=r.overlay,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),n,this.domBindings,this.wtSettings),this.wtViewport=r.viewport,this.selectionManager=r.selectionManager,this.wtEvent=new Is(n,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,r.event),this.findOriginalHeaders()}}function gc(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class pc{constructor(e,t,r,n,i){gc(this,"wtSettings",null),lo(this,"wot",e,{writable:!1}),this.domBindings=i,this.facadeGetter=t,this.wtSettings=n;const{TABLE:o,hider:a,spreader:s,holder:l,wtRootElement:c}=this.wot.wtTable;this.instance=this.wot,this.type=r,this.mainTableScrollableElement=null,this.TABLE=o,this.hider=a,this.spreader=s,this.holder=l,this.wtRootElement=c,this.trimmingContainer=ni(this.hider.parentNode.parentNode),this.needFullRender=this.shouldBeRendered(),this.clone=this.makeClone()}hasRenderingStateChanged(){return this.needFullRender!==this.shouldBeRendered()}updateStateOfRendering(e){"before"===e&&this.shouldBeRendered()?this.needFullRender=!0:"after"!==e||this.shouldBeRendered()||(this.needFullRender=!1)}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=ni(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:e}=this.wot,{rootWindow:t}=this.domBindings;"hidden"===t.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=ri(e.TABLE)}getRelativeCellPosition(e,t,r){if(!1===this.clone.wtTable.holder.contains(e))return void Ho(`The provided element is not a child of the ${this.type} overlay`);const n=this.mainTableScrollableElement===this.domBindings.rootWindow,i=r<this.wtSettings.getSetting("fixedColumnsStart"),o=t<this.wtSettings.getSetting("fixedRowsTop"),a=t>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),s=this.clone.wtTable.spreader,l={start:this.getRelativeStartPosition(s),top:s.offsetTop},c={start:this.getRelativeStartPosition(e),top:e.offsetTop};let u=null;return u=n?this.getRelativeCellPositionWithinWindow(o,i,c,l):this.getRelativeCellPositionWithinHolder(o,a,i,c,l),u}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,t,r,n){const i=this.wot.wtTable.wtRootElement.getBoundingClientRect();let o=0,a=0;if(t){let e=i.left;this.isRtl()&&(e=this.domBindings.rootWindow.innerWidth-(i.left+i.width+gi())),o=e<=0?-1*e:0}else o=n.start;if(e){a=this.clone.wtTable.TABLE.getBoundingClientRect().top-i.top}else a=n.top;return{start:r.start+o,top:r.top+a}}getRelativeCellPositionWithinHolder(e,t,r,n,i){const o=this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),a=this.wot.wtOverlays.topOverlay.getScrollPosition();let s=0,l=0;if(r||(s=o-i.start),t){const e=this.wot.wtTable.wtRootElement.getBoundingClientRect();l=-1*this.clone.wtTable.TABLE.getBoundingClientRect().top+e.top}else e||(l=a-i.top);return{start:n.start-s,top:n.top-l}}makeClone(){if(-1===Il.indexOf(this.type))throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:e,wtSettings:t}=this.wot,{rootDocument:r,rootWindow:n}=this.domBindings,i=r.createElement("div"),o=r.createElement("table"),a=e.wtRootElement.parentNode;i.className=`${Pl.get(this.type)} handsontable`,i.setAttribute("dir",this.isRtl()?"rtl":"ltr"),i.style.position="absolute",i.style.top=0,i.style.overflow="visible",this.isRtl()?i.style.right=0:i.style.left=0,t.getSetting("ariaTags")&&Vn(i,[vn()]),o.className=e.TABLE.className;e.TABLE.getAttribute("role")&&o.setAttribute("role",e.TABLE.getAttribute("role")),i.appendChild(o),a.appendChild(i);const s=this.wtSettings.getSetting("preventOverflow");return!0===s||"horizontal"===s&&this.type===_l||"vertical"===s&&this.type===Rl?this.mainTableScrollableElement=n:"hidden"===n.getComputedStyle(a).getPropertyValue("overflow")?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=ri(e.TABLE),new fc(o,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager})}refresh(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.needFullRender&&this.clone.draw(e)}reset(){const e=this.clone.wtTable.holder,t=this.clone.wtTable.hider;[e.style,t.style,e.parentNode.style].forEach((e=>{e.width="",e.height=""}))}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}const mc=Object.freeze({width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"});function vc(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class bc extends pc{constructor(e,t,r,n){super(e,t,_l,r,n),vc(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return new jl(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode,{rootWindow:t}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let n=0,i=!1;if(this.trimmingContainer!==t||r&&"vertical"===r)n=this.getScrollPosition(),mi(e);else{const{wtTable:t}=this.wot,r=t.hider.getBoundingClientRect();i=Math.ceil(r.bottom)===e.offsetHeight,n=this.getOverlayOffset(),pi(e,"0px",`${n}px`)}const o=this.adjustHeaderBordersPosition(n,i);return this.adjustElementsSize(),o}setScrollPosition(e){const t=this.domBindings.rootWindow;let r=!1;return this.mainTableScrollableElement===t&&t.scrollY!==e?(t.scrollTo(Qn(t),e),r=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,r=!0),r}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,t){const r=this.wtSettings.getSetting("defaultRowHeight");let n=e,i=0;for(;n<t;){const e=this.wot.wtTable.getRowHeight(n);i+=void 0===e?r:e,n+=1}return i}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e}=this.wot,{rootDocument:t,rootWindow:r}=this.domBindings,n=gi(t),i=this.clone.wtTable.holder.parentNode.style,o=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||"horizontal"===o){let t=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(t-=n),t=Math.min(t,e.wtRootElement.scrollWidth),i.width=`${t}px`}else i.width="";this.clone.wtTable.holder.style.width=i.width;let a=si(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(a=0),i.height=`${a}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,t=this.wot.selectionManager.getFocusSelection()?parseInt(mc.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=`${parseInt(e.parentNode.style.height,10)+t}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if("number"===typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else{if(0!==e)throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.top="0"}this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:t}=this.clone.wtTable;"number"===typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?t.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:t.style[e]=""}scrollTo(e,t){const{wot:r,wtSettings:n}=this,i=(r.cloneSource?r.cloneSource:r).wtTable.holder,o=n.getSetting("columnHeaders"),a=0===n.getSetting("fixedRowsTop")&&o.length>0&&!Un(i.parentNode,"innerBorderTop")?1:0;let s=this.getTableParentOffset(),l=0;if(t){this.wot.wtTable.getRowHeight(e)>this.wot.wtViewport.getViewportHeight()&&(t=!1)}if(t&&i.offsetHeight!==i.clientHeight&&(l=gi(this.domBindings.rootDocument)),t){const t=n.getSetting("fixedRowsBottom"),i=n.getSetting("totalRows");s+=this.sumCellSizes(0,e+1),s-=r.wtViewport.getViewportHeight()-this.sumCellSizes(i-t,i),s+=1,s+=a}else s+=this.sumCellSizes(n.getSetting("fixedRowsTop"),e);var c;return s+=l,(c=this.mainTableScrollableElement).scrollHeight-c.clientHeight===s-a&&a>0&&this.wot.wtOverlays.expandHiderVerticallyBy(a),this.setScrollPosition(s)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return ei(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,t=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!t||"vertical"!==t)){const e=this.wot.wtTable.getTotalHeight()-this.clone.wtTable.getTotalHeight();r=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),r>e&&(r=0)}return r}adjustHeaderBordersPosition(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const{wtSettings:r}=this,n=this.wot.wtTable.holder.parentNode,i=r.getSetting("totalColumns"),o="horizontal"===r.getSetting("preventOverflow");i?Wn(n,"emptyColumns"):jn(n,"emptyColumns");let a=!1;if(!t&&!o){const t=r.getSetting("fixedRowsTop"),i=this.cachedFixedRowsTop!==t,o=r.getSetting("columnHeaders");if((i||0===t)&&o.length>0){const t=Un(n,"innerBorderTop");this.cachedFixedRowsTop=r.getSetting("fixedRowsTop"),e||0===r.getSetting("totalRows")?(jn(n,"innerBorderTop"),a=!t):(Wn(n,"innerBorderTop"),a=t)}}return a}}const yc={getFirstRenderedRow(){const e=this.wtSettings.getSetting("totalRows"),t=this.wtSettings.getSetting("fixedRowsBottom"),r=e-t;return 0===e||0===t?-1:r<0?0:r},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const e=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),e)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount:()=>0};lo(yc,"MIXIN_NAME","stickyRowsBottom",{writable:!1,enumerable:!1});const wc=yc;class Sc extends Dl{constructor(e,t,r,n){super(e,t,r,n,Al)}}oo(Sc,wc),oo(Sc,Bl);const Cc=Sc;function kc(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class xc extends pc{constructor(e,t,r,n){super(e,t,Al,r,n),kc(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return new Cc(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,t=this.clone.wtTable.holder.parentNode;t.style.top="";let r=0;const n=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer!==e||n&&"vertical"===n?(r=this.getScrollPosition(),this.repositionOverlay()):(r=this.getOverlayOffset(),t.style.bottom=`${r}px`);const i=this.adjustHeaderBordersPosition(r);return this.adjustElementsSize(),i}repositionOverlay(){const{wtTable:e,wtViewport:t}=this.wot,{rootDocument:r}=this.domBindings,n=this.clone.wtTable.holder.parentNode;let i=0;t.hasVerticalScroll()||(i+=t.getWorkspaceHeight()-e.getTotalHeight()),t.hasVerticalScroll()&&t.hasHorizontalScroll()&&(i+=gi(r)),n.style.bottom=`${i}px`}setScrollPosition(e){const{rootWindow:t}=this.domBindings;let r=!1;return this.mainTableScrollableElement===t?(t.scrollTo(Qn(t),e),r=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,r=!0),r}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,t){const{wtTable:r,wtSettings:n}=this.wot,i=n.getSetting("defaultRowHeight");let o=e,a=0;for(;o<t;){const e=r.getRowHeight(o);a+=void 0===e?i:e,o+=1}return a}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:t}=this.wot,{rootDocument:r,rootWindow:n}=this.domBindings,i=gi(r),o=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==n||"horizontal"===a){let r=t.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(r-=i),r=Math.min(r,e.wtRootElement.scrollWidth),o.width=`${r}px`}else o.width="";this.clone.wtTable.holder.style.width=o.width;let s=si(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(s=0),o.height=`${s}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if("number"===typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else{if(0!==e)throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.top="0"}this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:t}=this.clone.wtTable;"number"===typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?t.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:t.style[e]=""}scrollTo(e,t){let r=this.getTableParentOffset();const n=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let i=0;t&&n.offsetHeight!==n.clientHeight&&(i=gi(this.domBindings.rootDocument)),t?(r+=this.sumCellSizes(0,e+1),r-=this.wot.wtViewport.getViewportHeight(),r+=1):r+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),r+=i,this.setScrollPosition(r)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return ei(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,t=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!t||"vertical"!==t)){const e=this.wot.wtTable.getTotalHeight(),t=e-this.clone.wtTable.getTotalHeight(),n=this.domBindings.rootDocument.documentElement.clientHeight;r=Math.max(this.getTableParentOffset()-this.getScrollPosition()-n+e,0),r>t&&(r=0)}return r}adjustHeaderBordersPosition(e){const t=this.wtSettings.getSetting("fixedRowsBottom"),r=this.cachedFixedRowsBottom!==t,n=this.wtSettings.getSetting("columnHeaders");let i=!1;if((r||0===t)&&n.length>0){const t=this.wot.wtTable.holder.parentNode,r=Un(t,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||0===this.wtSettings.getSetting("totalRows")?(jn(t,"innerBorderBottom"),i=!r):(Wn(t,"innerBorderBottom"),i=r)}return i}}const Ec={getFirstRenderedRow(){const e=this.dataAccessObject.startRowRendered;return null===e?-1:e},getFirstVisibleRow(){const e=this.dataAccessObject.startRowVisible;return null===e?-1:e},getFirstPartiallyVisibleRow(){const e=this.dataAccessObject.startRowPartiallyVisible;return null===e?-1:e},getLastRenderedRow(){const e=this.dataAccessObject.endRowRendered;return null===e?-1:e},getLastVisibleRow(){const e=this.dataAccessObject.endRowVisible;return null===e?-1:e},getLastPartiallyVisibleRow(){const e=this.dataAccessObject.endRowPartiallyVisible;return null===e?-1:e},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};lo(Ec,"MIXIN_NAME","calculatedRows",{writable:!1,enumerable:!1});const Tc=Ec,_c={getFirstRenderedColumn(){return 0===this.wtSettings.getSetting("totalColumns")?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getFirstPartiallyVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getLastPartiallyVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){const e=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),e)},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};lo(_c,"MIXIN_NAME","stickyColumnsStart",{writable:!1,enumerable:!1});const Ac=_c;class Rc extends Dl{constructor(e,t,r,n){super(e,t,r,n,Rl)}}oo(Rc,Tc),oo(Rc,Ac);const Oc=Rc;class Mc extends pc{constructor(e,t,r,n){super(e,t,Rl,r,n)}createTable(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return new Oc(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:e}=this.wot;if(!this.needFullRender||!this.shouldBeRendered()||!e.holder.parentNode)return!1;const{rootWindow:t}=this.domBindings,r=this.clone.wtTable.holder.parentNode,n=this.wtSettings.getSetting("preventOverflow");let i=0;this.trimmingContainer!==t||n&&"horizontal"===n?(i=this.getScrollPosition(),mi(r)):(i=this.getOverlayOffset()*(this.isRtl()?-1:1),pi(r,`${i}px`,"0px"));const o=this.adjustHeaderBordersPosition(i);return this.adjustElementsSize(),o}setScrollPosition(e){const{rootWindow:t}=this.domBindings;let r=!1;return this.isRtl()&&(e=-e),this.mainTableScrollableElement===t&&t.scrollX!==e?(t.scrollTo(e,Zn(t)),r=!0):this.mainTableScrollableElement.scrollLeft!==e&&(this.mainTableScrollableElement.scrollLeft=e,r=!0),r}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,t){const r=this.wtSettings.getSetting("defaultColumnWidth");let n=e,i=0;for(;n<t;)i+=this.wot.wtTable.getStretchedColumnWidth(n)||r,n+=1;return i}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e}=this.wot,{rootDocument:t,rootWindow:r}=this.domBindings,n=gi(t),i=this.clone.wtTable.holder.parentNode.style,o=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||"vertical"===o){let t=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(t-=n),t=Math.min(t,e.wtRootElement.scrollHeight),i.height=`${t}px`}else i.height="";this.clone.wtTable.holder.style.height=i.height;const a=ai(this.clone.wtTable.TABLE);i.width=`${a}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,t=this.wot.selectionManager.getFocusSelection()?parseInt(mc.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width=`${parseInt(e.parentNode.style.width,10)+t}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalColumns"),t=this.isRtl()?"right":"left";if("number"===typeof this.wot.wtViewport.columnsRenderCalculator.startPosition)this.spreader.style[t]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else{if(0!==e)throw new Error("Incorrect value of the columnsRenderCalculator");this.spreader.style[t]="0"}this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){"number"===typeof this.wot.wtViewport.rowsRenderCalculator.startPosition?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,t){const{wtSettings:r}=this,n=r.getSetting("rowHeaders"),i=r.getSetting("fixedColumnsStart"),o=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,a=0===i&&n.length>0&&!Un(o.parentNode,"innerBorderInlineStart")?1:0;let s=this.getTableParentOffset(),l=0;if(t){this.wot.wtTable.getColumnWidth(e)>this.wot.wtViewport.getViewportWidth()&&(t=!1)}var c;return t&&o.offsetWidth!==o.clientWidth&&(l=gi(this.domBindings.rootDocument)),t?(s+=this.sumCellSizes(0,e+1),s-=this.wot.wtViewport.getViewportWidth(),s+=a):s+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),s+=l,(c=this.mainTableScrollableElement).scrollWidth-c.clientWidth===s-a&&a>0&&this.wot.wtOverlays.expandHiderHorizontallyBy(a),this.setScrollPosition(s)}getTableParentOffset(){let e=0;return this.wtSettings.getSetting("preventOverflow")||this.trimmingContainer!==this.domBindings.rootWindow||(e=this.wot.wtTable.holderOffset.left),e}getScrollPosition(){return Math.abs(ti(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:e}=this.domBindings,t=this.wtSettings.getSetting("preventOverflow");let r=0;if(this.trimmingContainer===e&&(!t||"horizontal"!==t)){r=this.isRtl()?Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);r>this.wot.wtTable.getTotalWidth()-this.clone.wtTable.getTotalWidth()&&(r=0)}return r}adjustHeaderBordersPosition(e){const{wtSettings:t}=this,r=this.wot.wtTable.holder.parentNode,n=t.getSetting("rowHeaders"),i=t.getSetting("fixedColumnsStart"),o=t.getSetting("totalRows"),a="vertical"===t.getSetting("preventOverflow");o?Wn(r,"emptyRows"):jn(r,"emptyRows");let s=!1;if(!a)if(i&&!n.length)jn(r,"innerBorderLeft innerBorderInlineStart");else if(!i&&n.length){const t=Un(r,"innerBorderInlineStart");e?(jn(r,"innerBorderLeft innerBorderInlineStart"),s=!t):(Wn(r,"innerBorderLeft innerBorderInlineStart"),s=t)}return s}}class Ic extends Dl{constructor(e,t,r,n){super(e,t,r,n,Ol)}}oo(Ic,Ll),oo(Ic,Ac);const Pc=Ic;function Nc(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Dc extends pc{constructor(e,t,r,n,i,o){super(e,t,Ol,r,n),Nc(this,"topOverlay",void 0),Nc(this,"inlineStartOverlay",void 0),this.topOverlay=i,this.inlineStartOverlay=o}createTable(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return new Pc(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){pi(e,`${this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1)}px`,`${this.topOverlay.getOverlayOffset()}px`)}else mi(e);let t=si(this.clone.wtTable.TABLE);const r=ai(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(t=0),e.style.height=`${t}px`,e.style.width=`${r}px`,!1}}class Fc extends Dl{constructor(e,t,r,n){super(e,t,r,n,Ml)}}oo(Fc,wc),oo(Fc,Ac);const Lc=Fc;class Hc extends pc{constructor(e,t,r,n,i,o){super(e,t,Ml,r,n),this.bottomOverlay=i,this.inlineStartOverlay=o}createTable(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return new Lc(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;const t=this.clone.wtTable.holder.parentNode;if(t.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const e=this.inlineStartOverlay.getOverlayOffset(),r=this.bottomOverlay.getOverlayOffset();t.style[this.isRtl()?"right":"left"]=`${e}px`,t.style.bottom=`${r}px`}else mi(t),this.repositionOverlay();let r=si(this.clone.wtTable.TABLE);const n=ai(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(r=0),t.style.height=`${r}px`,t.style.width=`${n}px`,!1}repositionOverlay(){const{wtTable:e,wtViewport:t}=this.wot,{rootDocument:r}=this.domBindings,n=this.clone.wtTable.holder.parentNode;let i=0;t.hasVerticalScroll()||(i+=t.getWorkspaceHeight()-e.getTotalHeight()),t.hasVerticalScroll()&&t.hasHorizontalScroll()&&(i+=gi(r)),n.style.bottom=`${i}px`}}function Bc(e,t,r){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,r)}function Uc(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function jc(e,t,r){return e.set(Vc(e,t),r),r}function Wc(e,t){return e.get(Vc(e,t))}function Vc(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var zc=new WeakMap,qc=new WeakMap,Gc=new WeakMap,$c=new WeakMap;const Kc=class{constructor(e,t,r,n,i,o){Uc(this,"wot",null),Bc(this,zc,[]),Uc(this,"topOverlay",null),Uc(this,"bottomOverlay",null),Uc(this,"inlineStartOverlay",null),Uc(this,"topInlineStartCornerOverlay",null),Uc(this,"bottomInlineStartCornerOverlay",null),Uc(this,"browserLineHeight",void 0),Uc(this,"wtSettings",null),Bc(this,qc,!1),Bc(this,Gc,0),Bc(this,$c,null),Uc(this,"resizeObserver",new ResizeObserver((e=>{po((()=>{Array.isArray(e)&&e.length&&(jc(Gc,this,Wc(Gc,this)+1),100===Wc(Gc,this)&&(Ho("The ResizeObserver callback was fired too many times in direct succession.\nThis may be due to an infinite loop caused by setting a dynamic height/width (for example, with the `dvh` units) to a Handsontable container's parent. \nThe observer will be disconnected."),this.resizeObserver.disconnect()),null!==Wc($c,this)&&clearTimeout(Wc($c,this)),jc($c,this,setTimeout((()=>{jc(Gc,this,0)}),100)),this.wtSettings.getSetting("onContainerElementResize"))}))}))),this.wot=e,this.wtSettings=n,this.domBindings=r,this.facadeGetter=t,this.wtTable=o;const{rootDocument:a,rootWindow:s}=this.domBindings;this.instance=this.wot,this.eventManager=i,this.scrollbarSize=gi(a);const l="hidden"===s.getComputedStyle(o.wtRootElement.parentNode).getPropertyValue("overflow");this.scrollableElement=l?o.holder:ri(o.TABLE),this.initOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=s.scrollX,this.lastScrollY=s.scrollY}getOverlays(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=[...Wc(zc,this)];return e&&t.push(this.wtTable),t}initBrowserLineHeight(){const{rootWindow:e,rootDocument:t}=this.domBindings,r=e.getComputedStyle(t.body),n=parseInt(r.lineHeight,10),i=1.2*parseInt(r.fontSize,10);this.browserLineHeight=n||i}initOverlays(){const e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new bc(...e),this.bottomOverlay=new xc(...e),this.inlineStartOverlay=new Mc(...e),this.topInlineStartCornerOverlay=new Dc(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new Hc(...e,this.bottomOverlay,this.inlineStartOverlay),jc(zc,this,[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay])}beforeDraw(){jc(qc,this,Wc(zc,this).reduce(((e,t)=>t.hasRenderingStateChanged()||e),!1)),Wc(zc,this).forEach((e=>e.updateStateOfRendering("before")))}afterDraw(){this.syncScrollWithMaster(),Wc(zc,this).forEach((e=>{const t=e.hasRenderingStateChanged();e.updateStateOfRendering("after"),t&&!e.needFullRender&&e.reset()}))}refreshAll(){this.wot.drawn&&(this.wtTable.holder.parentNode?(this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1):this.destroy())}registerListeners(){const{rootDocument:e,rootWindow:t}=this.domBindings,{mainTableScrollableElement:r}=this.topOverlay,{mainTableScrollableElement:n}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",(e=>this.onKeyDown(e))),this.eventManager.addEventListener(e.documentElement,"keyup",(()=>this.onKeyUp())),this.eventManager.addEventListener(e,"visibilitychange",(()=>this.onKeyUp())),this.eventManager.addEventListener(r,"scroll",(e=>this.onTableScroll(e)),{passive:!0}),r!==n&&this.eventManager.addEventListener(n,"scroll",(e=>this.onTableScroll(e)),{passive:!0});const i=t.devicePixelRatio&&t.devicePixelRatio>1,o=this.scrollableElement===t,a=this.wtSettings.getSetting("preventWheel"),s={passive:o};(a||i||!Co())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",(e=>this.onCloneWheel(e,a)),s);let l;[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach((e=>{if(e&&e.needFullRender){const{holder:t}=e.clone.wtTable;this.eventManager.addEventListener(t,"wheel",(e=>this.onCloneWheel(e,a)),s)}})),this.eventManager.addEventListener(t,"resize",(()=>{clearTimeout(l),l=setTimeout((()=>{this.wtSettings.getSetting("onWindowResize"),jc(Gc,this,0)}),200)})),o||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}deregisterListeners(){this.eventManager.clearEvents(!0)}onTableScroll(e){const t=this.domBindings.rootWindow,r=this.inlineStartOverlay.mainTableScrollableElement,n=this.topOverlay.mainTableScrollableElement,i=e.target;this.keyPressed&&(n!==t&&i!==t&&!e.target.contains(n)||r!==t&&i!==t&&!e.target.contains(r))||this.syncScrollPositions(e)}onCloneWheel(e,t){const{rootWindow:r}=this.domBindings,n=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,o=e.target,a=i!==r&&o!==r&&!o.contains(i),s=n!==r&&o!==r&&!o.contains(n);if(this.keyPressed&&(a||s)||this.scrollableElement===r)return;const l=this.translateMouseWheelToScroll(e);(t||this.scrollableElement!==r&&l)&&e.preventDefault()}onKeyDown(e){this.keyPressed=Po(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let t=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,r=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;1===e.deltaMode&&(r+=r*this.browserLineHeight,t+=t*this.browserLineHeight);const n=this.scrollVertically(t),i=this.scrollHorizontally(r);return n||i}scrollVertically(e){const t=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,t!==this.scrollableElement.scrollTop}scrollHorizontally(e){const t=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,t!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const{rootWindow:e}=this.domBindings,t=this.topOverlay.clone.wtTable.holder,r=this.inlineStartOverlay.clone.wtTable.holder,[n,i]=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop];if(this.horizontalScrolling=t.scrollLeft!==n||this.lastScrollX!==e.scrollX,this.verticalScrolling=r.scrollTop!==i||this.lastScrollY!==e.scrollY,this.lastScrollX=e.scrollX,this.lastScrollY=e.scrollY,this.horizontalScrolling){t.scrollLeft=n;const e=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;e&&(e.scrollLeft=n)}this.verticalScrolling&&(r.scrollTop=i),this.refreshAll()}syncScrollWithMaster(){if(!Wc(qc,this))return;const e=this.topOverlay.mainTableScrollableElement,{scrollLeft:t,scrollTop:r}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=t),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=t),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=r),jc(qc,this,!1)}updateMainScrollableElements(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:e}=this,{rootWindow:t}=this.domBindings;"hidden"===t.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")?this.scrollableElement=e.holder:this.scrollableElement=ri(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){const e=this.wtTable.spreader,t=e.clientWidth,r=e.clientHeight,n=t!==this.spreaderLastSize.width||r!==this.spreaderLastSize.height;return n&&(this.spreaderLastSize.width=t,this.spreaderLastSize.height=r),n}adjustElementsSize(){const{wtViewport:e}=this.wot,{wtTable:t}=this,{rootWindow:r}=this.domBindings,n=this.scrollableElement===r,i=this.wtSettings.getSetting("totalColumns"),o=this.wtSettings.getSetting("totalRows"),a=e.getRowHeaderWidth(),s=e.getColumnHeaderHeight()+this.topOverlay.sumCellSizes(0,o)+1,l=a+this.inlineStartOverlay.sumCellSizes(0,i),c=t.hider.style,u=(()=>!n&&this.scrollableElement.scrollTop>Math.max(0,s-t.holder.clientHeight))()?1:0,h=(()=>!n&&this.scrollableElement.scrollLeft>Math.max(0,l-t.holder.clientWidth))()?1:0;if(c.width=`${l+h}px`,c.height=`${s+u}px`,this.scrollbarSize>0){const{scrollHeight:e,scrollWidth:r}=t.wtRootElement,{scrollHeight:n,scrollWidth:i}=t.holder;this.hasScrollbarRight=e<n,this.hasScrollbarBottom=r<i,this.hasScrollbarRight&&t.hider.scrollWidth+this.scrollbarSize>r?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&t.hider.scrollHeight+this.scrollbarSize>e&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(),this.inlineStartOverlay.adjustElementsSize(),this.bottomOverlay.adjustElementsSize()}expandHiderVerticallyBy(e){const{wtTable:t}=this;t.hider.style.height=`${parseInt(t.hider.style.height,10)+e}px`}expandHiderHorizontallyBy(e){const{wtTable:t}=this;t.hider.style.width=`${parseInt(t.hider.style.width,10)+e}px`}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;const t=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let r=null;return Ai(t,(t=>{t&&t.clone&&t.clone.wtTable.TABLE.contains(e)&&(r=t.clone)})),r}syncOverlayTableClassNames(){const e=this.wtTable.TABLE;Ai([this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay],(t=>{t&&(t.clone.wtTable.TABLE.className=e.className)}))}};function Yc(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Xc{constructor(e){Yc(this,"settings",{}),Yc(this,"defaults",Object.freeze(this.getDefaults())),co(this.defaults,((t,r)=>{if(void 0!==e[r])this.settings[r]=e[r];else{if(void 0===t)throw new Error(`A required setting "${r}" was not provided`);this.settings[r]=t}}))}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow:()=>!1,preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders:()=>[],columnHeaders:()=>[],totalRows:void 0,totalColumns:void 0,cellRenderer:(e,t,r)=>{const n=this.getSetting("data",e,t);Yn(r,void 0===n||null===n?"":n)},columnWidth(){},rowHeight(){},rowHeightByOverlayName(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:e=>e,onBeforeViewportScrollVertically:e=>e,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:e=>e,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllColumns:!1,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0}}update(e,t){return void 0===t?co(e,((e,t)=>{this.settings[t]=e})):this.settings[e]=t,this}getSetting(e,t,r,n,i){return"function"===typeof this.settings[e]?this.settings[e](t,r,n,i):void 0!==t&&Array.isArray(this.settings[e])?this.settings[e][t]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}}class Jc extends Dl{constructor(e,t,r,n){super(e,t,r,n,"master")}alignOverlaysWithTrimmingContainer(){const e=ni(this.wtRootElement),{rootWindow:t}=this.domBindings;if(e===t){this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible")}else{const r=e.parentElement,n=ii(e,"height",t),i=ii(e,"overflow",t),o=this.holder.style,{scrollWidth:a,scrollHeight:s}=e;let l=e.offsetWidth,c=e.offsetHeight;if(r&&["auto","hidden","scroll"].includes(i)){const n=e.cloneNode(!1);n.style.overflow="auto",n.style.position="absolute",e.nextElementSibling?r.insertBefore(n,e.nextElementSibling):r.appendChild(n);const i=parseInt(oi(n,t).height,10);r.removeChild(n),0===i&&(c=0)}c=Math.min(c,s),o.height="auto"===n?"auto":`${c}px`,l=Math.min(l,a),o.width=`${l}px`,o.overflow="",this.hasTableHeight="auto"===o.height||c>0,this.hasTableWidth=l>0}this.isTableVisible=Xn(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:e}=this,{wtViewport:t}=this.dataAccessObject,r="master",n=e.getSetting("columnHeaders").length;if(n&&!t.hasOversizedColumnHeadersMarked[r]){const i=e.getSetting("rowHeaders").length,o=this.getRenderedColumnsCount();for(let e=0;e<n;e++)for(let t=-1*i;t<o;t++)this.markIfOversizedColumnHeader(t);t.hasOversizedColumnHeadersMarked[r]=!0}}}oo(Jc,Tc),oo(Jc,Bl);const Zc=Jc;function Qc(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class eu{constructor(){Qc(this,"count",0),Qc(this,"startRow",0),Qc(this,"endRow",0),Qc(this,"startPosition",0),Qc(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalRows:t}=e;this.count=t,this.endRow=this.count-1}process(){}finalize(){}}function tu(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class ru{constructor(){tu(this,"count",0),tu(this,"startRow",null),tu(this,"endRow",null),tu(this,"startPosition",null),tu(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,t){const{totalCalculatedHeight:r,zeroBasedScrollOffset:n,innerViewportHeight:i}=t;r<=n&&(this.startRow=e),r>=n&&r<=i&&null===this.startRow&&(this.startRow=e),this.endRow=e}finalize(e){var t;const{scrollOffset:r,viewportHeight:n,horizontalScrollbarHeight:i,totalRows:o,needReverse:a,startPositions:s,rowHeight:l}=e;if(this.endRow===o-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const e=s[this.endRow]+l-s[this.startRow-1];if(this.startRow-=1,e>=n-i)break}this.startPosition=null!==(t=s[this.startRow])&&void 0!==t?t:null;r+n-i<0||r>s.at(-1)+l?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,o<this.endRow&&(this.endRow=o-1),null!==this.startRow&&(this.count=this.endRow-this.startRow+1)}}class nu extends ru{finalize(e){var t;super.finalize(e);const{overrideFn:r,totalRows:n,startPositions:i}=e;null!==this.startRow&&"function"===typeof r&&r(this),this.startRow<0&&(this.startRow=0),this.startPosition=null!==(t=i[this.startRow])&&void 0!==t?t:null,n<this.endRow&&(this.endRow=n-1),null!==this.startRow&&(this.count=this.endRow-this.startRow+1)}}function iu(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class ou{constructor(){iu(this,"count",0),iu(this,"startRow",null),iu(this,"endRow",null),iu(this,"startPosition",null),iu(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,t){const{totalCalculatedHeight:r,zeroBasedScrollOffset:n,innerViewportHeight:i,rowHeight:o}=t;r>=n&&r+o<=i&&(null===this.startRow&&(this.startRow=e),this.endRow=e)}finalize(e){var t;const{scrollOffset:r,viewportHeight:n,horizontalScrollbarHeight:i,totalRows:o,needReverse:a,startPositions:s,rowHeight:l}=e;if(this.endRow===o-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const e=s[this.endRow]+l-s[this.startRow-1];if(e<=n-i&&(this.startRow-=1),e>=n-i)break}this.startPosition=null!==(t=s[this.startRow])&&void 0!==t?t:null;r+n-i<(null===this.startRow?0:e.getRowHeight(this.startRow))||r>s.at(-1)?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,o<this.endRow&&(this.endRow=o-1),null!==this.startRow&&(this.count=this.endRow-this.startRow+1)}}function au(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class su{constructor(){au(this,"count",0),au(this,"startColumn",0),au(this,"endColumn",0),au(this,"startPosition",0),au(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalColumns:t}=e;this.count=t,this.endColumn=this.count-1}process(){}finalize(){}}function lu(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class cu{constructor(){lu(this,"count",0),lu(this,"startColumn",null),lu(this,"endColumn",null),lu(this,"startPosition",null),lu(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,t){const{totalCalculatedWidth:r,zeroBasedScrollOffset:n,viewportWidth:i}=t;r<=n&&(this.startColumn=e);r>=n&&r<=n+(n>0?i+1:i)&&(null!==this.startColumn&&void 0!==this.startColumn||(this.startColumn=e)),this.endColumn=e}finalize(e){var t;const{scrollOffset:r,viewportWidth:n,inlineStartOffset:i,zeroBasedScrollOffset:o,totalColumns:a,needReverse:s,startPositions:l,columnWidth:c}=e;if(this.endColumn===a-1&&s)for(this.startColumn=this.endColumn;this.startColumn>0;){const e=l[this.endColumn]+c-l[this.startColumn-1];if(this.startColumn-=1,e>n)break}this.startPosition=null!==(t=l[this.startColumn])&&void 0!==t?t:null;r+n-(o>0?n+1:n)<-1*i||r>l.at(-1)+c||-1*r-n>0?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),null!==this.startColumn&&(this.count=this.endColumn-this.startColumn+1)}}class uu extends cu{finalize(e){var t;super.finalize(e);const{overrideFn:r,totalColumns:n,startPositions:i}=e;null!==this.startColumn&&"function"===typeof r&&r(this),this.startColumn<0&&(this.startColumn=0),this.startPosition=null!==(t=i[this.startColumn])&&void 0!==t?t:null,n<this.endColumn&&(this.endColumn=n-1),null!==this.startColumn&&(this.count=this.endColumn-this.startColumn+1)}}function hu(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class du{constructor(){hu(this,"count",0),hu(this,"startColumn",null),hu(this,"endColumn",null),hu(this,"startPosition",null),hu(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,t){const{totalCalculatedWidth:r,zeroBasedScrollOffset:n,viewportWidth:i,columnWidth:o}=t;r>=n&&r+o<=n+(n>0?i+1:i)&&(null!==this.startColumn&&void 0!==this.startColumn||(this.startColumn=e),this.endColumn=e)}finalize(e){var t;const{scrollOffset:r,viewportWidth:n,inlineStartOffset:i,zeroBasedScrollOffset:o,totalColumns:a,needReverse:s,startPositions:l,columnWidth:c}=e;if(this.endColumn===a-1&&s)for(this.startColumn=this.endColumn;this.startColumn>0;){const e=l[this.endColumn]+c-l[this.startColumn-1];if(e<=n&&(this.startColumn-=1),e>=n)break}this.startPosition=null!==(t=l[this.startColumn])&&void 0!==t?t:null;const u=r+n-(o>0?n+1:n),h=null===this.startColumn?0:e.getColumnWidth(this.startColumn);u<-1*i||r>l.at(-1)||-1*r-n>-1*h?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),null!==this.startColumn&&(this.count=this.endColumn-this.startColumn+1)}}function fu(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class gu extends ll{constructor(e){let{calculationTypes:t,viewportHeight:r,scrollOffset:n,totalRows:i,rowHeightFn:o,overrideFn:a,horizontalScrollbarHeight:s}=e;super(t),fu(this,"viewportHeight",0),fu(this,"scrollOffset",0),fu(this,"zeroBasedScrollOffset",0),fu(this,"totalRows",0),fu(this,"rowHeightFn",null),fu(this,"rowHeight",0),fu(this,"overrideFn",null),fu(this,"horizontalScrollbarHeight",0),fu(this,"innerViewportHeight",0),fu(this,"totalCalculatedHeight",0),fu(this,"startPositions",[]),fu(this,"needReverse",!0),this.viewportHeight=r,this.scrollOffset=n,this.zeroBasedScrollOffset=Math.max(n,0),this.totalRows=i,this.rowHeightFn=o,this.overrideFn=a,this.horizontalScrollbarHeight=null!==s&&void 0!==s?s:0,this.innerViewportHeight=this.zeroBasedScrollOffset+this.viewportHeight-this.horizontalScrollbarHeight,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalRows;e++)if(this.rowHeight=this.getRowHeight(e),this._process(e,this),this.startPositions.push(this.totalCalculatedHeight),this.totalCalculatedHeight+=this.rowHeight,this.totalCalculatedHeight>=this.innerViewportHeight){this.needReverse=!1;break}this._finalize(this)}getRowHeight(e){const t=this.rowHeightFn(e);return isNaN(t)?23:t}}const pu=class{constructor(e,t,r,n,i){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=t,this.wtSettings=r,this.wtTable=i,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.rowsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllRows")?new eu:new nu],["fullyVisible",()=>new ou],["partiallyVisible",()=>new ru]]),this.columnsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllColumns")?new su:new uu],["fullyVisible",()=>new du],["partiallyVisible",()=>new cu]]),this.eventManager=n,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",(()=>{this.clientHeight=this.getWorkspaceHeight()}))}getWorkspaceHeight(){const e=this.domBindings.rootDocument,t=this.dataAccessObject.topOverlayTrimmingContainer;let r=0;if(t===this.domBindings.rootWindow)r=e.documentElement.clientHeight;else{r=si(t)>0&&t.clientHeight>0?t.clientHeight:1/0}return r}getWorkspaceWidth(){const{wtSettings:e}=this,{rootDocument:t,rootWindow:r}=this.domBindings,n=this.dataAccessObject.inlineStartOverlayTrimmingContainer,i=t.documentElement.offsetWidth,o=e.getSetting("totalColumns"),a=e.getSetting("preventOverflow"),s=e.getSetting("rtlMode"),l=this.wtTable.TABLE.getBoundingClientRect(),c=i-(s?l.right-i:l.left);let u,h;if(a)return ai(this.wtTable.wtRootElement);if(u=e.getSetting("freezeOverlays")?Math.min(c,i):Math.min(this.getContainerFillWidth(),c,i),n===r&&o>0&&this.sumColumnWidths(0,o-1)>u)return t.documentElement.clientWidth;if(n!==r&&(h=ii(this.dataAccessObject.inlineStartOverlayTrimmingContainer,"overflow",r),"scroll"===h||"hidden"===h||"auto"===h))return Math.max(u,n.clientWidth);const d=e.getSetting("stretchH");return"none"!==d&&d?u:Math.max(u,ai(this.wtTable.TABLE))}hasVerticalScroll(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}hasHorizontalScroll(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}sumColumnWidths(e,t){let r=0,n=e;for(;n<t;)r+=this.wtTable.getColumnWidth(n),n+=1;return r}getContainerFillWidth(){if(this.containerWidth)return this.containerWidth;const e=this.wtTable.holder,t=this.domBindings.rootDocument.createElement("div");t.style.width="100%",t.style.height="1px",e.appendChild(t);const r=t.offsetWidth;return this.containerWidth=r,e.removeChild(t),r}getWorkspaceOffset(){return Jn(this.wtTable.TABLE)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=si(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;const t=this.getColumnHeaderHeight();return t>0&&(e-=t),e}getRowHeaderWidth(){const e=this.wtSettings.getSetting("rowHeaderWidth"),t=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let r=0,n=t.length;r<n;r++)this.rowHeaderWidth+=e[r]||e}if(isNaN(this.rowHeaderWidth))if(t.length){let e=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let r=0,n=t.length;r<n;r++)e?(this.rowHeaderWidth+=ai(e),e=e.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}getViewportWidth(){const e=this.getWorkspaceWidth();if(e===1/0)return e;const t=this.getRowHeaderWidth();return t>0?e-t:e}createRowsCalculator(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:t,wtTable:r}=this;let n,i,o=this.getViewportHeight();this.rowHeaderWidth=NaN;let a=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const s=t.getSetting("fixedRowsTop"),l=t.getSetting("fixedRowsBottom"),c=t.getSetting("totalRows");return s&&a>=0&&(i=this.dataAccessObject.topOverlay.sumCellSizes(0,s),a+=i,o-=i),l&&this.dataAccessObject.bottomOverlay.clone&&(i=this.dataAccessObject.bottomOverlay.sumCellSizes(c-l,c),o-=i),n=r.holder.clientHeight===r.holder.offsetHeight?0:gi(this.domBindings.rootDocument),new gu({calculationTypes:e.map((e=>[e,this.rowsCalculatorTypes.get(e)()])),viewportHeight:o,scrollOffset:a,totalRows:t.getSetting("totalRows"),rowHeightFn:e=>r.getRowHeight(e),overrideFn:t.getSettingPure("viewportRowCalculatorOverride"),horizontalScrollbarHeight:n})}createColumnsCalculator(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:t,wtTable:r}=this;let n=this.getViewportWidth(),i=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const o=t.getSetting("fixedColumnsStart");if(o&&i>=0){const e=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,o);i+=e,n-=e}return r.holder.clientWidth!==r.holder.offsetWidth&&(n-=gi(this.domBindings.rootDocument)),new hl({calculationTypes:e.map((e=>[e,this.columnsCalculatorTypes.get(e)()])),viewportWidth:n,scrollOffset:i,totalColumns:t.getSetting("totalColumns"),columnWidthFn:e=>r.getColumnWidth(e),overrideFn:t.getSettingPure("viewportColumnCalculatorOverride"),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createCalculators(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const{wtSettings:t}=this,r=this.createRowsCalculator(),n=this.createColumnsCalculator();if(e&&!t.getSetting("renderAllRows")){const t=r.getResultsFor("fullyVisible");e=this.areAllProposedVisibleRowsAlreadyRendered(t)}if(e&&!t.getSetting("renderAllColumns")){const t=n.getResultsFor("fullyVisible");e=this.areAllProposedVisibleColumnsAlreadyRendered(t)}return e||(this.rowsRenderCalculator=r.getResultsFor("rendered"),this.columnsRenderCalculator=n.getResultsFor("rendered")),this.rowsVisibleCalculator=r.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=n.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=r.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=n.getResultsFor("partiallyVisible"),e}createVisibleCalculators(){const e=this.createRowsCalculator(["fullyVisible","partiallyVisible"]),t=this.createColumnsCalculator(["fullyVisible","partiallyVisible"]);this.rowsVisibleCalculator=e.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=t.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=e.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=t.getResultsFor("partiallyVisible")}areAllProposedVisibleRowsAlreadyRendered(e){if(!this.rowsVisibleCalculator)return!1;let{startRow:t,endRow:r}=e;if(null===t&&null===r){if(!e.isVisibleInTrimmingContainer)return!0;t=this.rowsPartiallyVisibleCalculator.startRow,r=this.rowsPartiallyVisibleCalculator.endRow}const{startRow:n,endRow:i}=this.rowsRenderCalculator;return!(t<n||t===n&&t>0)&&!(r>i||r===i&&r<this.wtSettings.getSetting("totalRows")-1)}areAllProposedVisibleColumnsAlreadyRendered(e){if(!this.columnsVisibleCalculator)return!1;let{startColumn:t,endColumn:r}=e;if(null===t&&null===r){if(!e.isVisibleInTrimmingContainer)return!0;t=this.columnsPartiallyVisibleCalculator.startColumn,r=this.columnsPartiallyVisibleCalculator.endColumn}const{startColumn:n,endColumn:i}=this.columnsRenderCalculator;return!(t<n||t===n&&t>0)&&!(r>i||r===i&&r<this.wtSettings.getSetting("totalColumns")-1)}resetHasOversizedColumnHeadersMarked(){co(this.hasOversizedColumnHeadersMarked,((e,t,r)=>{r[t]=void 0}))}};function mu(e,t,r){vu(e,t),t.set(e,r)}function vu(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function bu(e,t){return e.get(wu(e,t))}function yu(e,t,r){return e.set(wu(e,t),r),r}function wu(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var Su=new WeakMap,Cu=new WeakMap,ku=new WeakSet;class xu{constructor(){!function(e,t){vu(e,t),t.add(e)}(this,ku),mu(this,Su,void 0),mu(this,Cu,void 0)}setActiveOverlay(e){return yu(Cu,this,e),this}setActiveSelection(e){return yu(Su,this,e),this}scan(){const e=bu(Su,this).settings.selectionType,t=new Set;return"active-header"===e?(this.scanColumnsInHeadersRange((e=>t.add(e))),this.scanRowsInHeadersRange((e=>t.add(e)))):"area"===e?this.scanCellsRange((e=>t.add(e))):"focus"===e?(this.scanColumnsInHeadersRange((e=>t.add(e))),this.scanRowsInHeadersRange((e=>t.add(e))),this.scanCellsRange((e=>t.add(e)))):"fill"===e?this.scanCellsRange((e=>t.add(e))):"header"===e?(this.scanColumnsInHeadersRange((e=>t.add(e))),this.scanRowsInHeadersRange((e=>t.add(e)))):"row"===e?(this.scanRowsInHeadersRange((e=>t.add(e))),this.scanRowsInCellsRange((e=>t.add(e)))):"column"===e&&(this.scanColumnsInHeadersRange((e=>t.add(e))),this.scanColumnsInCellsRange((e=>t.add(e)))),t}scanColumnsInHeadersRange(e){const[t,r,n,i]=bu(Su,this).getCorners(),{wtTable:o}=bu(Cu,this),a=o.getRenderedColumnsCount(),s=o.getColumnHeadersCount();let l=0;for(let c=-o.getRowHeadersCount();c<a;c++){const a=o.columnFilter.renderedToSource(c);if(!(a<r||a>i)){for(let c=-s;c<0;c++){if(c<t||c>n)continue;const u=c+s;let h=o.getColumnHeader(a,u);const d=bu(Cu,this).getSetting("onBeforeHighlightingColumnHeader",a,u,{selectionType:bu(Su,this).settings.selectionType,columnCursor:l,selectionWidth:i-r+1});null!==d&&(d!==a&&(h=o.getColumnHeader(d,u)),e(h))}l+=1}}}scanRowsInHeadersRange(e){const[t,r,n,i]=bu(Su,this).getCorners(),{wtTable:o}=bu(Cu,this),a=o.getRenderedRowsCount(),s=o.getRowHeadersCount();let l=0;for(let c=-o.getColumnHeadersCount();c<a;c++){const a=o.rowFilter.renderedToSource(c);if(!(a<t||a>n)){for(let c=-s;c<0;c++){if(c<r||c>i)continue;const u=c+s;let h=o.getRowHeader(a,u);const d=bu(Cu,this).getSetting("onBeforeHighlightingRowHeader",a,u,{selectionType:bu(Su,this).settings.selectionType,rowCursor:l,selectionHeight:n-t+1});null!==d&&(d!==a&&(h=o.getRowHeader(d,u)),e(h))}l+=1}}}scanCellsRange(e){const[t,r,n,i]=bu(Su,this).getCorners(),{wtTable:o}=bu(Cu,this);wu(ku,this,Eu).call(this,((a,s)=>{if(a>=t&&a<=n&&s>=r&&s<=i){const t=o.getCell(bu(Cu,this).createCellCoords(a,s)),r=bu(Cu,this).getSetting("onAfterDrawSelection",a,s,bu(Su,this).settings.layerLevel);"string"===typeof r&&jn(t,r),e(t)}}))}scanRowsInCellsRange(e){const[t,,r]=bu(Su,this).getCorners(),{wtTable:n}=bu(Cu,this);wu(ku,this,Eu).call(this,((i,o)=>{if(i>=t&&i<=r){const t=n.getCell(bu(Cu,this).createCellCoords(i,o));e(t)}}))}scanColumnsInCellsRange(e){const[,t,,r]=bu(Su,this).getCorners(),{wtTable:n}=bu(Cu,this);wu(ku,this,Eu).call(this,((i,o)=>{if(o>=t&&o<=r){const t=n.getCell(bu(Cu,this).createCellCoords(i,o));e(t)}}))}}function Eu(e){const{wtTable:t}=bu(Cu,this),r=t.getRenderedRowsCount(),n=t.getRenderedColumnsCount();for(let i=0;i<r;i+=1){const r=t.rowFilter.renderedToSource(i);for(let i=0;i<n;i+=1)e(r,t.columnFilter.renderedToSource(i))}}const Tu=class{constructor(e,t){t&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=t,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=mc,this.cornerCenterPointOffset=-parseInt(this.cornerDefaultStyle.width,10)/2,this.corner=null,this.cornerStyle=null,this.createBorders(t),this.registerListeners())}registerListeners(){const e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",(()=>this.onMouseDown())),this.eventManager.addEventListener(e,"mouseup",(()=>this.onMouseUp()));for(let t=0,r=this.main.childNodes.length;t<r;t++){const e=this.main.childNodes[t];this.eventManager.addEventListener(e,"mouseenter",(e=>this.onMouseEnter(e,this.main.childNodes[t])))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,t){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),No(e);const r=this,n=this.wot.rootDocument.body,i=t.getBoundingClientRect();t.style.display="none",this.eventManager.addEventListener(n,"mousemove",(function e(o){var a;((a=o).clientY<Math.floor(i.top)||a.clientY>Math.ceil(i.top+i.height)||a.clientX<Math.floor(i.left)||a.clientX>Math.ceil(i.left+i.width))&&(r.eventManager.removeEventListener(n,"mousemove",e),t.style.display="block")}))}createBorders(e){const{rootDocument:t}=this.wot;this.main=t.createElement("div");const r=["top","start","bottom","end","corner"];let n=this.main.style;n.position="absolute",n.top=0,n.left=0;for(let a=0;a<5;a++){const i=r[a],o=t.createElement("div");o.className=`wtBorder ${this.settings.className||""}`,this.settings[i]&&this.settings[i].hide&&(o.className+=" hidden"),n=o.style,n.backgroundColor=this.settings[i]&&this.settings[i].color?this.settings[i].color:e.border.color,n.height=this.settings[i]&&this.settings[i].width?`${this.settings[i].width}px`:`${e.border.width}px`,n.width=this.settings[i]&&this.settings[i].width?`${this.settings[i].width}px`:`${e.border.width}px`,this.main.appendChild(o)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),Eo()&&this.instance.getSetting("isDataViewInstance")&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:i}=this.wot;let o=i.bordersHolder;o||(o=t.createElement("div"),o.className="htBorders",i.bordersHolder=o,i.spreader.appendChild(o)),o.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:e}=this.wot;this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};co({position:"absolute",height:"40px",width:"40px","border-radius":`${parseInt(40/1.5,10)}px`},((e,t)=>{this.selectionHandles.styles.bottomHitArea[t]=e,this.selectionHandles.styles.topHitArea[t]=e}));co({position:"absolute",height:"10px",width:"10px","border-radius":`${parseInt(10/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"},((e,t)=>{this.selectionHandles.styles.bottom[t]=e,this.selectionHandles.styles.top[t]=e})),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,t){const r=this.wot.selectionManager.getAreaSelection();return!(!r.cellRange||e===r.cellRange.to.row&&t===r.cellRange.to.col)}updateMultipleSelectionHandlesPosition(e,t,r,n,i,o){const a=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:s,topHitArea:l,bottom:c,bottomHitArea:u}=this.selectionHandles.styles,h=parseInt(s.borderWidth,10),d=parseInt(s.width,10),f=parseInt(l.width,10),g=this.wot.wtTable.getWidth(),p=this.wot.wtTable.getHeight();s.top=`${parseInt(r-d-1,10)}px`,s[a]=`${parseInt(n-d-1,10)}px`,l.top=`${parseInt(r-f/4*3,10)}px`,l[a]=`${parseInt(n-f/4*3,10)}px`;const m=Math.min(parseInt(n+i,10),g-d-2*h),v=Math.min(parseInt(n+i-f/4,10),g-f-2*h);c[a]=`${m}px`,u[a]=`${v}px`;const b=Math.min(parseInt(r+o,10),p-d-2*h),y=Math.min(parseInt(r+o-f/4,10),p-f-2*h);c.top=`${b}px`,u.top=`${y}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(s.display="block",l.display="block",this.isPartRange(e,t)?(c.display="none",u.display="none"):(c.display="block",u.display="block")):(s.display="none",c.display="none",l.display="none",u.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||t===this.wot.wtSettings.getSetting("fixedColumnsStart")?(s.zIndex="9999",l.zIndex="9999"):(s.zIndex="",l.zIndex="")}appear(e){if(this.disabled)return;const{wtTable:t,rootDocument:r,rootWindow:n}=this.wot;let i,o,a,s,l,c;const u=t.getRenderedRowsCount();for(let P=0;P<u;P+=1){const r=t.rowFilter.renderedToSource(P);if(r>=e[0]&&r<=e[2]){i=r,l=e[0];break}}for(let P=u-1;P>=0;P-=1){const r=t.rowFilter.renderedToSource(P);if(r>=e[0]&&r<=e[2]){o=r;break}}const h=t.getRenderedColumnsCount();for(let P=0;P<h;P+=1){const r=t.columnFilter.renderedToSource(P);if(r>=e[1]&&r<=e[3]){a=r,c=e[1];break}}for(let P=h-1;P>=0;P-=1){const r=t.columnFilter.renderedToSource(P);if(r>=e[1]&&r<=e[3]){s=r;break}}if(void 0===i||void 0===a)return void this.disappear();let d=t.getCell(this.wot.createCellCoords(i,a));const f=i!==o||a!==s,g=f?t.getCell(this.wot.createCellCoords(o,s)):d,p=Jn(d),m=f?Jn(g):p,v=Jn(t.TABLE),b=ai(t.TABLE),y=p.top,w=p.left,S=this.wot.wtSettings.getSetting("rtlMode");let C=0,k=0;if(S){const e=ai(d),t=n.innerWidth-v.left-b;k=w+e-m.left,C=n.innerWidth-w-e-t-1}else k=m.left+ai(g)-w,C=w-v.left-1;if(this.isEntireColumnSelected(i,o)){const e=this.getDimensionsFromHeader("columns",a,s,l,v);let t=null;e&&([t,C,k]=e),t&&(d=t)}let x=y-v.top-1,E=m.top+si(g)-y;if(this.isEntireRowSelected(a,s)){const e=this.getDimensionsFromHeader("rows",i,o,c,v);let t=null;e&&([t,x,E]=e),t&&(d=t)}const T=oi(d,n);parseInt(T.borderTopWidth,10)>0&&(x+=1,E=E>0?E-1:0),parseInt(T[S?"borderRightWidth":"borderLeftWidth"],10)>0&&(C+=1,k=k>0?k-1:0);const _=S?"right":"left";this.topStyle.top=`${x}px`,this.topStyle[_]=`${C}px`,this.topStyle.width=`${k}px`,this.topStyle.display="block",this.startStyle.top=`${x}px`,this.startStyle[_]=`${C}px`,this.startStyle.height=`${E}px`,this.startStyle.display="block";const A=Math.floor(this.settings.border.width/2);this.bottomStyle.top=x+E-A+"px",this.bottomStyle[_]=`${C}px`,this.bottomStyle.width=`${k}px`,this.bottomStyle.display="block",this.endStyle.top=`${x}px`,this.endStyle[_]=C+k-A+"px",this.endStyle.height=`${E+1}px`,this.endStyle.display="block";let R=this.settings.border.cornerVisible;R="function"===typeof R?R(this.settings.layerLevel):R;const O=this.wot.getSetting("onModifyGetCellCoords",o,s);let[M,I]=[o,s];if(O&&Array.isArray(O)&&([,,M,I]=O),Eo()||!R||this.isPartRange(M,I))this.cornerStyle.display="none";else{this.cornerStyle.top=x+E+this.cornerCenterPointOffset-1+"px",this.cornerStyle[_]=C+k+this.cornerCenterPointOffset-1+"px",this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let e=ni(t.TABLE);const i=e===n;i&&(e=r.documentElement);const a=parseInt(this.cornerDefaultStyle.width,10)/2,l=parseInt(this.cornerDefaultStyle.height,10)/2;if(s===this.wot.getSetting("totalColumns")-1){const t=i?g.getBoundingClientRect().left:g.offsetLeft;let r=!1,n=0;S?(n=t-parseInt(this.cornerDefaultStyle.width,10)/2,r=n<0):(n=t+ai(g)+parseInt(this.cornerDefaultStyle.width,10)/2,r=n>=ci(e)),r&&(this.cornerStyle[_]=`${Math.floor(C+k+this.cornerCenterPointOffset-a)}px`,this.cornerStyle[S?"borderLeftWidth":"borderRightWidth"]=0)}if(o===this.wot.getSetting("totalRows")-1){(i?g.getBoundingClientRect().top:g.offsetTop)+si(g)+parseInt(this.cornerDefaultStyle.height,10)/2>=li(e)&&(this.cornerStyle.top=`${Math.floor(x+E+this.cornerCenterPointOffset-l)}px`,this.cornerStyle.borderBottomWidth=0)}this.cornerStyle.display="block"}Eo()&&this.instance.getSetting("isDataViewInstance")&&this.updateMultipleSelectionHandlesPosition(o,s,x,C,k,E)}isEntireColumnSelected(e,t){return e===this.wot.wtTable.getFirstRenderedRow()&&t===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,t){return e===this.wot.wtTable.getFirstRenderedColumn()&&t===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,t,r,n,i){const{wtTable:o}=this.wot,a=o.wtRootElement.parentNode;let s=null,l=null,c=null,u=null,h=null,d=null,f=null,g=null;switch(e){case"rows":s=function(){return o.getRowHeader(...arguments)},l=function(){return si(...arguments)},c="ht__selection--rows",d="top";break;case"columns":s=function(){return o.getColumnHeader(...arguments)},l=function(){return ai(...arguments)},c="ht__selection--columns",d="left"}if(a.classList.contains(c)){const e=this.wot.getSetting("columnHeaders").length;if(f=s(t,e-n),g=s(r,e-n),!f||!g)return!1;const o=Jn(f),a=Jn(g);return f&&g&&(u=o[d]-i[d]-1,h=a[d]+l(g)-o[d]),[f,u,h]}return!1}changeBorderStyle(e,t){const r=this[e].style,n=t[e];!n||n.hide?jn(this[e],"hidden"):(Un(this[e],"hidden")&&Wn(this[e],"hidden"),r.backgroundColor=n.color,"top"!==e&&"bottom"!==e||(r.height=`${n.width}px`),"start"!==e&&"end"!==e||(r.width=`${n.width}px`))}changeBorderToDefaultStyle(e){const t=1,r="#000",n=this[e].style;n.backgroundColor=r,n.width=`${t}px`,n.height=`${t}px`}toggleHiddenClass(e,t){this.changeBorderToDefaultStyle(e),t?jn(this[e],"hidden"):Wn(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",Eo()&&this.instance.getSetting("isDataViewInstance")&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}};function _u(e,t,r){Au(e,t),t.set(e,r)}function Au(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ru(e,t){return e.get(Mu(e,t))}function Ou(e,t,r){return e.set(Mu(e,t),r),r}function Mu(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var Iu=new WeakMap,Pu=new WeakMap,Nu=new WeakMap,Du=new WeakMap,Fu=new WeakMap,Lu=new WeakMap,Hu=new WeakSet;class Bu{constructor(e){!function(e,t){Au(e,t),t.add(e)}(this,Hu),_u(this,Iu,void 0),_u(this,Pu,void 0),_u(this,Nu,new xu),_u(this,Du,new WeakMap),_u(this,Fu,new WeakSet),_u(this,Lu,new Map),Ou(Pu,this,e)}setActiveOverlay(e){return Ou(Iu,this,e),Ru(Nu,this).setActiveOverlay(Ru(Iu,this)),Ru(Du,this).has(Ru(Iu,this))||Ru(Du,this).set(Ru(Iu,this),new Set),this}getFocusSelection(){return null!==Ru(Pu,this)?Ru(Pu,this).getFocus():null}getAreaSelection(){return null!==Ru(Pu,this)?Ru(Pu,this).createLayeredArea():null}getBorderInstance(e){if(!e.settings.border)return null;if(Ru(Lu,this).has(e)){const t=Ru(Lu,this).get(e);if(t.has(Ru(Iu,this)))return t.get(Ru(Iu,this));const r=new Tu(Ru(Iu,this),e.settings);return t.set(Ru(Iu,this),r),r}const t=new Tu(Ru(Iu,this),e.settings);return Ru(Lu,this).set(e,new Map([[Ru(Iu,this),t]])),t}getBorderInstances(e){var t,r;return Array.from(null!==(t=null===(r=Ru(Lu,this).get(e))||void 0===r?void 0:r.values())&&void 0!==t?t:[])}destroyBorders(e){Ru(Lu,this).get(e).forEach((e=>e.destroy())),Ru(Lu,this).delete(e)}render(e){if(null===Ru(Pu,this))return;e&&Mu(Hu,this,Uu).call(this);const t=Array.from(Ru(Pu,this)),r=new Map,n=new Map;for(let i=0;i<t.length;i++){const e=t[i],{className:o,headerAttributes:a,createLayers:s,selectionType:l}=e.settings;Ru(Fu,this).has(e)||(Ru(Fu,this).add(e),e.addLocalHook("destroy",(()=>this.destroyBorders(e))));const c=this.getBorderInstance(e);if(e.isEmpty()){null===c||void 0===c||c.disappear();continue}if(o){Ru(Nu,this).setActiveSelection(e).scan().forEach((e=>{if(r.has(e)){const t=r.get(e);t.has(o)&&!0===s?t.set(o,t.get(o)+1):t.set(o,1)}else r.set(e,new Map([[o,1]]));a&&(n.has(e)||n.set(e,[]),"TH"===e.nodeName&&n.get(e).push(...a))}))}const u=e.getCorners();Ru(Iu,this).getSetting("onBeforeDrawBorders",u,l),null===c||void 0===c||c.appear(u)}r.forEach(((e,t)=>{var r;const n=Array.from(e).map((e=>{let[t,r]=e;return 1===r?t:[t,...Array.from({length:r-1},((e,r)=>`${t}-${r+1}`))]})).flat();n.forEach((e=>Ru(Du,this).get(Ru(Iu,this)).add(e))),jn(t,n),"TD"===t.nodeName&&Array.isArray(null===(r=Ru(Pu,this).options)||void 0===r?void 0:r.cellAttributes)&&Vn(t,Ru(Pu,this).options.cellAttributes)})),Array.from(n.keys()).forEach((e=>{Vn(e,[...n.get(e)])}))}}function Uu(){const e=Ru(Du,this).get(Ru(Iu,this)),t=Ru(Iu,this).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(t))for(let r=0;r<t.length;r++)e.add(t[r]);e.forEach((e=>{var t,r;const n=Ru(Iu,this).wtTable.TABLE.querySelectorAll(`.${e}`);let i=[];Array.isArray(null===(t=Ru(Pu,this).options)||void 0===t?void 0:t.cellAttributes)&&(i=Ru(Pu,this).options.cellAttributes.map((e=>e[0]))),Array.isArray(null===(r=Ru(Pu,this).options)||void 0===r?void 0:r.headerAttributes)&&(i=[...i,...Ru(Pu,this).options.headerAttributes.map((e=>e[0]))]);for(let o=0,a=n.length;o<a;o++)Wn(n[o],e),zn(n[o],i)})),e.clear()}class ju extends hc{constructor(e,t){super(e,new Xc(t));const r=this.wtSettings.getSetting("facade",this);this.wtTable=new Zc(this.getTableDao(),r,this.domBindings,this.wtSettings),this.wtViewport=new pu(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new Bu(this.wtSettings.getSetting("selections")),this.wtEvent=new Is(r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new Kc(this,r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const e=[],t=[];co({rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},((r,n)=>{this.wtSettings.getSetting(n).length&&t.push(r),e.push(r)})),Wn(this.wtTable.wtRootElement.parentNode,e),jn(this.wtTable.wtRootElement.parentNode,t)}getOverlayByName(e){var t;if(!Il.includes(e))return null;const r=e.replace(/_([a-z])/g,(e=>e[1].toUpperCase()));return null!==(t=this.wtOverlays[`${r}Overlay`])&&void 0!==t?t:null}getViewportDao(){const e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}class Wu{constructor(e){e instanceof hc?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=e=>{const t=new Wu(e);return()=>t},this._wot=new ju(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}createCellCoords(e,t){return this._wot.createCellCoords(e,t)}createCellRange(e,t,r){return this._wot.createCellRange(e,t,r)}draw(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._wot.draw(e),this}getCell(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this._wot.getCell(e,t)}scrollViewport(e,t,r,n,i){return this._wot.scrollViewport(e,t,r,n,i)}scrollViewportHorizontally(e,t,r){return this._wot.scrollViewportHorizontally(e,t,r)}scrollViewportVertically(e,t,r){return this._wot.scrollViewportVertically(e,t,r)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}getOverlayByName(e){return this._wot.getOverlayByName(e)}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,t){return this._wot.wtSettings.update(e,t),this}getSetting(e,t,r,n,i){return this._wot.wtSettings.getSetting(e,t,r,n,i)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}}function Vu(e){let{isShiftKey:t,isLeftClick:r,isRightClick:n,coords:i,selection:o,controller:a,cellCoordsFactory:s}=e;const l=o.isSelected()?o.getSelectedRange().current():null,c=o.isSelectedByCorner(),u=o.isSelectedByRowHeader();if(o.markSource("mouse"),t&&l)i.row>=0&&i.col>=0&&!a.cell?o.setRangeEnd(i):(c||u)&&i.row>=0&&i.col>=0&&!a.cell?o.setRangeEnd(s(i.row,i.col)):c&&i.row<0&&!a.column?o.setRangeEnd(s(l.to.row,i.col)):u&&i.col<0&&!a.row?o.setRangeEnd(s(i.row,l.to.col)):(!c&&!u&&i.col<0||c&&i.col<0)&&!a.row?o.selectRows(Math.max(l.from.row,0),i.row,i.col):(!c&&!u&&i.row<0||u&&i.row<0)&&!a.column&&o.selectColumns(Math.max(l.from.col,0),i.col,i.row);else{const e=!o.inInSelection(i),t=r||n&&e;i.row<0&&i.col>=0&&!a.column?t&&o.selectColumns(i.col,i.col,i.row):i.col<0&&i.row>=0&&!a.row?t&&o.selectRows(i.row,i.row,i.col):i.col>=0&&i.row>=0&&!a.cell?t&&o.setRangeStart(i):i.col<0&&i.row<0&&o.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}o.markEndSource()}const zu=new Map([["mousedown",Vu],["mouseover",function(e){let{isLeftClick:t,coords:r,selection:n,controller:i,cellCoordsFactory:o}=e;if(!t)return;const a=n.isSelectedByRowHeader(),s=n.isSelectedByColumnHeader(),l=n.tableProps.countCols(),c=n.tableProps.countRows();n.markSource("mouse"),s&&!i.column?n.setRangeEnd(o(c-1,r.col)):a&&!i.row?n.setRangeEnd(o(r.row,l-1)):i.cell||n.setRangeEnd(r),n.markEndSource()}],["touchstart",Vu]]);function qu(e,t){let{coords:r,selection:n,controller:i,cellCoordsFactory:o}=t;zu.get(e.type)({coords:r,selection:n,controller:i,cellCoordsFactory:o,isShiftKey:e.shiftKey,isLeftClick:Lo(e)||"touchstart"===e.type,isRightClick:Fo(e)})}const Gu=new WeakMap,$u=Symbol("rootInstance");function Ku(e){return e===$u}function Yu(e){return Gu.has(e)}function Xu(e,t,r){Ju(e,t),t.set(e,r)}function Ju(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Zu(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Qu(e,t){return e.get(th(e,t))}function eh(e,t,r){return e.set(th(e,t),r),r}function th(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var rh=new WeakMap,nh=new WeakMap,ih=new WeakMap,oh=new WeakMap,ah=new WeakMap,sh=new WeakMap,lh=new WeakMap,ch=new WeakSet;function uh(){return parseInt(this.hot.rootElement.getAttribute(kn()[0]),10)}function hh(e){const t=th(ch,this,uh).call(this)+e;Vn(this.hot.rootElement,...kn(t))}const dh=class{constructor(e){!function(e,t){Ju(e,t),t.add(e)}(this,ch),Zu(this,"hot",void 0),Zu(this,"eventManager",void 0),Zu(this,"settings",void 0),Zu(this,"THEAD",void 0),Zu(this,"TBODY",void 0),Zu(this,"_wt",void 0),Zu(this,"activeWt",void 0),Xu(this,rh,0),Xu(this,nh,0),Zu(this,"postponedAdjustElementsSize",!1),Xu(this,ih,!1),Xu(this,oh,void 0),Xu(this,ah,void 0),Xu(this,sh,0),Xu(this,lh,0),this.hot=e,this.eventManager=new ca(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){this.hot.isRenderSuspended()||(this.hot.runHooks("beforeRender",this.hot.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this._wt.draw(!this.hot.forceFullRender),this.hot.runHooks("afterRender",this.hot.forceFullRender),this.hot.forceFullRender=!1,this.hot.renderCall=!1)}adjustElementsSize(){this.hot.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize()}getCellAtCoords(e,t){const r=this._wt.getCell(e,t);return r<0?null:r}scrollViewport(e,t,r,n,i){return this._wt.scrollViewport(e,t,r,n,i)}scrollViewportHorizontally(e,t,r){return this._wt.scrollViewportHorizontally(e,t,r)}scrollViewportVertically(e,t,r){return this._wt.scrollViewportVertically(e,t,r)}createElements(){const{rootElement:e,rootDocument:t}=this.hot,r=e.getAttribute("style");r&&e.setAttribute("data-originalstyle",r),jn(e,"handsontable"),eh(ah,this,t.createElement("TABLE")),jn(Qu(ah,this),"htCore"),this.hot.getSettings().tableClassName&&jn(Qu(ah,this),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(Vn(Qu(ah,this),[vn()]),Vn(e,[["role","treegrid"],Cn(-1),kn(this.hot.countCols()),["aria-multiselectable","true"]])),this.THEAD=t.createElement("THEAD"),Qu(ah,this).appendChild(this.THEAD),this.TBODY=t.createElement("TBODY"),Qu(ah,this).appendChild(this.TBODY),this.hot.table=Qu(ah,this),this.hot.container.insertBefore(Qu(ah,this),this.hot.container.firstChild)}registerEvents(){const{rootElement:e,rootDocument:t,selection:r,rootWindow:n}=this.hot,i=t.documentElement;this.eventManager.addEventListener(e,"mousedown",(e=>{eh(ih,this,!0),this.isTextSelectionAllowed(e.target)||(hi(n),e.preventDefault(),n.focus())})),this.eventManager.addEventListener(e,"mouseup",(()=>{eh(ih,this,!1)})),this.eventManager.addEventListener(e,"mousemove",(e=>{Qu(ih,this)&&!this.isTextSelectionAllowed(e.target)&&(this.settings.fragmentSelection&&hi(n),e.preventDefault())})),this.eventManager.addEventListener(i,"keyup",(e=>{r.isInProgress()&&!e.shiftKey&&r.finish()})),this.eventManager.addEventListener(i,"mouseup",(n=>{r.isInProgress()&&Lo(n)&&r.finish(),eh(oh,this,!1);const i=bi(t.activeElement);vi(t.activeElement)&&!i||!i&&(r.isSelected()||r.isSelectedByAnyHeader()||e.contains(n.target)||Fo(n))||this.hot.unlisten()})),this.eventManager.addEventListener(i,"contextmenu",(e=>{r.isInProgress()&&Fo(e)&&(r.finish(),eh(oh,this,!1))})),this.eventManager.addEventListener(i,"touchend",(()=>{r.isInProgress()&&r.finish(),eh(oh,this,!1)})),this.eventManager.addEventListener(i,"mousedown",(r=>{const n=r.target,o=r.x||r.clientX,a=r.y||r.clientY;let s=r.target;if(Qu(oh,this)||!e||!this.hot.view)return;const{holder:l}=this._wt.wtTable;if(s===l){const e=gi(t);if(t.elementFromPoint(o+e,a)!==l||t.elementFromPoint(o,a+e)!==l)return}else for(;s!==i;){if(null===s){if(r.isTargetWebComponent)break;return}if(s===e)return;s=s.parentNode}("function"===typeof this.settings.outsideClickDeselects?this.settings.outsideClickDeselects(n):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)}));let o=Pn(n);for(;null!==o;)this.eventManager.addEventListener(o.document.documentElement,"click",(()=>{this.hot.unlisten()})),o=Pn(o);this.eventManager.addEventListener(Qu(ah,this),"selectstart",(e=>{this.settings.fragmentSelection||vi(e.target)||e.preventDefault()}))}translateFromRenderableToVisualCoords(e){let{row:t,col:r}=e;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(t,r))}translateFromRenderableToVisualIndex(e,t){let r=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e,n=t>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(t):t;return null===r&&(r=e),null===n&&(n=t),[r,n]}countRenderableIndexes(e,t){const r=Math.min(e.getNotTrimmedIndexesLength(),t),n=e.getNearestNotHiddenIndex(r-1,-1);return null===n?0:e.getRenderableFromVisualIndex(n)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,t){return this.countNotHiddenIndexes(e,t,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,t){return this.countNotHiddenIndexes(e,t,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,t,r,n){if(isNaN(e)||e<0)return 0;const i=r.getNearestNotHiddenIndex(e,t),o=r.getRenderableFromVisualIndex(i);if(!Number.isInteger(o))return 0;let a=0;return t<0?a=o+1:t>0&&(a=n-o),a}countNotHiddenFixedColumnsStart(){const e=this.hot.countCols(),t=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(t,-1)}countNotHiddenFixedRowsTop(){const e=this.hot.countRows(),t=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(t,-1)}countNotHiddenFixedRowsBottom(){const e=this.hot.countRows(),t=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(t,1)}countRenderableColumnsInRange(e,t){let r=0;for(let n=e;n<=t;n++)null!==this.hot.columnIndexMapper.getRenderableFromVisualIndex(n)&&(r+=1);return r}countRenderableRowsInRange(e,t){let r=0;for(let n=e;n<=t;n++)null!==this.hot.rowIndexMapper.getRenderableFromVisualIndex(n)&&(r+=1);return r}isMainTableNotFullyCoveredByOverlays(){const e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),t=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>e&&this.hot.countRenderedCols()>t}initializeWalkontable(){const e={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:Qu(ah,this),isDataViewInstance:()=>Yu(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,stretchH:()=>this.settings.stretchH,data:(e,t)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(e,t)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||e.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||e.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,renderAllColumns:this.settings.renderAllColumns,rowHeaders:()=>{const e=[];return this.hot.hasRowHeaders()&&e.push(((e,t)=>{const r=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e;this.appendRowHeader(r,t)})),this.hot.runHooks("afterGetRowHeaderRenderers",e),eh(nh,this,e.length),this.hot.getSettings().ariaTags&&th(ch,this,uh).call(this)===this.hot.countCols()&&th(ch,this,hh).call(this,Qu(nh,this)),e},columnHeaders:()=>{const e=[];return this.hot.hasColHeaders()&&e.push(((e,t)=>{const r=e>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(e):e;this.appendColHeader(r,t)})),this.hot.runHooks("afterGetColumnHeaderRenderers",e),eh(rh,this,e.length),e},columnWidth:e=>{const t=this.hot.columnIndexMapper.getVisualFromRenderableIndex(e);return this.hot.getColWidth(null===t?e:t)},rowHeight:e=>{const t=this.hot.rowIndexMapper.getVisualFromRenderableIndex(e);return this.hot.getRowHeight(null===t?e:t)},rowHeightByOverlayName:(e,t)=>{const r=this.hot.rowIndexMapper.getVisualFromRenderableIndex(e),n=null===r?e:r;return this.hot.runHooks("modifyRowHeightByOverlayName",this.hot.getRowHeight(n),n,t)},cellRenderer:(e,t,r)=>{const[n,i]=this.translateFromRenderableToVisualIndex(e,t),o=this.hot.runHooks("modifyGetCellCoords",n,i);let a=n,s=i;Array.isArray(o)&&([a,s]=o);const l=this.hot.getCellMeta(a,s),c=this.hot.colToProp(s);let u=this.hot.getDataAtRowProp(a,c);this.hot.hasHook("beforeValueRender")&&(u=this.hot.runHooks("beforeValueRender",u,l)),this.hot.runHooks("beforeRenderer",r,n,i,c,u,l),this.hot.getCellRenderer(l)(this.hot,r,n,i,c,u,l),this.hot.runHooks("afterRenderer",r,n,i,c,u,l)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&Xn(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(e,t,r,n)=>{const i=this.translateFromRenderableToVisualCoords(t),o={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=n,eh(oh,this,!0),this.hot.runHooks("beforeOnCellMouseDown",e,i,r,o),Do(e)||(qu(e,{coords:i,selection:this.hot.selection,controller:o,cellCoordsFactory:(e,t)=>this.hot._createCellCoords(e,t)}),this.hot.runHooks("afterOnCellMouseDown",e,i,r),this.activeWt=this._wt)},onCellContextMenu:(e,t,r,n)=>{const i=this.translateFromRenderableToVisualCoords(t);this.activeWt=n,eh(oh,this,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",e,i,r),Do(e)||(this.hot.runHooks("afterOnCellContextMenu",e,i,r),this.activeWt=this._wt)},onCellMouseOut:(e,t,r,n)=>{const i=this.translateFromRenderableToVisualCoords(t);this.activeWt=n,this.hot.runHooks("beforeOnCellMouseOut",e,i,r),Do(e)||(this.hot.runHooks("afterOnCellMouseOut",e,i,r),this.activeWt=this._wt)},onCellMouseOver:(e,t,r,n)=>{const i=this.translateFromRenderableToVisualCoords(t),o={row:!1,column:!1,cell:!1};this.activeWt=n,this.hot.runHooks("beforeOnCellMouseOver",e,i,r,o),Do(e)||(Qu(oh,this)&&qu(e,{coords:i,selection:this.hot.selection,controller:o,cellCoordsFactory:(e,t)=>this.hot._createCellCoords(e,t)}),this.hot.runHooks("afterOnCellMouseOver",e,i,r),this.activeWt=this._wt)},onCellMouseUp:(e,t,r,n)=>{const i=this.translateFromRenderableToVisualCoords(t);this.activeWt=n,this.hot.runHooks("beforeOnCellMouseUp",e,i,r),Do(e)||this.hot.isDestroyed||(this.hot.runHooks("afterOnCellMouseUp",e,i,r),this.activeWt=this._wt)},onCellCornerMouseDown:e=>{e.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",e)},onCellCornerDblClick:e=>{e.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",e)},beforeDraw:(e,t)=>this.beforeRender(e,t),onDraw:e=>this.afterRender(e),onBeforeViewportScrollVertically:e=>{const t=this.hot.rowIndexMapper,r=e<0;let n=e;return r||(n=t.getVisualFromRenderableIndex(e),null!==n)?(n=this.hot.runHooks("beforeViewportScrollVertically",n),this.hot.runHooks("beforeViewportScroll"),r?n:t.getRenderableFromVisualIndex(n)):e},onBeforeViewportScrollHorizontally:e=>{const t=this.hot.columnIndexMapper,r=e<0;let n=e;return r||(n=t.getVisualFromRenderableIndex(e),null!==n)?(n=this.hot.runHooks("beforeViewportScrollHorizontally",n),this.hot.runHooks("beforeViewportScroll"),r?n:t.getRenderableFromVisualIndex(n)):e},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(e,t,r)=>{const n=this.hot.rowIndexMapper,i=e<0;let o=e;i||(o=n.getVisualFromRenderableIndex(e));const a=this.hot.runHooks("beforeHighlightingRowHeader",o,t,r);return i?a:n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(a,1))},onBeforeHighlightingColumnHeader:(e,t,r)=>{const n=this.hot.columnIndexMapper,i=e<0;let o=e;i||(o=n.getVisualFromRenderableIndex(e));const a=this.hot.runHooks("beforeHighlightingColumnHeader",o,t,r);return i?a:n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(a,1))},onAfterDrawSelection:(e,t,r)=>{let n;const[i,o]=this.translateFromRenderableToVisualIndex(e,t),a=this.hot.selection.getSelectedRange();if(a.size()>0){const e=a.peekByIndex(null!==r&&void 0!==r?r:0);n=[e.from.row,e.from.col,e.to.row,e.to.col]}return this.hot.runHooks("afterDrawSelection",i,o,n,r)},onBeforeDrawBorders:(e,t)=>{const[r,n,i,o]=e,a=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(r),this.hot.columnIndexMapper.getVisualFromRenderableIndex(n),this.hot.rowIndexMapper.getVisualFromRenderableIndex(i),this.hot.columnIndexMapper.getVisualFromRenderableIndex(o)];return this.hot.runHooks("beforeDrawBorders",a,t)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onBeforeStretchingColumnWidth:(e,t)=>{const r=this.hot.columnIndexMapper.getVisualFromRenderableIndex(t);return this.hot.runHooks("beforeStretchingColumnWidth",e,r)},onModifyRowHeaderWidth:e=>this.hot.runHooks("modifyRowHeaderWidth",e),onModifyGetCellCoords:(e,t,r)=>{const n=this.hot.rowIndexMapper,i=this.hot.columnIndexMapper,o=t>=0?i.getVisualFromRenderableIndex(t):t,a=e>=0?n.getVisualFromRenderableIndex(e):e,s=this.hot.runHooks("modifyGetCellCoords",a,o,r);if(Array.isArray(s)){const[e,t,r,o]=s;return[e>=0?n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(e,1)):e,t>=0?i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(t,1)):t,r>=0?n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(r,-1)):r,o>=0?i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(o,-1)):o]}},viewportRowCalculatorOverride:e=>{let t=this.settings.viewportRowRenderingOffset;if("auto"===t&&this.settings.fixedRowsTop&&(t=10),t>0||"auto"===t){const r=this.countRenderableRows(),n=e.startRow,i=e.endRow;if("number"===typeof t)e.startRow=Math.max(n-t,0),e.endRow=Math.min(i+t,r-1);else if("auto"===t){const t=Math.ceil(i/r*12);e.startRow=Math.max(n-t,0),e.endRow=Math.min(i+t,r-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",e)},viewportColumnCalculatorOverride:e=>{let t=this.settings.viewportColumnRenderingOffset;if("auto"===t&&this.settings.fixedColumnsStart&&(t=10),t>0||"auto"===t){const r=this.countRenderableColumns(),n=e.startColumn,i=e.endColumn;if("number"===typeof t&&(e.startColumn=Math.max(n-t,0),e.endColumn=Math.min(i+t,r-1)),"auto"===t){const t=Math.ceil(i/r*6);e.startColumn=Math.max(n-t,0),e.endColumn=Math.min(i+t,r-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",e)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const e=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||e}};this.hot.runHooks("beforeInitWalkontable",e),this._wt=new Wu(e),this.activeWt=this._wt;const t=this._wt.wtTable.spreader,{width:r,height:n}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(r,n),this.eventManager.addEventListener(t,"mousedown",(e=>{e.target===t&&3===e.which&&e.stopPropagation()})),this.eventManager.addEventListener(t,"contextmenu",(e=>{e.target===t&&3===e.which&&e.stopPropagation()})),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",(()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&(this.hot.forceFullRender=!0,this.render())}))}isTextSelectionAllowed(e){if(vi(e))return!0;const t=Fn(e,this._wt.wtTable.spreader);return!(!0!==this.settings.fragmentSelection||!t)||(!("cell"!==this.settings.fragmentSelection||!this.isSelectedOnlyCell()||!t)||!(this.settings.fragmentSelection||!this.isCellEdited()||!this.isSelectedOnlyCell()))}isMouseDown(){return Qu(oh,this)}isSelectedOnlyCell(){var e,t;return null!==(e=null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.isSingleCell())&&void 0!==e&&e}isCellEdited(){const e=this.hot.getActiveEditor();return e&&e.isOpened()}beforeRender(e,t){e&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,t)}afterRender(e){e&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(e,t){if(t.firstChild){const r=t.firstChild;if(!Un(r,"relative"))return Gn(t),void this.appendRowHeader(e,t);this.updateCellHeader(r.querySelector(".rowHeader"),e,this.hot.getRowHeader)}else{const{rootDocument:r,getRowHeader:n}=this.hot,i=r.createElement("div"),o=r.createElement("span");i.className="relative",o.className="rowHeader",this.updateCellHeader(o,e,n),i.appendChild(o),t.appendChild(i)}this.hot.runHooks("afterGetRowHeader",e,t)}appendColHeader(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.hot.getColHeader,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;const i=()=>{const t=e>=0?this.hot.getColumnMeta(e).headerClassName:null;return t?t.split(" "):[]};if(t.firstChild){const o=t.firstChild;Un(o,"relative")?(this.updateCellHeader(o.querySelector(".colHeader"),e,r,n),o.className="",jn(o,["relative",...i()])):(Gn(t),this.appendColHeader(e,t,r,n))}else{const{rootDocument:o}=this.hot,a=o.createElement("div"),s=o.createElement("span"),l=i();a.classList.add("relative",...l),s.className="colHeader",this.settings.ariaTags&&(Vn(a,...vn()),Vn(s,...vn())),this.updateCellHeader(s,e,r,n),a.appendChild(s),t.appendChild(a)}this.hot.runHooks("afterGetColHeader",e,t,n)}updateCellHeader(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=t;const o=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(Un(e,"colHeader")?i=o.wtTable.columnFilter.sourceToRendered(t):Un(e,"rowHeader")&&(i=o.wtTable.rowFilter.sourceToRendered(t))),i>-1?Kn(e,r(t,n)):(Yn(e,String.fromCharCode(160)),jn(e,"cornerHeader"))}maximumVisibleElementWidth(e){const t=this._wt.wtViewport.getWorkspaceWidth()-e;return t>0?t:0}maximumVisibleElementHeight(e){const t=this._wt.wtViewport.getWorkspaceHeight()-e;return t>0?t:0}setLastSize(e,t){eh(sh,this,e),eh(lh,this,t)}getLastSize(){return{width:Qu(sh,this),height:Qu(lh,this)}}getFirstRenderedVisibleRow(){return this._wt.wtViewport.rowsRenderCalculator?this.hot.rowIndexMapper.getNearestNotHiddenIndex(this._wt.wtTable.getFirstRenderedRow(),1):null}getLastRenderedVisibleRow(){return this._wt.wtViewport.rowsRenderCalculator?this.hot.rowIndexMapper.getNearestNotHiddenIndex(this._wt.wtTable.getLastRenderedRow(),-1):null}getFirstRenderedVisibleColumn(){return this._wt.wtViewport.columnsRenderCalculator?this.hot.columnIndexMapper.getNearestNotHiddenIndex(this._wt.wtTable.getFirstRenderedColumn(),1):null}getLastRenderedVisibleColumn(){return this._wt.wtViewport.columnsRenderCalculator?this.hot.columnIndexMapper.getNearestNotHiddenIndex(this._wt.wtTable.getLastRenderedColumn(),-1):null}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleColumn())}getFirstPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleRow())}getLastPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleRow())}getFirstPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleColumn())}getLastPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleColumn())}getColumnHeadersCount(){return Qu(rh,this)}getRowHeadersCount(){return Qu(nh,this)}getViewportWidth(){return this._wt.wtViewport.getViewportWidth()}getWorkspaceWidth(){return this._wt.wtViewport.getWorkspaceWidth()}getViewportHeight(){return this._wt.wtViewport.getViewportHeight()}getWorkspaceHeight(){return this._wt.wtViewport.getWorkspaceHeight()}getElementOverlayName(e){var t;return(null!==(t=this._wt.wtOverlays.getParentOverlay(e))&&void 0!==t?t:this._wt).wtTable.name}getOverlayByName(e){return this._wt.getOverlayByName(e)}isVisible(){return this._wt.wtTable.isVisible()}destroy(){this._wt.destroy(),this.eventManager.destroy()}},fh=26;function gh(e){let t,r=e+1,n="";for(;r>0;)t=(r-1)%fh,n=String.fromCharCode(65+t)+n,r=parseInt((r-t)/fh,10);return n}function ph(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=e;const n=[];return Array.isArray(e)&&Array.isArray(e[0])||(r=[e]),r.forEach(((e,r)=>{Array.isArray(e)?e.forEach(((e,i)=>{n.push([r+t,i,e])})):Object.keys(e).forEach((i=>{n.push([r+t,i,e[i]])}))})),n}function mh(e){let t=0;return Array.isArray(e)&&(e[0]&&Array.isArray(e[0])?t=e[0].length:e[0]&&so(e[0])&&(t=ho(e[0]))),t}function vh(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const bh=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];vh(this,"hot",void 0),vh(this,"data",void 0),vh(this,"dataType","array"),vh(this,"colToProp",(()=>{})),vh(this,"propToCol",(()=>{})),this.hot=e,this.data=t}modifyRowData(e){let t;return this.hot.hasHook("modifyRowData")&&(t=this.hot.runHooks("modifyRowData",e)),void 0===t||Number.isInteger(t)?this.data[e]:t}getData(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.data&&0!==this.data.length?this.getByRange(null,null,e):this.data}setData(e){this.data=e}getAtColumn(e){const t=[];return Ai(this.data,((r,n)=>{const i=this.getAtCell(n,e);t.push(i)})),t}getAtRow(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i=void 0===t&&void 0===r,{dataDotNotation:o}=this.hot.getSettings();let a=null,s=null;if(a=this.modifyRowData(e),Array.isArray(a))s=[],i?a.forEach(((t,r)=>{s[r]=this.getAtPhysicalCell(e,r,a)})):ja(t,r,(r=>{s[r-t]=this.getAtPhysicalCell(e,r,a)}));else if(so(a)||Yi(a))if(s=n?[]:{},!i||n){const i=0,l=this.countFirstRowKeys()-1;ja(i,l,(c=>{const u=this.colToProp(c);if(c>=(t||i)&&c<=(r||l)&&!Number.isInteger(u)){const t=this.getAtPhysicalCell(e,u,a);n?s.push(t):o?uo(s,u,t):s[u]=t}}))}else co(a,((t,r)=>{const n=this.getAtPhysicalCell(e,r,a);o?uo(s,r,n):s[r]=n}));return s}setAtCell(e,t,r){if(!(e>=this.countRows()||t>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const n=fo(r);this.hot.runHooks("modifySourceData",e,t,n,"set"),n.isTouched()&&(r=n.value)}Number.isInteger(t)?this.data[e][t]=r:uo(this.data[e],t,r)}}getAtPhysicalCell(e,t,r){let n=null;if(r)if("string"===typeof t){const{dataDotNotation:e}=this.hot.getSettings();n=e?function(e,t){const r=t.split(".");let n=e;return co(r,(e=>{if(n=n[e],void 0===n)return n=void 0,!1})),n}(r,t):r[t]}else n="function"===typeof t?t(r):r[t];if(this.hot.hasHook("modifySourceData")){const r=fo(n);this.hot.runHooks("modifySourceData",e,t,r,"get"),r.isTouched()&&(n=r.value)}return n}getAtCell(e,t){const r=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(t),r)}getByRange(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=!1,i=null,o=null,a=null,s=null;null===e||null===t?(n=!0,i=0,a=this.countRows()-1):(i=Math.min(e.row,t.row),o=Math.min(e.col,t.col),a=Math.max(e.row,t.row),s=Math.max(e.col,t.col));const l=[];return ja(i,a,(e=>{l.push(n?this.getAtRow(e,void 0,void 0,r):this.getAtRow(e,o,s,r))})),l}countRows(){if(this.hot.hasHook("modifySourceLength")){const e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return mh(this.data)}destroy(){this.data=null,this.hot=null}},yh={_localHooks:Object.create(null),addLocalHook(e,t){return this._localHooks[e]||(this._localHooks[e]=[]),this._localHooks[e].push(t),this},runLocalHooks(e,t,r,n,i,o,a){if(this._localHooks[e]){const s=this._localHooks[e].length;for(let l=0;l<s;l++)Zi(this._localHooks[e][l],this,t,r,n,i,o,a)}},clearLocalHooks(){return this._localHooks={},this}};lo(yh,"MIXIN_NAME","localHooks",{writable:!1,enumerable:!1});const wh=yh;function Sh(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Ch{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;Sh(this,"indexedValues",[]),Sh(this,"initValueOrFn",void 0),this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){const t=this.indexedValues;if(e<t.length)return t[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,t){return e<this.indexedValues.length&&(this.indexedValues[e]=t,this.runLocalHooks("change"),!0)}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,Yi(this.initValueOrFn)?ja(e-1,(e=>this.indexedValues.push(this.initValueOrFn(e)))):ja(e-1,(()=>this.indexedValues.push(this.initValueOrFn))),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}function kh(e,t,r){return[...e.slice(0,t),...r,...e.slice(t)]}function xh(e,t){return Ti(e,(e=>!1===t.includes(e)))}function Eh(e,t){return _i(e,(e=>e-t.filter((t=>t<e)).length))}function Th(e,t){const r=t[0],n=t.length;return _i(e,(e=>e>=r?e+n:e))}oo(Ch,wh);class _h extends Ch{constructor(){super((e=>e))}insert(e,t){const r=Th(this.indexedValues,t);this.indexedValues=kh(r,e,t),super.insert(e,t)}remove(e){const t=xh(this.indexedValues,e);this.indexedValues=Eh(t,e),super.remove(e)}}function Ah(e,t,r,n){const i=r.length?r[0]:void 0;return[...e.slice(0,i),...r.map(((e,t)=>Yi(n)?n(e,t):n)),...void 0===i?[]:e.slice(i)]}function Rh(e,t){return Ti(e,((e,r)=>!1===t.includes(r)))}class Oh extends Ch{insert(e,t){this.indexedValues=Ah(this.indexedValues,0,t,this.initValueOrFn),super.insert(e,t)}remove(e){this.indexedValues=Rh(this.indexedValues,e),super.remove(e)}}class Mh extends Oh{constructor(){super(arguments.length>0&&void 0!==arguments[0]&&arguments[0])}getHiddenIndexes(){return Ei(this.getValues(),((e,t,r)=>(t&&e.push(r),e)),[])}}function Ih(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Ph extends Ch{constructor(){super(...arguments),Ih(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map((e=>this.indexedValues[e]))}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length&&(this.indexedValues[e]=t,!1===this.orderOfIndexes.includes(e)&&this.orderOfIndexes.splice(r,0,e),this.runLocalHooks("change"),!0)}clearValue(e){this.orderOfIndexes=xh(this.orderOfIndexes,[e]),Yi(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,t){this.indexedValues=Ah(this.indexedValues,0,t,this.initValueOrFn),this.orderOfIndexes=Th(this.orderOfIndexes,t),super.insert(e,t)}remove(e){this.indexedValues=Rh(this.indexedValues,e),this.orderOfIndexes=xh(this.orderOfIndexes,e),this.orderOfIndexes=Eh(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map((e=>[e,this.getValueAtIndex(e)]))}}class Nh extends Oh{constructor(){super(arguments.length>0&&void 0!==arguments[0]&&arguments[0])}getTrimmedIndexes(){return Ei(this.getValues(),((e,t,r)=>(t&&e.push(r),e)),[])}}const Dh=new Map([["hiding",Mh],["index",Ch],["linkedPhysicalIndexToValue",Ph],["physicalIndexToValue",Oh],["trimming",Nh]]);function Fh(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}let Lh=0;class Hh{constructor(){Fh(this,"collection",new Map)}register(e,t){!1===this.collection.has(e)&&(this.collection.set(e,t),t.addLocalHook("change",(()=>this.runLocalHooks("change",t))),Lh+=1)}unregister(e){const t=this.collection.get(e);Ni(t)&&(t.destroy(),this.collection.delete(e),this.runLocalHooks("change",t),Lh-=1)}unregisterAll(){this.collection.forEach(((e,t)=>this.unregister(t))),this.collection.clear()}get(e){return Di(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach((t=>{t.remove(e)}))}insertToEvery(e,t){this.collection.forEach((r=>{r.insert(e,t)}))}initEvery(e){this.collection.forEach((t=>{t.init(e)}))}}function Bh(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}oo(Hh,wh);class Uh extends Hh{constructor(e,t){super(),Bh(this,"mergedValuesCache",[]),Bh(this,"aggregationFunction",void 0),Bh(this,"fallbackValue",void 0),this.aggregationFunction=e,this.fallbackValue=t}getMergedValues(){if(!0===(!(arguments.length>0&&void 0!==arguments[0])||arguments[0]))return this.mergedValuesCache;if(0===this.getLength())return[];const e=_i(this.get(),(e=>e.getValues())),t=[],r=Ni(e[0])&&e[0].length||0;for(let n=0;n<r;n+=1){const r=[];for(let t=0;t<this.getLength();t+=1)r.push(e[t][n]);t.push(r)}return _i(t,this.aggregationFunction)}getMergedValueAtIndex(e,t){const r=this.getMergedValues(t)[e];return Ni(r)?r:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function jh(e,t,r){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,r)}function Wh(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var Vh=new WeakMap;class zh{constructor(){jh(this,Vh,[])}subscribe(e){return this.addLocalHook("change",e),this._write(function(e,t){return e.get(Wh(e,t))}(Vh,this)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){!function(e,t,r){e.set(Wh(e,t),r)}(Vh,this,e)}}function qh(e,t){const r=[];let n=0,i=0;for(;n<e.length&&i<t.length;n++,i++)e[n]!==t[i]&&r.push({op:"replace",index:i,oldValue:e[n],newValue:t[i]});for(;n<t.length;n++)r.push({op:"insert",index:n,oldValue:void 0,newValue:t[n]});for(;i<e.length;i++)r.push({op:"remove",index:i,oldValue:e[i],newValue:void 0});return r}function Gh(e,t,r){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,r)}function $h(e,t){return e.get(Yh(e,t))}function Kh(e,t,r){return e.set(Yh(e,t),r),r}function Yh(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}oo(zh,wh);var Xh=new WeakMap,Jh=new WeakMap,Zh=new WeakMap,Qh=new WeakMap,ed=new WeakMap;class td{constructor(){let{initialIndexValue:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Gh(this,Xh,new Set),Gh(this,Jh,[]),Gh(this,Zh,[]),Gh(this,Qh,!1),Gh(this,ed,!1),Kh(ed,this,null!==e&&void 0!==e&&e)}createObserver(){const e=new zh;return $h(Xh,this).add(e),e.addLocalHook("unsubscribe",(()=>{$h(Xh,this).delete(e)})),e._writeInitialChanges(qh($h(Jh,this),$h(Zh,this))),e}emit(e){let t=$h(Zh,this);$h(Qh,this)&&$h(Jh,this).length===e.length||(0===e.length?e=new Array(t.length).fill($h(ed,this)):Kh(Jh,this,new Array(e.length).fill($h(ed,this))),$h(Qh,this)||(Kh(Qh,this,!0),t=$h(Jh,this)));const r=qh(t,e);$h(Xh,this).forEach((e=>e._write(r))),Kh(Zh,this,e)}}function rd(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}new Set;class nd{constructor(){rd(this,"indexesSequence",new _h),rd(this,"trimmingMapsCollection",new Uh((e=>e.some((e=>!0===e))),!1)),rd(this,"hidingMapsCollection",new Uh((e=>e.some((e=>!0===e))),!1)),rd(this,"variousMapsCollection",new Hh),rd(this,"hidingChangesObservable",new td({initialIndexValue:!1})),rd(this,"notTrimmedIndexesCache",[]),rd(this,"notHiddenIndexesCache",[]),rd(this,"isBatched",!1),rd(this,"indexesSequenceChanged",!1),rd(this,"indexesChangeSource",void 0),rd(this,"trimmedIndexesChanged",!1),rd(this,"hiddenIndexesChanged",!1),rd(this,"renderablePhysicalIndexesCache",[]),rd(this,"fromPhysicalToVisualIndexesCache",new Map),rd(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",(()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)})),this.trimmingMapsCollection.addLocalHook("change",(e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)})),this.hidingMapsCollection.addLocalHook("change",(e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)})),this.variousMapsCollection.addLocalHook("change",(e=>{this.runLocalHooks("change",e,this.variousMapsCollection)}))}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if("hiding"!==e)throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,t,r){return this.registerMap(e,function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!Dh.has(e))throw new Error(`The provided map type ("${e}") does not exist.`);return new(Dh.get(e))(t)}(t,r))}registerMap(e,t){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);t instanceof Nh?this.trimmingMapsCollection.register(e,t):t instanceof Mh?this.hidingMapsCollection.register(e,t):this.variousMapsCollection.register(e,t);const r=this.getNumberOfIndexes();return r>0&&t.init(r),t}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){const t=this.notTrimmedIndexesCache[e];return Ni(t)?t:null}getPhysicalFromRenderableIndex(e){const t=this.renderablePhysicalIndexesCache[e];return Ni(t)?t:null}getVisualFromPhysicalIndex(e){const t=this.fromPhysicalToVisualIndexesCache.get(e);return Ni(t)?t:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){const t=this.fromVisualToRenderableIndexesCache.get(e);return Ni(t)?t:null}getNearestNotHiddenIndex(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null===this.getPhysicalFromVisualIndex(e))return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;const n=Array.from(this.fromVisualToRenderableIndexesCache.keys());let i=-1;return i=t>0?n.findIndex((t=>t>e)):n.reverse().findIndex((t=>t<e)),-1===i?r?this.getNearestNotHiddenIndex(e,-t,!1):null:n[i]}initToLength(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){const t=this.getNumberOfIndexes();if(e<t){const t=[...Array(this.getNumberOfIndexes()-e).keys()].map((t=>t+e));this.removeIndexes(t)}else this.insertIndexes(t,e-t)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){void 0===this.indexesChangeSource&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),"update"===this.indexesChangeSource&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){if(!0===(!(arguments.length>0&&void 0!==arguments[0])||arguments[0]))return this.notTrimmedIndexesCache;return this.getIndexesSequence().filter((e=>!1===this.isTrimmed(e)))}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){if(!0===(!(arguments.length>0&&void 0!==arguments[0])||arguments[0]))return this.notHiddenIndexesCache;return this.getIndexesSequence().filter((e=>!1===this.isHidden(e)))}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){if(!0===(!(arguments.length>0&&void 0!==arguments[0])||arguments[0]))return this.renderablePhysicalIndexesCache;return this.getNotTrimmedIndexes().filter((e=>!1===this.isHidden(e)))}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,t){"number"===typeof e&&(e=[e]);const r=_i(e,(e=>this.getPhysicalFromVisualIndex(e))),n=this.getNotTrimmedIndexesLength(),i=e.length,o=xh(this.getIndexesSequence(),r),a=o.filter((e=>!1===this.isTrimmed(e)));let s=o.indexOf(a[a.length-1])+1;if(t+i<n){const e=a[t];s=o.indexOf(e)}this.indexesChangeSource="move",this.setIndexesSequence(kh(o,s,r)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,t){const r=this.getNotTrimmedIndexes()[e],n=Ni(r)?r:this.getNumberOfIndexes(),i=this.getIndexesSequence().includes(r)?this.getIndexesSequence().indexOf(r):this.getNumberOfIndexes(),o=_i(new Array(t).fill(n),((e,t)=>e+t));this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(i,o),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(i,o),this.hidingMapsCollection.insertToEvery(i,o),this.variousMapsCollection.insertToEvery(i,o),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(!0===e||!1===this.isBatched&&!0===t)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let t=0;t<e;t+=1){const e=this.getPhysicalFromVisualIndex(t);this.fromPhysicalToVisualIndexesCache.set(e,t)}}cacheFromVisualToRenderableIndexes(){const e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let t=0;t<e;t+=1){const e=this.getPhysicalFromRenderableIndex(t),r=this.getVisualFromPhysicalIndex(e);this.fromVisualToRenderableIndexesCache.set(r,t)}}}function id(e){const t=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(e);return t?`${t[1].toLowerCase()}-${t[2].toUpperCase()}`:e}function od(e){Ni(e)&&Bo(Ii`Language with code "${e}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}oo(nd,wh);const{register:ad,getValues:sd}=Xo("phraseFormatters");ad("pluralize",(function(e,t){return Array.isArray(e)&&Number.isInteger(t)?e[t]:e}));const ld="ContextMenu:items",cd=`${ld}.noItems`,ud=`${ld}.insertRowAbove`,hd=`${ld}.insertRowBelow`,dd=`${ld}.insertColumnOnTheLeft`,fd=`${ld}.insertColumnOnTheRight`,gd=`${ld}.removeRow`,pd=`${ld}.removeColumn`,md=`${ld}.undo`,vd=`${ld}.redo`,bd=`${ld}.readOnly`,yd=`${ld}.clearColumn`,wd=`${ld}.copy`,Sd=`${ld}.copyWithHeaders`,Cd=`${ld}.copyWithGroupHeaders`,kd=`${ld}.copyHeadersOnly`,xd=`${ld}.cut`,Ed=`${ld}.freezeColumn`,Td=`${ld}.unfreezeColumn`,_d=`${ld}.mergeCells`,Ad=`${ld}.unmergeCells`,Rd=`${ld}.addComment`,Od=`${ld}.editComment`,Md=`${ld}.removeComment`,Id=`${ld}.readOnlyComment`,Pd=`${ld}.align`,Nd=`${ld}.align.left`,Dd=`${ld}.align.center`,Fd=`${ld}.align.right`,Ld=`${ld}.align.justify`,Hd=`${ld}.align.top`,Bd=`${ld}.align.middle`,Ud=`${ld}.align.bottom`,jd=`${ld}.borders`,Wd=`${ld}.borders.top`,Vd=`${ld}.borders.right`,zd=`${ld}.borders.bottom`,qd=`${ld}.borders.left`,Gd=`${ld}.borders.remove`,$d=`${ld}.nestedHeaders.insertChildRow`,Kd=`${ld}.nestedHeaders.detachFromParent`,Yd=`${ld}.hideColumn`,Xd=`${ld}.showColumn`,Jd=`${ld}.hideRow`,Zd=`${ld}.showRow`,Qd="Filters:",ef=`${Qd}conditions`,tf=`${ef}.none`,rf=`${ef}.isEmpty`,nf=`${ef}.isNotEmpty`,of=`${ef}.isEqualTo`,af=`${ef}.isNotEqualTo`,sf=`${ef}.beginsWith`,lf=`${ef}.endsWith`,cf=`${ef}.contains`,uf=`${ef}.doesNotContain`,hf=`${ef}.byValue`,df=`${ef}.greaterThan`,ff=`${ef}.greaterThanOrEqualTo`,gf=`${ef}.lessThan`,pf=`${ef}.lessThanOrEqualTo`,mf=`${ef}.isBetween`,vf=`${ef}.isNotBetween`,bf=`${ef}.after`,yf=`${ef}.before`,wf=`${ef}.today`,Sf=`${ef}.tomorrow`,Cf=`${ef}.yesterday`,kf=`${Qd}labels.filterByCondition`,xf=`${Qd}labels.filterByValue`,Ef=`${Qd}labels.conjunction`,Tf=`${Qd}labels.disjunction`,_f=`${Qd}values.blankCells`,Af=`${Qd}buttons.selectAll`,Rf=`${Qd}buttons.clear`,Of=`${Qd}buttons.ok`,Mf=`${Qd}buttons.cancel`,If=`${Qd}buttons.placeholder.search`,Pf=`${Qd}buttons.placeholder.value`,Nf=`${Qd}buttons.placeholder.secondValue`,Df="CheckboxRenderer:",Ff=`${Df}checked`,Lf=`${Df}unchecked`,Hf={languageCode:"en-US",[cd]:"No available options",[ud]:"Insert row above",[hd]:"Insert row below",[dd]:"Insert column left",[fd]:"Insert column right",[gd]:["Remove row","Remove rows"],[pd]:["Remove column","Remove columns"],[md]:"Undo",[vd]:"Redo",[bd]:"Read only",[yd]:"Clear column",[Pd]:"Alignment",[Nd]:"Left",[Dd]:"Center",[Fd]:"Right",[Ld]:"Justify",[Hd]:"Top",[Bd]:"Middle",[Ud]:"Bottom",[Ed]:"Freeze column",[Td]:"Unfreeze column",[jd]:"Borders",[Wd]:"Top",[Vd]:"Right",[zd]:"Bottom",[qd]:"Left",[Gd]:"Remove border(s)",[Rd]:"Add comment",[Od]:"Edit comment",[Md]:"Delete comment",[Id]:"Read-only comment",[_d]:"Merge cells",[Ad]:"Unmerge cells",[wd]:"Copy",[Sd]:["Copy with header","Copy with headers"],[Cd]:["Copy with group header","Copy with group headers"],[kd]:["Copy header only","Copy headers only"],[xd]:"Cut",[$d]:"Insert child row",[Kd]:"Detach from parent",[Yd]:["Hide column","Hide columns"],[Xd]:["Show column","Show columns"],[Jd]:["Hide row","Hide rows"],[Zd]:["Show row","Show rows"],[tf]:"None",[rf]:"Is empty",[nf]:"Is not empty",[of]:"Is equal to",[af]:"Is not equal to",[sf]:"Begins with",[lf]:"Ends with",[cf]:"Contains",[uf]:"Does not contain",[df]:"Greater than",[ff]:"Greater than or equal to",[gf]:"Less than",[pf]:"Less than or equal to",[mf]:"Is between",[vf]:"Is not between",[bf]:"After",[yf]:"Before",[wf]:"Today",[Sf]:"Tomorrow",[Cf]:"Yesterday",[_f]:"Blank cells",[kf]:"Filter by condition",[xf]:"Filter by value",[Ef]:"And",[Tf]:"Or",[Af]:"Select all",[Rf]:"Clear",[Of]:"OK",[Mf]:"Cancel",[If]:"Search",[Pf]:"Value",[Nf]:"Second value",[Ff]:"Checked",[Lf]:"Unchecked"},Bf=e,Uf=Hf.languageCode,{register:jf,getItem:Wf,hasItem:Vf,getValues:zf}=Xo("languagesDictionaries");function qf(e,t){let r=e,n=t;return so(e)&&(n=e,r=n.languageCode),function(e,t){e!==Uf&&(r=t,co(Wf(Uf),((e,t)=>{Di(r[t])&&(r[t]=e)})));var r}(r,n),jf(r,no(n)),no(n)}function Gf(e){return $f(e)?no(Wf(e)):null}function $f(e){return Vf(e)}function Kf(e,t,r){const n=Gf(e);if(null===n)return null;const i=n[t];if(Di(i))return null;const o=function(e,t){let r=e;return Ai(function(){return sd()}(),(n=>{r=n(e,t)})),r}(i,r);return Array.isArray(o)?o[0]:o}qf(Hf);const Yf="active-header",Xf="header",Jf="area",Zf="focus";class Qf{constructor(e,t){this.settings=e,this.cellRange=t||null}isEmpty(){return null===this.cellRange}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,t){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=t,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=t,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const e=this.cellRange.getOuterTopStartCorner(),t=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,t.row,t.col]}destroy(){this.runLocalHooks("destroy")}}oo(Qf,wh);const eg=Qf;function tg(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const rg=class extends eg{constructor(e,t){super(e,null),tg(this,"visualCellRange",null),this.visualCellRange=t||null,this.commit()}add(e){return null===this.visualCellRange?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:t,to:r}=e,n=this.getNearestNotHiddenCoords(t,1),i=this.getNearestNotHiddenCoords(r,-1);return null===n||null===i?null:((n.row>i.row||n.col>i.col)&&(n=t,i=r),this.settings.createCellRange(n,n,i))}getNearestNotHiddenCoords(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t;const n=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,e.row,t);if(null===n)return null;const i=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,e.col,r);return null===i?null:this.settings.createCellCoords(n,i)}getNearestNotHiddenIndex(e,t,r){return t<0?t:e.getNearestNotHiddenIndex(t,r)}commit(){if(null===this.visualCellRange)return this;const e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return this.cellRange=null===e?null:this.createRenderableCellRange(e.from,e.to),this}syncWith(e){const t=e.from.clone().normalize(),r="N-S"===e.getVerticalDirection()?1:-1,n="W-E"===e.getHorizontalDirection()?1:-1,i=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let o=null;if(null!==i&&null!==i.col&&null!==i.row||(o=this.getNearestNotHiddenCoords(t,r,n)),null!==o&&e.overlaps(o)){const t=e.highlight.clone();if(t.row>=0&&(t.row=o.row),t.col>=0&&(t.col=o.col),null===this.cellRange){const e=this.settings.visualToRenderableCoords(t);this.cellRange=this.settings.createCellRange(e)}e.setHighlight(t)}return"focus"===this.settings.selectionType&&null!==i&&null===o&&e.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:e,to:t}=this.cellRange;return[Math.min(e.row,t.row),Math.min(e.col,t.col),Math.max(e.row,t.row),Math.max(e.col,t.col)]}getVisualCorners(){const e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),t=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,t.row,t.col]}createRenderableCellRange(e,t){const r=this.settings.visualToRenderableCoords(e),n=this.settings.visualToRenderableCoords(t);return null===r.row||null===r.col||null===n.row||null===n.col?null:this.settings.createCellRange(r,r,n)}};function ng(e){let{activeHeaderClassName:t,...r}=e;return new rg({className:t,...r,selectionType:Yf})}function ig(e){let{areaCornerVisible:t,...r}=e;return new rg({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:t},...r,selectionType:Jf})}function og(e){let{...t}=e;return new rg({className:"highlight",...t,selectionType:Jf})}function ag(e){let{columnClassName:t,...r}=e;return new rg({className:t,...r,selectionType:"column"})}function sg(e){let{headerClassName:t,...r}=e;return new rg({className:t,...r,selectionType:Xf})}function lg(e){let{rowClassName:t,...r}=e;return new rg({className:t,...r,selectionType:"row"})}function cg(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function ug(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function hg(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var dg=new WeakSet;class fg{constructor(e){cg(this,dg),ug(this,"options",void 0),ug(this,"layerLevel",0),ug(this,"focus",void 0),ug(this,"fill",void 0),ug(this,"layeredAreas",new Map),ug(this,"areas",new Map),ug(this,"rowHeaders",new Map),ug(this,"columnHeaders",new Map),ug(this,"activeRowHeaders",new Map),ug(this,"activeColumnHeaders",new Map),ug(this,"activeCornerHeaders",new Map),ug(this,"rowHighlights",new Map),ug(this,"columnHighlights",new Map),ug(this,"customSelections",[]),this.options=e,this.focus=function(e){let{cellCornerVisible:t,...r}=e;return new rg({className:"current",headerAttributes:[["aria-selected","true"]],border:{width:2,color:"#4b89ff",cornerVisible:t},...r,selectionType:Zf})}(e),this.fill=function(e){let{...t}=e;return new rg({className:"fill",border:{width:1,color:"#ff0000"},...t,selectionType:"fill"})}(e)}isEnabledFor(e,t){let r=e;e===Zf&&(r="current");let n=this.options.disabledCellSelection(t.row,t.col);return"string"===typeof n&&(n=[n]),!1===n||Array.isArray(n)&&!n.includes(r)}useLayerLevel(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.layerLevel=e,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return hg(dg,this,gg).call(this,this.layeredAreas,ig)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return hg(dg,this,gg).call(this,this.areas,og)}getAreas(){return[...this.areas.values()]}createRowHeader(){return hg(dg,this,gg).call(this,this.rowHeaders,sg)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return hg(dg,this,gg).call(this,this.columnHeaders,sg)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return hg(dg,this,gg).call(this,this.activeRowHeaders,ng)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return hg(dg,this,gg).call(this,this.activeColumnHeaders,ng)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return hg(dg,this,gg).call(this,this.activeCornerHeaders,ng)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return hg(dg,this,gg).call(this,this.rowHighlights,lg)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return hg(dg,this,gg).call(this,this.columnHighlights,ag)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(function(e){let{border:t,visualCellRange:r,...n}=e;return new rg({...t,...n,selectionType:"custom-selection"},r)}({...this.options,...e}))}clear(){this.focus.clear(),this.fill.clear(),Ai(this.areas.values(),(e=>{e.clear()})),Ai(this.layeredAreas.values(),(e=>{e.clear()})),Ai(this.rowHeaders.values(),(e=>{e.clear()})),Ai(this.columnHeaders.values(),(e=>{e.clear()})),Ai(this.activeRowHeaders.values(),(e=>{e.clear()})),Ai(this.activeColumnHeaders.values(),(e=>{e.clear()})),Ai(this.activeCornerHeaders.values(),(e=>{e.clear()})),Ai(this.rowHighlights.values(),(e=>{e.clear()})),Ai(this.columnHighlights.values(),(e=>{e.clear()}))}[Symbol.iterator](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function gg(e,t){const r=this.layerLevel;if(e.has(r))return e.get(r);const n=t({layerLevel:r,...this.options});return e.set(r,n),n}const pg=fg;function mg(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class vg{constructor(e){mg(this,"ranges",[]),mg(this,"createCellRange",void 0),this.createCellRange=e}isEmpty(){return 0===this.size()}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}pop(){return this.ranges.pop(),this}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(e){return this.ranges.some((t=>t.includes(e)))}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}peekByIndex(){let e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return t>=0&&t<this.size()&&(e=this.ranges[t]),e}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}}const bg=vg;function yg(e,t,r){wg(e,t),t.set(e,r)}function wg(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Sg(e,t){return e.get(kg(e,t))}function Cg(e,t,r){return e.set(kg(e,t),r),r}function kg(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var xg=new WeakMap,Eg=new WeakMap,Tg=new WeakMap,_g=new WeakSet;class Ag{constructor(e,t){!function(e,t){wg(e,t),t.add(e)}(this,_g),yg(this,xg,void 0),yg(this,Eg,void 0),yg(this,Tg,{x:0,y:0}),Cg(xg,this,e),Cg(Eg,this,t)}transformStart(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n=Sg(Eg,this).createCellCoords(e,t);let i=Sg(xg,this).current().highlight;const o=Sg(Eg,this).visualToRenderableCoords(i);let a=0,s=0;if(this.runLocalHooks("beforeTransformStart",n),null!==o.row&&null!==o.col){const{width:e,height:t}=kg(_g,this,Og).call(this),{row:o,col:l}=kg(_g,this,Pg).call(this,i),c=Sg(Eg,this).fixedRowsBottom(),u=Sg(Eg,this).minSpareRows(),h=Sg(Eg,this).minSpareCols(),d=Sg(Eg,this).autoWrapRow(),f=Sg(Eg,this).autoWrapCol(),g=Sg(Eg,this).createCellCoords(o+n.row,l+n.col);if(g.row>=t){const n=fo(r&&u>0&&0===c),i=g.col+1,o=Sg(Eg,this).createCellCoords(g.row-t,i>=e?i-e:i);this.runLocalHooks("beforeColumnWrap",n,kg(_g,this,Ng).call(this,o),i>=e),n.value?this.runLocalHooks("insertRowRequire",Sg(Eg,this).countRenderableRows()):f&&g.assign(o)}else if(g.row<0){const r=fo(f),n=g.col-1,i=Sg(Eg,this).createCellCoords(t+g.row,n<0?e+n:n);this.runLocalHooks("beforeColumnWrap",r,kg(_g,this,Ng).call(this,i),n<0),f&&g.assign(i)}if(g.col>=e){const n=fo(r&&h>0),i=g.row+1,o=Sg(Eg,this).createCellCoords(i>=t?i-t:i,g.col-e);this.runLocalHooks("beforeRowWrap",n,kg(_g,this,Ng).call(this,o),i>=t),n.value?this.runLocalHooks("insertColRequire",Sg(Eg,this).countRenderableColumns()):d&&g.assign(o)}else if(g.col<0){const r=fo(d),n=g.row-1,i=Sg(Eg,this).createCellCoords(n<0?t+n:n,e+g.col);this.runLocalHooks("beforeRowWrap",r,kg(_g,this,Ng).call(this,i),n<0),d&&g.assign(i)}const{rowDir:p,colDir:m}=kg(_g,this,Rg).call(this,g);a=p,s=m,i=kg(_g,this,Ng).call(this,g)}return this.runLocalHooks("afterTransformStart",i,a,s),i}transformEnd(e,t){const r=Sg(Eg,this).createCellCoords(e,t),n=Sg(xg,this).current(),i=Sg(Eg,this).visualToRenderableCoords(n.highlight),o=kg(_g,this,Mg).call(this,n.to.row,n.from.row),a=kg(_g,this,Ig).call(this,n.to.col,n.from.col),s=n.to.clone();let l=0,c=0;if(this.runLocalHooks("beforeTransformEnd",r),null!==i.row&&null!==i.col&&null!==o&&null!==a){const{row:e,col:t}=kg(_g,this,Pg).call(this,n.highlight),i=Sg(Eg,this).createCellCoords(o+r.row,a+r.col),u=n.getTopStartCorner(),h=n.getTopEndCorner(),d=n.getBottomEndCorner();if(r.col<0&&a>=t&&i.col<t){const e=i.col-t;i.col=kg(_g,this,Ig).call(this,u.col,h.col)+e}else if(r.col>0&&a<=t&&i.col>t){const e=kg(_g,this,Ig).call(this,h.col,u.col),t=Math.max(i.col-e,1);i.col=e+t}if(r.row<0&&o>=e&&i.row<e){const t=i.row-e;i.row=kg(_g,this,Mg).call(this,u.row,d.row)+t}else if(r.row>0&&o<=e&&i.row>e){const e=kg(_g,this,Mg).call(this,d.row,u.row),t=Math.max(i.row-e,1);i.row=e+t}const{rowDir:f,colDir:g}=kg(_g,this,Rg).call(this,i);l=f,c=g;const p=kg(_g,this,Ng).call(this,i);0===r.row&&0!==r.col?s.col=p.col:0!==r.row&&0===r.col?s.row=p.row:(s.row=p.row,s.col=p.col)}return this.runLocalHooks("afterTransformEnd",s,l,c),s}setOffsetSize(e){let{x:t,y:r}=e;Cg(Tg,this,{x:t,y:r})}resetOffsetSize(){Cg(Tg,this,{x:0,y:0})}}function Rg(e){const{width:t,height:r}=kg(_g,this,Og).call(this);let n=0,i=0;return e.row<0?(n=-1,e.row=0):e.row>0&&e.row>=r&&(n=1,e.row=r-1),e.col<0?(i=-1,e.col=0):e.col>0&&e.col>=t&&(i=1,e.col=t-1),{rowDir:n,colDir:i}}function Og(){return{width:Sg(Tg,this).x+Sg(Eg,this).countRenderableColumns(),height:Sg(Tg,this).y+Sg(Eg,this).countRenderableRows()}}function Mg(e,t){const r=Sg(Eg,this).findFirstNonHiddenRenderableRow(e,t);return null===r?null:Sg(Tg,this).y+r}function Ig(e,t){const r=Sg(Eg,this).findFirstNonHiddenRenderableColumn(e,t);return null===r?null:Sg(Tg,this).x+r}function Pg(e){const{row:t,col:r}=Sg(Eg,this).visualToRenderableCoords(e);if(null===t||null===r)throw new Error("Renderable coords are not visible.");return Sg(Eg,this).createCellCoords(Sg(Tg,this).y+t,Sg(Tg,this).x+r)}function Ng(e){const t=e.clone();return t.col=e.col-Sg(Tg,this).x,t.row=e.row-Sg(Tg,this).y,Sg(Eg,this).renderableToVisualCoords(t)}oo(Ag,wh);const Dg=Ag,Fg=0,Lg=1,Hg=2,Bg=3,Ug=[Bg,Hg],jg=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],Wg=Symbol("root"),Vg=Symbol("child");function zg(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Wg;if(t!==Wg&&t!==Vg)throw new Error("The second argument is used internally only and cannot be overwritten.");const r=Array.isArray(e),n=t===Wg;let i=Fg;if(r){const t=e[0];if(0===e.length)i=Lg;else if(n&&t instanceof cc)i=Bg;else if(n&&Array.isArray(t))i=zg(t,Vg);else if(e.length>=2&&e.length<=4){const t=!e.some(((e,t)=>!jg[t].includes(typeof e)));t&&(i=Hg)}}return i}function qg(e){let{createCellCoords:t,createCellRange:r,keepDirection:n=!1,propToCol:i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!Ug.includes(e))throw new Error("Unsupported selection ranges schema type was provided.");return function(o){const a=e===Bg;let s=a?o.from.row:o[0],l=a?o.from.col:o[1],c=a?o.to.row:o[2],u=a?o.to.col:o[3];if("function"===typeof i&&("string"===typeof l&&(l=i(l)),"string"===typeof u&&(u=i(u))),Di(c)&&(c=s),Di(u)&&(u=l),!n){const e=s,t=l,r=c,n=u;s=Math.min(e,r),l=Math.min(t,n),c=Math.max(e,r),u=Math.max(t,n)}const h=t(s,l),d=t(c,u);return r(h,h,d)}}function Gg(e,t,r){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,r)}function $g(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Kg(e,t){return e.get(Xg(e,t))}function Yg(e,t,r){return e.set(Xg(e,t),r),r}function Xg(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var Jg=new WeakMap,Zg=new WeakMap,Qg=new WeakMap,ep=new WeakMap,tp=new WeakMap,rp=new WeakMap;class np{constructor(e,t){var r=this;$g(this,"settings",void 0),$g(this,"tableProps",void 0),$g(this,"inProgress",!1),$g(this,"selectedRange",new bg(((e,t,r)=>this.tableProps.createCellRange(e,t,r)))),$g(this,"highlight",void 0),Gg(this,Jg,void 0),Gg(this,Zg,void 0),$g(this,"selectedByRowHeader",new Set),$g(this,"selectedByColumnHeader",new Set),Gg(this,Qg,!1),Gg(this,ep,!1),Gg(this,tp,"unknown"),Gg(this,rp,-1),this.settings=e,this.tableProps=t,this.highlight=new pg({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,cellAttributes:[["aria-selected","true"]],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(e,t)=>this.tableProps.isDisabledCellSelection(e,t),cellCornerVisible:function(){return r.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return r.isAreaCornerVisible(...arguments)},visualToRenderableCoords:e=>this.tableProps.visualToRenderableCoords(e),renderableToVisualCoords:e=>this.tableProps.renderableToVisualCoords(e),createCellCoords:(e,t)=>this.tableProps.createCellCoords(e,t),createCellRange:(e,t,r)=>this.tableProps.createCellRange(e,t,r)}),Yg(Jg,this,new Dg(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>this.tableProps.countRenderableRows(),countRenderableColumns:()=>this.tableProps.countRenderableColumns(),visualToRenderableCoords:e=>this.tableProps.visualToRenderableCoords(e),renderableToVisualCoords:e=>this.tableProps.renderableToVisualCoords(e),findFirstNonHiddenRenderableRow:function(){return r.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return r.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(e,t)=>this.tableProps.createCellCoords(e,t),fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol})),Yg(Zg,this,new Dg(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>{const e=this.selectedRange.current();return this.tableProps.countRenderableRowsInRange(0,e.getOuterBottomEndCorner().row)},countRenderableColumns:()=>{const e=this.selectedRange.current();return this.tableProps.countRenderableColumnsInRange(0,e.getOuterBottomEndCorner().col)},visualToRenderableCoords:e=>this.tableProps.visualToRenderableCoords(e),renderableToVisualCoords:e=>this.tableProps.renderableToVisualCoords(e),findFirstNonHiddenRenderableRow:function(){return r.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return r.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(e,t)=>this.tableProps.createCellCoords(e,t),fixedRowsBottom:()=>0,minSpareRows:()=>0,minSpareCols:()=>0,autoWrapRow:()=>!0,autoWrapCol:()=>!0})),Kg(Jg,this).addLocalHook("beforeTransformStart",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runLocalHooks("beforeModifyTransformStart",...t)})),Kg(Jg,this).addLocalHook("afterTransformStart",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runLocalHooks("afterModifyTransformStart",...t)})),Kg(Jg,this).addLocalHook("beforeTransformEnd",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runLocalHooks("beforeModifyTransformEnd",...t)})),Kg(Jg,this).addLocalHook("afterTransformEnd",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runLocalHooks("afterModifyTransformEnd",...t)})),Kg(Jg,this).addLocalHook("insertRowRequire",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runLocalHooks("insertRowRequire",...t)})),Kg(Jg,this).addLocalHook("insertColRequire",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runLocalHooks("insertColRequire",...t)})),Kg(Jg,this).addLocalHook("beforeRowWrap",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runLocalHooks("beforeRowWrap",...t)})),Kg(Jg,this).addLocalHook("beforeColumnWrap",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runLocalHooks("beforeColumnWrap",...t)})),Kg(Zg,this).addLocalHook("beforeTransformStart",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runLocalHooks("beforeModifyTransformFocus",...t)})),Kg(Zg,this).addLocalHook("afterTransformStart",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runLocalHooks("afterModifyTransformFocus",...t)}))}getSelectedRange(){return this.selectedRange}markSource(e){Yg(tp,this,e)}markEndSource(){Yg(tp,this,"unknown")}getSelectionSource(){return Kg(tp,this)}setExpectedLayers(e){Yg(rp,this,e)}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1,Yg(rp,this,-1)}isInProgress(){return this.inProgress}setRangeStart(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e;const i="multiple"===this.settings.selectionMode,o=Di(t)?this.tableProps.getShortcutManager().isCtrlPressed():t,a=e.clone();Yg(Qg,this,!1),this.runLocalHooks("beforeSetRangeStart"+(r?"Only":""),a),(!i||i&&!o&&Di(t))&&this.selectedRange.clear(),this.selectedRange.add(a).current().setHighlight(n.clone()),0===this.getLayerLevel()&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),r||this.setRangeEnd(e)}setRangeStartOnly(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e;this.setRangeStart(e,t,!0,r)}setRangeEnd(e){if(this.selectedRange.isEmpty())return;const t=e.clone(),r=this.tableProps.countRows(),n=this.tableProps.countCols(),i=this.selectedRange.current().clone().setTo(e).isSingleHeader();if((r>0||n>0)&&(0===r&&t.col<0&&!i||0===n&&t.row<0&&!i))return;this.runLocalHooks("beforeSetRangeEnd",t),this.begin();const o=this.selectedRange.current();if(this.settings.navigableHeaders||o.highlight.normalize(),"single"===this.settings.selectionMode)o.setFrom(o.highlight),o.setTo(o.highlight);else{const e=o.getHorizontalDirection(),r=o.getVerticalDirection(),n=this.isMultiple();o.setTo(t),n&&(e!==o.getHorizontalDirection()||1===o.getWidth()&&!o.includes(o.highlight))&&o.from.assign({col:o.highlight.col}),n&&(r!==o.getVerticalDirection()||1===o.getHeight()&&!o.includes(o.highlight))&&o.from.assign({row:o.highlight.row})}r>0&&n>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!o.isSingleHeader())&&o.to.normalize(),this.runLocalHooks("beforeHighlightSet"),this.setRangeFocus(this.selectedRange.current().highlight),this.applyAndCommit();const a=-1===Kg(rp,this)||this.selectedRange.size()===Kg(rp,this);this.runLocalHooks("afterSetRangeEnd",e,a)}applyAndCommit(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.selectedRange.current(),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getLayerLevel();const r=this.tableProps.countRows(),n=this.tableProps.countCols();t<this.highlight.layerLevel&&(Ai(this.highlight.getAreas(),(e=>{e.clear()})),Ai(this.highlight.getLayeredAreas(),(e=>{e.clear()})),Ai(this.highlight.getRowHeaders(),(e=>{e.clear()})),Ai(this.highlight.getColumnHeaders(),(e=>{e.clear()})),Ai(this.highlight.getActiveRowHeaders(),(e=>{e.clear()})),Ai(this.highlight.getActiveColumnHeaders(),(e=>{e.clear()})),Ai(this.highlight.getActiveCornerHeaders(),(e=>{e.clear()})),Ai(this.highlight.getRowHighlights(),(e=>{e.clear()})),Ai(this.highlight.getColumnHighlights(),(e=>{e.clear()}))),this.highlight.useLayerLevel(t);const i=this.highlight.createArea(),o=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),s=this.highlight.createColumnHeader(),l=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),u=this.highlight.createActiveCornerHeader(),h=this.highlight.createRowHighlight(),d=this.highlight.createColumnHighlight();if(i.clear(),o.clear(),a.clear(),s.clear(),l.clear(),c.clear(),u.clear(),h.clear(),d.clear(),this.highlight.isEnabledFor(Jf,e.highlight)&&(this.isMultiple()||t>=1)&&(i.add(e.from).add(e.to).commit(),o.add(e.from).add(e.to).commit(),1===t)){const e=this.selectedRange.previous();this.highlight.useLayerLevel(t-1),this.highlight.createArea().add(e.from).commit().syncWith(e),this.highlight.createLayeredArea().add(e.from).commit().syncWith(e),this.highlight.useLayerLevel(t)}if(this.highlight.isEnabledFor(Xf,e.highlight)){if(!e.isSingleHeader()){const t=this.tableProps.createCellCoords(Math.max(e.from.row,0),-1),r=this.tableProps.createCellCoords(e.to.row,-1),n=this.tableProps.createCellCoords(-1,Math.max(e.from.col,0)),i=this.tableProps.createCellCoords(-1,e.to.col);"single"===this.settings.selectionMode?(a.add(t).commit(),s.add(n).commit(),h.add(t).commit(),d.add(n).commit()):(a.add(t).add(r).commit(),s.add(n).add(i).commit(),h.add(t).add(r).commit(),d.add(n).add(i).commit())}const t=!Kg(ep,this)&&this.isEntireRowSelected()&&(n>0&&n===e.getWidth()||0===n&&this.isSelectedByRowHeader()),i=!Kg(ep,this)&&this.isEntireColumnSelected()&&(r>0&&r===e.getHeight()||0===r&&this.isSelectedByColumnHeader());t&&l.add(this.tableProps.createCellCoords(Math.max(e.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(e.to.row,0),-1)).commit(),i&&c.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(e.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(e.to.col,0))).commit(),t&&i&&u.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}}setRangeFocus(e){if(this.selectedRange.isEmpty())return;const t=this.selectedRange.current();this.inProgress||this.runLocalHooks("beforeSetFocus",e);const r=this.highlight.getFocus();r.clear(),t.setHighlight(e),this.inProgress||this.runLocalHooks("beforeHighlightSet"),this.highlight.isEnabledFor(Zf,t.highlight)&&r.add(t.highlight).commit().syncWith(t),this.inProgress||(Yg(Qg,this,!0),this.runLocalHooks("afterSetFocus",t.highlight))}transformStart(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.settings.navigableHeaders?Kg(Jg,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):Kg(Jg,this).resetOffsetSize(),this.setRangeStart(Kg(Jg,this).transformStart(e,t,r))}transformEnd(e,t){this.settings.navigableHeaders?Kg(Jg,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):Kg(Jg,this).resetOffsetSize(),this.setRangeEnd(Kg(Jg,this).transformEnd(e,t))}transformFocus(e,t){const r=this.selectedRange.current(),{row:n,col:i}=r.getOuterTopStartCorner(),o=this.tableProps.countRenderableColumnsInRange(0,i-1),a=this.tableProps.countRenderableRowsInRange(0,n-1);r.highlight.isHeader()?Kg(Zg,this).setOffsetSize({x:i<0?Math.abs(i):-o,y:n<0?Math.abs(n):-a}):Kg(Zg,this).setOffsetSize({x:i<0?0:-o,y:n<0?0:-a});const s=Kg(Zg,this).transformStart(e,t);this.setRangeFocus(s.normalize())}shiftRows(e,t){if(!this.isSelected())return;const r=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByColumnHeader()||r.getOuterTopStartCorner().row>=e){const{from:n,to:i,highlight:o}=r,a=this.tableProps.countRows(),s=this.isSelectedByRowHeader(),l=this.isSelectedByColumnHeader(),c=l?-1:0,u=l?0:t;this.getSelectedRange().pop();const h=this.tableProps.createCellCoords(za(n.row+u,c,a-1),n.col),d=this.tableProps.createCellCoords(za(i.row+t,c,a-1),i.col);this.markSource("shift"),o.row>=e?this.setRangeStartOnly(h,!0,this.tableProps.createCellCoords(za(o.row+t,0,a-1),o.col)):this.setRangeStartOnly(h,!0),s&&this.selectedByRowHeader.add(this.getLayerLevel()),l&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(d),this.markEndSource()}}shiftColumns(e,t){if(!this.isSelected())return;const r=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByRowHeader()||r.getOuterTopStartCorner().col>=e){const{from:n,to:i,highlight:o}=r,a=this.tableProps.countCols(),s=this.isSelectedByRowHeader(),l=this.isSelectedByColumnHeader(),c=s?-1:0,u=s?0:t;this.getSelectedRange().pop();const h=this.tableProps.createCellCoords(n.row,za(n.col+u,c,a-1)),d=this.tableProps.createCellCoords(i.row,za(i.col+t,c,a-1));this.markSource("shift"),o.col>=e?this.setRangeStartOnly(h,!0,this.tableProps.createCellCoords(o.row,za(o.col+t,0,a-1))):this.setRangeStartOnly(h,!0),s&&this.selectedByRowHeader.add(this.getLayerLevel()),l&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(d),this.markEndSource()}}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isMultiple(){if(!this.isSelected())return!1;const e=fo(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",e),e.value}isFocusSelectionChanged(){return this.isSelected()&&Kg(Qg,this)}isSelectedByRowHeader(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&(-1===e?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e))}isEntireRowSelected(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();const t=e=>{const{col:t}=e.getOuterTopStartCorner(),r=this.tableProps.countRowHeaders(),n=this.tableProps.countCols();return(r>0&&t<0||0===r)&&e.getWidth()===n};if(-1===e)return Array.from(this.selectedRange).some((e=>t(e)));const r=this.selectedRange.peekByIndex(e);return!!r&&t(r)}isSelectedByColumnHeader(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(-1===e?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e))}isEntireColumnSelected(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();const t=e=>{const{row:t}=e.getOuterTopStartCorner(),r=this.tableProps.countColHeaders(),n=this.tableProps.countRows();return(r>0&&t<0||0===r)&&e.getHeight()===n};if(-1===e)return Array.from(this.selectedRange).some((e=>t(e)));const r=this.selectedRange.peekByIndex(e);return!!r&&t(r)}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(e){const t=this.tableProps.visualToRenderableCoords(e);return null!==t.row&&null!==t.col}isAreaCornerVisible(e){return(!Number.isInteger(e)||e===this.getLayerLevel())&&(this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple())}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var e;let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const i=this.tableProps.countRows(),o=this.tableProps.countCols(),a=this.tableProps.countRowHeaders(),s=this.tableProps.countColHeaders(),l=r?-s:0,c=t?-a:0;if(0===l&&0===c&&(0===i||0===o))return;let u=null===(e=this.getSelectedRange().current())||void 0===e?void 0:e.highlight;const{focusPosition:h,disableHeadersHighlight:d}=n;Yg(ep,this,d),h&&Number.isInteger(null===h||void 0===h?void 0:h.row)&&Number.isInteger(null===h||void 0===h?void 0:h.col)&&(u=this.tableProps.createCellCoords(za(h.row,l,i-1),za(h.col,c,o-1)));const f=this.tableProps.createCellCoords(l,c),g=this.tableProps.createCellCoords(i-1,o-1);this.clear(),this.setRangeStartOnly(f,void 0,u),c<0&&this.selectedByRowHeader.add(this.getLayerLevel()),l<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(g),this.finish(),Yg(ep,this,!1)}selectCells(e){var t=this;const r=zg(e);if(r===Lg)return!1;if(r===Fg)throw new Error(Ii`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const n=qg(r,{createCellCoords:function(){return t.tableProps.createCellCoords(...arguments)},createCellRange:function(){return t.tableProps.createCellRange(...arguments)},propToCol:e=>this.tableProps.propToCol(e),keepDirection:!0}),i=this.settings.navigableHeaders,o={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:i?this.tableProps.countRowHeaders():0,countColHeaders:i?this.tableProps.countColHeaders():0},a=!e.some((e=>{const t=n(e),r=t.isValid(o);return!(r&&!t.containsHeaders()||r&&t.containsHeaders()&&t.isSingleHeader())}));return a&&(this.clear(),this.setExpectedLayers(e.length),Ai(e,(e=>{const{from:t,to:r}=n(e);this.setRangeStartOnly(t.clone(),!1),this.setRangeEnd(r.clone())})),this.finish()),a}selectColumns(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const n="string"===typeof e?this.tableProps.propToCol(e):e,i="string"===typeof t?this.tableProps.propToCol(t):t,o=this.tableProps.countRows(),a=this.tableProps.countCols(),s=this.tableProps.countColHeaders(),l=0===s?0:-s,c=this.tableProps.createCellCoords(l,n),u=this.tableProps.createCellCoords(o-1,i),h=this.tableProps.createCellRange(c,c,u).isValid({countRows:o,countCols:a,countRowHeaders:0,countColHeaders:s});if(h){let e=0,t=0;Number.isInteger(null===r||void 0===r?void 0:r.row)&&Number.isInteger(null===r||void 0===r?void 0:r.col)?(e=za(r.row,l,o-1),t=za(r.col,Math.min(n,i),Math.max(n,i))):(e=za(r,l,o-1),t=n);const a=this.tableProps.createCellCoords(e,t),c=0===s?0:za(a.row,l,-1),u=o-1,h=this.tableProps.createCellCoords(c,n),d=this.tableProps.createCellCoords(u,i);this.runLocalHooks("beforeSelectColumns",h,d,a),h.row=c,d.row=u,this.setRangeStartOnly(h,void 0,a),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(d),this.runLocalHooks("afterSelectColumns",h,d,a),this.finish()}return h}selectRows(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const n=this.tableProps.countRows(),i=this.tableProps.countCols(),o=this.tableProps.countRowHeaders(),a=0===o?0:-o,s=this.tableProps.createCellCoords(e,a),l=this.tableProps.createCellCoords(t,i-1),c=this.tableProps.createCellRange(s,s,l).isValid({countRows:n,countCols:i,countRowHeaders:o,countColHeaders:0});if(c){let n=0,s=0;Number.isInteger(null===r||void 0===r?void 0:r.row)&&Number.isInteger(null===r||void 0===r?void 0:r.col)?(n=za(r.row,Math.min(e,t),Math.max(e,t)),s=za(r.col,a,i-1)):(n=e,s=za(r,a,i-1));const l=this.tableProps.createCellCoords(n,s),c=0===o?0:za(l.col,a,-1),u=i-1,h=this.tableProps.createCellCoords(e,c),d=this.tableProps.createCellCoords(t,u);this.runLocalHooks("beforeSelectRows",h,d,l),h.col=c,d.col=u,this.setRangeStartOnly(h,void 0,l),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(d),this.runLocalHooks("afterSelectRows",h,d,l),this.finish()}return c}refresh(){if(!this.isSelected())return;const e=this.tableProps.countRows(),t=this.tableProps.countCols();if(0===e||0===t)return void this.deselect();const r=this.selectedRange.peekByIndex(this.selectedRange.size()-1),{from:n,to:i,highlight:o}=r;this.clear(),o.assign({row:za(o.row,-1/0,e-1),col:za(o.col,-1/0,t-1)}),n.assign({row:za(n.row,-1/0,e-1),col:za(n.col,-1/0,t-1)}),i.assign({row:za(i.row,0,e-1),col:za(i.col,0,t-1)}),this.selectedRange.ranges.push(r),this.highlight.getFocus().add(o).commit().syncWith(r),this.applyAndCommit(r)}commit(){if(this.highlight.getCustomSelections().forEach((e=>{e.commit()})),!this.isSelected())return;const e=this.highlight.getFocus(),t=this.getLayerLevel();e.commit().syncWith(this.selectedRange.current());for(let r=0;r<this.selectedRange.size();r+=1){this.highlight.useLayerLevel(r);const e=this.highlight.createArea(),t=this.highlight.createLayeredArea(),n=this.highlight.createRowHeader(),i=this.highlight.createColumnHeader(),o=this.highlight.createActiveRowHeader(),a=this.highlight.createActiveColumnHeader(),s=this.highlight.createActiveCornerHeader(),l=this.highlight.createRowHighlight(),c=this.highlight.createColumnHighlight();e.commit(),t.commit(),n.commit(),i.commit(),o.commit(),a.commit(),s.commit(),l.commit(),c.commit()}this.highlight.useLayerLevel(t)}}oo(np,wh);const ip=np,{register:op,getItem:ap,hasItem:sp,getNames:lp,getValues:cp}=Xo("cellTypes");function up(e,t){"string"!==typeof e&&(e=(t=e).CELL_TYPE);const{editor:r,renderer:n,validator:i}=t;r&&aa(e,r),n&&hs(e,n),i&&vs(e,i),op(e,t)}function hp(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e;const n="string"===typeof t.type?function(e){if(!sp(e))throw Error(`You declared cell type "${e}" as a string that is not mapped to a known object.\n                 Cell type must be an object or a string mapped to an object registered by\n                 "Handsontable.cellTypes.registerCellType" method`);return ap(e)}(t.type):t.type;if(e._automaticallyAssignedMetaProps&&co(t,((t,r)=>{e._automaticallyAssignedMetaProps.delete(r)})),!so(n))return;r!==e||e._automaticallyAssignedMetaProps||(e._automaticallyAssignedMetaProps=new Set);const i={};co(n,((t,n)=>{var o;(function(e,t){var r;return"CELL_TYPE"!==e&&((null===(r=t._automaticallyAssignedMetaProps)||void 0===r?void 0:r.has(e))||!go(t,e))})(n,r)&&(i[n]=t,null===(o=e._automaticallyAssignedMetaProps)||void 0===o||o.add(n))})),to(e,i)}function dp(e){return Number.isInteger(e)&&e>=0}function fp(e,t){if(!e())throw new Error(`Assertion failed: ${t}`)}function gp(e){return null===e||void 0===e}const pp=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataDotNotation:!0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",timeFormat:"h:mm:ss a",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,headerClassName:void 0,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(e){let t,r,n;for(t=0,r=this.countRows();t<r;t++)if(n=this.getDataAtCell(t,e),!1===Fi(n))return!1;return!0},isEmptyRow(e){let t,r,n,i;for(t=0,r=this.countCols();t<r;t++)if(n=this.getDataAtCell(e,t),!1===Fi(n))return"object"===typeof n&&(i=this.getCellMeta(e,t),ao(this.getSchema()[i.prop],n));return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:!1,renderAllColumns:!1,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:void 0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",visibleRows:10,width:void 0,wordWrap:!0});function mp(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class vp{constructor(e){mp(this,"metaCtor",class{}),mp(this,"meta",void 0),this.meta=this.metaCtor.prototype,to(this.meta,pp()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var t;to(this.meta,e),hp(this.meta,{...e,type:null!==(t=e.type)&&void 0!==t?t:this.meta.type},e)}}function bp(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class yp{constructor(e){bp(this,"meta",void 0);const t=e.getMetaConstructor();this.meta=new t}getMeta(){return this.meta}updateMeta(e){to(this.meta,e),hp(this.meta,e,e)}}function wp(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Sp{constructor(e){wp(this,"valueFactory",void 0),wp(this,"data",[]),wp(this,"index",[]),wp(this,"holes",new Set),this.valueFactory=e}obtain(e){fp((()=>dp(e)),"Expecting an unsigned number.");const t=this._getStorageIndexByKey(e);let r;if(t>=0)r=this.data[t],void 0===r&&(r=this.valueFactory(e),this.data[t]=r);else if(r=this.valueFactory(e),this.holes.size>0){const t=this.holes.values().next().value;this.holes.delete(t),this.data[t]=r,this.index[e]=t}else this.data.push(r),this.index[e]=this.data.length-1;return r}insert(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;fp((()=>dp(e)||gp(e)),"Expecting an unsigned number or null/undefined argument.");const r=[],n=this.data.length;for(let o=0;o<t;o++)r.push(n+o),this.data.push(void 0);const i=gp(e)?this.index.length:e;this.index=[...this.index.slice(0,i),...r,...this.index.slice(i)]}remove(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;fp((()=>dp(e)||gp(e)),"Expecting an unsigned number or null/undefined argument.");const r=this.index.splice(gp(e)?this.index.length-t:e,t);for(let n=0;n<r.length;n++){const e=r[n];"number"===typeof e&&this.holes.add(e)}}size(){return this.data.length-this.holes.size}values(){return Ti(this.data,((e,t)=>!this.holes.has(t)))[Symbol.iterator]()}entries(){const e=[];for(let r=0;r<this.data.length;r++){const t=this._getKeyByStorageIndex(r);-1!==t&&e.push([t,this.data[r]])}let t=0;return{next:()=>{if(t<e.length){const r=e[t];return t+=1,{value:r,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[Symbol.iterator](){return this.entries()}}function Cp(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const kp=["data","width"];class xp{constructor(e){Cp(this,"globalMeta",void 0),Cp(this,"metas",new Sp((()=>this._createMeta()))),this.globalMeta=e,this.metas=new Sp((()=>this._createMeta()))}updateMeta(e,t){const r=this.getMeta(e);to(r,t),hp(r,t)}createColumn(e,t){this.metas.insert(e,t)}removeColumn(e,t){this.metas.remove(e,t)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];function r(){}eo(r,e);for(let n=0;n<t.length;n++)r.prototype[t[n]]=void 0;return r}(this.globalMeta.getMetaConstructor(),kp).prototype}}function Ep(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Tp{constructor(e){Ep(this,"columnMeta",void 0),Ep(this,"metas",new Sp((()=>this._createRow()))),this.columnMeta=e}updateMeta(e,t,r){const n=this.getMeta(e,t);to(n,r),hp(n,r)}createRow(e,t){this.metas.insert(e,t)}createColumn(e,t){for(let r=0;r<this.metas.size();r++)this.metas.obtain(r).insert(e,t)}removeRow(e,t){this.metas.remove(e,t)}removeColumn(e,t){for(let r=0;r<this.metas.size();r++)this.metas.obtain(r).remove(e,t)}getMeta(e,t,r){const n=this.metas.obtain(e).obtain(t);return void 0===r?n:n[r]}setMeta(e,t,r,n){var i;const o=this.metas.obtain(e).obtain(t);null===(i=o._automaticallyAssignedMetaProps)||void 0===i||i.delete(r),o[r]=n}removeMeta(e,t,r){delete this.metas.obtain(e).obtain(t)[r]}getMetas(){const e=[],t=Array.from(this.metas.values());for(let r=0;r<t.length;r++)Ni(t[r])&&e.push(...t[r].values());return e}getMetasAtRow(e){fp((()=>dp(e)),"Expecting an unsigned number.");const t=new Map(this.metas);return t.has(e)?Array.from(t.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new Sp((e=>this._createMeta(e)))}_createMeta(e){return new(this.columnMeta.getMetaConstructor(e))}}class _p{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];this.hot=e,this.globalMeta=new vp(e),this.tableMeta=new yp(this.globalMeta),this.columnMeta=new xp(this.globalMeta),this.cellMeta=new Tp(this.columnMeta),r.forEach((e=>new e(this))),this.globalMeta.updateMeta(t)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,t){this.columnMeta.updateMeta(e,t)}getCellMeta(e,t,r){let{visualRow:n,visualColumn:i}=r;const o=this.cellMeta.getMeta(e,t);return o.visualRow=n,o.visualCol=i,o.row=e,o.col=t,this.runLocalHooks("afterGetCellMeta",o),o}getCellMetaKeyValue(e,t,r){if("string"!==typeof r)throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,t,r)}setCellMeta(e,t,r,n){this.cellMeta.setMeta(e,t,r,n)}updateCellMeta(e,t,r){this.cellMeta.updateMeta(e,t,r)}removeCellMeta(e,t,r){this.cellMeta.removeMeta(e,t,r)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.createRow(e,t)}removeRow(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.removeRow(e,t)}createColumn(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.createColumn(e,t),this.columnMeta.createColumn(e,t)}removeColumn(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.removeColumn(e,t),this.columnMeta.removeColumn(e,t)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}function Ap(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}oo(_p,wh);class Rp{constructor(e){Ap(this,"metaManager",void 0),Ap(this,"metaSyncMemo",new Map),this.metaManager=e,e.addLocalHook("afterGetCellMeta",(e=>this.extendCellMeta(e))),Ko.getSingleton().add("beforeRender",(e=>{e&&this.metaSyncMemo.clear()}),this.metaManager.hot)}extendCellMeta(e){var t;const{row:r,col:n}=e;if(null!==(t=this.metaSyncMemo.get(r))&&void 0!==t&&t.has(n))return;const{visualRow:i,visualCol:o}=e,a=this.metaManager.hot,s=a.colToProp(o);e.prop=s,a.runHooks("beforeGetCellMeta",i,o,e);const l=go(e,"type")?e.type:null;let c=Yi(e.cells)?e.cells(r,n,s):null;var u;l&&(c?c.type=null!==(u=c.type)&&void 0!==u?u:l:c={type:l});c&&this.metaManager.updateCellMeta(r,n,c),a.runHooks("afterGetCellMeta",i,o,e),this.metaSyncMemo.has(r)||this.metaSyncMemo.set(r,new Set),this.metaSyncMemo.get(r).add(n)}}function Op(e,t,r){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,r)}function Mp(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ip(e,t){return e.get(function(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}(e,t))}var Pp=new WeakMap;class Np{constructor(e){Mp(this,"metaManager",void 0),Mp(this,"usageTracker",new Set),Mp(this,"propDescriptors",new Map([["ariaTags",{initOnly:!0}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(e){if(this.metaManager.hot.isRtl()&&"fixedColumnsLeft"===e)throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{initOnly:!0}],["renderAllColumns",{initOnly:!0}],["renderAllRows",{initOnly:!0}]])),Op(this,Pp,((e,t,r)=>{if(!r)throw new Error(`The \`${e}\` option can not be updated after the Handsontable is initialized.`)})),this.metaManager=e,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach(((e,t)=>{const{initOnly:r,target:n,onChange:i}=e,o="string"===typeof n,a=o?n:t,s=`_${a}`;this.metaManager.globalMeta.meta[s]=this.metaManager.globalMeta.meta[a],i?(this.installPropWatcher(t,s,i),o&&this.installPropWatcher(n,s,i)):r&&(this.installPropWatcher(t,s,Ip(Pp,this)),this.metaManager.globalMeta.meta._initOnlySettings||(this.metaManager.globalMeta.meta._initOnlySettings=[]),this.metaManager.globalMeta.meta._initOnlySettings.push(t))}))}installPropWatcher(e,t,r){const n=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[t]},set(i){const o=!n.usageTracker.has(e);n.usageTracker.add(e),r.call(n,e,i,o),this[t]=i},enumerable:!0,configurable:!0})}}const Dp=/^(\r\n|\n\r|\r|\n)/,Fp=/^[^\t\r\n]+/,Lp=/^\t/;function Hp(e){let t,r,n,i,o,a="";for(t=0,r=e.length;t<r;t+=1){for(i=e[t].length,n=0;n<i;n+=1)n>0&&(a+="\t"),o=e[t][n],"string"===typeof o?o.indexOf("\n")>-1?a+=`"${o.replace(/"/g,'""')}"`:a+=o:a+=null===o||void 0===o?"":o;t!==r-1&&(a+="\n")}return a}function Bp(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Up{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,t,r){Bp(this,"hot",void 0),Bp(this,"metaManager",void 0),Bp(this,"tableMeta",void 0),Bp(this,"dataSource",void 0),Bp(this,"duckSchema",void 0),Bp(this,"colToPropCache",void 0),Bp(this,"propToColCache",void 0),this.hot=e,this.metaManager=r,this.tableMeta=r.getTableMeta(),this.dataSource=t,this.duckSchema=this.createDuckSchema(),this.createMap()}createMap(){const e=this.getSchema();if("undefined"===typeof e)throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const t=this.tableMeta.columns;let r;if(this.colToPropCache=[],this.propToColCache=new Map,t){let n=0,i=0,o=!1;if("function"===typeof t){const t=ho(e);n=t>0?t:this.countFirstRowKeys(),o=!0}else{const e=this.tableMeta.maxCols;n=Math.min(e,t.length)}for(r=0;r<n;r++){const e=o?t(r):t[r];if(so(e)){if("undefined"!==typeof e.data){const t=o?i:r;this.colToPropCache[t]=e.data,this.propToColCache.set(e.data,t)}i+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return mh(this.dataSource)}recursiveDuckColumns(e,t,r){let n,i=t,o=r;return"undefined"===typeof i&&(i=0,o=""),"object"!==typeof e||Array.isArray(e)||co(e,((e,t)=>{null===e?(n=o+t,this.colToPropCache.push(n),this.propToColCache.set(n,i),i+=1):i=this.recursiveDuckColumns(e,i,`${t}.`)})),i}colToProp(e){if(!1===Number.isInteger(e))return e;const t=this.hot.toPhysicalColumn(e);return null===t?e:this.colToPropCache&&Ni(this.colToPropCache[t])?this.colToPropCache[t]:t}propToCol(e){const t=this.propToColCache.get(e);if(Ni(t))return this.hot.toVisualColumn(t);const r=this.hot.toVisualColumn(e);return null===r?e:r}getSchema(){const e=this.tableMeta.dataSchema;return e?"function"===typeof e?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?Qi(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,{source:r,mode:n="above"}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=this.hot.countSourceRows();let o=i,a=0,s=e;("number"!==typeof s||s>=i)&&(s=i),s<this.hot.countRows()&&(o=this.hot.toPhysicalRow(s));if(!1===this.hot.runHooks("beforeCreateRow",s,t,r)||null===o)return{delta:0};const l=this.tableMeta.maxRows,c=this.getSchema().length,u=[];for(;a<t&&i+a<l;){let e=null;"array"===this.hot.dataType?this.tableMeta.dataSchema?e=no(this.getSchema()):(e=[],ja(c-1,(()=>e.push(null)))):"function"===this.hot.dataType?e=this.tableMeta.dataSchema(s+a):(e={},ro(e,this.getSchema())),u.push(e),a+=1}this.hot.rowIndexMapper.insertIndexes(s,a),"below"===n&&(o=Math.min(o+1,i)),this.spliceData(o,0,u);const h=this.hot.toVisualRow(o);return this.hot.countSourceRows()===u.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),a>0&&(void 0===e||null===e?this.metaManager.createRow(null,a):"auto"!==r&&this.metaManager.createRow(o,t)),this.hot.runHooks("afterCreateRow",h,a,r),this.hot.forceFullRender=!0,{delta:a,startPhysicalIndex:o}}createCol(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,{source:r,mode:n="start"}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const i=this.dataSource,o=this.tableMeta.maxCols,a=this.hot.countSourceCols();let s=e;("number"!==typeof s||s>=a)&&(s=a);if(!1===this.hot.runHooks("beforeCreateCol",s,t,r))return{delta:0};let l=a;s<this.hot.countCols()&&(l=this.hot.toPhysicalColumn(s));const c=this.hot.countSourceRows();let u=this.hot.countCols(),h=0,d=l;"end"===n&&(d=Math.min(d+1,a));const f=d;for(;h<t&&u<o;){if("number"!==typeof s||s>=u)if(c>0)for(let e=0;e<c;e+=1)"undefined"===typeof i[e]&&(i[e]=[]),i[e].push(null);else i.push([null]);else for(let e=0;e<c;e++)i[e].splice(d,0,null);h+=1,d+=1,u+=1}this.hot.columnIndexMapper.insertIndexes(s,h),h>0&&(void 0===e||null===e?this.metaManager.createColumn(null,h):"auto"!==r&&this.metaManager.createColumn(f,t));const g=this.hot.toVisualColumn(f);return this.hot.runHooks("afterCreateCol",g,h,r),this.hot.forceFullRender=!0,this.refreshDuckSchema(),{delta:h,startPhysicalIndex:f}}removeRow(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0,n=Number.isInteger(e)?e:-t;const i=this.visualRowsToPhysical(n,t),o=this.hot.countSourceRows();n=(o+n)%o;if(!1===this.hot.runHooks("beforeRemoveRow",n,i.length,i,r))return!1;const a=i.length;if(this.filterData(n,a,i),n<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(i);const e=Ni(this.tableMeta.columns)||Ni(this.tableMeta.dataSchema);0===this.hot.rowIndexMapper.getNotTrimmedIndexesLength()&&!1===e&&this.hot.columnIndexMapper.setIndexesSequence([])}const s=i.slice(0).sort(((e,t)=>t-e));return s.forEach((e=>{this.metaManager.removeRow(e,1)})),this.hot.runHooks("afterRemoveRow",n,a,i,r),this.hot.forceFullRender=!0,!0}removeCol(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0;if("object"===this.hot.dataType||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let n="number"!==typeof e?-t:e;n=(this.hot.countCols()+n)%this.hot.countCols();const i=this.visualColumnsToPhysical(n,t),o=i.slice(0).sort(((e,t)=>t-e));if(!1===this.hot.runHooks("beforeRemoveCol",n,t,i,r))return!1;let a=!0;const s=o.length,l=this.dataSource;for(let c=0;c<s;c++)a&&i[0]!==i[c]-c&&(a=!1);if(a)for(let c=0,u=this.hot.countSourceRows();c<u;c++)l[c].splice(i[0],t),0===c&&this.metaManager.removeColumn(i[0],t);else for(let c=0,u=this.hot.countSourceRows();c<u;c++)for(let e=0;e<s;e++)l[c].splice(o[e],1),0===c&&this.metaManager.removeColumn(o[e],1);return n<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(i),0===this.hot.columnIndexMapper.getNotTrimmedIndexesLength()&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",n,t,i,r),this.hot.forceFullRender=!0,this.refreshDuckSchema(),!0}spliceCol(e,t,r){const n=this.hot.getDataAtCol(e),i=n.slice(t,t+r),o=n.slice(t+r);for(var a=arguments.length,s=new Array(a>3?a-3:0),l=3;l<a;l++)s[l-3]=arguments[l];ki(s,o);let c=0;for(;c<r;)s.push(null),c+=1;return function(e){const t=e.length;let r=0;for(;r<t;)e[r]=[e[r]],r+=1}(s),this.hot.populateFromArray(t,e,s,null,null,"spliceCol"),i}spliceRow(e,t,r){const n=this.hot.getSourceDataAtRow(e),i=n.slice(t,t+r),o=n.slice(t+r);for(var a=arguments.length,s=new Array(a>3?a-3:0),l=3;l<a;l++)s[l-3]=arguments[l];ki(s,o);let c=0;for(;c<r;)s.push(null),c+=1;return this.hot.populateFromArray(e,t,[s],null,null,"spliceRow"),i}spliceData(e,t,r){if(!1!==this.hot.runHooks("beforeDataSplice",e,t,r)){const t=[...this.dataSource.slice(0,e),...r,...this.dataSource.slice(e)];this.dataSource.length=0,t.forEach((e=>this.dataSource.push(e)))}}filterData(e,t,r){let n=this.hot.runHooks("filterData",e,t,r);!1===Array.isArray(n)&&(n=this.dataSource.filter(((e,t)=>-1===r.indexOf(t)))),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,n)}get(e,t){const r=this.hot.toPhysicalRow(e);let n=this.dataSource[r];const i=this.hot.runHooks("modifyRowData",r);n=isNaN(i)?i:n;const{dataDotNotation:o}=this.hot.getSettings();let a=null;if(n&&n.hasOwnProperty&&go(n,t))a=n[t];else if(o&&"string"===typeof t&&t.indexOf(".")>-1){let e=n;if(!e)return null;const r=t.split(".");for(let t=0,n=r.length;t<n;t++)if(e=e[r[t]],"undefined"===typeof e)return null;a=e}else"function"===typeof t&&(a=t(this.dataSource.slice(r,r+1)[0]));if(this.hot.hasHook("modifyData")){const e=fo(a);this.hot.runHooks("modifyData",r,this.propToCol(t),e,"get"),e.isTouched()&&(a=e.value)}return a}getCopyable(e,t){return this.hot.getCellMeta(e,this.propToCol(t)).copyable?this.get(e,t):""}set(e,t,r){const n=this.hot.toPhysicalRow(e);let i=r,o=this.dataSource[n];const a=this.hot.runHooks("modifyRowData",n);if(o=isNaN(a)?a:o,this.hot.hasHook("modifyData")){const e=fo(i);this.hot.runHooks("modifyData",n,this.propToCol(t),e,"set"),e.isTouched()&&(i=e.value)}const{dataDotNotation:s}=this.hot.getSettings();if(o&&o.hasOwnProperty&&go(o,t))o[t]=i;else if(s&&"string"===typeof t&&t.indexOf(".")>-1){let e,r=o,n=0;const a=t.split(".");for(n=0,e=a.length-1;n<e;n++)"undefined"===typeof r[a[n]]&&(r[a[n]]={}),r=r[a[n]];r[a[n]]=i}else"function"===typeof t?t(this.dataSource.slice(n,n+1)[0],i):o[t]=i}visualRowsToPhysical(e,t){const r=this.hot.countSourceRows(),n=[];let i,o=(r+e)%r,a=t;for(;o<r&&a;)i=this.hot.toPhysicalRow(o),n.push(i),a-=1,o+=1;return n}visualColumnsToPhysical(e,t){const r=this.hot.countCols(),n=[];let i=(r+e)%r,o=t;for(;i<r&&o;){const e=this.hot.toPhysicalColumn(i);n.push(e),o-=1,i+=1}return n}clear(){for(let e=0;e<this.hot.countSourceRows();e++)for(let t=0;t<this.hot.countCols();t++)this.set(e,this.colToProp(t),"")}getLength(){const e=this.tableMeta.maxRows;let t;t=e<0||0===e?0:e||1/0;const r=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(r,t)}getAll(){const e={row:0,col:0},t={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return e.row-t.row!==0||this.hot.countSourceRows()?this.getRange(e,t,Up.DESTINATION_RENDERER):[]}countCachedColumns(){return this.colToPropCache.length}getRange(e,t,r){const n=[];let i,o,a;const s=this.tableMeta.maxRows,l=this.tableMeta.maxCols;if(0===s||0===l)return[];const c=r===Up.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,u=Math.min(Math.max(s-1,0),Math.max(e.row,t.row)),h=Math.min(Math.max(l-1,0),Math.max(e.col,t.col));for(i=Math.min(e.row,t.row);i<=u;i++){a=[];const r=i>=0?this.hot.toPhysicalRow(i):i;for(o=Math.min(e.col,t.col);o<=h&&null!==r;o++)a.push(c.call(this,i,this.colToProp(o)));null!==r&&n.push(a)}return n}getText(e,t){return Hp(this.getRange(e,t,Up.DESTINATION_RENDERER))}getCopyableText(e,t){return Hp(this.getRange(e,t,Up.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}const jp=Up;function Wp(e,t,r,n){const{hotInstance:i,dataMap:o,dataSource:a,internalSource:s,source:l,metaManager:c,firstRun:u}=n,h=un(s),d=i.getSettings();Array.isArray(d.dataSchema)?i.dataType="array":Yi(d.dataSchema)?i.dataType="function":i.dataType="object",o&&o.destroy(),e=i.runHooks(`before${h}`,e,u,l);const f=new jp(i,e,c);if(t(f),"object"===typeof e&&null!==e)e.push&&e.splice||(e=[e]);else{if(null!==e)throw new Error(`${s} only accepts array of objects or array of arrays (${typeof e} given)`);{const t=f.getSchema();let r;e=[];let n=0,o=0;for(n=0,o=d.startRows;n<o;n++)if("object"!==i.dataType&&"function"!==i.dataType||!d.dataSchema)if("array"===i.dataType)r=no(t[0]),e.push(r);else{r=[];for(let e=0,t=d.startCols;e<t;e++)r.push(null);e.push(r)}else r=no(t),e.push(r)}}Array.isArray(e[0])&&(i.dataType="array"),d.data=e,f.dataSource=e,a.data=e,a.dataType=i.dataType,a.colToProp=f.colToProp.bind(f),a.propToCol=f.propToCol.bind(f),a.countCachedColumns=f.countCachedColumns.bind(f),r(f),i.runHooks(`after${h}`,e,u,l),u||(i.runHooks("afterChange",null,s),i.render()),i.getSettings().ariaTags&&Vn(i.rootElement,[Cn(-1),kn(i.countCols()+(i.view?i.countRowHeaders():0))])}const Vp="gridDefault",zp="editorManager.handlingEditor";function qp(e){const t=e.rootDocument.createElement("input");return t.type="text",t.classList.add("htFocusCatcher"),e.getSettings().ariaTags&&Vn(t,[vn(),wn()]),t}function Gp(e){const t=function(e){return t=>{if(!t)return null;const r=$p(e),n=Kp(e);return t.col<r.col&&(t.col=r.col),t.col>n.col&&(t.col=n.col),t.row<r.row&&(t.row=r.row),t.row>n.row&&(t.row=n.row),t}}(e);let r;const{activate:n,deactivate:i}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=e.rootElement,n=qp(e),i=qp(e);return n.addEventListener("focus",(()=>null===t||void 0===t?void 0:t.onFocusFromTop())),i.addEventListener("focus",(()=>null===t||void 0===t?void 0:t.onFocusFromBottom())),r.firstChild.before(n),r.lastChild.after(i),{activate(){e._registerTimeout((()=>{n.tabIndex=0,i.tabIndex=0}),10)},deactivate(){e._registerTimeout((()=>{n.tabIndex=-1,i.tabIndex=-1}),10)}}}(e,{onFocusFromTop(){var n;const i=null!==(n=t(r))&&void 0!==n?n:$p(e);i&&(e.runHooks("modifyFocusOnTabNavigation","from_above",i),e.selectCell(i.row,i.col)),e.listen()},onFocusFromBottom(){var n;const i=null!==(n=t(r))&&void 0!==n?n:Kp(e);i&&(e.runHooks("modifyFocusOnTabNavigation","from_below",i),e.selectCell(i.row,i.col)),e.listen()}}),o={wrapped:!1,flipped:!1};let a=!0,s=!1,l=!1;e.addHook("afterListen",(()=>i())),e.addHook("afterUnlisten",(()=>n())),e.addHook("afterSelection",((t,n,i,c,u)=>{var h;(s&&(o.wrapped&&o.flipped||l)&&(l=!1,u.value=!0),a)&&(r=null===(h=e.getSelectedRangeLast())||void 0===h?void 0:h.highlight)})),e.addHook("beforeRowWrap",((e,t,r)=>{o.wrapped=!0,o.flipped=r}));const c={keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:Vp,group:"focusCatcher"};e.getShortcutManager().getContext("grid").addShortcuts([{...c,callback:()=>{const{tabNavigation:t}=e.getSettings();s=!0,e.getSelectedRangeLast()&&!t&&(a=!1),t||(l=!0)},position:"before"},{...c,callback:t=>{const{tabNavigation:n,autoWrapRow:i}=e.getSettings();if(s=!1,a=!0,!n||!e.selection.isSelected()||i&&o.wrapped&&o.flipped||!i&&o.wrapped)return i&&o.wrapped&&o.flipped&&(r=t.shiftKey?$p(e):Kp(e)),o.wrapped=!1,o.flipped=!1,e.deselectCell(),e.unlisten(),!1;t.preventDefault()},position:"after"}])}function $p(e){const{rowIndexMapper:t,columnIndexMapper:r}=e,{navigableHeaders:n}=e.getSettings();let i=n&&e.countColHeaders()>0?-e.countColHeaders():0,o=n&&e.countRowHeaders()>0?-e.countRowHeaders():0;return 0===i&&(i=t.getVisualFromRenderableIndex(i)),0===o&&(o=r.getVisualFromRenderableIndex(o)),null===i||null===o?null:e._createCellCoords(i,o)}function Kp(e){var t,r;const{rowIndexMapper:n,columnIndexMapper:i}=e,{navigableHeaders:o}=e.getSettings();let a=n.getRenderableIndexesLength()-1,s=i.getRenderableIndexesLength()-1;if(a<0){if(!o||0===e.countColHeaders())return null;a=-1}if(s<0){if(!o||0===e.countColHeaders())return null;s=-1}return e._createCellCoords(null!==(t=n.getVisualFromRenderableIndex(a))&&void 0!==t?t:a,null!==(r=i.getVisualFromRenderableIndex(s))&&void 0!==r?r:s)}const Yp=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),Xp=e=>e.map((e=>{const t=e.toLowerCase();return Yp.has(t)?Yp.get(t):t})).sort().join("+"),Jp=new Map([[186,"semicolon"],[187,"equal"],[188,"comma"],[189,"minus"],[190,"period"],[191,"slash"],[192,"backquote"],[219,"bracketleft"],[220,"backslash"],[221,"bracketright"],[222,"quote"]]),Zp=e=>{let{which:t,key:r}=e;if(Jp.has(t))return Jp.get(t);const n=String.fromCharCode(t).toLowerCase();return/^[a-z0-9]$/.test(n)?n:r.toLowerCase()},Qp=Symbol("shortcut-context");function em(e){return so(e)&&e.__kindOf===Qp}const tm=["meta","alt","shift","control"],rm=function(){const e=new Set;return{press(t){e.add(t)},release(t){e.delete(t)},releaseAll(){e.clear()},isPressed:t=>e.has(t)}}(),nm=[];let im=0;const om=e=>{let{ownerWindow:t,handleEvent:r,beforeKeyDown:n,afterKeyDown:i}=e;const o=Xa({errorIdExists:e=>`The "${e}" context name is already registered.`});let a="grid";const s=()=>a,l=e=>o.getItem(e);let c=!1;const u=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:s();const n=em(r)?r:l(r);let i=!1;if(!n.hasShortcut(t))return i;const o=n.getShortcuts(t);for(let a=0;a<o.length;a++){const{callback:r,runOnlyIf:n,preventDefault:s,stopPropagation:l,captureCtrl:h,forwardToContext:d}=o[a];if(!0===n(e)){if(c=h,i=!1===r(e,t),c=!1,s&&e.preventDefault(),l&&(No(e),e.stopPropagation()),i)break;d&&u(e,t,d)}}return i},h=function(e,t,r,n,i){const o=e=>tm.includes(e),a=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const r=[];return e.altKey&&r.push("alt"),t&&(e.ctrlKey||e.metaKey)?r.push("control/meta"):(e.ctrlKey&&r.push("control"),e.metaKey&&r.push("meta")),e.shiftKey&&r.push("shift"),r},s=e=>{if(!1===t(e))return;const s=r(e);if(229===e.keyCode||!1===s||Do(e))return;const l=Zp(e);let c=[];o(l)||(c=a(e));const u=[l].concat(c);!i(e,u)&&(Ro()&&c.includes("meta")||!Ro()&&c.includes("control"))&&i(e,[l].concat(a(e,!0))),n(e)},l=e=>{if(e.key){const t=Zp(e);o(t)&&rm.press(t)}},c=e=>{if(e.key){const t=Zp(e);o(t)&&rm.release(t)}},u=()=>{rm.releaseAll()};return{mount:()=>{let t=e;for(im+=1;t;)1===im&&(t.document.documentElement.addEventListener("keydown",l),nm.push({event:"keydown",listener:l}),t.document.documentElement.addEventListener("keyup",c),nm.push({event:"keyup",listener:c})),t.document.documentElement.addEventListener("keydown",s),t.document.documentElement.addEventListener("blur",u),t=Pn(t)},unmount:()=>{let t=e;for(im-=1;t;){if(0===im){for(let e=0;e<nm.length;e++){const{event:r,listener:n}=nm[e];t.document.documentElement.removeEventListener(r,n)}nm.length=0}t.document.documentElement.removeEventListener("keydown",s),t.document.documentElement.removeEventListener("blur",u),t=Pn(t)}},isPressed:e=>rm.isPressed(e),releasePressedKeys:()=>rm.releaseAll()}}(t,r,n,i,u);return h.mount(),{addContext:e=>{const t=(e=>{const t=Xa({errorIdExists:t=>`The "${t}" shortcut is already registered in the "${e}" context.`}),r=function(){let{keys:e,callback:r,group:n,runOnlyIf:i=()=>!0,captureCtrl:o=!1,preventDefault:a=!0,stopPropagation:s=!1,relativeToGroup:l,position:c,forwardToContext:u}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(Di(n))throw new Error("You need to define the shortcut's group.");if(!1===Yi(r))throw new Error("The shortcut's callback needs to be a function.");if(!1===Array.isArray(e))throw new Error(Ii`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const h={callback:r,group:n,runOnlyIf:i,captureCtrl:o,preventDefault:a,stopPropagation:s};Ni(l)&&(h.relativeToGroup=l,h.position=c),em(u)&&(h.forwardToContext=u),e.forEach((e=>{const r=Xp(e);if(t.hasItem(r)){const e=t.getItem(r);let n=e.findIndex((e=>e.group===l));-1!==n?"before"===c?n-=1:n+=1:n=e.length,e.splice(n,0,h)}else t.addItem(r,[h])}))},n=e=>{const r=Xp(e);t.removeItem(r)};return{__kindOf:Qp,addShortcut:r,addShortcuts:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.forEach((e=>{co(t,((r,n)=>{!1===Object.prototype.hasOwnProperty.call(e,n)&&(e[n]=t[n])})),r(e)}))},getShortcuts:e=>{const r=Xp(e),n=t.getItem(r);return Ni(n)?n.slice():[]},hasShortcut:e=>{const r=Xp(e);return t.hasItem(r)},removeShortcutsByKeys:n,removeShortcutsByGroup:e=>{t.getItems().forEach((t=>{let[r,i]=t;const o=i.filter((t=>t.group!==e));0===o.length?n((e=>e.split("+"))(r)):(i.length=0,i.push(...o))}))}}})(e);return o.addItem(e,t),t},getActiveContextName:s,getContext:l,setActiveContextName:e=>{if(!o.hasItem(e))throw new Error(Ii`You've tried to activate the "${e}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);a=e},isCtrlPressed:()=>!c&&(h.isPressed("control")||h.isPressed("meta")),releasePressedKeys:()=>h.releasePressedKeys(),destroy:()=>h.unmount()}},am={name:"editorCloseAndSave",callback(e){e._getEditorManager().closeEditorAndSaveChanges()}},sm={_hooksStorage:Object.create(null),addHook(e,t){return this._hooksStorage[e]||(this._hooksStorage[e]=[]),this.hot.addHook(e,t),this._hooksStorage[e].push(t),this},removeHooksByKey(e){Ai(this._hooksStorage[e]||[],(t=>{this.hot.removeHook(e,t)}))},clearHooks(){co(this._hooksStorage,((e,t)=>this.removeHooksByKey(t))),this._hooksStorage={}}};lo(sm,"MIXIN_NAME","hooksRefRegisterer",{writable:!1,enumerable:!1});const lm=sm;function cm(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const um=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"});class hm{static get EDITOR_TYPE(){return"base"}constructor(e){cm(this,"hot",void 0),cm(this,"state",um.VIRGIN),cm(this,"_opened",!1),cm(this,"_fullEditMode",!1),cm(this,"_closeCallback",null),cm(this,"TD",null),cm(this,"row",null),cm(this,"col",null),cm(this,"prop",null),cm(this,"originalValue",null),cm(this,"cellProperties",null),this.hot=e,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,t,r,n,i,o){this.TD=n,this.row=e,this.col=t,this.prop=r,this.originalValue=i,this.cellProperties=o,this.state=this.isOpened()?this.state:um.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,t){let r,n,i,o;if(t){const e=this.hot.getSelectedLast();r=Math.max(Math.min(e[0],e[2]),0),n=Math.max(Math.min(e[1],e[3]),0),i=Math.max(e[0],e[2]),o=Math.max(e[1],e[3])}else[r,n,i,o]=[this.row,this.col,null,null];const a=this.hot.runHooks("modifyGetCellCoords",r,n);Array.isArray(a)&&([r,n]=a),this.hot.populateFromArray(r,n,e,i,o,"edit")}beginEditing(e,t){if(this.state!==um.VIRGIN)return;const r=this.hot,n=r.rowIndexMapper.getRenderableFromVisualIndex(this.row),i=r.columnIndexMapper.getRenderableFromVisualIndex(this.col);if(r.view.scrollViewport(r._createCellCoords(n,i)),this.state=um.EDITING,this.isInFullEditMode()){const t="string"===typeof e?e:Pi(this.originalValue);this.setValue(t)}this.open(t),this._opened=!0,this.focus(),r.view.render(),r.runHooks("afterBeginEditing",this.row,this.col)}finishEditing(e,t,r){let n;if(r){const e=this._closeCallback;this._closeCallback=t=>{e&&e(t),r(t),this.hot.view.render()}}if(!this.isWaiting())if(this.state!==um.VIRGIN){if(this.state===um.EDITING){if(e)return this.cancelChanges(),void this.hot.view.render();const r=this.getValue();n=this.cellProperties.trimWhitespace?[["string"===typeof r?String.prototype.trim.call(r||""):r]]:[[r]],this.state=um.WAITING,this.saveValue(n,t),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",(e=>{this.state=um.FINISHED,this.discardEditor(e)})):(this.state=um.FINISHED,this.discardEditor(!0))}}else this.hot._registerTimeout((()=>{this._fireCallbacks(!0)}))}cancelChanges(){this.state=um.FINISHED,this.discardEditor()}discardEditor(e){if(this.state===um.FINISHED)if(!1===e&&!0!==this.cellProperties.allowInvalid)this.hot.selectCell(this.row,this.col),this.focus(),this.state=um.EDITING,this._fireCallbacks(!1);else{this.close(),this._opened=!1,this._fullEditMode=!1,this.state=um.VIRGIN,this._fireCallbacks(!0);this.hot.getShortcutManager().setActiveContextName("grid")}}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===um.WAITING}getEditedCellRect(){var e;const t=this.getEditedCell();if(!t)return;const{wtOverlays:r,wtViewport:n}=this.hot.view._wt,i=this.hot.rootWindow,o=Jn(t),a=ai(t),s=Jn(this.hot.rootElement),l=ai(this.hot.rootElement),c=r.topOverlay.holder,u=r.inlineStartOverlay.holder,h=c!==i?c.scrollTop:0,d=u!==i?u.scrollLeft:0,f=i.innerWidth-s.left-l,{wtTable:g}=null!==(e=r.getParentOverlay(t))&&void 0!==e?e:this.hot.view._wt,p=g.name,m=["master","inline_start"].includes(p)?h:0,v=["master","top","bottom"].includes(p)?d:0,b=o.top===s.top?0:1;let y=o.top-s.top-b-m,w=0;w=this.hot.isRtl()?i.innerWidth-o.left-a-f-1+v:o.left-s.left-1-v,["top","top_inline_start_corner"].includes(p)&&(y+=r.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(p)&&(w+=Math.abs(r.inlineStartOverlay.getOverlayOffset()));const S=this.hot.hasColHeaders(),C=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),k=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),x=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(S&&C<=0||C===x)&&(y+=1),k<=0&&(w+=1);const E=n.rowsRenderCalculator.startPosition,T=n.columnsRenderCalculator.startPosition,_=Math.abs(r.inlineStartOverlay.getScrollPosition()),A=r.topOverlay.getScrollPosition(),R=gi(this.hot.rootDocument);let O=t.offsetTop;if(["inline_start","master"].includes(p)&&(O+=E-A),["bottom","bottom_inline_start_corner"].includes(p)){const{wtViewport:e,wtTable:t}=r.bottomOverlay.clone;O+=e.getWorkspaceHeight()-t.getHeight()-R}let M=t.offsetLeft;this.hot.isRtl()?(M=M>=0?g.getWidth()-t.offsetLeft:Math.abs(M),M+=T-_-a):["top","master","bottom"].includes(p)&&(M+=T-_);const I=oi(this.TD,this.hot.rootWindow),P=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",N=parseInt(I[P],10)>0?0:1,D=parseInt(I.borderTopWidth,10)>0?0:1,F=ai(t)+N,L=si(t)+D,H=(B=c).offsetWidth!==B.clientWidth?R:0;var B;const U=function(e){return e.offsetHeight!==e.clientHeight}(u)?R:0,j=this.hot.view.maximumVisibleElementWidth(M)-H+N;return{top:y,start:w,height:L,maxHeight:Math.max(this.hot.view.maximumVisibleElementHeight(O)-U+D,23),width:F,maxWidth:j}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const e=this.hot.countRows();let t="";return this.row<this.hot.getSettings().fixedRowsTop?t=this.col<this.hot.getSettings().fixedColumnsStart?"top-inline-start-corner":"top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?t=this.col<this.hot.getSettings().fixedColumnsStart?"bottom-inline-start-corner":"bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(t="inline-start"),t}}oo(hm,lm);const dm={name:"editorCloseAndSaveByArrowKeys",callback(e,t,r){const n=e._getEditorManager(),i=n.getActiveEditor();i.isInFullEditMode()&&i.state===um.EDITING||(n.closeEditorAndSaveChanges(),e.getSelected()&&(r.includes("arrowdown")?e.selection.transformStart(1,0):r.includes("arrowup")?e.selection.transformStart(-1,0):r.includes("arrowleft")?e.selection.transformStart(0,-1*e.getDirectionFactor()):r.includes("arrowright")&&e.selection.transformStart(0,e.getDirectionFactor())),t.preventDefault())}},fm={name:"editorCloseAndSaveByEnter",callback(e,t){const r=e._getEditorManager();r.closeEditorAndSaveChanges(t.ctrlKey||t.metaKey),r.moveSelectionAfterEnter(t)}},gm={name:"editorCloseWithoutSaving",callback(e){const t=e._getEditorManager();t.closeEditorAndRestoreOriginalValue(e.getShortcutManager().isCtrlPressed()),t.activeEditor.focus()}},pm={name:"editorFastOpen",callback(e,t){const{highlight:r}=e.getSelectedRangeLast();r.isHeader()||e._getEditorManager().openEditor(null,t,!0)}},mm={name:"editorOpen",callback(e,t,r){const n=e._getEditorManager(),i=e.getSelectedRangeLast(),{highlight:o}=i;if(e.selection.isMultiple()&&!i.isHeader()&&e.countRenderedCols()>0&&e.countRenderedRows()>0){const n=e.getSettings(),i="function"===typeof n.enterMoves?n.enterMoves(t):n.enterMoves;r.includes("shift")?e.selection.transformFocus(-i.row,-i.col):e.selection.transformFocus(i.row,i.col)}else o.isHeader()||(e.getSettings().enterBeginsEditing?n.cellProperties.readOnly?n.moveSelectionAfterEnter(t):n.openEditor(null,t,!0):n.moveSelectionAfterEnter(t),No(t))}};const vm={name:"extendCellsSelectionDown",callback(e){const{highlight:t}=e.getSelectedRangeLast();e.selection.isSelectedByColumnHeader()||e.selection.isSelectedByCorner()||!(t.isCell()||t.isHeader()&&e.selection.isSelectedByRowHeader())||e.selection.transformEnd(1,0)}},bm={name:"extendCellsSelectionDownByViewportHeight",callback(e){const{to:t}=e.getSelectedRangeLast(),r=Math.min(t.row+e.countVisibleRows(),e.countRows()-1),n=e.rowIndexMapper.getNearestNotHiddenIndex(r,-1);if(null!==n){const r=e._createCellCoords(n,t.col),i=t.row-e.view.getFirstFullyVisibleRow(),o=Math.min(r.row-i,e.countRows()-1);e.selection.setRangeEnd(r),e.scrollViewportTo({row:o,verticalSnap:"top",horizontalSnap:"start"})}}},ym={name:"extendCellsSelectionLeft",callback(e){const{highlight:t}=e.getSelectedRangeLast();e.selection.isSelectedByRowHeader()||e.selection.isSelectedByCorner()||!(t.isCell()||t.isHeader()&&e.selection.isSelectedByColumnHeader())||e.selection.transformEnd(0,-1*e.getDirectionFactor())}},wm={name:"extendCellsSelectionRight",callback(e){const{highlight:t}=e.getSelectedRangeLast();e.selection.isSelectedByRowHeader()||e.selection.isSelectedByCorner()||!(t.isCell()||t.isHeader()&&e.selection.isSelectedByColumnHeader())||e.selection.transformEnd(0,e.getDirectionFactor())}},Sm={name:"extendCellsSelectionToColumns",callback(e){const{highlight:t,from:r,to:n}=e.getSelectedRangeLast();e.selection.isSelectedByRowHeader()?e.selection.selectAll(!0,!0):e.selectColumns(r.col,n.col,t)}},Cm={name:"extendCellsSelectionToMostBottom",callback(e){const{selection:t,rowIndexMapper:r}=e,{highlight:n,from:i,to:o}=e.getSelectedRangeLast(),a=n.isHeader()&&e.selection.isSelectedByRowHeader();if(n.isCell()||a){const s=r.getNearestNotHiddenIndex(e.countRows()-1,-1),l=i.clone();l.row=n.row,t.setRangeStart(l,void 0,!1,n.clone()),a&&t.selectedByRowHeader.add(t.getLayerLevel()),t.setRangeEnd(e._createCellCoords(s,o.col))}}},km={name:"extendCellsSelectionToMostInlineEnd",callback(e){const{selection:t,columnIndexMapper:r}=e,{highlight:n,from:i,to:o}=e.getSelectedRangeLast();if(!e.selection.isSelectedByRowHeader()&&!e.selection.isSelectedByCorner()&&n.isCell()){const a=r.getNearestNotHiddenIndex(e.countCols()-1,-1),s=i.clone();s.col=n.col,t.setRangeStart(s,void 0,!1,n.clone()),t.setRangeEnd(e._createCellCoords(o.row,a))}}},xm={name:"extendCellsSelectionToMostInlineStart",callback(e){const{selection:t,columnIndexMapper:r}=e,{highlight:n,from:i,to:o}=e.getSelectedRangeLast();if(!e.selection.isSelectedByRowHeader()&&!e.selection.isSelectedByCorner()&&n.isCell()){const a=parseInt(e.getSettings().fixedColumnsStart,10),s=r.getNearestNotHiddenIndex(a,1),l=i.clone();l.col=n.col,t.setRangeStart(l,void 0,!1,n.clone()),t.setRangeEnd(e._createCellCoords(o.row,s))}}},Em={name:"extendCellsSelectionToMostLeft",callback(e){const{selection:t,columnIndexMapper:r}=e,{highlight:n,from:i,to:o}=e.getSelectedRangeLast(),a=n.isHeader()&&e.selection.isSelectedByColumnHeader();if(n.isCell()||a){const s=r.getNearestNotHiddenIndex(...e.isRtl()?[e.countCols()-1,-1]:[0,1]),l=i.clone();l.col=n.col,t.setRangeStart(l,void 0,!1,n.clone()),a&&t.selectedByColumnHeader.add(t.getLayerLevel()),t.setRangeEnd(e._createCellCoords(o.row,s))}}},Tm={name:"extendCellsSelectionToMostRight",callback(e){const{selection:t,columnIndexMapper:r}=e,{highlight:n,from:i,to:o}=e.getSelectedRangeLast(),a=n.isHeader()&&e.selection.isSelectedByColumnHeader();if(n.isCell()||a){const s=r.getNearestNotHiddenIndex(...e.isRtl()?[0,1]:[e.countCols()-1,-1]),l=i.clone();l.col=n.col,t.setRangeStart(l,void 0,!1,n.clone()),a&&t.selectedByColumnHeader.add(t.getLayerLevel()),t.setRangeEnd(e._createCellCoords(o.row,s))}}},_m={name:"extendCellsSelectionToMostTop",callback(e){const{selection:t,rowIndexMapper:r}=e,{highlight:n,from:i,to:o}=e.getSelectedRangeLast(),a=n.isHeader()&&e.selection.isSelectedByRowHeader();if(n.isCell()||a){const s=r.getNearestNotHiddenIndex(0,1),l=i.clone();l.row=n.row,t.setRangeStart(l,void 0,!1,n.clone()),a&&t.selectedByRowHeader.add(t.getLayerLevel()),t.setRangeEnd(e._createCellCoords(s,o.col))}}},Am={name:"extendCellsSelectionToRows",callback(e){const{highlight:t,from:r,to:n}=e.getSelectedRangeLast();e.selection.isSelectedByColumnHeader()?e.selection.selectAll(!0,!0):e.selectRows(r.row,n.row,t)}},Rm={name:"extendCellsSelectionUp",callback(e){const{highlight:t}=e.getSelectedRangeLast();e.selection.isSelectedByColumnHeader()||e.selection.isSelectedByCorner()||!(t.isCell()||t.isHeader()&&e.selection.isSelectedByRowHeader())||e.selection.transformEnd(-1,0)}},Om={name:"extendCellsSelectionUpByViewportHeight",callback(e){const{to:t}=e.getSelectedRangeLast(),r=Math.max(t.row-e.countVisibleRows(),0),n=e.rowIndexMapper.getNearestNotHiddenIndex(r,1);if(null!==n){const r=e._createCellCoords(n,t.col),i=t.row-e.view.getFirstFullyVisibleRow(),o=Math.max(r.row-i,0);e.selection.setRangeEnd(r),e.scrollViewportTo({row:o,verticalSnap:"top",horizontalSnap:"start"})}}};const Mm={name:"moveCellSelectionDown",callback(e){let{selection:t}=e;t.transformStart(1,0)}},Im={name:"moveCellSelectionDownByViewportHeight",callback(e){const{navigableHeaders:t}=e.getSettings(),r=t?e.countColHeaders():0,{row:n}=e.getSelectedRangeLast().highlight;let i=e.countVisibleRows()+r;n===e.countRows()-1?i=1:n+i>e.countRows()&&(i=e.countRows()-n-1),e.selection.transformStart(i,0),e.getSelectedRangeLast().highlight.row<0&&e.scrollViewportTo({row:0})}},Pm={name:"moveCellSelectionInlineEnd",callback(e,t){const r=e.getSettings(),n=e.getSelectedRangeLast(),i="function"===typeof r.tabMoves?r.tabMoves(t):r.tabMoves;e.selection.isMultiple()&&!n.isHeader()&&e.countRenderedCols()>0&&e.countRenderedRows()>0?e.selection.transformFocus(-i.row,-i.col):e.selection.transformStart(-i.row,-i.col)}},Nm={name:"moveCellSelectionInlineStart",callback(e,t){const r=e.getSettings(),n=e.getSelectedRangeLast(),i="function"===typeof r.tabMoves?r.tabMoves(t):r.tabMoves;e.selection.isMultiple()&&!n.isHeader()&&e.countRenderedCols()>0&&e.countRenderedRows()>0?e.selection.transformFocus(i.row,i.col):e.selection.transformStart(i.row,i.col)}},Dm={name:"moveCellSelectionLeft",callback(e){e.selection.transformStart(0,-1*e.getDirectionFactor())}},Fm={name:"moveCellSelectionRight",callback(e){e.selection.transformStart(0,e.getDirectionFactor())}},Lm={name:"moveCellSelectionToMostBottom",callback(e){const{col:t}=e.getSelectedRangeLast().highlight;let r=e.rowIndexMapper.getNearestNotHiddenIndex(e.countRows()-1,-1);null===r&&(r=-1),e.selection.setRangeStart(e._createCellCoords(r,t))}},Hm={name:"moveCellSelectionToMostBottomInlineEnd",callback(e){const{selection:t,rowIndexMapper:r,columnIndexMapper:n}=e,i=parseInt(e.getSettings().fixedRowsBottom,10),o=r.getNearestNotHiddenIndex(e.countRows()-i-1,-1),a=n.getNearestNotHiddenIndex(e.countCols()-1,-1);t.setRangeStart(e._createCellCoords(o,a))}},Bm={name:"moveCellSelectionToMostInlineEnd",callback(e){const{selection:t,columnIndexMapper:r}=e;t.setRangeStart(e._createCellCoords(e.getSelectedRangeLast().highlight.row,r.getNearestNotHiddenIndex(e.countCols()-1,-1)))}},Um={name:"moveCellSelectionToMostInlineStart",callback(e){const{selection:t,columnIndexMapper:r}=e,n=parseInt(e.getSettings().fixedColumnsStart,10),i=e.getSelectedRangeLast().highlight.row,o=r.getNearestNotHiddenIndex(n,1);t.setRangeStart(e._createCellCoords(i,o))}},jm={name:"moveCellSelectionToMostLeft",callback(e){const{selection:t,columnIndexMapper:r}=e,n=e.getSelectedRangeLast().highlight.row;let i=r.getNearestNotHiddenIndex(...e.isRtl()?[e.countCols()-1,-1]:[0,1]);null===i&&(i=e.isRtl()?-1:-e.countRowHeaders()),t.setRangeStart(e._createCellCoords(n,i))}},Wm={name:"moveCellSelectionToMostRight",callback(e){const{selection:t,columnIndexMapper:r}=e,{row:n}=e.getSelectedRangeLast().highlight;let i=r.getNearestNotHiddenIndex(...e.isRtl()?[0,1]:[e.countCols()-1,-1]);null===i&&(i=e.isRtl()?-e.countRowHeaders():-1),t.setRangeStart(e._createCellCoords(n,i))}},Vm={name:"moveCellSelectionToMostTop",callback(e){const{col:t}=e.getSelectedRangeLast().highlight;let r=e.rowIndexMapper.getNearestNotHiddenIndex(0,1);null===r&&(r=-e.countColHeaders()),e.selection.setRangeStart(e._createCellCoords(r,t))}},zm={name:"moveCellSelectionToMostTopInlineStart",callback(e){const{selection:t,rowIndexMapper:r,columnIndexMapper:n}=e,i=parseInt(e.getSettings().fixedRowsTop,10),o=parseInt(e.getSettings().fixedColumnsStart,10),a=r.getNearestNotHiddenIndex(i,1),s=n.getNearestNotHiddenIndex(o,1);t.setRangeStart(e._createCellCoords(a,s))}},qm={name:"moveCellSelectionUp",callback(e){let{selection:t}=e;t.transformStart(-1,0)}},Gm={name:"moveCellSelectionUpByViewportHight",callback(e){const{navigableHeaders:t}=e.getSettings(),r=t?e.countColHeaders():0,{row:n}=e.getSelectedRangeLast().highlight;let i=-(e.countVisibleRows()+r);n===-r?i=-1:n+i<r&&(i=-(n+r)),e.selection.transformStart(i,0),e.getSelectedRangeLast().highlight.row<0&&e.scrollViewportTo({row:0})}};const $m={name:"emptySelectedCells",callback(e){e.emptySelectedCells(),e._getEditorManager().prepareEditor()}},Km={name:"scrollToFocusedCell",callback(e){const{highlight:t}=e.getSelectedRangeLast(),r=e.view.getFirstFullyVisibleRow()-1,n=e.view.getFirstFullyVisibleColumn()-1,i=e.view.getLastFullyVisibleRow()+1,o=e.view.getLastFullyVisibleColumn()+1,a=e._createCellCoords(r,n),s=e._createCellCoords(i,o);if(!e._createCellRange(a,a,s).includes(t)&&(t.row>=0||t.col>=0)){const r={};if(t.col>=0){const n=Math.floor(e.countVisibleCols()/2);r.col=Math.max(t.col-n,0)}if(t.row>=0){const n=Math.floor(e.countVisibleRows()/2);r.row=Math.max(t.row-n,0)}e.scrollViewportTo({...r,verticalSnap:"top",horizontalSnap:"start"})}}},Ym={name:"selectAllCells",callback(e){e.selection.selectAll(!0,!0,{disableHeadersHighlight:!0})}},Xm={name:"selectAllCellsAndHeaders",callback(e){e.selection.selectAll(!0,!0,{disableHeadersHighlight:!1})}},Jm={name:"populateSelectedCellsData",callback(e){const t=e.getSelectedRange(),{row:r,col:n}=t[t.length-1].highlight.normalize(),i=e.getDataAtCell(r,n),o=new Map;for(let a=0;a<t.length;a++)t[a].forAll(((t,a)=>{if(t>=0&&a>=0&&(t!==r||a!==n)){const{readOnly:r}=e.getCellMeta(t,a);r||o.set(`${t}x${a}`,[t,a,i])}}));e.setDataAtCell(Array.from(o.values()))}},Zm=[am,dm,fm,gm,pm,mm,vm,bm,ym,wm,Sm,Cm,km,xm,Em,Tm,_m,Am,Rm,Om,Mm,Im,Pm,Nm,Dm,Fm,Lm,Hm,Bm,Um,jm,Wm,Vm,zm,qm,Gm,$m,Km,Ym,Xm,Jm];function Qm(e){const t={};return Zm.forEach((r=>{let{name:n,callback:i}=r;t[n]=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return i(e,...r)}})),t}function ev(e){const t=e.getShortcutManager().addContext("editor"),r=Qm(e),n={group:zp};t.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(e,t)=>r.editorCloseAndSaveByEnter(e,t)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(e,t)=>r.editorCloseAndSaveByEnter(e,t)},{keys:[["Tab"],["Tab","Shift"],["PageDown"],["PageUp"]],forwardToContext:e.getShortcutManager().getContext("grid"),callback:(e,t)=>r.editorCloseAndSave(e,t)},{keys:[["ArrowDown"],["ArrowUp"],["ArrowLeft"],["ArrowRight"]],preventDefault:!1,callback:(e,t)=>r.editorCloseAndSaveByArrowKeys(e,t)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>r.editorCloseWithoutSaving()}],n)}function tv(e){const t=e.getShortcutManager().addContext("grid"),r=Qm(e),n={runOnlyIf:()=>{const{navigableHeaders:t}=e.getSettings();return Ni(e.getSelected())&&(t||!t&&e.countRenderedRows()>0&&e.countRenderedCols()>0)},group:Vp};t.addShortcuts([{keys:[["F2"]],callback:e=>r.editorFastOpen(e)},{keys:[["Enter"],["Enter","Shift"]],callback:(e,t)=>r.editorOpen(e,t)},{keys:[["Backspace"],["Delete"]],callback:()=>r.emptySelectedCells()}],{group:zp,runOnlyIf:()=>Ni(e.getSelected())}),t.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>r.selectAllCells(),runOnlyIf:()=>!e.getSelectedRangeLast().highlight.isHeader()},{keys:[["Control/Meta","A"]],callback:()=>{},runOnlyIf:()=>e.getSelectedRangeLast().highlight.isHeader(),preventDefault:!0},{keys:[["Control/Meta","Shift","Space"]],callback:()=>r.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>r.populateSelectedCellsData(),runOnlyIf:()=>!e.getSelectedRangeLast().highlight.isHeader()&&e.getSelectedRangeLast().getCellsCount()>1},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>r.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>r.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>r.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(e.selection.isSelectedByCorner()||e.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>r.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>r.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(e.selection.isSelectedByCorner()||e.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>r.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>r.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(e.selection.isSelectedByCorner()||e.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>r.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>r.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(e.selection.isSelectedByCorner()||e.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>e.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>r.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>e.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>e.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>r.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>e.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>r.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>r.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>r.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>r.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:e=>r.moveCellSelectionInlineStart(e)},{keys:[["Shift","Tab"]],preventDefault:!1,callback:e=>r.moveCellSelectionInlineEnd(e)},{keys:[["Control/Meta","Backspace"]],callback:()=>r.scrollToFocusedCell()}],n)}let rv=null;const nv=new Map;new Set;function iv(e,t){var r,n=this;let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=this;const a=new ca(o);let s,l,c,u,h,d,f=!0;var g;Ku(i)&&(g=this,Gu.set(g,!0)),this.rootElement=e,this.rootDocument=e.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const p=null!==(r=null===t||void 0===t?void 0:t.layoutDirection)&&void 0!==r?r:"inherit",m=["rtl","ltr"].includes(p)?p:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",m),this.isRtl=function(){return"rtl"===m},this.isLtr=function(){return!o.isRtl()},this.getDirectionFactor=function(){return o.isLtr()?1:-1},t.language=function(e){let t=id(e);return $f(t)||(t=Uf,od(e)),t}(t.language);const v=new _p(o,t,[Rp,Np]),b=v.getTableMeta(),y=v.getGlobalMeta(),w=Xa();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,e.insertBefore(this.container,e.firstChild),Yu(this)&&Ki(t.licenseKey,e),this.guid=`ht_${hn()}`,nv.set(this.guid,this),this.columnIndexMapper=new nd,this.rowIndexMapper=new nd,this.columnIndexMapper.addLocalHook("indexesSequenceChange",(e=>{o.runHooks("afterColumnSequenceChange",e)})),this.rowIndexMapper.addLocalHook("indexesSequenceChange",(e=>{o.runHooks("afterRowSequenceChange",e)})),l=new bh(o),this.rootElement.id&&"ht_"!==this.rootElement.id.substring(0,3)||(this.rootElement.id=this.guid);let S=new ip(b,{rowIndexMapper:o.rowIndexMapper,columnIndexMapper:o.columnIndexMapper,countCols:()=>o.countCols(),countRows:()=>o.countRows(),propToCol:e=>s.propToCol(e),isEditorOpened:()=>!!o.getActiveEditor()&&o.getActiveEditor().isOpened(),countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),countRenderableRowsInRange:function(){return n.view.countRenderableRowsInRange(...arguments)},countRenderableColumnsInRange:function(){return n.view.countRenderableColumnsInRange(...arguments)},getShortcutManager:()=>o.getShortcutManager(),createCellCoords:(e,t)=>o._createCellCoords(e,t),createCellRange:(e,t,r)=>o._createCellRange(e,t,r),visualToRenderableCoords:e=>{const{row:t,col:r}=e;return o._createCellCoords(t>=0?o.rowIndexMapper.getRenderableFromVisualIndex(t):t,r>=0?o.columnIndexMapper.getRenderableFromVisualIndex(r):r)},renderableToVisualCoords:e=>{const{row:t,col:r}=e;return o._createCellCoords(t>=0?o.rowIndexMapper.getVisualFromRenderableIndex(t):t,r>=0?o.columnIndexMapper.getVisualFromRenderableIndex(r):r)},findFirstNonHiddenRenderableRow:(e,t)=>{const r=t>e?1:-1,n=Math.min(e,t),i=Math.max(e,t),a=o.rowIndexMapper.getNearestNotHiddenIndex(e,r);return null===a||1===r&&a>i||-1===r&&a<n?null:a>=0?o.rowIndexMapper.getRenderableFromVisualIndex(a):a},findFirstNonHiddenRenderableColumn:(e,t)=>{const r=t>e?1:-1,n=Math.min(e,t),i=Math.max(e,t),a=o.columnIndexMapper.getNearestNotHiddenIndex(e,r);return null===a||1===r&&a>i||-1===r&&a<n?null:a>=0?o.columnIndexMapper.getRenderableFromVisualIndex(a):a},isDisabledCellSelection:(e,t)=>e<0||t<0?o.getSettings().disableVisualSelection:o.getCellMeta(e,t).disableVisualSelection});this.selection=S;const C=e=>{let{hiddenIndexesChanged:t}=e;t&&this.selection.commit()};function k(e){const t=id(e);$f(t)?(o.runHooks("beforeLanguageChange",t),y.language=t,o.runHooks("afterLanguageChange",t)):od(e)}function x(e,t){const r="className"===e?o.rootElement:o.table;if(f)jn(r,t);else{let n=[],i=[];y[e]&&(n=Array.isArray(y[e])?y[e]:Mi(y[e])),t&&(i=Array.isArray(t)?t:Mi(t));const o=Oi(n,i),a=Oi(i,n);o.length&&Wn(r,o),a.length&&jn(r,a)}y[e]=t}function E(){let e=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,e=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){0===this.validatorsInQueue&&!1===e&&(e=!0,this.onQueueEmpty(this.valid))}}}function T(e){const t=e.replace(",",".");return!1===isNaN(parseFloat(t))?parseFloat(t):e}function _(e,t,r){if(!e.length)return void r();const n=o.getActiveEditor(),i=new E;let a=!0;i.onQueueEmpty=()=>{n&&a&&n.cancelChanges(),r()};for(let l=e.length-1;l>=0;l--){const[r,n,,c]=e[l],u=s.propToCol(n);let h;h=Number.isInteger(u)?o.getCellMeta(r,u):{...Object.getPrototypeOf(b),...b},"numeric"===h.type&&"string"===typeof c&&Ua(c,[","])&&(e[l][3]=T(c)),o.getCellValidator(h)&&(i.addValidatorToQueue(),o.validateCell(e[l][3],h,function(t,r){return function(n){if("boolean"!==typeof n)throw new Error("Validation error: result is not boolean");!1===n&&!1===r.allowInvalid&&(a=!1,e.splice(t,1),r.valid=!0),i.removeValidatorFormQueue()}}(l,h),t))}i.checkIfQueueIsEmpty()}function A(e,t){for(let n=e.length-1;n>=0;n--){let r=!1;if(null!==e[n]){if(null!==e[n][2]&&void 0!==e[n][2]||null!==e[n][3]&&void 0!==e[n][3]){if(b.allowInsertRow)for(;e[n][0]>o.countRows()-1;){const{delta:e}=s.createRow(void 0,void 0,{source:t});if(0===e){r=!0;break}}if("array"===o.dataType&&(!b.columns||0===b.columns.length)&&b.allowInsertColumn)for(;s.propToCol(e[n][1])>o.countCols()-1;){const{delta:e}=s.createCol(void 0,void 0,{source:t});if(0===e){r=!0;break}}r||s.set(e[n][0],e[n][1],e[n][3])}}else e.splice(n,1)}const r=e.length>0;if(o.forceFullRender=!0,r){c.adjustRowsAndCols(),o.runHooks("beforeChangeRender",e,t),u.closeEditor(),o.view.render(),u.prepareEditor(),o.view.adjustElementsSize(),o.runHooks("afterChange",e,t||"edit");const r=o.getActiveEditor();r&&Ni(r.refreshValue)&&r.refreshValue()}else o.view.render()}function R(e,t,r){return Array.isArray(e)?e:[[e,t,r]]}function O(e,t){const r=o.getActiveEditor(),n=o.runHooks("beforeChange",e,t||"edit"),i=e.filter((e=>null!==e));return!1===n||0===i.length?(r&&r.cancelChanges(),[]):i}this.columnIndexMapper.addLocalHook("cacheUpdated",C),this.rowIndexMapper.addLocalHook("cacheUpdated",C),this.selection.addLocalHook("afterSetRangeEnd",((e,t)=>{const r=fo(!1),n=this.selection.getSelectedRange(),{from:i,to:a}=n.current(),s=n.size()-1;this.runHooks("afterSelection",i.row,i.col,a.row,a.col,r,s),this.runHooks("afterSelectionByProp",i.row,o.colToProp(i.col),a.row,o.colToProp(a.col),r,s),t&&(!r.isTouched()||r.isTouched()&&!r.value)&&d.scrollTo(e);const l=S.isSelectedByRowHeader(),c=S.isSelectedByColumnHeader();l&&c?jn(this.rootElement,["ht__selection--rows","ht__selection--columns"]):l?(Wn(this.rootElement,"ht__selection--columns"),jn(this.rootElement,"ht__selection--rows")):c?(Wn(this.rootElement,"ht__selection--rows"),jn(this.rootElement,"ht__selection--columns")):Wn(this.rootElement,["ht__selection--rows","ht__selection--columns"]),"shift"!==S.getSelectionSource()&&u.closeEditor(null),o.view.render(),u.prepareEditor()})),this.selection.addLocalHook("beforeSetFocus",(e=>{this.runHooks("beforeSelectionFocusSet",e.row,e.col)})),this.selection.addLocalHook("afterSetFocus",(e=>{const t=fo(!1);this.runHooks("afterSelectionFocusSet",e.row,e.col,t),(!t.isTouched()||t.isTouched()&&!t.value)&&d.scrollTo(e),u.closeEditor(),o.view.render(),u.prepareEditor()})),this.selection.addLocalHook("afterSelectionFinished",(e=>{const t=e.length-1,{from:r,to:n}=e[t];this.runHooks("afterSelectionEnd",r.row,r.col,n.row,n.col,t),this.runHooks("afterSelectionEndByProp",r.row,o.colToProp(r.col),n.row,o.colToProp(n.col),t)})),this.selection.addLocalHook("afterIsMultipleSelection",(e=>{const t=this.runHooks("afterIsMultipleSelection",e.value);e.value&&(e.value=t)})),this.selection.addLocalHook("afterDeselect",(()=>{u.closeEditor(),o.view.render(),Wn(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")})),this.selection.addLocalHook("beforeHighlightSet",(()=>this.runHooks("beforeSelectionHighlightSet"))).addLocalHook("beforeSetRangeStart",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runHooks("beforeSetRangeStart",...t)})).addLocalHook("beforeSetRangeStartOnly",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runHooks("beforeSetRangeStartOnly",...t)})).addLocalHook("beforeSetRangeEnd",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runHooks("beforeSetRangeEnd",...t)})).addLocalHook("beforeSelectColumns",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runHooks("beforeSelectColumns",...t)})).addLocalHook("afterSelectColumns",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runHooks("afterSelectColumns",...t)})).addLocalHook("beforeSelectRows",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runHooks("beforeSelectRows",...t)})).addLocalHook("afterSelectRows",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runHooks("afterSelectRows",...t)})).addLocalHook("beforeModifyTransformStart",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runHooks("modifyTransformStart",...t)})).addLocalHook("afterModifyTransformStart",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runHooks("afterModifyTransformStart",...t)})).addLocalHook("beforeModifyTransformFocus",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runHooks("modifyTransformFocus",...t)})).addLocalHook("afterModifyTransformFocus",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runHooks("afterModifyTransformFocus",...t)})).addLocalHook("beforeModifyTransformEnd",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runHooks("modifyTransformEnd",...t)})).addLocalHook("afterModifyTransformEnd",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runHooks("afterModifyTransformEnd",...t)})).addLocalHook("beforeRowWrap",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runHooks("beforeRowWrap",...t)})).addLocalHook("beforeColumnWrap",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.runHooks("beforeColumnWrap",...t)})).addLocalHook("insertRowRequire",(e=>this.alter("insert_row_above",e,1,"auto"))).addLocalHook("insertColRequire",(e=>this.alter("insert_col_start",e,1,"auto"))),c={alter(e,t){var r,n;let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3?arguments[3]:void 0,l=arguments.length>4?arguments[4]:void 0;const h=e=>{if(0===e.length)return[];const t=[...e];t.sort(((e,t)=>{let[r]=e,[n]=t;return r===n?0:r>n?1:-1}));return Ei(t,((e,t)=>{let[r,n]=t;const i=e[e.length-1],[o,a]=i,s=o+a;if(r<=s){const e=Math.max(n-(s-r),0);i[1]+=e}else e.push([r,n]);return e}),[t[0]])};switch(e){case"insert_row_below":case"insert_row_above":const l=o.countSourceRows();if(b.maxRows===l)return;const c="insert_row_below"===e?"below":"above";t=null!==(r=t)&&void 0!==r?r:"below"===c?l:0;const{delta:d,startPhysicalIndex:f}=s.createRow(t,i,{source:a,mode:c});S.shiftRows(o.toVisualRow(f),d);break;case"insert_col_start":case"insert_col_end":const g="insert_col_end"===e?"end":"start";t=null!==(n=t)&&void 0!==n?n:"end"===g?o.countSourceCols():0;const{delta:p,startPhysicalIndex:m}=s.createCol(t,i,{source:a,mode:g});if(p){if(Array.isArray(b.colHeaders)){const e=[o.toVisualColumn(m),0];e.length+=p,Array.prototype.splice.apply(b.colHeaders,e)}S.shiftColumns(o.toVisualColumn(m),p)}break;case"remove_row":const v=e=>{let t=0;Ai(e,(e=>{let[r,n]=e;const i=Fi(r)?o.countRows()-1:Math.max(r-t,0);Number.isInteger(r)&&(r=Math.max(r-t,0));if(!s.removeRow(r,n,a))return;if(S.isSelected()){const{row:e}=o.getSelectedRangeLast().highlight;e>=r&&e<=r+n-1&&u.closeEditor(!0)}const l=o.countRows();0===l?S.deselect():"ContextMenu.removeRow"===a?S.refresh():S.shiftRows(r,-n);const c=b.fixedRowsTop;c>=i+1&&(b.fixedRowsTop-=Math.min(n,c-i));const h=b.fixedRowsBottom;h&&i>=l-h&&(b.fixedRowsBottom-=Math.min(n,h)),t+=n}))};Array.isArray(t)?v(h(t)):v([[t,i]]);break;case"remove_col":const y=e=>{let t=0;Ai(e,(e=>{let[r,n]=e;const i=Fi(r)?o.countCols()-1:Math.max(r-t,0);let l=o.toPhysicalColumn(i);Number.isInteger(r)&&(r=Math.max(r-t,0));if(!s.removeCol(r,n,a))return;if(S.isSelected()){const{col:e}=o.getSelectedRangeLast().highlight;e>=r&&e<=r+n-1&&u.closeEditor(!0)}0===o.countCols()?S.deselect():"ContextMenu.removeColumn"===a?S.refresh():S.shiftColumns(r,-n);const c=b.fixedColumnsStart;c>=i+1&&(b.fixedColumnsStart-=Math.min(n,c-i)),Array.isArray(b.colHeaders)&&("undefined"===typeof l&&(l=-1),b.colHeaders.splice(l,n)),t+=n}))};Array.isArray(t)?y(h(t)):y([[t,i]]);break;default:throw new Error(`There is no such action "${e}"`)}o.view.render(),l||c.adjustRowsAndCols()},adjustRowsAndCols(){const e=b.minRows,t=b.minSpareRows,r=b.minCols,n=b.minSpareCols;if(e){const t=o.countRows();t<e&&s.createRow(t,e-t,{source:"auto"})}if(t){const e=o.countEmptyRows(!0);if(e<t){const r=t-e,n=Math.min(r,b.maxRows-o.countSourceRows());s.createRow(o.countRows(),n,{source:"auto"})}}{let e;(r||n)&&(e=o.countEmptyCols(!0));let t=o.countCols();if(r&&!b.columns&&t<r){const n=r-t;e+=n,s.createCol(t,n,{source:"auto"})}if(n&&!b.columns&&"array"===o.dataType&&e<n){t=o.countCols();const r=n-e,i=Math.min(r,b.maxCols-t);s.createCol(t,i,{source:"auto"})}}o.view&&o.view.adjustElementsSize()},populateFromArray(e,t,r,n,i){let a,s,l,c;const u=[],h={},d=[],f=e.row,g=e.col;if(s=t.length,0===s)return!1;let p=0,m=0;switch(so(r)&&(p=r.col-g+1,m=r.row-f+1),i){case"shift_down":const i=xi(t),v=i.length,y=Math.max(v,p),w=o.getData().slice(f),S=xi(w).slice(g,g+y);for(l=0;l<y;l+=1)if(l<v){for(a=0,s=i[l].length;a<m-s;a+=1)i[l].push(i[l][a%s]);l<S.length?d.push(i[l].concat(S[l])):d.push(i[l].concat(new Array(w.length).fill(null)))}else d.push(i[l%v].concat(S[l]));o.populateFromArray(f,g,xi(d));break;case"shift_right":const C=t.length,k=Math.max(C,m),x=o.getData().slice(f).map((e=>e.slice(g)));for(a=0;a<k;a+=1)if(a<C){for(l=0,c=t[a].length;l<p-c;l+=1)t[a].push(t[a][l%c]);if(a<x.length)for(let e=0;e<x[a].length;e+=1)t[a].push(x[a][e]);else t[a].push(...new Array(x[0].length).fill(null))}else t.push(t[a%s].slice(0,k).concat(x[a]));o.populateFromArray(f,g,t);break;default:h.row=e.row,h.col=e.col;let E,T=0,_=0,A=!0;const R=function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const n=t[e%t.length];return null!==r?n[r%n.length]:n},O=t.length,M=r?r.row-e.row+1:0;for(s=r?M:Math.max(O,M),a=0;a<s&&!(r&&h.row>r.row&&M>O||!b.allowInsertRow&&h.row>o.countRows()-1||h.row>=b.maxRows);a++){const t=a-T,i=R(t).length,d=r?r.col-e.col+1:0;if(c=r?d:Math.max(i,d),h.col=e.col,E=o.getCellMeta(h.row,h.col),"CopyPaste.paste"!==n&&"Autofill.fill"!==n||!E.skipRowOnPaste){for(_=0,l=0;l<c&&!(r&&h.col>r.col&&d>i||!b.allowInsertColumn&&h.col>o.countCols()-1||h.col>=b.maxCols);l++){if(E=o.getCellMeta(h.row,h.col),("CopyPaste.paste"===n||"Autofill.fill"===n)&&E.skipColumnOnPaste){_+=1,h.col+=1,c+=1;continue}if(E.readOnly&&"UndoRedo.undo"!==n){h.col+=1;continue}let e=R(t,l-_),r=o.getDataAtCell(h.row,h.col);if(null!==e&&"object"===typeof e)if(Array.isArray(e)&&null===r&&(r=[]),null===r||"object"!==typeof r)A=!1;else{const t=Qi(Array.isArray(r)?r:r[0]||r),n=Qi(Array.isArray(e)?e:e[0]||e);ao(t,n)||Array.isArray(t)&&Array.isArray(n)?e=no(e):A=!1}else null!==r&&"object"===typeof r&&(A=!1);A&&u.push([h.row,h.col,e]),A=!0,h.col+=1}h.row+=1}else T+=1,h.row+=1,s+=1}o.setDataAtCell(u,null,null,n||"populateFromArray")}}},this.init=function(){var e,t;l.setData(b.data),o.runHooks("beforeInit"),(Eo()||_o())&&jn(o.rootElement,"mobile"),this.updateSettings(b,!0),this.view=new dh(this),u=ba.getInstance(o,b,S),d=function(e){const{selection:t}=e;let r=!1,n=!1;return{resume(){n=!1},suspend(){n=!0},skipNextScrollCycle(){r=!0},scrollTo(i){var o;if(r||n)return void(r=!1);let a;t.isFocusSelectionChanged()?a=function(e){return t=>{e.scrollViewportTo(t.toObject())}}(e):t.isSelectedByCorner()?a=()=>{}:t.isSelectedByRowHeader()?a=function(e){return t=>{let{row:r}=t;e.scrollViewportTo({row:r})}}(e):t.isSelectedByColumnHeader()?a=function(e){return t=>{let{col:r}=t;e.scrollViewportTo({col:r})}}(e):1===t.getSelectedRange().size()&&t.isMultiple()?a=function(e){return t=>{e.scrollViewportTo(t.toObject())}}(e):1!==t.getSelectedRange().size()||t.isMultiple()?t.getSelectedRange().size()>1&&(a=function(e){return t=>{e.scrollViewportTo(t.toObject())}}(e)):a=function(e){return t=>{const r=e.selection.getSelectionSource(),{row:n,col:i}=t;if(n<0&&i>=0)e.scrollViewportTo({col:i});else if(i<0&&n>=0)e.scrollViewportTo({row:n});else{if("mouse"===r&&(i===e.view.getLastPartiallyVisibleColumn()||n===e.view.getLastPartiallyVisibleRow()))return;e.scrollViewportTo({row:n,col:i})}}}(e),null===(o=a)||void 0===o||o(i)}}}(o),h=new Ma(o),Yu(this)&&Gp(o),o.runHooks("init"),this.forceFullRender=!0,this.view.render(),f&&null===o.rootElement.offsetParent&&(e=o.rootElement,t=()=>{o.view._wt.wtOverlays.updateLastSpreaderSize(),o.render(),o.view.adjustElementsSize()},new IntersectionObserver(((r,n)=>{r.forEach((r=>{r.isIntersecting&&null!==e.offsetParent&&(t(),n.unobserve(e))}))}),{root:e.ownerDocument.body}).observe(e)),"object"===typeof f&&(o.runHooks("afterChange",f[0],f[1]),f=!1),o.runHooks("afterInit")},this._createCellCoords=function(e,t){return o.view._wt.createCellCoords(e,t)},this._createCellRange=function(e,t,r){return o.view._wt.createCellRange(e,t,r)},this.validateCell=function(e,t,r,n){let i=o.getCellValidator(t);function a(e){if(!(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])||!0===t.hidden)return void r(e);const n=t.visualCol,i=t.visualRow,a=o.getCell(i,n,!0);if(a&&"TH"!==a.nodeName){const e=o.rowIndexMapper.getRenderableFromVisualIndex(i),t=o.columnIndexMapper.getRenderableFromVisualIndex(n);o.view._wt.getSetting("cellRenderer",e,t,a)}r(e)}var s,l;l=i,"[object RegExp]"===Object.prototype.toString.call(l)&&(s=i,i=function(e,t){t(s.test(e))}),Yi(i)?(e=o.runHooks("beforeValidate",e,t.visualRow,t.prop,n),o._registerImmediate((()=>{i.call(t,e,(r=>{o&&(r=o.runHooks("afterValidate",r,e,t.visualRow,t.prop,n),t.valid=r,a(r),o.runHooks("postAfterValidate",r,e,t.visualRow,t.prop,n))}))}))):o._registerImmediate((()=>{t.valid=!0,a(t.valid,!1)}))},this.setDataAtCell=function(e,t,r,n){const i=R(e,t,r),a=[];let c,u,h,d=n;for(c=0,u=i.length;c<u;c++){if("object"!==typeof i[c])throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if("number"!==typeof i[c][1])throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");h=i[c][1]>=this.countCols()?i[c][1]:s.colToProp(i[c][1]),a.push([i[c][0],h,l.getAtCell(this.toPhysicalRow(i[c][0]),i[c][1]),i[c][2]])}d||"object"!==typeof e||(d=t);const f=O(a,n);o.runHooks("afterSetDataAtCell",f,d),_(f,d,(()=>{A(f,d)}))},this.setDataAtRowProp=function(e,t,r,n){const i=R(e,t,r),a=[];let s,c,u=n;for(s=0,c=i.length;s<c;s++)a.push([i[s][0],i[s][1],l.getAtCell(this.toPhysicalRow(i[s][0]),i[s][1]),i[s][2]]);u||"object"!==typeof e||(u=t);const h=O(a,n);o.runHooks("afterSetDataAtRowProp",h,u),_(h,u,(()=>{A(h,u)}))},this.listen=function(){o&&!o.isListening()&&(nv.forEach((e=>{o!==e&&e.unlisten()})),rv=o.guid,o.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(rv=null,o.runHooks("afterUnlisten"))},this.isListening=function(){return rv===o.guid},this.destroyEditor=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];u.closeEditor(e),o.view.render(),t&&S.isSelected()&&u.prepareEditor()},this.populateFromArray=function(e,t,r,n,i,a,s){if("object"!==typeof r||"object"!==typeof r[0])throw new Error("populateFromArray parameter `input` must be an array of arrays");const l="number"===typeof n?o._createCellCoords(n,i):null;return c.populateFromArray(o._createCellCoords(e,t),r,l,a,s)},this.spliceCol=function(e,t,r){for(var n=arguments.length,i=new Array(n>3?n-3:0),o=3;o<n;o++)i[o-3]=arguments[o];return s.spliceCol(e,t,r,...i)},this.spliceRow=function(e,t,r){for(var n=arguments.length,i=new Array(n>3?n-3:0),o=3;o<n;o++)i[o-3]=arguments[o];return s.spliceRow(e,t,r,...i)},this.getSelected=function(){if(S.isSelected())return _i(S.getSelectedRange(),(e=>{let{from:t,to:r}=e;return[t.row,t.col,r.row,r.col]}))},this.getSelectedLast=function(){const e=this.getSelected();let t;return e&&e.length>0&&(t=e[e.length-1]),t},this.getSelectedRange=function(){if(S.isSelected())return Array.from(S.getSelectedRange())},this.getSelectedRangeLast=function(){const e=this.getSelectedRange();let t;return e&&e.length>0&&(t=e[e.length-1]),t},this.emptySelectedCells=function(e){if(!S.isSelected()||0===this.countRows()||0===this.countCols())return;const t=[];Ai(S.getSelectedRange(),(e=>{if(e.isSingleHeader())return;const r=e.getTopStartCorner(),n=e.getBottomEndCorner();ja(r.row,n.row,(e=>{ja(r.col,n.col,(r=>{this.getCellMeta(e,r).readOnly||t.push([e,r,null])}))}))})),t.length>0&&this.setDataAtCell(t,e)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const e=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(e,0),this.isRenderSuspended()||e!==this.renderSuspendedCounter||(this.renderCall?this.render():o.view.render())},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||o.view.render())},this.batchRender=function(e){this.suspendRender();const t=e();return this.resumeRender(),t},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(t,0),(!this.isExecutionSuspended()&&t===this.executionSuspendedCounter||e)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.suspendExecution();const r=e();return this.resumeExecution(t),r},this.batch=function(e){this.suspendRender(),this.suspendExecution();const t=e();return this.resumeExecution(),this.resumeRender(),t},this.refreshDimensions=function(){if(!o.view)return;const{width:e,height:t}=o.view.getLastSize(),{width:r,height:n}=o.rootElement.getBoundingClientRect(),i=r!==e||n!==t;!1===o.runHooks("beforeRefreshDimensions",{width:e,height:t},{width:r,height:n},i)||((i||o.view._wt.wtOverlays.scrollableElement===o.rootWindow)&&(o.view.setLastSize(r,n),o.render()),o.runHooks("afterRefreshDimensions",{width:e,height:t},{width:r,height:n},i))},this.updateData=function(e,t){Wp(e,(e=>{s=e}),(e=>{s=e,o.columnIndexMapper.fitToLength(this.getInitialColumnCount()),o.rowIndexMapper.fitToLength(this.countSourceRows()),c.adjustRowsAndCols(),S.refresh()}),{hotInstance:o,dataMap:s,dataSource:l,internalSource:"updateData",source:t,metaManager:v,firstRun:f})},this.loadData=function(e,t){Wp(e,(e=>{s=e}),(()=>{v.clearCellsCache(),o.initIndexMappers(),c.adjustRowsAndCols(),S.refresh(),f&&(f=[null,"loadData"])}),{hotInstance:o,dataMap:s,dataSource:l,internalSource:"loadData",source:t,metaManager:v,firstRun:f})},this.getInitialColumnCount=function(){const e=b.columns;let t=0;if(Array.isArray(e))t=e.length;else if(Yi(e))if("array"===o.dataType){const r=this.countSourceCols();for(let n=0;n<r;n+=1)e(n)&&(t+=1)}else"object"!==o.dataType&&"function"!==o.dataType||(t=s.colToPropCache.length);else if(Ni(b.dataSchema)){const e=s.getSchema();t=Array.isArray(e)?e.length:ho(e)}else t=this.countSourceCols();return t},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(e,t,r,n){return Di(e)?s.getAll():s.getRange(o._createCellCoords(e,t),o._createCellCoords(r,n),s.DESTINATION_RENDERER)},this.getCopyableText=function(e,t,r,n){return s.getCopyableText(o._createCellCoords(e,t),o._createCellCoords(r,n))},this.getCopyableData=function(e,t){return s.getCopyable(e,s.colToProp(t))},this.getSchema=function(){return s.getSchema()},this.updateSettings=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const r=(f?o.loadData:o.updateData).bind(this);let n,i,a=!1;if(Ni(e.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(Ni(e.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(Ni(e.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(n in e)"data"===n||("language"===n?k(e.language):"className"===n?x("className",e.className):"tableClassName"===n&&o.table?(x("tableClassName",e.tableClassName),o.view._wt.wtOverlays.syncOverlayTableClassNames()):Ko.getSingleton().isRegistered(n)||Ko.getSingleton().isDeprecated(n)?(Yi(e[n])||Array.isArray(e[n]))&&(e[n].initialHook=!0,o.addHook(n,e[n])):!t&&go(e,n)&&(y[n]=e[n]));void 0===e.data&&void 0===b.data?r(null,"updateSettings"):void 0!==e.data?r(e.data,"updateSettings"):void 0!==e.columns&&(s.createMap(),o.initIndexMappers());const l=o.countCols(),u=b.columns;if(u&&Yi(u)&&(a=!0),void 0===e.cell&&void 0===e.cells&&void 0===e.columns||v.clearCache(),l>0)for(n=0,i=0;n<l;n++){if(u){const e=a?u(n):u[i];e&&v.updateColumnMeta(i,e)}i+=1}Ni(e.cell)&&co(e.cell,(e=>{o.setCellMetaObject(e.row,e.col,e)})),o.runHooks("afterCellMetaReset");let h=o.rootElement.style.height;""!==h&&(h=parseInt(o.rootElement.style.height,10));let d=e.height;if(Yi(d)&&(d=d()),t){o.rootElement.getAttribute("style")&&o.rootElement.setAttribute("data-initialstyle",o.rootElement.getAttribute("style"))}if(null===d){const e=o.rootElement.getAttribute("data-initialstyle");e&&(e.indexOf("height")>-1||e.indexOf("overflow")>-1)?o.rootElement.setAttribute("style",e):(o.rootElement.style.height="",o.rootElement.style.overflow="")}else void 0!==d&&(o.rootElement.style.height=isNaN(d)?`${d}`:`${d}px`,o.rootElement.style.overflow="hidden");if("undefined"!==typeof e.width){let t=e.width;Yi(t)&&(t=t()),o.rootElement.style.width=isNaN(t)?`${t}`:`${t}px`}t||(o.view&&(o.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),o.view._wt.exportSettingsAsClassNames()),o.runHooks("afterUpdateSettings",e)),c.adjustRowsAndCols(),o.view&&!f&&(o.forceFullRender=!0,o.view.render(),o.view._wt.wtOverlays.adjustElementsSize()),t||!o.view||""!==h&&""!==d&&void 0!==d||h===d||o.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const e=o.getSelectedLast();if(b.getValue){if(Yi(b.getValue))return b.getValue.call(o);if(e)return o.getData()[e[0][0]][b.getValue]}else if(e)return o.getDataAtCell(e[0],e[1])},this.getSettings=function(){return b},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(e,t,r,n,i){c.alter(e,t,r,n,i)},this.getCell=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=t,i=e;if(t>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(t)))return null;n=this.columnIndexMapper.getRenderableFromVisualIndex(t)}if(e>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(e)))return null;i=this.rowIndexMapper.getRenderableFromVisualIndex(e)}return null===i||null===n||void 0===i||void 0===n?null:o.view.getCellAtCoords(o._createCellCoords(i,n),r)},this.getCoords=function(e){const t=this.view._wt.wtTable.getCoords(e);if(null===t)return null;const{row:r,col:n}=t;let i=r,a=n;return r>=0&&(i=this.rowIndexMapper.getVisualFromRenderableIndex(r)),n>=0&&(a=this.columnIndexMapper.getVisualFromRenderableIndex(n)),o._createCellCoords(i,a)},this.colToProp=function(e){return s.colToProp(e)},this.propToCol=function(e){return s.propToCol(e)},this.toVisualRow=e=>this.rowIndexMapper.getVisualFromPhysicalIndex(e),this.toVisualColumn=e=>this.columnIndexMapper.getVisualFromPhysicalIndex(e),this.toPhysicalRow=e=>this.rowIndexMapper.getPhysicalFromVisualIndex(e),this.toPhysicalColumn=e=>this.columnIndexMapper.getPhysicalFromVisualIndex(e),this.getDataAtCell=function(e,t){return s.get(e,s.colToProp(t))},this.getDataAtRowProp=function(e,t){return s.get(e,t)},this.getDataAtCol=function(e){const t=[],r=s.getRange(o._createCellCoords(0,e),o._createCellCoords(b.data.length-1,e),s.DESTINATION_RENDERER);for(let n=0;n<r.length;n+=1)for(let e=0;e<r[n].length;e+=1)t.push(r[n][e]);return t},this.getDataAtProp=function(e){const t=[],r=s.getRange(o._createCellCoords(0,s.propToCol(e)),o._createCellCoords(b.data.length-1,s.propToCol(e)),s.DESTINATION_RENDERER);for(let n=0;n<r.length;n+=1)for(let e=0;e<r[n].length;e+=1)t.push(r[n][e]);return t},this.getSourceData=function(e,t,r,n){let i;return i=void 0===e?l.getData():l.getByRange(o._createCellCoords(e,t),o._createCellCoords(r,n)),i},this.getSourceDataArray=function(e,t,r,n){let i;return i=void 0===e?l.getData(!0):l.getByRange(o._createCellCoords(e,t),o._createCellCoords(r,n),!0),i},this.getSourceDataAtCol=function(e){return l.getAtColumn(e)},this.setSourceDataAtCell=function(e,t,r,n){const i=R(e,t,r),a=this.hasHook("afterSetSourceDataAtCell"),s=[];a&&Ai(i,(e=>{let[t,r,n]=e;s.push([t,r,l.getAtCell(t,r),n])})),Ai(i,(e=>{let[t,r,n]=e;l.setAtCell(t,r,n)})),a&&this.runHooks("afterSetSourceDataAtCell",s,n),this.render();const c=o.getActiveEditor();c&&Ni(c.refreshValue)&&c.refreshValue()},this.getSourceDataAtRow=function(e){return l.getAtRow(e)},this.getSourceDataAtCell=function(e,t){return l.getAtCell(e,t)},this.getDataAtRow=function(e){return s.getRange(o._createCellCoords(e,0),o._createCellCoords(e,this.countCols()-1),s.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(e,t,r,n){const i=void 0===e?[0,0,this.countRows(),this.countCols()]:[e,t,r,n],[o,a]=i;let[,,s,l]=i,c=null,u=null;void 0===s&&(s=o),void 0===l&&(l=a);let h="mixed";return ja(Math.max(Math.min(o,s),0),Math.max(o,s),(e=>{let t=!0;return ja(Math.max(Math.min(a,l),0),Math.max(a,l),(r=>{const n=this.getCellMeta(e,r);return u=n.type,c?t=c===u:c=u,t})),h=t?u:"mixed",t})),h},this.removeCellMeta=function(e,t,r){const[n,i]=[this.toPhysicalRow(e),this.toPhysicalColumn(t)];let a=v.getCellMetaKeyValue(n,i,r);!1!==o.runHooks("beforeRemoveCellMeta",e,t,r,a)&&(v.removeCellMeta(n,i,r),o.runHooks("afterRemoveCellMeta",e,t,r,a)),a=null},this.spliceCellsMeta=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(var r=arguments.length,n=new Array(r>2?r-2:0),i=2;i<r;i++)n[i-2]=arguments[i];if(n.length>0&&!Array.isArray(n[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");t>0&&v.removeRow(this.toPhysicalRow(e),t),n.length>0&&Ai(n.reverse(),(t=>{v.createRow(this.toPhysicalRow(e)),Ai(t,((t,r)=>this.setCellMetaObject(e,r,t)))})),o.render()},this.setCellMetaObject=function(e,t,r){"object"===typeof r&&co(r,((r,n)=>{this.setCellMeta(e,t,n,r)}))},this.setCellMeta=function(e,t,r,n){if(!1===o.runHooks("beforeSetCellMeta",e,t,r,n))return;let i=e,a=t;e<this.countRows()&&(i=this.toPhysicalRow(e)),t<this.countCols()&&(a=this.toPhysicalColumn(t)),v.setCellMeta(i,a,r,n),o.runHooks("afterSetCellMeta",e,t,r,n)},this.getCellsMeta=function(){return v.getCellsMeta()},this.getCellMeta=function(e,t){let r=this.toPhysicalRow(e),n=this.toPhysicalColumn(t);return null===r&&(r=e),null===n&&(n=t),v.getCellMeta(r,n,{visualRow:e,visualColumn:t})},this.getColumnMeta=function(e){return v.getColumnMeta(this.toPhysicalColumn(e))},this.getCellMetaAtRow=function(e){return v.getCellsMetaAtRow(e)},this.isColumnModificationAllowed=function(){return!("object"===o.dataType||b.columns)},this.getCellRenderer=function(e,t){const r="number"===typeof e?o.getCellMeta(e,t).renderer:e.renderer;return"string"===typeof r?us(r):Di(r)?us("text"):r},this.getCellEditor=function(e,t){const r="number"===typeof e?o.getCellMeta(e,t).editor:e.editor;return"string"===typeof r?oa(r):Di(r)?oa("text"):r},this.getCellValidator=function(e,t){const r="number"===typeof e?o.getCellMeta(e,t).validator:e.validator;return"string"===typeof r?function(e){if("function"===typeof e)return e;if(!gs(e))throw Error(`No registered validator found under "${e}" name`);return fs(e)}(r):r},this.validateCells=function(e){this._validateCells(e)},this.validateRows=function(e,t){if(!Array.isArray(e))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(t,e)},this.validateColumns=function(e,t){if(!Array.isArray(e))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(t,void 0,e)},this._validateCells=function(e,t,r){const n=new E;e&&(n.onQueueEmpty=e);let i=o.countRows()-1;for(;i>=0;){if(void 0!==t&&-1===t.indexOf(i)){i-=1;continue}let e=o.countCols()-1;for(;e>=0;)void 0===r||-1!==r.indexOf(e)?(n.addValidatorToQueue(),o.validateCell(o.getDataAtCell(i,e),o.getCellMeta(i,e),(e=>{if("boolean"!==typeof e)throw new Error("Validation error: result is not boolean");!1===e&&(n.valid=!1),n.removeValidatorFormQueue()}),"validateCells"),e-=1):e-=1;i-=1}n.checkIfQueueIsEmpty()},this.getRowHeader=function(e){let t=b.rowHeaders,r=e;return void 0!==r&&(r=o.runHooks("modifyRowHeader",r)),void 0===r?(t=[],ja(o.countRows()-1,(e=>{t.push(o.getRowHeader(e))}))):Array.isArray(t)&&void 0!==t[r]?t=t[r]:Yi(t)?t=t(r):t&&"string"!==typeof t&&"number"!==typeof t&&(t=r+1),t},this.hasRowHeaders=function(){return!!b.rowHeaders},this.hasColHeaders=function(){if(void 0!==b.colHeaders&&null!==b.colHeaders)return!!b.colHeaders;for(let e=0,t=o.countCols();e<t;e++)if(o.getColHeader(e))return!0;return!1},this.getColHeader=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;const r=o.runHooks("modifyColHeader",e);if(void 0===r){const e=[],t=o.countCols();for(let r=0;r<t;r++)e.push(o.getColHeader(r));return e}let n=b.colHeaders;const i=o.toPhysicalColumn(r),a=function(e){const t=[],r=o.countCols();let n=0;for(;n<r;n++)Yi(b.columns)&&b.columns(n)&&t.push(n);return t[e]}(i);return!1===b.colHeaders?n=null:b.columns&&Yi(b.columns)&&b.columns(a)&&b.columns(a).title?n=b.columns(a).title:b.columns&&b.columns[i]&&b.columns[i].title?n=b.columns[i].title:Array.isArray(b.colHeaders)&&void 0!==b.colHeaders[i]?n=b.colHeaders[i]:Yi(b.colHeaders)?n=b.colHeaders(i):b.colHeaders&&"string"!==typeof b.colHeaders&&"number"!==typeof b.colHeaders&&(n=gh(r)),n=o.runHooks("modifyColumnHeaderValue",n,e,t),n},this._getColWidthFromSettings=function(e){let t;if(e>=0){t=o.getCellMeta(0,e).width}if(void 0!==t&&t!==b.width||(t=b.colWidths),void 0!==t&&null!==t){switch(typeof t){case"object":t=t[e];break;case"function":t=t(e)}"string"===typeof t&&(t=parseInt(t,10))}return t},this.getColWidth=function(e){let t=o._getColWidthFromSettings(e);return t=o.runHooks("modifyColWidth",t,e),void 0===t&&(t=ul),t},this._getRowHeightFromSettings=function(e){let t=b.rowHeights;if(void 0!==t&&null!==t){switch(typeof t){case"object":t=t[e];break;case"function":t=t(e)}"string"===typeof t&&(t=parseInt(t,10))}return t},this.getRowHeight=function(e){let t=o._getRowHeightFromSettings(e);return t=o.runHooks("modifyRowHeight",t,e),t},this.countSourceRows=function(){return l.countRows()},this.countSourceCols=function(){return l.countFirstRowKeys()},this.countRows=function(){return s.getLength()},this.countCols=function(){const e=b.maxCols,t=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(e,t)},this.countRenderedRows=function(){return o.view._wt.drawn?o.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return o.view._wt.drawn?o.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return o.view._wt.drawn?o.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return o.view._wt.drawn?o.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=0;return Wa(o.countRows()-1,(r=>{if(o.isEmptyRow(r))t+=1;else if(!0===e)return!1})),t},this.countEmptyCols=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=0;return Wa(o.countCols()-1,(r=>{if(o.isEmptyCol(r))t+=1;else if(!0===e)return!1})),t},this.isEmptyRow=function(e){return b.isEmptyRow.call(o,e)},this.isEmptyCol=function(e){return b.isEmptyCol.call(o,e)},this.selectCell=function(e,t,r,n){let i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],o=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];return!Di(e)&&!Di(t)&&this.selectCells([[e,t,r,n]],i,o)},this.selectCells=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[[]],t=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];!1===(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&d.suspend();const r=S.selectCells(e);return r&&t&&o.listen(),d.resume(),r},this.selectColumns=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,r=arguments.length>2?arguments[2]:void 0;return S.selectColumns(e,t,r)},this.selectRows=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,r=arguments.length>2?arguments[2]:void 0;return S.selectRows(e,t,r)},this.deselectCell=function(){S.deselect()},this.selectAll=function(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,r=arguments.length>2?arguments[2]:void 0;d.skipNextScrollCycle(),S.selectAll(e,t,r)};const M=(e,t)=>e.getNearestNotHiddenIndex(t,1,!0);this.scrollViewportTo=function(e){var t,r;"number"===typeof e&&(e={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:null===(r=arguments[4])||void 0===r||r});const{row:n,col:i,verticalSnap:a,horizontalSnap:s,considerHiddenIndexes:l}=null!==(t=e)&&void 0!==t?t:{};let c,u,h,d;void 0!==a&&(c="top"===a,u=!c),void 0!==s&&(h="start"===s,d=!h);let f=n,g=i;if(void 0===l||l){const e=Number.isInteger(n)&&n>=0,t=Number.isInteger(i)&&i>=0,r=e?M(this.rowIndexMapper,n):void 0,a=t?M(this.columnIndexMapper,i):void 0;if(null===r||null===a)return!1;f=e?o.rowIndexMapper.getRenderableFromVisualIndex(r):n,g=t?o.columnIndexMapper.getRenderableFromVisualIndex(a):i}const p=Number.isInteger(f),m=Number.isInteger(g);return p&&f>=0&&m&&g>=0?o.view.scrollViewport(o._createCellCoords(f,g),c,d,u,h):p&&f>=0&&(m&&g<0||!m)?o.view.scrollViewportVertically(f,c,u):!!(m&&g>=0&&(p&&f<0||!p))&&o.view.scrollViewportHorizontally(g,d,h)},this.scrollToFocusedCell=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:()=>{};if(!this.selection.isSelected())return;this.addHookOnce("afterScroll",e);const{highlight:t}=this.getSelectedRangeLast();this.scrollViewportTo(t.toObject())?this.view.render():(this.removeHook("afterScroll",e),this._registerImmediate((()=>e())))},this.destroy=function(){if(o._clearTimeouts(),o._clearImmediates(),o.view&&o.view.destroy(),l&&l.destroy(),l=null,this.getShortcutManager().destroy(),v.clearCache(),nv.delete(this.guid),Yu(o)){const e=this.rootDocument.querySelector(".hot-display-license-info");e&&e.parentNode.removeChild(e)}Gn(o.rootElement),a.destroy(),u&&u.destroy(),o.batchExecution((()=>{o.rowIndexMapper.unregisterAll(),o.columnIndexMapper.unregisterAll(),w.getItems().forEach((e=>{let[,t]=e;t.destroy()})),w.clear(),o.runHooks("afterDestroy")}),!0),Ko.getSingleton().destroy(o),co(o,((e,t,r)=>{var n;Yi(e)?r[t]=(n=t,()=>{throw new Error(`The "${n}" method cannot be called because this Handsontable instance has been destroyed`)}):"guid"!==t&&(r[t]=null)})),o.isDestroyed=!0,s&&s.destroy(),s=null,c=null,S=null,u=null,o=null},this.getActiveEditor=function(){return u.getActiveEditor()},this.getPlugin=function(e){const t=un(e);return"UndoRedo"===t?this.undoRedo:w.getItem(t)},this.getPluginName=function(e){return e===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:w.getId(e)},this.getInstance=function(){return o},this.addHook=function(e,t,r){Ko.getSingleton().add(e,t,o,r)},this.hasHook=function(e){return Ko.getSingleton().has(e,o)||Ko.getSingleton().has(e)},this.addHookOnce=function(e,t,r){Ko.getSingleton().once(e,t,o,r)},this.removeHook=function(e,t){Ko.getSingleton().remove(e,t,o)},this.runHooks=function(e,t,r,n,i,a,s){return Ko.getSingleton().run(o,e,t,r,n,i,a,s)},this.getTranslatedPhrase=function(e,t){return Kf(b.language,e,t)},this.toHTML=()=>Ha(this),this.toTableElement=()=>{const e=this.rootDocument.createElement("div");return e.insertAdjacentHTML("afterbegin",Ha(this)),e.firstElementChild},this.timeouts=[],this._registerTimeout=function(e){let t=e;"function"===typeof t&&(t=setTimeout(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0)),this.timeouts.push(t)},this._clearTimeouts=function(){Ai(this.timeouts,(e=>{clearTimeout(e)}))},this.immediates=[],this._registerImmediate=function(e){this.immediates.push(setImmediate(e))},this._clearImmediates=function(){Ai(this.immediates,(e=>{clearImmediate(e)}))},this._getEditorManager=function(){return u},this.isRtl=function(){return"rtl"===o.rootWindow.getComputedStyle(o.rootElement).direction},this.isLtr=function(){return!o.isRtl()},this.getDirectionFactor=function(){return o.isLtr()?1:-1};const I=om({handleEvent:()=>o.isListening(),beforeKeyDown:e=>this.runHooks("beforeKeyDown",e),afterKeyDown:e=>{this.isDestroyed||o.runHooks("afterDocumentKeyDown",e)},ownerWindow:this.rootWindow});var P;this.addHook("beforeOnCellMouseDown",(e=>{!1===e.ctrlKey&&!1===e.metaKey&&I.releasePressedKeys()})),this.getShortcutManager=function(){return I},this.getFocusManager=function(){return h},rs().forEach((e=>{const t=ns(e);w.addItem(e,new t(this))})),P=o,[tv,ev].forEach((e=>e(P))),I.setActiveContextName("grid"),Ko.getSingleton().run(o,"construct")}function ov(e,t,r){e.addEventListener(t,r,!1)}function av(e,t,r){e.removeEventListener(t,r,!1)}function sv(e){return e.ownerDocument.defaultView.getComputedStyle(e)}function lv(e){const t={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},r=e.body,n=e.createTextNode(""),i=e.createElement("span");let o;function a(){n.textContent=o.value,i.style.position="absolute",i.style.fontSize=sv(o).fontSize,i.style.fontFamily=sv(o).fontFamily,i.style.whiteSpace="pre",r.appendChild(i);const e=i.clientWidth+2;r.removeChild(i);const a=o.style;a.height=`${t.minHeight}px`,t.minWidth>e?a.width=`${t.minWidth}px`:e>t.maxWidth?a.width=`${t.maxWidth}px`:a.width=`${e}px`;const s=o.scrollHeight?o.scrollHeight-1:0;t.minHeight>s?a.height=`${t.minHeight}px`:t.maxHeight<s?(a.height=`${t.maxHeight}px`,a.overflowY="visible"):a.height=`${s}px`}function s(){e.defaultView.setTimeout(a,0)}return{init:function(e,r){let l=arguments.length>2&&void 0!==arguments[2]&&arguments[2];o=e,function(e){if(e&&e.minHeight)if("inherit"===e.minHeight)t.minHeight=o.clientHeight;else{const r=parseInt(e.minHeight,10);isNaN(r)||(t.minHeight=r)}if(e&&e.maxHeight)if("inherit"===e.maxHeight)t.maxHeight=o.clientHeight;else{const r=parseInt(e.maxHeight,10);isNaN(r)||(t.maxHeight=r)}if(e&&e.minWidth)if("inherit"===e.minWidth)t.minWidth=o.clientWidth;else{const r=parseInt(e.minWidth,10);isNaN(r)||(t.minWidth=r)}if(e&&e.maxWidth)if("inherit"===e.maxWidth)t.maxWidth=o.clientWidth;else{const r=parseInt(e.maxWidth,10);isNaN(r)||(t.maxWidth=r)}i.firstChild||(i.className="autoResize",i.style.display="inline-block",i.appendChild(n))}(r),"TEXTAREA"===o.nodeName&&(o.style.resize="none",o.style.height=`${t.minHeight}px`,o.style.minWidth=`${t.minWidth}px`,o.style.maxWidth=`${t.maxWidth}px`,o.style.overflowY="hidden"),l&&(ov(o,"input",a),ov(o,"keydown",s)),a()},resize:a,unObserve(){av(o,"input",a),av(o,"keydown",s)}}}function cv(e,t){const r=ui(t),n=t.value.split("\n");let i=r,o=0;for(let a=0;a<n.length;a++){const t=n[a];0!==a&&(o+=n[a-1].length+1);const s=o+t.length;if("home"===e?i=o:"end"===e&&(i=s),r<=s)break}di(t,i)}function uv(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const hv="ht_editor_hidden",dv="textEditor";class fv extends hm{static get EDITOR_TYPE(){return"text"}constructor(e){super(e),uv(this,"eventManager",new ca(this)),uv(this,"autoResize",lv(this.hot.rootDocument)),uv(this,"TEXTAREA",void 0),uv(this,"textareaStyle",void 0),uv(this,"TEXTAREA_PARENT",void 0),uv(this,"textareaParentStyle",void 0),uv(this,"layerClass",void 0),this.eventManager=new ca(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",(()=>this.destroy()))}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this.autoResize.unObserve(),function(e,t){const r=e.closest(".handsontable");return!!r&&(r.parentNode===t||r===t)}(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(e,t,r,n,i,o){const a=this.state;if(super.prepare(e,t,r,n,i,o),!o.readOnly){this.refreshDimensions(!0);const{allowInvalid:e}=o;e&&!this.isOpened()&&(this.TEXTAREA.value=""),a===um.FINISHED||this.isOpened()||this.hideEditableElement()}}beginEditing(e,t){this.state===um.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,t))}focus(){this.TEXTAREA.select(),di(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),Vn(this.TEXTAREA,[["data-hot-input",""],mn(-1)]),this.hot.getSettings().ariaTags&&Vn(this.TEXTAREA,[wn()]),jn(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),jn(this.TEXTAREA_PARENT,"handsontableInputHolder"),Un(this.TEXTAREA_PARENT,this.layerClass)&&Wn(this.TEXTAREA_PARENT,this.layerClass),jn(this.TEXTAREA_PARENT,hv),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){wo.edge.value&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",Wn(this.TEXTAREA_PARENT,this.layerClass),jn(this.TEXTAREA_PARENT,hv)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="";const e=this.TEXTAREA_PARENT.childNodes;let t=!1;ja(e.length-1,(r=>{if(Un(e[r],"handsontableEditor"))return t=!0,!1})),Un(this.TEXTAREA_PARENT,hv)&&Wn(this.TEXTAREA_PARENT,hv),t?(this.layerClass="ht_editor_visible",jn(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),jn(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const e=this.hot.toPhysicalRow(this.row),t=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=t,this.setValue(t),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.state!==um.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD)return void(e||this.close());const{top:t,start:r,width:n,maxWidth:i,height:o,maxHeight:a}=this.getEditedCellRect();this.textareaParentStyle.top=`${t}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${r}px`,this.showEditableElement();const s=oi(this.TD,this.hot.rootWindow);this.TEXTAREA.style.fontSize=s.fontSize,this.TEXTAREA.style.fontFamily=s.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor;const l=oi(this.TEXTAREA),c=parseInt(l.paddingLeft,10)+parseInt(l.paddingRight,10),u=parseInt(l.paddingTop,10)+parseInt(l.paddingBottom,10),h=n-c,d=o-u,f=i-c,g=a-u;this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(h,f),minHeight:Math.min(d,g),maxWidth:f,maxHeight:g},!0)}bindEvents(){To()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",(()=>this.finishEditing(!1))),this.addHook("afterScrollHorizontally",(()=>this.refreshDimensions())),this.addHook("afterScrollVertically",(()=>this.refreshDimensions())),this.addHook("afterColumnResize",(()=>{this.refreshDimensions(),this.state===um.EDITING&&this.focus()})),this.addHook("afterRowResize",(()=>{this.refreshDimensions(),this.state===um.EDITING&&this.focus()}))}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const e=this.hot.getShortcutManager().getContext("editor"),t={runOnlyIf:()=>Ni(this.hot.getSelected()),group:dv},r=()=>{this.hot.rootDocument.execCommand("insertText",!1,"\n")};e.addShortcuts([{keys:[["Control","Enter"]],callback:()=>(r(),!1),runOnlyIf:e=>!this.hot.selection.isMultiple()&&!e.altKey},{keys:[["Meta","Enter"]],callback:()=>(r(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(r(),!1)},{keys:[["Home"]],callback:(e,t)=>{let[r]=t;cv(r,this.TEXTAREA)}},{keys:[["End"]],callback:(e,t)=>{let[r]=t;cv(r,this.TEXTAREA)}}],t)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(dv)}}function gv(e,t,r,n,i,o,a){const s=a.ariaTags,l=[],c=[],u=[],h=[];a.className&&jn(t,a.className),a.readOnly?(l.push(a.readOnlyCellClassName),s&&h.push(_n())):s&&u.push(_n()[0]),!1===a.valid&&a.invalidCellClassName?(l.push(a.invalidCellClassName),s&&h.push(An())):(c.push(a.invalidCellClassName),s&&u.push(An()[0])),!1===a.wordWrap&&a.noWordWrapClassName&&l.push(a.noWordWrapClassName),!o&&a.placeholder&&l.push(a.placeholderCellClassName),Wn(t,c),jn(t,l),zn(t,u),Vn(t,h)}gv.RENDERER_TYPE="base";function pv(e,t,r,n,i,o,a){gv.apply(this,[e,t,r,n,i,o,a]);let s=o;if(!s&&a.placeholder&&(s=a.placeholder),s=Pi(s),a.trimWhitespace&&(s=s.trim()),a.rendererTemplate){Gn(t);const n=e.rootDocument.createElement("TEMPLATE");n.setAttribute("bind","{{}}"),n.innerHTML=a.rendererTemplate,HTMLTemplateElement.decorate(n),n.model=e.getSourceDataAtRow(r),t.appendChild(n)}else Yn(t,s)}pv.RENDERER_TYPE="text";const mv={CELL_TYPE:"text",editor:fv,renderer:pv};function vv(e,t){const r=new iv(e,t||{},$u);return r.init(),r}up(mv),vv.editors={BaseEditor:hm},vv.Core=function(e){return new iv(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},$u)},vv.DefaultSettings=pp(),vv.hooks=Ko.getSingleton(),vv.CellCoords=rc,vv.CellRange=cc,vv.packageName="handsontable",vv.buildDate="30/07/2024 11:21:58",vv.version="14.5.0",vv.languages={dictionaryKeys:Bf,getLanguageDictionary:Gf,getLanguagesDictionaries:function(){return zf()},registerLanguageDictionary:qf,getTranslatedPhrase:Kf};const bv=vv;function yv(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function wv(e,t,r){return t=Ev(t),function(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,_v()?Reflect.construct(t,r||[],Ev(e).constructor):t.apply(e,r))}function Sv(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Cv(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Mv(n.key),n)}}function kv(e,t,r){return t&&Cv(e.prototype,t),r&&Cv(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function xv(e,t,r){return(t=Mv(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ev(e){return Ev=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ev(e)}function Tv(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Rv(e,t)}function _v(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(_v=function(){return!!e})()}function Av(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Rv(e,t){return Rv=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Rv(e,t)}function Ov(e){return function(e){if(Array.isArray(e))return yv(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return yv(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?yv(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Mv(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e,"string");return"symbol"==typeof t?t:t+""}var Iv=null,Pv="global";function Nv(e,r){var n=t.Children.toArray(e),i=t.Children.count(e),o=null;return 0!==i&&(o=1===i&&n[0].props[r]?n[0]:n.find((function(e){return void 0!==e.props[r]}))),o||null}function Dv(e){return e?e.type.WrappedComponent?e.type.WrappedComponent:e.type:null}function Fv(e,n){if("undefined"===typeof e||null===n)return null;var i=Bv(n.props,!1);return i.className="".concat("hot-wrapper-editor-container"," ").concat(i.className),r.createPortal(t.createElement("div",Object.assign({},i),n),e.body)}function Lv(e,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Pv,i=Nv(e,"hot-editor"),o=Dv(i);return i?t.cloneElement(i,{emitEditorInstance:function(e,t){r.get(o)||r.set(o,new Map),r.get(o).set(null!==t&&void 0!==t?t:Pv,e)},editorColumnScope:n,isEditor:!0}):null}function Hv(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:document,o=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0;i||(i=document),Iv||(Iv=i.createDocumentFragment());var s=null!==a&&void 0!==a?a:i.createElement("DIV");Iv.appendChild(s);var l=t.cloneElement(e,function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Av(Object(r),!0).forEach((function(t){xv(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Av(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({key:"".concat(n.row,"-").concat(n.col)},n));return{portal:r.createPortal(l,s,o),portalContainer:s}}function Bv(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return{id:e.id||(t?"hot-"+Math.random().toString(36).substring(5):void 0),className:e.className||"",style:e.style||{}}}var Uv=function(){return kv((function e(){Sv(this,e)}),null,[{key:"getSettings",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.prevProps,n=void 0===r?{}:r,i=t.isInit,o=void 0!==i&&i,a=t.initOnlySettingKeys,s=void 0===a?[]:a,l=function(t){return!(o||!s.includes(t))&&n[t]===e[t]},c={};if(e.settings){var u=e.settings;for(var h in u)u.hasOwnProperty(h)&&!l(h)&&(c[h]=u[h])}for(var d in e)"settings"!==d&&"children"!==d&&!l(d)&&e.hasOwnProperty(d)&&(c[d]=e[d]);return c}}])}(),jv=function(e){function r(){return Sv(this,r),wv(this,r,arguments)}return Tv(r,e),kv(r,[{key:"getSettingsProps",value:function(){var e=this;return this.internalProps=["_componentRendererColumns","_emitColumnSettings","_columnIndex","_getChildElementByType","_getRendererWrapper","_getEditorClass","_getEditorCache","_getOwnerDocument","hot-renderer","hot-editor","children"],Object.keys(this.props).filter((function(t){return!e.internalProps.includes(t)})).reduce((function(t,r){return t[r]=e.props[r],t}),{})}},{key:"getLocalEditorElement",value:function(){return Lv(this.props.children,this.props._getEditorCache(),this.props._columnIndex)}},{key:"createColumnSettings",value:function(){var e=this.props._getChildElementByType(this.props.children,"hot-renderer"),t=this.getLocalEditorElement();this.columnSettings=Uv.getSettings(this.getSettingsProps()),null!==e&&(this.columnSettings.renderer=this.props._getRendererWrapper(e),this.props._componentRendererColumns.set(this.props._columnIndex,!0)),null!==t&&(this.columnSettings.editor=this.props._getEditorClass(t,this.props._columnIndex))}},{key:"emitColumnSettings",value:function(){this.props._emitColumnSettings(this.columnSettings,this.props._columnIndex)}},{key:"componentDidMount",value:function(){this.createColumnSettings(),this.emitColumnSettings()}},{key:"componentDidUpdate",value:function(){this.createColumnSettings(),this.emitColumnSettings()}},{key:"render",value:function(){var e=Fv(this.props._getOwnerDocument(),this.getLocalEditorElement());return t.createElement(t.Fragment,null,e)}}])}(t.Component),Wv=function(e){function r(){var e;return Sv(this,r),(e=wv(this,r,arguments)).state={portals:[]},e}return Tv(r,e),kv(r,[{key:"render",value:function(){return t.createElement(t.Fragment,null,this.state.portals)}}])}(t.Component);function Vv(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var zv={exports:{}};var qv,Gv,$v,Kv;function Yv(){if(Gv)return qv;Gv=1;return qv="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"}zv.exports=function(){if(Kv)return $v;Kv=1;var e=Yv();function t(){}function r(){}return r.resetWarningCache=t,$v=function(){function n(t,r,n,i,o,a){if(a!==e){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function i(){return n}n.isRequired=n;var o={array:n,bigint:n,bool:n,func:n,number:n,object:n,string:n,symbol:n,any:n,arrayOf:i,element:n,elementType:n,instanceOf:i,node:n,objectOf:i,oneOf:i,oneOfType:i,shape:i,exact:i,checkPropTypes:r,resetWarningCache:t};return o.PropTypes=o,o}}()();var Xv=Vv(zv.exports),Jv=function(e){function r(){var e;return Sv(this,r),(e=wv(this,r,arguments)).id=null,e.__hotInstance=null,e.hotElementRef=null,e.columnSettings=[],e.renderersPortalManager=null,e.portalCache=new Map,e.portalContainerCache=new Map,e.renderedCellCache=new Map,e.editorCache=new Map,e.componentRendererColumns=new Map,e}return Tv(r,e),kv(r,[{key:"hotInstance",get:function(){return!this.__hotInstance||this.__hotInstance&&!this.__hotInstance.isDestroyed?this.__hotInstance:(console.warn("The Handsontable instance bound to this component was destroyed and cannot be used properly."),null)},set:function(e){this.__hotInstance=e}},{key:"_isHotInstanceDestroyed",value:function(){return this.__hotInstance&&this.__hotInstance.isDestroyed}},{key:"getPortalContainerCache",value:function(){return this.portalContainerCache}},{key:"getRenderedCellCache",value:function(){return this.renderedCellCache}},{key:"getEditorCache",value:function(){return this.editorCache}},{key:"clearCache",value:function(){this.getRenderedCellCache().clear(),this.componentRendererColumns.clear()}},{key:"getOwnerDocument",value:function(){return"undefined"!==typeof window?this.hotElementRef?this.hotElementRef.ownerDocument:document:null}},{key:"setHotElementRef",value:function(e){this.hotElementRef=e}},{key:"getRendererWrapper",value:function(e){var t=this;return function(r,n,i,o,a,s,l){var c=t.getRenderedCellCache(),u=t.getPortalContainerCache(),h="".concat(i,"-").concat(o),d=r.guid,f="".concat(d,"-").concat(h),g="".concat(h,"-").concat(d);if(c.has(h)&&(n.innerHTML=c.get(h).innerHTML),n&&!n.getAttribute("ghost-table")){for(var p=t.portalCache.get(g),m=u.get(f);n.firstChild;)n.removeChild(n.firstChild);if(p&&m)n.appendChild(m);else{var v=Hv(e,{TD:n,row:i,col:o,prop:a,value:s,cellProperties:l,isRenderer:!0},n.ownerDocument,g,m),b=v.portal,y=v.portalContainer;u.set(f,y),n.appendChild(y),t.portalCache.set(g,b)}}return c.set(h,n),n}}},{key:"getEditorClass",value:function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Pv,n=Dv(e),i=null===(t=this.getEditorCache().get(n))||void 0===t?void 0:t.get(r);return this.makeEditorClass(i)}},{key:"makeEditorClass",value:function(e){var t=function(t){function r(t){var n;return Sv(this,r),n=wv(this,r,[t]),e.hotCustomEditorInstance=n,n.editorComponent=e,n}return Tv(r,t),kv(r,[{key:"focus",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}}])}(bv.editors.BaseEditor);return Object.getOwnPropertyNames(bv.editors.BaseEditor.prototype).forEach((function(r){"constructor"!==r&&(t.prototype[r]=function(){for(var t,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(t=e[r]).call.apply(t,[e].concat(i))})})),t}},{key:"getGlobalRendererElement",value:function(){return Nv(this.props.children,"hot-renderer")}},{key:"getGlobalEditorElement",value:function(){return Lv(this.props.children,this.getEditorCache())}},{key:"createNewGlobalSettings",value:function(){var e,t,r,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=this._isHotInstanceDestroyed()?[]:(null===(e=this.hotInstance)||void 0===e||null===(e=e.getSettings())||void 0===e?void 0:e._initOnlySettings)||[],a=Uv.getSettings(this.props,{prevProps:i,isInit:n,initOnlySettingKeys:o}),s=this.getGlobalRendererElement(),l=this.getGlobalEditorElement();(a.columns=this.columnSettings.length?this.columnSettings:a.columns,l)?a.editor=this.getEditorClass(l,Pv):this.props.editor||null!==(t=this.props.settings)&&void 0!==t&&t.editor?a.editor=this.props.editor||this.props.settings.editor:a.editor=oa("text");s?(a.renderer=this.getRendererWrapper(s),this.componentRendererColumns.set("global",!0)):this.props.renderer||null!==(r=this.props.settings)&&void 0!==r&&r.renderer?a.renderer=this.props.renderer||this.props.settings.renderer:a.renderer=us("text");return a}},{key:"displayAutoSizeWarning",value:function(e){var t,r;this.hotInstance&&(null!==(t=this.hotInstance.getPlugin("autoRowSize"))&&void 0!==t&&t.enabled||null!==(r=this.hotInstance.getPlugin("autoColumnSize"))&&void 0!==r&&r.enabled)&&this.componentRendererColumns.size>0&&function(){var e;"undefined"!==typeof console&&(e=console).warn.apply(e,arguments)}("Your `HotTable` configuration includes `autoRowSize`/`autoColumnSize` options, which are not compatible with  the component-based renderers`. Disable `autoRowSize` and `autoColumnSize` to prevent row and column misalignment.")}},{key:"setHotColumnSettings",value:function(e,t){this.columnSettings[t]=e}},{key:"handsontableBeforeViewRender",value:function(){this.portalCache.clear(),this.getRenderedCellCache().clear()}},{key:"handsontableAfterViewRender",value:function(){this.renderersPortalManager.setState({portals:Ov(this.portalCache.values())})}},{key:"updateHot",value:function(e){this.hotInstance&&this.hotInstance.updateSettings(e,!1)}},{key:"setRenderersPortalManagerRef",value:function(e){this.renderersPortalManager=e}},{key:"componentDidMount",value:function(){var e=this,t=this.createNewGlobalSettings(!0);this.hotInstance=new bv.Core(this.hotElementRef,t),this.hotInstance.addHook("beforeViewRender",(function(){return e.handsontableBeforeViewRender()})),this.hotInstance.addHook("afterViewRender",(function(){return e.handsontableAfterViewRender()})),this.hotInstance.init(),this.displayAutoSizeWarning(t)}},{key:"componentDidUpdate",value:function(e){this.clearCache();var t=this.createNewGlobalSettings(!1,e);this.updateHot(t),this.displayAutoSizeWarning(t)}},{key:"componentWillUnmount",value:function(){this.clearCache(),this.hotInstance&&this.hotInstance.destroy()}},{key:"render",value:function(){var e=this,r=t.Children.toArray(this.props.children).filter((function(e){return function(e){return e.type===jv}(e)})).map((function(r,n){return t.cloneElement(r,{_componentRendererColumns:e.componentRendererColumns,_emitColumnSettings:e.setHotColumnSettings.bind(e),_columnIndex:n,_getChildElementByType:Nv.bind(e),_getRendererWrapper:e.getRendererWrapper.bind(e),_getEditorClass:e.getEditorClass.bind(e),_getOwnerDocument:e.getOwnerDocument.bind(e),_getEditorCache:e.getEditorCache.bind(e),children:r.props.children})})),n=Bv(this.props),i=Fv(this.getOwnerDocument(),this.getGlobalEditorElement());return t.createElement(t.Fragment,null,t.createElement("div",Object.assign({ref:this.setHotElementRef.bind(this)},n),r),t.createElement(Wv,{ref:this.setRenderersPortalManagerRef.bind(this)}),i)}}],[{key:"version",get:function(){return"14.5.0"}}])}(t.Component);Jv.propTypes={style:Xv.object,id:Xv.string,className:Xv.string};var Zv=["children"],Qv=t.forwardRef((function(e,r){var n,i=e.children,o=function(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.includes(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.includes(r)||{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}(e,Zv),a="function"===typeof t.useId?t.useId():void 0,s=null!==(n=o.id)&&void 0!==n?n:a;return t.createElement(Jv,Object.assign({id:s},o,{ref:r}),i)}));Qv.version=Jv.version;t.Component;const eb="handsontableEditor";class tb extends fv{static get EDITOR_TYPE(){return"handsontable"}open(){super.open(),this.htEditor&&this.htEditor.destroy(),"none"===this.htContainer.style.display&&(this.htContainer.style.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),di(this.TEXTAREA,0,this.TEXTAREA.value.length),this.refreshDimensions()}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close()}prepare(e,t,r,n,i,o){super.prepare(e,t,r,n,i,o);const a=this,s={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,ariaTags:!1,afterOnCellMouseDown(e,t){const r=this.getSourceData(t.row,t.col);void 0!==r&&a.setValue(r),a.hot.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&to(s,o.handsontable),this.htOptions=s}beginEditing(e,t){const r=this.hot.getSettings().onBeginEditing;r&&!1===r()||super.beginEditing(e,t)}createElements(){super.createElements();const e=this.hot.rootDocument.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.assignHooks()}finishEditing(e,t,r){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){const e=this.htEditor.getValue();void 0!==e&&this.setValue(e)}super.finishEditing(e,t,r)}assignHooks(){this.hot.addHook("afterDestroy",(()=>{this.htEditor&&this.htEditor.destroy()}))}registerShortcuts(){const e=this.hot.getShortcutManager().getContext("editor");super.registerShortcuts();const t={group:eb,relativeToGroup:zp,position:"before"},r=(e,t)=>{const r=this.htEditor;if(void 0!==e&&(e<0||r.flipped&&e>r.countRows()-1?r.deselectCell():r.selectCell(e,0),r.getData().length))return t.preventDefault(),No(t),this.hot.listen(),this.TEXTAREA.focus(),!1};e.addShortcuts([{keys:[["ArrowUp"]],callback:e=>{const t=this.htEditor;let n,i;return!t.getSelectedLast()&&t.flipped?n=t.countRows()-1:t.getSelectedLast()&&(t.flipped?(i=t.getSelectedLast()[0],n=Math.max(0,i-1)):(i=t.getSelectedLast()[0],n=i-1)),r(n,e)},preventDefault:!1},{keys:[["ArrowDown"]],callback:e=>{const t=this.htEditor;let n,i;if(t.getSelectedLast()||t.flipped){if(t.getSelectedLast())if(t.flipped)n=t.getSelectedLast()[0]+1;else if(!t.flipped){const e=t.countRows()-1;i=t.getSelectedLast()[0],n=Math.min(e,i+1)}}else n=0;return r(n,e)},preventDefault:!1}],t)}unregisterShortcuts(){super.unregisterShortcuts();this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(eb)}}function rb(e,t,r){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,r)}function nb(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ib(e,t){return e.get(function(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}(e,t))}var ob=new WeakMap;class ab extends tb{constructor(){super(...arguments),nb(this,"query",null),nb(this,"strippedChoices",[]),nb(this,"rawChoices",[]),rb(this,ob,this.hot.guid.slice(0,9)),nb(this,"sortByRelevance",(function(e,t,r){const n=[],i=[],o=e.length;let a,s,l,c,u=t.length;if(0===o){for(l=0;l<u;l++)i.push(l);return i}for(l=0;l<u;l++){if(s=gn(Pi(t[l])),r)c=s.indexOf(e);else{const t=this.cellProperties.locale;c=s.toLocaleLowerCase(t).indexOf(e.toLocaleLowerCase(t))}-1!==c&&(a=s.length-c-o,n.push({baseIndex:l,index:c,charsLeft:a,value:s}))}for(n.sort(((e,t)=>{if(-1===t.index)return-1;if(-1===e.index)return 1;if(e.index<t.index)return-1;if(t.index<e.index)return 1;if(e.index===t.index){if(e.charsLeft<t.charsLeft)return-1;if(e.charsLeft>t.charsLeft)return 1}return 0})),l=0,u=n.length;l<u;l++)i.push(n[l].baseIndex);return i}))}static get EDITOR_TYPE(){return"autocomplete"}getValue(){const e=this.rawChoices.find((e=>this.stripValueIfNeeded(e)===this.TEXTAREA.value));return Ni(e)?e:this.TEXTAREA.value}createElements(){super.createElements(),jn(this.htContainer,"autocompleteEditor"),jn(this.htContainer,-1===this.hot.rootWindow.navigator.platform.indexOf("Mac")?"":"htMacScroll"),this.hot.getSettings().ariaTags&&Vn(this.TEXTAREA,[["type","text"],["role","combobox"],Sn("listbox"),["aria-autocomplete","list"]])}prepare(e,t,r,n,i,o){var a;super.prepare(e,t,r,n,i,o),this.hot.getSettings().ariaTags&&Vn(this.TEXTAREA,[Tn("false"),(a=`${ib(ob,this)}-listbox-${e}-${t}`,["aria-controls",a])])}open(){super.open();const e=void 0===this.cellProperties.trimDropdown||this.cellProperties.trimDropdown,t=this.hot.getSettings().ariaTags,r=Array.isArray(this.cellProperties.source)?this.cellProperties.source:null,n=null===r||void 0===r?void 0:r.length,{row:i,col:o}=this;this.showEditableElement(),this.focus();let a=gi();var s;0===a&&Ro()&&(a+=15),this.addHook("beforeKeyDown",(e=>this.onBeforeKeyDown(e))),this.htEditor.updateSettings({colWidths:e?[ai(this.TEXTAREA)-2]:void 0,width:e?ai(this.TEXTAREA)+a:void 0,autoColumnSize:!0,renderer:(e,i,o,a,s,l,c)=>{pv(e,i,o,a,s,l,c);const{filteringCaseSensitive:u,allowHtml:h,locale:d}=this.cellProperties,f=this.query;let g,p,m=Pi(l);var v;m&&!h&&(g=!0===u?m.indexOf(f):m.toLocaleLowerCase(d).indexOf(f.toLocaleLowerCase(d)),-1!==g&&(p=m.substr(g,f.length),m=m.replace(p,`<strong>${p}</strong>`))),t&&Vn(i,[["role","option"],...r?[(v=n,["aria-setsize",v])]:[],...r?[Mn(r.indexOf(l)+1)]:[],["id",`${this.htEditor.rootElement.id}_${o}-${a}`]]),i.innerHTML=m},afterSelectionEnd:(e,r)=>{if(t){const t=this.htEditor.getCell(e,r,!0);Vn(t,[["aria-selected","true"]]),Vn(this.TEXTAREA,...(n=t.id,["aria-activedescendant",n]))}var n}}),t&&(Vn(this.htEditor.view._wt.wtOverlays.wtTable.TABLE,...vn()),Vn(this.htEditor.rootElement,[["role","listbox"],(s="polite",["aria-live",s]),On("text"),["id",`${ib(ob,this)}-listbox-${i}-${o}`]]),Vn(this.TEXTAREA,...Tn("true"))),this.hot._registerTimeout((()=>{this.queryChoices(this.TEXTAREA.value)}))}close(){this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&Vn(this.TEXTAREA,[Tn("false")])}discardEditor(e){super.discardEditor(e),this.hot.view.render()}queryChoices(e){const t=this.cellProperties.source;this.query=e,"function"===typeof t?t.call(this.cellProperties,e,(e=>{this.rawChoices=e,this.updateChoicesList(this.stripValuesIfNeeded(e))})):Array.isArray(t)?(this.rawChoices=t,this.updateChoicesList(this.stripValuesIfNeeded(t))):this.updateChoicesList([])}updateChoicesList(e){const t=ui(this.TEXTAREA),r=(n=this.TEXTAREA).selectionEnd?n.selectionEnd:0;var n;const i=this.cellProperties.sortByRelevance,o=this.cellProperties.filter;let a=null,s=null,l=e;i&&(a=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),l,this.cellProperties.filteringCaseSensitive));const c=Array.isArray(a)?a.length:0;if(!1===o)c&&(s=a[0]);else{const e=[];for(let t=0,r=l.length;t<r&&!(i&&c<=t);t++)c?e.push(l[a[t]]):e.push(l[t]);s=0,l=e}this.strippedChoices=l,0===l.length?this.htEditor.rootElement.style.display="none":this.htEditor.rootElement.style.display="",this.htEditor.loadData(xi([l])),l.length>0&&(this.updateDropdownDimensions(),this.flipDropdownIfNeeded(),!0===this.cellProperties.strict&&this.highlightBestMatchingChoice(s)),this.hot.listen(),di(this.TEXTAREA,t,t===r?void 0:r)}flipDropdownIfNeeded(){const e=ni(this.hot.view._wt.wtTable.TABLE),t=e===this.hot.rootWindow,r=this.cellProperties.preventOverflow;if(t||!t&&(r||"horizontal"===r))return!1;const n=Jn(this.TEXTAREA),i=si(this.TEXTAREA),o=this.getDropdownHeight(),a=e.scrollTop,s=si(this.hot.view._wt.wtTable.THEAD),l=Jn(e),c=n.top-l.top-s+a,u=e.scrollHeight-c-s-i,h=o>u&&c>u;return h?this.flipDropdown(o):this.unflipDropdown(),this.limitDropdownIfNeeded(h?c:u,o),h}limitDropdownIfNeeded(e,t){if(t>e){let r=0,n=0,i=0,o=null;do{i=this.htEditor.getRowHeight(n)||this.htEditor.view._wt.getSetting("defaultRowHeight"),r+=i,n+=1}while(r<e);o=r-i,this.htEditor.flipped&&(this.htEditor.rootElement.style.top=parseInt(this.htEditor.rootElement.style.top,10)+t-o+"px"),this.setDropdownHeight(r-i)}}flipDropdown(e){const t=this.htEditor.rootElement.style;t.position="absolute",t.top=-e+"px",this.htEditor.flipped=!0}unflipDropdown(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top="",this.htEditor.flipped=void 0}updateDropdownDimensions(){const e=this.htEditor.getColWidth(0)+gi(this.hot.rootDocument)+2,t=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:t?void 0:e}),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(e){this.htEditor.updateSettings({height:e})}highlightBestMatchingChoice(e){"number"===typeof e?this.htEditor.selectCell(e,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getDropdownHeight(){const e=this.htEditor.getRowHeight(0)||23,t=this.cellProperties.visibleRows;return this.strippedChoices.length>=t?t*e:this.strippedChoices.length*e+8}stripValueIfNeeded(e){return this.stripValuesIfNeeded([e])[0]}stripValuesIfNeeded(e){const{allowHtml:t}=this.cellProperties,r=_i(e,(e=>Pi(e)));return _i(r,(e=>t?e:gn(e)))}allowKeyEventPropagation(e){const t=this.htEditor.getSelectedRangeLast(),r=t?t.from.row:-1;let n=!1;return e===Oo.ARROW_DOWN&&r>0&&r<this.htEditor.countRows()-1&&(n=!0),e===Oo.ARROW_UP&&r>-1&&(n=!0),n}onBeforeKeyDown(e){if(32===(t=e.keyCode)||t>=48&&t<=57||t>=96&&t<=111||t>=186&&t<=192||t>=219&&t<=222||t>=226||t>=65&&t<=90||e.keyCode===Oo.BACKSPACE||e.keyCode===Oo.DELETE||e.keyCode===Oo.INSERT){let t=10;if(e.keyCode===Oo.C&&(e.ctrlKey||e.metaKey))return;this.isOpened()||(t+=10),this.htEditor&&this.hot._registerTimeout((()=>{this.queryChoices(this.TEXTAREA.value)}),t)}var t}}class sb extends hm{static get EDITOR_TYPE(){return"checkbox"}beginEditing(e,t){if(t&&"mouseup"===t.type&&"TD"===t.target.nodeName){const e=this.TD.querySelector('input[type="checkbox"]');Un(e,"htBadValue")||e.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}}const lb=()=>window,cb=()=>window.document,ub=(e,t)=>window.setTimeout(e,t),hb=function(e,t,r,n){e.addEventListener(t,r,!!n)},db=function(e,t,r,n){e.removeEventListener(t,r,!!n)},fb=function(e,t){return-1!==(" "+e.className+" ").indexOf(" "+t+" ")},gb=function(e,t){fb(e,t)||(e.className=""===e.className?t:e.className+" "+t)},pb=function(e,t){var r;e.className=(r=(" "+e.className+" ").replace(" "+t+" "," ")).trim?r.trim():r.replace(/^\s+|\s+$/g,"")},mb=function(e){return/Array/.test(Object.prototype.toString.call(e))},vb=function(e){return/Date/.test(Object.prototype.toString.call(e))&&!isNaN(e.getTime())},bb=function(e){let t=e.getDay();return 0===t||6===t},yb=function(e){return e%4===0&&e%100!==0||e%400===0},wb=function(e,t){return[31,yb(e)?29:28,31,30,31,30,31,31,30,31,30,31][t]},Sb=function(e){vb(e)&&e.setHours(0,0,0,0)},Cb=function(e,t){return e.getTime()===t.getTime()},kb=function(e,t,r){let n,i;for(n in t)i=void 0!==e[n],i&&"object"===typeof t[n]&&null!==t[n]&&void 0===t[n].nodeName?vb(t[n])?r&&(e[n]=new Date(t[n].getTime())):mb(t[n])?r&&(e[n]=t[n].slice(0)):e[n]=kb({},t[n],r):!r&&i||(e[n]=t[n]);return e},xb=function(e,t,r){let n=cb().createEvent("HTMLEvents");n.initEvent(t,!0,!1),n=kb(n,r),e.dispatchEvent(n)},Eb=function(e){return e.month<0&&(e.year-=Math.ceil(Math.abs(e.month)/12),e.month+=12),e.month>11&&(e.year+=Math.floor(Math.abs(e.month)/12),e.month-=12),e},Tb={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},_b=function(e,t,r){for(t+=e.firstDay;t>=7;)t-=7;return r?e.i18n.weekdaysShort[t]:e.i18n.weekdays[t]},Ab=function(e){let t=[],r="false";if(e.isEmpty){if(!e.showDaysInNextAndPreviousMonths)return'<td class="is-empty"></td>';t.push("is-outside-current-month"),e.enableSelectionDaysInNextAndPreviousMonths||t.push("is-selection-disabled")}return e.isDisabled&&t.push("is-disabled"),e.isToday&&t.push("is-today"),e.isSelected&&(t.push("is-selected"),r="true"),e.hasEvent&&t.push("has-event"),e.isInRange&&t.push("is-inrange"),e.isStartRange&&t.push("is-startrange"),e.isEndRange&&t.push("is-endrange"),'<td data-day="'+e.day+'" class="'+t.join(" ")+'" aria-selected="'+r+'"><button class="pika-button pika-day" type="button" data-pika-year="'+e.year+'" data-pika-month="'+e.month+'" data-pika-day="'+e.day+'">'+e.day+"</button></td>"},Rb=function(e,t,r,n,i){let o=new Date(n,r,t),a=e.hasMoment?e.moment(o).isoWeek():function(e,t){e.setHours(0,0,0,0);let r=e.getDate(),n=e.getDay(),i=t,o=i-1,a=function(e){return(e+7-1)%7};e.setDate(r+o-a(n));let s=new Date(e.getFullYear(),0,i),l=(e.getTime()-s.getTime())/864e5;return 1+Math.round((l-o+a(s.getDay()))/7)}(o,i);return'<td class="pika-week">'+a+"</td>"},Ob=function(e,t,r,n){return'<tr class="pika-row'+(r?" pick-whole-week":"")+(n?" is-selected":"")+'">'+(t?e.reverse():e).join("")+"</tr>"},Mb=function(e,t,r,n,i,o){let a,s,l,c,u,h=e._o,d=r===h.minYear,f=r===h.maxYear,g='<div id="'+o+'" class="pika-title" role="heading" aria-live="polite">',p=!0,m=!0;for(l=[],a=0;a<12;a++)l.push('<option value="'+(r===i?a-t:12+a-t)+'"'+(a===n?' selected="selected"':"")+(d&&a<h.minMonth||f&&a>h.maxMonth?' disabled="disabled"':"")+">"+h.i18n.months[a]+"</option>");for(c='<div class="pika-label">'+h.i18n.months[n]+'<select class="pika-select pika-select-month" tabindex="-1">'+l.join("")+"</select></div>",mb(h.yearRange)?(a=h.yearRange[0],s=h.yearRange[1]+1):(a=r-h.yearRange,s=1+r+h.yearRange),l=[];a<s&&a<=h.maxYear;a++)a>=h.minYear&&l.push('<option value="'+a+'"'+(a===r?' selected="selected"':"")+">"+a+"</option>");return u='<div class="pika-label">'+r+h.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+l.join("")+"</select></div>",h.showMonthAfterYear?g+=u+c:g+=c+u,d&&(0===n||h.minMonth>=n)&&(p=!1),f&&(11===n||h.maxMonth<=n)&&(m=!1),0===t&&(g+='<button class="pika-prev'+(p?"":" is-disabled")+'" type="button">'+h.i18n.previousMonth+"</button>"),t===e._o.numberOfMonths-1&&(g+='<button class="pika-next'+(m?"":" is-disabled")+'" type="button">'+h.i18n.nextMonth+"</button>"),g+"</div>"},Ib=function(e,t,r){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+r+'">'+function(e){let t,r=[];for(e.showWeekNumber&&r.push("<th></th>"),t=0;t<7;t++)r.push('<th scope="col"><abbr title="'+_b(e,t)+'">'+_b(e,t,!0)+"</abbr></th>");return"<thead><tr>"+(e.isRTL?r.reverse():r).join("")+"</tr></thead>"}(e)+("<tbody>"+t.join("")+"</tbody></table>")};function Pb(e){let t=this,r=t.config(e);t._onMouseDown=function(e){if(!t._v)return;let n=(e=e||lb().event).target||e.srcElement;if(n)if(fb(n,"is-disabled")||(!fb(n,"pika-button")||fb(n,"is-empty")||fb(n.parentNode,"is-disabled")?fb(n,"pika-prev")?t.prevMonth():fb(n,"pika-next")&&t.nextMonth():(t.setDate(new Date(n.getAttribute("data-pika-year"),n.getAttribute("data-pika-month"),n.getAttribute("data-pika-day"))),r.bound&&ub((function(){t.hide(),r.blurFieldOnSelect&&r.field&&r.field.blur()}),100))),fb(n,"pika-select"))t._c=!0;else{if(!e.preventDefault)return e.returnValue=!1,!1;e.preventDefault()}},t._onChange=function(e){let r=(e=e||lb().event).target||e.srcElement;r&&(fb(r,"pika-select-month")?t.gotoMonth(r.value):fb(r,"pika-select-year")&&t.gotoYear(r.value))},t._onKeyChange=function(e){if(e=e||lb().event,t.isVisible())switch(e.keyCode){case 13:case 27:r.field&&r.field.blur();break;case 37:t.adjustDate("subtract",1);break;case 38:t.adjustDate("subtract",7);break;case 39:t.adjustDate("add",1);break;case 40:t.adjustDate("add",7);break;case 8:case 46:t.setDate(null)}},t._parseFieldValue=function(){if(r.parse)return r.parse(r.field.value,r.format);if(this.hasMoment){let e=this.moment(r.field.value,r.format,r.formatStrict);return e&&e.isValid()?e.toDate():null}return new Date(Date.parse(r.field.value))},t._onInputChange=function(e){let r;e.firedBy!==t&&(r=t._parseFieldValue(),vb(r)&&t.setDate(r),t._v||t.show())},t._onInputFocus=function(){t.show()},t._onInputClick=function(){t.show()},t._onInputBlur=function(){let e=cb().activeElement;do{if(fb(e,"pika-single"))return}while(e=e.parentNode);t._c||(t._b=ub((function(){t.hide()}),50)),t._c=!1},t._onClick=function(e){let n=(e=e||lb().event).target||e.srcElement,i=n;if(n){!hasEventListeners&&fb(n,"pika-select")&&(n.onchange||(n.setAttribute("onchange","return;"),hb(n,"change",t._onChange)));do{if(fb(i,"pika-single")||i===r.trigger)return}while(i=i.parentNode);t._v&&n!==r.trigger&&i!==r.trigger&&t.hide()}},t.el=cb().createElement("div"),t.el.className="pika-single"+(r.isRTL?" is-rtl":"")+(r.theme?" "+r.theme:""),hb(t.el,"mousedown",t._onMouseDown,!0),hb(t.el,"touchend",t._onMouseDown,!0),hb(t.el,"change",t._onChange),r.keyboardInput&&hb(cb(),"keydown",t._onKeyChange),r.field&&(r.container?r.container.appendChild(t.el):r.bound?cb().body.appendChild(t.el):r.field.parentNode.insertBefore(t.el,r.field.nextSibling),hb(r.field,"change",t._onInputChange),r.defaultDate||(r.defaultDate=t._parseFieldValue(),r.setDefaultDate=!0));let n=r.defaultDate;vb(n)?r.setDefaultDate?t.setDate(n,!0):t.gotoDate(n):t.gotoDate(new Date),r.bound?(this.hide(),t.el.className+=" is-bound",hb(r.trigger,"click",t._onInputClick),hb(r.trigger,"focus",t._onInputFocus),hb(r.trigger,"blur",t._onInputBlur)):this.show()}function Nb(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Pb.prototype={config:function(e){this._o||(this._o=kb({},Tb,!0));let t=kb(this._o,e,!0);t.isRTL=!!t.isRTL,t.field=t.field&&t.field.nodeName?t.field:null,t.theme="string"===typeof t.theme&&t.theme?t.theme:null,t.bound=!!(void 0!==t.bound?t.field&&t.bound:t.field),t.trigger=t.trigger&&t.trigger.nodeName?t.trigger:t.field,t.disableWeekends=!!t.disableWeekends,t.disableDayFn="function"===typeof t.disableDayFn?t.disableDayFn:null;let r=parseInt(t.numberOfMonths,10)||1;if(t.numberOfMonths=r>4?4:r,vb(t.minDate)||(t.minDate=!1),vb(t.maxDate)||(t.maxDate=!1),t.minDate&&t.maxDate&&t.maxDate<t.minDate&&(t.maxDate=t.minDate=!1),t.minDate&&this.setMinDate(t.minDate),t.maxDate&&this.setMaxDate(t.maxDate),mb(t.yearRange)){let e=(new Date).getFullYear()-10;t.yearRange[0]=parseInt(t.yearRange[0],10)||e,t.yearRange[1]=parseInt(t.yearRange[1],10)||e}else t.yearRange=Math.abs(parseInt(t.yearRange,10))||Tb.yearRange,t.yearRange>100&&(t.yearRange=100);return t},toString:function(e){return e=e||this._o.format,vb(this._d)?this._o.toString?this._o.toString(this._d,e):this.hasMoment?this.moment(this._d).format(e):this._d.toDateString():""},getMoment:function(){return this.hasMoment?this.moment(this._d):null},setMoment:function(e,t){this.hasMoment&&this.moment.isMoment(e)&&this.setDate(e.toDate(),t)},useMoment:function(e){this.hasMoment=!0,this.moment=e},getDate:function(){return vb(this._d)?new Date(this._d.getTime()):null},setDate:function(e,t){if(!e)return this._d=null,this._o.field&&(this._o.field.value="",xb(this._o.field,"change",{firedBy:this})),this.draw();if("string"===typeof e&&(e=new Date(Date.parse(e))),!vb(e))return;let r=this._o.minDate,n=this._o.maxDate;vb(r)&&e<r?e=r:vb(n)&&e>n&&(e=n),this._d=new Date(e.getTime()),Sb(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),xb(this._o.field,"change",{firedBy:this})),t||"function"!==typeof this._o.onSelect||this._o.onSelect.call(this,this.getDate())},clear:function(){this.setDate(null)},gotoDate:function(e){let t=!0;if(vb(e)){if(this.calendars){let r=new Date(this.calendars[0].year,this.calendars[0].month,1),n=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),i=e.getTime();n.setMonth(n.getMonth()+1),n.setDate(n.getDate()-1),t=i<r.getTime()||n.getTime()<i}t&&(this.calendars=[{month:e.getMonth(),year:e.getFullYear()}],"right"===this._o.mainCalendar&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(e,t){let r,n=this.getDate()||new Date,i=24*parseInt(t)*60*60*1e3;"add"===e?r=new Date(n.valueOf()+i):"subtract"===e&&(r=new Date(n.valueOf()-i)),this.setDate(r)},adjustCalendars:function(){this.calendars[0]=Eb(this.calendars[0]);for(let e=1;e<this._o.numberOfMonths;e++)this.calendars[e]=Eb({month:this.calendars[0].month+e,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(e){isNaN(e)||(this.calendars[0].month=parseInt(e,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(e){isNaN(e)||(this.calendars[0].year=parseInt(e,10),this.adjustCalendars())},setMinDate:function(e){e instanceof Date?(Sb(e),this._o.minDate=e,this._o.minYear=e.getFullYear(),this._o.minMonth=e.getMonth()):(this._o.minDate=Tb.minDate,this._o.minYear=Tb.minYear,this._o.minMonth=Tb.minMonth,this._o.startRange=Tb.startRange),this.draw()},setMaxDate:function(e){e instanceof Date?(Sb(e),this._o.maxDate=e,this._o.maxYear=e.getFullYear(),this._o.maxMonth=e.getMonth()):(this._o.maxDate=Tb.maxDate,this._o.maxYear=Tb.maxYear,this._o.maxMonth=Tb.maxMonth,this._o.endRange=Tb.endRange),this.draw()},setStartRange:function(e){this._o.startRange=e},setEndRange:function(e){this._o.endRange=e},draw:function(e){if(!this._v&&!e)return;let t,r=this._o,n=r.minYear,i=r.maxYear,o=r.minMonth,a=r.maxMonth,s="";this._y<=n&&(this._y=n,!isNaN(o)&&this._m<o&&(this._m=o)),this._y>=i&&(this._y=i,!isNaN(a)&&this._m>a&&(this._m=a));for(let l=0;l<r.numberOfMonths;l++)t="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),s+='<div class="pika-lendar">'+Mb(this,l,this.calendars[l].year,this.calendars[l].month,this.calendars[0].year,t)+this.render(this.calendars[l].year,this.calendars[l].month,t)+"</div>";this.el.innerHTML=s,r.bound&&"hidden"!==r.field.type&&ub((function(){r.trigger.focus()}),1),"function"===typeof this._o.onDraw&&this._o.onDraw(this),r.bound&&r.field.setAttribute("aria-label",r.ariaLabel)},adjustPosition:function(){let e,t,r,n,i,o,a,s,l,c,u;this._o.container||(this.el.style.position="absolute",e=this._o.trigger,t=this.el.offsetWidth,r=this.el.offsetHeight,n=lb().innerWidth||cb().documentElement.clientWidth,i=lb().innerHeight||cb().documentElement.clientHeight,o=cb().body.scrollTop||cb().documentElement.scrollTop,c=!0,u=!0,l=e.getBoundingClientRect(),a=l.left+lb().pageXOffset,s=l.bottom+lb().pageYOffset,(this._o.reposition&&a+t>n||this._o.position.indexOf("right")>-1&&a-t+e.offsetWidth>0)&&(a=a-t+e.offsetWidth,c=!1),(this._o.reposition&&s+r>i+o||this._o.position.indexOf("top")>-1&&s-r-e.offsetHeight>0)&&(s=s-r-e.offsetHeight,u=!1),a<0&&(a=0),s<0&&(s=0),this.el.style.left=a+"px",this.el.style.top=s+"px",gb(this.el,c?"left-aligned":"right-aligned"),gb(this.el,u?"bottom-aligned":"top-aligned"),pb(this.el,c?"right-aligned":"left-aligned"),pb(this.el,u?"top-aligned":"bottom-aligned"))},render:function(e,t,r){let n=this._o,i=new Date,o=wb(e,t),a=new Date(e,t,1).getDay(),s=[],l=[];Sb(i),n.firstDay>0&&(a-=n.firstDay,a<0&&(a+=7));let c=0===t?11:t-1,u=11===t?0:t+1,h=0===t?e-1:e,d=11===t?e+1:e,f=wb(h,c),g=o+a,p=g;for(;p>7;)p-=7;g+=7-p;let m=!1;for(let v=0,b=0;v<g;v++){let r=new Date(e,t,v-a+1),g=!!vb(this._d)&&Cb(r,this._d),p=Cb(r,i),y=-1!==n.events.indexOf(r.toDateString()),w=v<a||v>=o+a,S=v-a+1,C=t,k=e,x=n.startRange&&Cb(n.startRange,r),E=n.endRange&&Cb(n.endRange,r),T=n.startRange&&n.endRange&&n.startRange<r&&r<n.endRange;w&&(v<a?(S=f+S,C=c,k=h):(S-=o,C=u,k=d));let _={day:S,month:C,year:k,hasEvent:y,isSelected:g,isToday:p,isDisabled:n.minDate&&r<n.minDate||n.maxDate&&r>n.maxDate||n.disableWeekends&&bb(r)||n.disableDayFn&&n.disableDayFn(r),isEmpty:w,isStartRange:x,isEndRange:E,isInRange:T,showDaysInNextAndPreviousMonths:n.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:n.enableSelectionDaysInNextAndPreviousMonths};n.pickWholeWeek&&g&&(m=!0),l.push(Ab(_)),7===++b&&(n.showWeekNumber&&l.unshift(Rb(this,v-a,t,e,n.firstWeekOfYearMinDays)),s.push(Ob(l,n.isRTL,n.pickWholeWeek,m)),l=[],b=0,m=!1)}return Ib(n,s,r)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),pb(this.el,"is-hidden"),this._o.bound&&(hb(cb(),"click",this._onClick),this.adjustPosition()),"function"===typeof this._o.onOpen&&this._o.onOpen.call(this))},hide:function(){let e=this._v;!1!==e&&(this._o.bound&&db(cb(),"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),gb(this.el,"is-hidden"),this._v=!1,void 0!==e&&"function"===typeof this._o.onClose&&this._o.onClose.call(this))},destroy:function(){let e=this._o;this.hide(),db(this.el,"mousedown",this._onMouseDown,!0),db(this.el,"touchend",this._onMouseDown,!0),db(this.el,"change",this._onChange),e.keyboardInput&&db(cb(),"keydown",this._onKeyChange),e.field&&(db(e.field,"change",this._onInputChange),e.bound&&(db(e.trigger,"click",this._onInputClick),db(e.trigger,"focus",this._onInputFocus),db(e.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}};const Db="date",Fb="dateEditor";class Lb extends fv{constructor(){super(...arguments),Nb(this,"defaultDateFormat","DD/MM/YYYY"),Nb(this,"parentDestroyed",!1),Nb(this,"$datePicker",null)}static get EDITOR_TYPE(){return Db}init(){if("function"!==typeof Ci)throw new Error("You need to include moment.js to your project.");super.init(),this.hot.addHook("afterDestroy",(()=>{this.parentDestroyed=!0,this.destroyElements()}))}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),jn(this.datePicker,"htDatepickerHolder"),this.hot.rootDocument.body.appendChild(this.datePicker),this.eventManager.addEventListener(this.datePicker,"mousedown",(e=>{Un(e.target,"pika-day")&&this.hideDatepicker(),e.stopPropagation()}))}destroyElements(){const e=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),e&&e.removeChild(this.datePicker)}prepare(e,t,r,n,i,o){super.prepare(e,t,r,n,i,o)}open(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;const t=this.hot.getShortcutManager().getContext("editor");this.showDatepicker(e),super.open(),t.addShortcuts([{keys:[["ArrowLeft"]],callback:()=>{this.$datePicker.adjustDate("subtract",1)}},{keys:[["ArrowRight"]],callback:()=>{this.$datePicker.adjustDate("add",1)}},{keys:[["ArrowUp"]],callback:()=>{this.$datePicker.adjustDate("subtract",7)}},{keys:[["ArrowDown"]],callback:()=>{this.$datePicker.adjustDate("add",7)}}],{group:Fb})}close(){var e;this._opened=!1,null!==(e=this.$datePicker)&&void 0!==e&&e.destroy&&this.$datePicker.destroy(),this.hot._registerTimeout((()=>{const e=this.hot._getEditorManager();e.closeEditor(),this.hot.view.render(),e.prepareEditor()}));this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(Fb),super.close()}finishEditing(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super.finishEditing(e,t)}showDatepicker(e){const t=this.cellProperties.dateFormat||this.defaultDateFormat,r=this.hot.view.isMouseDown(),n=!!e&&Io(e.keyCode);let i;this.datePicker.style.display="block",this.$datePicker=new Pb(this.getDatePickerConfig()),"function"===typeof this.$datePicker.useMoment&&this.$datePicker.useMoment(Ci),this.$datePicker._onInputFocus=function(){},this.originalValue?(i=this.originalValue,Ci(i,t,!0).isValid()&&this.$datePicker.setMoment(Ci(i,t),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),n||r||this.setValue("")):this.cellProperties.defaultDate?(i=this.cellProperties.defaultDate,Ci(i,t,!0).isValid()&&this.$datePicker.setMoment(Ci(i,t),!0),n||r||this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){const e=this.TEXTAREA,t={};this.cellProperties&&this.cellProperties.datePickerConfig&&ro(t,this.cellProperties.datePickerConfig);const r=t.onSelect,n=t.onClose;return t.field=e,t.trigger=e,t.container=this.datePicker,t.bound=!1,t.keyboardInput=!1,t.format=t.format||this.defaultDateFormat,t.reposition=t.reposition||!1,t.isRTL=!1,t.onSelect=e=>{let t=e;isNaN(t.getTime())||(t=Ci(t).format(this.cellProperties.dateFormat||this.defaultDateFormat)),this.setValue(t),r&&r()},t.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),n&&n()},t}refreshDimensions(e){var t;if(super.refreshDimensions(e),this.state!==um.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD)return void this.hideDatepicker();const{rowIndexMapper:r,columnIndexMapper:n}=this.hot,{wtOverlays:i}=this.hot.view._wt,{wtTable:o}=null!==(t=i.getParentOverlay(this.TD))&&void 0!==t?t:this.hot.view._wt,a=r.getVisualFromRenderableIndex(o.getFirstPartiallyVisibleRow()),s=r.getVisualFromRenderableIndex(o.getLastPartiallyVisibleRow()),l=n.getVisualFromRenderableIndex(o.getFirstPartiallyVisibleColumn()),c=n.getVisualFromRenderableIndex(o.getLastPartiallyVisibleColumn());if(this.row>=a&&this.row<=s&&this.col>=l&&this.col<=c){const e=this.TD.getBoundingClientRect();this.datePickerStyle.top=`${this.hot.rootWindow.pageYOffset+e.top+si(this.TD)}px`;let t=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?t+=e.right-ai(this.datePicker):t+=e.left,this.datePickerStyle.left=`${t}px`}else this.hideDatepicker()}}class Hb extends ab{static get EDITOR_TYPE(){return"dropdown"}prepare(e,t,r,n,i,o){super.prepare(e,t,r,n,i,o),this.cellProperties.filter=!1,this.cellProperties.strict=!0}}Ko.getSingleton().add("beforeValidate",(function(e,t,r){const n=this.propToCol(r);if(Number.isInteger(n)){const e=this.getCellMeta(t,n);e.editor===Hb&&void 0===e.strict&&(e.filter=!1,e.strict=!0)}}));class Bb extends fv{static get EDITOR_TYPE(){return"numeric"}}class Ub extends fv{static get EDITOR_TYPE(){return"password"}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.hot.getSettings().ariaTags&&Vn(this.TEXTAREA,[wn()]),Gn(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}const jb="ht_editor_visible",Wb="selectEditor";class Vb extends hm{static get EDITOR_TYPE(){return"select"}init(){this.select=this.hot.rootDocument.createElement("select"),this.select.setAttribute("data-hot-input","true"),this.select.style.display="none",jn(this.select,"htSelectEditor"),this.hot.rootElement.appendChild(this.select),this.registerHooks()}getValue(){return this.select.value}setValue(e){this.select.value=e}open(){this._opened=!0,this.refreshDimensions(),this.select.style.display="";this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.select.style.display="none",Un(this.select,jb)&&Wn(this.select,jb),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",(()=>this.refreshDimensions())),this.addHook("afterScrollVertically",(()=>this.refreshDimensions())),this.addHook("afterColumnResize",(()=>this.refreshDimensions())),this.addHook("afterRowResize",(()=>this.refreshDimensions()))}prepare(e,t,r,n,i,o){super.prepare(e,t,r,n,i,o);const a=this.cellProperties.selectOptions;let s;s="function"===typeof a?this.prepareOptions(a(this.row,this.col,this.prop)):this.prepareOptions(a),Gn(this.select),co(s,((e,t)=>{const r=this.hot.rootDocument.createElement("OPTION");r.value=t,Kn(r,e),this.select.appendChild(r)}))}prepareOptions(e){let t={};if(Array.isArray(e))for(let r=0,n=e.length;r<n;r++)t[e[r]]=e[r];else"object"===typeof e&&(t=e);return t}refreshValue(){const e=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){if(this.state!==um.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD)return void this.close();const{top:e,start:t,width:r,height:n}=this.getEditedCellRect(),i=this.select.style;i.height=`${n}px`,i.width=`${r}px`,i.top=`${e}px`,i[this.hot.isRtl()?"right":"left"]=`${t}px`,i.margin="0px",jn(this.select,jb)}registerShortcuts(){const e=this.hot.getShortcutManager().getContext("editor"),t={group:Wb};this.isInFullEditMode()&&e.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{const e=this.select.selectedIndex-1;e>=0&&(this.select[e].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{const e=this.select.selectedIndex+1;e<=this.select.length-1&&(this.select[e].selected=!0)}}],t)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(Wb)}}class zb extends fv{static get EDITOR_TYPE(){return"time"}prepare(e,t,r,n,i,o){super.prepare(e,t,r,n,i,o),this.TEXTAREA.dir="ltr"}}function qb(e,t,r,n,i,o,a){gv.apply(this,[e,t,r,n,i,o,a]),Kn(t,null===o||void 0===o?"":o,!1)}qb.RENDERER_TYPE="html";function Gb(e,t,r,n,i,o,a){const{rootDocument:s}=e,l=a.allowHtml?qb:pv,c=s.createElement("DIV"),u=e.getSettings().ariaTags;if(c.className="htAutocompleteArrow",u&&c.setAttribute(...wn()),c.appendChild(s.createTextNode(String.fromCharCode(9660))),l.apply(this,[e,t,r,n,i,o,a]),t.firstChild||t.appendChild(s.createTextNode(String.fromCharCode(160))),t.insertBefore(c,t.firstChild),jn(t,"htAutocomplete"),!e.acArrowListener){const i=new ca(e);e.acArrowListener=function(i){Un(i.target,"htAutocompleteArrow")&&e.view._wt.getSetting("onCellDblClick",null,e._createCellCoords(r,n),t)},i.addEventListener(e.rootElement,"mousedown",e.acArrowListener),e.addHookOnce("afterDestroy",(()=>{i.destroy()}))}}Gb.RENDERER_TYPE="autocomplete";function $b(e,t,r,n,i,o,a){Gb.apply(this,[e,t,r,n,i,o,a])}$b.RENDERER_TYPE="dropdown";const Kb=new WeakMap,Yb=new WeakMap,Xb="htBadValue",Jb="data-row",Zb="data-col",Qb="checkboxRenderer",ey="checkbox";function ty(e,t,r,n,i,o,a){const{rootDocument:s}=e,l=e.getSettings().ariaTags;gv.apply(this,[e,t,r,n,i,o,a]),function(e){let t=Yb.get(e);if(!t){const{rootElement:r}=e;t=new ca(e),t.addEventListener(r,"click",(t=>function(e,t){const{target:r}=e;if(!ry(r))return;if(!r.hasAttribute(Jb)||!r.hasAttribute(Zb))return;const n=parseInt(r.getAttribute(Jb),10),i=parseInt(r.getAttribute(Zb),10),o=t.getCellMeta(n,i);o.readOnly&&e.preventDefault()}(t,e))),t.addEventListener(r,"mouseup",(t=>function(e,t){const{target:r}=e;if(!ry(r))return;if(!r.hasAttribute(Jb)||!r.hasAttribute(Zb))return;setTimeout(t.listen,10)}(t,e))),t.addEventListener(r,"change",(t=>function(e,t){const{target:r}=e;if(!ry(r))return;if(!r.hasAttribute(Jb)||!r.hasAttribute(Zb))return;const n=parseInt(r.getAttribute(Jb),10),i=parseInt(r.getAttribute(Zb),10),o=t.getCellMeta(n,i);if(!o.readOnly){let r=null;r=e.target.checked?void 0===o.uncheckedTemplate||o.checkedTemplate:void 0!==o.uncheckedTemplate&&o.uncheckedTemplate,t.setDataAtCell(n,i,r)}}(t,e))),Yb.set(e,t)}}(e);let c=function(e){const t=e.createElement("input");return t.className="htCheckboxRendererInput",t.type="checkbox",t.setAttribute("tabindex","-1"),t.cloneNode(!1)}(s);const u=a.label;let h=!1;if("undefined"===typeof a.checkedTemplate&&(a.checkedTemplate=!0),"undefined"===typeof a.uncheckedTemplate&&(a.uncheckedTemplate=!1),Gn(t),o===a.checkedTemplate||Pi(o).toLocaleLowerCase(a.locale)===Pi(a.checkedTemplate).toLocaleLowerCase(a.locale)?c.checked=!0:o===a.uncheckedTemplate||Pi(o).toLocaleLowerCase(a.locale)===Pi(a.uncheckedTemplate).toLocaleLowerCase(a.locale)?c.checked=!1:Fi(o)?jn(c,"noValue"):(c.style.display="none",jn(c,Xb),h=!0),Vn(c,[[Jb,r],[Zb,n]]),l&&Vn(c,[yn(c.checked?e.getTranslatedPhrase(Ff):e.getTranslatedPhrase(Lf)),Rn(c.checked),bn()]),!h&&u){let a="";if(u.value)a="function"===typeof u.value?u.value.call(this,r,n,i,o):u.value;else if(u.property){const t=e.getDataAtRowProp(r,u.property);a=null!==t?t:""}const l=function(e,t,r){const n=e.createElement("label");return n.className="htCheckboxRendererLabel "+(r?"fullWidth":""),n.appendChild(e.createTextNode(t)),n.cloneNode(!0)}(s,a,!0!==u.separated);"before"===u.position?u.separated?(t.appendChild(l),t.appendChild(c)):(l.appendChild(c),c=l):u.position&&"after"!==u.position||(u.separated?(t.appendChild(c),t.appendChild(l)):(l.insertBefore(c,l.firstChild),c=l))}function d(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const r=e.getSelectedRange(),n=[];let i=[],o=0;if(r){for(let a=0;a<r.length;a++){const{row:s,col:l}=r[a].getTopStartCorner(),{row:c,col:u}=r[a].getBottomEndCorner();for(let r=s;r<=c;r+=1)for(let n=l;n<=u;n+=1){const a=e.getCellMeta(r,n),s={checkedTemplate:a.checkedTemplate,uncheckedTemplate:a.uncheckedTemplate};if("checkbox"!==a.type)return;if(!0===a.readOnly)continue;"undefined"===typeof a.checkedTemplate&&(a.checkedTemplate=!0),"undefined"===typeof a.uncheckedTemplate&&(a.uncheckedTemplate=!1);const l=e.getDataAtCell(r,n);!1===t?[a.checkedTemplate,a.checkedTemplate.toString()].includes(l)?i.push([r,n,a.uncheckedTemplate,s]):[a.uncheckedTemplate,a.uncheckedTemplate.toString(),null,void 0].includes(l)&&i.push([r,n,a.checkedTemplate,s]):i.push([r,n,a.uncheckedTemplate,s]),o+=1}n.push(o),o=0}i=i.every((e=>{let[,,t]=e;return t===i[0][2]}))?i.map((e=>{let[t,r,n]=e;return[t,r,n]})):i.map((e=>{let[t,r,,n]=e;return[t,r,n.checkedTemplate]})),i.length>0&&n.forEach((t=>{const r=i.splice(0,t);e.setDataAtCell(r)}))}}function f(){const t=e.getSelectedRange();if(t){for(let r=0;r<t.length;r++){const n=t[r].getTopStartCorner(),i=t[r].getBottomEndCorner();for(let t=n.row;t<=i.row;t++)for(let r=n.col;r<=i.col;r++){const n=e.getCellMeta(t,r);if("checkbox"!==n.type)return!1;const i=e.getCell(t,r);if(null===i||void 0===i)return!0;if(i.querySelectorAll("input[type=checkbox]").length>0&&!n.readOnly)return!0}}return!1}}(!u||u&&!u.separated)&&t.appendChild(c),h&&t.appendChild(s.createTextNode("#bad-value#")),Kb.has(e)||(Kb.set(e,!0),function(){const t=e.getShortcutManager().getContext("grid"),r={group:Qb,relativeToGroup:zp,position:"before"};t.addShortcuts([{keys:[["space"]],callback:()=>(d(),!f()),runOnlyIf:()=>{var t;return null===(t=e.getSelectedRangeLast())||void 0===t?void 0:t.highlight.isCell()}},{keys:[["enter"]],callback:()=>(d(),!f()),runOnlyIf:()=>{const t=e.getSelectedRangeLast();return e.getSettings().enterBeginsEditing&&(null===t||void 0===t?void 0:t.isSingle())&&t.highlight.isCell()}},{keys:[["delete"],["backspace"]],callback:()=>(d(!0),!f()),runOnlyIf:()=>{var t;return null===(t=e.getSelectedRangeLast())||void 0===t?void 0:t.highlight.isCell()}}],r)}())}function ry(e){return"INPUT"===e.tagName&&"checkbox"===e.getAttribute("type")}Ko.getSingleton().add("modifyAutoColumnSizeSeed",(function(e,t,r){const{label:n,type:i,row:o,column:a,prop:s}=t;if(i===ey){if(n){const{value:t,property:i}=n;let l=r;if(t)l="function"===typeof t?t(o,a,s,r):t;else if(i){const e=this.getDataAtRowProp(o,i);l=null!==e?e:r}e=l}return e}})),ty.RENDERER_TYPE=ey;function ny(e,t,r,n,i,o,a){Gb.apply(this,[e,t,r,n,i,o,a])}ny.RENDERER_TYPE="handsontable";var iy=__webpack_require__(407);function oy(e,t){if(Ua(e)){const r=t.numericFormat,n=r&&r.culture||"-",i=r&&r.pattern;if("undefined"!==typeof n&&!iy.languages()[n]){const e=n.replace("-",""),t=iy.allLanguages?iy.allLanguages[n]:iy[e];t&&iy.registerLanguage(t)}iy.setLanguage(n),e=iy(e).format(i||"0")}return e}function ay(e,t,r,n,i,o,a){let s=o;if(Ua(s)){const e=a.className||"",r=e.length?e.split(" "):[];s=oy(s,a),r.indexOf("htLeft")<0&&r.indexOf("htCenter")<0&&r.indexOf("htRight")<0&&r.indexOf("htJustify")<0&&r.push("htRight"),r.indexOf("htNumeric")<0&&r.push("htNumeric"),a.className=r.join(" "),t.dir="ltr"}pv(e,t,r,n,i,s,a)}ay.RENDERER_TYPE="numeric";function sy(e,t,r,n,i,o,a){pv.apply(this,[e,t,r,n,i,o,a]);const s=a.hashLength||t.innerHTML.length,l=a.hashSymbol||"*";let c="";ja(s-1,(()=>{c+=l})),Kn(t,c)}sy.RENDERER_TYPE="password";function ly(e,t,r,n,i,o,a){pv.apply(this,[e,t,r,n,i,o,a])}ly.RENDERER_TYPE="select";function cy(e,t,r,n,i,o,a){pv.apply(this,[e,t,r,n,i,o,a]),t.dir="ltr"}cy.RENDERER_TYPE="time";function uy(e,t){let r=e;null!==r&&void 0!==r||(r=""),this.allowEmpty&&""===r?t(!0):this.strict&&this.source?"function"===typeof this.source?this.source(r,hy(r,t)):hy(r,t)(this.source):t(!0)}function hy(e,t){const r=e;return function(e){let n=!1;for(let t=0,i=e.length;t<i;t++)if(r===e[t]){n=!0;break}t(n)}}uy.VALIDATOR_TYPE="autocomplete";function dy(e,t){const r=ia(Db,this.instance);let n=e,i=!0;null!==n&&void 0!==n||(n="");let o=Ci(n,this.dateFormat||r.defaultDateFormat,!0).isValid(),a=Ci(new Date(n)).isValid()||o;if(this.allowEmpty&&""===n&&(a=!0,o=!0),a||(i=!1),!a&&o&&(i=!0),a&&!o)if(!0===this.correctFormat){const e=function(e,t){const r=Ci(function(e){const t=new Date(e);return isNaN(new Date(`${e}T00:00`).getDate())?t:new Date(t.getTime()+6e4*t.getTimezoneOffset())}(e)),n=Ci(e,t),i=e.search(/[A-z]/g)>-1;let o;o=r.isValid()&&r.format("x")===n.format("x")||!n.isValid()||i?r:n;return o.format(t)}(n,this.dateFormat);this.instance.setDataAtCell(this.visualRow,this.visualCol,e,"dateValidator"),i=!0}else i=!1;t(i)}dy.VALIDATOR_TYPE="date";function fy(e,t){uy.apply(this,[e,t])}fy.VALIDATOR_TYPE="dropdown";function gy(e,t){let r=e;null!==r&&void 0!==r||(r=""),this.allowEmpty&&""===r?t(!0):t(""!==r&&Ua(e))}gy.VALIDATOR_TYPE="numeric";const py=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"];function my(e,t){const r=this.timeFormat||"h:mm:ss a";let n=!0,i=e;null===i&&(i=""),i=/^\d{3,}$/.test(i)?parseInt(i,10):i;const o=/^\d{1,2}$/.test(i);o&&(i+=":00");const a=Ci(i,py,!0).isValid()?Ci(i):Ci(i,r);let s=a.isValid(),l=Ci(i,r,!0).isValid()&&!o;if(this.allowEmpty&&""===i&&(s=!0,l=!0),s||(n=!1),!s&&l&&(n=!0),s&&!l)if(!0===this.correctFormat){const e=a.format(r);this.instance.setDataAtCell(this.visualRow,this.visualCol,e,"timeValidator"),n=!0}else n=!1;t(n)}my.VALIDATOR_TYPE="time";const vy={CELL_TYPE:"autocomplete",editor:ab,renderer:Gb,validator:uy},by={CELL_TYPE:"checkbox",editor:sb,renderer:ty};function yy(e,t,r,n,i,o,a){Gb.apply(this,[e,t,r,n,i,o,a])}yy.RENDERER_TYPE="date";const wy={CELL_TYPE:"date",editor:Lb,renderer:yy,validator:dy},Sy={CELL_TYPE:"dropdown",editor:Hb,renderer:$b,validator:fy},Cy={CELL_TYPE:"handsontable",editor:tb,renderer:ny},ky={CELL_TYPE:"numeric",editor:Bb,renderer:ay,validator:gy,dataType:"number"},xy={CELL_TYPE:"password",editor:Ub,renderer:sy,copyable:!1},Ey={CELL_TYPE:"select",editor:Vb,renderer:ly},Ty={CELL_TYPE:"time",editor:zb,renderer:cy,validator:my};function _y(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ay(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ry(e,t){return e.get(Oy(e,t))}function Oy(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}const My=new Map([["plugin",function(e){return!!ns(e)}],["cell-type",sp],["editor",ea],["renderer",ss],["validator",gs]]),Iy=[];let Py=null;var Ny=new WeakMap,Dy=new WeakSet;class Fy{static get PLUGIN_KEY(){return"base"}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}constructor(e){!function(e,t){_y(e,t),t.add(e)}(this,Dy),Ay(this,"eventManager",new ca(this)),Ay(this,"pluginName",null),Ay(this,"pluginsInitializedCallbacks",[]),Ay(this,"isPluginsReady",!1),Ay(this,"enabled",!1),Ay(this,"initialized",!1),function(e,t,r){_y(e,t),t.set(e,r)}(this,Ny,{}),lo(this,"hot",e,{writable:!1}),Py=null,this.hot.addHook("afterPluginsInitialized",(()=>this.onAfterPluginsInitialized())),this.hot.addHook("afterUpdateSettings",(e=>this.onUpdateSettings(e))),this.hot.addHook("beforeInit",(()=>this.init()))}init(){this.pluginName=this.hot.getPluginName(this);const e=this.constructor.PLUGIN_DEPS,t=Array.isArray(e)?e:[];if(t.length>0){const e=[];if(t.forEach((t=>{const[r,n]=t.split(":");if(!My.has(r))throw new Error(`Unknown plugin dependency type "${r}" was found.`);My.get(r)(n)||e.push(` - ${n} (${r})`)})),e.length>0){const t=[`The ${this.pluginName} plugin requires the following modules:\n`,`${e.join("\n")}\n`].join("");Iy.push(t)}}Py||(Py=rs()),Py.indexOf("UndoRedo")>=0&&Py.splice(Py.indexOf("UndoRedo"),1),Py.indexOf(this.pluginName)>=0&&Py.splice(Py.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",(()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}));if(0===Py.length){if(Iy.length>0){const e=[`${Iy.join("\n")}\n`,"You have to import and register them manually."].join("");throw new Error(e)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var e;null===(e=this.eventManager)||void 0===e||e.clear(),this.clearHooks(),this.enabled=!1}addHook(e,t,r){Ry(Ny,this)[e]=Ry(Ny,this)[e]||[];const n=Ry(Ny,this)[e];this.hot.addHook(e,t,r),n.push(t),Ry(Ny,this)[e]=n}removeHooks(e){Ai(Ry(Ny,this)[e]||[],(t=>{this.hot.removeHook(e,t)}))}clearHooks(){const e=Ry(Ny,this);co(e,((e,t)=>this.removeHooks(t))),e.length=0}callOnPluginsReady(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}onAfterPluginsInitialized(){Ai(this.pluginsInitializedCallbacks,(e=>e())),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(e){const t=Oy(Dy,this,Ly).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&t&&this.updatePlugin(e))}updatePlugin(){}destroy(){var e;null===(e=this.eventManager)||void 0===e||e.destroy(),this.clearHooks(),co(this,((e,t)=>{"hot"!==t&&(this[t]=null)})),delete this.t,delete this.hot}}function Ly(e){if(!e)return!1;const t=this.constructor.SETTING_KEYS;if("boolean"===typeof t)return t;for(let r=0;r<t.length;r++)if(void 0!==e[t[r]])return!0;return!1}function Hy(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const By=class{constructor(e){Hy(this,"hot",null),Hy(this,"container",null),Hy(this,"injected",!1),Hy(this,"rows",[]),Hy(this,"columns",[]),Hy(this,"samples",null),Hy(this,"settings",{useHeaders:!0}),this.hot=e}addRow(e,t){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const r={row:e};this.rows.push(r),this.samples=t,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(e)),this.table.tr.appendChild(this.createRow(e)),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}addColumnHeadersRow(e){const t=this.hot.getColHeader(0);if(null!==t&&void 0!==t){const t={row:-1};this.rows.push(t),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),t.table=this.table.table}}addColumn(e,t){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const r={col:e};this.columns.push(r),this.samples=t,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&null!==this.hot.getColHeader(e)&&this.hot.view.appendColHeader(e,this.table.th),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),r.table=this.table.table}getHeights(e){this.injected||this.injectTable(),Ai(this.rows,(t=>{e(t.row,si(t.table)-1)}))}getWidths(e){this.injected||this.injectTable(),Ai(this.columns,(t=>{const{width:r}=t.table.getBoundingClientRect();e(t.col,Math.ceil(r))}))}setSettings(e){this.settings=e}setSetting(e,t){this.settings||(this.settings={}),this.settings[e]=t}getSettings(){return this.settings}getSetting(e){return this.settings?this.settings[e]:null}createColGroupsCol(e){const t=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&t.appendChild(this.createColElement(-1,-1)),this.samples.forEach((r=>{Ai(r.strings,(r=>{t.appendChild(this.createColElement(r.col,e))}))})),t}createRow(e){const{rootDocument:t}=this.hot,r=t.createDocumentFragment(),n=t.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,n),r.appendChild(n)),this.samples.forEach((n=>{Ai(n.strings,(n=>{const i=n.col,o=this.hot.getCellMeta(e,i),a=this.hot.getCellRenderer(o),s=t.createElement("td");s.setAttribute("ghost-table",1),a(this.hot,s,e,i,this.hot.colToProp(i),n.value,o),r.appendChild(s)}))})),r}appendColumnHeadersRow(){const{rootDocument:e}=this.hot,t=e.createDocumentFragment(),r=[];if(this.hot.hasRowHeaders()){const n=e.createElement("th");r.push([-1,n]),t.appendChild(n)}this.samples.forEach((n=>{Ai(n.strings,(n=>{const i=n.col,o=e.createElement("th");r.push([i,o]),t.appendChild(o)}))})),this.table.tHead.appendChild(t),Ai(r,(e=>{const[t,r]=e;this.hot.view.appendColHeader(t,r)}))}createCol(e){const{rootDocument:t}=this.hot,r=t.createDocumentFragment();return this.samples.forEach((n=>{Ai(n.strings,(n=>{const i=n.row,o=this.hot.getCellMeta(i,e),a=this.hot.getCellRenderer(o),s=t.createElement("td"),l=t.createElement("tr");s.setAttribute("ghost-table",1),a(this.hot,s,i,e,this.hot.colToProp(e),n.value,o),l.appendChild(s),r.appendChild(l)}))})),r}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(e,t){const r=this.hot.rootDocument.createElement("col");let n=0;t>=0&&e>=0&&(n=this.hot.getCellMeta(t,e).colspan);let i=this.hot.getColWidth(e);if(n>1)for(let o=e+1;o<e+n;o++)i+=this.hot.getColWidth(o);return r.style.width=`${i}px`,r}createTable(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";const{rootDocument:t}=this.hot,r=t.createDocumentFragment(),n=t.createElement("table"),i=t.createElement("thead"),o=t.createElement("tbody"),a=t.createElement("colgroup"),s=t.createElement("tr"),l=t.createElement("th");return this.isVertical()&&n.appendChild(a),this.isHorizontal()&&(s.appendChild(l),i.appendChild(s),n.style.tableLayout="auto",n.style.width="auto"),n.appendChild(i),this.isVertical()&&o.appendChild(s),n.appendChild(o),jn(n,e),r.appendChild(n),{fragment:r,table:n,tHead:i,tBody:o,colGroup:a,tr:s,th:l}}createContainer(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";const{rootDocument:t}=this.hot,r=t.createDocumentFragment(),n=t.createElement("div");return jn(n,`htGhostTable htAutoSize ${e.trim()}`),r.appendChild(n),{fragment:r,container:n}}isVertical(){return!(!this.rows.length||this.columns.length)}isHorizontal(){return!(!this.columns.length||this.rows.length)}};function Uy(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class jy{static get SAMPLE_COUNT(){return 3}constructor(e){Uy(this,"samples",null),Uy(this,"dataFactory",null),Uy(this,"customSampleCount",null),Uy(this,"allowDuplicates",!1),this.dataFactory=e}getSampleCount(){return this.customSampleCount?this.customSampleCount:jy.SAMPLE_COUNT}setSampleCount(e){this.customSampleCount=e}setAllowDuplicates(e){this.allowDuplicates=e}generateRowSamples(e,t){return this.generateSamples("row",t,e)}generateColumnSamples(e,t){return this.generateSamples("col",t,e)}generateSamples(e,t,r){const n=new Map,{from:i,to:o}="number"===typeof r?{from:r,to:r}:r;return ja(i,o,(r=>{const i=this.generateSample(e,t,r);n.set(r,i)})),n}generateSample(e,t,r){if("row"!==e&&"col"!==e)throw new Error("Unsupported sample type");const n=new Map,i="row"===e?"col":"row",o=[];return ja(t.from,t.to,(t=>{const a="row"===e?this.dataFactory(r,t):this.dataFactory(t,r);if(!1===a)return;const{value:s,bundleSeed:l}=a,c="string"===typeof l&&l.length>0;let u;u=c?l:so(s)?`${Object.keys(s).length}`:Array.isArray(s)?`${s.length}`:`${Pi(s).length}`,n.has(u)||n.set(u,{needed:this.getSampleCount(),strings:[]});const h=n.get(u);if(h.needed){(!(o.indexOf(s)>-1)||this.allowDuplicates||c)&&(h.strings.push({value:s,[i]:t}),o.push(s),h.needed-=1)}})),n}}const Wy=jy;function Vy(e,t,r){zy(e,t),t.set(e,r)}function zy(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qy(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Gy(e,t){return e.get(Ky(e,t))}function $y(e,t,r){return e.set(Ky(e,t),r),r}function Ky(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}Ko.getSingleton().register("modifyAutoColumnSizeSeed");const Yy="autoColumnSize";var Xy=new WeakMap,Jy=new WeakMap,Zy=new WeakSet;class Qy extends Fy{static get PLUGIN_KEY(){return Yy}static get PLUGIN_PRIORITY(){return 10}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(e){super(e),function(e,t){zy(e,t),t.add(e)}(this,Zy),qy(this,"ghostTable",new By(this.hot)),qy(this,"samplesGenerator",new Wy(((e,t)=>{const r=this.hot.toPhysicalRow(e),n=this.hot.toPhysicalColumn(t);if(this.hot.rowIndexMapper.isHidden(r)||this.hot.columnIndexMapper.isHidden(n))return!1;const i=this.hot.getCellMeta(e,t);let o="";i.spanned||(o=this.hot.getDataAtCell(e,t));let a="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(a=this.hot.runHooks("modifyAutoColumnSizeSeed",a,i,o)),{value:o,bundleSeed:a}}))),qy(this,"inProgress",!1),qy(this,"measuredColumns",0),qy(this,"columnWidthsMap",new Oh),Vy(this,Xy,[]),Vy(this,Jy,[]),this.hot.columnIndexMapper.registerMap("autoColumnSize",this.columnWidthsMap),this.addHook("beforeColumnResize",((e,t,r)=>Ky(Zy,this,iw).call(this,e,t,r)))}isEnabled(){return!1!==this.hot.getSettings()[Yy]&&!this.hot.getSettings().colWidths}enablePlugin(){var e=this;if(this.enabled)return;const t=this.hot.getSettings()[Yy];t&&null!==t.useHeaders&&void 0!==t.useHeaders&&this.ghostTable.setSetting("useHeaders",t.useHeaders),this.setSamplingOptions(),this.addHook("afterLoadData",(function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return Ky(Zy,e,rw).call(e,...r)})),this.addHook("beforeChangeRender",(function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return Ky(Zy,e,nw).call(e,...r)})),this.addHook("afterFormulasValuesUpdate",(function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return Ky(Zy,e,aw).call(e,...r)})),this.addHook("beforeRender",(()=>Ky(Zy,this,tw).call(this))),this.addHook("modifyColWidth",((e,t)=>this.getColumnWidth(t,e))),this.addHook("init",(()=>Ky(Zy,this,ow).call(this))),super.enablePlugin()}updatePlugin(){$y(Jy,this,this.findColumnsWhereHeaderWasChanged()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",((e,t,r)=>Ky(Zy,this,iw).call(this,e,t,r)))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;const e=this.getFirstVisibleColumn(),t=this.getLastVisibleColumn();if(-1===e||-1===t)return;const r=this.hot.renderCall;this.calculateColumnsWidth({from:e,to:t},void 0,r)}calculateColumnsWidth(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countCols()-1},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{from:0,to:this.hot.countRows()-1},r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n="number"===typeof e?{from:e,to:e}:e,i="number"===typeof t?{from:t,to:t}:t;ja(n.from,n.to,(e=>{let t=this.hot.toPhysicalColumn(e);if(null===t&&(t=e),r||null===this.columnWidthsMap.getValueAtIndex(t)&&!this.hot._getColWidthFromSettings(t)){this.samplesGenerator.generateColumnSamples(e,i).forEach(((e,t)=>this.ghostTable.addColumn(t,e)))}})),this.ghostTable.columns.length&&(this.hot.batchExecution((()=>{this.ghostTable.getWidths(((e,t)=>{const r=this.hot.toPhysicalColumn(e);this.columnWidthsMap.setValueAtIndex(r,t)}))}),!0),this.measuredColumns=n.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countRows()-1},t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=0;const n=this.hot.countCols()-1;let i=null;this.inProgress=!0;const o=()=>{if(!this.hot)return mo(i),void(this.inProgress=!1);this.calculateColumnsWidth({from:r,to:Math.min(r+Qy.CALCULATION_STEP,n)},e,t),r=r+Qy.CALCULATION_STEP+1,r<n?i=po(o):(mo(i),this.inProgress=!1,this.hot.view.adjustElementsSize())},a=this.getSyncCalculationLimit();a>=0&&(this.calculateColumnsWidth({from:0,to:a},e,t),r=a+1),r<n?o():this.inProgress=!1}setSamplingOptions(){const e=this.hot.getSettings()[Yy],t=e&&go(e,"samplingRatio")?e.samplingRatio:void 0,r=e&&go(e,"allowSampleDuplicates")?e.allowSampleDuplicates:void 0;t&&!isNaN(t)&&this.samplesGenerator.setSampleCount(parseInt(t,10)),r&&this.samplesGenerator.setAllowDuplicates(r)}recalculateAllColumnsWidth(){this.hot.view.isVisible()&&this.calculateAllColumnsWidth({from:0,to:this.hot.countRows()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[Yy];let t=Qy.SYNC_CALCULATION_LIMIT;const r=this.hot.countCols()-1;return so(e)&&(t=e.syncLimit,dn(t)?t=Va(r,t):t>>=0),Math.min(t,r)}getColumnWidth(e,t){let r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=t;return void 0===n&&(n=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),r&&"number"===typeof n&&(n=Math.max(n,ul))),n}getFirstVisibleColumn(){var e;return null!==(e=this.hot.view.getFirstRenderedVisibleColumn())&&void 0!==e?e:-1}getLastVisibleColumn(){var e;return null!==(e=this.hot.view.getLastRenderedVisibleColumn())&&void 0!==e?e:-1}findColumnsWhereHeaderWasChanged(){return this.hot.getColHeader().reduce(((e,t,r)=>{const n=Gy(Xy,this).length;return(n-1<r||Gy(Xy,this)[r]!==t)&&e.push(this.hot.toVisualColumn(r)),n-1<r?Gy(Xy,this).push(t):Gy(Xy,this)[r]=t,e}),[])}clearCache(e){Array.isArray(e)?this.hot.batchExecution((()=>{e.forEach((e=>{this.columnWidthsMap.setValueAtIndex(e,null)}))}),!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!this.columnWidthsMap.getValues().slice(0,this.measuredColumns).filter((e=>null===e)).length}destroy(){this.ghostTable.clean(),super.destroy()}}function ew(e){const t={from:0,to:this.hot.countRows()-1};e.forEach((e=>{const r=this.hot.toPhysicalColumn(e);if(null!==r&&!this.hot._getColWidthFromSettings(r)){this.samplesGenerator.generateColumnSamples(e,t).forEach(((e,t)=>this.ghostTable.addColumn(t,e)))}})),this.ghostTable.columns.length&&(this.hot.batchExecution((()=>{this.ghostTable.getWidths(((e,t)=>{const r=this.hot.toPhysicalColumn(e);this.columnWidthsMap.setValueAtIndex(r,t)}))}),!0),this.ghostTable.clean())}function tw(){this.calculateVisibleColumnsWidth(),this.inProgress||(Ky(Zy,this,ew).call(this,Gy(Jy,this)),$y(Jy,this,[]))}function rw(e,t){t||this.recalculateAllColumnsWidth()}function nw(e){const t=e.reduce(((e,t)=>{let[,r]=t;const n=this.hot.propToCol(r);return Number.isInteger(n)&&-1===e.indexOf(n)&&e.push(n),e}),[]);Gy(Jy,this).push(...t)}function iw(e,t,r){let n=e;return r&&(this.calculateColumnsWidth(t,void 0,!0),n=this.getColumnWidth(t,void 0,!1)),n}function ow(){$y(Xy,this,this.hot.getColHeader()),this.recalculateAllColumnsWidth()}function aw(e){const t=e.reduce(((e,t)=>{var r;const n=null===(r=t.address)||void 0===r?void 0:r.col;if(Number.isInteger(n)){const t=this.hot.toVisualColumn(n);-1===e.indexOf(t)&&e.push(t)}return e}),[]);Gy(Jy,this).push(...t)}const sw={horizontal:"horizontal",vertical:"vertical"};function lw(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function cw(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function uw(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}Ko.getSingleton().register("modifyAutofillRange"),Ko.getSingleton().register("beforeAutofill"),Ko.getSingleton().register("afterAutofill");const hw="autofill",dw=["fillHandle"];var fw=new WeakSet;class gw extends Fy{constructor(){super(...arguments),lw(this,fw),cw(this,"addingStarted",!1),cw(this,"mouseDownOnCellCorner",!1),cw(this,"mouseDragOutside",!1),cw(this,"handleDraggedCells",0),cw(this,"directions",[]),cw(this,"autoInsertRow",!1)}static get PLUGIN_KEY(){return hw}static get PLUGIN_PRIORITY(){return 20}static get SETTING_KEYS(){return[hw,...dw]}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",(e=>uw(fw,this,mw).call(this,e))),this.addHook("afterOnCellCornerDblClick",(e=>uw(fw,this,pw).call(this,e))),this.addHook("beforeOnCellMouseOver",((e,t)=>uw(fw,this,vw).call(this,t))),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){const e=this.hot.getSelectedRangeLast(),{row:t,col:r}=e.getTopStartCorner(),{row:n,col:i}=e.getBottomEndCorner(),o=this.hot.runHooks("modifyCopyableRange",[{startRow:t,startCol:r,endRow:n,endCol:i}]),a=[],s=[],l=[];return Ai(o,(e=>{for(let t=e.startRow;t<=e.endRow;t+=1)-1===a.indexOf(t)&&a.push(t);for(let t=e.startCol;t<=e.endCol;t+=1)-1===s.indexOf(t)&&s.push(t)})),Ai(a,(e=>{const t=[];Ai(s,(r=>{t.push(this.hot.getCopyableData(e,r))})),l.push(t)})),l}fillIn(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;const[e,t,r,n]=this.hot.selection.highlight.getFill().getVisualCorners(),i=this.hot.getSelectedRangeLast(),o=i.getTopStartCorner(),a=i.getBottomEndCorner();this.resetSelectionOfDraggedArea();const s=[o.row,o.col,a.row,a.col],l=this.hot.runHooks("modifyAutofillRange",[Math.min(o.row,e),Math.min(o.col,t),Math.max(a.row,r),Math.max(a.col,n)],s),{directionOfDrag:c,startOfDragCoords:u,endOfDragCoords:h}=function(e,t,r){let n,i,o;return t[0]===e[0]&&t[1]<e[1]?(o="left",n=r(t[0],t[1]),i=r(t[2],e[1]-1)):t[2]===e[2]&&t[0]===e[0]&&t[3]>e[3]?(o="right",n=r(t[0],e[3]+1),i=r(t[2],t[3])):t[0]<e[0]&&t[1]===e[1]?(o="up",n=r(t[0],t[1]),i=r(e[0]-1,t[3])):t[2]>e[2]&&t[1]===e[1]&&(o="down",n=r(e[2]+1,t[1]),i=r(t[2],t[3])),n&&n.normalize(),i&&i.normalize(),{directionOfDrag:o,startOfDragCoords:n,endOfDragCoords:i}}(s,l,((e,t)=>this.hot._createCellCoords(e,t)));if(u&&u.row>-1&&u.col>-1){const e=this.getSelectionData(),t=i.clone(),r=this.hot._createCellRange(u,u,h),n=this.hot.runHooks("beforeAutofill",e,t,r,c);if(!1===n)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let o=n;const a=n;if(["up","left"].indexOf(c)>-1&&(1!==a.length||0!==a[0].length))if(o=[],"up"===c){const e=h.row-u.row+1,t=e%a.length;for(let r=0;r<e;r++)o.push(a[(r+(a.length-t))%a.length])}else{const e=h.col-u.col+1,t=e%a[0].length;for(let r=0;r<a.length;r++){o.push([]);for(let n=0;n<e;n++)o[r].push(a[r][(n+(a[r].length-t))%a[r].length])}}this.hot.populateFromArray(u.row,u.col,o,h.row,h.col,`${this.pluginName}.fill`,null),this.setSelection(l),this.hot.runHooks("afterAutofill",o,t,r,c),this.hot.render()}else this.hot.view.render();return!0}reduceSelectionAreaIfNeeded(e){return e.row<0&&(e.row=0),e.col<0&&(e.col=0),e}getCoordsOfDragAndDropBorders(e){const t=this.hot.getSelectedRangeLast(),r=t.getBottomEndCorner();let n=e;if(this.directions.includes(sw.vertical)&&this.directions.includes(sw.horizontal)){const i=t.getTopStartCorner();(r.col<=e.col||i.col>=e.col)&&(n=this.hot._createCellCoords(r.row,e.col)),(r.row<e.row||i.row>e.row)&&(n=this.hot._createCellCoords(e.row,r.col))}else if(this.directions.includes(sw.vertical))n=this.hot._createCellCoords(e.row,r.col);else{if(!this.directions.includes(sw.horizontal))return;n=this.hot._createCellCoords(r.row,e.col)}return this.reduceSelectionAreaIfNeeded(n)}showBorder(e){const t=this.getCoordsOfDragAndDropBorders(e);t&&this.redrawBorders(t)}addRow(){this.hot._registerTimeout((()=>{this.hot.alter("insert_row_below",void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1}),200)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&!1===this.addingStarted&&this.autoInsertRow){const e=this.hot.getSelectedLast(),t=this.hot.selection.highlight.getFill().getVisualCorners(),r=this.hot.countRows();e[2]<r-1&&t[2]===r-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(e){const t=this.hot.getData(),r=this.hot.countRows();let n;for(let i=e[2]+1;i<r;i++){for(let n=e[1];n<=e[3];n++){if(!Fi(t[i][n]))return-1}const r=t[i][e[1]-1],o=t[i][e[3]+1];Fi(r)&&Fi(o)||(n=i)}return n}addSelectionFromStartAreaToSpecificRowIndex(e,t){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(e[0],e[1])).add(this.hot._createCellCoords(t,e[3])).commit()}setSelection(e){this.hot.selectCell(..._i(e,(e=>Math.max(e,0))),!1,!1)}selectAdjacent(){const e=this.hot.getSelectedLast(),t=this.getIndexOfLastAdjacentFilledInRow(e);return-1!==t&&void 0!==t&&(this.addSelectionFromStartAreaToSpecificRowIndex(e,t),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(e){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(e).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(e){const{documentElement:t}=this.hot.rootDocument,r=Jn(this.hot.table).top-(this.hot.rootWindow.pageYOffset||t.scrollTop)+si(this.hot.table),n=Jn(this.hot.table).left-(this.hot.rootWindow.pageXOffset||t.scrollLeft)+ai(this.hot.table);return e.clientY>r&&e.clientX<=n}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mouseup",(()=>uw(fw,this,bw).call(this))),this.eventManager.addEventListener(e,"mousemove",(e=>uw(fw,this,yw).call(this,e)))}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){const e=function(e){const t={};return!0===e?(t.directions=Object.keys(sw),t.autoInsertRow=!0):so(e)?(Ni(e.autoInsertRow)?e.direction===sw.horizontal?t.autoInsertRow=!1:t.autoInsertRow=e.autoInsertRow:t.autoInsertRow=!1,Ni(e.direction)?t.directions=[e.direction]:t.directions=Object.keys(sw)):"string"===typeof e?(t.directions=[e],t.autoInsertRow=!0):(t.directions=[],t.autoInsertRow=!1),t}(this.hot.getSettings().fillHandle);this.directions=e.directions,this.autoInsertRow=e.autoInsertRow}destroy(){super.destroy()}}function pw(){this.selectAdjacent()&&this.fillIn()}function mw(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}function vw(e){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(e),this.addNewRowIfNeeded())}function bw(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}function yw(e){const t=this.getIfMouseWasDraggedOutside(e);!1===this.addingStarted&&this.handleDraggedCells>0&&t?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}function ww(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Sw(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Cw(e,t){return e.get(kw(e,t))}function kw(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}const xw="autoRowSize";var Ew=new WeakMap,Tw=new WeakSet;class _w extends Fy{static get PLUGIN_KEY(){return xw}static get PLUGIN_PRIORITY(){return 40}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(e){super(e),function(e,t){ww(e,t),t.add(e)}(this,Tw),Sw(this,"headerHeight",null),Sw(this,"ghostTable",new By(this.hot)),Sw(this,"samplesGenerator",new Wy(((e,t)=>{const r=this.hot.toPhysicalRow(e),n=this.hot.toPhysicalColumn(t);if(this.hot.rowIndexMapper.isHidden(r)||this.hot.columnIndexMapper.isHidden(n))return!1;if(e>=0&&t>=0){if(this.hot.getCellMeta(e,t).hidden)return!1}let i;return e>=0?i=this.hot.getDataAtCell(e,t):-1===e&&(i=this.hot.getColHeader(t)),{value:i}}))),Sw(this,"inProgress",!1),Sw(this,"measuredRows",0),Sw(this,"rowHeightsMap",new Oh),function(e,t,r){ww(e,t),t.set(e,r)}(this,Ew,[]),this.hot.rowIndexMapper.registerMap("autoRowSize",this.rowHeightsMap),this.addHook("beforeRowResize",((e,t,r)=>kw(Tw,this,Ow).call(this,e,t,r)))}isEnabled(){const e=this.hot.getSettings()[xw];return!0===e||so(e)}enablePlugin(){var e=this;this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",(function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return kw(Tw,e,Mw).call(e,...r)})),this.addHook("beforeChangeRender",(function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return kw(Tw,e,Iw).call(e,...r)})),this.addHook("beforeColumnResize",(()=>this.recalculateAllRowsHeight())),this.addHook("afterFormulasValuesUpdate",(function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return kw(Tw,e,Nw).call(e,...r)})),this.addHook("beforeRender",(()=>kw(Tw,this,Rw).call(this))),this.addHook("modifyRowHeight",((e,t)=>this.getRowHeight(t,e))),this.addHook("init",(()=>kw(Tw,this,Pw).call(this))),this.addHook("modifyColumnHeaderHeight",(()=>this.getColumnHeaderHeight())),super.enablePlugin())}disablePlugin(){this.headerHeight=null,super.disablePlugin(),this.addHook("beforeRowResize",((e,t,r)=>kw(Tw,this,Ow).call(this,e,t,r)))}calculateVisibleRowsHeight(){if(!this.hot.countCols())return;const e=this.getFirstVisibleRow(),t=this.getLastVisibleRow();if(-1===e||-1===t)return;const r=this.hot.renderCall;this.calculateRowsHeight({from:e,to:t},void 0,r)}calculateRowsHeight(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countRows()-1},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{from:0,to:this.hot.countCols()-1},r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n="number"===typeof e?{from:e,to:e}:e,i="number"===typeof t?{from:t,to:t}:t;if(null!==this.hot.getColHeader(0)){const e=this.samplesGenerator.generateRowSamples(-1,i);this.ghostTable.addColumnHeadersRow(e.get(-1))}ja(n.from,n.to,(e=>{let t=this.hot.toPhysicalRow(e);if(null===t&&(t=e),r||null===this.rowHeightsMap.getValueAtIndex(t)){this.samplesGenerator.generateRowSamples(e,i).forEach(((e,t)=>this.ghostTable.addRow(t,e)))}})),this.ghostTable.rows.length&&(this.hot.batchExecution((()=>{this.ghostTable.getHeights(((e,t)=>{e<0?this.headerHeight=t:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(e),t)}))}),!0),this.measuredRows=n.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countCols()-1},t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=0;const n=this.hot.countRows()-1;let i=null;this.inProgress=!0;const o=()=>{if(!this.hot)return mo(i),void(this.inProgress=!1);this.calculateRowsHeight({from:r,to:Math.min(r+_w.CALCULATION_STEP,n)},e,t),r=r+_w.CALCULATION_STEP+1,r<n?i=po(o):(mo(i),this.inProgress=!1,this.hot.view.adjustElementsSize(),this.hot.view._wt.wtOverlays.inlineStartOverlay.needFullRender&&this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.draw())},a=this.getSyncCalculationLimit();a>=0&&(this.calculateRowsHeight({from:0,to:a},e,t),r=a+1),r<n?o():(this.inProgress=!1,this.hot.view.adjustElementsSize())}setSamplingOptions(){const e=this.hot.getSettings()[xw],t=e&&go(e,"samplingRatio")?e.samplingRatio:void 0,r=e&&go(e,"allowSampleDuplicates")?e.allowSampleDuplicates:void 0;t&&!isNaN(t)&&this.samplesGenerator.setSampleCount(parseInt(t,10)),r&&this.samplesGenerator.setAllowDuplicates(r)}recalculateAllRowsHeight(){this.hot.view.isVisible()&&this.calculateAllRowsHeight({from:0,to:this.hot.countCols()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[xw];let t=_w.SYNC_CALCULATION_LIMIT;const r=this.hot.countRows()-1;return so(e)&&(t=e.syncLimit,dn(t)?t=Va(r,t):t>>=0),Math.min(t,r)}getRowHeight(e,t){const r=e<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(e));let n=t;return null!==r&&r>(t||0)&&(n=r),n}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){var e;return null!==(e=this.hot.view.getFirstRenderedVisibleRow())&&void 0!==e?e:-1}getLastVisibleRow(){var e;return null!==(e=this.hot.view.getLastRenderedVisibleRow())&&void 0!==e?e:-1}clearCache(e){this.headerHeight=null,Array.isArray(e)?this.hot.batchExecution((()=>{e.forEach((e=>{this.rowHeightsMap.setValueAtIndex(e,null)}))}),!0):this.rowHeightsMap.clear()}clearCacheByRange(e){const{from:t,to:r}="number"===typeof e?{from:e,to:e}:e;this.hot.batchExecution((()=>{ja(Math.min(t,r),Math.max(t,r),(e=>{this.rowHeightsMap.setValueAtIndex(e,null)}))}),!0)}isNeedRecalculate(){return!!this.rowHeightsMap.getValues().slice(0,this.measuredRows).filter((e=>null===e)).length}destroy(){this.ghostTable.clean(),super.destroy()}}function Aw(e){const t={from:0,to:this.hot.countCols()-1};e.forEach((e=>{this.samplesGenerator.generateRowSamples(e,t).forEach(((e,t)=>this.ghostTable.addRow(t,e)))})),this.ghostTable.rows.length&&(this.hot.batchExecution((()=>{this.ghostTable.getHeights(((e,t)=>{const r=this.hot.toPhysicalRow(e);this.rowHeightsMap.setValueAtIndex(r,t)}))}),!0),this.ghostTable.clean())}function Rw(){this.calculateVisibleRowsHeight(),this.inProgress||(kw(Tw,this,Aw).call(this,Cw(Ew,this)),function(e,t,r){e.set(kw(e,t),r)}(Ew,this,[]))}function Ow(e,t,r){let n=e;return r&&(this.calculateRowsHeight(t,void 0,!0),n=this.getRowHeight(t)),n}function Mw(e,t){t||this.recalculateAllRowsHeight()}function Iw(e){const t=e.reduce(((e,t)=>{let[r]=t;return-1===e.indexOf(r)&&e.push(r),e}),[]);Cw(Ew,this).push(...t)}function Pw(){this.recalculateAllRowsHeight()}function Nw(e){const t=e.reduce(((e,t)=>{var r;const n=null===(r=t.address)||void 0===r?void 0:r.row;if(Number.isInteger(n)){const t=this.hot.toVisualRow(n);-1===e.indexOf(t)&&e.push(t)}return e}),[]);Cw(Ew,this).push(...t)}const Dw=new Map([["indexesSequence",{getListWithInsertedItems:kh,getListWithRemovedItems:xh}],["physicallyIndexed",{getListWithInsertedItems:Ah,getListWithRemovedItems:Rh}]]),Fw=e=>{if(!1===Dw.has(e))throw new Error(`Alter strategy with ID '${e}' does not exist.`);return Dw.get(e)},{getListWithInsertedItems:Lw,getListWithRemovedItems:Hw}=Fw("physicallyIndexed");const Bw=class extends Ch{constructor(){super((e=>e))}insert(e,t){const r=Th(this.indexedValues,t);this.indexedValues=Lw(r,e,t,this.initValueOrFn),super.insert(e,t)}remove(e){const t=Hw(this.indexedValues,e);this.indexedValues=Eh(t,e),super.remove(e)}},{getListWithInsertedItems:Uw,getListWithRemovedItems:jw}=Fw("physicallyIndexed");const Ww=class extends Ch{constructor(){super((e=>e))}insert(e,t){this.indexedValues=Uw(this.indexedValues,e,t,((e,t)=>this.getNextValue(t))),super.insert(e,t)}remove(e){this.indexedValues=jw(this.indexedValues,e),super.remove(e)}getNextValue(e){return Math.max(...this.getValues())+1+e}};function Vw(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function zw(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const qw="bindRowsWithHeaders",Gw=new Map([["loose",Bw],["strict",Ww]]);var $w=new WeakSet;class Kw extends Fy{constructor(){super(...arguments),Vw(this,$w),zw(this,"headerIndexes",null)}static get PLUGIN_KEY(){return qw}static get PLUGIN_PRIORITY(){return 210}isEnabled(){return!!this.hot.getSettings()[qw]}enablePlugin(){if(this.enabled)return;let e=this.hot.getSettings()[qw];"string"!==typeof e&&(e="loose");const t=Gw.get(e);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new t),this.addHook("modifyRowHeader",(e=>function(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}($w,this,Yw).call(this,e))),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}destroy(){super.destroy()}}function Yw(e){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(e))}function Xw(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Jw(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Zw(e,t){return e.get(eS(e,t))}function Qw(e,t,r){return e.set(eS(e,t),r),r}function eS(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}const tS="collapsibleColumns",rS=["nestedHeaders"],nS="collapsibleIndicator",iS=tS,oS=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]);var aS=new WeakMap,sS=new WeakSet;class lS extends Fy{constructor(){super(...arguments),function(e,t){Xw(e,t),t.add(e)}(this,sS),Jw(this,"nestedHeadersPlugin",null),Jw(this,"headerStateManager",null),function(e,t,r){Xw(e,t),t.set(e,r)}(this,aS,null)}static get PLUGIN_KEY(){return tS}static get PLUGIN_PRIORITY(){return 290}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[tS,...rS]}isEnabled(){return!!this.hot.getSettings()[tS]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:t}=this.hot.getSettings();t||Ho("You need to configure the Nested Headers plugin in order to use collapsible headers."),Qw(aS,this,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",(()=>eS(sS,this,hS).call(this))),this.addHook("afterLoadData",(function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return eS(sS,e,dS).call(e,...r)})),this.addHook("afterGetColHeader",(function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return eS(sS,e,cS).call(e,...r)})),this.addHook("beforeOnCellMouseDown",((e,t,r)=>eS(sS,this,uS).call(this,e,t,r))),this.registerShortcuts(),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){const{collapsibleColumns:e}=this.hot.getSettings();"boolean"===typeof e?this.headerStateManager.mapState((e=>({collapsible:e.origColspan>1}))):Array.isArray(e)&&(this.headerStateManager.mapState((()=>({collapsible:!1}))),this.headerStateManager.mergeStateWith(e))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),Qw(aS,this,null),this.nestedHeadersPlugin=null,this.unregisterShortcuts(),this.clearButtons(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{var e;const{row:t,col:r}=this.hot.getSelectedRangeLast().highlight,{collapsible:n,isCollapsed:i,columnIndex:o}=null!==(e=this.headerStateManager.getHeaderTreeNodeData(t,r))&&void 0!==e?e:{};if(n)return i?this.expandSection({row:t,col:o}):this.collapseSection({row:t,col:o}),!1},runOnlyIf:()=>{var e,t;return(null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.isSingle())&&(null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight.isHeader())},group:iS,relativeToGroup:zp,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(iS)}clearButtons(){if(!this.hot.view)return;const e=this.hot.view._wt.getSetting("columnHeaders").length,t=this.hot.view._wt.wtTable.THEAD,r=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,n=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,i=function(e){e&&e.parentNode.removeChild(e)};ja(0,e-1,(e=>{const o=t.childNodes[e],a=r.childNodes[e],s=n?n.childNodes[e]:null;ja(0,o.childNodes.length-1,(e=>{let t=o.childNodes[e].querySelector(`.${nS}`);i(t),a&&a.childNodes[e]&&(t=a.childNodes[e].querySelector(`.${nS}`),i(t)),n&&s&&s.childNodes[e]&&(t=s.childNodes[e].querySelector(`.${nS}`),i(t))}))}))}expandSection(e){this.toggleCollapsibleSection([e],"expand")}collapseSection(e){this.toggleCollapsibleSection([e],"collapse")}toggleAllCollapsibleSections(e){const t=this.headerStateManager.mapNodes((t=>{const{collapsible:r,origColspan:n,headerLevel:i,columnIndex:o,isCollapsed:a}=t;if(!0===r&&n>1&&(a&&"expand"===e||!a&&"collapse"===e))return{row:this.headerStateManager.levelToRowCoords(i),col:o}}));this.toggleCollapsibleSection(t,e)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(e,t){if(!oS.has(t))throw new Error(`Unsupported action is passed (${t}).`);if(!Array.isArray(e))return;const r=Ti(e,(e=>{let{row:t}=e;return t<0}));let n=r.length>0;Ai(r,(e=>{var r;let{row:i,col:o}=e;const{collapsible:a,isCollapsed:s}=null!==(r=this.headerStateManager.getHeaderSettings(i,o))&&void 0!==r?r:{};if(!a||s&&"collapse"===t||!s&&"expand"===t)return n=!1,!1}));const i=[],o=[];n&&Ai(r,(e=>{let{row:r,col:n}=e;const{colspanCompensation:a,affectedColumns:s,rollbackModification:l}=this.headerStateManager.triggerNodeModification(t,r,n);a>0&&(o.push(...s),i.push(l))}));const a=this.getCollapsedColumns();let s=[];"collapse"===t?s=Ri([...a,...o]):"expand"===t&&(s=Ti(a,(e=>!o.includes(e))));const l=oS.get(t);if(!1===this.hot.runHooks(l.beforeHook,a,s,n))return void Ai(i,(e=>{e()}));this.hot.batchExecution((()=>{Ai(o,(e=>{Zw(aS,this).setValueAtIndex(this.hot.toPhysicalColumn(e),l.hideColumn)}))}),!0);const c=this.getCollapsedColumns().length!==a.length,u=this.hot.getSelectedRangeLast();if("collapse"===t&&c&&u){const{row:e,col:t}=u.highlight;if((this.hot.rowIndexMapper.isHidden(e)||this.hot.columnIndexMapper.isHidden(t))&&o.includes(t)){const r=e>=0?this.hot.rowIndexMapper.getNearestNotHiddenIndex(e,1,!0):e,n=t>=0?this.hot.columnIndexMapper.getNearestNotHiddenIndex(t,1,!0):t;null!==r&&null!==n&&this.hot.selectCell(r,n)}}this.hot.runHooks(l.afterHook,a,s,n,c),this.hot.render(),this.hot.view.adjustElementsSize()}getCollapsedColumns(){return Zw(aS,this).getHiddenIndexes()}destroy(){Qw(aS,this,null),super.destroy()}}function cS(e,t,r){var n;const{collapsible:i,origColspan:o,isCollapsed:a}=null!==(n=this.headerStateManager.getHeaderSettings(r,e))&&void 0!==n?n:{},s=i&&o>1&&e>=this.hot.getSettings().fixedColumnsStart,l=this.hot.getSettings().ariaTags;let c=t.querySelector(`.${nS}`);var u;(zn(t,[Tn("")[0]]),s)?(c||(c=this.hot.rootDocument.createElement("div"),jn(c,nS),t.querySelector("div:first-child").appendChild(c)),Wn(c,["collapsed","expanded"]),a?(jn(c,"collapsed"),Yn(c,"+"),l&&Vn(t,...Tn(!1))):(jn(c,"expanded"),Yn(c,"-"),l&&Vn(t,...Tn(!0))),l&&Vn(c,...wn())):null===(u=c)||void 0===u||u.remove()}function uS(e,t){Un(e.target,nS)&&(Un(e.target,"expanded")?(this.eventManager.fireEvent(e.target,"mouseup"),this.toggleCollapsibleSection([t],"collapse")):Un(e.target,"collapsed")&&(this.eventManager.fireEvent(e.target,"mouseup"),this.toggleCollapsibleSection([t],"expand")),No(e))}function hS(){this.updatePlugin()}function dS(e,t){t||this.updatePlugin()}function fS(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const gS=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"];class pS{constructor(e,t){fS(this,"hot",void 0),fS(this,"sortingStates",new Ph),fS(this,"sortEmptyCells",false),fS(this,"indicator",true),fS(this,"headerAction",true),fS(this,"compareFunctionFactory",void 0),fS(this,"mapName",void 0),this.hot=e,this.mapName=t,this.hot.columnIndexMapper.registerMap(t,this.sortingStates)}updateAllColumnsProperties(e){so(e)&&co(e,((e,t)=>{gS.includes(t)&&(this[t]=e)}))}getAllColumnsProperties(){const e={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return"function"===typeof this.compareFunctionFactory&&(e.compareFunctionFactory=this.compareFunctionFactory),e}getSortOrderOfColumn(e){var t;return null===(t=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))||void 0===t?void 0:t.sortOrder}getIndexOfColumnInSortQueue(e){return e=this.hot.toPhysicalColumn(e),this.sortingStates.getEntries().findIndex((t=>{let[r]=t;return r===e}))}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return 0===this.getNumberOfSortedColumns()}isColumnSorted(e){return so(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))}getSortStates(){if(null===this.sortingStates)return[];return this.sortingStates.getEntries().map((e=>{let[t,r]=e;return{column:this.hot.toVisualColumn(t),...r}}))}getColumnSortState(e){const t=this.getSortOrderOfColumn(e);if(Ni(t))return{column:e,sortOrder:t}}setSortStates(e){this.sortingStates.clear();for(let t=0;t<e.length;t+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(e[t].column),{sortOrder:e[t].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}function mS(e,t,r){const n=t.locale;return function(t,i){const{sortEmptyCells:o}=r;return"string"===typeof t&&(t=t.toLocaleLowerCase(n)),"string"===typeof i&&(i=i.toLocaleLowerCase(n)),t===i?xS:Fi(t)?Fi(i)?xS:o&&"asc"===e?ES:TS:Fi(i)?o&&"asc"===e?TS:ES:isNaN(t)&&!isNaN(i)?"asc"===e?TS:ES:!isNaN(t)&&isNaN(i)?"asc"===e?ES:TS:(isNaN(t)||isNaN(i)||(t=parseFloat(t),i=parseFloat(i)),t<i?"asc"===e?ES:TS:t>i?"asc"===e?TS:ES:xS)}}const vS="default";const{register:bS,getItem:yS,hasItem:wS}=Xo("sorting.compareFunctionFactory"),{register:SS,getItem:CS}=Xo("sorting.mainSortComparator");function kS(e){return wS(e)?yS(e):yS(vS)}bS("checkbox",(function(e,t,r){const n=t.checkedTemplate,i=t.uncheckedTemplate,{sortEmptyCells:o}=r;return function(a,s){const l=Fi(a),c=Fi(s),u=l?i:a,h=c?i:s,d=u===i||u===n,f=h===i||h===n;if(!1===o){if(l&&!1===c)return TS;if(!1===l&&c)return ES}return!1===d&&f?"asc"===e?ES:TS:d&&!1===f?"asc"===e?TS:ES:!1===d&&!1===f?mS(e,t,r)(a,s):u===i&&h===n?"asc"===e?ES:TS:u===n&&h===i?"asc"===e?TS:ES:xS}})),bS("date",(function(e,t,r){return DS(e,t.dateFormat,r)})),bS(vS,mS),bS("numeric",(function(e,t,r){return function(t,n){const i=parseFloat(t),o=parseFloat(n),{sortEmptyCells:a}=r;if(i===o||isNaN(i)&&isNaN(o))return xS;if(a){if(Fi(t))return"asc"===e?ES:TS;if(Fi(n))return"asc"===e?TS:ES}return isNaN(i)?TS:isNaN(o)?ES:i<o?"asc"===e?ES:TS:i>o?"asc"===e?TS:ES:xS}})),bS("time",(function(e,t,r){return DS(e,t.timeFormat,r)}));const xS=0,ES=-1,TS=1;const _S="asc",AS="desc",RS="colHeader";function OS(e){if(e.some((e=>!1===function(e){if(!1===so(e))return!1;const{column:t,sortOrder:r}=e;return Number.isInteger(t)&&[_S,AS].includes(r)}(e))))return!1;const t=e.map((e=>{let{column:t}=e;return t}));return new Set(t).size===t.length}function MS(e){if(e!==AS)return e===_S?AS:_S}function IS(e){return e.querySelector(`.${RS}`)}function PS(e,t){if(e<0||!t.parentNode)return!1;const r=t.parentNode.parentNode.childNodes;return-1===Array.from(r).indexOf(t.parentNode)-r.length}function NS(e,t,r){return-1===e&&t>=0&&!1===Fo(r)}function DS(e,t,r){return function(n,i){const{sortEmptyCells:o}=r;if(n===i)return xS;if(Fi(n))return Fi(i)?xS:o&&"asc"===e?ES:TS;if(Fi(i))return o&&"asc"===e?TS:ES;const a=Ci(n,t),s=Ci(i,t);return a.isValid()?s.isValid()?s.isAfter(a)?"asc"===e?ES:TS:s.isBefore(a)?"asc"===e?TS:ES:xS:ES:TS}}const FS="indicatorDisabled",LS="columnSorting",HS="sortAction",BS=new Map([[_S,"ascending"],[AS,"descending"]]);function US(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function jS(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function WS(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}const VS="columnSorting",zS="append",qS=VS;SS(VS,(function(e,t){return function(r,n){const[,...i]=r,[,...o]=n;return function(r){const n=e[r],a=t[r],s=i[r],l=o[r],c=a.columnSorting;return(c.compareFunctionFactory?c.compareFunctionFactory:kS(a.type))(n,a,c)(s,l)}(0)}})),Ko.getSingleton().register("beforeColumnSort"),Ko.getSingleton().register("afterColumnSort");var GS=new WeakSet;class $S extends Fy{constructor(){super(...arguments),US(this,GS),jS(this,"columnStatesManager",null),jS(this,"columnMetaCache",null),jS(this,"pluginKey",VS),jS(this,"indexesSequenceCache",null)}static get PLUGIN_KEY(){return VS}static get PLUGIN_PRIORITY(){return 50}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var e=this;this.enabled||(this.columnStatesManager=new pS(this.hot,`${this.pluginKey}.sortingStates`),this.columnMetaCache=new Oh((e=>{let t=this.hot.toVisualColumn(e);return null===t&&(t=e),this.getMergedPluginSettings(t)})),this.hot.columnIndexMapper.registerMap(`${this.pluginKey}.columnMeta`,this.columnMetaCache),this.addHook("afterGetColHeader",((e,t)=>WS(GS,this,YS).call(this,e,t))),this.addHook("beforeOnCellMouseDown",(function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return WS(GS,e,JS).call(e,...r)})),this.addHook("afterOnCellMouseDown",((e,t)=>this.onAfterOnCellMouseDown(e,t))),this.addHook("afterInit",(()=>WS(GS,this,KS).call(this))),this.addHook("afterLoadData",(function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return WS(GS,e,XS).call(e,...r)})),this.hot.view&&WS(GS,this,KS).call(this),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){const e=(e,t)=>{const r=IS(t);!1!==PS(e,t)&&null!==r&&this.updateHeaderClasses(r)};this.hot.addHook("afterGetColHeader",e),this.hot.addHookOnce("afterViewRender",(()=>{this.hot.removeHook("afterGetColHeader",e)})),this.hot.batchExecution((()=>{null!==this.indexesSequenceCache&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey),this.indexesSequenceCache=null)}),!0),this.hot.columnIndexMapper.unregisterMap(`${this.pluginKey}.columnMeta`),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();return this.sort(this.getColumnNextConfig(e.col)),!1},runOnlyIf:()=>{var e,t;const r=null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.highlight;return r&&(null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.isSingle())&&this.hot.selection.isCellVisible(r)&&-1===r.row&&r.col>=0},relativeToGroup:zp,position:"before",group:qS})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(qS)}sort(e){const t=this.getSortConfig(),r=this.getNormalizedSortConfigs(e),n=this.areValidSortConfigs(r);!1!==this.hot.runHooks("beforeColumnSort",t,r,n)&&(0===t.length&&null===this.indexesSequenceCache&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new _h),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),n&&(this.columnStatesManager.setSortStates(r),this.sortByPresetSortStates(r),this.saveAllSortSettings(r)),this.hot.runHooks("afterColumnSort",t,n?r:t,n),n&&(this.hot.render(),this.hot.forceFullRender=!1,this.hot.view.render()))}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(e){return Ni(e)?this.columnStatesManager.getColumnSortState(e):this.columnStatesManager.getSortStates()}setSortConfig(e){const t=this.getNormalizedSortConfigs(e);this.areValidSortConfigs(t)&&this.columnStatesManager.setSortStates(t)}getNormalizedSortConfigs(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Array.isArray(e)?e.slice(0,1):[e]}areValidSortConfigs(e){const t=this.hot.countCols();return OS(e)&&e.every((e=>{let{column:r}=e;return r<=t&&r>=0}))}saveAllSortSettings(e){const t=this.columnStatesManager.getAllColumnsProperties();t.initialConfig=_i(e,(e=>{let{column:t,...r}=e;return{column:this.hot.toPhysicalColumn(t),...r}})),this.hot.runHooks("persistentStateSave","columnSorting",t)}getAllSavedSortSettings(){const e={};this.hot.runHooks("persistentStateLoad","columnSorting",e);const t=e.value,r=e=>{let{column:t,...r}=e;return{column:this.hot.toVisualColumn(t),...r}};return Ni(t)&&Array.isArray(t.initialConfig)&&(t.initialConfig=_i(t.initialConfig,r)),t}getColumnNextConfig(e){const t=this.columnStatesManager.getSortOrderOfColumn(e);if(Ni(t)){const r=MS(t);return Ni(r)?{column:e,sortOrder:r}:void 0}const r=this.hot.countCols();if(Number.isInteger(e)&&e>=0&&e<r)return{column:e,sortOrder:MS()}}getNextSortConfig(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:zS;const r=this.columnStatesManager.getIndexOfColumnInSortQueue(e),n=-1!==r,i=this.getSortConfig(),o=this.getColumnNextConfig(e);if(n){if(Di(o))return[...i.slice(0,r),...i.slice(r+1)];if(t===zS)return[...i.slice(0,r),...i.slice(r+1),o];if("replace"===t)return[...i.slice(0,r),o,...i.slice(r+1)]}return Ni(o)?i.concat(o):i}getPluginColumnConfig(e){if(so(e)){const t=e[this.pluginKey];if(so(t))return t}return{}}getMergedPluginSettings(e){const t=this.hot.getSettings()[this.pluginKey],r=this.columnStatesManager.getAllColumnsProperties(),n=this.hot.getCellMeta(0,e),i=Object.getPrototypeOf(n);return Array.isArray(i.columns)?Object.assign(r,t,this.getPluginColumnConfig(i.columns[e])):Yi(i.columns)?Object.assign(r,t,this.getPluginColumnConfig(i.columns(e))):Object.assign(r,t)}getFirstCellSettings(e){const t=this.hot.getCellMeta(0,e),r=Object.create(t);return r[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(e)),r}getNumberOfRowsToSort(e){const t=this.hot.getSettings();return t.maxRows<=e?t.maxRows:e-t.minSpareRows}sortByPresetSortStates(e){if(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),0===e.length)return;const t=[],r=this.hot.countRows(),n=t=>_i(e,(e=>this.hot.getDataAtCell(t,e.column)));for(let l=0;l<this.getNumberOfRowsToSort(r);l+=1)t.push([this.hot.toPhysicalRow(l)].concat(n(l)));const i=_i(t,(e=>e[0]));!function(e,t){const r=CS(t);for(var n=arguments.length,i=new Array(n>2?n-2:0),o=2;o<n;o++)i[o-2]=arguments[o];e.sort(r(...i))}(t,this.pluginKey,_i(e,(e=>e.sortOrder)),_i(e,(e=>this.getFirstCellSettings(e.column))));for(let l=t.length;l<r;l+=1)t.push([l].concat(n(l)));const o=_i(t,(e=>e[0])),a=new Map(_i(i,((e,t)=>[e,o[t]]))),s=_i(this.hot.rowIndexMapper.getIndexesSequence(),(e=>a.has(e)?a.get(e):e));this.hot.rowIndexMapper.setIndexesSequence(s)}sortBySettings(e){if(so(e)){this.columnStatesManager.updateAllColumnsProperties(e);const t=e.initialConfig;(Array.isArray(t)||so(t))&&this.sort(t)}else this.hot.render()}updateHeaderClasses(e){if(Wn(e,Array.from(BS.values()).concat(HS,FS,LS)),!1!==this.enabled){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];jn(e,function(e,t,r,n){const i=[LS];if(n&&i.push(HS),!1===r)return i.push(FS),i;const o=e.getSortOrderOfColumn(t);return Ni(o)&&i.push(BS.get(o)),i}(...r))}}onUpdateSettings(e){super.onUpdateSettings(),null!==this.columnMetaCache&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),Ni(e[this.pluginKey])&&this.sortBySettings(e[this.pluginKey])}wasClickableHeaderClicked(e,t){return this.getFirstCellSettings(t)[this.pluginKey].headerAction&&Un(e.target,RS)}onAfterOnCellMouseDown(e,t){!1!==NS(t.row,t.col,e)&&this.wasClickableHeaderClicked(e,t.col)&&(this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(t.col)),this.sort(this.getColumnNextConfig(t.col)))}destroy(){var e;null===(e=this.columnStatesManager)||void 0===e||e.destroy(),super.destroy()}}function KS(){const e=this.getAllSavedSortSettings();if(so(e))this.sortBySettings(e);else{const e=this.hot.getSettings()[this.pluginKey];this.sortBySettings(e)}}function YS(e,t){const r=IS(t);if(!1===PS(e,t)||null===r)return;const n=this.getFirstCellSettings(e)[this.pluginKey],i=n.indicator,o=n.headerAction;if(this.updateHeaderClasses(r,this.columnStatesManager,e,i,o),this.hot.getSettings().ariaTags){const r=this.columnStatesManager.getSortOrderOfColumn(e);Vn(t,...(a=r?`${r}ending`:"none",["aria-sort",a]))}var a}function XS(e){!0===e&&this.hot.view&&WS(GS,this,KS).call(this)}function JS(e,t,r,n){!1!==NS(t.row,t.col,e)&&this.wasClickableHeaderClicked(e,t.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(n.column=!0)}function ZS(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const QS=class{constructor(e,t){ZS(this,"plugin",void 0),ZS(this,"hot",void 0),ZS(this,"endpoints",[]),ZS(this,"settings",void 0),ZS(this,"settingsType","array"),ZS(this,"currentEndpoint",null),ZS(this,"cellsToSetCache",[]),this.plugin=e,this.hot=this.plugin.hot,this.settings=t}initEndpoints(){this.endpoints=this.parseSettings(),this.refreshAllEndpoints()}getEndpoint(e){return"function"===this.settingsType?this.fillMissingEndpointData(this.settings)[e]:this.endpoints[e]}getAllEndpoints(){return"function"===this.settingsType?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(e){return this.parseSettings(e.call(this))}parseSettings(e){const t=[];let r=e;if(r||"function"!==typeof this.settings)return r||(r=this.settings),Ai(r,(e=>{const r={};this.assignSetting(e,r,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(e,r,"reversedRowCoords",!1),this.assignSetting(e,r,"destinationRow",new Error("\n        You must provide a destination row for the Column Summary plugin in order to work properly!\n      ")),this.assignSetting(e,r,"destinationColumn",new Error("\n        You must provide a destination column for the Column Summary plugin in order to work properly!\n      ")),this.assignSetting(e,r,"sourceColumn",e.destinationColumn),this.assignSetting(e,r,"type","sum"),this.assignSetting(e,r,"forceNumeric",!1),this.assignSetting(e,r,"suppressDataTypeErrors",!0),this.assignSetting(e,r,"customFunction",null),this.assignSetting(e,r,"readOnly",!0),this.assignSetting(e,r,"roundFloat",!1),t.push(r)})),t;this.settingsType="function"}assignSetting(e,t,r,n){if("ranges"!==r||void 0!==e[r]){if("ranges"!==r||0!==e[r].length)if(void 0===e[r]){if(n instanceof Error)throw n;t[r]=n}else"destinationRow"===r&&t.reversedRowCoords?t[r]=this.hot.countRows()-e[r]-1:t[r]=e[r]}else t[r]=n}resetSetupBeforeStructureAlteration(e,t,r){if("function"!==this.settingsType)return;const n=e.indexOf("row")>-1?"row":"col",i=this.getAllEndpoints();Ai(i,(i=>{"row"===n&&i.destinationRow>=t&&("insert_row"===e?i.alterRowOffset=r:"remove_row"===e&&(i.alterRowOffset=-1*r)),"col"===n&&i.destinationColumn>=t&&("insert_col"===e?i.alterColumnOffset=r:"remove_col"===e&&(i.alterColumnOffset=-1*r))})),this.resetAllEndpoints(i,!1)}resetSetupAfterStructureAlteration(e,t,r,n,i){let o=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];if("function"===this.settingsType){const e=()=>(this.hot.removeHook("beforeViewRender",e),this.refreshAllEndpoints());return void this.hot.addHookOnce("beforeViewRender",e)}const a=e.indexOf("row")>-1?"row":"col",s=e.indexOf("remove")>-1?-1:1,l=this.getAllEndpoints(),c=0===e.indexOf("move_row"),u=t;Ai(l,(e=>{"row"===a&&e.destinationRow>=u&&(e.alterRowOffset=s*r),"col"===a&&e.destinationColumn>=u&&(e.alterColumnOffset=s*r)})),this.resetAllEndpoints(l,!c),Ai(l,c?e=>{this.extendEndpointRanges(e,u,n[0],n.length),this.recreatePhysicalRanges(e),this.clearOffsetInformation(e)}:e=>{this.shiftEndpointCoordinates(e,u)}),o&&this.refreshAllEndpoints()}clearOffsetInformation(e){e.alterRowOffset=void 0,e.alterColumnOffset=void 0}extendEndpointRanges(e,t,r,n){Ai(e.ranges,(e=>{e[1]&&(t>=e[0]&&t<=e[1]?r>e[1]?e[1]+=n:r<e[0]&&(e[0]-=n):r>=e[0]&&r<=e[1]&&(e[1]-=n,t<=e[0]&&(e[0]+=1,e[1]+=1)))}))}recreatePhysicalRanges(e){const t=e.ranges,r=[],n=[];Ai(t,(e=>{const t=[];if(e[1])for(let r=e[0];r<=e[1];r++)t.push(this.hot.toPhysicalRow(r));else t.push(this.hot.toPhysicalRow(e[0]));n.push(t)})),Ai(n,(e=>{let t=[];Ai(e,((n,i)=>{0===i?t.push(n):e[i]!==e[i-1]+1&&(t.push(e[i-1]),r.push(t),t=[],t.push(n)),i===e.length-1&&(t.push(n),r.push(t))}))})),e.ranges=r}shiftEndpointCoordinates(e,t){e.alterRowOffset&&0!==e.alterRowOffset?(e.destinationRow+=e.alterRowOffset||0,Ai(e.ranges,(r=>{Ai(r,((n,i)=>{n>=t&&(r[i]+=e.alterRowOffset||0)}))}))):e.alterColumnOffset&&0!==e.alterColumnOffset&&(e.destinationColumn+=e.alterColumnOffset||0,e.sourceColumn+=e.alterColumnOffset||0)}resetAllEndpoints(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getAllEndpoints(),t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e.some((e=>{const t=e.alterRowOffset||0,r=e.alterColumnOffset||0;return e.destinationRow+t>=this.hot.countRows()||e.destinationColumn+r>=this.hot.countCols()}))||(this.cellsToSetCache=[],Ai(e,(e=>{this.resetEndpointValue(e,t)})),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],Ai(this.getAllEndpoints(),(e=>{this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e,"init")})),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(e){const t=[];this.cellsToSetCache=[],Ai(e,((e,r,n)=>{`${e[2]||""}`!==`${e[3]}`&&Ai(this.getAllEndpoints(),((e,i)=>{this.hot.propToCol(n[r][1])===e.sourceColumn&&-1===t.indexOf(i)&&t.push(i)}))})),Ai(t,(e=>{this.refreshEndpoint(this.getEndpoint(e))})),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshCellMetas(){this.endpoints.forEach((e=>{const t=this.hot.toVisualRow(e.destinationRow);if(null!==t){const r=this.hot.getCellMeta(t,e.destinationColumn);r.readOnly=e.readOnly,r.className="columnSummaryResult"}}))}refreshEndpoint(e){this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e),this.currentEndpoint=null}resetEndpointValue(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const r=e.alterRowOffset||0,n=e.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(e.destinationRow+(t?r:0)),this.hot.toVisualColumn(e.destinationColumn+(t?n:0)),""])}setEndpointValue(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n=this.hot.toVisualRow(e.destinationRow);if(e.destinationRow>=this.hot.countRows()||e.destinationColumn>=this.hot.countCols())return void this.throwOutOfBoundsWarning();const i=this.hot.toVisualRow(e.destinationRow);if(null!==i){const r=this.hot.getCellMeta(i,e.destinationColumn);"init"!==t&&r.readOnly===e.readOnly||(r.readOnly=e.readOnly,r.className="columnSummaryResult")}if((!0===e.roundFloat||Number.isInteger(e.roundFloat))&&!isNaN(e.result)){const t=e.roundFloat;let r=0;Number.isInteger(t)&&(r=Math.min(Math.max(0,t),100)),e.result=e.result.toFixed(r)}r?this.hot.setDataAtCell(n,e.destinationColumn,e.result,"ColumnSummary.set"):this.cellsToSetCache.push([n,e.destinationColumn,e.result]),e.alterRowOffset=void 0,e.alterColumnOffset=void 0}throwOutOfBoundsWarning(){Ho("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}};function eC(e){return null===e||void 0===e||isNaN(e)}function tC(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function rC(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function nC(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}const iC="columnSummary";var oC=new WeakSet;class aC extends Fy{constructor(){super(...arguments),tC(this,oC),rC(this,"endpoints",null)}static get PLUGIN_KEY(){return iC}static get PLUGIN_PRIORITY(){return 220}isEnabled(){return!!this.hot.getSettings()[iC]}enablePlugin(){var e=this;this.enabled||(this.settings=this.hot.getSettings()[iC],this.endpoints=new QS(this,this.settings),this.addHook("afterInit",(function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return nC(oC,e,sC).call(e,...r)})),this.addHook("afterChange",(function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return nC(oC,e,cC).call(e,...r)})),this.addHook("afterUpdateSettings",(function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return nC(oC,e,lC).call(e,...r)})),this.addHook("beforeCreateRow",((e,t,r)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",e,t,null,r))),this.addHook("beforeCreateCol",((e,t,r)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",e,t,null,r))),this.addHook("beforeRemoveRow",(function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return e.endpoints.resetSetupBeforeStructureAlteration("remove_row",...r)})),this.addHook("beforeRemoveCol",(function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return e.endpoints.resetSetupBeforeStructureAlteration("remove_col",...r)})),this.addHook("afterCreateRow",((e,t,r)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",e,t,null,r))),this.addHook("afterCreateCol",((e,t,r)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",e,t,null,r))),this.addHook("afterRemoveRow",(function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return e.endpoints.resetSetupAfterStructureAlteration("remove_row",...r)})),this.addHook("afterRemoveCol",(function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return e.endpoints.resetSetupAfterStructureAlteration("remove_col",...r)})),this.addHook("afterRowMove",(function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return nC(oC,e,uC).call(e,...r)})),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.endpoints.initEndpoints(),super.updatePlugin()}calculate(e){switch(e.type.toLowerCase()){case"sum":e.result=this.calculateSum(e);break;case"min":case"max":e.result=this.calculateMinMax(e,e.type);break;case"count":e.result=this.countEntries(e);break;case"average":e.result=this.calculateAverage(e);break;case"custom":e.result=e.customFunction.call(this,e)}}calculateSum(e){let t=0;return co(e.ranges,(r=>{t+=this.getPartialSum(r,e.sourceColumn)})),t}getPartialSum(e,t){let r=0,n=e[1]||e[0],i=null,o=0;do{if(i=this.getCellValue(n,t),i=eC(i)?null:i,null!==i){const e=(`${i}`.split(".")[1]||[]).length||1;e>o&&(o=e)}r+=i||0,n-=1}while(n>=e[0]);return Math.round(r*10**o)/10**o}calculateMinMax(e,t){let r=null;return co(e.ranges,(n=>{const i=this.getPartialMinMax(n,e.sourceColumn,t);if(null===r&&null!==i&&(r=i),null!==i)switch(t){case"min":r=Math.min(r,i);break;case"max":r=Math.max(r,i)}})),null===r?"Not enough data":r}getPartialMinMax(e,t,r){let n,i=null,o=e[1]||e[0];do{if(n=this.getCellValue(o,t),n=eC(n)?null:n,null===i)i=n;else if(null!==n)switch(r){case"min":i=Math.min(i,n);break;case"max":i=Math.max(i,n)}o-=1}while(o>=e[0]);return i}countEmpty(e,t){let r,n=0,i=e[1]||e[0];do{r=this.getCellValue(i,t),r=eC(r)?null:r,null===r&&(n+=1),i-=1}while(i>=e[0]);return n}countEntries(e){let t=0;return co(e.ranges,(r=>{const n=void 0===r[1]?1:r[1]-r[0]+1,i=this.countEmpty(r,e.sourceColumn);t+=n,t-=i})),t}calculateAverage(e){return this.calculateSum(e)/this.countEntries(e)}getCellValue(e,t){const r=this.hot.toVisualRow(e),n=this.hot.toVisualColumn(t);let i=this.hot.getSourceDataAtCell(e,t),o="";if(null!==r&&null!==n&&(o=this.hot.getCellMeta(r,n).className||""),o.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&("string"===typeof i&&(i=i.replace(/,/,".")),i=parseFloat(i)),isNaN(i)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(Ii`ColumnSummary plugin: cell at (${e}, ${t}) is not in a\x20
          numeric format. Cannot do the calculation.`);return i}}function sC(){this.endpoints.initEndpoints()}function lC(e){void 0!==e.columns&&this.endpoints.refreshCellMetas()}function cC(e,t){e&&"ColumnSummary.reset"!==t&&"ColumnSummary.set"!==t&&"loadData"!==t&&this.endpoints.refreshChangedEndpoints(e)}function uC(e,t){this.endpoints.resetSetupBeforeStructureAlteration("move_row",e[0],e.length,e,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",t,e.length,e,this.pluginName)}function hC(e,t,r){dC(e,t),t.set(e,r)}function dC(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function fC(e,t){return e.get(pC(e,t))}function gC(e,t,r){return e.set(pC(e,t),r),r}function pC(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var mC=new WeakMap,vC=new WeakMap,bC=new WeakMap,yC=new WeakSet;class wC{constructor(){!function(e,t){dC(e,t),t.add(e)}(this,yC),hC(this,mC,!0),hC(this,vC,null),hC(this,bC,new ResizeObserver((e=>pC(yC,this,SC).call(this,e))))}setObservedElement(e){gC(vC,this,e)}unobserve(){fC(bC,this).unobserve(fC(vC,this))}observe(){gC(mC,this,!0),fC(bC,this).observe(fC(vC,this))}destroy(){fC(bC,this).disconnect()}}function SC(e){!fC(mC,this)&&Array.isArray(e)&&e.length?e.forEach((e=>{let{borderBoxSize:t}=e;const{inlineSize:r,blockSize:n}=t[0];this.runLocalHooks("resize",r,n)})):gC(mC,this,!1)}function CC(e,t,r){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,r)}function kC(e,t){return e.get(EC(e,t))}function xC(e,t,r){return e.set(EC(e,t),r),r}function EC(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}oo(wC,wh);var TC=new WeakMap,_C=new WeakMap,AC=new WeakMap,RC=new WeakMap,OC=new WeakMap,MC=new WeakMap,IC=new WeakMap;class PC{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(e,t){var r=this;CC(this,TC,void 0),CC(this,_C,!1),CC(this,AC,null),CC(this,RC,void 0),CC(this,OC,void 0),CC(this,MC,!0),CC(this,IC,new wC),xC(TC,this,e),xC(_C,this,t),xC(RC,this,this.createEditor()),xC(OC,this,kC(RC,this).style),kC(IC,this).setObservedElement(this.getInputElement()),kC(IC,this).addLocalHook("resize",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.runLocalHooks("resize",...t)})),this.hide()}setPosition(e,t){kC(OC,this).left=`${e}px`,kC(OC,this).top=`${t}px`}setSize(e,t){if(e&&t){const r=this.getInputElement();r.style.width=`${e}px`,r.style.height=`${t}px`}}getSize(){return{width:ai(this.getInputElement()),height:si(this.getInputElement())}}observeSize(){kC(IC,this).observe()}resetSize(){const e=this.getInputElement();e.style.width="",e.style.height=""}setReadOnlyState(e){this.getInputElement().readOnly=e}show(){kC(OC,this).display="block",xC(MC,this,!1)}hide(){kC(IC,this).unobserve(),kC(MC,this)||(kC(OC,this).display="none"),xC(MC,this,!0)}isVisible(){return"block"===kC(OC,this).display}setValue(){const e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"")||"";this.getInputElement().value=e}getValue(){return this.getInputElement().value}isFocused(){return kC(TC,this).activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){const e=kC(TC,this).createElement("div"),t=kC(TC,this).createElement("textarea");return e.style.display="none",xC(AC,this,kC(TC,this).createElement("div")),kC(AC,this).setAttribute("dir",kC(_C,this)?"rtl":"ltr"),jn(kC(AC,this),PC.CLASS_EDITOR_CONTAINER),kC(TC,this).body.appendChild(kC(AC,this)),jn(e,PC.CLASS_EDITOR),jn(t,PC.CLASS_INPUT),t.setAttribute("data-hot-input",!0),e.appendChild(t),kC(AC,this).appendChild(e),e}getInputElement(){return kC(RC,this).querySelector(`.${PC.CLASS_INPUT}`)}destroy(){const e=kC(AC,this)?kC(AC,this).parentNode:null;kC(RC,this).parentNode.removeChild(kC(RC,this)),xC(RC,this,null),xC(OC,this,null),kC(IC,this).destroy(),e&&e.removeChild(kC(AC,this))}}oo(PC,wh);const NC=PC;function DC(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class FC{constructor(e){DC(this,"wasLastActionShow",!0),DC(this,"showDebounced",null),DC(this,"hidingTimer",null),this.updateDelay(e)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout((()=>{!1===this.wasLastActionShow&&this.runLocalHooks("hide")}),250)}show(e){this.wasLastActionShow=!0,this.showDebounced(e)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:250;this.showDebounced=Xi((e=>{this.wasLastActionShow&&this.runLocalHooks("show",e.from.row,e.from.col)}),e)}destroy(){this.clearLocalHooks()}}oo(FC,wh);const LC=FC,HC="---------";function BC(e,t){const r={};return Ai(e,(e=>{e.forAll(((e,n)=>{e>=0&&n>=0&&(r[e]||(r[e]=[]),r[e][n]=t(e,n))}))})),r}function UC(e,t,r,n,i){Ai(e,(e=>{e.forAll(((e,o)=>{e>=0&&o>=0&&function(e,t,r,n,i,o){const a=i(e,t);let s=n;a.className&&(s="vertical"===r?function(e,t){return-1!==e.indexOf(t)?e:`${e.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")} ${t}`}(a.className,n):function(e,t){return-1!==e.indexOf(t)?e:`${e.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")} ${t}`}(a.className,n));o(e,t,"className",s)}(e,o,t,r,n,i)}))}))}function jC(e){return`<span class="selected">${String.fromCharCode(10003)}</span>${e}`}function WC(e,t){let r=!1;return Array.isArray(e)&&Ai(e,(e=>(e.forAll(((e,n)=>{if(e>=0&&n>=0&&t(e,n))return r=!0,!1})),r))),r}function VC(e,t){const r={top:0,left:0};if(t!==e.ownerDocument){const{frameElement:e}=t.defaultView,{top:n,left:i}=e.getBoundingClientRect();r.top=n,r.left=i}return r}function zC(e,t,r){qC(e,t),t.set(e,r)}function qC(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function GC(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $C(e,t,r){return e.set(YC(e,t),r),r}function KC(e,t){return e.get(YC(e,t))}function YC(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}const XC="comments",JC="comment",ZC="value",QC="style",ek="readOnly",tk=XC,rk=`plugin:${XC}`;var nk=new WeakMap,ik=new WeakMap,ok=new WeakMap,ak=new WeakMap,sk=new WeakMap,lk=new WeakMap,ck=new WeakSet;class uk extends Fy{constructor(){super(...arguments),function(e,t){qC(e,t),t.add(e)}(this,ck),GC(this,"range",{}),zC(this,nk,null),zC(this,ik,null),zC(this,ok,!1),zC(this,ak,!1),zC(this,sk,null),zC(this,lk,"")}static get PLUGIN_KEY(){return XC}static get PLUGIN_PRIORITY(){return 60}isEnabled(){return!!this.hot.getSettings()[XC]}enablePlugin(){var e=this;this.enabled||(KC(nk,this)||($C(nk,this,new NC(this.hot.rootDocument,this.hot.isRtl())),KC(nk,this).addLocalHook("resize",(function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return YC(ck,e,vk).call(e,...r)}))),KC(ik,this)||$C(ik,this,new LC(this.getDisplayDelaySetting())),this.addHook("afterContextMenuDefaultOptions",(e=>this.addToContextMenu(e))),this.addHook("afterRenderer",((e,t,r,n,i,o)=>YC(ck,this,gk).call(this,e,o))),this.addHook("afterScroll",(()=>YC(ck,this,yk).call(this))),this.addHook("afterBeginEditing",(()=>this.hide())),this.addHook("afterDocumentKeyDown",(e=>YC(ck,this,bk).call(this,e))),KC(ik,this).addLocalHook("hide",(()=>this.hide())),KC(ik,this).addLocalHook("show",((e,t)=>this.showAtCell(e,t))),this.registerShortcuts(),this.registerListeners(),super.enablePlugin())}updatePlugin(){KC(ik,this).updateDelay(this.getDisplayDelaySetting()),super.updatePlugin()}disablePlugin(){this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager(),t=e.getContext("grid"),r=e.addContext(rk);t.addShortcut({keys:[["Control","Alt","M"]],callback:()=>{const t=this.hot.getSelectedRangeLast();$C(ak,this,!0),this.hot.scrollToFocusedCell((()=>{this.setRange(t),this.show(),this.focusEditor(),e.setActiveContextName(rk),this.hot._registerTimeout((()=>{$C(ak,this,!1)}))}))},stopPropagation:!0,runOnlyIf:()=>{var e;return(null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.highlight.isCell())&&!KC(nk,this).isVisible()},group:tk}),r.addShortcut({keys:[["Escape"]],callback:()=>{KC(nk,this).setValue(KC(lk,this)),this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>KC(nk,this).isVisible()&&KC(nk,this).isFocused(),group:tk}),r.addShortcut({keys:[["Control/Meta","Enter"]],callback:()=>{this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>KC(nk,this).isVisible()&&KC(nk,this).isFocused(),group:tk})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(tk)}registerListeners(){const{rootDocument:e}=this.hot,t=this.getEditorInputElement();this.eventManager.addEventListener(e,"mouseover",(e=>YC(ck,this,dk).call(this,e))),this.eventManager.addEventListener(e,"mousedown",(e=>YC(ck,this,hk).call(this,e))),this.eventManager.addEventListener(e,"mouseup",(()=>YC(ck,this,fk).call(this))),this.eventManager.addEventListener(t,"focus",(()=>YC(ck,this,mk).call(this))),this.eventManager.addEventListener(t,"blur",(()=>YC(ck,this,pk).call(this)))}setRange(e){this.range=e}clearRange(){this.range={}}targetIsCellWithComment(e){const t=Nn(e.target,"TD","TBODY");return!!(t&&Un(t,"htCommentCell")&&Nn(t,[this.hot.rootElement]))}targetIsCommentTextArea(e){return this.getEditorInputElement()===e.target}setComment(e){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const t=KC(nk,this).getValue();let r="";null!==e&&void 0!==e?r=e:null!==t&&void 0!==t&&(r=t);const n=this.range.from.row,i=this.range.from.col;this.updateCommentMeta(n,i,{[ZC]:r}),this.hot.render()}setCommentAtCell(e,t,r){this.setRange({from:this.hot._createCellCoords(e,t)}),this.setComment(r)}removeComment(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,JC),e&&this.hot.render(),this.hide()}removeCommentAtCell(e,t){let r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.setRange({from:this.hot._createCellCoords(e,t)}),this.removeComment(r)}getComment(){const e=this.range.from.row,t=this.range.from.col;return this.getCommentMeta(e,t,ZC)}getCommentAtCell(e,t){return this.getCommentMeta(e,t,ZC)}show(){var e;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{from:{row:t,col:r}}=this.range;if(t<0||t>this.hot.countSourceRows()-1||r<0||r>this.hot.countSourceCols()-1)return!1;const n=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return KC(ik,this).cancelHiding(),KC(nk,this).setValue(null!==(e=n[JC]?n[JC][ZC]:null)&&void 0!==e?e:""),KC(nk,this).show(),this.refreshEditor(!0),!0}showAtCell(e,t){return this.setRange({from:this.hot._createCellCoords(e,t)}),this.show()}hide(){KC(nk,this).hide()}refreshEditor(){var e,t;if(!(arguments.length>0&&void 0!==arguments[0]&&arguments[0])&&(!this.range.from||!KC(nk,this).isVisible()))return;const{rowIndexMapper:r,columnIndexMapper:n}=this.hot,{row:i,col:o}=this.range.from;let a=r.getRenderableFromVisualIndex(i),s=n.getRenderableFromVisualIndex(o);const l=null===a;KC(nk,this).setPosition(0,0),null===a&&(a=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(i,-1))),null===s&&(s=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(o,-1)));const c=null===a,u=null===s;a=null!==(e=a)&&void 0!==e?e:0,s=null!==(t=s)&&void 0!==t?t:0;const{rootWindow:h,view:{_wt:d}}=this.hot,{wtTable:f}=d,g=d.getCell({row:a,col:s},!0),p=this.getCommentMeta(i,o,QC);p?KC(nk,this).setSize(p.width,p.height):KC(nk,this).resetSize();const m=u?0:f.getStretchedColumnWidth(s),v=l&&!c?si(g):0,{left:b,top:y,width:w,height:S}=g.getBoundingClientRect(),{width:C,height:k}=KC(nk,this).getSize(),{innerWidth:x,innerHeight:E}=this.hot.rootWindow,T=this.hot.rootDocument.documentElement;let _=b+h.scrollX+m,A=y+h.scrollY+v;this.hot.isRtl()&&(_-=C+m),this.hot.isLtr()&&b+w+C>x?_=b+h.scrollX-C-1:this.hot.isRtl()&&_<-(T.scrollWidth-T.clientWidth)&&(_=b+h.scrollX+m+1),y+k>E&&(A-=k-S+1),KC(nk,this).setPosition(_,A),KC(nk,this).setReadOnlyState(this.getCommentMeta(i,o,ek)),KC(nk,this).observeSize()}focusEditor(){KC(nk,this).focus()}updateCommentMeta(e,t,r){const n=this.hot.getCellMeta(e,t)[JC];let i;n?(i=no(n),ro(i,r)):i=r,this.hot.setCellMeta(e,t,JC,i)}getCommentMeta(e,t,r){const n=this.hot.getCellMeta(e,t);if(n[JC])return n[JC][r]}addToContextMenu(e){var t;e.items.push({name:HC},(t=this,{key:"commentsAddEdit",name(){var e;const r=null===(e=this.getSelectedRangeLast())||void 0===e?void 0:e.highlight;return null!==r&&void 0!==r&&r.isCell()&&t.getCommentAtCell(r.row,r.col)?this.getTranslatedPhrase(Od):this.getTranslatedPhrase(Rd)},callback(){const e=this.getSelectedRangeLast();t.setRange(e),t.show(),t.focusEditor()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||0===this.countRenderedRows()||0===this.countRenderedCols())}}),function(e){return{key:"commentsRemove",name(){return this.getTranslatedPhrase(Md)},callback(){this.getSelectedRangeLast().forAll(((t,r)=>{t>=0&&r>=0&&e.removeCommentAtCell(t,r,!1)})),this.render()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||0===this.countRenderedRows()||0===this.countRenderedCols())}}}(this),function(e){return{key:"commentsReadOnly",name(){const t=this.getTranslatedPhrase(Id),r=WC(this.getSelectedRange(),((t,r)=>e.getCommentMeta(t,r,ek)));return r?jC(t):t},callback(){this.getSelectedRangeLast().forAll(((t,r)=>{if(t>=0&&r>=0){const n=!!e.getCommentMeta(t,r,ek);e.updateCommentMeta(t,r,{[ek]:!n})}}))},disabled(){const t=this.getSelectedRangeLast();return!!(!t||t.highlight.isHeader()||!e.getCommentAtCell(t.highlight.row,t.highlight.col)||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||0===this.countRenderedRows()||0===this.countRenderedCols())}}}(this))}getDisplayDelaySetting(){const e=this.hot.getSettings()[XC];if(so(e))return e.displayDelay}getEditorInputElement(){return KC(nk,this).getInputElement()}destroy(){var e,t;null===(e=KC(nk,this))||void 0===e||e.destroy(),null===(t=KC(ik,this))||void 0===t||t.destroy(),super.destroy()}}function hk(e){if(this.hot.view&&this.hot.view._wt&&!KC(ok,this)&&!this.targetIsCommentTextArea(e)){const t=Nn(e.target,"TD","TBODY");let r=null;t&&(r=this.hot.getCoords(t)),(!t||this.range.from&&r&&(this.range.from.row!==r.row||this.range.from.col!==r.col))&&this.hide()}}function dk(e){const{rootDocument:t}=this.hot;if(!(KC(ok,this)||KC(nk,this).isFocused()||Un(e.target,"wtBorder")||KC(sk,this)===e.target)&&KC(nk,this))if($C(sk,this,t.elementFromPoint(e.clientX,e.clientY)),this.targetIsCellWithComment(e)){const t=this.hot._createCellRange(this.hot.getCoords(e.target));KC(ik,this).show(t)}else Fn(e.target,t)&&!this.targetIsCommentTextArea(e)&&KC(ik,this).hide()}function fk(){$C(ok,this,!1)}function gk(e,t){t[JC]&&t[JC][ZC]&&jn(e,t.commentedCellClassName)}function pk(){$C(lk,this,""),this.hot.getShortcutManager().setActiveContextName("grid"),this.setComment()}function mk(){$C(lk,this,this.getComment()),this.hot.listen(),this.hot.getShortcutManager().setActiveContextName(rk)}function vk(e,t){this.updateCommentMeta(this.range.from.row,this.range.from.col,{[QC]:{width:e,height:t}})}function bk(e){KC(nk,this).isVisible()&&No(e)}function yk(){KC(ak,this)||this.hide()}function wk(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Sk{constructor(e){wk(this,"hot",void 0),wk(this,"commands",{}),wk(this,"commonCallback",null),this.hot=e}registerCommand(e,t){this.commands[e]=t}setCommonCallback(e){this.commonCallback=e}execute(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];const i=e.split(":"),o=i[0],a=2===i.length?i[1]:null;let s=this.commands[o];if(!s)throw new Error(`Menu command '${o}' not exists.`);if(a&&s.submenu&&(s=function(e,t){let r;return Ai(t,(t=>{const n=t.key?t.key.split(":"):null;if(Array.isArray(n)&&n[1]===e)return r=t,!1})),r}(a,s.submenu.items)),!0===s.disabled)return;if("function"===typeof s.disabled&&!0===s.disabled.call(this.hot))return;if(go(s,"submenu"))return;const l=[];"function"===typeof s.callback&&l.push(s.callback),"function"===typeof this.commonCallback&&l.push(this.commonCallback),r.unshift(i.join(":")),Ai(l,(e=>e.apply(this.hot,r)))}}const Ck="alignment";const kk="clear_column";const xk="col_left";const Ek="col_right";const Tk="make_read_only";const _k="redo";const Ak="remove_col";const Rk="remove_row";const Ok="row_above";const Mk="row_below";const Ik="no_items";const Pk="undo";const Nk=[Ok,Mk,xk,Ek,kk,Rk,Ak,Pk,_k,Tk,Ck,HC,Ik],Dk={[HC]:function(){return{name:HC}},[Ik]:function(){return{key:Ik,name(){return this.getTranslatedPhrase(cd)},disabled:!0,isCommand:!1}},[Ok]:function(){return{key:Ok,name(){return this.getTranslatedPhrase(ud)},callback(){const e=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",e.row,1,"ContextMenu.rowAbove")},disabled(){const e=this.getSelectedRangeLast();if(!e)return!0;if(e.isSingleHeader()&&e.highlight.row<0)return!0;if(this.selection.isSelectedByCorner()){return 0===this.countRows()}return this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden(){return!this.getSettings().allowInsertRow}}},[Mk]:function(){return{key:Mk,name(){return this.getTranslatedPhrase(hd)},callback(){const e=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",e.row,1,"ContextMenu.rowBelow")},disabled(){const e=this.getSelectedRangeLast();return!e||(!!(e.isSingleHeader()&&e.highlight.row<0)||!this.selection.isSelectedByCorner()&&(this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows))},hidden(){return!this.getSettings().allowInsertRow}}},[xk]:function(){return{key:xk,name(){return this.getTranslatedPhrase(dd)},callback(){const e=this.getSelectedRangeLast().getTopLeftCorner(),t=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(t,e.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;const e=this.getSelectedRangeLast();if(!e)return!0;if(e.isSingleHeader()&&e.highlight.col<0)return!0;if(this.selection.isSelectedByCorner()){return 0===this.countCols()}return this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden(){return!this.getSettings().allowInsertColumn}}},[Ek]:function(){return{key:Ek,name(){return this.getTranslatedPhrase(fd)},callback(){const e=this.getSelectedRangeLast().getTopRightCorner(),t=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(t,e.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;const e=this.getSelectedRangeLast();return!e||(!!(e.isSingleHeader()&&e.highlight.col<0)||!this.selection.isSelectedByCorner()&&(this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols))},hidden(){return!this.getSettings().allowInsertColumn}}},[kk]:function(){return{key:kk,name(){return this.getTranslatedPhrase(yd)},callback(e,t){const r=t[0].start.col,n=t[0].end.col;this.countRows()&&this.populateFromArray(0,r,[[null]],Math.max(t[0].start.row,t[0].end.row),n,"ContextMenu.clearColumn")},disabled(){const e=this.getSelectedRangeLast();return!e||(!!(e.isSingleHeader()&&e.highlight.col<0)||!this.selection.isSelectedByColumnHeader())}}},[Rk]:function(){return{key:Rk,name(){const e=this.getSelected();let t=0;if(e)if(e.length>1)t=1;else{const[r,,n]=e[0];r-n!==0&&(t=1)}return this.getTranslatedPhrase(gd,t)},callback(){this.alter("remove_row",function(e){const t=zg(e.getSelected());if(t===Fg||t===Lg)return[];const r=qg(t,{createCellCoords:e._createCellCoords.bind(e),createCellRange:e._createCellRange.bind(e)}),n=new Set;Ai(e.getSelected(),(e=>{const{from:t,to:i}=r(e),o=Math.max(t.row,0),a=i.row-o+1;Ai(Array.from(new Array(a),((e,t)=>o+t)),(e=>{n.has(e)||n.add(e)}))}));const i=Array.from(n).sort(((e,t)=>e-t)),o=Ei(i,((e,t,r,n)=>(0!==r&&t===n[r-1]+1?e[e.length-1][1]+=1:e.push([t,1]),e)),[]);return o}(this),1,"ContextMenu.removeRow")},disabled(){const e=this.getSelectedRangeLast();if(!e)return!0;if(e.isSingleHeader()&&e.highlight.row<0)return!0;const t=this.countRows();return this.selection.isSelectedByCorner()?0===t:this.selection.isSelectedByColumnHeader()||0===t},hidden(){return!this.getSettings().allowRemoveRow}}},[Ak]:function(){return{key:Ak,name(){const e=this.getSelected();let t=0;if(e)if(e.length>1)t=1;else{const[,r,,n]=e[0];r-n!==0&&(t=1)}return this.getTranslatedPhrase(pd,t)},callback(){this.alter("remove_col",function(e){const t=zg(e.getSelected());if(t===Fg||t===Lg)return[];const r=qg(t,{createCellCoords:e._createCellCoords.bind(e),createCellRange:e._createCellRange.bind(e)}),n=new Set;Ai(e.getSelected(),(e=>{const{from:t,to:i}=r(e),o=Math.max(t.col,0),a=i.col-o+1;Ai(Array.from(new Array(a),((e,t)=>o+t)),(e=>{n.has(e)||n.add(e)}))}));const i=Array.from(n).sort(((e,t)=>e-t)),o=Ei(i,((e,t,r,n)=>(0!==r&&t===n[r-1]+1?e[e.length-1][1]+=1:e.push([t,1]),e)),[]);return o}(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;const e=this.getSelectedRangeLast();if(!e)return!0;if(e.isSingleHeader()&&e.highlight.col<0)return!0;const t=this.countCols();return this.selection.isSelectedByCorner()?0===t:this.selection.isSelectedByRowHeader()||0===t},hidden(){return!this.getSettings().allowRemoveColumn}}},[Pk]:function(){return{key:Pk,name(){return this.getTranslatedPhrase(md)},callback(){this.undo()},hidden(){const e=this.getPlugin("undoRedo");return!e||!e.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}},[_k]:function(){return{key:_k,name(){return this.getTranslatedPhrase(vd)},callback(){this.redo()},hidden(){const e=this.getPlugin("undoRedo");return!e||!e.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}},[Tk]:function(){return{key:Tk,name(){let e=this.getTranslatedPhrase(bd);const t=WC(this.getSelectedRange(),((e,t)=>this.getCellMeta(e,t).readOnly));return t&&(e=jC(e)),e},callback(){const e=this.getSelectedRange(),t=WC(e,((e,t)=>this.getCellMeta(e,t).readOnly));Ai(e,(e=>{e.forAll(((e,r)=>{e>=0&&r>=0&&this.setCellMeta(e,r,"readOnly",!t)}))})),this.render()},disabled(){const e=this.getSelectedRangeLast();return!e||(!!e.isSingleHeader()||(!!this.selection.isSelectedByCorner()||(0===this.countRows()||0===this.countCols()||(!this.getSelectedRange()||0===this.getSelectedRange().length))))}}},[Ck]:function(){return{key:Ck,name(){return this.getTranslatedPhrase(Pd)},disabled(){if(0===this.countRows()||0===this.countCols())return!0;const e=this.getSelectedRangeLast();return!e||(!!e.isSingleHeader()||!(this.getSelectedRange()&&!this.selection.isSelectedByCorner()))},submenu:{items:[{key:`${Ck}:left`,name(){let e=this.getTranslatedPhrase(Nd);const t=WC(this.getSelectedRange(),((e,t)=>{const r=this.getCellMeta(e,t).className;if(r&&-1!==r.indexOf("htLeft"))return!0}));return t&&(e=jC(e)),e},callback(){const e=this.getSelectedRange(),t=BC(e,((e,t)=>this.getCellMeta(e,t).className)),r="horizontal",n="htLeft";this.runHooks("beforeCellAlignment",t,e,r,n),UC(e,r,n,((e,t)=>this.getCellMeta(e,t)),((e,t,r,n)=>this.setCellMeta(e,t,r,n))),this.render()},disabled:!1},{key:`${Ck}:center`,name(){let e=this.getTranslatedPhrase(Dd);const t=WC(this.getSelectedRange(),((e,t)=>{const r=this.getCellMeta(e,t).className;if(r&&-1!==r.indexOf("htCenter"))return!0}));return t&&(e=jC(e)),e},callback(){const e=this.getSelectedRange(),t=BC(e,((e,t)=>this.getCellMeta(e,t).className)),r="horizontal",n="htCenter";this.runHooks("beforeCellAlignment",t,e,r,n),UC(e,r,n,((e,t)=>this.getCellMeta(e,t)),((e,t,r,n)=>this.setCellMeta(e,t,r,n))),this.render()},disabled:!1},{key:`${Ck}:right`,name(){let e=this.getTranslatedPhrase(Fd);const t=WC(this.getSelectedRange(),((e,t)=>{const r=this.getCellMeta(e,t).className;if(r&&-1!==r.indexOf("htRight"))return!0}));return t&&(e=jC(e)),e},callback(){const e=this.getSelectedRange(),t=BC(e,((e,t)=>this.getCellMeta(e,t).className)),r="horizontal",n="htRight";this.runHooks("beforeCellAlignment",t,e,r,n),UC(e,r,n,((e,t)=>this.getCellMeta(e,t)),((e,t,r,n)=>this.setCellMeta(e,t,r,n))),this.render()},disabled:!1},{key:`${Ck}:justify`,name(){let e=this.getTranslatedPhrase(Ld);const t=WC(this.getSelectedRange(),((e,t)=>{const r=this.getCellMeta(e,t).className;if(r&&-1!==r.indexOf("htJustify"))return!0}));return t&&(e=jC(e)),e},callback(){const e=this.getSelectedRange(),t=BC(e,((e,t)=>this.getCellMeta(e,t).className)),r="horizontal",n="htJustify";this.runHooks("beforeCellAlignment",t,e,r,n),UC(e,r,n,((e,t)=>this.getCellMeta(e,t)),((e,t,r,n)=>this.setCellMeta(e,t,r,n))),this.render()},disabled:!1},{name:HC},{key:`${Ck}:top`,name(){let e=this.getTranslatedPhrase(Hd);const t=WC(this.getSelectedRange(),((e,t)=>{const r=this.getCellMeta(e,t).className;if(r&&-1!==r.indexOf("htTop"))return!0}));return t&&(e=jC(e)),e},callback(){const e=this.getSelectedRange(),t=BC(e,((e,t)=>this.getCellMeta(e,t).className)),r="vertical",n="htTop";this.runHooks("beforeCellAlignment",t,e,r,n),UC(e,r,n,((e,t)=>this.getCellMeta(e,t)),((e,t,r,n)=>this.setCellMeta(e,t,r,n))),this.render()},disabled:!1},{key:`${Ck}:middle`,name(){let e=this.getTranslatedPhrase(Bd);const t=WC(this.getSelectedRange(),((e,t)=>{const r=this.getCellMeta(e,t).className;if(r&&-1!==r.indexOf("htMiddle"))return!0}));return t&&(e=jC(e)),e},callback(){const e=this.getSelectedRange(),t=BC(e,((e,t)=>this.getCellMeta(e,t).className)),r="vertical",n="htMiddle";this.runHooks("beforeCellAlignment",t,e,r,n),UC(e,r,n,((e,t)=>this.getCellMeta(e,t)),((e,t,r,n)=>this.setCellMeta(e,t,r,n))),this.render()},disabled:!1},{key:`${Ck}:bottom`,name(){let e=this.getTranslatedPhrase(Ud);const t=WC(this.getSelectedRange(),((e,t)=>{const r=this.getCellMeta(e,t).className;if(r&&-1!==r.indexOf("htBottom"))return!0}));return t&&(e=jC(e)),e},callback(){const e=this.getSelectedRange(),t=BC(e,((e,t)=>this.getCellMeta(e,t).className)),r="vertical",n="htBottom";this.runHooks("beforeCellAlignment",t,e,r,n),UC(e,r,n,((e,t)=>this.getCellMeta(e,t)),((e,t,r,n)=>this.setCellMeta(e,t,r,n))),this.render()},disabled:!1}]}}}};function Fk(){const e={};return co(Dk,((t,r)=>{e[r]=t()})),e}function Lk(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Hk{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;Lk(this,"hot",void 0),Lk(this,"predefinedItems",Fk()),Lk(this,"defaultOrderPattern",void 0),this.hot=e,this.defaultOrderPattern=t}setPredefinedItems(e){const t={};this.defaultOrderPattern.length=0,co(e,((e,r)=>{let n="";e.name===HC?(t[HC]=e,n=HC):isNaN(parseInt(r,10))?(e.key=void 0===e.key?r:e.key,t[r]=e,n=e.key):(t[e.key]=e,n=e.key),this.defaultOrderPattern.push(n)})),this.predefinedItems=t}getItems(){return function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const n=[];let i=e;i&&i.items?i=i.items:Array.isArray(i)||(i=t);so(i)?co(i,((e,t)=>{let i=r["string"===typeof e?e:t];i||(i=e),so(e)?to(i,e):"string"===typeof i&&(i={name:i}),void 0===i.key&&(i.key=t),n.push(i)})):Ai(i,((e,t)=>{let i=r[e];!i&&Nk.indexOf(e)>=0||(i||(i={name:e,key:`${t}`}),so(e)&&to(i,e),void 0===i.key&&(i.key=t),n.push(i))}));return n}(arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,this.defaultOrderPattern,this.predefinedItems)}}function Bk(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class Uk{constructor(e,t){Bk(this,"top",void 0),Bk(this,"topRelative",void 0),Bk(this,"left",void 0),Bk(this,"leftRelative",void 0),Bk(this,"scrollTop",void 0),Bk(this,"scrollLeft",void 0),Bk(this,"cellHeight",void 0),Bk(this,"cellWidth",void 0);const r=t.scrollY,n=t.scrollX;let i,o,a,s,l,c;this.rootWindow=t,this.type=this.getSourceType(e),"literal"===this.type?(i=parseInt(e.top,10),a=parseInt(e.left,10),l=e.height||0,c=e.width||0,o=i,s=a,i+=r,a+=n):"event"===this.type&&(i=parseInt(e.pageY,10),a=parseInt(e.pageX,10),l=e.target.clientHeight,c=e.target.clientWidth,o=i-r,s=a-n),this.top=i,this.topRelative=o,this.left=a,this.leftRelative=s,this.scrollTop=r,this.scrollLeft=n,this.cellHeight=l,this.cellWidth=c}getSourceType(e){let t="literal";return e instanceof Event&&(t="event"),t}fitsAbove(e){return this.topRelative>=e.offsetHeight}fitsBelow(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=t}fitsOnRight(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=t}fitsOnLeft(e){return this.leftRelative>=e.offsetWidth}}function jk(e,t,r){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,r)}function Wk(e,t){return e.get(zk(e,t))}function Vk(e,t,r){return e.set(zk(e,t),r),r}function zk(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var qk=new WeakMap,Gk=new WeakMap,$k=new WeakMap,Kk=new WeakMap,Yk=new WeakMap;class Xk{constructor(e){jk(this,qk,void 0),jk(this,Gk,void 0),jk(this,$k,void 0),jk(this,Kk,!1),jk(this,Yk,{above:0,below:0,left:0,right:0}),Vk(Kk,this,e)}setOffset(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Wk(Yk,this)[e]=t,this}setElement(e){return Vk(qk,this,e),this}setParentElement(e){return Vk(Gk,this,e),this}updatePosition(e){Vk($k,this,new Uk(e,Wk(qk,this).ownerDocument.defaultView)),Wk(Kk,this)?(Wk($k,this).fitsBelow(Wk(qk,this))?this.setPositionBelowCursor():Wk($k,this).fitsAbove(Wk(qk,this))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){"rtl"===Wk(qk,this).dir?Wk($k,this).fitsOnLeft(Wk(qk,this))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():Wk($k,this).fitsOnRight(Wk(qk,this))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let e=Wk(Yk,this).above+Wk($k,this).top-Wk(qk,this).offsetHeight;Wk(Gk,this)&&(e=Wk($k,this).top+Wk($k,this).cellHeight-Wk(qk,this).offsetHeight+3),Wk(qk,this).style.top=`${e}px`}setPositionBelowCursor(){let e=Wk(Yk,this).below+Wk($k,this).top+1;Wk(Gk,this)&&(e=Wk($k,this).top-1),Wk(qk,this).style.top=`${e}px`}setPositionOnRightOfCursor(){let e=Wk($k,this).left;if(Wk(Gk,this)){const{right:t}=Wk(Gk,this).getBoundingClientRect();e+=Wk($k,this).cellWidth+t-(Wk($k,this).left+Wk($k,this).cellWidth)}else e+=Wk(Yk,this).right;Wk(qk,this).style.left=`${e}px`}setPositionOnLeftOfCursor(){let e=Wk(Yk,this).left+Wk($k,this).left-Wk(qk,this).offsetWidth;if(Wk(Gk,this)){const{left:t}=Wk(Gk,this).getBoundingClientRect();e-=Wk($k,this).left-t}Wk(qk,this).style.left=`${e}px`}}function Jk(e){let{initialPage:t=-1,size:r=()=>0,onItemSelect:n=()=>{},onClear:i=()=>{}}=e;const o=new Set;let a=za(t,-1,l()-1);function s(e,t){const r=l()-1;if(e<0&&(e=r),e>r&&(e=0),o.has(e))return-1;o.add(e);return!1===n(e,!1)&&(e=s(1===t?++e:--e,t)),e}function l(){return Math.max(r(),0)}return{setCurrentPage:function(e){e>-1&&e<l()&&!1!==n(e,!0)&&(a=e)},getCurrentPage:function(){return a},toFirstItem:function(){l()>0&&(o.clear(),a=s(0,1))},toLastItem:function(){l()>0&&(o.clear(),a=s(l()-1,-1))},toNextItem:function(){l()>0&&(o.clear(),a=s(++a,1))},toPreviousItem:function(){l()>0&&(o.clear(),a=s(--a,-1))},getSize:l,clear:function(){o.clear(),a=t,i()}}}function Zk(e){return go(e,"submenu")}function Qk(e){return new RegExp(HC,"i").test(e.name)}function ex(e,t){return!0===e.disabled||"function"===typeof e.disabled&&!0===e.disabled.call(t)}function tx(e){return go(e,"disableSelection")}function rx(e,t){const r=e.slice(0);for(let n=0;n<r.length&&r[n].name===t;)r.shift();return r}function nx(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:HC,r=e.slice(0);return r=rx(r,t),r=function(e,t){let r=e.slice(0);return r.reverse(),r=rx(r,t),r.reverse(),r}(r,t),r=function(e){const t=[];return Ai(e,((e,r)=>{r>0?t[t.length-1].name!==e.name&&t.push(e):t.push(e)})),t}(r),r}function ix(e){return Jk({size:()=>e.countRows(),onItemSelect(t,r){const n=e.getCell(t,0);if(!n||function(e){return Un(e,"htSeparator")}(n)||function(e){return Un(e,"htDisabled")}(n)||function(e){return Un(e,"htSelectionDisabled")}(n))return!1;e.selectCell(t,0,...r?[t,0,!1,!1]:[])},onClear(){e.deselectCell()}})}const ox="menu",ax=ox;function sx(e,t,r){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,r)}function lx(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function cx(e,t,r){return e.set(hx(e,t),r),r}function ux(e,t){return e.get(hx(e,t))}function hx(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var dx=new WeakMap,fx=new WeakMap;class gx{constructor(e,t){var r=this;lx(this,"hot",void 0),lx(this,"options",void 0),lx(this,"eventManager",new ca(this)),lx(this,"container",void 0),lx(this,"positioner",void 0),lx(this,"hotMenu",null),lx(this,"hotSubMenus",{}),lx(this,"parentMenu",void 0),lx(this,"menuItems",null),lx(this,"origOutsideClickDeselects",null),sx(this,dx,void 0),sx(this,fx,void 0),this.hot=e,this.options=t||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:215,container:this.hot.rootDocument.documentElement},this.container=this.createContainer(this.options.name),this.positioner=new Xk(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.parentMenu.runLocalHooks("afterSelectionChange",...t)}))}registerEvents(){let e=this.hot.rootWindow;for(;e;)this.eventManager.addEventListener(e.document,"mousedown",(e=>this.onDocumentMouseDown(e))),this.eventManager.addEventListener(e.document,"touchstart",(e=>this.onDocumentMouseDown(e))),this.eventManager.addEventListener(e.document,"contextmenu",(e=>this.onDocumentContextMenu(e))),e=Pn(e)}setMenuItems(e){this.menuItems=e}getNavigator(){return ux(dx,this)}getKeyboardShortcutsCtrl(){return ux(fx,this)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedLast())}isSubMenu(){return null!==this.parentMenu}open(){this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const e=Xi((e=>this.openSubMenu(e)),300),t=this.options.minWidth||215;let r=!1,n=Ti(this.menuItems,(e=>(e.key===Ik&&(r=!0),function(e,t){return!e.hidden||!("function"===typeof e.hidden&&e.hidden.call(t))}(e,this.hot))));if(n.length<1&&!r)n.push(Fk()[Ik]);else if(0===n.length)return;n=nx(n,HC);let i=!1;const o={data:n,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth:e=>Ni(e)&&e<t?t:e,autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:(a=this.hot,(e,t,r,n,i,o)=>{if(t.hasAttribute("ghost-table"))return;const s=e.getSourceDataAtRow(r),l=a.rootDocument.createElement("div"),c="function"===typeof o?o.call(a):o;if(Gn(t),jn(l,"htItemWrapper"),a.getSettings().ariaTags){const e=!ex(s,a)&&!tx(s)&&!Qk(s);Vn(t,[["role","menuitem"],yn(c),...e?[mn(-1)]:[],...ex(s,a)?[["aria-disabled","true"]]:[],...Zk(s)?[Tn(!1)]:[]])}t.className="",t.appendChild(l),Qk(s)?jn(t,"htSeparator"):"function"===typeof s.renderer?(jn(t,"htCustomMenuRenderer"),t.appendChild(s.renderer(e,l,r,n,i,c))):Kn(l,c),ex(s,a)?jn(t,"htDisabled"):tx(s)?jn(t,"htSelectionDisabled"):Zk(s)&&jn(t,"htSubmenu")})}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,beforeOnCellMouseOver:(e,t)=>{ux(dx,this).setCurrentPage(t.row)},afterOnCellMouseOver:(t,r)=>{this.isAllSubMenusClosed()?e(r.row):this.openSubMenu(r.row)},rowHeights:e=>n[e].name===HC?1:23,afterOnCellContextMenu:e=>{e.preventDefault(),Ao()&&i&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(e,t,r,n,i)=>{this.hotMenu.view.isMouseDown()&&(i.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:e=>{this.hasSelectedItem()&&(i=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(e))},afterOnCellMouseUp:e=>{Ao()&&Fo(e)||!i||!this.hasSelectedItem()||(Eo()||_o()?this.hot._registerTimeout((()=>this.close(!0)),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};var a;this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,o),this.hotMenu.addHook("afterInit",(()=>this.onAfterInit())),this.hotMenu.init(),cx(dx,this,ix(this.hotMenu)),cx(fx,this,function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const r=[];function n(e,t){a(t).addShortcuts(e,{group:ox})}function i(e,t){const i=a(t);e.forEach((e=>{let{keys:t}=e;t.forEach((e=>i.removeShortcutsByKeys(e)))})),r.push({shortcuts:e,contextName:t}),n(e,t)}function o(e){return e?`${ax}:${e}`:ax}function a(t){var r;const n=e.hotMenu.getShortcutManager(),i=o(t);return null!==(r=n.getContext(i))&&void 0!==r?r:n.addContext(i)}return n(function(e){const{hot:t,hotMenu:r}=e;return[{keys:[["Control/Meta","A"]],forwardToContext:t.getShortcutManager().getContext("grid"),callback:()=>e.close(!0)},{keys:[["Tab"],["Shift","Tab"]],callback:(r,n)=>{const i=t.getSettings(),o="function"===typeof i.tabMoves?i.tabMoves(r):i.tabMoves;n.includes("shift")?t.selection.transformStart(-o.row,-o.col):t.selection.transformStart(o.row,o.col),e.close(!0)}},{keys:[["Escape"]],callback:()=>e.close()},{keys:[["ArrowDown"]],callback:()=>e.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>e.getNavigator().toPreviousItem()},{keys:[["ArrowRight"]],callback:()=>{const t=r.getSelectedLast();if(t){const r=e.openSubMenu(t[0]);r&&r.getNavigator().toFirstItem()}}},{keys:[["ArrowLeft"]],callback:()=>{r.getSelectedLast()&&e.isSubMenu()&&(e.close(),e.isSubMenu()&&e.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>e.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>e.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:t=>{const n=r.getSelectedLast();n&&(r.getSourceDataAtRow(n[0]).submenu?e.openSubMenu(n[0]).getNavigator().toFirstItem():(e.executeCommand(t),e.close(!0)))}},{keys:[["PageUp"]],callback:()=>{r.getSelectedLast()?r.selection.transformStart(-r.countVisibleRows(),0):e.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{r.getSelectedLast()?r.selection.transformStart(r.countVisibleRows(),0):e.getNavigator().toLastItem()}}]}(e)),t.forEach((e=>{let{shortcuts:t,contextName:r}=e;i(t,r)})),{addCustomShortcuts:i,getCustomShortcuts:function(){return[...r]},getContext:a,listen:function(t){e.hotMenu.getShortcutManager().setActiveContextName(o(t))}}}(this)),ux(fx,this).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",(()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this))),this.runLocalHooks("afterOpen",this)}close(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.isOpened())if(e&&this.isSubMenu())this.parentMenu.close();else if(ux(dx,this).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){const e=this.parentMenu.hotMenu.getSelectedLast();if(e){Vn(this.parentMenu.hotMenu.getCell(e[0],0),[Tn(!1)])}}this.parentMenu.hotMenu.listen()}}openSubMenu(e){if(!this.hotMenu)return!1;const t=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!t||!function(e){return Un(e,"htSubmenu")}(t))return!1;const r=this.hotMenu.getSourceDataAtRow(e),n=new gx(this.hot,{parent:this,name:r.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return n.setMenuItems(r.submenu.items),n.open(),n.setPosition(t.getBoundingClientRect()),this.hotSubMenus[r.key]=n,this.hot.getSettings().ariaTags&&Vn(t,[Tn(!0)]),n}closeSubMenu(e){const t=this.hotMenu.getSourceDataAtRow(e),r=this.hotSubMenus[t.key];if(r){r.destroy(),delete this.hotSubMenus[t.key];const n=this.hotMenu.getCell(e,0);this.hot.getSettings().ariaTags&&Vn(n,[Tn(!1)])}}closeAllSubMenus(){Ai(this.hotMenu.getData(),((e,t)=>this.closeSubMenu(t)))}isAllSubMenusClosed(){return 0===Object.keys(this.hotSubMenus).length}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){const e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}isOpened(){return null!==this.hotMenu}executeCommand(e){if(!this.isOpened()||!this.hasSelectedItem())return;const t=this.getSelectedItem();if(this.runLocalHooks("select",t,e),this.isCommandPassive(t))return;const r=this.hot.getSelectedRange(),n=r?function(e){return _i(e,(e=>({start:e.getTopStartCorner(),end:e.getBottomEndCorner()})))}(r):[];this.runLocalHooks("executeCommand",t.key,n,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",t.key,n,e)}isCommandPassive(e){return!1===e.isCommand||Qk(e)||ex(e,this.hot)||Zk(e)}setOffset(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.positioner.setOffset(e,t)}setPosition(e){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(e)}createContainer(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;const t=this.options.container.ownerDocument;let r,n=e;return n&&(Yi(n)&&(n=n.call(this.hot),n=null===n||Di(n)?"":n.toString()),n=n.replace(/[^A-z0-9]/g,"_"),n=`${this.options.className}Sub_${n}`,r=t.querySelector(`.${this.options.className}.${n}`)),r||(r=t.createElement("div"),jn(r,`htMenu ${this.options.className}`),n&&jn(r,n),this.options.container.appendChild(r)),r}onAfterInit(){const{wtTable:e}=this.hotMenu.view._wt,t=this.hotMenu.getSettings().data,r=e.hider.style,n=e.holder.style,i=parseInt(r.width,10),o=Ei(t,((e,t)=>e+(t.name===HC?1:26)),0);n.width=`${i+3}px`,n.height=`${o+3}px`,r.height=n.height,this.hot.getSettings().ariaTags&&Vn(this.hotMenu.rootElement,[["role","menu"],mn(-1)])}onDocumentMouseDown(e){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!Fn(e.target,this.hotMenu.rootElement)?this.close(!0):!this.isAllSubMenusClosed()&&!this.isSubMenu()||Fn(e.target,".htMenu")||this.close(!0))}onDocumentContextMenu(e){this.isOpened()&&Un(e.target,"htCore")&&Fn(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}function px(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function mx(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function vx(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}oo(gx,wh);const bx="contextMenu",yx=bx;Ko.getSingleton().register("afterContextMenuDefaultOptions"),Ko.getSingleton().register("beforeContextMenuShow"),Ko.getSingleton().register("afterContextMenuShow"),Ko.getSingleton().register("afterContextMenuHide"),Ko.getSingleton().register("afterContextMenuExecute");var wx=new WeakSet;class Sx extends Fy{constructor(){super(...arguments),px(this,wx),mx(this,"commandExecutor",new Sk(this.hot)),mx(this,"itemsFactory",null),mx(this,"menu",null)}static get PLUGIN_KEY(){return bx}static get PLUGIN_PRIORITY(){return 70}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[Ok,Mk,HC,xk,Ek,HC,Rk,Ak,HC,Pk,_k,HC,Tk,HC,Ck]}isEnabled(){return!!this.hot.getSettings()[bx]}enablePlugin(){var e=this;if(this.enabled)return;const t=this.hot.getSettings()[bx];"function"===typeof t.callback&&this.commandExecutor.setCommonCallback(t.callback),this.menu=new gx(this.hot,{className:"htContextMenu",keepInViewport:!0,container:t.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",(()=>vx(wx,this,kx).call(this))),this.menu.addLocalHook("afterOpen",(()=>vx(wx,this,xx).call(this))),this.menu.addLocalHook("afterClose",(()=>vx(wx,this,Ex).call(this))),this.menu.addLocalHook("executeCommand",(function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return e.executeCommand.call(e,...r)})),this.addHook("afterOnCellContextMenu",(e=>vx(wx,this,Cx).call(this,e))),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","Backslash"],["Shift","F10"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();this.hot.scrollToFocusedCell();const t=this.hot.getCell(e.row,e.col,!0).getBoundingClientRect(),r=VC(this.menu.container,this.hot.rootDocument);this.open({left:t.left+r.left,top:t.top+r.top-1+t.height},{left:t.width,above:-t.height}),this.menu.getNavigator().toFirstItem()},runOnlyIf:()=>{var e;const t=null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.highlight;return t&&this.hot.selection.isCellVisible(t)&&!this.menu.isOpened()},group:yx})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(yx)}open(e){var t;let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{above:0,below:0,left:0,right:0};null!==(t=this.menu)&&void 0!==t&&t.isOpened()||(this.prepareMenuItems(),this.menu.open(),co(r,((e,t)=>{this.menu.setOffset(t,e)})),this.menu.setPosition(e))}close(){var e;null===(e=this.menu)||void 0===e||e.close(),this.itemsFactory=null}executeCommand(e){null===this.itemsFactory&&this.prepareMenuItems();for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];this.commandExecutor.execute(e,...r)}prepareMenuItems(){this.itemsFactory=new Hk(this.hot,Sx.DEFAULT_ITEMS);const e=this.hot.getSettings()[bx],t={items:this.itemsFactory.getItems(e)};this.hot.runHooks("afterContextMenuDefaultOptions",t),this.itemsFactory.setPredefinedItems(t.items);const r=this.itemsFactory.getItems(e);this.hot.runHooks("beforeContextMenuSetItems",r),this.menu.setMenuItems(r),Ai(r,(e=>this.commandExecutor.registerCommand(e.key,e)))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function Cx(e){const t=this.hot.getSettings(),r=t.rowHeaders,n=t.colHeaders;const i=e.target;if(this.close(),Un(i,"handsontableInput"))return;if(e.preventDefault(),e.stopPropagation(),!r&&!n&&!function(e){return"TD"===e.nodeName||"TD"===e.parentNode.nodeName}(i)&&(!Un(i,"current")||!Un(i,"wtBorder")))return;const o=VC(this.menu.container,this.hot.rootDocument);this.open({top:e.clientY+o.top,left:e.clientX+o.left})}function kx(){this.hot.runHooks("beforeContextMenuShow",this)}function xx(){this.hot.runHooks("afterContextMenuShow",this)}function Ex(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}Sx.SEPARATOR={name:HC};class Tx{constructor(){this.data={}}setData(e,t){this.data[e]=t}getData(e){return this.data[e]||void 0}}class _x{constructor(){this.clipboardData=new Tx}preventDefault(){}}function Ax(e,t,r){Rx(e,t),t.set(e,r)}function Rx(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ox(e,t){return e.get(Ix(e,t))}function Mx(e,t,r){return e.set(Ix(e,t),r),r}function Ix(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var Px=new WeakMap,Nx=new WeakMap,Dx=new WeakMap,Fx=new WeakMap,Lx=new WeakMap,Hx=new WeakMap,Bx=new WeakSet;class Ux{constructor(e){let{countRows:t,countColumns:r,rowsLimit:n,columnsLimit:i,countColumnHeaders:o}=e;!function(e,t){Rx(e,t),t.add(e)}(this,Bx),Ax(this,Px,void 0),Ax(this,Nx,void 0),Ax(this,Dx,void 0),Ax(this,Fx,void 0),Ax(this,Lx,void 0),Ax(this,Hx,void 0),Mx(Nx,this,t),Mx(Dx,this,r),Mx(Fx,this,n),Mx(Lx,this,i),Mx(Hx,this,o)}setSelectedRange(e){Mx(Px,this,e)}getCellsRange(){if(0===Ox(Nx,this).call(this)||0===Ox(Dx,this).call(this))return null;const{row:e,col:t}=Ox(Px,this).getTopStartCorner(),{row:r,col:n}=Ox(Px,this).getBottomEndCorner(),i=Ix(Bx,this,Wx).call(this,e,r),o=Ix(Bx,this,jx).call(this,t,n);return{isRangeTrimmed:r!==i||n!==o,startRow:e,startCol:t,endRow:i,endCol:o}}getMostBottomColumnHeadersRange(){if(0===Ox(Dx,this).call(this)||0===Ox(Hx,this).call(this))return null;const{col:e}=Ox(Px,this).getTopStartCorner(),{col:t}=Ox(Px,this).getBottomEndCorner(),r=Ix(Bx,this,jx).call(this,e,t);return{isRangeTrimmed:t!==r,startRow:-1,startCol:e,endRow:-1,endCol:r}}getAllColumnHeadersRange(){if(0===Ox(Dx,this).call(this)||0===Ox(Hx,this).call(this))return null;const{col:e}=Ox(Px,this).getTopStartCorner(),{col:t}=Ox(Px,this).getBottomEndCorner(),r=Ix(Bx,this,jx).call(this,e,t);return{isRangeTrimmed:t!==r,startRow:-Ox(Hx,this).call(this),startCol:e,endRow:-1,endCol:r}}}function jx(e,t){return Math.min(t,Math.max(e+Ox(Lx,this).call(this)-1,e))}function Wx(e,t){return Math.min(t,Math.max(e+Ox(Fx,this).call(this)-1,e))}function Vx(e){const t=[],r=[];return Ai(e,(e=>{ja(Math.min(e.startRow,e.endRow),Math.max(e.startRow,e.endRow),(e=>{-1===t.indexOf(e)&&t.push(e)}));ja(Math.min(e.startCol,e.endCol),Math.max(e.startCol,e.endCol),(e=>{-1===r.indexOf(e)&&r.push(e)}))})),{rows:t,columns:r}}function zx(e,t,r){qx(e,t),t.set(e,r)}function qx(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Gx(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $x(e,t){return e.get(Yx(e,t))}function Kx(e,t,r){return e.set(Yx(e,t),r),r}function Yx(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}Ko.getSingleton().register("afterCopyLimit"),Ko.getSingleton().register("modifyCopyableRange"),Ko.getSingleton().register("beforeCut"),Ko.getSingleton().register("afterCut"),Ko.getSingleton().register("beforePaste"),Ko.getSingleton().register("afterPaste"),Ko.getSingleton().register("beforeCopy"),Ko.getSingleton().register("afterCopy");const Xx="copyPaste",Jx=["fragmentSelection"],Zx=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var Qx=new WeakMap,eE=new WeakMap,tE=new WeakMap,rE=new WeakMap,nE=new WeakMap,iE=new WeakMap,oE=new WeakMap,aE=new WeakMap,sE=new WeakSet;class lE extends Fy{constructor(){super(...arguments),function(e,t){qx(e,t),t.add(e)}(this,sE),Gx(this,"columnsLimit",1/0),Gx(this,"rowsLimit",1/0),Gx(this,"pasteMode","overwrite"),Gx(this,"uiContainer",this.hot.rootDocument.body),zx(this,Qx,!1),zx(this,eE,!1),zx(this,tE,!1),zx(this,rE,"cells-only"),zx(this,nE,!1),zx(this,iE,!1),zx(this,oE,new Ux({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})),zx(this,aE,!1),Gx(this,"copyableRanges",[])}static get PLUGIN_KEY(){return Xx}static get SETTING_KEYS(){return[Xx,...Jx]}static get PLUGIN_PRIORITY(){return 80}isEnabled(){return!!this.hot.getSettings()[Xx]}enablePlugin(){var e=this;if(this.enabled)return;const{[Xx]:t}=this.hot.getSettings();var r,n;"object"===typeof t&&(this.pasteMode=null!==(r=t.pasteMode)&&void 0!==r?r:this.pasteMode,this.rowsLimit=isNaN(t.rowsLimit)?this.rowsLimit:t.rowsLimit,this.columnsLimit=isNaN(t.columnsLimit)?this.columnsLimit:t.columnsLimit,Kx(Qx,this,!!t.copyColumnHeaders),Kx(eE,this,!!t.copyColumnGroupHeaders),Kx(tE,this,!!t.copyColumnHeadersOnly),this.uiContainer=null!==(n=t.uiContainer)&&void 0!==n?n:this.uiContainer);this.addHook("afterContextMenuDefaultOptions",(e=>Yx(sE,this,fE).call(this,e))),this.addHook("afterSelection",(function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return Yx(sE,e,gE).call(e,...r)})),this.addHook("afterSelectionEnd",(()=>Yx(sE,this,pE).call(this))),this.eventManager.addEventListener(this.hot.rootDocument,"copy",(function(){return e.onCopy(...arguments)})),this.eventManager.addEventListener(this.hot.rootDocument,"cut",(function(){return e.onCut(...arguments)})),this.eventManager.addEventListener(this.hot.rootDocument,"paste",(function(){return e.onPaste(...arguments)})),xo()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",(function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return Yx(sE,e,mE).call(e,...r)})),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",(function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return Yx(sE,e,vE).call(e,...r)})),this.addHook("afterSelection",(()=>Yx(sE,this,bE).call(this)))),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){Kx(rE,this,arguments.length>0&&void 0!==arguments[0]?arguments[0]:"cells-only"),Kx(nE,this,!0),Yx(sE,this,cE).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){Kx(iE,this,!0),Yx(sE,this,cE).call(this,"cut")}getRangedCopyableData(e){return Hp(this.getRangedData(e))}getRangedData(e){const t=[],{rows:r,columns:n}=Vx(e);return Ai(r,(e=>{const r=[];Ai(n,(t=>{e<0?r.push(this.hot.getColHeader(t,e)):r.push(this.hot.getCopyableData(e,t))})),t.push(r)})),t}paste(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;if(!e&&!t)return;const r=new _x;e&&r.clipboardData.setData("text/plain",e),t&&r.clipboardData.setData("text/html",t),this.onPaste(r)}setCopyableText(){const e=this.hot.getSelectedRangeLast();if(!e)return;if(e.isSingleHeader())return void(this.copyableRanges=[]);$x(oE,this).setSelectedRange(e);const t=new Map([["headers",null],["cells",null]]);"column-headers-only"===$x(rE,this)?t.set("headers",$x(oE,this).getMostBottomColumnHeadersRange()):("with-column-headers"===$x(rE,this)?t.set("headers",$x(oE,this).getMostBottomColumnHeadersRange()):"with-column-group-headers"===$x(rE,this)&&t.set("headers",$x(oE,this).getAllColumnHeadersRange()),t.set("cells",$x(oE,this).getCellsRange())),this.copyableRanges=Array.from(t.values()).filter((e=>null!==e)).map((e=>{let{startRow:t,startCol:r,endRow:n,endCol:i}=e;return{startRow:t,startCol:r,endRow:n,endCol:i}})),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const r=t.get("cells");if(null!==r&&r.isRangeTrimmed){const{startRow:e,startCol:t,endRow:n,endCol:i}=r;this.hot.runHooks("afterCopyLimit",n-e+1,i-t+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var e;return null===(e=this.hot.getActiveEditor())||void 0===e?void 0:e.isOpened()}populateValues(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.hot.getSelectedRangeLast();if(!e.length)return;const r=e.length,n=e[0].length,i=[],{row:o,col:a}=t.getTopStartCorner(),{row:s,col:l}=t.getBottomEndCorner();let c=o,u=a,h=o,d=a;for(;i.length<r||c<=s;){const{skipRowOnPaste:t,visualRow:s}=this.hot.getCellMeta(c,a);if(c=s+1,!0===t)continue;h=s,u=a;const f=[],g=i.length%r;for(;f.length<n||u<=l;){const{skipColumnOnPaste:t,visualCol:r}=this.hot.getCellMeta(o,u);if(u=r+1,!0===t)continue;d=r;const i=f.length%n;f.push(e[g][i])}i.push(f)}return Kx(aE,this,!0),this.hot.populateFromArray(o,a,i,void 0,void 0,"CopyPaste.paste",this.pasteMode),[o,a,h,d]}onCopy(e){if(!this.hot.isListening()&&!$x(nE,this)||this.isEditorOpened())return;if(!this.hot.getSettings().outsideClickDeselects&&e.target!==this.hot.rootDocument.body)return;this.setCopyableText(),Kx(nE,this,!1);const t=this.getRangedData(this.copyableRanges),r=Yx(sE,this,uE).call(this,this.copyableRanges);if(!!this.hot.runHooks("beforeCopy",t,this.copyableRanges,r)){const n=Hp(t);if(e&&e.clipboardData){const r=Ba(t,this.hot.rootDocument);e.clipboardData.setData("text/plain",n),e.clipboardData.setData("text/html",[Zx,r].join(""))}else"undefined"===typeof ClipboardEvent&&this.hot.rootWindow.clipboardData.setData("Text",n);this.hot.runHooks("afterCopy",t,this.copyableRanges,r)}Kx(rE,this,"cells-only"),e.preventDefault()}onCut(e){if(!this.hot.isListening()&&!$x(iE,this)||this.isEditorOpened())return;if(!this.hot.getSettings().outsideClickDeselects&&e.target!==this.hot.rootDocument.body)return;this.setCopyableText(),Kx(iE,this,!1);const t=this.getRangedData(this.copyableRanges);if(!!this.hot.runHooks("beforeCut",t,this.copyableRanges)){const r=Hp(t);if(e&&e.clipboardData){const n=Ba(t,this.hot.rootDocument);e.clipboardData.setData("text/plain",r),e.clipboardData.setData("text/html",[Zx,n].join(""))}else"undefined"===typeof ClipboardEvent&&this.hot.rootWindow.clipboardData.setData("Text",r);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",t,this.copyableRanges)}e.preventDefault()}onPaste(e){if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected())return;if(!this.hot.getSettings().outsideClickDeselects&&e.target!==this.hot.rootDocument.body)return;let t;if(e.preventDefault(),e&&"undefined"!==typeof e.clipboardData){const r=pn(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});if(r&&/(<table)|(<TABLE)/g.test(r)){const e=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document;const r={},n=t.createDocumentFragment(),i=t.createElement("div");n.appendChild(i);let o=e;if("string"===typeof o){const e=o.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,(e=>{const t=e.match(/<td\b[^>]*?>/g)[0];return`${t}${e.substring(t.length,e.lastIndexOf("<")).trim().replaceAll(/\n\s+/g," ").replaceAll(/<p.*?>/g,"\n").replace("\n","").replaceAll(/<\/(.*)>\s+$/gm,"</$1>").replace(/(<(?!br)([^>]+)>)/gi,"").replaceAll(/^&nbsp;$/gm,"")}</td>`}));i.insertAdjacentHTML("afterbegin",`${e}`),o=i.querySelector("table")}if(!o||!function(e){return"TABLE"===(e&&e.nodeName||"")}(o))return;const a=i.querySelector('meta[name$="enerator"]'),s=null!==o.querySelector("tbody th"),l=o.querySelector("tr"),c=l?Array.from(l.cells).reduce(((e,t)=>e+t.colSpan),0)-(s?1:0):0,u=o.tFoot&&Array.from(o.tFoot.rows)||[],h=[];let d=!1,f=0,g=0;if(o.tHead){const e=Array.from(o.tHead.rows).filter((e=>{const t=null!==e.querySelector("td");return t&&h.push(e),!t}));f=e.length,d=f>0,f>1?r.nestedHeaders=Array.from(e).reduce(((e,t)=>{const r=Array.from(t.cells).reduce(((e,t,r)=>{if(s&&0===r)return e;const{colSpan:n,innerHTML:i}=t,o=n>1?{label:i,colspan:n}:i;return e.push(o),e}),[]);return e.push(r),e}),[]):d&&(r.colHeaders=Array.from(e[0].children).reduce(((e,t,r)=>(s&&0===r||e.push(t.innerHTML),e)),[]))}h.length&&(r.fixedRowsTop=h.length),u.length&&(r.fixedRowsBottom=u.length);const p=[...h,...Array.from(o.tBodies).reduce(((e,t)=>(e.push(...Array.from(t.rows)),e)),[]),...u];g=p.length;const m=new Array(g);for(let y=0;y<g;y++)m[y]=new Array(c);const v=[],b=[];for(let y=0;y<g;y++){const e=p[y],t=Array.from(e.cells),r=t.length;for(let n=0;n<r;n++){const e=t[n],{nodeName:r,innerHTML:i,rowSpan:o,colSpan:s}=e,l=m[y].findIndex((e=>void 0===e));if("TD"===r){if(o>1||s>1){for(let e=y;e<y+o;e++)if(e<g)for(let t=l;t<l+s;t++)m[e][t]=null;const t=e.getAttribute("style");t&&t.includes("mso-ignore:colspan")||v.push({col:l,row:y,rowspan:o,colspan:s})}let t="";t=a&&/excel/gi.test(a.content)?i.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,"\r\n"):i.replace(/<br(\s*|\/)>[\r\n]?/gim,"\r\n"),m[y][l]=t.replace(La,(e=>Fa[e]))}else b.push(i)}}return v.length&&(r.mergeCells=v),b.length&&(r.rowHeaders=b),m.length&&(r.data=m),r}(r,this.hot.rootDocument);t=e.data}else t=e.clipboardData.getData("text/plain")}else"undefined"===typeof ClipboardEvent&&"undefined"!==typeof this.hot.rootWindow.clipboardData&&(t=this.hot.rootWindow.clipboardData.getData("Text"));if("string"===typeof t&&(t=function(e){const t=[[""]];if(0===e.length)return t;let r,n=0,i=0;for(;e.length>0&&r!==e.length;)if(r=e.length,e.match(Lp))e=e.replace(Lp,""),n+=1,t[i][n]="";else if(e.match(Dp))e=e.replace(Dp,""),n=0,i+=1,t[i]=[""];else{let r="";if(e.startsWith('"')){let t=0,n=!0;for(;n;){const i=e.slice(0,1);'"'===i&&(t+=1),r+=i,(0===(e=e.slice(1)).length||e.match(/^[\t\r\n]/)&&t%2===0)&&(n=!1)}r=r.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,(e=>new Array(Math.floor(e.length/2)).fill('"').join("")))}else{const t=e.match(Fp);r=t?t[0]:"",e=e.slice(r.length)}t[i][n]=r}return t}(t)),void 0===t||t&&0===t.length)return;if(!1===this.hot.runHooks("beforePaste",t,this.copyableRanges))return;const[r,n,i,o]=this.populateValues(t);this.hot.selectCell(r,n,Math.min(this.hot.countRows()-1,i),Math.min(this.hot.countCols()-1,o)),this.hot.runHooks("afterPaste",t,this.copyableRanges)}destroy(){super.destroy()}}function cE(e){if(xo()){const t=this.hot.getSelectedRangeLast();if(t){const{row:r,col:n}=t.highlight,i=this.hot.getCell(r,n,!0);i&&function(e,t){let r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];wi(e,r),t(),Si(e,r)}(i,(()=>{this.hot.rootDocument.execCommand(e)}))}}else this.hot.rootDocument.execCommand(e)}function uE(e){const{rows:t}=Vx(e);let r=0;for(let n=0;n<t.length&&!(t[n]>=0);n++)r+=1;return{columnHeadersCount:r}}function hE(){if(this.hot.isListening()){const e=this.hot.getSelectedRangeLast();if(e){const{row:t,col:r}=e.highlight,n=this.hot.getCell(t,r,!0);n&&wi(n)}}}function dE(){if(this.hot.isListening()){const e=this.hot.getSelectedRangeLast();if(e){const{row:t,col:r}=e.highlight,n=this.hot.getCell(t,r,!0);null!==n&&void 0!==n&&n.hasAttribute("contenteditable")&&Si(n)}}}function fE(e){var t;e.items.push({name:"---------"},(t=this,{key:"copy",name(){return this.getTranslatedPhrase(wd)},callback(){t.copyCellsOnly()},disabled(){if(0===this.countRows()||0===this.countCols())return!0;const e=this.getSelectedRangeLast();if(!e)return!0;if(e.isSingleHeader())return!0;const t=this.getSelected();return!t||t.length>1},hidden:!1})),$x(Qx,this)&&e.items.push(function(e){return{key:"copy_with_column_headers",name(){const e=this.getSelectedRangeLast(),t=e?za(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(Sd,t)},callback(){e.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e)return!0;if(e.isSingleHeader())return!0;const t=this.getSelected();return!t||t.length>1},hidden:!1}}(this)),$x(eE,this)&&e.items.push(function(e){return{key:"copy_with_column_group_headers",name(){const e=this.getSelectedRangeLast(),t=e?za(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(Cd,t)},callback(){e.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const e=this.getSelectedRangeLast();if(!e)return!0;if(e.isSingleHeader())return!0;const t=this.getSelected();return!t||t.length>1},hidden:!1}}(this)),$x(tE,this)&&e.items.push(function(e){return{key:"copy_column_headers_only",name(){const e=this.getSelectedRangeLast(),t=e?za(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(kd,t)},callback(){e.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e)return!0;if(e.isSingleHeader())return!0;const t=this.getSelected();return!t||t.length>1},hidden:!1}}(this)),e.items.push(function(e){return{key:"cut",name(){return this.getTranslatedPhrase(xd)},callback(){e.cut()},disabled(){if(0===this.countRows()||0===this.countCols())return!0;const e=this.getSelectedRangeLast();if(!e)return!0;if(e.isSingleHeader())return!0;const t=this.getSelected();return!t||t.length>1},hidden:!1}}(this))}function gE(e,t,r,n,i){$x(aE,this)&&(i.value=!0),Kx(aE,this,!1)}function pE(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function mE(){Yx(sE,this,dE).call(this)}function vE(){Yx(sE,this,hE).call(this)}function bE(){Yx(sE,this,dE).call(this)}function yE(e,t){return`border_row${e}col${t}`}function wE(e){var t,r;(Ni(e.start)||Ni(e.left))&&(e.start=null!==(t=e.start)&&void 0!==t?t:e.left);(Ni(e.end)||Ni(e.right))&&(e.end=null!==(r=e.end)&&void 0!==r?r:e.right);return delete e.left,delete e.right,e}function SE(e){return Ni(e.start)&&(e.left=e.start),Ni(e.end)&&(e.right=e.end),e}function CE(e,t){return{id:yE(e,t),border:{width:1,color:"#000",cornerVisible:!1},row:e,col:t,top:{hide:!0},bottom:{hide:!0},start:{hide:!0},end:{hide:!0}}}function kE(e,t){let r=!1;return Ai(e.getSelectedRange(),(n=>{n.forAll(((n,i)=>{if(n<0||i<0)return;const o=e.getCellMeta(n,i).borders;if(o){if(!t)return r=!0,!1;if(!go(o[t],"hide")||!1===o[t].hide)return r=!0,!1}}))})),r}function xE(e){return`<span class="selected">${String.fromCharCode(10003)}</span>${e}`}const EE=new Map([["left","start"],["right","end"]]);function TE(e){const t=e.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let e=this.getTranslatedPhrase(Vd);return kE(this,t)&&(e=xE(e)),e},callback(r,n){const i=kE(this,t);e.prepareBorder(n,t,i)}}}function _E(e){return{key:"borders:bottom",name(){let e=this.getTranslatedPhrase(zd);return kE(this,"bottom")&&(e=xE(e)),e},callback(t,r){const n=kE(this,"bottom");e.prepareBorder(r,"bottom",n)}}}function AE(e){const t=e.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let e=this.getTranslatedPhrase(qd);return kE(this,t)&&(e=xE(e)),e},callback(r,n){const i=kE(this,t);e.prepareBorder(n,t,i)}}}function RE(e){return{key:"borders:no_borders",name(){return this.getTranslatedPhrase(Gd)},callback(t,r){e.prepareBorder(r,"noBorders")},disabled(){return!kE(this)}}}function OE(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function ME(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function IE(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}const PE="customBorders";var NE=new WeakSet;class DE extends Fy{constructor(){super(...arguments),OE(this,NE),ME(this,"savedBorders",[])}static get PLUGIN_KEY(){return PE}static get PLUGIN_PRIORITY(){return 90}isEnabled(){return!!this.hot.getSettings()[PE]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",(e=>IE(NE,this,FE).call(this,e))),this.addHook("init",(()=>IE(NE,this,LE).call(this))),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(e,t){let r=["top","bottom","start","end"],n=null;t&&(this.checkSettingsCohesion([t]),r=Object.keys(t),n=wE(t));const i=qg(zg(e),{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)});Ai(e,(e=>{i(e).forAll(((e,t)=>{Ai(r,(r=>{this.prepareBorderFromCustomAdded(e,t,n,function(e){var t;return null!==(t=EE.get(e))&&void 0!==t?t:e}(r))}))}))})),this.hot.view.render()}getBorders(e){if(!Array.isArray(e))return this.savedBorders;const t=qg(zg(e),{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)}),r=[];return Ai(e,(e=>{t(e).forAll(((e,t)=>{Ai(this.savedBorders,(n=>{n.row===e&&n.col===t&&r.push(SE(n))}))}))})),r}clearBorders(e){e?this.setBorders(e):(Ai(this.savedBorders,(e=>{this.clearBordersFromSelectionSettings(e.id),this.clearNullCellRange(),this.hot.removeCellMeta(e.row,e.col,"borders")})),this.savedBorders.length=0)}insertBorderIntoSettings(e,t){this.checkSavedBorders(e)||this.savedBorders.push(e);const r=this.hot._createCellRange(this.hot._createCellCoords(e.row,e.col));this.checkCustomSelections(e,r,t)||this.hot.selection.highlight.addCustomSelection({border:e,visualCellRange:r})}prepareBorderFromCustomAdded(e,t,r,n){const i=this.hot.countRows(),o=this.hot.countCols();if(e>=i||t>=o)return;let a=CE(e,t);var s,l;r&&(s=a,go(l=r,"border")&&l.border&&(s.border=l.border),go(l,"top")&&Ni(l.top)&&(l.top?(so(l.top)||(l.top={width:1,color:"#000"}),s.top=l.top):(l.top={hide:!0},s.top=l.top)),go(l,"bottom")&&Ni(l.bottom)&&(l.bottom?(so(l.bottom)||(l.bottom={width:1,color:"#000"}),s.bottom=l.bottom):(l.bottom={hide:!0},s.bottom=l.bottom)),go(l,"start")&&Ni(l.start)&&(l.start?(so(l.start)||(l.start={width:1,color:"#000"}),s.start=l.start):(l.start={hide:!0},s.start=l.start)),go(l,"end")&&Ni(l.end)&&(l.end?(so(l.end)||(l.end={width:1,color:"#000"}),s.end=l.end):(l.end={hide:!0},s.end=l.end)),a=s,Ai(this.hot.selection.highlight.customSelections,(e=>{if(a.id===e.settings.id)return Object.assign(e.settings,r),a.id=e.settings.id,a.top=e.settings.top,a.bottom=e.settings.bottom,a.start=e.settings.start,a.end=e.settings.end,!1}))),this.hot.setCellMeta(e,t,"borders",SE(a)),this.insertBorderIntoSettings(a,n)}prepareBorderFromCustomAddedRange(e,t){const r=Math.min(e.to.row,this.hot.countRows()-1),n=Math.min(e.to.col,this.hot.countCols()-1);ja(e.from.row,r,(r=>{ja(e.from.col,n,(n=>{const i=CE(r,n);let o=0;r===e.from.row&&go(t,"top")&&(o+=1,i.top=t.top),r===e.to.row&&go(t,"bottom")&&(o+=1,i.bottom=t.bottom),n===e.from.col&&go(t,"start")&&(o+=1,i.start=t.start),n===e.to.col&&go(t,"end")&&(o+=1,i.end=t.end),o>0&&(this.hot.setCellMeta(r,n,"borders",SE(i)),this.insertBorderIntoSettings(i))}))}))}removeAllBorders(e,t){const r=yE(e,t);this.spliceBorder(r),this.clearBordersFromSelectionSettings(r),this.clearNullCellRange(),this.hot.removeCellMeta(e,t,"borders")}setBorder(e,t,r,n){let i=this.hot.getCellMeta(e,t).borders;if(i=i&&void 0!==i.border?wE(i):CE(e,t),n){i[r]={hide:!0};if(4===this.countHide(i))this.removeAllBorders(e,t);else{this.checkCustomSelectionsFromContextMenu(i,r,n)||this.insertBorderIntoSettings(i),this.hot.setCellMeta(e,t,"borders",SE(i))}}else{i[r]={width:1,color:"#000"};this.checkCustomSelectionsFromContextMenu(i,r,n)||this.insertBorderIntoSettings(i),this.hot.setCellMeta(e,t,"borders",SE(i))}}prepareBorder(e,t,r){Ai(e,(e=>{let{start:n,end:i}=e;if(n.row===i.row&&n.col===i.col)"noBorders"===t?this.removeAllBorders(n.row,n.col):this.setBorder(n.row,n.col,t,r);else switch(t){case"noBorders":ja(n.col,i.col,(e=>{ja(n.row,i.row,(t=>{this.removeAllBorders(t,e)}))}));break;case"top":ja(n.col,i.col,(e=>{this.setBorder(n.row,e,t,r)}));break;case"bottom":ja(n.col,i.col,(e=>{this.setBorder(i.row,e,t,r)}));break;case"start":ja(n.row,i.row,(e=>{this.setBorder(e,n.col,t,r)}));break;case"end":ja(n.row,i.row,(e=>{this.setBorder(e,i.col,t,r)}))}}))}createCustomBorders(e){Ai(e,(e=>{const t=wE(e);e.range?this.prepareBorderFromCustomAddedRange(e.range,t):this.prepareBorderFromCustomAdded(e.row,e.col,t)}))}countHide(e){const{top:t,bottom:r,start:n,end:i}=e;return Ei([t,r,n,i],((e,t)=>{let r=e;return t&&t.hide&&(r+=1),r}),0)}clearBordersFromSelectionSettings(e){const t=_i(this.hot.selection.highlight.customSelections,(e=>e.settings.id)).indexOf(e);t>-1&&this.hot.selection.highlight.customSelections[t].clear()}clearNullCellRange(){Ai(this.hot.selection.highlight.customSelections,((e,t)=>{if(null===e.cellRange)return this.hot.selection.highlight.customSelections[t].destroy(),this.hot.selection.highlight.customSelections.splice(t,1),!1}))}hideBorders(){Ai(this.savedBorders,(e=>{this.clearBordersFromSelectionSettings(e.id),this.clearNullCellRange()}))}spliceBorder(e){const t=_i(this.savedBorders,(e=>e.id)).indexOf(e);t>-1&&this.savedBorders.splice(t,1)}checkSavedBorders(e){let t=!1;return 4===this.countHide(e)?(this.spliceBorder(e.id),t=!0):Ai(this.savedBorders,((r,n)=>{if(e.id===r.id)return this.savedBorders[n]=e,t=!0,!1})),t}checkCustomSelectionsFromContextMenu(e,t,r){let n=!1;return Ai(this.hot.selection.highlight.customSelections,(i=>{if(e.id===i.settings.id){return Ai(this.hot.view._wt.selectionManager.getBorderInstances(i),(e=>{e.toggleHiddenClass(t,r)})),n=!0,!1}})),n}checkCustomSelections(e,t,r){const n=this.countHide(e);let i=!1;return 4===n?(this.removeAllBorders(e.row,e.col),i=!0):Ai(this.hot.selection.highlight.customSelections,(n=>{if(e.id===n.settings.id){if(n.visualCellRange=t,n.commit(),r){Ai(this.hot.view._wt.selectionManager.getBorderInstances(n),(t=>{t.changeBorderStyle(r,e)}))}return i=!0,!1}})),i}changeBorderSettings(){const e=this.hot.getSettings()[PE];if(Array.isArray(e)){const t=no(e);this.checkSettingsCohesion(t),t.length||(this.savedBorders=t),this.createCustomBorders(t)}else void 0!==e&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(e){const t=e.some((e=>Ni(e.left)||Ni(e.right)));const r=function(e){return e.some((e=>Ni(e.start)||Ni(e.end)))}(e);if(t&&r)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&t)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}destroy(){super.destroy()}}function FE(e){var t;this.hot.getSettings()[PE]&&e.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(jd)},disabled(){const e=this.getSelectedRangeLast();return!e||(!!e.isSingleHeader()||this.selection.isSelectedByCorner())},submenu:{items:[(t=this,{key:"borders:top",name(){let e=this.getTranslatedPhrase(Wd);return kE(this,"top")&&(e=xE(e)),e},callback(e,r){const n=kE(this,"top");t.prepareBorder(r,"top",n)}}),TE(this),_E(this),AE(this),RE(this)]}})}function LE(){this.changeBorderSettings()}function HE(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function BE(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function UE(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}const jE="dragToScroll";var WE=new WeakSet;class VE extends Fy{constructor(){super(...arguments),HE(this,WE),BE(this,"boundaries",null),BE(this,"callback",null),BE(this,"listening",!1)}static get PLUGIN_KEY(){return jE}static get PLUGIN_PRIORITY(){return 100}isEnabled(){return!!this.hot.getSettings()[jE]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",(e=>UE(WE,this,zE).call(this,e))),this.addHook("afterOnCellCornerMouseDown",(e=>UE(WE,this,zE).call(this,e))),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{left:0,right:this.hot.rootWindow.innerWidth,top:0,bottom:this.hot.rootWindow.innerHeight};this.boundaries=e}setCallback(e){this.callback=e}check(e,t){let r=0,n=0;t<this.boundaries.top?n=t-this.boundaries.top:t>this.boundaries.bottom&&(n=t-this.boundaries.bottom),e<this.boundaries.left?r=e-this.boundaries.left:e>this.boundaries.right&&(r=e-this.boundaries.right),this.callback(r,n)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){const{rootWindow:e}=this.hot;let t=e;for(;t;)this.eventManager.addEventListener(t.document,"contextmenu",(()=>this.unlisten())),this.eventManager.addEventListener(t.document,"mouseup",(()=>this.unlisten())),this.eventManager.addEventListener(t.document,"mousemove",(e=>this.onMouseMove(e))),t=Pn(t)}unregisterEvents(){this.eventManager.clear()}onMouseMove(e){this.isListening()&&this.check(e.clientX,e.clientY)}destroy(){super.destroy()}}function zE(e){if(Fo(e))return;const t=this.hot.view._wt.wtOverlays.topOverlay.mainTableScrollableElement;this.setBoundaries(t!==this.hot.rootWindow?t.getBoundingClientRect():void 0),this.setCallback(((e,r)=>{var n,i;const o=null!==(n=t.scrollLeft)&&void 0!==n?n:t.scrollX,a=null!==(i=t.scrollTop)&&void 0!==i?i:t.scrollY;t.scroll(o+50*Math.sign(e),a+20*Math.sign(r))})),this.listen()}function qE(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function GE(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $E(e,t,r){return e.set(KE(e,t),r),r}function KE(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}Ko.getSingleton().register("afterDropdownMenuDefaultOptions"),Ko.getSingleton().register("beforeDropdownMenuShow"),Ko.getSingleton().register("afterDropdownMenuShow"),Ko.getSingleton().register("afterDropdownMenuHide"),Ko.getSingleton().register("afterDropdownMenuExecute");const YE="dropdownMenu",XE="changeType",JE=YE;var ZE=new WeakMap,QE=new WeakSet;class eT extends Fy{static get PLUGIN_KEY(){return YE}static get PLUGIN_PRIORITY(){return 230}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[xk,Ek,HC,Ak,HC,kk,HC,Tk,HC,Ck]}constructor(e){super(e),function(e,t){qE(e,t),t.add(e)}(this,QE),GE(this,"commandExecutor",new Sk(this.hot)),GE(this,"itemsFactory",null),GE(this,"menu",null),function(e,t,r){qE(e,t),t.set(e,r)}(this,ZE,!1),this.hot.addHook("afterGetColHeader",((e,t)=>KE(QE,this,nT).call(this,e,t)))}isEnabled(){return this.hot.getSettings()[YE]}enablePlugin(){var e=this;if(this.enabled)return;this.itemsFactory=new Hk(this.hot,eT.DEFAULT_ITEMS),this.addHook("beforeOnCellMouseDown",(function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return KE(QE,e,cT).call(e,...r)})),this.addHook("beforeViewportScrollHorizontally",(function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return KE(QE,e,lT).call(e,...r)}));const t=this.hot.getSettings()[YE],r={items:this.itemsFactory.getItems(t)};this.registerEvents(),"function"===typeof t.callback&&this.commandExecutor.setCommonCallback(t.callback),this.registerShortcuts(),super.enablePlugin(),this.callOnPluginsReady((()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",r),this.itemsFactory.setPredefinedItems(r.items);const n=this.itemsFactory.getItems(t);this.menu&&this.menu.destroy(),this.menu=new gx(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:t.uiContainer||this.hot.rootDocument.body}),this.hot.runHooks("beforeDropdownMenuSetItems",n),this.menu.setMenuItems(n),this.menu.addLocalHook("beforeOpen",(()=>KE(QE,this,iT).call(this))),this.menu.addLocalHook("afterOpen",(()=>KE(QE,this,oT).call(this))),this.menu.addLocalHook("afterSubmenuOpen",(e=>KE(QE,this,aT).call(this,e))),this.menu.addLocalHook("afterClose",(()=>KE(QE,this,sT).call(this))),this.menu.addLocalHook("executeCommand",(function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return e.executeCommand.call(e,...r)})),Ai(n,(e=>this.commandExecutor.registerCommand(e.key,e)))}))}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=()=>{const{highlight:e}=this.hot.getSelectedRangeLast();if((e.isHeader()&&-1===e.row||e.isCell())&&e.col>=0){this.hot.selectColumns(e.col,e.col,-1);const{from:t}=this.hot.getSelectedRangeLast(),r=VC(this.menu.container,this.hot.rootDocument),n=this.hot.getCell(-1,t.col,!0),i=n.getBoundingClientRect();this.open({left:i.left+r.left,top:i.top+n.offsetHeight+r.top},{left:i.width}),this.menu.getNavigator().toFirstItem()}};this.hot.getShortcutManager().getContext("grid").addShortcuts([{keys:[["Shift","Alt","ArrowDown"],["Control/Meta","Enter"]],callback:e,runOnlyIf:()=>{var e;const t=null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.highlight;return t&&this.hot.selection.isCellVisible(t)&&t.isHeader()&&!this.menu.isOpened()},captureCtrl:!0,group:JE},{keys:[["Shift","Alt","ArrowDown"]],callback:e,runOnlyIf:()=>{var e;const t=null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.highlight;return t&&this.hot.selection.isCellVisible(t)&&t.isCell()&&!this.menu.isOpened()},group:JE}])}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(JE)}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",(e=>KE(QE,this,rT).call(this,e)))}open(e){var t;let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{above:0,below:0,left:0,right:0};null!==(t=this.menu)&&void 0!==t&&t.isOpened()||(this.menu.open(),co(r,((e,t)=>{this.menu.setOffset(t,e)})),this.menu.setPosition(e))}close(){var e;null===(e=this.menu)||void 0===e||e.close()}executeCommand(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];this.commandExecutor.execute(e,...r)}setListening(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.menu.isOpened()&&(e?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function tT(e){e.getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Control/Meta","A"]],callback:()=>!1}])}function rT(e){if(Un(e.target,XE)){const t=VC(this.menu.container,this.hot.rootDocument),r=e.target.getBoundingClientRect();e.stopPropagation(),$E(ZE,this,!1),this.open({left:r.left+t.left,top:r.top+e.target.offsetHeight+3+t.top},{left:r.width})}}function nT(e,t){const r=t.parentNode;if(!r)return;const n=r.parentNode.childNodes,i=Array.prototype.indexOf.call(n,r);if(e<0||i!==n.length-1)return;const o=t.querySelector(`.${XE}`);if(this.enabled&&o)return;if(!this.enabled)return void(o&&o.parentNode.removeChild(o));const a=this.hot.rootDocument.createElement("button");a.className=XE,a.type="button",a.tabIndex=-1,this.hot.getSettings().ariaTags&&(Vn(a,[wn(),yn(" ")]),Vn(t,[Sn("menu")])),a.onclick=function(){return!1},t.firstChild.insertBefore(a,t.firstChild.firstChild)}function iT(){this.hot.runHooks("beforeDropdownMenuShow",this)}function oT(){this.hot.runHooks("afterDropdownMenuShow",this),KE(QE,this,tT).call(this,this.menu)}function aT(e){KE(QE,this,tT).call(this,e)}function sT(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}function lT(e){return function(e,t){return e.get(KE(e,t))}(ZE,this)?null:e}function cT(e){Un(e.target,XE)&&$E(ZE,this,!0)}function uT(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}eT.SEPARATOR={name:HC};const hT=class{constructor(e){uT(this,"hot",void 0),uT(this,"options",{}),this.hot=e}setOptions(e){this.options=e}getData(){const{startRow:e,startCol:t,endRow:r,endCol:n}=this._getDataRange(),i=this.options,o=[];return ja(e,r,(e=>{const r=[];!i.exportHiddenRows&&this._isHiddenRow(e)||(ja(t,n,(t=>{!i.exportHiddenColumns&&this._isHiddenColumn(t)||r.push(this.hot.getDataAtCell(e,t))})),o.push(r))})),o}getRowHeaders(){const e=[];if(this.options.rowHeaders){const{startRow:t,endRow:r}=this._getDataRange(),n=this.hot.getRowHeader();ja(t,r,(t=>{!this.options.exportHiddenRows&&this._isHiddenRow(t)||e.push(n[t])}))}return e}getColumnHeaders(){const e=[];if(this.options.columnHeaders){const{startCol:t,endCol:r}=this._getDataRange(),n=this.hot.getColHeader();ja(t,r,(t=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(t)||e.push(n[t])}))}return e}_getDataRange(){const e=this.hot.countCols()-1,t=this.hot.countRows()-1;let[r=0,n=0,i=t,o=e]=this.options.range;return r=Math.max(r,0),n=Math.max(n,0),i=Math.min(i,t),o=Math.min(o,e),{startRow:r,startCol:n,endRow:i,endCol:o}}_isHiddenRow(e){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(e))}_isHiddenColumn(e){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(e))}};function dT(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class fT{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(e,t){dT(this,"dataProvider",void 0),dT(this,"options",void 0),this.dataProvider=e,this.options=this._mergeOptions(t),this.dataProvider.setOptions(this.options)}_mergeOptions(e){let t=io(this.constructor.DEFAULT_OPTIONS);const r=new Date;return t=to(io(fT.DEFAULT_OPTIONS),t),t=to(t,e),t.filename=fn(t.filename,{YYYY:r.getFullYear(),MM:`${r.getMonth()+1}`.padStart(2,"0"),DD:`${r.getDate()}`.padStart(2,"0")}),t}}const gT=fT,pT=String.fromCharCode(13),mT=String.fromCharCode(34),vT=String.fromCharCode(10);const bT=class extends gT{static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:"\r\n"}}export(){const e=this.options,t=this.dataProvider.getData();let r=this.dataProvider.getColumnHeaders();const n=r.length>0,i=this.dataProvider.getRowHeaders(),o=i.length>0;let a=e.bom?String.fromCharCode(65279):"";return n&&(r=_i(r,(e=>this._escapeCell(e,!0))),o&&(a+=e.columnDelimiter),a+=r.join(e.columnDelimiter),a+=e.rowDelimiter),Ai(t,((t,r)=>{r>0&&(a+=e.rowDelimiter),o&&(a+=this._escapeCell(i[r])+e.columnDelimiter),a+=t.map((e=>this._escapeCell(e))).join(e.columnDelimiter)})),a}_escapeCell(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=Pi(e);return""!==r&&(t||r.indexOf(pT)>=0||r.indexOf(mT)>=0||r.indexOf(vT)>=0||r.indexOf(this.options.columnDelimiter)>=0)&&(r=r.replace(new RegExp('"',"g"),'""'),r=`"${r}"`),r}},yT="csv",wT={[yT]:bT};class ST extends Fy{static get PLUGIN_KEY(){return"exportFile"}static get PLUGIN_PRIORITY(){return 240}isEnabled(){return!0}exportAsString(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._createTypeFormatter(e,t).export()}exportAsBlob(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._createBlob(this._createTypeFormatter(e,t))}downloadFile(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{rootDocument:r,rootWindow:n}=this.hot,i=this._createTypeFormatter(e,t),o=this._createBlob(i),a=n.URL||n.webkitURL,s=r.createElement("a"),l=`${i.options.filename}.${i.options.fileExtension}`;if(void 0!==s.download){const e=a.createObjectURL(o);s.style.display="none",s.setAttribute("href",e),s.setAttribute("download",l),r.body.appendChild(s),s.dispatchEvent(new MouseEvent("click")),r.body.removeChild(s),setTimeout((()=>{a.revokeObjectURL(e)}),100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(o,l)}_createTypeFormatter(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!wT[e])throw new Error(`Export format type "${e}" is not supported.`);return function(e,t,r){return"function"===typeof wT[e]?new wT[e](t,r):null}(e,new hT(this.hot),t)}_createBlob(e){let t=null;return"undefined"!==typeof Blob&&(t=new Blob([e.export()],{type:`${e.options.mimeType};charset=${e.options.encoding}`})),t}}function CT(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class kT{constructor(e,t){let{id:r,stateless:n=!0}=t;CT(this,"hot",void 0),CT(this,"id",void 0),CT(this,"elements",[]),CT(this,"hidden",!1),CT(this,"stateId",""),CT(this,"state",void 0),this.hot=e,this.id=r,this.stateId=`Filters.component.${this.id}`,this.state=n?null:this.hot.columnIndexMapper.registerMap(this.stateId,new Ph)}getElements(){return this.elements}reset(){Ai(this.elements,(e=>e.reset()))}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return null===this.hot||this.hidden}restoreState(e){this.state&&this.setState(this.state.getValueAtIndex(e))}setState(){throw new Error("The state setting logic is not implemented")}saveState(e){this.state&&this.state.setValueAtIndex(e,this.getState())}getState(){throw new Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),Ai(this.elements,(e=>e.destroy())),this.state=null,this.elements=null,this.hot=null}}oo(kT,wh);const xT={};function ET(e,t){if(!xT[e])throw Error(`Filter condition "${e}" does not exist.`);const{condition:r,descriptor:n}=xT[e];let i=t;return n.inputValuesDecorator&&(i=n.inputValuesDecorator(i)),function(e){return r.apply(e.meta.instance,[].concat([e],[i]))}}function TT(e){if(!xT[e])throw Error(`Filter condition "${e}" does not exist.`);return xT[e].descriptor}function _T(e,t,r){r.key=e,xT[e]={condition:t,descriptor:r}}const AT="none";_T(AT,(function(){return!0}),{name:tf,inputsCount:0,showOperators:!1});const RT="empty";_T(RT,(function(e){return Fi(e.value)}),{name:rf,inputsCount:0,showOperators:!0});const OT="not_empty";_T(OT,(function(e,t){return!ET(RT,t)(e)}),{name:nf,inputsCount:0,showOperators:!0});const MT="eq";_T(MT,(function(e,t){let[r]=t;return Pi(e.value).toLocaleLowerCase(e.meta.locale)===Pi(r)}),{name:of,inputsCount:1,showOperators:!0});const IT="neq";_T(IT,(function(e,t){return!ET(MT,t)(e)}),{name:af,inputsCount:1,showOperators:!0});_T("gt",(function(e,t){let[r]=t,n=r;return"numeric"===e.meta.type&&(n=parseFloat(n,10)),e.value>n}),{name:df,inputsCount:1,showOperators:!0});_T("gte",(function(e,t){let[r]=t,n=r;return"numeric"===e.meta.type&&(n=parseFloat(n,10)),e.value>=n}),{name:ff,inputsCount:1,showOperators:!0});_T("lt",(function(e,t){let[r]=t,n=r;return"numeric"===e.meta.type&&(n=parseFloat(n,10)),e.value<n}),{name:gf,inputsCount:1,showOperators:!0});_T("lte",(function(e,t){let[r]=t,n=r;return"numeric"===e.meta.type&&(n=parseFloat(n,10)),e.value<=n}),{name:pf,inputsCount:1,showOperators:!0});const PT="date_after";_T(PT,(function(e,t){let[r]=t;const n=Ci(e.value,e.meta.dateFormat),i=Ci(r,e.meta.dateFormat);return!(!n.isValid()||!i.isValid())&&n.diff(i)>=0}),{name:bf,inputsCount:1,showOperators:!0});const NT="date_before";_T(NT,(function(e,t){let[r]=t;const n=Ci(e.value,e.meta.dateFormat),i=Ci(r,e.meta.dateFormat);return!(!n.isValid()||!i.isValid())&&n.diff(i)<=0}),{name:yf,inputsCount:1,showOperators:!0});const DT="between";_T(DT,(function(e,t){let[r,n]=t,i=r,o=n;if("numeric"===e.meta.type){const e=parseFloat(i,10),t=parseFloat(o,10);i=Math.min(e,t),o=Math.max(e,t)}else if("date"===e.meta.type){const t=ET(NT,[o]),r=ET(PT,[i]);return t(e)&&r(e)}return e.value>=i&&e.value<=o}),{name:mf,inputsCount:2,showOperators:!0});const FT="not_between";_T(FT,(function(e,t){return!ET(DT,t)(e)}),{name:vf,inputsCount:2,showOperators:!0});const LT="begins_with";_T(LT,(function(e,t){let[r]=t;return Pi(e.value).toLocaleLowerCase(e.meta.locale).startsWith(Pi(r))}),{name:sf,inputsCount:1,showOperators:!0});const HT="ends_with";_T(HT,(function(e,t){let[r]=t;return Pi(e.value).toLocaleLowerCase(e.meta.locale).endsWith(Pi(r))}),{name:lf,inputsCount:1,showOperators:!0});const BT="contains";_T(BT,(function(e,t){let[r]=t;return Pi(e.value).toLocaleLowerCase(e.meta.locale).indexOf(Pi(r))>=0}),{name:cf,inputsCount:1,showOperators:!0});const UT="not_contains";_T(UT,(function(e,t){return!ET(BT,t)(e)}),{name:uf,inputsCount:1,showOperators:!0});const jT="date_tomorrow";_T(jT,(function(e){const t=Ci(e.value,e.meta.dateFormat);return!!t.isValid()&&t.isSame(Ci().subtract(-1,"days").startOf("day"),"d")}),{name:Sf,inputsCount:0});const WT="date_today";_T(WT,(function(e){const t=Ci(e.value,e.meta.dateFormat);return!!t.isValid()&&t.isSame(Ci().startOf("day"),"d")}),{name:wf,inputsCount:0});const VT="date_yesterday";_T(VT,(function(e){const t=Ci(e.value,e.meta.dateFormat);return!!t.isValid()&&t.isSame(Ci().subtract(1,"days").startOf("day"),"d")}),{name:Cf,inputsCount:0});const zT="numeric",qT="text",GT="date",$T={[zT]:[AT,HC,RT,OT,HC,MT,IT,HC,"gt","gte","lt","lte",DT,FT],[qT]:[AT,HC,RT,OT,HC,MT,IT,HC,LT,HT,HC,BT,UT],[GT]:[AT,HC,RT,OT,HC,MT,IT,HC,NT,PT,DT,HC,jT,WT,VT]};function KT(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const YT="built",XT="building",JT=["click","input","keydown","keypress","keyup","focus","blur","change"];class ZT{static get DEFAULTS(){return io({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(e,t){KT(this,"hot",void 0),KT(this,"eventManager",new ca(this)),KT(this,"options",void 0),KT(this,"_element",void 0),KT(this,"buildState",void 0),this.hot=e,this.options=to(ZT.DEFAULTS,t),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName)}setValue(e){this.options.value=e,this.update()}getValue(){return this.options.value}get element(){return this.buildState===XT?this._element:this.buildState===YT?(this.update(),this._element):(this.buildState=XT,this.build(),this.buildState=YT,this._element)}isBuilt(){return this.buildState===YT}translateIfPossible(e){return"string"===typeof e&&e.startsWith(Qd)?this.hot.getTranslatedPhrase(e):e}build(){const e=(e,t)=>{this.eventManager.addEventListener(e,t,(e=>this.runLocalHooks(t,e,this)))};if(this.buildState||(this.buildState=XT),this._element.setAttribute("data-hot-input",!0),void 0!==this.options.tabIndex&&this._element.setAttribute("tabindex",this.options.tabIndex),void 0!==this.options.role&&this._element.setAttribute("role",this.options.role),this.options.className&&jn(this._element,this.options.className),this.options.children.length)Ai(this.options.children,(e=>this._element.appendChild(e.element)));else if(this.options.wrapIt){const t=this.hot.rootDocument.createElement(this.options.tagName);t.setAttribute("data-hot-input",!0),co(this.options,((e,r)=>{void 0!==t[r]&&"className"!==r&&"tagName"!==r&&"children"!==r&&(t[r]=this.translateIfPossible(e))})),this._element.appendChild(t),Ai(JT,(r=>e(t,r)))}else Ai(JT,(t=>e(this._element,t)))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}}function QT(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function e_(e,t){return e.get(t_(e,t))}function t_(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}oo(ZT,wh);var r_=new WeakMap,n_=new WeakSet;class i_ extends ZT{static get DEFAULTS(){return io({placeholder:"",type:"text",tagName:"input",tabIndex:-1})}constructor(e,t){super(e,to(i_.DEFAULTS,t)),function(e,t){QT(e,t),t.add(e)}(this,n_),function(e,t,r){QT(e,t),t.set(e,r)}(this,r_,void 0),this.registerHooks()}registerHooks(){this.addLocalHook("keyup",(e=>t_(n_,this,o_).call(this,e)))}build(){super.build();const e=this.hot.rootDocument.createElement("div");!function(e,t,r){e.set(t_(e,t),r)}(r_,this,this._element.firstChild),jn(this._element,"htUIInput"),jn(e,"htUIInputIcon"),this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(e_(r_,this).type=this.options.type,e_(r_,this).placeholder=this.translateIfPossible(this.options.placeholder),e_(r_,this).value=this.translateIfPossible(this.options.value))}focus(){this.isBuilt()&&e_(r_,this).focus()}}function o_(e){this.options.value=e.target.value}function a_(e,t,r){s_(e,t),t.set(e,r)}function s_(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function l_(e,t,r){return e.set(u_(e,t),r),r}function c_(e,t){return e.get(u_(e,t))}function u_(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var h_=new WeakMap,d_=new WeakMap,f_=new WeakMap,g_=new WeakMap,p_=new WeakMap,m_=new WeakSet;class v_ extends ZT{static get DEFAULTS(){return io({className:"htUISelect",wrapIt:!1,tabIndex:-1})}constructor(e,t){super(e,to(v_.DEFAULTS,t)),function(e,t){s_(e,t),t.add(e)}(this,m_),a_(this,h_,null),a_(this,d_,[]),a_(this,f_,void 0),a_(this,g_,void 0),a_(this,p_,void 0),this.registerHooks()}getMenu(){return c_(h_,this)}registerHooks(){this.addLocalHook("click",(()=>u_(m_,this,w_).call(this)))}setItems(e){l_(d_,this,this.translateNames(e)),c_(h_,this)&&c_(h_,this).setMenuItems(c_(d_,this))}translateNames(e){return Ai(e,(e=>{e.name=this.translateIfPossible(e.name)})),e}build(){super.build(),l_(h_,this,new gx(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer})),c_(h_,this).setMenuItems(c_(d_,this));const e=new ZT(this.hot,{className:"htUISelectCaption"}),t=new ZT(this.hot,{className:"htUISelectDropdown"});l_(f_,this,e),l_(g_,this,e.element),l_(p_,this,t),this.hot.getSettings().ariaTags&&(Vn(t.element,[wn()]),Vn(this._element,[["role","listbox"]])),Ai([e,t],(e=>this._element.appendChild(e.element))),c_(h_,this).addLocalHook("select",(e=>u_(m_,this,b_).call(this,e))),c_(h_,this).addLocalHook("afterClose",(()=>u_(m_,this,y_).call(this))),this.update()}update(){if(!this.isBuilt())return;let e;e=this.options.value?this.options.value.name:c_(h_,this).hot.getTranslatedPhrase(tf),c_(g_,this).textContent=e,super.update()}openOptions(){const e=this.element.getBoundingClientRect();c_(h_,this)&&(c_(h_,this).open(),c_(h_,this).setPosition({left:this.hot.isLtr()?e.left-5:e.left-31,top:e.top-1,width:e.width,height:e.height}),c_(h_,this).getNavigator().toFirstItem(),c_(h_,this).getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:e=>{this.closeOptions(),this.runLocalHooks("tabKeydown",e)}},{keys:[["Control/Meta","A"]],callback:()=>!1}]))}closeOptions(){c_(h_,this)&&c_(h_,this).close()}focus(){this.isBuilt()&&this.element.focus()}destroy(){c_(h_,this)&&(c_(h_,this).destroy(),l_(h_,this,null)),c_(f_,this)&&c_(f_,this).destroy(),c_(p_,this)&&c_(p_,this).destroy(),super.destroy()}}function b_(e){e.name!==HC&&(this.options.value=e,this.update(),this.runLocalHooks("select",this.options.value))}function y_(){this.runLocalHooks("afterClose")}function w_(){this.openOptions()}function S_(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function C_(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function k_(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var x_=new WeakSet;class E_ extends kT{constructor(e,t){super(e,{id:t.id,stateless:!1}),S_(this,x_),C_(this,"name",""),C_(this,"addSeparator",!1),this.name=t.name,this.addSeparator=t.addSeparator,this.elements.push(new v_(this.hot,{menuContainer:t.menuContainer})),this.elements.push(new i_(this.hot,{placeholder:Pf})),this.elements.push(new i_(this.hot,{placeholder:Nf})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",(e=>k_(x_,this,T_).call(this,e))).addLocalHook("afterClose",(()=>this.runLocalHooks("afterClose"))).addLocalHook("tabKeydown",(e=>this.runLocalHooks("selectTabKeydown",e))),Ai(this.getInputElements(),(e=>{e.addLocalHook("keydown",(e=>k_(x_,this,__).call(this,e)))}))}setState(e){if(this.reset(),!e)return;const t=io(e.command);t.name.startsWith(ef)&&(t.name=this.hot.getTranslatedPhrase(t.name)),this.getSelectElement().setValue(t),Ai(e.args,((e,r)=>{if(r>t.inputsCount-1)return!1;const n=this.getInputElement(r);n.setValue(e),n[t.inputsCount>r?"show":"hide"](),r||this.hot._registerTimeout((()=>n.focus()),10)}))}getState(){const e=this.getSelectElement().getValue()||TT(AT),t=[];return Ai(this.getInputElements(),((r,n)=>{e.inputsCount>n&&t.push(r.getValue())})),{command:e,args:t}}updateState(e,t){const r=TT(e?e.name:AT);this.state.setValueAtIndex(t,{command:r,args:e?e.args:[]}),e||Ai(this.getInputElements(),(e=>e.setValue(null)))}getSelectElement(){return this.elements.filter((e=>e instanceof v_))[0]}getInputElement(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.getInputElements()[e]}getInputElements(){return this.elements.filter((e=>e instanceof i_))}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t,r,n,i,o)=>{jn(t.parentNode,"htFiltersMenuCondition"),this.addSeparator&&jn(t.parentNode,"border");const a=this.hot.rootDocument.createElement("div");return jn(a,"htFiltersMenuLabel"),a.textContent=o,t.appendChild(a),Ai(this.elements,(e=>t.appendChild(e.element))),t}}}reset(){const e=this.hot.getPlugin("filters").getSelectedColumn();let t=[TT(AT)];if(null!==e){const{visualIndex:r}=e;t=function(e){const t=[];let r=e;return $T[r]||(r=qT),Ai($T[r],(e=>{let r;r=e===HC?{name:HC}:io(TT(e)),t.push(r)})),t}(this.hot.getDataType(0,r,this.hot.countRows(),r))}Ai(this.getInputElements(),(e=>e.hide())),this.getSelectElement().setItems(t),super.reset(),this.getSelectElement().setValue(t[0])}}function T_(e){Ai(this.getInputElements(),((t,r)=>{t[e.inputsCount>r?"show":"hide"](),0===r&&this.hot._registerTimeout((()=>t.focus()),10)})),this.runLocalHooks("change",e)}function __(e){Po(e.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),No(e))}const A_={};function R_(e,t,r){A_[e]={name:t,func:r}}const O_="conjunction";R_(O_,Ef,(function(e,t){return e.every((e=>e.func(t)))}));const M_="disjunction";R_(M_,Tf,(function(e,t){return e.some((e=>e.func(t)))}));const I_="disjunctionWithExtraCondition";function P_(e,t,r){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,r)}function N_(e,t){return e.get(F_(e,t))}function D_(e,t,r){return e.set(F_(e,t),r),r}function F_(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}R_(I_,Tf,(function(e,t){if(e.length<3)throw Error("Operation doesn't work on less then three conditions.");return e.slice(0,e.length-1).some((e=>e.func(t)))&&e[e.length-1].func(t)}));var L_=new WeakMap,H_=new WeakMap;class B_ extends ZT{static get DEFAULTS(){return io({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(e,t){super(e,to(B_.DEFAULTS,t)),P_(this,L_,void 0),P_(this,H_,void 0)}build(){super.build();const e=this.hot.rootDocument.createElement("label");e.textContent=this.translateIfPossible(this.options.label.textContent),e.htmlFor=this.translateIfPossible(this.options.label.htmlFor),D_(H_,this,e),D_(L_,this,this._element.firstChild),N_(L_,this).checked=this.options.checked,this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(N_(H_,this).textContent=this.translateIfPossible(this.options.label.textContent))}isChecked(){return!!this.isBuilt()&&N_(L_,this).checked}setChecked(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.isBuilt()&&(N_(L_,this).checked=e)}focus(){this.isBuilt()&&N_(L_,this).focus()}}function U_(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function j_(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var W_=new WeakSet;class V_ extends kT{constructor(e,t){super(e,{id:t.id,stateless:!1}),U_(this,W_),j_(this,"name",""),this.name=t.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t)=>(jn(t.parentNode,"htFiltersMenuOperators"),Ai(this.elements,(e=>t.appendChild(e.element))),t)}}buildOperatorsElement(){const e=[O_,M_];Ai(e,(t=>{const r=new B_(this.hot,{name:"operator",label:{htmlFor:t,textContent:(n=t,A_[n].name)},value:t,checked:t===e[0],id:t});var n;r.addLocalHook("change",(e=>function(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}(W_,this,z_).call(this,e))),this.elements.push(r)}))}setChecked(e){if(this.elements.length<e)throw Error(Ii`Radio button with index ${e} doesn't exist.`);Ai(this.elements,((t,r)=>{t.setChecked(r===e)}))}getActiveOperationId(){const e=this.elements.find((e=>e instanceof B_&&e.isChecked()));return e?e.getValue():O_}getState(){return this.getActiveOperationId()}setState(e){this.reset(),e&&this.getActiveOperationId()!==e&&Ai(this.elements,(t=>{t.setChecked(t.getValue()===e)}))}updateState(){let e=arguments.length>1?arguments[1]:void 0,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O_;t===I_&&(t=M_),this.state.setValueAtIndex(e,t)}reset(){this.setChecked(0)}}function z_(e){this.setState(e.target.value)}!function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};bo||(bo="object"===typeof Intl?new Intl.Collator(e,t).compare:"function"===typeof String.prototype.localeCompare?(e,t)=>`${e}`.localeCompare(t):(e,t)=>e===t?0:e>t?-1:1)}();function q_(e,t){let r=e;return""===r&&(r=`(${t})`),r}const G_=new Set([1]).has(1),$_=G_&&"function"===typeof Array.from;function K_(e){let t=e;return G_&&(t=new Set(t)),function(e){let r;return r=G_?t.has(e):!!~t.indexOf(e),r}}function Y_(e){return null===e||void 0===e?"":e}function X_(e){let t=e;return t=$_?Array.from(new Set(t)):Ri(t),t=t.sort(((e,t)=>"number"===typeof e&&"number"===typeof t?e-t:e===t?0:e>t?1:-1)),t}function J_(e,t,r,n){const i=[],o=e===t;let a;return o||(a=K_(t)),Ai(e,(e=>{let t=!1;(o||a(e))&&(t=!0);const s={checked:t,value:e,visualValue:q_(e,r)};n&&n(s),i.push(s)})),i}function Z_(e,t,r){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,r)}function Q_(e,t){return e.get(eA(e,t))}function eA(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var tA=new WeakMap;class rA extends ZT{static get DEFAULTS(){return io({href:"#",tagName:"a",tabIndex:-1,role:"button"})}constructor(e,t){super(e,to(rA.DEFAULTS,t)),Z_(this,tA,void 0)}build(){super.build(),function(e,t,r){e.set(eA(e,t),r)}(tA,this,this._element.firstChild)}update(){this.isBuilt()&&(Q_(tA,this).textContent=this.translateIfPossible(this.options.textContent))}focus(){this.isBuilt()&&Q_(tA,this).focus()}activate(){Q_(tA,this).click()}}function nA(e,t,r){iA(e,t),t.set(e,r)}function iA(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function oA(e,t){return e.get(sA(e,t))}function aA(e,t,r){return e.set(sA(e,t),r),r}function sA(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}const lA="multipleSelect.itemBox";var cA=new WeakMap,uA=new WeakMap,hA=new WeakMap,dA=new WeakMap,fA=new WeakMap,gA=new WeakMap,pA=new WeakSet;class mA extends ZT{static get DEFAULTS(){return io({className:"htUIMultipleSelect",value:[]})}constructor(e,t){super(e,to(mA.DEFAULTS,t)),function(e,t){iA(e,t),t.add(e)}(this,pA),nA(this,cA,[]),nA(this,uA,void 0),nA(this,hA,void 0),nA(this,dA,void 0),nA(this,fA,void 0),nA(this,gA,void 0),aA(dA,this,new i_(this.hot,{placeholder:If,className:"htUIMultipleSelectSearch"})),aA(fA,this,new rA(this.hot,{textContent:Af,className:"htUISelectAll"})),aA(gA,this,new rA(this.hot,{textContent:Rf,className:"htUIClearAll"})),this.registerHooks()}getItemsBox(){return oA(uA,this)}registerHooks(){oA(dA,this).addLocalHook("keydown",(e=>sA(pA,this,bA).call(this,e))),oA(dA,this).addLocalHook("input",(e=>sA(pA,this,vA).call(this,e))),oA(fA,this).addLocalHook("click",(e=>sA(pA,this,yA).call(this,e))),oA(gA,this).addLocalHook("click",(e=>sA(pA,this,wA).call(this,e)))}setItems(e){aA(cA,this,e),oA(uA,this)&&oA(uA,this).loadData(oA(cA,this))}setLocale(e){aA(hA,this,e)}getLocale(){return oA(hA,this)}getItems(){return[...oA(cA,this)]}getValue(){return function(e){const t=[];return e.forEach((e=>{e.checked&&t.push(e.value)})),t}(oA(cA,this))}getSearchInputElement(){return oA(dA,this)}getSelectAllElement(){return oA(fA,this)}getClearAllElement(){return oA(gA,this)}isSelectedAllValues(){return oA(cA,this).length===this.getValue().length}build(){super.build();const{rootDocument:e}=this.hot,t=e.createElement("div"),r=new ZT(this.hot,{className:"htUISelectionControls",children:[oA(fA,this),oA(gA,this)]});this._element.appendChild(oA(dA,this).element),this._element.appendChild(r.element),this._element.appendChild(t);const n=t=>{if(!this._element)return;oA(uA,this)&&oA(uA,this).destroy(),jn(t,"htUIMultipleSelectHot"),aA(uA,this,new this.hot.constructor(t,{data:oA(cA,this),columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(e,t,r,n,i,o)=>{e.title=o.instance.getDataAtRowProp(t,o.label.property)},afterListen:()=>{this.runLocalHooks("focus",this)},beforeOnCellMouseUp:()=>{oA(uA,this).listen()},colWidths:()=>oA(uA,this).container.scrollWidth-gi(e),maxCols:1,autoWrapCol:!0,height:110,copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},layoutDirection:this.hot.isRtl()?"rtl":"ltr"})),oA(uA,this).init();const r=oA(uA,this).getShortcutManager().getContext("grid");r.removeShortcutsByKeys(["Tab"]),r.removeShortcutsByKeys(["Shift","Tab"]),r.addShortcut({keys:[["Escape"]],callback:e=>{this.runLocalHooks("keydown",e,this)},group:lA}),r.addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:e=>{oA(uA,this).deselectCell(),this.runLocalHooks("keydown",e,this),this.runLocalHooks("listTabKeydown",e,this)},group:lA})};n(t),this.hot._registerTimeout((()=>n(t)),100)}focus(){this.isBuilt()&&oA(uA,this).listen()}reset(){oA(dA,this).reset(),oA(fA,this).reset(),oA(gA,this).reset()}update(){this.isBuilt()&&(oA(uA,this).loadData(function(e,t){const r=K_(t);return e.map((e=>(e.checked=r(e.value),e)))}(oA(cA,this),this.options.value)),super.update())}destroy(){oA(uA,this)&&oA(uA,this).destroy(),oA(dA,this).destroy(),oA(gA,this).destroy(),oA(fA,this).destroy(),aA(dA,this,null),aA(gA,this,null),aA(fA,this,null),aA(uA,this,null),aA(cA,this,null),super.destroy()}}function vA(e){const t=e.target.value.toLocaleLowerCase(this.getLocale());let r;r=""===t?[...oA(cA,this)]:oA(cA,this).filter((e=>`${e.value}`.toLocaleLowerCase(this.getLocale()).indexOf(t)>=0)),oA(uA,this).loadData(r)}function bA(e){this.runLocalHooks("keydown",e,this);Ji(Po,e.keyCode)("ARROW_DOWN")&&(e.preventDefault(),No(e),oA(uA,this).listen(),oA(uA,this).selectCell(0,0))}function yA(e){const t=[];e.preventDefault(),oA(uA,this).getSourceData().forEach(((e,r)=>{e.checked=!0,t.push(ph(e,r)[0])})),oA(uA,this).setSourceDataAtCell(t)}function wA(e){const t=[];e.preventDefault(),oA(uA,this).getSourceData().forEach(((e,r)=>{e.checked=!1,t.push(ph(e,r)[0])})),oA(uA,this).setSourceDataAtCell(t)}const SA="by_value";function CA(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function kA(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function xA(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}_T(SA,(function(e,t){let[r]=t;return r(e.value)}),{name:"By value",inputsCount:0,inputValuesDecorator(e){let[t]=e;return[K_(t)]},showOperators:!1});var EA,TA=new WeakSet;class _A extends kT{constructor(e,t){super(e,{id:t.id,stateless:!1}),CA(this,TA),kA(this,"name",""),this.name=t.name,this.elements.push(new mA(this.hot)),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",(e=>xA(TA,this,AA).call(this,e))).addLocalHook("listTabKeydown",(e=>this.runLocalHooks("listTabKeydown",e))),this.hot.addHook("modifyFiltersMultiSelectValue",((e,t)=>xA(TA,this,OA).call(this,e,t)))}getElements(){const e=this.getMultipleSelectElement();return[e.getSearchInputElement(),e.getSelectAllElement(),e.getClearAllElement(),this.getMultipleSelectElement()]}setState(e){if(this.reset(),e&&e.command.key===SA){const t=this.getMultipleSelectElement();t.setItems(e.itemsSnapshot),t.setValue(e.args[0]),t.setLocale(e.locale)}}getState(){const e=this.getMultipleSelectElement(),t=e.getItems();return{command:{key:e.isSelectedAllValues()||!t.length?AT:SA},args:[e.getValue()],itemsSnapshot:t}}updateState(e){const t=(t,r,n,i,o)=>{const[a]=Ti(r,(e=>e.name===SA)),s={},l=this.hot.getTranslatedPhrase(_f);if(a){const r=i(t,o),c=_i(r,(e=>e.value)),u=new Map(r.map((e=>[e.value,this.hot.getCellMeta(e.meta.visualRow,e.meta.visualCol)]))),h=X_(c);n&&(a.args[0]=n);const d=[],f=J_(h,a.args[0],l,(e=>{e.checked&&d.push(e.value),xA(TA,this,RA).call(this,e,u)})),g=e.editedConditionStack.column;s.locale=this.hot.getCellMeta(0,g).locale,s.args=[d],s.command=TT(SA),s.itemsSnapshot=f}else s.args=[],s.command=TT(AT);this.state.setValueAtIndex(t,s)};t(e.editedConditionStack.column,e.editedConditionStack.conditions,e.conditionArgsChange,e.filteredRowsFactory),e.dependentConditionStacks.length&&t(e.dependentConditionStacks[0].column,e.dependentConditionStacks[0].conditions,e.conditionArgsChange,e.filteredRowsFactory,e.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter((e=>e instanceof mA))[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t,r,n,i,o)=>{jn(t.parentNode,"htFiltersMenuValue");const a=this.hot.rootDocument.createElement("div");return jn(a,"htFiltersMenuLabel"),a.textContent=o,t.appendChild(a),Ai(this.elements,(e=>t.appendChild(e.element))),t}}}reset(){const e=this.hot.getTranslatedPhrase(_f),t=this._getColumnVisibleValues(),r=t.map((e=>e.value)),n=new Map(t.map((e=>[e.value,e.meta]))),i=X_(r),o=J_(i,i,e,(e=>{xA(TA,this,RA).call(this,e,n)}));this.getMultipleSelectElement().setItems(o),super.reset(),this.getMultipleSelectElement().setValue(i);const a=this.hot.getPlugin("filters").getSelectedColumn();null!==a&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,a.visualIndex).locale)}_getColumnVisibleValues(){const e=this.hot.getPlugin("filters").getSelectedColumn();return null===e?[]:_i(this.hot.getDataAtCol(e.visualIndex),((t,r)=>({value:Y_(t),meta:this.hot.getCellMeta(r,e.visualIndex)})))}}function AA(e){Po(e.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),No(e))}function RA(e,t){this.hot.hasHook("modifyFiltersMultiSelectValue")&&(e.visualValue=this.hot.runHooks("modifyFiltersMultiSelectValue",e.visualValue,t.get(e.value)))}function OA(e,t){return"numeric"===t.type?oy(e,t):e}function MA(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function IA(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var PA=new WeakSet;class NA extends kT{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(e,t){super(e,{id:t.id,stateless:!0}),MA(this,PA),IA(this,"name",""),this.name=t.name,this.elements.push(new i_(this.hot,{type:"button",value:Of,className:"htUIButton htUIButtonOK",identifier:NA.BUTTON_OK})),this.elements.push(new i_(this.hot,{type:"button",value:Mf,className:"htUIButton htUIButtonCancel",identifier:NA.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){Ai(this.elements,(e=>{e.addLocalHook("click",((e,t)=>function(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}(PA,this,DA).call(this,e,t)))}))}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t)=>(jn(t.parentNode,"htFiltersMenuActionBar"),Ai(this.elements,(e=>t.appendChild(e.element))),t)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}}function DA(e,t){t.options.identifier===EA.BUTTON_OK?this.accept():this.cancel()}function FA(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}EA=NA;const LA="ConditionCollection.filteringStates";class HA{constructor(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];FA(this,"hot",void 0),FA(this,"isMapRegistrable",void 0),FA(this,"filteringStates",new Ph),this.hot=e,this.isMapRegistrable=t,!0===this.isMapRegistrable?this.hot.columnIndexMapper.registerMap(LA,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return 0===this.getFilteredColumns().length}isMatch(e,t){var r;const n=this.filteringStates.getValueAtIndex(t),i=null!==(r=null===n||void 0===n?void 0:n.conditions)&&void 0!==r?r:[],o=null===n||void 0===n?void 0:n.operation;return this.isMatchInConditions(i,e,o)}isMatchInConditions(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:O_;return!e.length||function(e){if(!A_[e])throw Error(`Operation with id "${e}" does not exist.`);const t=A_[e].func;return function(e,r){return t(e,r)}}(r)(e,t)}addCondition(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:O_,n=arguments.length>3?arguments[3]:void 0;const i=this.hot.getCellMeta(0,e).locale,o=_i(t.args,(e=>"string"===typeof e?e.toLocaleLowerCase(i):e)),a=t.name||t.command.key;this.runLocalHooks("beforeAdd",e);const s=this.getOperation(e);if(s){if(s!==r)throw Error(Ii`The column of index ${e} has been already applied with a \`${s}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if(Di(A_[r]))throw new Error(Ii`Unexpected operation named \`${r}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);const l=this.getConditions(e);0===l.length?this.filteringStates.setValueAtIndex(e,{operation:r,conditions:[{name:a,args:o,func:ET(a,o)}]},n):l.push({name:a,args:o,func:ET(a,o)}),this.runLocalHooks("afterAdd",e)}getConditions(e){var t,r;return null!==(t=null===(r=this.filteringStates.getValueAtIndex(e))||void 0===r?void 0:r.conditions)&&void 0!==t?t:[]}getOperation(e){var t;return null===(t=this.filteringStates.getValueAtIndex(e))||void 0===t?void 0:t.operation}getFilteredColumns(){return this.filteringStates.getEntries().map((e=>{let[t]=e;return t}))}getColumnStackPosition(e){return this.getFilteredColumns().indexOf(e)}exportAllConditions(){return Ei(this.filteringStates.getEntries(),((e,t)=>{let[r,{operation:n,conditions:i}]=t;return e.push({column:r,operation:n,conditions:_i(i,(e=>{let{name:t,args:r}=e;return{name:t,args:r}}))}),e}),[])}importAllConditions(e){this.clean(),Ai(e,(e=>{Ai(e.conditions,(t=>this.addCondition(e.column,t)))}))}removeConditions(e){this.runLocalHooks("beforeRemove",e),this.filteringStates.clearValue(e),this.runLocalHooks("afterRemove",e)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(e,t){const r=this.getConditions(e);return t?r.some((e=>e.name===t)):r.length>0}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(LA),this.filteringStates=null,this.clearLocalHooks()}}oo(HA,wh);const BA=HA;function UA(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const jA=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>[];UA(this,"conditionCollection",void 0),UA(this,"columnDataFactory",void 0),this.conditionCollection=e,this.columnDataFactory=t}filter(){let e=[];return Ai(this.conditionCollection.getFilteredColumns(),((t,r)=>{let n=this.columnDataFactory(t);r&&(n=this._getIntersectData(n,e)),e=this.filterByColumn(t,n)})),e}filterByColumn(e){const t=[];return Ai(arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],(r=>{void 0!==r&&this.conditionCollection.isMatch(r,e)&&t.push(r)})),t}_getIntersectData(e,t){const r=[];return Ai(t,(t=>{const n=t.meta.visualRow;void 0!==e[n]&&(r[n]=e[n])})),r}};function WA(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function VA(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function zA(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var qA=new WeakSet;class GA{constructor(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>[];WA(this,qA),VA(this,"hot",void 0),VA(this,"conditionCollection",void 0),VA(this,"columnDataFactory",void 0),VA(this,"changes",[]),VA(this,"grouping",!1),VA(this,"latestEditedColumnPosition",-1),VA(this,"latestOrderStack",[]),this.hot=e,this.conditionCollection=t,this.columnDataFactory=r,this.conditionCollection.addLocalHook("beforeRemove",(e=>zA(qA,this,$A).call(this,e))),this.conditionCollection.addLocalHook("afterRemove",(e=>this.updateStatesAtColumn(e))),this.conditionCollection.addLocalHook("afterAdd",(e=>this.updateStatesAtColumn(e))),this.conditionCollection.addLocalHook("beforeClean",(()=>zA(qA,this,KA).call(this))),this.conditionCollection.addLocalHook("afterClean",(()=>zA(qA,this,YA).call(this)))}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,Ai(this.changes,(e=>{this.updateStatesAtColumn(e)})),this.changes.length=0}updateStatesAtColumn(e,t){var r=this;if(this.grouping)return void(-1===this.changes.indexOf(e)&&this.changes.push(e));const n=this.conditionCollection.exportAllConditions();let i=this.conditionCollection.getColumnStackPosition(e);-1===i&&(i=this.latestEditedColumnPosition);const o=n.slice(0,i),a=n.slice(i);a.length&&a[0].column===e&&a.shift();const s=function(e){const t=e.length;return function r(n){return function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];const s=n.concat(o);let l;return l=s.length>=t?e.apply(this,s):r(s),l}}([])}((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];const i=new BA(r.hot,!1),o=[].concat(e,n);i.importAllConditions(o);const a=r.columnDataFactory(t);let s;s=i.isEmpty()?a:new jA(i,(e=>r.columnDataFactory(e))).filter(),s=_i(s,(e=>e.meta.visualRow));const l=K_(s);return i.destroy(),Ti(a,(e=>l(e.meta.visualRow)))}))(o),l=[].concat(this.conditionCollection.getConditions(e));this.runLocalHooks("update",{editedConditionStack:{column:e,conditions:l},dependentConditionStacks:a,filteredRowsFactory:s,conditionArgsChange:t})}destroy(){this.clearLocalHooks(),co(this,((e,t)=>{this[t]=null}))}}function $A(e){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(e)}function KA(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}function YA(){Ai(this.latestOrderStack,(e=>{this.updateStatesAtColumn(e)}))}oo(GA,wh);const XA=GA;const JA="filters";function ZA(e,t){let r=-1;const n=(i=t,Jk({initialPage:0,size:()=>i.length,onItemSelect:(e,t)=>{const r=i[e];return r instanceof mA?t:!(r.element&&!Xn(r.element))&&void r.focus()}}));var i;const o=r=>()=>{e.isOpened()&&e.getKeyboardShortcutsCtrl().listen(JA),n.setCurrentPage(t.indexOf(r))};function a(i){const o=e.getKeyboardShortcutsCtrl(),a=i.getKeyboardShortcutsCtrl();n.clear(),a.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:o.getContext(JA),callback:()=>{i.isSubMenu()&&i.close(),o.listen(JA)}}]),i.isSubMenu()||o.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:t=>{const i=e.getNavigator();i.getCurrentPage()>-1&&(r=i.getCurrentPage()),i.clear(),t.shiftKey?n.toPreviousItem():n.toNextItem()}},{keys:[["Escape"]],callback:()=>{e.close()}},{keys:[["Enter"],["Space"]],preventDefault:!1,callback:e=>{const r=t[n.getCurrentPage()];r instanceof v_&&(r.openOptions(),e.preventDefault()),r instanceof rA&&(r.activate(),e.preventDefault()),r instanceof ZT||e.preventDefault()}}],JA)}return t.forEach((e=>{e instanceof ZT&&(e.addLocalHook("click",o(e)),e.addLocalHook("focus",o(e)),e.addLocalHook("afterClose",o(e)))})),e.addLocalHook("afterSelectionChange",(e=>{e.key.startsWith("filter_")||n.clear()})),e.addLocalHook("afterSubmenuOpen",a),e.addLocalHook("afterOpen",a),{...n,listen:function(){e.focus(),e.getKeyboardShortcutsCtrl().listen(JA)},getLastMenuPage:function(){return r}}}function QA(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function eR(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function tR(e,t){return e.get(rR(e,t))}function rR(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}const nR="filters",iR=nR;var oR=new WeakMap,aR=new WeakSet;class sR extends Fy{static get PLUGIN_KEY(){return nR}static get PLUGIN_PRIORITY(){return 250}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(e){super(e),function(e,t){QA(e,t),t.add(e)}(this,aR),eR(this,"dropdownMenuPlugin",null),eR(this,"conditionCollection",null),eR(this,"conditionUpdateObserver",null),eR(this,"components",new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]])),eR(this,"filtersRowsMap",null),function(e,t,r){QA(e,t),t.set(e,r)}(this,oR,void 0),this.hot.addHook("afterGetColHeader",((e,t)=>rR(aR,this,pR).call(this,e,t)))}isEnabled(){return!!this.hot.getSettings()[nR]}enablePlugin(){if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new Nh),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");const e=this.hot.getSettings().dropdownMenu,t=e&&e.uiContainer||this.hot.rootDocument.body,r=e=>(e.addLocalHook("accept",(()=>rR(aR,this,dR).call(this,"accept"))),e.addLocalHook("cancel",(()=>rR(aR,this,dR).call(this,"cancel"))),e.addLocalHook("change",(t=>rR(aR,this,fR).call(this,e,t))),e),n=()=>`${this.hot.getTranslatedPhrase(kf)}:`,i=()=>`${this.hot.getTranslatedPhrase(xf)}:`;if(!this.components.get("filter_by_condition")){const e=new E_(this.hot,{id:"filter_by_condition",name:n,addSeparator:!1,menuContainer:t});e.addLocalHook("afterClose",(()=>rR(aR,this,gR).call(this))),this.components.set("filter_by_condition",r(e))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new V_(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){const e=new E_(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:t});e.addLocalHook("afterClose",(()=>rR(aR,this,gR).call(this))),this.components.set("filter_by_condition2",r(e))}if(this.components.get("filter_by_value")||this.components.set("filter_by_value",r(new _A(this.hot,{id:"filter_by_value",name:i}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",r(new NA(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new BA(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new XA(this.hot,this.conditionCollection,(e=>this.getDataMapAtColumn(e))),this.conditionUpdateObserver.addLocalHook("update",(e=>rR(aR,this,mR).call(this,e)))),this.components.forEach((e=>e.show())),this.addHook("afterDropdownMenuDefaultOptions",(e=>rR(aR,this,hR).call(this,e))),this.addHook("afterDropdownMenuShow",(()=>rR(aR,this,cR).call(this))),this.addHook("afterDropdownMenuHide",(()=>rR(aR,this,uR).call(this))),this.addHook("afterChange",(e=>rR(aR,this,lR).call(this,e))),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),!tR(oR,this)&&this.dropdownMenuPlugin.enabled){const e=this.dropdownMenuPlugin.menu,t=[{focus:()=>{const t=e.getNavigator(),r=tR(oR,this).getLastMenuPage();e.focus(),r>0?t.setCurrentPage(r):t.toFirstItem()}},...Array.from(this.components).map((e=>{let[,t]=e;return t.getElements()})).flat()];!function(e,t,r){e.set(rR(e,t),r)}(oR,this,ZA(e,t));const r=e=>{tR(oR,this).listen(),e.preventDefault(),Po(e.keyCode,"TAB")&&(e.shiftKey?tR(oR,this).toPreviousItem():tR(oR,this).toNextItem())};this.components.get("filter_by_value").addLocalHook("listTabKeydown",r),this.components.get("filter_by_condition").addLocalHook("selectTabKeydown",r)}this.registerShortcuts(),super.enablePlugin()}disablePlugin(){var e;this.enabled&&(null!==(e=this.dropdownMenuPlugin)&&void 0!==e&&e.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach(((e,t)=>{e.destroy(),this.components.set(t,null)})),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName));this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Alt","A"]],stopPropagation:!0,callback:()=>{const e=this.hot.getSelected();this.clearConditions(),this.filter(),e&&this.hot.selectCells(e)},group:iR})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(iR)}addCondition(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:O_;const i=this.hot.toPhysicalColumn(e);this.conditionCollection.addCondition(i,{command:{key:t},args:r},n)}removeConditions(e){const t=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(t)}clearConditions(e){if(void 0===e)this.conditionCollection.clean();else{const t=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(t)}}filter(){const{navigableHeaders:e}=this.hot.getSettings(),t=this._createDataFilter(),r=!this.conditionCollection.isEmpty();let n=[];const i=this.conditionCollection.exportAllConditions();if(!1!==this.hot.runHooks("beforeFilter",i))if(r){const r=[];this.hot.batchExecution((()=>{this.filtersRowsMap.clear(),n=_i(t.filter(),(e=>e.meta.visualRow));const e=K_(n);ja(this.hot.countSourceRows()-1,(t=>{e(t)||r.push(t)})),Ai(r,(e=>{this.filtersRowsMap.setValueAtIndex(e,!0)}))}),!0),e||n.length||this.hot.deselectCell()}else this.filtersRowsMap.clear();this.hot.runHooks("afterFilter",i),this.hot.view.adjustElementsSize(),this.hot.render(),this.hot.selection.isSelected()&&this.hot.selectCell(e?-1:0,this.hot.getSelectedRangeLast().highlight.col)}getSelectedColumn(){var e;const t=null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.highlight;return t?{visualIndex:t.col,physicalIndex:this.hot.toPhysicalColumn(t.col)}:null}getDataMapAtColumn(e){const t=this.hot.toVisualColumn(e),r=[];return Ai(this.hot.getSourceDataAtCol(t),((e,n)=>{var i;const{row:o,col:a,visualCol:s,visualRow:l,type:c,instance:u,dateFormat:h,locale:d}=this.hot.getCellMeta(n,t),f=null!==(i=this.hot.getDataAtCell(this.hot.toVisualRow(n),t))&&void 0!==i?i:e;r.push({meta:{row:o,col:a,visualCol:s,visualRow:l,type:c,instance:u,dateFormat:h,locale:d},value:Y_(f)})})),r}updateValueComponentCondition(e){const t=X_(this.hot.getDataAtCol(e));this.conditionUpdateObserver.updateStatesAtColumn(e,t)}restoreComponents(e){var t;const r=null===(t=this.getSelectedColumn())||void 0===t?void 0:t.physicalIndex;e.forEach((e=>{e.isHidden()||e.restoreState(r)})),this.updateDependentComponentsVisibility()}getOperationBasedOnArguments(e,t,r,n){let i=e;return i===M_&&t.command.key!==AT&&r.command.key!==AT&&n.command.key!==AT?i=I_:n.command.key!==AT&&(t.command.key!==AT&&r.command.key!==AT||(i=O_)),i}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){const e=this.components.get("filter_by_condition"),{command:t}=e.getState(),r=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];t.showOperators?this.showComponents(...r):this.hideComponents(...r)}_createDataFilter(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.conditionCollection;return new jA(e,(e=>this.getDataMapAtColumn(e)))}getIndexesOfComponents(){const e=[];if(!this.dropdownMenuPlugin)return e;const t=this.dropdownMenuPlugin.menu;for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Ai(n,(r=>{Ai(t.menuItems,((t,n)=>{t.key===r.getMenuItemDescriptor().key&&e.push(n)}))})),e}changeComponentsVisibility(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!this.dropdownMenuPlugin)return;const t=this.dropdownMenuPlugin.menu.hotMenu,r=t.getPlugin("hiddenRows");for(var n=arguments.length,i=new Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];const a=this.getIndexesOfComponents(...i);e?r.showRows(a):r.hideRows(a),t.render()}hideComponents(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.changeComponentsVisibility(!1,...t)}showComponents(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.changeComponentsVisibility(!0,...t)}destroy(){this.enabled&&(this.components.forEach(((e,t)=>{null!==e&&(e.destroy(),this.components.set(t,null))})),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}}function lR(e){e&&Ai(e,(e=>{const[,t]=e,r=this.hot.propToCol(t);this.conditionCollection.hasConditions(r)&&this.updateValueComponentCondition(r)}))}function cR(){this.restoreComponents(Array.from(this.components.values()))}function uR(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}function hR(e){e.items.push({name:HC}),this.components.forEach((t=>{e.items.push(t.getMenuItemDescriptor())}))}function dR(e){var t;if("accept"===e){const e=this.getSelectedColumn();var r;if(null===e)return void(null===(r=this.dropdownMenuPlugin)||void 0===r||r.close());const{physicalIndex:t}=e,n=this.components.get("filter_by_condition").getState(),i=this.components.get("filter_by_condition2").getState(),o=this.components.get("filter_by_value").getState(),a=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),n,i,o);this.conditionUpdateObserver.groupChanges();let s=this.conditionCollection.getColumnStackPosition(t);-1===s&&(s=void 0),this.conditionCollection.removeConditions(t),n.command.key!==AT&&(this.conditionCollection.addCondition(t,n,a,s),i.command.key!==AT&&this.conditionCollection.addCondition(t,i,a,s)),o.command.key!==AT&&this.conditionCollection.addCondition(t,o,a,s),this.conditionUpdateObserver.flush(),this.components.forEach((e=>e.saveState(t))),this.filtersRowsMap.clear(),this.filter()}null===(t=this.dropdownMenuPlugin)||void 0===t||t.close()}function fR(e,t){this.updateDependentComponentsVisibility(),e.constructor!==E_||t.inputsCount||this.setListeningDropdownMenu()}function gR(){this.setListeningDropdownMenu()}function pR(e,t){const r=this.hot.toPhysicalColumn(e);this.enabled&&this.conditionCollection.hasConditions(r)?jn(t,"htFiltersActive"):Wn(t,"htFiltersActive")}function mR(e){var t;if(null===(t=this.dropdownMenuPlugin)||void 0===t||!t.enabled)return;const{editedConditionStack:{conditions:r,column:n}}=e,i=r.filter((e=>e.name===SA)),o=r.filter((e=>e.name!==SA));if(i.length>=2||o.length>=3)Ho(Ii`The filter conditions have been applied properly, but couldnt be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{const t=this.conditionCollection.getOperation(n);this.components.get("filter_by_condition").updateState(o[0],n),this.components.get("filter_by_condition2").updateState(o[1],n),this.components.get("filter_operators").updateState(t,n),this.components.get("filter_by_value").updateState(e)}}const vR="internal-use-in-handsontable",bR={licenseKey:vR,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function yR(e){var t;return{maxColumns:e.maxColumns,maxRows:e.maxRows,language:null===(t=e[cO])||void 0===t||null===(t=t.language)||void 0===t?void 0:t.langCode}}function wR(e){return Object.keys(e).reduce(((t,r)=>("hyperformula"!==r&&(t[r]=e[r]),t)),{})}function SR(){const e="engine_relationship",t=Xo(cO);return t.hasItem(e)||t.register(e,new Map),t.getItem(e)}function CR(){const e="shared_engine_usage",t=Xo(cO);return t.hasItem(e)||t.register(e,new Map),t.getItem(e)}function kR(e){const t=e.getSettings(),r=t[cO],n=null===r||void 0===r?void 0:r.engine;if(!0===r)return null;if(Di(n))return null;var i;if("function"===typeof n.hyperformula||"function"===typeof n)return function(e,t,r){const n=t[cO],i=function(e){var t;const r=e[cO],n=wR(null!==r&&void 0!==r&&null!==(t=r.engine)&&void 0!==t&&t.hyperformula?r.engine:{}),i=yR(e);return{...bR,...n,...i}}(t),o=SR(),a=CR();(function(e,t){t&&t.forEach((t=>{const{name:r,plugin:n,translations:i}=t;try{e.registerFunction(r,n,i)}catch(oJ){Ho(oJ.message)}}))})(e,n.functions),function(e,t){if(t){const{langCode:r}=t;try{e.registerLanguage(r,t)}catch(oJ){Ho(oJ.message)}}}(e,n.language);const s=e.buildEmpty(i);return o.set(s,[r]),a.set(s,[r.guid]),function(e,t){t&&(e.suspendEvaluation(),t.forEach((t=>{const{name:r,expression:n,scope:i,options:o}=t;try{e.addNamedExpression(r,n,i,o)}catch(oJ){Ho(oJ.message)}})),e.resumeEvaluation())}(s,n.namedExpressions),s.on("sheetAdded",(()=>{s.rebuildAndRecalculate()})),s.on("sheetRemoved",(()=>{s.rebuildAndRecalculate()})),s}(null!==(i=n.hyperformula)&&void 0!==i?i:n,t,e);if("object"===typeof n&&Di(n.hyperformula)){const t=SR(),r=CR().get(n);return t.has(n)||t.set(n,[]),t.get(n).push(e),r&&r.push(e.guid),n.getConfig().licenseKey||n.updateConfig({licenseKey:vR}),n.getConfig().leapYear1900===bR.leapYear1900&&!1!==ao(n.getConfig().nullDate,bR.nullDate)||Ho(Ii`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),n}return null}function xR(e){var t;const r=SR(),n=0===r.size?[]:Array.from(null!==(t=r.get(e))&&void 0!==t?t:[]);return new Map(n.map((e=>[e.getPlugin("formulas").sheetId,e])))}function ER(e,t){if(e){const r=SR(),n=r.get(e),i=CR(),o=i.get(e);n&&n.includes(t)&&(n.splice(n.indexOf(t),1),0===n.length&&r.delete(e)),o&&o.includes(t.guid)&&(o.splice(o.indexOf(t.guid),1),0===o.length&&(i.delete(e),e.destroy()))}}const TR="DD/MM/YYYY";function _R(e){return"string"===typeof e&&"'"===e.charAt(0)&&"="===e.charAt(1)}function AR(e,t){return"string"===typeof e&&"date"===t}function RR(e,t){return Ci(e,t,!0).isValid()}function OR(e,t){return Ci(e,t,!0).format(TR)}function MR(e,t){const r=new Date(Date.UTC(0,0,e+-1));return Ci(r).format(t)}function IR(e,t,r){const n=function(e,t){const r=[];return e.forEach((e=>{const n={from:e,to:t};r.forEach((e=>{const t=e.from>e.to,r=e.to<=n.from;e.from>n.from&&r&&t&&(n.from+=1)})),n.from>=t&&(t+=1),r.push(n)})),r}(e,function(e,t,r){const n=Array.from(Array(r).keys()).filter((t=>!1===e.includes(t)));var i;return 0===t?null!==(i=n[t])&&void 0!==i?i:0:n[t-1]+1}(e,t,r));return function(e){return e.forEach(((t,r)=>{e.slice(r+1).forEach((e=>{const r=e.from<e.to;e.from>t.from&&r&&(e.from-=1)}))})),e}(n)}function PR(e,t,r){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,r)}function NR(e,t){return e.get(FR(e,t))}function DR(e,t,r){return e.set(FR(e,t),r),r}function FR(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var LR=new WeakMap,HR=new WeakMap,BR=new WeakMap,UR=new WeakMap,jR=new WeakMap,WR=new WeakMap,VR=new WeakMap;const zR=class{constructor(e,t,r){PR(this,LR,void 0),PR(this,HR,void 0),PR(this,BR,void 0),PR(this,UR,[]),PR(this,jR,[]),PR(this,WR,void 0),PR(this,VR,[]),DR(LR,this,e),DR(HR,this,t),DR(BR,this,r)}setRemovedHfIndexes(e){return DR(VR,this,e.map((e=>{const t=NR(HR,this).getVisualFromPhysicalIndex(e);return this.getHfIndexFromVisualIndex(t)}))),NR(VR,this)}getRemovedHfIndexes(){return NR(VR,this)}getHfIndexFromVisualIndex(e){const t=NR(HR,this).getIndexesSequence(),r=NR(HR,this).getNotTrimmedIndexes();return t.indexOf(r[e])}syncMoves(e){const t=`move${un(NR(LR,this))}s`;NR(BR,this).getEngine().batch((()=>{e.forEach((e=>{const r=e.from!==e.to,n=e.from+1!==e.to;r&&n&&NR(BR,this).getEngine()[t](NR(BR,this).getSheetId(),e.from,1,e.to)}))}))}storeMovesInformation(e,t,r){!1!==r&&(DR(jR,this,e.map((e=>this.getHfIndexFromVisualIndex(e)))),DR(WR,this,this.getHfIndexFromVisualIndex(t)))}calculateAndSyncMoves(e,t){if(NR(BR,this).isPerformingUndoRedo())return;if(!1===e||!1===t)return;const r=IR(NR(jR,this),NR(WR,this),NR(HR,this).getNumberOfIndexes());null===NR(BR,this).getSheetId()?NR(BR,this).getPostponeAction((()=>this.syncMoves(r))):this.syncMoves(r)}getIndexesChangeSyncMethod(){const e=`set${un(NR(LR,this))}Order`;return t=>{if(NR(BR,this).isPerformingUndoRedo())return;const r=NR(HR,this).getIndexesSequence();if("update"===t&&r.length>0){const t=NR(UR,this).map((e=>r.indexOf(e))),n=NR(BR,this).getEngine().getSheetDimensions(NR(BR,this).getSheetId());let i;i="row"===NR(LR,this)?n.height:n.width;for(let e=t.length;e<i;e+=1)t.push(e);NR(BR,this).getEngine()[e](NR(BR,this).getSheetId(),t)}DR(UR,this,r)}}init(){DR(UR,this,NR(HR,this).getIndexesSequence())}};function qR(e,t,r){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,r)}function GR(e,t){return e.get(KR(e,t))}function $R(e,t,r){return e.set(KR(e,t),r),r}function KR(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var YR=new WeakMap,XR=new WeakMap,JR=new WeakMap,ZR=new WeakMap,QR=new WeakMap,eO=new WeakMap,tO=new WeakMap;const rO=class{constructor(e,t,r){qR(this,YR,void 0),qR(this,XR,void 0),qR(this,JR,void 0),qR(this,ZR,!1),qR(this,QR,!1),qR(this,eO,null),qR(this,tO,null),$R(YR,this,new zR("row",e,this)),$R(XR,this,new zR("column",t,this)),$R(JR,this,r)}getForAxis(e){return GR("row"===e?YR:XR,this)}setPerformUndo(e){$R(ZR,this,e)}setPerformRedo(e){$R(QR,this,e)}isPerformingUndoRedo(){return GR(ZR,this)||GR(QR,this)}getSheetId(){return GR(tO,this)}getEngine(){return GR(eO,this)}getPostponeAction(){return GR(JR,this)}setupSyncEndpoint(e,t){$R(eO,this,e),$R(tO,this,t),GR(YR,this).init(),GR(XR,this).init()}};function nO(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function iO(e,t,r){oO(e,t),t.set(e,r)}function oO(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function aO(e,t,r){return e.set(lO(e,t),r),r}function sO(e,t){return e.get(lO(e,t))}function lO(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}const cO="formulas",uO=["maxRows","maxColumns","language"];Ko.getSingleton().register("afterNamedExpressionAdded"),Ko.getSingleton().register("afterNamedExpressionRemoved"),Ko.getSingleton().register("afterSheetAdded"),Ko.getSingleton().register("afterSheetRemoved"),Ko.getSingleton().register("afterSheetRenamed"),Ko.getSingleton().register("afterFormulasValuesUpdate");const hO=e=>"UndoRedo.undo"===e||"UndoRedo.redo"===e||"auto"===e;var dO=new WeakMap,fO=new WeakMap,gO=new WeakMap,pO=new WeakSet;class mO extends Fy{constructor(){var e;super(...arguments),e=this,function(e,t){oO(e,t),t.add(e)}(this,pO),iO(this,dO,!1),iO(this,fO,!1),iO(this,gO,[["valuesUpdated",function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return lO(pO,e,DO).call(e,...r)}],["namedExpressionAdded",function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return lO(pO,e,FO).call(e,...r)}],["namedExpressionRemoved",function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return lO(pO,e,LO).call(e,...r)}],["sheetAdded",function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return lO(pO,e,HO).call(e,...r)}],["sheetRenamed",function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return lO(pO,e,BO).call(e,...r)}],["sheetRemoved",function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return lO(pO,e,UO).call(e,...r)}]]),nO(this,"staticRegister",Xo("formulas")),nO(this,"engine",null),nO(this,"sheetName",null),nO(this,"indexSyncer",null),nO(this,"rowAxisSyncer",null),nO(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return cO}static get PLUGIN_PRIORITY(){return 260}static get SETTING_KEYS(){return[cO,...uO]}get sheetId(){return null===this.sheetName?null:this.engine.getSheetId(this.sheetName)}isEnabled(){return!!this.hot.getSettings()[cO]}enablePlugin(){var e,t=this;if(!this.enabled)if(this.engine=null!==(e=kR(this.hot))&&void 0!==e?e:this.engine,this.engine){if(null!==this.sheetName&&!this.engine.doesSheetExist(this.sheetName)){const e=this.addSheet(this.sheetName,this.hot.getSourceDataArray());!1!==e&&(this.sheetName=e)}this.addHook("beforeLoadData",(function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return lO(pO,t,yO).call(t,...r)})),this.addHook("afterLoadData",(function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return lO(pO,t,SO).call(t,...r)})),this.addHook("beforeUpdateData",(function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return lO(pO,t,yO).call(t,...r)})),this.addHook("afterUpdateData",(function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return lO(pO,t,SO).call(t,...r)})),this.addHook("modifyData",(function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return lO(pO,t,CO).call(t,...r)})),this.addHook("modifySourceData",(function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return lO(pO,t,kO).call(t,...r)})),this.addHook("beforeValidate",(function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return lO(pO,t,vO).call(t,...r)})),this.addHook("afterSetSourceDataAtCell",(function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return lO(pO,t,EO).call(t,...r)})),this.addHook("afterSetDataAtCell",(function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return lO(pO,t,xO).call(t,...r)})),this.addHook("afterSetDataAtRowProp",(function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return lO(pO,t,xO).call(t,...r)})),this.addHook("beforeCreateRow",(function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return lO(pO,t,TO).call(t,...r)})),this.addHook("beforeCreateCol",(function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return lO(pO,t,_O).call(t,...r)})),this.addHook("afterCreateRow",(function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return lO(pO,t,OO).call(t,...r)})),this.addHook("afterCreateCol",(function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return lO(pO,t,MO).call(t,...r)})),this.addHook("beforeRemoveRow",(function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return lO(pO,t,AO).call(t,...r)})),this.addHook("beforeRemoveCol",(function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return lO(pO,t,RO).call(t,...r)})),this.addHook("afterRemoveRow",(function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return lO(pO,t,IO).call(t,...r)})),this.addHook("afterRemoveCol",(function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return lO(pO,t,PO).call(t,...r)})),this.indexSyncer=new rO(this.hot.rowIndexMapper,this.hot.columnIndexMapper,(e=>{this.hot.addHookOnce("init",(()=>{e()}))})),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",((e,t,r,n)=>{this.rowAxisSyncer.storeMovesInformation(e,t,n)})),this.hot.addHook("beforeColumnMove",((e,t,r,n)=>{this.columnAxisSyncer.storeMovesInformation(e,t,n)})),this.hot.addHook("afterRowMove",((e,t,r,n,i)=>{this.rowAxisSyncer.calculateAndSyncMoves(n,i)})),this.hot.addHook("afterColumnMove",((e,t,r,n,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(n,i)})),this.hot.addHook("beforeColumnFreeze",((e,t)=>{this.columnAxisSyncer.storeMovesInformation([e],this.hot.getSettings().fixedColumnsStart,t)})),this.hot.addHook("afterColumnFreeze",((e,t)=>{this.columnAxisSyncer.calculateAndSyncMoves(t,t)})),this.hot.addHook("beforeColumnUnfreeze",((e,t)=>{this.columnAxisSyncer.storeMovesInformation([e],this.hot.getSettings().fixedColumnsStart-1,t)})),this.hot.addHook("afterColumnUnfreeze",((e,t)=>{this.columnAxisSyncer.calculateAndSyncMoves(t,t)})),this.addHook("afterCellMetaReset",(function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return lO(pO,t,wO).call(t,...r)})),this.addHook("beforeUndo",(()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()})),this.addHook("beforeRedo",(()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()})),this.addHook("afterUndo",(()=>{this.indexSyncer.setPerformUndo(!1)})),this.addHook("afterUndo",(()=>{this.indexSyncer.setPerformRedo(!1)})),this.addHook("afterDetachChild",(function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return lO(pO,t,NO).call(t,...r)})),this.addHook("beforeAutofill",(function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return lO(pO,t,bO).call(t,...r)})),sO(gO,this).forEach((e=>{let[t,r]=e;return this.engine.on(t,r)})),super.enablePlugin()}else Ho("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.")}disablePlugin(){sO(gO,this).forEach((e=>{let[t,r]=e;return this.engine.off(t,r)})),ER(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(e){const t=function(e){var t;const r=e[cO];return{...wR(null!==r&&void 0!==r&&null!==(t=r.engine)&&void 0!==t&&t.hyperformula?r.engine:{}),...yR(e)}}(this.hot.getSettings());(function(e,t){return Object.keys(t).some((r=>void 0!==t[r]&&t[r]!==e[r]))})(this.engine.getConfig(),t)&&this.engine.updateConfig(t);const r=this.hot.getSettings()[cO];if(Ni(r)&&Ni(r.sheetName)&&r.sheetName!==this.sheetName&&this.switchSheet(r.sheetName),!e.data&&null===this.sheetName){const e=this.hot.getSettings()[cO].sheetName;e&&this.engine.doesSheetExist(e)?this.switchSheet(this.sheetName):this.sheetName=this.addSheet(null!==e&&void 0!==e?e:void 0,this.hot.getSourceDataArray())}super.updatePlugin(e)}destroy(){sO(gO,this).forEach((e=>{var t;let[r,n]=e;return null===(t=this.engine)||void 0===t?void 0:t.off(r,n)})),aO(gO,this,null),ER(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(e,t){if(Ni(t)&&(r=t,!(Array.isArray(r)&&r.length&&r.every((e=>Array.isArray(e))))))return Ho("The provided data should be an array of arrays."),!1;var r;if(void 0!==e&&null!==e&&this.engine.doesSheetExist(e))return Ho("Sheet with the provided name already exists."),!1;try{const r=this.engine.addSheet(null!==e&&void 0!==e?e:void 0);return t&&this.engine.setSheetContent(this.engine.getSheetId(r),t),r}catch(oJ){return Ho(oJ.message),!1}}switchSheet(e){if(!this.engine.doesSheetExist(e))return void Bo(`The sheet named \`${e}\` does not exist, switch aborted.`);this.sheetName=e;const t=this.engine.getSheetSerialized(this.sheetId);t.length>0&&this.hot.loadData(t,`${un(cO)}.switchSheet`)}getCellType(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.sheetId;const n=this.hot.toPhysicalRow(e),i=this.hot.toPhysicalColumn(t);return null!==n&&null!==i?this.engine.getCellType({sheet:r,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t)}):"EMPTY"}isFormulaCellType(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:r,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t)})}renderDependentSheets(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const r=new Set;e.forEach((e=>{var t;const n=null===e||void 0===e||null===(t=e.address)||void 0===t?void 0:t.sheet;void 0!==n&&(r.has(n)||r.add(n))})),xR(this.engine).forEach(((e,n)=>{var i;(t||n!==this.sheetId)&&r.has(n)&&(e.render(),null===(i=e.view)||void 0===i||i.adjustElementsSize())}))}validateDependentCells(e){const t=e=>{var t;const{row:r,col:n,sheet:i}=null!==(t=null===e||void 0===e?void 0:e.address)&&void 0!==t?t:{};return Ni(i)?`${i}:${r}x${n}`:""},r=new Set((arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]).map((e=>t(e))));e.forEach((e=>{var n,i;const{row:o,col:a}=null!==(n=e.address)&&void 0!==n?n:{};if(!1===Ni(o)||!1===Ni(a)||o>=this.hot.countRows()||a>=this.hot.countCols())return;const s=null===e||void 0===e||null===(i=e.address)||void 0===i?void 0:i.sheet,l=t(e);if(void 0!==s&&!r.has(l)){const e=xR(this.engine).get(s);if(!e)return;e.validateCell(e.getDataAtCell(o,a),e.getCellMeta(o,a),(()=>{}))}}))}syncChangeWithEngine(e,t,r){const n={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(n))return void Ho(`Not possible to set cell data at ${JSON.stringify(n)}`);const i=this.hot.getCellMeta(e,t);var o;return AR(r,i.type)&&(RR(r,i.dateFormat)?r=OR(r,i.dateFormat):!1===("string"===typeof(o=r)&&o.startsWith("="))&&(r=`'${r}`)),this.engine.setCellContents(n,r)}}function vO(e,t,r){const n=this.hot.propToCol(r);if(this.isFormulaCellType(t,n)){const e={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(t),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n),sheet:this.sheetId},r=this.hot.getCellMeta(t,n);let i=this.engine.getCellValue(e);return"date"===r.type&&Ua(i)&&(i=MR(i,r.dateFormat)),"object"===typeof i&&null!==i?i.value:i}return e}function bO(e,t,r){const{row:n,col:i}=t.getTopStartCorner(),{row:o,col:a}=t.getBottomEndCorner(),{row:s,col:l}=r.getTopStartCorner(),{row:c,col:u}=r.getBottomEndCorner(),h={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(n),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(a),sheet:this.sheetId}},d={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(c),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId}};if(!1===this.engine.isItPossibleToSetCellContents(d))return!1;const f=this.engine.getFillRangeData(h,d),{row:g,col:p}=h.start,{row:m,col:v}=h.end,b=m-g+1,y=v-p+1;for(let C=0;C<f.length;C+=1)for(let e=0;e<f[C].length;e+=1){const t=f[C][e],r=g+C%b,n=p+e%y,i=this.hot.getCellMeta(r,n);AR(t,i.type)&&(t.startsWith("'")?f[C][e]=t.slice(1):!1===this.isFormulaCellType(r,n,this.sheetId)&&(f[C][e]=(w=t,S=i.dateFormat,Ci(w,TR,!0).format(S))))}var w,S;return f}function yO(e,t){(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"").includes(un(cO))||aO(fO,this,Di(this.hot.getSettings().data))}function wO(){const e=this.hot.getSourceDataArray();let t=!1;e.forEach(((r,n)=>{r.forEach(((r,i)=>{const o=this.hot.getCellMeta(n,i),a=o.dateFormat;AR(r,o.type)&&(t=!0,RR(r,a)?e[n][i]=OR(r,a):!1===this.isFormulaCellType(n,i)&&(e[n][i]=`'${r}`))}))})),!0===t&&(aO(dO,this,!0),this.engine.setSheetContent(this.sheetId,e),aO(dO,this,!1))}function SO(e,t){var r,n;if(!(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"").includes(un(cO)))if(this.sheetName=(r=this.engine,!Di(n=this.hot.getSettings()[cO].sheetName)&&r.doesSheetExist(n)||(n=r.addSheet(n)),n),sO(fO,this))this.switchSheet(this.sheetName);else{const e=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,e)){aO(dO,this,!0);const t=this.engine.setSheetContent(this.sheetId,e);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(t),aO(dO,this,!1)}}}function CO(e,t,r,n){if("get"!==n||sO(dO,this)||null===this.sheetName||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(e);if(null===i||null===t)return;if(!this.isFormulaCellType(i,t)){if("ARRAY"!==this.getCellType(i,t))return void(_R(r.value)&&(r.value=_R(o=r.value)?o.substr(1):o))}var o;const a={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t),sheet:this.sheetId};let s=this.engine.getCellValue(a),l=this.hot.getCellsMeta().find((e=>e.visualRow===i&&e.visualCol===t));void 0===l&&(l={}),"date"===l.type&&Ua(s)&&(s=MR(s,l.dateFormat));const c="object"===typeof s&&null!==s?s.value:s;r.value=c}function kO(e,t,r,n){if("get"!==n||sO(dO,this)||null===this.sheetName||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(e),o=this.hot.propToCol(t);if(null===i||null===o)return;if(!this.isFormulaCellType(i,o)){if("ARRAY"!==this.getCellType(i,o))return}const a=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(0===a.width&&0===a.height)return;const s={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(o),sheet:this.sheetId};r.value=this.engine.getCellSerialized(s)}function xO(e,t){if(hO(t))return;const r=[],n=[],i=this.engine.batch((()=>{e.forEach((e=>{let[t,i,,o]=e;const a=this.hot.propToCol(i),s=this.hot.toPhysicalRow(t),l=this.hot.toPhysicalColumn(a),c={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(t),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(a),sheet:this.sheetId};null!==s&&null!==l?this.syncChangeWithEngine(t,a,o):r.push([t,a,o]),n.push({address:c})}))}));r.length&&this.hot.addHookOnce("afterChange",(()=>{const e=this.engine.batch((()=>{r.forEach((e=>{let[t,r,n]=e;this.syncChangeWithEngine(t,r,n)}))}));this.renderDependentSheets(e,!0)})),this.renderDependentSheets(i),this.validateDependentCells(i,n)}function EO(e,t){if(hO(t))return;const r=[],n=[];e.forEach((e=>{let[t,i,,o]=e;const a=this.hot.propToCol(i);if(!Ua(a))return;const s={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(t),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(a),sheet:this.sheetId};this.engine.isItPossibleToSetCellContents(s)?(n.push({address:s}),r.push(...this.engine.setCellContents(s,o))):Ho(`Not possible to set source cell data at ${JSON.stringify(s)}`)})),this.renderDependentSheets(r),this.validateDependentCells(r,n)}function TO(e,t){let r=this.rowAxisSyncer.getHfIndexFromVisualIndex(e);if(e>=this.hot.countRows()&&(r=e),null===this.sheetId||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[r,t]))return!1}function _O(e,t){let r=this.columnAxisSyncer.getHfIndexFromVisualIndex(e);if(e>=this.hot.countCols()&&(r=e),null===this.sheetId||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[r,t]))return!1}function AO(e,t,r){return!1!==this.rowAxisSyncer.setRemovedHfIndexes(r).every((e=>this.engine.isItPossibleToRemoveRows(this.sheetId,[e,1])))&&void 0}function RO(e,t,r){return!1!==this.columnAxisSyncer.setRemovedHfIndexes(r).every((e=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[e,1])))&&void 0}function OO(e,t,r){if(hO(r))return;const n=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(e),t]);this.renderDependentSheets(n)}function MO(e,t,r){if(hO(r))return;const n=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(e),t]);this.renderDependentSheets(n)}function IO(e,t,r,n){if(hO(n))return;const i=this.rowAxisSyncer.getRemovedHfIndexes().sort(((e,t)=>t-e)),o=this.engine.batch((()=>{i.forEach((e=>{this.engine.removeRows(this.sheetId,[e,1])}))}));this.renderDependentSheets(o)}function PO(e,t,r,n){if(hO(n))return;const i=this.columnAxisSyncer.getRemovedHfIndexes().sort(((e,t)=>t-e)),o=this.engine.batch((()=>{i.forEach((e=>{this.engine.removeColumns(this.sheetId,[e,1])}))}));this.renderDependentSheets(o)}function NO(e,t,r){var n;aO(dO,this,!0);const i=this.hot.getSourceDataArray(r,0,r+((null===(n=t.__children)||void 0===n?void 0:n.length)||0),this.hot.countSourceCols());aO(dO,this,!1),i.forEach(((e,t)=>{e.forEach(((e,n)=>{this.engine.setCellContents({col:n,row:r+t,sheet:this.sheetId},[[e]])}))}))}function DO(e){this.hot.runHooks("afterFormulasValuesUpdate",e)}function FO(e,t){this.hot.runHooks("afterNamedExpressionAdded",e,t)}function LO(e,t){this.hot.runHooks("afterNamedExpressionRemoved",e,t)}function HO(e){this.hot.runHooks("afterSheetAdded",e)}function BO(e,t){this.sheetName=t,this.hot.runHooks("afterSheetRenamed",e,t)}function UO(e,t){this.hot.runHooks("afterSheetRemoved",e,t)}function jO(e,t,r){WO(e,t),t.set(e,r)}function WO(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function VO(e,t){return e.get(qO(e,t))}function zO(e,t,r){return e.set(qO(e,t),r),r}function qO(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}Ko.getSingleton().register("beforeHideColumns"),Ko.getSingleton().register("afterHideColumns"),Ko.getSingleton().register("beforeUnhideColumns"),Ko.getSingleton().register("afterUnhideColumns");const GO="hiddenColumns";var $O=new WeakMap,KO=new WeakMap,YO=new WeakSet;class XO extends Fy{constructor(){super(...arguments),function(e,t){WO(e,t),t.add(e)}(this,YO),jO(this,$O,{}),jO(this,KO,null)}static get PLUGIN_KEY(){return GO}static get PLUGIN_PRIORITY(){return 310}isEnabled(){return!!this.hot.getSettings()[GO]}enablePlugin(){var e=this;if(this.enabled)return;const t=this.hot.getSettings()[GO];so(t)&&(zO($O,this,t),Di(t.copyPasteEnabled)&&(t.copyPasteEnabled=!0)),zO(KO,this,new Mh),VO(KO,this).addLocalHook("init",(()=>qO(YO,this,rM).call(this))),this.hot.columnIndexMapper.registerMap(this.pluginName,VO(KO,this)),this.addHook("afterContextMenuDefaultOptions",(function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return qO(YO,e,tM).call(e,...r)})),this.addHook("afterGetCellMeta",((e,t,r)=>qO(YO,this,ZO).call(this,e,t,r))),this.addHook("modifyColWidth",((e,t)=>qO(YO,this,JO).call(this,e,t)),2),this.addHook("afterGetColHeader",(function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return qO(YO,e,eM).call(e,...r)})),this.addHook("modifyCopyableRange",(e=>qO(YO,this,QO).call(this,e))),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),zO($O,this,{}),super.disablePlugin(),this.resetCellsMeta()}showColumns(e){const t=this.getHiddenColumns(),r=this.isValidConfig(e);let n=t;const i=VO(KO,this).getValues().slice(),o=e.length>0;if(r&&o){Ai(e.map((e=>this.hot.toPhysicalColumn(e))),(e=>{i[e]=!1})),n=Ei(i,((e,t,r)=>(t&&e.push(this.hot.toVisualColumn(r)),e)),[])}!1!==this.hot.runHooks("beforeUnhideColumns",t,n,r&&o)&&(r&&o&&VO(KO,this).setValues(i),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",t,n,r&&o,r&&n.length<t.length))}showColumn(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.showColumns(t)}hideColumns(e){const t=this.getHiddenColumns(),r=this.isValidConfig(e);let n=t;r&&(n=Array.from(new Set(t.concat(e))));!1!==this.hot.runHooks("beforeHideColumns",t,n,r)&&(r&&this.hot.batchExecution((()=>{Ai(e,(e=>{VO(KO,this).setValueAtIndex(this.hot.toPhysicalColumn(e),!0)}))}),!0),this.hot.runHooks("afterHideColumns",t,n,r,r&&n.length>t.length))}hideColumn(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.hideColumns(t)}getHiddenColumns(){return _i(VO(KO,this).getHiddenIndexes(),(e=>this.hot.toVisualColumn(e)))}isHidden(e){return VO(KO,this).getValueAtIndex(this.hot.toPhysicalColumn(e))||!1}isValidConfig(e){const t=this.hot.countCols();return!!(Array.isArray(e)&&e.length>0)&&e.every((e=>Number.isInteger(e)&&e>=0&&e<t))}resetCellsMeta(){Ai(this.hot.getCellsMeta(),(e=>{e&&(e.skipColumnOnPaste=!1)}))}destroy(){zO($O,this,null),zO(KO,this,null),super.destroy()}}function JO(e,t){return this.isHidden(t)?0:VO($O,this).indicators&&(this.isHidden(t+1)||this.isHidden(t-1))&&"number"===typeof e&&this.hot.hasColHeaders()?e+15:void 0}function ZO(e,t,r){if(!1===VO($O,this).copyPasteEnabled&&this.isHidden(t)&&(r.skipColumnOnPaste=!0),this.isHidden(t-1))r.className=r.className||"",-1===r.className.indexOf("afterHiddenColumn")&&(r.className+=" afterHiddenColumn");else if(r.className){const e=r.className.split(" ");if(e.length>0){const t=e.indexOf("afterHiddenColumn");t>-1&&e.splice(t,1),r.className=e.join(" ")}}}function QO(e){if(VO($O,this).copyPasteEnabled)return e;const t=[],r=(e,r,n,i)=>{t.push({startRow:e,endRow:r,startCol:n,endCol:i})};return Ai(e,(e=>{let t=!0,n=0;ja(e.startCol,e.endCol,(i=>{this.isHidden(i)?(t||r(e.startRow,e.endRow,n,i-1),t=!0):(t&&(n=i),i===e.endCol&&r(e.startRow,e.endRow,n,i),t=!1)}))})),t}function eM(e,t){if(!VO($O,this).indicators||e<0)return;const r=[];e>=1&&this.isHidden(e-1)&&r.push("afterHiddenColumn"),e<this.hot.countCols()-1&&this.isHidden(e+1)&&r.push("beforeHiddenColumn"),jn(t,r)}function tM(e){var t;e.items.push({name:HC},(t=this,{key:"hidden_columns_hide",name(){const e=this.getSelectedLast();let t=0;if(Array.isArray(e)){const[,r,,n]=e;r-n!==0&&(t=1)}return this.getTranslatedPhrase(Yd,t)},callback(){const{from:e,to:r}=this.getSelectedRangeLast(),n=Math.max(Math.min(e.col,r.col),0),i=Math.max(e.col,r.col),o=[];for(let t=n;t<=i;t+=1)o.push(t);t.hideColumns(o);const a=o[o.length-1],s=this.columnIndexMapper.getNearestNotHiddenIndex(a,1,!0);Number.isInteger(s)&&s>=0?this.selectColumns(s):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}),function(e){const t=[];return{key:"hidden_columns_show",name(){const e=t.length>1?1:0;return this.getTranslatedPhrase(Xd,e)},callback(){var r,n;if(0===t.length)return;let i=t[0],o=t[t.length-1];i=null!==(r=this.columnIndexMapper.getNearestNotHiddenIndex(i-1,-1))&&void 0!==r?r:0,o=null!==(n=this.columnIndexMapper.getNearestNotHiddenIndex(o+1,1))&&void 0!==n?n:this.countCols()-1,e.showColumns(t),this.render(),this.view.adjustElementsSize(),o-i+1===this.countCols()||this.selectColumns(i,o)},disabled:!1,hidden(){const r=_i(e.getHiddenColumns(),(e=>this.toPhysicalColumn(e)));if(!this.selection.isSelectedByColumnHeader()&&!this.selection.isSelectedByCorner()||r.length<1)return!0;t.length=0;const n=this.getSelectedRangeLast(),i=n.getTopStartCorner().col,o=n.getBottomEndCorner().col,a=this.columnIndexMapper,s=a.getRenderableFromVisualIndex(i),l=a.getRenderableFromVisualIndex(o),c=a.getNotTrimmedIndexes(),u=[];if(i!==o){if(o-i+1>l-s+1){const e=c.slice(i,o+1);u.push(...e.filter((e=>r.includes(e))))}}else if(0===s&&s<i)u.push(...c.slice(0,i));else if(null===s)u.push(...c.slice(0,this.countCols()));else{const e=this.countCols()-1;l===a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(e,-1))&&e>o&&u.push(...c.slice(o+1))}return Ai(u,(e=>{t.push(this.toVisualColumn(e))})),0===t.length}}}(this))}function rM(){Array.isArray(VO($O,this).columns)&&this.hideColumns(VO($O,this).columns)}function nM(e,t,r){iM(e,t),t.set(e,r)}function iM(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function oM(e,t){return e.get(sM(e,t))}function aM(e,t,r){return e.set(sM(e,t),r),r}function sM(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}Ko.getSingleton().register("beforeHideRows"),Ko.getSingleton().register("afterHideRows"),Ko.getSingleton().register("beforeUnhideRows"),Ko.getSingleton().register("afterUnhideRows");const lM="hiddenRows";var cM=new WeakMap,uM=new WeakMap,hM=new WeakSet;class dM extends Fy{constructor(){super(...arguments),function(e,t){iM(e,t),t.add(e)}(this,hM),nM(this,cM,{}),nM(this,uM,null)}static get PLUGIN_KEY(){return lM}static get PLUGIN_PRIORITY(){return 320}isEnabled(){return!!this.hot.getSettings()[lM]}enablePlugin(){var e=this;if(this.enabled)return;const t=this.hot.getSettings()[lM];so(t)&&(aM(cM,this,t),Di(t.copyPasteEnabled)&&(t.copyPasteEnabled=!0)),aM(uM,this,new Mh),oM(uM,this).addLocalHook("init",(()=>sM(hM,this,bM).call(this))),this.hot.rowIndexMapper.registerMap(this.pluginName,oM(uM,this)),this.addHook("afterContextMenuDefaultOptions",(function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return sM(hM,e,vM).call(e,...r)})),this.addHook("afterGetCellMeta",((e,t,r)=>sM(hM,this,gM).call(this,e,t,r))),this.addHook("modifyRowHeight",((e,t)=>sM(hM,this,fM).call(this,e,t))),this.addHook("afterGetRowHeader",(function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return sM(hM,e,mM).call(e,...r)})),this.addHook("modifyCopyableRange",(e=>sM(hM,this,pM).call(this,e))),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap(this.pluginName),aM(cM,this,{}),super.disablePlugin(),this.resetCellsMeta()}showRows(e){const t=this.getHiddenRows(),r=this.isValidConfig(e);let n=t;const i=oM(uM,this).getValues().slice(),o=e.length>0;if(r&&o){Ai(e.map((e=>this.hot.toPhysicalRow(e))),(e=>{i[e]=!1})),n=Ei(i,((e,t,r)=>(t&&e.push(this.hot.toVisualRow(r)),e)),[])}!1!==this.hot.runHooks("beforeUnhideRows",t,n,r&&o)&&(r&&o&&oM(uM,this).setValues(i),this.hot.runHooks("afterUnhideRows",t,n,r&&o,r&&n.length<t.length))}showRow(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.showRows(t)}hideRows(e){const t=this.getHiddenRows(),r=this.isValidConfig(e);let n=t;r&&(n=Array.from(new Set(t.concat(e))));!1!==this.hot.runHooks("beforeHideRows",t,n,r)&&(r&&this.hot.batchExecution((()=>{Ai(e,(e=>{oM(uM,this).setValueAtIndex(this.hot.toPhysicalRow(e),!0)}))}),!0),this.hot.runHooks("afterHideRows",t,n,r,r&&n.length>t.length))}hideRow(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.hideRows(t)}getHiddenRows(){return _i(oM(uM,this).getHiddenIndexes(),(e=>this.hot.toVisualRow(e)))}isHidden(e){return oM(uM,this).getValueAtIndex(this.hot.toPhysicalRow(e))||!1}isValidConfig(e){const t=this.hot.countRows();return!!(Array.isArray(e)&&e.length>0)&&e.every((e=>Number.isInteger(e)&&e>=0&&e<t))}resetCellsMeta(){Ai(this.hot.getCellsMeta(),(e=>{e&&(e.skipRowOnPaste=!1)}))}destroy(){aM(cM,this,null),aM(uM,this,null),super.destroy()}}function fM(e,t){return this.isHidden(t)?0:e}function gM(e,t,r){if(!1===oM(cM,this).copyPasteEnabled&&this.isHidden(e)&&(r.skipRowOnPaste=!0),this.isHidden(e-1))r.className=r.className||"",-1===r.className.indexOf("afterHiddenRow")&&(r.className+=" afterHiddenRow");else if(r.className){const e=r.className.split(" ");if(e.length>0){const t=e.indexOf("afterHiddenRow");t>-1&&e.splice(t,1),r.className=e.join(" ")}}}function pM(e){if(oM(cM,this).copyPasteEnabled)return e;const t=[],r=(e,r,n,i)=>{t.push({startRow:e,endRow:r,startCol:n,endCol:i})};return Ai(e,(e=>{let t=!0,n=0;ja(e.startRow,e.endRow,(i=>{this.isHidden(i)?(t||r(n,i-1,e.startCol,e.endCol),t=!0):(t&&(n=i),i===e.endRow&&r(n,i,e.startCol,e.endCol),t=!1)}))})),t}function mM(e,t){if(!oM(cM,this).indicators||e<0)return;const r=[];e>=1&&this.isHidden(e-1)&&r.push("afterHiddenRow"),e<this.hot.countRows()-1&&this.isHidden(e+1)&&r.push("beforeHiddenRow"),jn(t,r)}function vM(e){var t;e.items.push({name:HC},(t=this,{key:"hidden_rows_hide",name(){const e=this.getSelectedLast();let t=0;if(Array.isArray(e)){const[r,,n]=e;r-n!==0&&(t=1)}return this.getTranslatedPhrase(Jd,t)},callback(){const{from:e,to:r}=this.getSelectedRangeLast(),n=Math.max(Math.min(e.row,r.row),0),i=Math.max(e.row,r.row),o=[];for(let t=n;t<=i;t+=1)o.push(t);t.hideRows(o);const a=o[o.length-1],s=this.rowIndexMapper.getNearestNotHiddenIndex(a,1,!0);Number.isInteger(s)&&s>=0?this.selectRows(s):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}),function(e){const t=[];return{key:"hidden_rows_show",name(){const e=t.length>1?1:0;return this.getTranslatedPhrase(Zd,e)},callback(){var r,n;if(0===t.length)return;let i=t[0],o=t[t.length-1];i=null!==(r=this.rowIndexMapper.getNearestNotHiddenIndex(i-1,-1))&&void 0!==r?r:0,o=null!==(n=this.rowIndexMapper.getNearestNotHiddenIndex(o+1,1))&&void 0!==n?n:this.countRows()-1,e.showRows(t),this.render(),this.view.adjustElementsSize(),o-i+1===this.countRows()||this.selectRows(i,o)},disabled:!1,hidden(){const r=_i(e.getHiddenRows(),(e=>this.toPhysicalRow(e)));if(!this.selection.isSelectedByRowHeader()&&!this.selection.isSelectedByCorner()||r.length<1)return!0;t.length=0;const n=this.getSelectedRangeLast(),i=n.getTopStartCorner().row,o=n.getBottomEndCorner().row,a=this.rowIndexMapper,s=a.getRenderableFromVisualIndex(i),l=a.getRenderableFromVisualIndex(o),c=a.getNotTrimmedIndexes(),u=[];if(i!==o){if(o-i+1>l-s+1){const e=c.slice(i,o+1);u.push(...e.filter((e=>r.includes(e))))}}else if(0===s&&s<i)u.push(...c.slice(0,i));else if(null===s)u.push(...c.slice(0,this.countRows()));else{const e=this.countRows()-1;l===a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(e,-1))&&e>o&&u.push(...c.slice(o+1))}return Ai(u,(e=>{t.push(this.toVisualRow(e))})),0===t.length}}}(this))}function bM(){Array.isArray(oM(cM,this).rows)&&this.hideRows(oM(cM,this).rows)}function yM(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function wM(e,t){return e.get(CM(e,t))}function SM(e,t,r){return e.set(CM(e,t),r),r}function CM(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}Ko.getSingleton().register("beforeColumnFreeze"),Ko.getSingleton().register("afterColumnFreeze"),Ko.getSingleton().register("beforeColumnUnfreeze"),Ko.getSingleton().register("afterColumnUnfreeze");const kM="manualColumnFreeze";var xM=new WeakMap,EM=new WeakSet;class TM extends Fy{constructor(){super(...arguments),function(e,t){yM(e,t),t.add(e)}(this,EM),function(e,t,r){yM(e,t),t.set(e,r)}(this,xM,!1)}static get PLUGIN_KEY(){return kM}static get PLUGIN_PRIORITY(){return 110}isEnabled(){return!!this.hot.getSettings()[kM]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",(e=>CM(EM,this,_M).call(this,e))),this.addHook("beforeColumnMove",((e,t)=>CM(EM,this,AM).call(this,e,t))),super.enablePlugin())}disablePlugin(){SM(xM,this,!1),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(e){const t=this.hot.getSettings(),r=t.fixedColumnsStart<this.hot.countCols()&&e>t.fixedColumnsStart-1;wM(xM,this)||SM(xM,this,!0);!1!==this.hot.runHooks("beforeColumnFreeze",e,r)&&(r&&(this.hot.columnIndexMapper.moveIndexes(e,t.fixedColumnsStart),t._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",e,r))}unfreezeColumn(e){const t=this.hot.getSettings(),r=t.fixedColumnsStart>0&&e<=t.fixedColumnsStart-1;wM(xM,this)||SM(xM,this,!0);!1!==this.hot.runHooks("beforeColumnUnfreeze",e,r)&&(r&&(t._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(e,t.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",e,r))}}function _M(e){var t;e.items.push({name:"---------"},(t=this,{key:"freeze_column",name(){return this.getTranslatedPhrase(Ed)},callback(e,r){const[{start:{col:n}}]=r;t.freezeColumn(n),this.render(),this.view.adjustElementsSize()},hidden(){const e=this.getSelectedRange();let t=!1;return(void 0===e||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(t=!0),t}}),function(e){return{key:"unfreeze_column",name(){return this.getTranslatedPhrase(Td)},callback(t,r){const[{start:{col:n}}]=r;e.unfreezeColumn(n),this.render(),this.view.adjustElementsSize()},hidden(){const e=this.getSelectedRange();let t=!1;return(void 0===e||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col>=this.getSettings().fixedColumnsStart)&&(t=!0),t}}}(this))}function AM(e,t){if(wM(xM,this)){const r=this.hot.getSettings().fixedColumnsStart;if(t<r)return!1;if(e.some((e=>e<r)))return!1}}function RM(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const OM="px";const MM=class{constructor(e){RM(this,"hot",void 0),RM(this,"_element",null),RM(this,"state",0),RM(this,"inlineProperty",void 0),this.hot=e,this.inlineProperty=e.isRtl()?"right":"left"}appendTo(e){e.appendChild(this._element),this.state=2}build(){0===this.state&&(this._element=this.hot.rootDocument.createElement("div"),this.state=1)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=0}isAppended(){return 2===this.state}isBuilt(){return this.state>=1}setPosition(e,t){Ua(e)&&(this._element.style.top=e+OM),Ua(t)&&(this._element.style[this.inlineProperty]=t+OM)}getPosition(){const e=this._element.style;return{top:e.top?parseInt(e.top,10):0,start:e[this.inlineProperty]?parseInt(e[this.inlineProperty],10):0}}setSize(e,t){Ua(e)&&(this._element.style.width=e+OM),Ua(t)&&(this._element.style.height=t+OM)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,t){Ua(e)&&(this._element.style.marginTop=e+OM),Ua(t)&&(this._element.style[`margin${un(this.inlineProperty)}`]=t+OM)}getOffset(){const e=this._element.style,t=`margin${un(this.inlineProperty)}`;return{top:e.marginTop?parseInt(e.marginTop,10):0,start:e[t]?parseInt(e[t],10):0}}};const IM=class extends MM{build(){super.build(),jn(this._element,"ht__manualColumnMove--backlight")}};const PM=class extends MM{build(){super.build(),jn(this._element,"ht__manualColumnMove--guideline")}};function NM(e,t,r){DM(e,t),t.set(e,r)}function DM(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function FM(e,t,r){return e.set(HM(e,t),r),r}function LM(e,t){return e.get(HM(e,t))}function HM(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}Ko.getSingleton().register("beforeColumnMove"),Ko.getSingleton().register("afterColumnMove");const BM="manualColumnMove",UM="ht__manualColumnMove",jM="show-ui",WM="on-moving--columns",VM="after-selection--columns";var zM=new WeakMap,qM=new WeakMap,GM=new WeakMap,$M=new WeakMap,KM=new WeakMap,YM=new WeakMap,XM=new WeakMap,JM=new WeakMap,ZM=new WeakMap,QM=new WeakMap,eI=new WeakMap,tI=new WeakSet;class rI extends Fy{constructor(){super(...arguments),function(e,t){DM(e,t),t.add(e)}(this,tI),NM(this,zM,new IM(this.hot)),NM(this,qM,new PM(this.hot)),NM(this,GM,[]),NM(this,$M,0),NM(this,KM,!1),NM(this,YM,{}),NM(this,XM,void 0),NM(this,JM,void 0),NM(this,ZM,void 0),NM(this,QM,void 0),NM(this,eI,void 0)}static get PLUGIN_KEY(){return BM}static get PLUGIN_PRIORITY(){return 120}isEnabled(){return!!this.hot.getSettings()[BM]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",(function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return HM(tI,e,nI).call(e,...r)})),this.addHook("beforeOnCellMouseOver",(function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return HM(tI,e,oI).call(e,...r)})),this.addHook("afterScrollVertically",(()=>HM(tI,this,sI).call(this))),this.addHook("afterLoadData",(function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return HM(tI,e,lI).call(e,...r)})),this.buildPluginUI(),this.registerEvents(),jn(this.hot.rootElement,UM),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){Wn(this.hot.rootElement,UM),this.unregisterEvents(),LM(zM,this).destroy(),LM(qM,this).destroy(),super.disablePlugin()}moveColumn(e,t){return this.moveColumns([e],t)}moveColumns(e,t){const r=LM(XM,this),n=this.isMovePossible(e,t),i=this.hot.runHooks("beforeColumnMove",e,t,r,n);if(FM(XM,this,void 0),!1===i)return;n&&this.hot.columnIndexMapper.moveIndexes(e,t);const o=n&&this.isColumnOrderChanged(e,t);return this.hot.runHooks("afterColumnMove",e,t,r,n,o),o}dragColumn(e,t){return this.dragColumns([e],t)}dragColumns(e,t){const r=this.countFinalIndex(e,t);return FM(XM,this,t),this.moveColumns(e,r)}isMovePossible(e,t){const r=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),n=e.length+t>r,i=t<0,o=e.some((e=>e<0)),a=e.some((e=>e>=r));return!(n||i||o||a)}isColumnOrderChanged(e,t){return e.some(((e,r)=>e-r!==t))}countFinalIndex(e,t){const r=Ei(e,((e,r)=>(r<t&&(e+=1),e)),0);return t-r}getColumnsWidth(e,t){const r=this.hot.columnIndexMapper;let n=0;for(let i=e;i<=t;i+=1){const e=r.getRenderableFromVisualIndex(i);i<0?n+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:null!==e&&(n+=this.hot.view._wt.wtTable.getStretchedColumnWidth(e)||0)}return n}moveBySettingsOrLoad(){const e=this.hot.getSettings()[BM];if(Array.isArray(e))this.moveColumns(e,0);else if(void 0!==e){const e=this.persistentStateLoad();e.length&&this.moveColumns(e,0)}}isFixedColumnsStart(e){return e<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",e),e.value?e.value:[]}prepareColumnsToMoving(e,t){const r=[];return ja(e,t,(e=>{r.push(e)})),r}refreshPositions(){const e=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(LM(JM,this))&&e>0&&this.hot.scrollViewportTo({col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(e-1,-1)});const t=this.hot.view._wt.wtTable,r=this.hot.view._wt.wtOverlays.scrollableElement,n="number"===typeof r.scrollX?r.scrollX:r.scrollLeft;let i=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,LM(JM,this)-1);const o=t.hider.offsetWidth,a=t.TBODY.offsetLeft,s=LM(zM,this).getOffset().start,l=LM(zM,this).getSize().width;let c=0,u=0;if(this.hot.isRtl()){const e=this.hot.rootWindow,t=ai(this.hot.rootElement),i=e.innerWidth-LM(ZM,this)-t;u=e.innerWidth-LM(YM,this).eventPageX-i-(void 0===r.scrollX?n:0)}else u=LM(YM,this).eventPageX-(LM(ZM,this)-(void 0===r.scrollX?n:0));if(LM(QM,this)&&(c=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(LM(JM,this))&&(i+=n),i+=c,LM(JM,this)<0)LM(eI,this)>0?LM(YM,this).col=0:LM(YM,this).col=e>0?e-1:e;else if(LM(YM,this).TD.offsetWidth/2+i<=u){const e=LM(JM,this)>=LM($M,this)?LM($M,this)-1:LM(JM,this);LM(YM,this).col=e+1,i+=LM(YM,this).TD.offsetWidth}else LM(YM,this).col=LM(JM,this);let h=u,d=i;u+l+s>=o?h=o-l-s:u+s<a+c&&(h=a+c+Math.abs(s)),i>=o-1?d=o-1:0===d?d=1:void 0!==r.scrollX&&LM(JM,this)<LM(eI,this)&&(d-=LM(ZM,this)<=r.scrollX?LM(ZM,this):0),LM(zM,this).setPosition(null,h),LM(qM,this).setPosition(null,d)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",(e=>HM(tI,this,iI).call(this,e))),this.eventManager.addEventListener(e,"mouseup",(()=>HM(tI,this,aI).call(this)))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){LM(zM,this).build(),LM(qM,this).build()}destroy(){LM(zM,this).destroy(),LM(qM,this).destroy(),super.destroy()}}function nI(e,t,r,n){const i=this.hot.view._wt.wtTable,o=this.hot.selection.isSelectedByColumnHeader(),a=this.hot.getSelectedRangeLast(),s=Un(e.target,"sortAction");if(!a||!o||LM(KM,this)||0!==e.button||s)return FM(KM,this,!1),LM(GM,this).length=0,void Wn(this.hot.rootElement,[WM,jM]);const l=LM(qM,this).isBuilt()&&!LM(qM,this).isAppended(),c=LM(zM,this).isBuilt()&&!LM(zM,this).isAppended();l&&c&&(LM(qM,this).appendTo(i.hider),LM(zM,this).appendTo(i.hider));const{from:u,to:h}=a,d=Math.min(u.col,h.col),f=Math.max(u.col,h.col);if(t.row<0&&t.col>=d&&t.col<=f){n.column=!0,FM(KM,this,!0);const o=r.firstChild?function(e,t){const r={x:e.offsetX,y:e.offsetY};let n=e.target;if(!(t instanceof HTMLElement)||n!==t&&n.contains(t))return r;for(;n!==t;)r.x+=n.offsetLeft,r.y+=n.offsetTop,n=n.offsetParent;return r}(e,r.firstChild).x:e.offsetX;LM(YM,this).eventPageX=e.pageX,FM(JM,this,t.col),LM(YM,this).TD=r,LM(YM,this).col=t.col,FM(GM,this,this.prepareColumnsToMoving(d,f)),FM(QM,this,!!this.hot.getSettings().rowHeaders),FM($M,this,this.hot.countCols()),FM(eI,this,this.hot.getSettings().fixedColumnsStart),FM(ZM,this,Jn(this.hot.rootElement).left);const a=LM(QM,this)?-1:0,s=i.holder.scrollTop+i.getColumnHeaderHeight(0)+1,l=t.col<LM(eI,this),c=this.hot.view._wt.wtOverlays.inlineStartOverlay.getOverlayOffset(),u=Math.abs(o-(this.hot.isRtl()?r.offsetWidth:0)),h=this.getColumnsWidth(d,t.col-1)+u,g=this.getColumnsWidth(a,d-1)+(l?c:0)+h;LM(zM,this).setPosition(s,g),LM(zM,this).setSize(this.getColumnsWidth(d,f),i.hider.offsetHeight-s),LM(zM,this).setOffset(null,-h),jn(this.hot.rootElement,WM)}else Wn(this.hot.rootElement,VM),FM(KM,this,!1),LM(GM,this).length=0}function iI(e){LM(KM,this)&&(LM(YM,this).eventPageX=e.pageX,this.refreshPositions())}function oI(e,t,r,n){this.hot.getSelectedRangeLast()&&LM(KM,this)&&(LM(GM,this).indexOf(t.col)>-1?Wn(this.hot.rootElement,jM):jn(this.hot.rootElement,jM),n.row=!0,n.column=!0,n.cell=!0,FM(JM,this,t.col),LM(YM,this).TD=r)}function aI(){const e=LM(YM,this).col,t=LM(GM,this).length;if(FM(JM,this,void 0),FM(KM,this,!1),Wn(this.hot.rootElement,[WM,jM,VM]),this.hot.selection.isSelectedByColumnHeader()&&jn(this.hot.rootElement,VM),t<1||void 0===e)return;const r=LM(GM,this)[0],n=this.hot.toPhysicalColumn(r),i=this.dragColumns(LM(GM,this),e);if(LM(GM,this).length=0,!0===i){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const e=this.hot.toVisualColumn(n),r=e+t-1;this.hot.selectColumns(e,r)}}function sI(){const e=this.hot.view._wt.wtTable,t=e.getColumnHeaderHeight(0)+1+e.holder.scrollTop;LM(zM,this).setPosition(t),LM(zM,this).setSize(null,e.hider.offsetHeight-t)}function lI(){this.moveBySettingsOrLoad()}function cI(e,t,r){uI(e,t),t.set(e,r)}function uI(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function hI(e,t,r){return e.set(fI(e,t),r),r}function dI(e,t){return e.get(fI(e,t))}function fI(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}const gI="manualColumnResize",pI="manualColumnWidths";var mI=new WeakMap,vI=new WeakMap,bI=new WeakMap,yI=new WeakMap,wI=new WeakMap,SI=new WeakMap,CI=new WeakMap,kI=new WeakMap,xI=new WeakMap,EI=new WeakMap,TI=new WeakMap,_I=new WeakMap,AI=new WeakMap,RI=new WeakMap,OI=new WeakMap,MI=new WeakMap,II=new WeakSet;class PI extends Fy{static get PLUGIN_KEY(){return gI}static get PLUGIN_PRIORITY(){return 130}constructor(e){super(e),function(e,t){uI(e,t),t.add(e)}(this,II),cI(this,mI,null),cI(this,vI,null),cI(this,bI,[]),cI(this,yI,null),cI(this,wI,null),cI(this,SI,null),cI(this,CI,null),cI(this,kI,null),cI(this,xI,this.hot.rootDocument.createElement("DIV")),cI(this,EI,this.hot.rootDocument.createElement("DIV")),cI(this,TI,null),cI(this,_I,!1),cI(this,AI,0),cI(this,RI,null),cI(this,OI,void 0),cI(this,MI,void 0),jn(dI(xI,this),"manualColumnResizer"),jn(dI(EI,this),"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[gI]}enablePlugin(){this.enabled||(hI(OI,this,new Oh),dI(OI,this).addLocalHook("init",(()=>fI(II,this,NI).call(this))),this.hot.columnIndexMapper.registerMap(this.pluginName,dI(OI,this)),this.addHook("modifyColWidth",((e,t)=>fI(II,this,UI).call(this,e,t)),1),this.addHook("beforeStretchingColumnWidth",((e,t)=>fI(II,this,jI).call(this,e,t))),this.addHook("beforeColumnResize",((e,t,r)=>fI(II,this,WI).call(this,e,t,r))),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){hI(MI,this,dI(OI,this).getValues()),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",pI,dI(OI,this).getValues())}loadManualColumnWidths(){const e={};return this.hot.runHooks("persistentStateLoad",pI,e),e.value}setManualSize(e,t){const r=Math.max(t,20),n=this.hot.toPhysicalColumn(e);return dI(OI,this).setValueAtIndex(n,r),r}clearManualSize(e){const t=this.hot.toPhysicalColumn(e);dI(OI,this).setValueAtIndex(t,null)}setupHandlePosition(e){if(!e.parentNode)return;hI(mI,this,e);const{_wt:t}=this.hot.view,r=t.wtTable.getCoords(dI(mI,this)),n=r.col;if(n<0)return;const i=si(dI(mI,this)),o=dI(mI,this).getBoundingClientRect();let a;n<t.getSetting("fixedColumnsStart")&&(a=t.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(dI(mI,this),r.row,r.col)),a||(a=t.wtOverlays.topOverlay.getRelativeCellPosition(dI(mI,this),r.row,r.col)),hI(vI,this,this.hot.columnIndexMapper.getVisualFromRenderableIndex(n)),hI(bI,this,[]);const s=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&s){Ai(this.hot.getSelectedRange(),(e=>{ja(e.getTopStartCorner().col,e.getBottomEndCorner().col,(e=>{dI(bI,this).includes(e)||dI(bI,this).push(e)}))}))}dI(bI,this).includes(dI(vI,this))||hI(bI,this,[dI(vI,this)]),hI(kI,this,a.start-6),hI(CI,this,parseInt(o.width,10)),dI(xI,this).style.top=`${a.top}px`,dI(xI,this).style[this.inlineDir]=`${dI(kI,this)+dI(CI,this)}px`,dI(xI,this).style.height=`${i}px`,this.hot.rootElement.appendChild(dI(xI,this))}refreshHandlePosition(){dI(xI,this).style[this.inlineDir]=`${dI(kI,this)+dI(yI,this)}px`}setupGuidePosition(){const e=parseInt(si(dI(xI,this)),10),t=parseInt(dI(xI,this).style.top,10)+e,r=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);jn(dI(xI,this),"active"),jn(dI(EI,this),"active"),dI(EI,this).style.top=`${t}px`,this.refreshGuidePosition(),dI(EI,this).style.height=r-e+"px",this.hot.rootElement.appendChild(dI(EI,this))}refreshGuidePosition(){dI(EI,this).style[this.inlineDir]=dI(xI,this).style[this.inlineDir]}hideHandleAndGuide(){Wn(dI(xI,this),"active"),Wn(dI(EI,this),"active")}checkIfColumnHeader(e){const t=Nn(e,["THEAD"],this.hot.rootElement),{topOverlay:r,topInlineStartCornerOverlay:n}=this.hot.view._wt.wtOverlays;return[r.clone.wtTable.THEAD,n.clone.wtTable.THEAD].includes(t)}getClosestTHParent(e){return"TABLE"!==e.tagName?"TH"===e.tagName?e:this.getClosestTHParent(e.parentNode):null}afterMouseDownTimeout(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},t=(t,r)=>{const n=this.hot.runHooks("beforeColumnResize",dI(wI,this),t,!0);void 0!==n&&hI(wI,this,n),"all"===this.hot.getSettings().stretchH?this.clearManualSize(t):this.setManualSize(t,dI(wI,this)),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",dI(wI,this),t,!0),r&&e()};if(dI(AI,this)>=2){dI(bI,this).length>1?(Ai(dI(bI,this),(e=>{t(e)})),e()):Ai(dI(bI,this),(e=>{t(e,!0)}))}hI(AI,this,0),hI(RI,this,null)}bindEvents(){const{rootWindow:e,rootElement:t}=this.hot;this.eventManager.addEventListener(t,"mouseover",(e=>fI(II,this,DI).call(this,e))),this.eventManager.addEventListener(t,"mousedown",(e=>fI(II,this,FI).call(this,e))),this.eventManager.addEventListener(e,"mousemove",(e=>fI(II,this,LI).call(this,e))),this.eventManager.addEventListener(e,"mouseup",(()=>fI(II,this,HI).call(this))),this.eventManager.addEventListener(dI(xI,this),"contextmenu",(()=>fI(II,this,BI).call(this)))}destroy(){super.destroy()}}function NI(){const e=this.hot.getSettings()[gI],t=this.loadManualColumnWidths();"undefined"!==typeof t?this.hot.batchExecution((()=>{t.forEach(((e,t)=>{dI(OI,this).setValueAtIndex(t,e)}))}),!0):Array.isArray(e)?(this.hot.batchExecution((()=>{e.forEach(((e,t)=>{dI(OI,this).setValueAtIndex(t,e)}))}),!0),hI(MI,this,e)):!0===e&&Array.isArray(dI(MI,this))&&this.hot.batchExecution((()=>{dI(MI,this).forEach(((e,t)=>{dI(OI,this).setValueAtIndex(t,e)}))}),!0)}function DI(e){if(!yi(e.target)&&!0!==dI(_I,this)&&this.checkIfColumnHeader(e.target)){const t=this.getClosestTHParent(e.target);if(!t)return;const r=t.getAttribute("colspan");!t||null!==r&&"1"!==r||dI(TI,this)||this.setupHandlePosition(t)}}function FI(e){e.target.parentNode===this.hot.rootElement&&Un(e.target,"manualColumnResizer")&&(this.setupHandlePosition(dI(mI,this)),this.setupGuidePosition(),hI(TI,this,!0),null===dI(RI,this)&&(hI(RI,this,setTimeout((()=>this.afterMouseDownTimeout()),500)),this.hot._registerTimeout(dI(RI,this))),hI(AI,this,dI(AI,this)+1),this.startX=e.pageX,hI(wI,this,dI(CI,this)))}function LI(e){if(dI(TI,this)){const t=(e.pageX-this.startX)*this.hot.getDirectionFactor();hI(yI,this,dI(CI,this)+t),Ai(dI(bI,this),(e=>{hI(wI,this,this.setManualSize(e,dI(yI,this)))})),this.refreshHandlePosition(),this.refreshGuidePosition()}}function HI(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},t=(t,r)=>{this.hot.runHooks("beforeColumnResize",dI(wI,this),t,!1),r&&e(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",dI(wI,this),t,!1)};if(dI(TI,this)){if(this.hideHandleAndGuide(),hI(TI,this,!1),dI(wI,this)!==dI(CI,this)){dI(bI,this).length>1?(Ai(dI(bI,this),(e=>{t(e)})),e()):Ai(dI(bI,this),(e=>{t(e,!0)}))}this.setupHandlePosition(dI(mI,this))}}function BI(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(dI(xI,this)),this.hot.rootElement.removeChild(dI(EI,this)),hI(TI,this,!1),hI(_I,this,!0),this.hot._registerImmediate((()=>{hI(_I,this,!1)}))}function UI(e,t){let r=e;if(this.enabled){const e=this.hot.toPhysicalColumn(t),n=dI(OI,this).getValueAtIndex(e);this.hot.getSettings()[gI]&&n&&(r=n)}return r}function jI(e,t){let r=dI(OI,this).getValueAtIndex(t);return null===r&&(r=e),r}function WI(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}function VI(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const zI="px";const qI=class{constructor(e){VI(this,"hot",void 0),VI(this,"_element",null),VI(this,"state",0),this.hot=e}appendTo(e){e.appendChild(this._element),this.state=2}build(){0===this.state&&(this._element=this.hot.rootDocument.createElement("div"),this.state=1)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=0}isAppended(){return 2===this.state}isBuilt(){return this.state>=1}setPosition(e,t){void 0!==e&&(this._element.style.top=e+zI),void 0!==t&&(this._element.style.left=t+zI)}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(e,t){e&&(this._element.style.width=e+zI),t&&(this._element.style.height=t+zI)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,t){e&&(this._element.style.marginTop=e+zI),t&&(this._element.style.marginLeft=t+zI)}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}};const GI=class extends qI{build(){super.build(),jn(this._element,"ht__manualRowMove--backlight")}};const $I=class extends qI{build(){super.build(),jn(this._element,"ht__manualRowMove--guideline")}};function KI(e,t,r){YI(e,t),t.set(e,r)}function YI(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function XI(e,t,r){return e.set(ZI(e,t),r),r}function JI(e,t){return e.get(ZI(e,t))}function ZI(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}Ko.getSingleton().register("beforeRowMove"),Ko.getSingleton().register("afterRowMove");const QI="manualRowMove",eP="ht__manualRowMove",tP="show-ui",rP="on-moving--rows",nP="after-selection--rows";var iP=new WeakMap,oP=new WeakMap,aP=new WeakMap,sP=new WeakMap,lP=new WeakMap,cP=new WeakMap,uP=new WeakSet;class hP extends Fy{constructor(){super(...arguments),function(e,t){YI(e,t),t.add(e)}(this,uP),KI(this,iP,new GI(this.hot)),KI(this,oP,new $I(this.hot)),KI(this,aP,[]),KI(this,sP,void 0),KI(this,lP,{}),KI(this,cP,void 0)}static get PLUGIN_KEY(){return QI}static get PLUGIN_PRIORITY(){return 140}isEnabled(){return!!this.hot.getSettings()[QI]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",(function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return ZI(uP,e,dP).call(e,...r)})),this.addHook("beforeOnCellMouseOver",(function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return ZI(uP,e,gP).call(e,...r)})),this.addHook("afterScrollHorizontally",(()=>ZI(uP,this,mP).call(this))),this.addHook("afterLoadData",(function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return ZI(uP,e,vP).call(e,...r)})),this.buildPluginUI(),this.registerEvents(),jn(this.hot.rootElement,eP),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){Wn(this.hot.rootElement,eP),this.unregisterEvents(),JI(iP,this).destroy(),JI(oP,this).destroy(),super.disablePlugin()}moveRow(e,t){return this.moveRows([e],t)}moveRows(e,t){const r=JI(cP,this),n=this.isMovePossible(e,t),i=this.hot.runHooks("beforeRowMove",e,t,r,n);if(XI(cP,this,void 0),!1===i)return;n&&this.hot.rowIndexMapper.moveIndexes(e,t);const o=n&&this.isRowOrderChanged(e,t);return this.hot.runHooks("afterRowMove",e,t,r,n,o),o}dragRow(e,t){return this.dragRows([e],t)}dragRows(e,t){const r=this.countFinalIndex(e,t);return XI(cP,this,t),this.moveRows(e,r)}isMovePossible(e,t){const r=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),n=e.length+t>r,i=t<0,o=e.some((e=>e<0)),a=e.some((e=>e>=r));return!(n||i||o||a)}isRowOrderChanged(e,t){return e.some(((e,r)=>e-r!==t))}countFinalIndex(e,t){const r=Ei(e,((e,r)=>(r<t&&(e+=1),e)),0);return t-r}getRowsHeight(e,t){const r=this.hot.rowIndexMapper;let n=0;for(let i=e;i<=t;i++){const e=r.getRenderableFromVisualIndex(i);null!==e&&(n+=this.hot.view._wt.wtTable.getRowHeight(e)||23)}return n}moveBySettingsOrLoad(){const e=this.hot.getSettings()[QI];if(Array.isArray(e))this.moveRows(e,0);else if(void 0!==e){const e=this.persistentStateLoad();e.length&&this.moveRows(e,0)}}isFixedRowTop(e){return e<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(e){return e>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualRowMove",e),e.value?e.value:[]}prepareRowsToMoving(){const e=this.hot.getSelectedRangeLast(),t=[];if(!e)return t;const{from:r,to:n}=e;return ja(Math.min(r.row,n.row),Math.max(r.row,n.row),(e=>{t.push(e)})),t}refreshPositions(){const e=JI(lP,this).coords,t=this.hot.view.getFirstFullyVisibleRow(),r=this.hot.view.getLastFullyVisibleRow(),n=this.hot.countRows();this.isFixedRowTop(e.row)&&t>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(t-1,-1)),this.isFixedRowBottom(e.row)&&r<n&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(r+1,1),void 0,!0);const i=this.hot.view._wt.wtTable,o=JI(lP,this).TD,a=this.hot.rootElement,s=Jn(a),l=ni(a),c=i.holder.scrollTop,u=this.hot.rootWindow!==l?l.scrollTop:0,h=s.top-u,d=JI(lP,this).eventPageY-h+c,f=i.hider.offsetHeight,g=i.TBODY.offsetTop,p=JI(iP,this).getOffset().top,m=JI(iP,this).getSize().height,v=o.offsetHeight/2,b=o.offsetHeight;let y=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,e.row-1);const w=d>=y+v;this.isFixedRowTop(e.row)&&(y+=this.hot.view._wt.wtOverlays.topOverlay.getOverlayOffset()),e.row<0?JI(lP,this).row=t>0?t-1:t:w?(JI(lP,this).row=e.row+1,y+=0===e.row?b-1:b):JI(lP,this).row=e.row;let S=d,C=y;d+m+p>=f?S=f-m-p:d+p<g&&(S=g+Math.abs(p)),y>=f-1&&(C=f-1),JI(iP,this).setPosition(S),JI(oP,this).setPosition(C)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",(e=>ZI(uP,this,fP).call(this,e))),this.eventManager.addEventListener(e,"mouseup",(()=>ZI(uP,this,pP).call(this)))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){JI(iP,this).build(),JI(oP,this).build()}destroy(){JI(iP,this).destroy(),JI(oP,this).destroy(),super.destroy()}}function dP(e,t,r,n){const{wtTable:i,wtViewport:o}=this.hot.view._wt,a=this.hot.selection.isSelectedByRowHeader(),s=this.hot.getSelectedRangeLast();if(!s||!a||JI(sP,this)||0!==e.button)return XI(sP,this,!1),JI(aP,this).length=0,void Wn(this.hot.rootElement,[rP,tP]);const l=JI(oP,this).isBuilt()&&!JI(oP,this).isAppended(),c=JI(iP,this).isBuilt()&&!JI(iP,this).isAppended();l&&c&&(JI(oP,this).appendTo(i.hider),JI(iP,this).appendTo(i.hider));const{from:u,to:h}=s,d=Math.min(u.row,h.row),f=Math.max(u.row,h.row);if(t.col<0&&t.row>=d&&t.row<=f){n.row=!0,XI(sP,this,!0),JI(lP,this).eventPageY=e.pageY,JI(lP,this).coords=t,JI(lP,this).TD=r,XI(aP,this,this.prepareRowsToMoving());const a=i.holder.scrollLeft+o.getRowHeaderWidth(),s=this.getRowsHeight(d,t.row-1)+e.offsetY;JI(iP,this).setPosition(null,a),JI(iP,this).setSize(i.hider.offsetWidth-a,this.getRowsHeight(d,f)),JI(iP,this).setOffset(-s,null),jn(this.hot.rootElement,rP),this.refreshPositions()}else Wn(this.hot.rootElement,nP),XI(sP,this,!1),JI(aP,this).length=0}function fP(e){JI(sP,this)&&(JI(lP,this).eventPageY=e.pageY,this.refreshPositions())}function gP(e,t,r,n){this.hot.getSelectedRangeLast()&&JI(sP,this)&&(JI(aP,this).indexOf(t.row)>-1?Wn(this.hot.rootElement,tP):jn(this.hot.rootElement,tP),n.row=!0,n.column=!0,n.cell=!0,JI(lP,this).coords=t,JI(lP,this).TD=r)}function pP(){const e=JI(lP,this).row,t=JI(aP,this).length;if(XI(sP,this,!1),Wn(this.hot.rootElement,[rP,tP,nP]),this.hot.selection.isSelectedByRowHeader()&&jn(this.hot.rootElement,nP),t<1||void 0===e)return;const r=JI(aP,this)[0],n=this.hot.toPhysicalRow(r),i=this.dragRows(JI(aP,this),e);if(JI(aP,this).length=0,!0===i){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const e=this.hot.toVisualRow(n),r=e+t-1;this.hot.selectRows(e,r)}}function mP(){const e=this.hot.view._wt.wtTable,t=this.hot.view._wt.wtViewport.getRowHeaderWidth()+e.holder.scrollLeft;JI(iP,this).setPosition(null,t),JI(iP,this).setSize(e.hider.offsetWidth-t)}function vP(){this.moveBySettingsOrLoad()}function bP(e,t,r){yP(e,t),t.set(e,r)}function yP(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function wP(e,t,r){return e.set(CP(e,t),r),r}function SP(e,t){return e.get(CP(e,t))}function CP(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}const kP="manualRowResize",xP="manualRowHeights";var EP=new WeakMap,TP=new WeakMap,_P=new WeakMap,AP=new WeakMap,RP=new WeakMap,OP=new WeakMap,MP=new WeakMap,IP=new WeakMap,PP=new WeakMap,NP=new WeakMap,DP=new WeakMap,FP=new WeakMap,LP=new WeakMap,HP=new WeakMap,BP=new WeakMap,UP=new WeakMap,jP=new WeakSet;class WP extends Fy{static get PLUGIN_KEY(){return kP}static get PLUGIN_PRIORITY(){return 30}constructor(e){super(e),function(e,t){yP(e,t),t.add(e)}(this,jP),bP(this,EP,null),bP(this,TP,null),bP(this,_P,[]),bP(this,AP,null),bP(this,RP,null),bP(this,OP,null),bP(this,MP,null),bP(this,IP,null),bP(this,PP,this.hot.rootDocument.createElement("DIV")),bP(this,NP,this.hot.rootDocument.createElement("DIV")),bP(this,DP,!1),bP(this,FP,!1),bP(this,LP,0),bP(this,HP,null),bP(this,BP,void 0),bP(this,UP,void 0),jn(SP(PP,this),"manualRowResizer"),jn(SP(NP,this),"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[kP]}enablePlugin(){this.enabled||(wP(BP,this,new Oh),SP(BP,this).addLocalHook("init",(()=>CP(jP,this,YP).call(this))),this.hot.rowIndexMapper.registerMap(this.pluginName,SP(BP,this)),this.addHook("modifyRowHeight",((e,t)=>CP(jP,this,KP).call(this,e,t))),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){wP(UP,this,SP(BP,this).getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",xP,SP(BP,this).getValues())}loadManualRowHeights(){const e={};return this.hot.runHooks("persistentStateLoad",xP,e),e.value}setManualSize(e,t){const r=this.hot.toPhysicalRow(e),n=Math.max(t,23);return SP(BP,this).setValueAtIndex(r,n),n}getLastDesiredRowHeight(){return SP(AP,this)}setupHandlePosition(e){wP(EP,this,e);const{view:t}=this.hot,{_wt:r}=t,n=r.wtTable.getCoords(SP(EP,this)),i=n.row;if(i<0)return;const o=ai(SP(EP,this)),a=SP(EP,this).getBoundingClientRect(),s=i<r.getSetting("fixedRowsTop"),l=i>=t.countNotHiddenRowIndexes(0,1)-r.getSetting("fixedRowsBottom");let c;s?c=r.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(SP(EP,this),n.row,n.col):l&&(c=r.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(SP(EP,this),n.row,n.col)),c||(c=r.wtOverlays.inlineStartOverlay.getRelativeCellPosition(SP(EP,this),n.row,n.col)),wP(TP,this,this.hot.rowIndexMapper.getVisualFromRenderableIndex(i)),wP(_P,this,[]);const u=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&u){Ai(this.hot.getSelectedRange(),(e=>{ja(e.getTopStartCorner().row,e.getBottomStartCorner().row,(e=>{SP(_P,this).includes(e)||SP(_P,this).push(e)}))}))}SP(_P,this).includes(SP(TP,this))||wP(_P,this,[SP(TP,this)]),wP(IP,this,c.top-6),wP(MP,this,parseInt(a.height,10)),SP(PP,this).style.top=`${SP(IP,this)+SP(MP,this)}px`,SP(PP,this).style[this.inlineDir]=`${c.start}px`,SP(PP,this).style.width=`${o}px`,this.hot.rootElement.appendChild(SP(PP,this))}refreshHandlePosition(){SP(PP,this).style.top=`${SP(IP,this)+SP(AP,this)}px`}setupGuidePosition(){const e=parseInt(ai(SP(PP,this)),10),t=parseInt(SP(PP,this).style[this.inlineDir],10)+e,r=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);jn(SP(PP,this),"active"),jn(SP(NP,this),"active"),SP(NP,this).style.top=SP(PP,this).style.top,SP(NP,this).style[this.inlineDir]=`${t}px`,SP(NP,this).style.width=r-e+"px",this.hot.rootElement.appendChild(SP(NP,this))}refreshGuidePosition(){SP(NP,this).style.top=SP(PP,this).style.top}hideHandleAndGuide(){Wn(SP(PP,this),"active"),Wn(SP(NP,this),"active")}checkIfRowHeader(e){const t=Nn(e,["TBODY"],this.hot.rootElement),{inlineStartOverlay:r,topInlineStartCornerOverlay:n,bottomInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;return[r.clone.wtTable.TBODY,n.clone.wtTable.TBODY,i.clone.wtTable.TBODY].includes(t)}getClosestTHParent(e){return"TABLE"!==e.tagName?"TH"===e.tagName?e:this.getClosestTHParent(e.parentNode):null}getActualRowHeight(e){const t=this.hot.view._wt.wtTable.getRowHeight(e);return void 0!==t&&SP(RP,this)<t?t:SP(RP,this)}afterMouseDownTimeout(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},t=(t,r)=>{const n=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(t),t,!0);void 0!==n&&wP(RP,this,n),this.setManualSize(t,SP(RP,this)),this.hot.runHooks("afterRowResize",this.getActualRowHeight(t),t,!0),r&&e()};if(SP(LP,this)>=2){SP(_P,this).length>1?(Ai(SP(_P,this),(e=>{t(e)})),e()):Ai(SP(_P,this),(e=>{t(e,!0)}))}wP(LP,this,0),wP(HP,this,null)}bindEvents(){const{rootElement:e,rootWindow:t}=this.hot;this.eventManager.addEventListener(e,"mouseover",(e=>CP(jP,this,VP).call(this,e))),this.eventManager.addEventListener(e,"mousedown",(e=>CP(jP,this,zP).call(this,e))),this.eventManager.addEventListener(t,"mousemove",(e=>CP(jP,this,qP).call(this,e))),this.eventManager.addEventListener(t,"mouseup",(()=>CP(jP,this,GP).call(this))),this.eventManager.addEventListener(SP(PP,this),"contextmenu",(()=>CP(jP,this,$P).call(this)))}destroy(){super.destroy()}}function VP(e){if(!yi(e.target)&&!0!==SP(FP,this)&&this.checkIfRowHeader(e.target)){const t=this.getClosestTHParent(e.target);t&&(SP(DP,this)||this.setupHandlePosition(t))}}function zP(e){Un(e.target,"manualRowResizer")&&(this.setupHandlePosition(SP(EP,this)),this.setupGuidePosition(),wP(DP,this,!0),null===SP(HP,this)&&(wP(HP,this,setTimeout((()=>this.afterMouseDownTimeout()),500)),this.hot._registerTimeout(SP(HP,this))),wP(LP,this,SP(LP,this)+1),wP(OP,this,e.pageY),wP(RP,this,SP(MP,this)))}function qP(e){SP(DP,this)&&(wP(AP,this,SP(MP,this)+(e.pageY-SP(OP,this))),Ai(SP(_P,this),(e=>{wP(RP,this,this.setManualSize(e,SP(AP,this)))})),this.refreshHandlePosition(),this.refreshGuidePosition())}function GP(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},t=(t,r)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(t),t,!1),r&&e(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(t),t,!1)};if(SP(DP,this)){if(this.hideHandleAndGuide(),wP(DP,this,!1),SP(RP,this)!==SP(MP,this)){SP(_P,this).length>1?(Ai(SP(_P,this),(e=>{t(e)})),e()):Ai(SP(_P,this),(e=>{t(e,!0)}))}this.setupHandlePosition(SP(EP,this))}}function $P(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(SP(PP,this)),this.hot.rootElement.removeChild(SP(NP,this)),wP(DP,this,!1),wP(FP,this,!0),this.hot._registerImmediate((()=>{wP(FP,this,!1)}))}function KP(e,t){let r=e;if(this.enabled){const e=this.hot.toPhysicalRow(t),n=SP(BP,this).getValueAtIndex(e);this.hot.getSettings()[kP]&&n&&(r=n)}return r}function YP(){const e=this.hot.getSettings()[kP],t=this.loadManualRowHeights();this.hot.batchExecution((()=>{"undefined"!==typeof t?t.forEach(((e,t)=>{SP(BP,this).setValueAtIndex(t,e)})):Array.isArray(e)?(e.forEach(((e,t)=>{SP(BP,this).setValueAtIndex(t,e)})),wP(UP,this,e)):!0===e&&Array.isArray(SP(UP,this))&&SP(UP,this).forEach(((e,t)=>{SP(BP,this).setValueAtIndex(t,e)}))}),!0)}function XP(e,t,r){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,r)}function JP(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ZP(e,t){return e.get(eN(e,t))}function QP(e,t,r){return e.set(eN(e,t),r),r}function eN(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var tN=new WeakMap;const rN=class{constructor(e,t,r,n,i,o){JP(this,"row",void 0),JP(this,"col",void 0),JP(this,"rowspan",void 0),JP(this,"colspan",void 0),JP(this,"removed",!1),JP(this,"cellCoordsFactory",void 0),JP(this,"cellRangeFactory",void 0),XP(this,tN,null),this.row=e,this.col=t,this.rowspan=r,this.colspan=n,this.cellCoordsFactory=i,this.cellRangeFactory=o}static NEGATIVE_VALUES_WARNING(e){let{row:t,col:r,rowspan:n,colspan:i}=e;return Ii`The merged cell declared with {row: ${t}, col: ${r},\x20
      rowspan: ${n}, colspan: ${i}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(e){let{row:t,col:r}=e;return Ii`The merged cell declared at [${t}, ${r}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(e){let{row:t,col:r}=e;return Ii`The merged cell declared at [${t}, ${r}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(e){let{row:t,col:r}=e;return Ii`The merged cell declared at [${t}, ${r}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(e){let{row:t,col:r,rowspan:n,colspan:i}=e;return t<0||r<0||n<0||i<0}static isSingleCell(e){let{rowspan:t,colspan:r}=e;return 1===r&&1===t}static containsZeroSpan(e){let{rowspan:t,colspan:r}=e;return 0===r||0===t}static isOutOfBounds(e,t,r){return e.row<0||e.col<0||e.row>=t||e.row+e.rowspan-1>=t||e.col>=r||e.col+e.colspan-1>=r}normalize(e){const t=e.countRows(),r=e.countCols();this.row<0?this.row=0:this.row>t-1&&(this.row=t-1),this.col<0?this.col=0:this.col>r-1&&(this.col=r-1),this.row+this.rowspan>t-1&&(this.rowspan=t-this.row),this.col+this.colspan>r-1&&(this.colspan=r-this.col),QP(tN,this,null)}includes(e,t){return this.row<=e&&this.col<=t&&this.row+this.rowspan-1>=e&&this.col+this.colspan-1>=t}includesHorizontally(e){return this.col<=e&&this.col+this.colspan-1>=e}includesVertically(e){return this.row<=e&&this.row+this.rowspan-1>=e}shift(e,t){const r=e[0]||e[1],n=t+Math.abs(e[0]||e[1])-1,i=e[0]?"colspan":"rowspan",o=e[0]?"col":"row",a=Math.min(t,n),s=Math.max(t,n),l=this[o],c=this[o]+this[i]-1;if(l>=t&&(this[o]+=r),r>0)t<=c&&t>l&&(this[i]+=r);else if(r<0){if(a<=l&&s>=c)return this.removed=!0,QP(tN,this,null),!1;if(l>=a&&l<=s){const e=s-l+1,t=Math.abs(r)-e;this[o]-=t+r,this[i]-=e}else if(l<=a&&c>=s)this[i]+=r;else if(l<=a&&c>=a&&c<s){const e=c-a+1;this[i]-=e}}return QP(tN,this,null),!0}isFarther(e,t){return!e||("down"===t?e.row+e.rowspan-1<this.row+this.rowspan-1:"up"===t?e.row>this.row:"right"===t?e.col+e.colspan-1<this.col+this.colspan-1:"left"===t?e.col>this.col:null)}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return ZP(tN,this)||QP(tN,this,this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))),ZP(tN,this)}};function nN(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function iN(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function oN(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var aN=new WeakSet;class sN{constructor(e){nN(this,aN),iN(this,"plugin",void 0),iN(this,"mergedCells",[]),iN(this,"mergedCellsMatrix",new Map),iN(this,"hot",void 0),this.plugin=e,this.hot=e.hot}static IS_OVERLAPPING_WARNING(e){let{row:t,col:r}=e;return Ii`The merged cell declared at [${t}, ${r}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(e,t){var r;return!!this.mergedCellsMatrix.has(e)&&(null!==(r=this.mergedCellsMatrix.get(e).get(t))&&void 0!==r&&r)}getByRange(e){let t=!1;return Ai(this.mergedCells,(r=>!(r.row<=e.from.row&&r.row+r.rowspan-1>=e.to.row&&r.col<=e.from.col&&r.col+r.colspan-1>=e.to.col)||(t=r,t))),t}filterOverlappingMergeCells(e){const t=new Set;this.mergedCells.forEach((e=>{const{row:r,col:n,colspan:i,rowspan:o}=e;for(let a=r;a<r+o;a++)for(let e=n;e<n+i;e++)t.add(`r${a},c${e}`)}));const r=e.filter((e=>{const{row:r,col:n,colspan:i,rowspan:o}=e,a=new Set;let s=!1;for(let l=r;l<r+o;l++){for(let r=n;r<n+i;r++){const n=`r${l},c${r}`;if(t.has(n)){Ho(sN.IS_OVERLAPPING_WARNING(e)),s=!0;break}a.add(n)}if(s)break}return s||t.add(...a),!s}));return r}getWithinRange(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const{row:r,col:n}=e.getTopStartCorner(),{row:i,col:o}=e.getBottomEndCorner(),a=[];for(let s=r;s<=i;s++)for(let e=n;e<=o;e++){const r=this.get(s,e);r&&(t||!t&&r.row===s&&r.col===e)&&a.push(r)}return a}add(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const r=e.row,n=e.col,i=e.rowspan,o=e.colspan,a=new rN(r,n,i,o,this.hot._createCellCoords,this.hot._createCellRange),s=this.get(r,n),l=!t&&this.isOverlapping(a);return s||l?(Ho(sN.IS_OVERLAPPING_WARNING(a)),!1):(this.hot&&a.normalize(this.hot),this.mergedCells.push(a),oN(aN,this,cN).call(this,a),a)}remove(e,t){const r=this.get(e,t),n=r?this.mergedCells.indexOf(r):-1;return!(!r||-1===n)&&(this.mergedCells.splice(n,1),oN(aN,this,uN).call(this,r),r)}clear(){Ai(this.mergedCells,(e=>{let{row:t,col:r,rowspan:n,colspan:i}=e;ja(t,t+n,(e=>{ja(r,r+i,(t=>{const r=this.hot.getCell(e,t);r&&(r.removeAttribute("rowspan"),r.removeAttribute("colspan"),r.style.display="")}))}))})),this.mergedCells.length=0,this.mergedCellsMatrix=new Map}isOverlapping(e){const t=e.getRange();for(let r=0;r<this.mergedCells.length;r++){if(this.mergedCells[r].getRange().overlaps(t))return!0}return!1}isFirstRenderableMergedCell(e,t){const r=this.get(e,t);return r&&this.hot.rowIndexMapper.getNearestNotHiddenIndex(r.row,1)===e&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(r.col,1)===t}getFirstRenderableCoords(e,t){const r=this.get(e,t);if(!r||this.isFirstRenderableMergedCell(e,t))return this.hot._createCellCoords(e,t);const n=this.hot.rowIndexMapper.getNearestNotHiddenIndex(r.row,1),i=this.hot.columnIndexMapper.getNearestNotHiddenIndex(r.col,1);return this.hot._createCellCoords(n,i)}getStartMostColumnIndex(e,t){const r=oN(aN,this,lN).call(this,e,"col",-1);let n=t;for(let i=0;i<r.length;i++)if(r[i]<=t){n=r[i];break}return n}getEndMostColumnIndex(e,t){const r=oN(aN,this,lN).call(this,e,"col",1);let n=t;for(let i=0;i<r.length;i++)if(r[i]>=t){n=r[i];break}return n}getTopMostRowIndex(e,t){const r=oN(aN,this,lN).call(this,e,"row",-1);let n=t;for(let i=0;i<r.length;i++)if(r[i]<=t){n=r[i];break}return n}getBottomMostRowIndex(e,t){const r=oN(aN,this,lN).call(this,e,"row",1);let n=t;for(let i=0;i<r.length;i++)if(r[i]>=t){n=r[i];break}return n}shiftCollections(e,t,r){const n=[0,0];switch(e){case"right":n[0]+=r;break;case"left":n[0]-=r;break;case"down":n[1]+=r;break;case"up":n[1]-=r}Ai(this.mergedCells,(e=>{oN(aN,this,uN).call(this,e),e.shift(n,t),oN(aN,this,cN).call(this,e)})),Wa(this.mergedCells.length-1,0,(e=>{const t=this.mergedCells[e];t&&t.removed&&(this.mergedCells.splice(this.mergedCells.indexOf(t),1),oN(aN,this,uN).call(this,t))}))}}function lN(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;const n=new Map,i=1===r?e.getTopStartCorner():e.getBottomEndCorner(),o=1===r?e.getBottomEndCorner():e.getTopStartCorner();for(let a=i.row;1===r?a<=o.row:a>=o.row;a+=r)for(let e=i.col;1===r?e<=o.col:e>=o.col;e+=r){const i="row"===t?a:e,o=this.get(a,e);let s=i;o&&(s=1===r?o[t]+o[`${t}span`]-1:o[t]),n.has(i)||n.set(i,new Set),n.get(i).add(s)}return Array.from(new Set(Array.from(n.entries()).filter((e=>{let[,t]=e;return 1===t.size})).flatMap((e=>{let[,t]=e;return Array.from(t)}))))}function cN(e){for(let t=e.row;t<e.row+e.rowspan;t++)for(let r=e.col;r<e.col+e.colspan;r++)this.mergedCellsMatrix.has(t)||this.mergedCellsMatrix.set(t,new Map),this.mergedCellsMatrix.get(t).set(r,e)}function uN(e){for(let t=e.row;t<e.row+e.rowspan;t++)for(let r=e.col;r<e.col+e.colspan;r++)this.mergedCellsMatrix.get(t).delete(r)}const hN=sN;function dN(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const fN=class{constructor(e){dN(this,"plugin",void 0),dN(this,"mergedCellsCollection",void 0),dN(this,"currentFillData",null),this.plugin=e,this.mergedCellsCollection=this.plugin.mergedCellsCollection}correctSelectionAreaSize(e){if(e[0]===e[2]&&e[1]===e[3]){const t=this.mergedCellsCollection.get(e[0],e[1]);t&&(e[2]=e[0]+t.rowspan-1,e[3]=e[1]+t.colspan-1)}}getDirection(e,t){let r=null;return r=t[0]===e[0]&&t[1]===e[1]&&t[3]===e[3]?"down":t[2]===e[2]&&t[1]===e[1]&&t[3]===e[3]?"up":t[1]===e[1]&&t[2]===e[2]?"right":"left",r}snapDragArea(e,t,r,n){const i=t.slice(0),o=this.getAutofillSize(e,t,r),[a,s,l,c]=e,u=["up","down"].indexOf(r)>-1?l-a+1:c-s+1,h=o-Math.floor(o/u)*u,d=this.getFarthestCollection(e,t,r,n);if(d)if("down"===r){const e=d.row+d.rowspan-a-h;i[2]+e>=this.plugin.hot.countRows()?i[2]-=h:i[2]+=h?e:0}else if("right"===r){const e=d.col+d.colspan-s-h;i[3]+e>=this.plugin.hot.countCols()?i[3]-=h:i[3]+=h?e:0}else if("up"===r){const e=l-h-d.row+1;i[0]+e<0?i[0]+=h:i[0]-=h?e:0}else if("left"===r){const e=c-h-d.col+1;i[1]+e<0?i[1]+=h:i[1]-=h?e:0}return this.updateCurrentFillCache({baseArea:e,dragDirection:r,foundMergedCells:n,fillSize:o,dragArea:i,cycleLength:u}),i}updateCurrentFillCache(e){this.currentFillData||(this.currentFillData={}),to(this.currentFillData,e)}getAutofillSize(e,t,r){const[n,i,o,a]=e,[s,l,c,u]=t;switch(r){case"up":return n-s;case"down":return c-o;case"left":return i-l;case"right":return u-a;default:return null}}getDragArea(e,t,r){const[n,i,o,a]=e,[s,l,c,u]=t;switch(r){case"up":return[s,l,n-1,a];case"down":return[o+1,i,c,a];case"left":return[s,l,o,i-1];case"right":return[n,a+1,c,u];default:return null}}getFarthestCollection(e,t,r,n){const[i,o,a,s]=e,l=["up","down"].indexOf(r)>-1,c=l?a:s,u=l?i:o,h=this.getAutofillSize(e,t,r),d=l?a-i+1:s-o+1,f=h-Math.floor(h/d)*d;let g=null,p=null,m=null;switch(r){case"up":g="includesVertically",m=c-f+1;break;case"left":g="includesHorizontally",m=c-f+1;break;case"down":g="includesVertically",m=u+f-1;break;case"right":g="includesHorizontally",m=u+f-1}return Ai(n,(e=>{e[g](m)&&e.isFarther(p,r)&&(p=e)})),p}recreateAfterDataPopulation(e){if(!this.currentFillData)return;const t=this.getRangeFromChanges(e),r=this.currentFillData.foundMergedCells,n=this.currentFillData.dragDirection,i=(e,r)=>{switch(n){case"up":return e.row-r>=t.from.row;case"down":return e.row+e.rowspan-1+r<=t.to.row;case"left":return e.col-r>=t.from.column;case"right":return e.col+e.colspan-1+r<=t.to.column;default:return null}};let o=0,a=null,s=1;do{for(let e=0;e<r.length;e+=1){if(a=r[e],o=s*this.currentFillData.cycleLength,i(a,o))switch(n){case"up":this.plugin.mergedCellsCollection.add({row:a.row-o,rowspan:a.rowspan,col:a.col,colspan:a.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:a.row+o,rowspan:a.rowspan,col:a.col,colspan:a.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col-o,colspan:a.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col+o,colspan:a.colspan})}e===r.length-1&&(s+=1)}}while(i(a,o));this.currentFillData=null,this.plugin.hot.render(),r.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(e){const t={min:null,max:null},r={min:null,max:null};return Ai(e,(e=>{const n=e[0],i=this.plugin.hot.propToCol(e[1]);(null===t.min||n<t.min)&&(t.min=n),(null===t.max||n>t.max)&&(t.max=n),(null===r.min||i<r.min)&&(r.min=i),(null===r.max||i>r.max)&&(r.max=i)})),{from:{row:t.min,column:r.min},to:{row:t.max,column:r.max}}}dragAreaOverlapsCollections(e,t,r){const n=this.getDragArea(e,t,r),[i,o,a,s]=n,l=this.plugin.hot._createCellCoords(i,o),c=this.plugin.hot._createCellCoords(a,s),u=this.plugin.hot._createCellRange(l,l,c);return this.mergedCellsCollection.getWithinRange(u,!0).length>0}};function gN(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const pN=class{constructor(e){gN(this,"plugin",void 0),gN(this,"hot",void 0),gN(this,"fullySelectedMergedCellClassName","fullySelectedMergedCell"),this.plugin=e,this.hot=e.hot}getSelectedMergedCellClassName(e,t,r,n){const i=Math.min(r[0],r[2]),o=Math.min(r[1],r[3]),a=Math.max(r[0],r[2]),s=Math.max(r[1],r[3]);if(void 0===n)return;if(!this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(e,t))return;const l=this.plugin.mergedCellsCollection.get(e,t);if(!l)return;const c=l.getLastRow(),u=l.getLastColumn();return i<=l.row&&o<=l.col&&a>=c&&s>=u?`${this.fullySelectedMergedCellClassName}-${n}`:this.isMergeCellFullySelected(l,this.plugin.hot.getSelectedRange())?`${this.fullySelectedMergedCellClassName}-multiple`:void 0}isMergeCellFullySelected(e,t){const r=[];if(!t||!e)return!1;for(let n=0;n<e.rowspan;n+=1)for(let t=0;t<e.colspan;t+=1)r.push(this.hot._createCellCoords(e.row+n,e.col+t));for(let n=0;n<r.length;n+=1){const e=[];for(let i=0;i<t.length;i+=1)e[i]=t[i].includes(r[n]);if(!e.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){const e=[];for(let t=0;t<=7;t+=1)e.push(`${this.fullySelectedMergedCellClassName}-${t}`);return e.push(`${this.fullySelectedMergedCellClassName}-multiple`),e}};function mN(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class vN{constructor(e){mN(this,"data",void 0),mN(this,"next",null),mN(this,"prev",null),this.data=e}}const bN=class{constructor(){mN(this,"first",null),mN(this,"last",null)}push(e){const t=new vN(e);if(null===this.first)this.first=t,this.last=t;else{const e=this.last;this.last=t,t.prev=e,e.next=t}return t}unshift(e){const t=new vN(e);if(null===this.first)this.first=t,this.last=t;else{const e=this.first;this.first=t,t.next=e,e.prev=t}}inorder(e){let t=this.first;for(;t;){const r=e(t);if(t===this.last||!0===r)break;t=t.next}}remove(e){if(null===this.first)return!1;let t,r,n=this.first;for(;n;){if(n.data===e)return t=n.next,r=n.prev,t&&(t.prev=r),r&&(r.next=t),n===this.first&&(this.first=t),n===this.last&&(this.last=r),!0;n=n.next}return!1}hasCycle(){let e=this.first,t=this.first;for(;;){if(null===e)return!1;if(e=e.next,null===e)return!1;if(e=e.next,t=t.next,e===t)return!0}}pop(){if(null===this.last)return null;const e=this.last;return this.last=this.last.prev,e}shift(){if(null===this.first)return null;const e=this.first;return this.first=this.first.next,e}recursiveReverse(){if(!this.first)return;!function e(t,r){r&&(e(r,r.next),r.next=t)}(this.first,this.first.next),this.first.next=null;const e=this.first;this.first=this.last,this.last=e}reverse(){if(!this.first||!this.first.next)return;let e,t=this.first.next,r=this.first;for(;t;)e=t.next,t.next=r,r.prev=t,r=t,t=e;this.first.next=null,this.last.prev=null,e=this.first,this.first=r,this.last=e}};function yN(e,t,r){wN(e,t),t.set(e,r)}function wN(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function SN(e,t){return e.get(kN(e,t))}function CN(e,t,r){return e.set(kN(e,t),r),r}function kN(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var xN=new WeakMap,EN=new WeakMap,TN=new WeakMap,_N=new WeakMap,AN=new WeakMap,RN=new WeakMap,ON=new WeakMap,MN=new WeakSet;class IN{constructor(e){let{mergedCellsGetter:t,rowIndexMapper:r,columnIndexMapper:n}=e;!function(e,t){wN(e,t),t.add(e)}(this,MN),yN(this,xN,new bN),yN(this,EN,new bN),yN(this,TN,null),yN(this,_N,null),yN(this,AN,null),yN(this,RN,null),yN(this,ON,null),CN(AN,this,t),CN(RN,this,r),CN(ON,this,n)}getCurrentVerticalNode(){return SN(_N,this).data}getFirstVerticalNode(){return SN(EN,this).first.data}getNextVerticalNode(){return SN(_N,this).next.data}getPrevVerticalNode(){return SN(_N,this).prev.data}getCurrentHorizontalNode(){return SN(TN,this).data}getFirstHorizontalNode(){return SN(xN,this).first.data}getNextHorizontalNode(){return SN(TN,this).next.data}getPrevHorizontalNode(){return SN(TN,this).prev.data}setPrevNodeAsActive(){CN(_N,this,SN(_N,this).prev),CN(TN,this,SN(TN,this).prev)}setNextNodeAsActive(){CN(_N,this,SN(_N,this).next),CN(TN,this,SN(TN,this).next)}buildFocusOrder(e){const t=e.getTopStartCorner(),r=e.getBottomEndCorner(),n=new WeakSet;CN(xN,this,new bN);for(let o=t.row;o<=r.row;o++)if(!SN(RN,this).isHidden(o))for(let i=t.col;i<=r.col;i++){if(SN(ON,this).isHidden(i))continue;const t=kN(MN,this,PN).call(this,e,SN(xN,this),n,o,i);t&&CN(TN,this,t)}SN(xN,this).first&&(SN(xN,this).first.prev=SN(xN,this).last,SN(xN,this).last.next=SN(xN,this).first);const i=new WeakSet;CN(EN,this,new bN);for(let o=t.col;o<=r.col;o++)if(!SN(ON,this).isHidden(o))for(let n=t.row;n<=r.row;n++){if(SN(RN,this).isHidden(n))continue;const t=kN(MN,this,PN).call(this,e,SN(EN,this),i,n,o);t&&CN(_N,this,t)}SN(EN,this).first&&(SN(EN,this).first.prev=SN(EN,this).last,SN(EN,this).last.next=SN(EN,this).first)}setActiveNode(e,t){return SN(xN,this).inorder((r=>{const{rowStart:n,rowEnd:i,colStart:o,colEnd:a}=r.data;if(e>=n&&e<=i&&t>=o&&t<=a)return CN(TN,this,r),!1})),SN(EN,this).inorder((r=>{const{rowStart:n,rowEnd:i,colStart:o,colEnd:a}=r.data;if(e>=n&&e<=i&&t>=o&&t<=a)return CN(_N,this,r),!1})),this}}function PN(e,t,r,n,i){const o=e.getTopStartCorner(),a=e.getBottomEndCorner(),s=e.highlight.clone().normalize(),l=SN(AN,this).call(this,n,i);if(l&&r.has(l))return null;const c={colStart:i,colEnd:i,rowStart:n,rowEnd:n};if(l){if(r.add(l),l.row<o.row||l.row+l.rowspan-1>a.row||l.col<o.col||l.col+l.colspan-1>a.col)return null;c.colStart=l.col,c.colEnd=l.col+l.colspan-1,c.rowStart=l.row,c.rowEnd=l.row+l.rowspan-1}const u=t.push(c);return n===s.row&&i===s.col||l&&s.row>=l.row&&s.row<=l.row+l.rowspan-1&&s.col>=l.col&&s.col<=l.col+l.colspan-1?u:null}function NN(e,t,r){DN(e,t),t.set(e,r)}function DN(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function FN(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function LN(e,t,r){return e.set(BN(e,t),r),r}function HN(e,t){return e.get(BN(e,t))}function BN(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}Ko.getSingleton().register("beforeMergeCells"),Ko.getSingleton().register("afterMergeCells"),Ko.getSingleton().register("beforeUnmergeCells"),Ko.getSingleton().register("afterUnmergeCells");const UN="mergeCells",jN=UN;var WN=new WeakMap,VN=new WeakMap,zN=new WeakMap,qN=new WeakMap,GN=new WeakSet;class $N extends Fy{constructor(){super(...arguments),function(e,t){DN(e,t),t.add(e)}(this,GN),FN(this,"mergedCellsCollection",null),FN(this,"autofillCalculations",null),FN(this,"selectionCalculations",null),NN(this,WN,null),NN(this,VN,{row:0,col:0}),NN(this,zN,new IN({mergedCellsGetter:(e,t)=>this.mergedCellsCollection.get(e,t),rowIndexMapper:this.hot.rowIndexMapper,columnIndexMapper:this.hot.columnIndexMapper})),NN(this,qN,function(e){const{hot:t}=e,{rowIndexMapper:r,columnIndexMapper:n}=t;return{before:function(){},after:function(t,i,o){const a=e.mergedCellsCollection.get(i,o);if(!so(a))return t.removeAttribute("rowspan"),t.removeAttribute("colspan"),void(t.style.display="");const{row:s,col:l,colspan:c,rowspan:u}=a,[h,d]=e.translateMergedCellToRenderable(s,u,l,c),f=h-r.getRenderableFromVisualIndex(i)+1,g=d-n.getRenderableFromVisualIndex(o)+1,p=r.getNearestNotHiddenIndex(s,1),m=n.getNearestNotHiddenIndex(l,1),v=Math.min(u,f),b=Math.min(c,g);p===i&&m===o?(t.setAttribute("rowspan",v),t.setAttribute("colspan",b)):(t.removeAttribute("rowspan"),t.removeAttribute("colspan"),t.style.display="none")}}}(this))}static get PLUGIN_KEY(){return UN}static get PLUGIN_PRIORITY(){return 150}isEnabled(){return!!this.hot.getSettings()[UN]}enablePlugin(){var e=this;this.enabled||(this.mergedCellsCollection=new hN(this),this.autofillCalculations=new fN(this),this.selectionCalculations=new pN(this),this.addHook("afterInit",(function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return BN(GN,e,KN).call(e,...r)})),this.addHook("modifyTransformFocus",(function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return BN(GN,e,XN).call(e,...r)})),this.addHook("modifyTransformStart",(function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return BN(GN,e,JN).call(e,...r)})),this.addHook("modifyTransformEnd",(function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return BN(GN,e,ZN).call(e,...r)})),this.addHook("beforeSelectionHighlightSet",(function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return BN(GN,e,QN).call(e,...r)})),this.addHook("beforeSetRangeStart",(function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return BN(GN,e,rD).call(e,...r)})),this.addHook("beforeSetRangeStartOnly",(function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return BN(GN,e,rD).call(e,...r)})),this.addHook("beforeSelectionFocusSet",(function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return BN(GN,e,nD).call(e,...r)})),this.addHook("afterSelectionFocusSet",(function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return BN(GN,e,iD).call(e,...r)})),this.addHook("afterSelectionEnd",(function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return BN(GN,e,oD).call(e,...r)})),this.addHook("modifyGetCellCoords",(function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return BN(GN,e,eD).call(e,...r)})),this.addHook("afterIsMultipleSelection",(function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return BN(GN,e,YN).call(e,...r)})),this.addHook("afterRenderer",(function(){return HN(qN,e).after(...arguments)})),this.addHook("afterContextMenuDefaultOptions",(function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return BN(GN,e,tD).call(e,...r)})),this.addHook("afterGetCellMeta",(function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return BN(GN,e,aD).call(e,...r)})),this.addHook("afterViewportRowCalculatorOverride",(function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return BN(GN,e,sD).call(e,...r)})),this.addHook("afterViewportColumnCalculatorOverride",(function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return BN(GN,e,lD).call(e,...r)})),this.addHook("modifyAutofillRange",(function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return BN(GN,e,cD).call(e,...r)})),this.addHook("afterCreateCol",(function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return BN(GN,e,uD).call(e,...r)})),this.addHook("afterRemoveCol",(function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return BN(GN,e,hD).call(e,...r)})),this.addHook("afterCreateRow",(function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return BN(GN,e,dD).call(e,...r)})),this.addHook("afterRemoveRow",(function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return BN(GN,e,fD).call(e,...r)})),this.addHook("afterChange",(function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return BN(GN,e,gD).call(e,...r)})),this.addHook("beforeDrawBorders",(function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return BN(GN,e,pD).call(e,...r)})),this.addHook("afterDrawSelection",(function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return BN(GN,e,mD).call(e,...r)})),this.addHook("beforeRemoveCellClassNames",(function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return BN(GN,e,vD).call(e,...r)})),this.addHook("beforeBeginEditing",(function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return BN(GN,e,bD).call(e,...r)})),this.addHook("modifyRowHeightByOverlayName",(function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return BN(GN,e,yD).call(e,...r)})),this.addHook("beforeUndoStackChange",((e,t)=>{if("MergeCells"===t)return!1})),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){const e=this.hot.getSettings()[UN];this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(e),super.updatePlugin()}ifChromeForceRepaint(){if(!Co())return;const e=[];let t=[];this.mergedCellsCollection.mergedCells.forEach((e=>{const{row:r,rowspan:n}=e;for(let i=r+1;i<r+n;i++)t.push(i)})),t=[...new Set(t)],t.forEach((t=>{const r=this.hot.rowIndexMapper.getRenderableFromVisualIndex(t);this.hot.view._wt.wtOverlays.getOverlays(!0).map((e=>"master"===(null===e||void 0===e?void 0:e.name)?e:e.clone.wtTable)).forEach((t=>{const n=t.getRow(r);n&&(n.style.background=ii(n,"backgroundColor").replace(")",", 0.99)"),e.push(n))}))})),this.hot._registerTimeout((()=>{e.forEach((e=>{e.style.background=ii(e,"backgroundColor").replace(", 0.99)",")")}))}),1)}validateSetting(e){return!!e&&(rN.containsNegativeValues(e)?(Ho(rN.NEGATIVE_VALUES_WARNING(e)),!1):rN.isOutOfBounds(e,this.hot.countRows(),this.hot.countCols())?(Ho(rN.IS_OUT_OF_BOUNDS_WARNING(e)),!1):rN.isSingleCell(e)?(Ho(rN.IS_SINGLE_CELL(e)),!1):!rN.containsZeroSpan(e)||(Ho(rN.ZERO_SPAN_WARNING(e)),!1))}generateFromSettings(e){if(!Array.isArray(e))return;const t=e.filter((e=>this.validateSetting(e))),r=this.mergedCellsCollection.filterOverlappingMergeCells(t),n=[];r.forEach((e=>{const{row:t,col:r,rowspan:i,colspan:o}=e,a=this.hot._createCellCoords(t,r),s=this.hot._createCellCoords(t+i-1,r+o-1),l=this.hot._createCellRange(a,a,s);this.mergeRange(l,!0,!0);for(let c=t;c<t+i;c++)for(let e=r;e<r+o;e++)c===t&&e===r||n.push([c,e,null])})),0!==n.length&&this.hot.setDataAtCell(n,void 0,void 0,this.pluginName)}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(e){return!!(arguments.length>1&&void 0!==arguments[1]&&arguments[1])||this.validateSetting(e)}mergeSelection(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:t,to:r}=e;this.unmergeRange(e,!0),this.mergeRange(e),this.hot.selectCell(t.row,t.col,r.row,r.col,!1)}unmergeSelection(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;const{from:t,to:r}=e;this.unmergeRange(e,!0),this.hot.selectCell(t.row,t.col,r.row,r.col,!1)}mergeRange(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n=e.getTopStartCorner(),i=e.getBottomEndCorner(),o={row:n.row,col:n.col,rowspan:i.row-n.row+1,colspan:i.col-n.col+1},a=[];let s=null;if(!this.canMergeRange(o,t))return!1;this.hot.runHooks("beforeMergeCells",e,t),ja(0,o.rowspan-1,(e=>{ja(0,o.colspan-1,(t=>{let r=null;a[e]||(a[e]=[]),0===e&&0===t?r=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(o.row),this.hot.toPhysicalColumn(o.col)):this.hot.setCellMeta(o.row+e,o.col+t,"hidden",!0),a[e][t]=r}))})),this.hot.setCellMeta(o.row,o.col,"spanned",!0);return!this.mergedCellsCollection.add(o,t)||(r?s=[o.row,o.col,a]:this.hot.populateFromArray(o.row,o.col,a,void 0,void 0,this.pluginName),t||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",e,o,t),s)}unmergeRange(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const r=this.mergedCellsCollection.getWithinRange(e);0!==r.length&&(this.hot.runHooks("beforeUnmergeCells",e,t),Ai(r,(e=>{this.mergedCellsCollection.remove(e.row,e.col),ja(0,e.rowspan-1,(t=>{ja(0,e.colspan-1,(r=>{this.hot.removeCellMeta(e.row+t,e.col+r,"hidden"),this.hot.removeCellMeta(e.row+t,e.col+r,"copyable")}))})),this.hot.removeCellMeta(e.row,e.col,"spanned")})),this.hot.runHooks("afterUnmergeCells",e,t),this.hot.render())}toggleMerge(e){const t=this.mergedCellsCollection.get(e.from.row,e.from.col);t.row===e.from.row&&t.col===e.from.col&&t.row+t.rowspan-1===e.to.row&&t.col+t.colspan-1===e.to.col?this.unmergeRange(e):this.mergeSelection(e)}merge(e,t,r,n){const i=this.hot._createCellCoords(e,t),o=this.hot._createCellCoords(r,n);this.mergeRange(this.hot._createCellRange(i,i,o))}unmerge(e,t,r,n){const i=this.hot._createCellCoords(e,t),o=this.hot._createCellCoords(r,n);this.unmergeRange(this.hot._createCellRange(i,i,o))}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control","m"]],callback:()=>{const e=this.hot.getSelectedRangeLast();e&&!e.isSingleHeader()&&(this.toggleMerge(e),this.hot.render())},runOnlyIf:e=>!e.altKey,group:jN})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(jN)}modifyViewportRowStart(e,t){const r=this.hot.rowIndexMapper,n=r.getVisualFromRenderableIndex(e.startRow);for(let i=0;i<t;i+=1){const o=this.mergedCellsCollection.get(n,i);if(so(o)){const n=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(o.row,1));if(n<e.startRow)return e.startRow=n,void this.modifyViewportRowStart(e,t)}}}modifyViewportRowEnd(e,t){const r=this.hot.rowIndexMapper,n=r.getVisualFromRenderableIndex(e.endRow);for(let i=0;i<t;i+=1){const o=this.mergedCellsCollection.get(n,i);if(so(o)){const n=o.row+o.rowspan-1,i=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(n,-1));if(i>e.endRow)return e.endRow=i,void this.modifyViewportRowEnd(e,t)}}}modifyViewportColumnStart(e,t){const r=this.hot.columnIndexMapper,n=r.getVisualFromRenderableIndex(e.startColumn);for(let i=0;i<t;i+=1){const o=this.mergedCellsCollection.get(i,n);if(so(o)){const n=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(o.col,1));if(n<e.startColumn)return e.startColumn=n,void this.modifyViewportColumnStart(e,t)}}}modifyViewportColumnEnd(e,t){const r=this.hot.columnIndexMapper,n=r.getVisualFromRenderableIndex(e.endColumn);for(let i=0;i<t;i+=1){const o=this.mergedCellsCollection.get(i,n);if(so(o)){const n=o.col+o.colspan-1,i=r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(n,-1));if(i>e.endColumn)return e.endColumn=i,void this.modifyViewportColumnEnd(e,t)}}}translateMergedCellToRenderable(e,t,r,n){const{rowIndexMapper:i,columnIndexMapper:o}=this.hot;let a,s;a=0===t?i.getNearestNotHiddenIndex(e,1):i.getNearestNotHiddenIndex(e+t-1,-1),s=0===n?o.getNearestNotHiddenIndex(r,1):o.getNearestNotHiddenIndex(r+n-1,-1);return[e>=0?i.getRenderableFromVisualIndex(a):e,r>=0?o.getRenderableFromVisualIndex(s):r]}}function KN(){this.generateFromSettings(this.hot.getSettings()[UN]),this.hot.render()}function YN(e){if(e){const e=this.mergedCellsCollection.mergedCells,t=this.hot.getSelectedRangeLast(),r=t.getTopStartCorner(),n=t.getBottomEndCorner();for(let i=0;i<e.length;i+=1)if(r.row===e[i].row&&r.col===e[i].col&&n.row===e[i].row+e[i].rowspan-1&&n.col===e[i].col+e[i].colspan-1)return!1}return e}function XN(e){HN(VN,this).row=e.row,HN(VN,this).col=e.col}function JN(e){const t=this.hot.getSelectedRangeLast(),{highlight:r}=t,{columnIndexMapper:n,rowIndexMapper:i}=this.hot;HN(WN,this)&&(null!==i.getRenderableFromVisualIndex(HN(WN,this).row)&&(r.row=HN(WN,this).row),null!==n.getRenderableFromVisualIndex(HN(WN,this).col)&&(r.col=HN(WN,this).col),LN(WN,this,null));const o=this.mergedCellsCollection.get(r.row,r.col);if(!o)return;const a=o.col,s=o.col+o.colspan-1;if(e.col<0){const t=r.col>=a&&r.col<=s?a-1:s,i=n.getNearestNotHiddenIndex(t,-1);e.col=null===i?-this.hot.view.countRenderableColumnsInRange(0,r.col):-Math.max(this.hot.view.countRenderableColumnsInRange(i,r.col)-1,1)}else if(e.col>0){const t=r.col>=a&&r.col<=s?s+1:a,i=n.getNearestNotHiddenIndex(t,1);e.col=null===i?this.hot.view.countRenderableColumnsInRange(r.col,this.hot.countCols()):Math.max(this.hot.view.countRenderableColumnsInRange(r.col,i)-1,1)}const l=o.row,c=o.row+o.rowspan-1;if(e.row<0){const t=r.row>=l&&r.row<=c?l-1:c,n=i.getNearestNotHiddenIndex(t,-1);e.row=null===n?-this.hot.view.countRenderableRowsInRange(0,r.row):-Math.max(this.hot.view.countRenderableRowsInRange(n,r.row)-1,1)}else if(e.row>0){const t=r.row>=l&&r.row<=c?c+1:l,n=i.getNearestNotHiddenIndex(t,1);e.row=null===n?this.hot.view.countRenderableRowsInRange(r.row,this.hot.countRows()):Math.max(this.hot.view.countRenderableRowsInRange(r.row,n)-1,1)}}function ZN(e){const t=this.hot.getSelectedRangeLast(),r=t.clone(),{to:n}=t,{columnIndexMapper:i,rowIndexMapper:o}=this.hot,a=(e,t)=>{r.expand(this.hot._createCellCoords(e,t));for(let n=0;n<this.mergedCellsCollection.mergedCells.length;n+=1)r.expandByRange(this.mergedCellsCollection.mergedCells[n].getRange())};if(e.col<0){let o=this.mergedCellsCollection.getStartMostColumnIndex(t,n.col)+e.col;a(n.row,o),"E-W"===t.getHorizontalDirection()&&"E-W"===r.getHorizontalDirection()&&(o=r.getTopStartCorner().col);const s=i.getNearestNotHiddenIndex(o,1);null!==s&&(e.col=-Math.max(this.hot.view.countRenderableColumnsInRange(s,n.col)-1,1))}else if(e.col>0){let o=this.mergedCellsCollection.getEndMostColumnIndex(t,n.col)+e.col;a(n.row,o),"W-E"===t.getHorizontalDirection()&&"W-E"===r.getHorizontalDirection()&&(o=r.getBottomEndCorner().col);const s=i.getNearestNotHiddenIndex(o,-1);null!==s&&(e.col=Math.max(this.hot.view.countRenderableColumnsInRange(n.col,s)-1,1))}if(e.row<0){let i=this.mergedCellsCollection.getTopMostRowIndex(t,n.row)+e.row;a(i,n.col),"S-N"===t.getVerticalDirection()&&"S-N"===r.getVerticalDirection()&&(i=r.getTopStartCorner().row);const s=o.getNearestNotHiddenIndex(i,1);null!==s&&(e.row=-Math.max(this.hot.view.countRenderableRowsInRange(s,n.row)-1,1))}else if(e.row>0){let i=this.mergedCellsCollection.getBottomMostRowIndex(t,n.row)+e.row;a(i,n.col),"N-S"===t.getVerticalDirection()&&"N-S"===r.getVerticalDirection()&&(i=r.getBottomStartCorner().row);const s=o.getNearestNotHiddenIndex(i,-1);null!==s&&(e.row=Math.max(this.hot.view.countRenderableRowsInRange(n.row,s)-1,1))}}function QN(){const e=this.hot.getSelectedRangeLast(),{highlight:t}=e;if(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader())return void LN(WN,this,t.clone());for(let n=0;n<this.mergedCellsCollection.mergedCells.length;n+=1)e.expandByRange(this.mergedCellsCollection.mergedCells[n].getRange(),!1);for(let n=0;n<this.mergedCellsCollection.mergedCells.length;n+=1)e.expandByRange(this.mergedCellsCollection.mergedCells[n].getRange(),!1);const r=this.mergedCellsCollection.get(t.row,t.col);LN(WN,this,t.clone()),r&&t.assign(r)}function eD(e,t){if(e<0||t<0)return;const r=this.mergedCellsCollection.get(e,t);if(!r)return;const{row:n,col:i,colspan:o,rowspan:a}=r;return[n,i,n+a-1,i+o-1]}function tD(e){var t;e.items.push({name:"---------"},(t=this,{key:"mergeCells",name(){const e=this.getSelectedLast();if(e){const r=t.mergedCellsCollection.get(e[0],e[1]);if(r.row===e[0]&&r.col===e[1]&&r.row+r.rowspan-1===e[2]&&r.col+r.colspan-1===e[3])return this.getTranslatedPhrase(Ad)}return this.getTranslatedPhrase(_d)},callback(){const e=this.getSelectedRangeLast();if(!e)return;e.setDirection(this.isRtl()?"NE-SW":"NW-SE");const{from:r,to:n}=e;t.toggleMerge(e),this.selectCell(r.row,r.col,n.row,n.col,!1)},disabled(){const e=this.getSelectedLast();return!e||rN.isSingleCell({row:e[0],col:e[1],rowspan:e[2]-e[0]+1,colspan:e[3]-e[1]+1})||this.selection.isSelectedByCorner()},hidden:!1}))}function rD(){LN(WN,this,null)}function nD(){if(HN(WN,this).isCell())return;const e=this.hot.getSelectedRangeLast(),t=e.getVerticalDirection(),r=e.getHorizontalDirection(),n=HN(WN,this).clone().normalize();HN(zN,this).setActiveNode(n.row,n.col),HN(VN,this).row>0||HN(VN,this).col>0?HN(zN,this).setPrevNodeAsActive():("E-W"===r&&HN(VN,this).col<0||"S-N"===t&&HN(VN,this).row<0)&&HN(zN,this).setNextNodeAsActive()}function iD(e,t){const r=this.hot.getSelectedRangeLast(),{columnIndexMapper:n,rowIndexMapper:i}=this.hot;let o=null,a=null;if(HN(VN,this).col<0){const{rowEnd:e,colEnd:t}=HN(zN,this).getPrevHorizontalNode();a=n.getNearestNotHiddenIndex(t,-1),o=i.getNearestNotHiddenIndex(e,-1)}else if(HN(VN,this).col>0){const{rowStart:e,colStart:t}=HN(zN,this).getNextHorizontalNode();a=n.getNearestNotHiddenIndex(t,1),o=i.getNearestNotHiddenIndex(e,1)}else if(HN(VN,this).row<0){const{rowEnd:e,colEnd:t}=HN(zN,this).getPrevVerticalNode();a=n.getNearestNotHiddenIndex(t,-1),o=i.getNearestNotHiddenIndex(e,-1)}else if(HN(VN,this).row>0){const{rowStart:e,colStart:t}=HN(zN,this).getNextVerticalNode();a=n.getNearestNotHiddenIndex(t,1),o=i.getNearestNotHiddenIndex(e,1)}if(null!==o||null!==a){const n=this.hot._createCellCoords(o,a),i=this.mergedCellsCollection.get(n.row,n.col),s=this.hot.selection.highlight.getFocus();e=n.row,t=n.col,i?r.highlight.assign({row:this.hot.rowIndexMapper.getNearestNotHiddenIndex(i.row,1),col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(i.col,1)}):r.highlight.assign(n),s.clear(),s.add(n).commit()}HN(zN,this).setActiveNode(e,t),LN(VN,this,{row:0,col:0})}function oD(){this.hot.getSelectedRangeLast().isHeader()||HN(zN,this).buildFocusOrder(this.hot.getSelectedRangeLast())}function aD(e,t,r){const n=this.mergedCellsCollection.get(e,t);n&&(n.row!==e||n.col!==t?r.copyable=!1:(r.rowspan=n.rowspan,r.colspan=n.colspan))}function sD(e){const t=this.hot.countCols();this.modifyViewportRowStart(e,t),this.modifyViewportRowEnd(e,t)}function lD(e){const t=this.hot.countRows();this.modifyViewportColumnStart(e,t),this.modifyViewportColumnEnd(e,t)}function cD(e,t){this.autofillCalculations.correctSelectionAreaSize(t);const r=this.autofillCalculations.getDirection(t,e);let n=e;if(this.autofillCalculations.dragAreaOverlapsCollections(t,n,r))return n=t,n;const i=this.hot._createCellCoords(t[0],t[1]),o=this.hot._createCellCoords(t[2],t[3]),a=this.hot._createCellRange(i,i,o),s=this.mergedCellsCollection.getWithinRange(a);return 0===s.length||(n=this.autofillCalculations.snapDragArea(t,n,r,s)),n}function uD(e,t){this.mergedCellsCollection.shiftCollections("right",e,t)}function hD(e,t){this.mergedCellsCollection.shiftCollections("left",e,t)}function dD(e,t,r){"auto"!==r&&this.mergedCellsCollection.shiftCollections("down",e,t)}function fD(e,t){this.mergedCellsCollection.shiftCollections("up",e,t)}function gD(e,t){"Autofill.fill"===t&&this.autofillCalculations.recreateAfterDataPopulation(e)}function pD(e,t){if(t&&"area"===t){const t=this.hot.getSelectedRangeLast();Ai(this.mergedCellsCollection.getWithinRange(t),(r=>{t.getBottomEndCorner().row===r.getLastRow()&&t.getBottomEndCorner().col===r.getLastColumn()&&(e[2]=r.row,e[3]=r.col)}))}}function mD(e,t,r,n){if(r)return this.selectionCalculations.getSelectedMergedCellClassName(e,t,r,n)}function vD(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}function bD(e,t,r,n){if(!(n instanceof MouseEvent))return;const i=this.hot.getSelectedRangeLast(),o=this.mergedCellsCollection.getByRange(i);if(!o)return;const a=this.hot._createCellCoords(o.row,o.col),s=this.hot._createCellCoords(o.row+o.rowspan-1,o.col+o.colspan-1);return 0===this.hot.selection.getLayerLevel()&&i.isEqual(this.hot._createCellRange(a,a,s))}function yD(e,t,r){if(this.hot.getSettings().rowHeaders||"bottom"===r||"bottom_inline_start_corner"===r)return e;let n,i;if("master"===r)n=this.hot.view.getFirstRenderedVisibleColumn(),i=this.hot.view.getLastRenderedVisibleColumn();else{const e=this.hot.view.getOverlayByName(r);n=this.hot.columnIndexMapper.getVisualFromRenderableIndex(e.clone.wtTable.getFirstRenderedColumn()),i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(e.clone.wtTable.getLastRenderedColumn())}if(!this.mergedCellsCollection.get(t,n))return e;const o=this.hot._createCellCoords(t,n),a=this.hot._createCellCoords(t,i),s=this.hot._createCellRange(o,o,a),l=this.mergedCellsCollection.getWithinRange(s),c=l.reduce(((e,t)=>{let{rowspan:r}=t;return Math.max(e,r)}),1);let u=0;return l.length>1&&l[0].rowspan<c&&(u=c-l[0].rowspan),l.forEach((n=>{var i;let{rowspan:o}=n,a=0;a="top"===r||"top_inline_start_corner"===r?Math.min(c,this.hot.view.countNotHiddenFixedRowsTop()-t):o-u,e=Math.max(null!==(i=e)&&void 0!==i?i:0,BN(GN,this,wD).call(this,t,a))})),e}function wD(e,t){const r=this.hot.view._wt.wtSettings.getSettingPure("defaultRowHeight"),n=this.hot.getPlugin("autoRowSize");let i=0;for(let a=e;a<e+t;a++){var o;if(!this.hot.rowIndexMapper.isHidden(a))i+=null!==(o=null===n||void 0===n?void 0:n.getRowHeight(a))&&void 0!==o?o:r}return i}function SD(){Ho(Ii`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously. 
    Only \`multiColumnSorting\` will work. The \`columnSorting\` plugin will be disabled.`)}const CD="sort";function kD(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const xD="multiColumnSorting",ED="columnSorting",TD=xD;SS(xD,(function(e,t){return function(r,n){const[,...i]=r,[,...o]=n;return function r(n){const a=e[n],s=t[n],l=i[n],c=o[n],u=s.multiColumnSorting,h=(u.compareFunctionFactory?u.compareFunctionFactory:kS(s.type))(a,s,u)(l,c);if(h===xS){const e=n+1;if("undefined"!==typeof t[e])return r(e)}return h}(0)}}));class _D extends $S{constructor(){super(...arguments),kD(this,"pluginKey",xD)}static get PLUGIN_KEY(){return xD}static get PLUGIN_PRIORITY(){return 170}isEnabled(){return super.isEnabled()}enablePlugin(){!this.enabled&&this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[ED]&&(SD(),this.hot.getPlugin(ED).disablePlugin()),super.enablePlugin()}disablePlugin(){super.disablePlugin()}registerShortcuts(){super.registerShortcuts(),this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Shift","Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();return-1===e.row&&e.col>=0&&this.sort(this.getNextSortConfig(e.col,zS)),!1},runOnlyIf:()=>{var e,t;const r=null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.highlight;return r&&(null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.isSingle())&&this.hot.selection.isCellVisible(r)&&r.isHeader()},relativeToGroup:zp,position:"before",group:TD})}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(TD)}sort(e){super.sort(e)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(e){return super.getSortConfig(e)}setSortConfig(e){super.setSortConfig(e)}getNormalizedSortConfigs(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Array.isArray(e)?e:[e]}updateHeaderClasses(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];super.updateHeaderClasses(e,...r),Wn(e,function(e){const t=e.className.split(" "),r=new RegExp(`^${CD}-[0-9]{1,2}$`);return t.filter((e=>r.test(e)))}(e)),!1!==this.enabled&&jn(e,function(e,t,r){const n=[];return!1===r||e.isColumnSorted(t)&&e.getNumberOfSortedColumns()>1&&n.push(`${CD}-${e.getIndexOfColumnInSortQueue(t)+1}`),n}(...r))}onUpdateSettings(e){this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[ED]&&SD(),super.onUpdateSettings(e)}onAfterOnCellMouseDown(e,t){!1!==NS(t.row,t.col,e)&&this.wasClickableHeaderClicked(e,t.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(t.col),this.sort(this.getNextSortConfig(t.col,zS))):this.sort(this.getColumnNextConfig(t.col)))}}function AD(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class RD extends Fy{constructor(){super(...arguments),AD(this,"dragged",[]),AD(this,"lastSetCell",null)}static get PLUGIN_KEY(){return"multipleSelectionHandles"}static get PLUGIN_PRIORITY(){return 160}isEnabled(){return Eo()}enablePlugin(){this.enabled||(this.registerListeners(),super.enablePlugin())}registerListeners(){const e=this,{rootElement:t}=this.hot;function r(t){if(1===e.dragged.length)return e.dragged.splice(0,e.dragged.length),!0;const r=e.dragged.indexOf(t);if(-1===r)return!1;0===r?e.dragged=e.dragged.slice(0,1):1===r&&(e.dragged=e.dragged.slice(-1))}this.eventManager.addEventListener(t,"touchstart",(t=>{let r;return Un(t.target,"topSelectionHandle-HitArea")?(r=e.hot.getSelectedRangeLast(),e.dragged.push("top"),e.touchStartRange={width:r.getWidth(),height:r.getHeight(),direction:r.getDirection()},t.preventDefault(),!1):Un(t.target,"bottomSelectionHandle-HitArea")?(r=e.hot.getSelectedRangeLast(),e.dragged.push("bottom"),e.touchStartRange={width:r.getWidth(),height:r.getHeight(),direction:r.getDirection()},t.preventDefault(),!1):void 0})),this.eventManager.addEventListener(t,"touchend",(t=>Un(t.target,"topSelectionHandle-HitArea")?(r.call(e,"top"),e.touchStartRange=void 0,t.preventDefault(),!1):Un(t.target,"bottomSelectionHandle-HitArea")?(r.call(e,"bottom"),e.touchStartRange=void 0,t.preventDefault(),!1):void 0)),this.eventManager.addEventListener(t,"touchmove",(t=>{const{rootDocument:r}=this.hot;let n,i,o,a,s,l;if(0===e.dragged.length)return;const c=r.elementFromPoint(t.touches[0].clientX,t.touches[0].clientY);c&&c!==e.lastSetCell&&("TD"!==c.nodeName&&"TH"!==c.nodeName||(n=e.hot.getCoords(c),-1===n.col&&(n.col=0),i=e.hot.getSelectedRangeLast(),o=i.getWidth(),a=i.getHeight(),s=i.getDirection(),1===o&&1===a&&e.hot.selection.setRangeEnd(n),l=e.getCurrentRangeCoords(i,n,e.touchStartRange.direction,s,e.dragged[0]),null!==l.start&&e.hot.selection.setRangeStart(l.start),e.hot.selection.setRangeEnd(l.end),e.lastSetCell=c),t.preventDefault())}))}getCurrentRangeCoords(e,t,r,n,i){const o=e.getTopStartCorner(),a=e.getBottomEndCorner(),s=e.getBottomStartCorner(),l=e.getTopEndCorner();let c={start:null,end:null};switch(r){case"NE-SW":switch(n){case"NE-SW":case"NW-SE":c="top"===i?{start:this.hot._createCellCoords(t.row,e.highlight.col),end:this.hot._createCellCoords(s.row,t.col)}:{start:this.hot._createCellCoords(e.highlight.row,t.col),end:this.hot._createCellCoords(t.row,o.col)};break;case"SE-NW":"bottom"===i&&(c={start:this.hot._createCellCoords(a.row,t.col),end:this.hot._createCellCoords(t.row,o.col)})}break;case"NW-SE":switch(n){case"NE-SW":"top"===i?c={start:t,end:s}:c.end=t;break;case"NW-SE":"top"===i?c={start:t,end:a}:c.end=t;break;case"SE-NW":"top"===i?c={start:t,end:o}:c.end=t;break;case"SW-NE":"top"===i?c={start:t,end:l}:c.end=t}break;case"SW-NE":switch(n){case"NW-SE":c="bottom"===i?{start:this.hot._createCellCoords(t.row,o.col),end:this.hot._createCellCoords(s.row,t.col)}:{start:this.hot._createCellCoords(o.row,t.col),end:this.hot._createCellCoords(t.row,a.col)};break;case"SW-NE":c="top"===i?{start:this.hot._createCellCoords(e.highlight.row,t.col),end:this.hot._createCellCoords(t.row,a.col)}:{start:this.hot._createCellCoords(t.row,o.col),end:this.hot._createCellCoords(o.row,t.col)};break;case"SE-NW":"bottom"===i?c={start:this.hot._createCellCoords(t.row,l.col),end:this.hot._createCellCoords(o.row,t.col)}:"top"===i&&(c={start:s,end:t})}break;case"SE-NW":switch(n){case"NW-SE":case"NE-SW":case"SW-NE":"top"===i&&(c.end=t);break;case"SE-NW":"top"===i?c.end=t:c={start:t,end:o}}}return c}isDragged(){return this.dragged.length>0}}function OD(){let{label:e="",colspan:t=1,origColspan:r=1,collapsible:n=!1,crossHiddenColumns:i=[],isCollapsed:o=!1,isHidden:a=!1,isRoot:s=!1,isPlaceholder:l=!1,headerClassNames:c=[]}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{label:e,colspan:t,origColspan:r,collapsible:n,isCollapsed:o,crossHiddenColumns:i,isHidden:a,isRoot:s,isPlaceholder:l,headerClassNames:c}}function MD(e,t,r){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,r)}function ID(e,t){return e.get(ND(e,t))}function PD(e,t,r){return e.set(ND(e,t),r),r}function ND(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}const DD=["label","collapsible"];var FD=new WeakMap,LD=new WeakMap,HD=new WeakMap;class BD{constructor(){MD(this,FD,[]),MD(this,LD,0),MD(this,HD,1/0)}setColumnsLimit(e){PD(HD,this,e)}setData(){PD(FD,this,function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0;const r=[];if(0===t)return r;Ai(e,(e=>{const n=[];let i=0;r.push(n),Ai(e,(e=>{const r=OD();if(so(e)){const{label:t,colspan:n,headerClassName:i}=e;r.label=Pi(t),"number"===typeof n&&n>1&&(r.colspan=n,r.origColspan=n),"string"===typeof i&&(r.headerClassNames=[...i.split(" ")])}else r.label=Pi(e);i+=r.origColspan;let o=!1;if(i>=t&&(r.colspan=r.origColspan-(i-t),r.origColspan=r.colspan,o=!0),n.push(r),r.colspan>1)for(let t=0;t<r.colspan-1;t++)n.push({label:"",isPlaceholder:!0});return!o}))}));const n=Math.max(..._i(r,(e=>e.length)));return Ai(r,(e=>{if(e.length<n){const t=_i(new Array(n-e.length),(()=>OD()));e.splice(e.length,0,...t)}})),r}(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],ID(HD,this))),PD(LD,this,ID(FD,this).length)}getData(){return ID(FD,this)}mergeWith(e){Ai(e,(e=>{let{row:t,col:r,...n}=e;const i=this.getHeaderSettings(t,r);null!==i&&to(i,n,DD)}))}map(e){Ai(ID(FD,this),(t=>{Ai(t,(t=>{const r=e({...t});so(r)&&to(t,r,DD)}))}))}getHeaderSettings(e,t){var r;if(e>=ID(LD,this)||e<0)return null;const n=ID(FD,this)[e];return!1===Array.isArray(n)||t>=n.length?null:null!==(r=n[t])&&void 0!==r?r:null}getHeadersSettings(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;const n=[];if(e>=ID(LD,this)||e<0)return n;const i=ID(FD,this)[e];let o=0;for(let a=t;a<i.length;a++){const e=i[a];if(e.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(o+=e.colspan,n.push(e),e.colspan>1&&(a+=e.colspan-1),o===r)break;if(o>r)throw new Error("The last column settings cannot overlap the other header layers")}return n}getLayersCount(){return ID(LD,this)}getColumnsCount(){return ID(LD,this)>0?ID(FD,this)[0].length:0}clear(){PD(FD,this,[]),PD(LD,this,0)}}function UD(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const jD="DF-pre-order";const WD=new Map([[jD,function e(t,r){let n=t.call(r,this);for(let i=0;i<this.childs.length;i++){if(!1===n)return!1;n=e.call(this.childs[i],t,r)}return n}],["DF-post-order",function e(t,r){for(let n=0;n<this.childs.length;n++){if(!1===e.call(this.childs[n],t,r))return!1}return t.call(r,this)}],["BF",function(e,t){const r=[this];!function n(){if(0===r.length)return;const i=r.shift();r.push(...i.childs),!1!==e.call(t,i)&&n()}()}]]);class VD{constructor(e){UD(this,"data",{}),UD(this,"parent",null),UD(this,"childs",[]),this.data=e}addChild(e){e.parent=this,this.childs.push(e)}cloneTree(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this;const t=new VD({...e.data});for(let r=0;r<e.childs.length;r++)t.addChild(this.cloneTree(e.childs[r]));return t}replaceTreeWith(e){this.data={...e.data},this.childs=[];for(let t=0;t<e.childs.length;t++)this.addChild(e.childs[t])}walkDown(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"BF";if(!WD.has(t))throw new Error(`Traversal strategy "${t}" does not exist`);WD.get(t).call(this,e,this)}walkUp(e){const t=this,r=n=>{!1!==e.call(t,n)&&null!==n.parent&&r(n.parent)};r(this)}}function zD(e,t,r){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,r)}function qD(e,t){return e.get(GD(e,t))}function GD(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var $D=new WeakMap,KD=new WeakMap,YD=new WeakMap;class XD{constructor(e){zD(this,$D,new Map),zD(this,KD,new Map),zD(this,YD,null),function(e,t,r){e.set(GD(e,t),r)}(YD,this,e)}getRoots(){return Array.from(qD($D,this).values())}getRootByColumn(e){let t;return qD(KD,this).has(e)&&(t=qD($D,this).get(qD(KD,this).get(e))),t}getNode(e,t){const r=this.getRootByColumn(t);if(!r)return;const n=t-qD(KD,this).get(t);let i,o=0;return r.walkDown((r=>{const{data:{origColspan:a,headerLevel:s}}=r;if(e===s){if(n>=o&&n<=o+a-1)return i=r,i.data.isRoot=t===i.data.columnIndex,!1;o+=a}})),i}rebuildTreeIndex(){let e=0;qD(KD,this).clear(),Ai(qD($D,this),(t=>{let[,{data:{colspan:r}}]=t;for(let n=e;n<e+r;n++)qD(KD,this).set(n,e);e+=r}))}buildTree(){this.clear();const e=qD(YD,this).getColumnsCount();let t=0;for(;t<e;){const e=qD(YD,this).getHeaderSettings(0,t),r=new VD;qD($D,this).set(t,r),this.buildLeaves(r,t,0,e.origColspan),t+=e.origColspan}this.rebuildTreeIndex()}buildLeaves(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;const i=qD(YD,this).getHeadersSettings(r,t,n);r+=1,Ai(i,(n=>{const i={...n,headerLevel:r-1,columnIndex:t};let o;1===r?(e.data=i,o=e):(o=new VD(i),e.addChild(o)),r<qD(YD,this).getLayersCount()&&this.buildLeaves(o,t,r,n.origColspan),t+=n.origColspan}))}clear(){qD($D,this).clear(),qD(KD,this).clear()}}function JD(e,t){e.walkDown((e=>{let{data:r,childs:n}=e;if(!r.isHidden&&(t(r.columnIndex),0===n.length))for(let i=1;i<r.colspan;i++)t(r.columnIndex+i)}))}function ZD(e,t){let{childs:r}=e;if(0!==r.length)return r[0].data[t]}function QD(e){return ZD(e,"origColspan")===e.data.origColspan}function eF(e){const{data:t,childs:r}=e;if(!t.isCollapsed||t.isHidden||t.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(QD(e))return eF(r[0]);t.isCollapsed=!1;const n=r.slice(1),i=new Set;let o=0;if(n.length>0)Ai(n,(e=>{e.replaceTreeWith(e.data.clonedTree),e.data.clonedTree=null;const t=e.data;o+=t.colspan,JD(e,(e=>{i.add(e)}))}));else{const{colspan:e,origColspan:r,columnIndex:n}=t;o=r-e;for(let t=1;t<r;t++)i.add(n+t)}return e.walkUp((e=>{const{data:t}=e;t.colspan+=o,t.colspan>=t.origColspan?(t.colspan=t.origColspan,t.isCollapsed=!1):QD(e)&&(t.isCollapsed=ZD(e,"isCollapsed"))})),{rollbackModification:()=>tF(e),affectedColumns:Array.from(i),colspanCompensation:o}}function tF(e){var t;const{data:r,childs:n}=e;if(r.isCollapsed||r.isHidden||r.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(QD(e))return tF(n[0]);r.isCollapsed=!0;const i=n.slice(1),o=new Set;if(i.length>0)Ai(i,(e=>{JD(e,(e=>{o.add(e)})),e.data.clonedTree=e.cloneTree(),e.walkDown((e=>{let{data:t}=e;t.isHidden=!0}))}));else{const{origColspan:e,columnIndex:t}=r;for(let r=1;r<e;r++){const e=t+r;o.add(e)}}const a=r.colspan-(null!==(t=ZD(e,"colspan"))&&void 0!==t?t:1);return e.walkUp((e=>{const{data:t}=e;t.colspan-=a,t.colspan<=1?(t.colspan=1,t.isCollapsed=!0):QD(e)&&(t.isCollapsed=ZD(e,"isCollapsed"))})),{rollbackModification:()=>eF(e),affectedColumns:Array.from(o),colspanCompensation:a}}const rF=new Map([["collapse",tF],["expand",eF],["hide-column",function(e,t){if(!Number.isInteger(t))throw new Error("The passed gridColumnIndex argument has invalid type.");if(e.childs.length>0)throw new Error(Ii`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);const{crossHiddenColumns:r}=e.data;if(r.includes(t))return;let n=!1;e.walkUp((e=>{const{data:{collapsible:t}}=e;if(t)return n=!0,!1})),n||e.walkUp((e=>{const{data:r}=e;r.crossHiddenColumns.push(t),r.colspan>1?r.colspan-=1:r.isHidden=!0}))}],["show-column",function(e,t){if(!Number.isInteger(t))throw new Error("The passed gridColumnIndex argument has invalid type.");if(e.childs.length>0)throw new Error(Ii`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);const{crossHiddenColumns:r}=e.data;if(!r.includes(t))return;let n=!1;e.walkUp((e=>{const{data:{collapsible:t}}=e;if(t)return n=!0,!1})),n||e.walkUp((e=>{const{data:r}=e;r.crossHiddenColumns.splice(r.crossHiddenColumns.indexOf(t),1),!r.isHidden&&r.colspan<r.origColspan&&(r.colspan+=1),r.isHidden=!1}))}]]);function nF(e){const t=[];return Ai(e,(e=>{e.walkDown((e=>{const r=e.data,{origColspan:n,columnIndex:i,headerLevel:o,crossHiddenColumns:a}=r,s=function(e,t){let r;Array.isArray(e[t])?r=e[t]:(r=[],e[t]=r);return r}(t,o);let l=!1;for(let t=i;t<i+n;t++){if(a.includes(t)||l)s.push({label:"",isPlaceholder:!0});else{const e=iF(r);e.isRoot=!0,s.push(e),l=!0}}}))})),t}function iF(e){const{crossHiddenColumns:t,...r}=OD(e);return r}function oF(e,t,r){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,r)}function aF(e,t,r){return e.set(lF(e,t),r),r}function sF(e,t){return e.get(lF(e,t))}function lF(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var cF=new WeakMap,uF=new WeakMap,hF=new WeakMap;class dF{constructor(){oF(this,cF,new BD),oF(this,uF,new XD(sF(cF,this))),oF(this,hF,[[]])}setState(e){sF(cF,this).setData(e);let t=!1;try{sF(uF,this).buildTree()}catch(r){sF(uF,this).clear(),sF(cF,this).clear(),t=!0}return aF(hF,this,nF(sF(uF,this).getRoots())),t}setColumnsLimit(e){sF(cF,this).setColumnsLimit(e)}mergeStateWith(e){const t=_i(e,(e=>{let{row:t,...r}=e;return{row:t<0?this.rowCoordsToLevel(t):t,...r}}));sF(cF,this).mergeWith(t),sF(uF,this).buildTree(),aF(hF,this,nF(sF(uF,this).getRoots()))}mapState(e){sF(cF,this).map(e),sF(uF,this).buildTree(),aF(hF,this,nF(sF(uF,this).getRoots()))}mapNodes(e){return Ei(sF(uF,this).getRoots(),((t,r)=>(r.walkDown((r=>{const n=e(r.data);void 0!==n&&t.push(n)})),t)),[])}triggerNodeModification(e,t,r){t<0&&(t=this.rowCoordsToLevel(t));const n=sF(uF,this).getNode(t,r);let i;return n&&(i=function(e,t,r){if(!rF.has(e))throw new Error(`The node modifier action ("${e}") does not exist.`);return rF.get(e)(t,r)}(e,n,r),aF(hF,this,nF(sF(uF,this).getRoots()))),i}triggerColumnModification(e,t){return this.triggerNodeModification(e,-1,t)}rowCoordsToLevel(e){if(e>=0)return null;const t=e+Math.max(this.getLayersCount(),1);return t<0?null:t}levelToRowCoords(e){if(e<0)return null;const t=e-Math.max(this.getLayersCount(),1);return t>=0?null:t}getHeaderSettings(e,t){var r,n;return e<0&&(e=this.rowCoordsToLevel(e)),null===e||e>=this.getLayersCount()?null:null!==(r=null===(n=sF(hF,this)[e])||void 0===n?void 0:n[t])&&void 0!==r?r:null}getHeaderTreeNodeData(e,t){const r=this.getHeaderTreeNode(e,t);return r?{...r.data}:null}getHeaderTreeNode(e,t){if(e<0&&(e=this.rowCoordsToLevel(e)),null===e||e>=this.getLayersCount())return null;const r=sF(uF,this).getNode(e,t);return r||null}findTopMostEntireHeaderLevel(e){var t;let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;const n=r-e+1;let i=!1,o=null;for(let a=e;a<=r;a++){const t=sF(uF,this).getRootByColumn(a);if(!t)break;i=!0,t.walkDown((t=>{const{columnIndex:i,headerLevel:a,origColspan:s,isHidden:l}=t.data;l||s<=n&&i>=e&&i+s-1<=r&&(null===o||a<o)&&(o=a)}),jD)}return i&&null===o?-1:this.levelToRowCoords(null!==(t=o)&&void 0!==t?t:0)}findLeftMostColumnIndex(e,t){var r;const{isRoot:n}=null!==(r=this.getHeaderSettings(e,t))&&void 0!==r?r:{isRoot:!0};if(n)return t;let i=t-1;for(;i>=0;){var o;const{isRoot:t}=null!==(o=this.getHeaderSettings(e,i))&&void 0!==o?o:{isRoot:!0};if(t)break;i-=1}return i}findRightMostColumnIndex(e,t){var r;const{isRoot:n,origColspan:i}=null!==(r=this.getHeaderSettings(e,t))&&void 0!==r?r:{isRoot:!0,origColspan:1};if(n)return t+i-1;let o=t+1;for(;o<this.getColumnsCount();){var a;const{isRoot:t}=null!==(a=this.getHeaderSettings(e,o))&&void 0!==a?a:{isRoot:!0};if(t)break;o+=1}return o-1}getLayersCount(){return sF(cF,this).getLayersCount()}getColumnsCount(){return sF(cF,this).getColumnsCount()}clear(){aF(hF,this,[]),sF(cF,this).clear(),sF(uF,this).clear()}}function fF(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const gF=class{constructor(e,t){fF(this,"hot",void 0),fF(this,"nestedHeaderSettingsGetter",void 0),fF(this,"layersCount",0),fF(this,"container",void 0),fF(this,"widthsMap",void 0),this.hot=e,this.nestedHeaderSettingsGetter=t,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(e){return this.layersCount=e,this}getWidth(e){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e))}buildWidthsMap(){this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);const e=this.container.querySelectorAll("tr:last-of-type th"),t=e.length;this.widthsMap.clear();for(let r=0;r<t;r++){const t=this.hot.columnIndexMapper.getVisualFromRenderableIndex(r),n=this.hot.toPhysicalColumn(t);this.widthsMap.setValueAtIndex(n,e[r].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(e){const{rootDocument:t,columnIndexMapper:r}=this.hot,n=t.createDocumentFragment(),i=t.createElement("table"),o=!!this.hot.getSettings().dropdownMenu,a=r.getRenderableIndexesLength();for(let s=0;s<this.layersCount;s++){const e=t.createElement("tr");for(let n=0;n<a;n++){let i=r.getVisualFromRenderableIndex(n);null===i&&(i=n);const a=t.createElement("th"),l=this.nestedHeaderSettingsGetter(s,i);if(l&&(!l.isPlaceholder||l.isHidden)){let t=l.label;o&&(t+='<button class="changeType"></button>'),Kn(a,t),a.colSpan=l.colspan,e.appendChild(a)}}i.appendChild(e)}n.appendChild(i),e.appendChild(n)}clear(){this.widthsMap.clear(),this.container=null}};function pF(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function mF(e,t,r){vF(e,t),t.set(e,r)}function vF(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function bF(e,t,r){return e.set(wF(e,t),r),r}function yF(e,t){return e.get(wF(e,t))}function wF(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}const SF="nestedHeaders";var CF=new WeakMap,kF=new WeakMap,xF=new WeakMap,EF=new WeakMap,TF=new WeakSet;class _F extends Fy{constructor(){super(...arguments),function(e,t){vF(e,t),t.add(e)}(this,TF),mF(this,CF,new dF),mF(this,kF,null),mF(this,xF,null),mF(this,EF,!1),pF(this,"ghostTable",new gF(this.hot,((e,t)=>this.getHeaderSettings(e,t)))),pF(this,"detectedOverlappedHeaders",!1)}static get PLUGIN_KEY(){return SF}static get PLUGIN_PRIORITY(){return 280}isEnabled(){return!!this.hot.getSettings()[SF]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:t}=this.hot.getSettings();Array.isArray(t)&&Array.isArray(t[0])||Ho(Ii`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",(()=>wF(TF,this,zF).call(this))),this.addHook("afterLoadData",(function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return wF(TF,e,qF).call(e,...r)})),this.addHook("beforeOnCellMouseDown",(function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return wF(TF,e,IF).call(e,...r)})),this.addHook("afterOnCellMouseDown",(function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return wF(TF,e,PF).call(e,...r)})),this.addHook("beforeOnCellMouseOver",(function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return wF(TF,e,NF).call(e,...r)})),this.addHook("beforeOnCellMouseUp",(function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return wF(TF,e,DF).call(e,...r)})),this.addHook("beforeSelectionHighlightSet",(function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return wF(TF,e,FF).call(e,...r)})),this.addHook("modifyTransformStart",(function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return wF(TF,e,LF).call(e,...r)})),this.addHook("afterSelection",(()=>wF(TF,this,AF).call(this))),this.addHook("afterSelectionFocusSet",(()=>wF(TF,this,AF).call(this))),this.addHook("beforeViewportScrollHorizontally",(function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return wF(TF,e,RF).call(e,...r)})),this.addHook("afterGetColumnHeaderRenderers",(e=>wF(TF,this,BF).call(this,e))),this.addHook("modifyColWidth",(function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return wF(TF,e,jF).call(e,...r)})),this.addHook("modifyColumnHeaderValue",(function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return wF(TF,e,WF).call(e,...r)})),this.addHook("beforeHighlightingColumnHeader",(function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return wF(TF,e,OF).call(e,...r)})),this.addHook("beforeCopy",(function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return wF(TF,e,MF).call(e,...r)})),this.addHook("beforeSelectColumns",(function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return wF(TF,e,HF).call(e,...r)})),this.addHook("afterViewportColumnCalculatorOverride",(function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return wF(TF,e,UF).call(e,...r)})),this.addHook("modifyFocusedElement",(function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return wF(TF,e,VF).call(e,...r)})),this.hot.columnIndexMapper.addLocalHook("cacheUpdated",(()=>wF(TF,this,AF).call(this))),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",(()=>wF(TF,this,AF).call(this))),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;const{nestedHeaders:e}=this.hot.getSettings();yF(CF,this).setColumnsLimit(this.hot.countCols()),Array.isArray(e)&&(this.detectedOverlappedHeaders=yF(CF,this).setState(e)),this.detectedOverlappedHeaders&&Ho(Ii`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach(((e,t)=>{const r=!0===e?"hide-column":"show-column";yF(CF,this).triggerColumnModification(r,t)})),!yF(kF,this)&&this.enabled&&bF(kF,this,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe((e=>{e.forEach((e=>{let{op:t,index:r,newValue:n}=e;if("replace"===t){const e=!0===n?"hide-column":"show-column";yF(CF,this).triggerColumnModification(e,r)}})),this.ghostTable.buildWidthsMap()}))),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.clearColspans(),yF(CF,this).clear(),yF(kF,this).unsubscribe(),bF(kF,this,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return yF(CF,this)}getLayersCount(){return yF(CF,this).getLayersCount()}getHeaderSettings(e,t){return yF(CF,this).getHeaderSettings(e,t)}clearColspans(){if(!this.hot.view)return;const{_wt:e}=this.hot.view,t=e.getSetting("columnHeaders").length,r=e.wtTable.THEAD,n=e.wtOverlays.topOverlay.clone.wtTable.THEAD,i=e.wtOverlays.topInlineStartCornerOverlay?e.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let o=0;o<t;o++){const e=r.childNodes[o];if(!e)break;const t=n.childNodes[o],a=i?i.childNodes[o]:null;for(let r=0,n=e.childNodes.length;r<n;r++)e.childNodes[r].removeAttribute("colspan"),Wn(e.childNodes[r],"hiddenHeader"),t&&t.childNodes[r]&&(t.childNodes[r].removeAttribute("colspan"),Wn(t.childNodes[r],"hiddenHeader")),i&&a&&a.childNodes[r]&&(a.childNodes[r].removeAttribute("colspan"),Wn(a.childNodes[r],"hiddenHeader"))}}headerRendererFactory(e){var t=this;const r=this.hot.view._wt.getSetting("fixedColumnsStart");return(n,i)=>{var o;const{columnIndexMapper:a,view:s}=this.hot;let l=a.getVisualFromRenderableIndex(n);null===l&&(l=n),i.removeAttribute("colspan"),Wn(i,"hiddenHeader");const{colspan:c,isHidden:u,isPlaceholder:h,headerClassNames:d}=null!==(o=yF(CF,this).getHeaderSettings(e,l))&&void 0!==o?o:{label:""};if(h||u)jn(i,"hiddenHeader");else if(c>1){var f,g;const{wtOverlays:e}=s._wt,t=null===(f=e.topInlineStartCornerOverlay)||void 0===f?void 0:f.clone.wtTable.THEAD.contains(i),o=null===(g=e.inlineStartOverlay)||void 0===g?void 0:g.clone.wtTable.THEAD.contains(i),a=t||o?Math.min(c,r-n):c;a>1&&i.setAttribute("colspan",a)}if(this.hot.view.appendColHeader(l,i,(function(){return t.getColumnHeaderValue(...arguments)}),e),!h&&!u){const e=i.querySelector("div.relative");e&&d&&d.length>0&&(Wn(e,this.hot.getColumnMeta(l).headerClassName),jn(e,d))}}}getColumnHeaderValue(e,t){var r;const{isHidden:n,isPlaceholder:i}=null!==(r=yF(CF,this).getHeaderSettings(t,e))&&void 0!==r?r:{};return i||n?"":this.hot.getColHeader(e,t)}destroy(){bF(CF,this,null),null!==yF(kF,this)&&(yF(kF,this).unsubscribe(),bF(kF,this,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(e){if(!(e.row>=0||e.col<0))return yF(CF,this).getHeaderTreeNodeData(e.row,e.col)}}function AF(){var e;const t=null===(e=this.hot)||void 0===e?void 0:e.getSelectedRangeLast();if(!t)return;const{highlight:r}=t;if(r.isHeader()&&r.col>=0){const e=yF(CF,this).findLeftMostColumnIndex(r.row,r.col),t=this.hot.selection.highlight.getFocus();t.visualCellRange.highlight.col=e,t.visualCellRange.from.col=e,t.visualCellRange.to.col=e,t.commit()}}function RF(e){const t=this.hot.getSelectedRangeLast();if(!t)return e;const{highlight:r}=t;if(!(r.isHeader()&&r.col>=0))return e;const n=this.hot.view.getFirstFullyVisibleColumn(),i=this.hot.view.getLastFullyVisibleColumn(),o=yF(CF,this).findLeftMostColumnIndex(r.row,r.col),a=yF(CF,this).findRightMostColumnIndex(r.row,r.col);return o<n&&a>i?e:o<n?o:a}function OF(e,t,r){const n=yF(CF,this).getHeaderTreeNodeData(t,e);if(!n)return e;const{columnCursor:i,selectionType:o,selectionWidth:a}=r,{isRoot:s,colspan:l}=yF(CF,this).getHeaderSettings(t,e);if(o===Xf){if(!s)return n.columnIndex}else if(o===Yf&&(l>a-i||!s))return null;return e}function MF(e,t,r){let{columnHeadersCount:n}=r;if(0!==n)for(let o=0;o<t.length;o++){const{startRow:r,startCol:n,endRow:a,endCol:s}=t[o],l=a-r+1;if(r>=0||1===n-s+1)break;for(let t=n;t<=s;t++)for(let o=r;o<=a;o++){var i;const r=l+o,a=t-n;if(0===a)continue;!1===(null===(i=yF(CF,this).getHeaderTreeNodeData(o,t))||void 0===i?void 0:i.isRoot)&&(e[r][a]="")}}}function IF(e,t,r,n){this._getHeaderTreeNodeDataByCoords(t)&&(n.column=!0)}function PF(e,t){const r=this._getHeaderTreeNodeDataByCoords(t);if(!r)return;bF(xF,this,t.clone()),bF(EF,this,!0);const{selection:n}=this.hot,i=n.isSelected()?n.getSelectedRange().current():null,o=[],{columnIndex:a,origColspan:s}=r,l=!n.inInSelection(t);e.shiftKey&&i?t.col<i.from.col?o.push(i.getTopEndCorner().col,a,t.row):t.col>i.from.col?o.push(i.getTopStartCorner().col,a+s-1,t.row):o.push(a,a+s-1,t.row):(Lo(e)||Fo(e)&&l||function(e){return e instanceof TouchEvent}(e))&&o.push(a,a+s-1,t.row),n.selectColumns(...o)}function NF(e,t,r,n){if(!this.hot.view.isMouseDown())return;const i=this._getHeaderTreeNodeDataByCoords(t);if(!i)return;const{columnIndex:o,origColspan:a}=i,s=this.hot.getSelectedRangeLast(),l=s.getTopStartCorner(),c=s.getBottomEndCorner(),{from:u}=s;n.column=!0,n.cell=!0;const h=[],d=za(t.row,-1/0,-1);t.col<u.col?h.push(c.col,o,d):t.col>u.col?h.push(l.col,o+a-1,d):h.push(o,o+a-1,d),this.hot.selection.selectColumns(...h)}function DF(){bF(EF,this,!1)}function FF(){const{navigableHeaders:e}=this.hot.getSettings();if(!this.hot.view.isMouseDown()||!yF(EF,this)||!e)return;const t=this.hot.getSelectedRangeLast(),r=t.getTopStartCorner().col,n=t.getBottomEndCorner().col,{columnIndex:i,origColspan:o}=yF(CF,this).getHeaderTreeNodeData(yF(xF,this).row,yF(xF,this).col);if(t.setHighlight(yF(xF,this)),o>t.getWidth()||i<r||i+o-1>n){const e=yF(CF,this).findTopMostEntireHeaderLevel(za(r,i,i+o-1),za(n,i,i+o-1));t.highlight.row=e,t.highlight.col=t.from.col}}function LF(e){const{highlight:t}=this.hot.getSelectedRangeLast(),r=this.hot._createCellCoords(t.row+e.row,t.col+e.col);if(!(r.isHeader()&&r.col>=0))return;const n=yF(CF,this).findLeftMostColumnIndex(r.row,r.col),i=yF(CF,this).findRightMostColumnIndex(r.row,r.col);if(e.col<0){const r=t.col>=n&&t.col<=i?n-1:i,o=this.hot.columnIndexMapper.getNearestNotHiddenIndex(r,-1);e.col=null===o?-this.hot.view.countRenderableColumnsInRange(0,t.col):-Math.max(this.hot.view.countRenderableColumnsInRange(o,t.col)-1,1)}else if(e.col>0){const r=t.col>=n&&t.col<=i?i+1:n,o=this.hot.columnIndexMapper.getNearestNotHiddenIndex(r,1);e.col=null===o?this.hot.view.countRenderableColumnsInRange(t.col,this.hot.countCols()):Math.max(this.hot.view.countRenderableColumnsInRange(t.col,o)-1,1)}}function HF(e,t){const r=e.row,n=this._getHeaderTreeNodeDataByCoords({row:r,col:e.col}),i=this._getHeaderTreeNodeDataByCoords({row:r,col:t.col});t.col<e.col?(n&&(e.col=n.columnIndex+n.origColspan-1),i&&(t.col=i.columnIndex)):t.col>=e.col&&(n&&(e.col=n.columnIndex),i&&(t.col=i.columnIndex+i.origColspan-1))}function BF(e){e.length=0;for(let t=0;t<yF(CF,this).getLayersCount();t++)e.push(this.headerRendererFactory(t))}function UF(e){const t=yF(CF,this).getLayersCount();let r=e.startColumn,n=!!t;for(let i=0;i<t;i++){const t=yF(CF,this).findLeftMostColumnIndex(i,e.startColumn),o=this.hot.columnIndexMapper.getRenderableFromVisualIndex(t);if(t>=0&&(n=!1),Ua(o)&&o<e.startColumn){r=o;break}}e.startColumn=n?yF(CF,this).getHeaderTreeNodeData(0,r).columnIndex:r}function jF(e,t){const r=this.ghostTable.getWidth(t);return e>r?e:r}function WF(e,t,r){var n;const{label:i}=null!==(n=yF(CF,this).getHeaderTreeNodeData(r,t))&&void 0!==n?n:{label:""};return i}function VF(e,t){if(e<0)return this.hot.getCell(e,yF(CF,this).findLeftMostColumnIndex(e,t),!0)}function zF(){this.updatePlugin()}function qF(e,t){t||this.updatePlugin()}function GF(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const $F=class{constructor(e,t){GF(this,"hot",void 0),GF(this,"data",null),GF(this,"plugin",void 0),GF(this,"parentReference",new WeakMap),GF(this,"cache",{levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}),this.hot=t,this.plugin=e}setData(e){this.data=e}getData(){return this.data}getRawSourceData(){let e=null;return this.plugin.disableCoreAPIModifiers(),e=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),e}updateWithData(e){this.setData(e),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},ja(0,this.data.length-1,(e=>{this.cacheNode(this.data[e],0,null)}))}cacheNode(e,t,r){this.cache.levels[t]||(this.cache.levels[t]=[],this.cache.levelCount+=1),this.cache.levels[t].push(e),this.cache.rows.push(e),this.cache.nodeInfo.set(e,{parent:r,row:this.cache.rows.length-1,level:t}),this.hasChildren(e)&&Ai(e.__children,(r=>{this.cacheNode(r,t+1,e)}))}getDataObject(e){return null===e||void 0===e?null:this.cache.rows[e]}readTreeNodes(e,t,r,n){let i=!1,o=t;if(isNaN(o)&&o.end)return o;let a=e;return a||(a={__children:this.data},i=!0,o-=1),null!==r&&void 0!==r&&o===r?{result:a,end:!0}:null!==n&&void 0!==n&&a===n?{result:o,end:!0}:(o+=1,a.__children&&Ai(a.__children,(e=>{if(this.parentReference.set(e,i?null:a),o=this.readTreeNodes(e,o,r,n),isNaN(o)&&o.end)return!1})),o)}mockParent(){const e=this.mockNode();return e.__children=this.data,e}mockNode(){const e={};return co(this.data[0],((t,r)=>{e[r]=null})),e}getRowIndex(e){return null===e||void 0===e?null:this.cache.nodeInfo.get(e).row}getRowIndexWithinParent(e){let t=null;t=isNaN(e)?e:this.getDataObject(e);const r=this.getRowParent(e);return null===r||void 0===r?this.data.indexOf(t):r.__children.indexOf(t)}countAllRows(){const e={__children:this.data};return this.countChildren(e)}countChildren(e){let t=0,r=e;return isNaN(r)||(r=this.getDataObject(r)),r&&r.__children?(Ai(r.__children,(e=>{t+=1,e.__children&&(t+=this.countChildren(e))})),t):0}getRowParent(e){let t;return t=isNaN(e)?e:this.getDataObject(e),this.getRowObjectParent(t)}getRowObjectParent(e){return e&&"object"===typeof e?this.cache.nodeInfo.get(e).parent:null}getRowLevel(e){let t=null;return t=isNaN(e)?e:this.getDataObject(e),t?this.getRowObjectLevel(t):null}getRowObjectLevel(e){return null===e||void 0===e?null:this.cache.nodeInfo.get(e).level}hasChildren(e){let t=e;return isNaN(t)||(t=this.getDataObject(t)),!(!t.__children||!t.__children.length)}isChild(e){return null!==this.getRowParent(e)}getChild(e,t){var r;return(null===(r=e.__children)||void 0===r?void 0:r[t])||null}isRowHighestLevel(e){return!this.isChild(e)}isParent(e){var t;let r=e;return isNaN(r)||(r=this.getDataObject(r)),r&&!!r.__children&&0!==(null===(t=r.__children)||void 0===t?void 0:t.length)}addChild(e,t){let r=t;this.hot.runHooks("beforeAddChild",e,r);let n=null;e&&(n=this.getRowIndex(e)),this.hot.runHooks("beforeCreateRow",n+this.countChildren(e)+1,1);let i=e;e||(i=this.mockParent()),i.__children||(i.__children=[]),r||(r=this.mockNode()),i.__children.push(r),this.rewriteCache();const o=this.getRowIndex(r);this.hot.rowIndexMapper.insertIndexes(o,1),this.hot.runHooks("afterCreateRow",o,1),this.hot.runHooks("afterAddChild",e,r)}addChildAtIndex(e,t,r){let n,i=r;if(i||(i=this.mockNode()),this.hot.runHooks("beforeAddChild",e,i,t),e){const r=this.getRowIndex(e)+t+1;this.hot.runHooks("beforeCreateRow",r,1),e.__children.splice(t,null,i),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(e),"__children",e.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(r,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",r,1),n=r}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",t,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),n=this.getRowIndex(this.data[t]);i=this.getDataObject(n),this.hot.runHooks("afterAddChild",e,i,t)}addSibling(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"below";const r=this.translateTrimmedRow(e),n=this.getRowParent(r),i=this.getRowIndexWithinParent(r);switch(t){case"below":this.addChildAtIndex(n,i+1,null);break;case"above":this.addChildAtIndex(n,i,null)}}detachFromParent(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=null;const n=[];Array.isArray(e)?(ja(e[0],e[2],(e=>{const t=this.translateTrimmedRow(e);n.push(this.getDataObject(t))})),ja(0,n.length-2,(e=>{this.detachFromParent(n[e],!1)})),r=n[n.length-1]):r=e;const i=this.getRowIndex(r),o=this.countChildren(r),a=this.getRowIndexWithinParent(r),s=this.getRowParent(r),l=this.getRowParent(s),c=this.getRowIndex(l);let u=null;if(this.hot.runHooks("beforeDetachChild",s,r),null!==a&&void 0!==a){const e=Array.from(new Array(i+o+1).keys()).splice(-1*(o+1));if(this.hot.runHooks("beforeRemoveRow",i,o+1,e,this.plugin.pluginName),s.__children.splice(a,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",i,o+1,e,this.plugin.pluginName),l){u=c+this.countChildren(l);const e=this.getChild(l,this.countChildren(l)-1),t=this.getRowIndex(e);this.hot.runHooks("beforeCreateRow",t+1,o+1,this.plugin.pluginName),l.__children.push(r)}else u=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",u-2,o+1,this.plugin.pluginName),this.data.push(r)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",u-2,o+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",s,r,this.getRowIndex(r)),t&&this.hot.render()}filterData(e,t,r){const n=[];Ai(r,(e=>{n.push(this.getDataObject(e))})),Ai(n,(e=>{const t=this.getRowIndexWithinParent(e),r=this.getRowParent(e);null===r?this.data.splice(t,1):r.__children.splice(t,1)})),this.rewriteCache()}spliceData(e,t,r){const n=this.getDataObject(e-1);let i=null,o=e;n&&n.__children&&0===n.__children.length?(i=n,o=0):e<this.countAllRows()&&(i=this.getRowParent(e),o=this.getRowIndexWithinParent(e)),i?r?i.__children.splice(o,t,...r):i.__children.splice(o,t):r?this.data.splice(o,t,...r):this.data.splice(o,t),this.rewriteCache()}syncRowWithRawSource(e){let t=e,r=null;do{r=this.getRowParent(r),null!==r&&(t=r)}while(null!==r);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndex(t),"__children",t.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(e,t,r,n){const i=t===this.hot.countRows(),o=this.getRowParent(e),a=this.getRowIndexWithinParent(e),s=o.__children.slice(a,a+1),l=e>t;let c=i?this.getRowParent(t-1):this.getRowParent(t);null!==c&&void 0!==c||(c=this.getRowParent(t-1)),null!==c&&void 0!==c||(c=this.getDataObject(t-1)),c?c.__children||(c.__children=[]):(c=this.getDataObject(t),c.__children=[]);const u=i||r||n?c.__children.length:this.getRowIndexWithinParent(t),h=o===c;c.__children.splice(u,0,s[0]),o.__children.splice(a+(l&&h?1:0),1),this.syncRowWithRawSource(o),h||this.syncRowWithRawSource(c)}translateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(e):e}untranslateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(e):e}};function KF(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const YF=class{constructor(e,t){KF(this,"hot",void 0),KF(this,"plugin",void 0),this.hot=t,this.plugin=e}};class XF extends YF{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(e,t){super(e,t),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(e,t){const r=this.hot.toPhysicalRow(e),n=this.dataManager.getRowLevel(r),i=this.dataManager.getDataObject(r),o=t.getElementsByTagName("DIV")[0],a=o.querySelector("span.rowHeader"),s=o.querySelectorAll('[class^="ht_nesting"]'),l=this.hot.getSettings().ariaTags;if(Ai(s,(e=>{e&&o.removeChild(e)})),jn(t,XF.CSS_CLASSES.indicatorContainer),n){const{rootDocument:e}=this.hot,t=a.cloneNode(!0);o.innerHTML="",ja(0,n-1,(()=>{const t=e.createElement("SPAN");jn(t,XF.CSS_CLASSES.emptyIndicator),o.appendChild(t)})),o.appendChild(t)}if(this.dataManager.hasChildren(i)){const e=this.hot.rootDocument.createElement("DIV");l&&Vn(e,[wn()]),jn(t,XF.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(r)?(jn(e,`${XF.CSS_CLASSES.button} ${XF.CSS_CLASSES.expandButton}`),l&&Vn(t,[Tn(!1)])):(jn(e,`${XF.CSS_CLASSES.button} ${XF.CSS_CLASSES.collapseButton}`),l&&Vn(t,[Tn(!0)])),o.appendChild(e)}}updateRowHeaderWidth(e){let t=e;t||(t=this.dataManager.cache.levelCount),this.rowHeaderWidthCache=Math.max(50,11+10*t+25),this.hot.render()}}const JF=XF;const ZF=class extends YF{constructor(e,t){var r;super(e,t),r=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];r.lastCollapsedRows=r.collapsedRows.slice(0),r.expandMultipleChildren(r.lastCollapsedRows,e)},shiftStash:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;null!==t&&void 0!==t||(t=1/0),Ai(r.lastCollapsedRows,((i,o)=>{i>=e&&i<t&&(r.lastCollapsedRows[o]=i+n)}))},applyStash:function(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];r.collapseMultipleChildren(r.lastCollapsedRows,e),r.lastCollapsedRows=void 0},trimStash:(e,t)=>{ja(e,e+t-1,(e=>{const t=this.lastCollapsedRows.indexOf(e);t>-1&&this.lastCollapsedRows.splice(t,1)}))}}}collapseChildren(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const n=[];let i=null,o=null,a=null;return isNaN(e)?(i=e,o=this.dataManager.getRowIndex(i)):(i=this.dataManager.getDataObject(e),o=e),this.dataManager.hasChildren(i)&&Ai(i.__children,(e=>{n.push(this.dataManager.getRowIndex(e))})),a=this.collapseRows(n,!0,!1),r&&this.trimRows(a),t&&this.renderAndAdjust(),-1===this.collapsedRows.indexOf(o)&&this.collapsedRows.push(o),a}collapseMultipleChildren(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const n=[];Ai(e,(e=>{n.push(...this.collapseChildren(e,!1,!1))})),r&&this.trimRows(n),t&&this.renderAndAdjust()}collapseRow(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.collapseRows([e],t)}collapseRows(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n=[];return Ai(e,(e=>{n.push(e),t&&this.collapseChildRows(e,n)})),r&&this.trimRows(n),n}collapseChildRows(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(this.dataManager.hasChildren(e)){Ai(this.dataManager.getDataObject(e).__children,(e=>{const r=this.dataManager.getRowIndex(e);t.push(r),this.collapseChildRows(r,t)}))}r&&this.trimRows(t)}expandRow(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.expandRows([e],t)}expandRows(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const n=[];return Ai(e,(e=>{n.push(e),t&&this.expandChildRows(e,n)})),r&&this.untrimRows(n),n}expandChildRows(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(this.dataManager.hasChildren(e)){Ai(this.dataManager.getDataObject(e).__children,(e=>{if(!this.isAnyParentCollapsed(e)){const r=this.dataManager.getRowIndex(e);t.push(r),this.expandChildRows(r,t)}}))}r&&this.untrimRows(t)}expandChildren(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const n=[];let i=null,o=null,a=null;return isNaN(e)?(i=e,o=this.dataManager.getRowIndex(e)):(i=this.dataManager.getDataObject(e),o=e),this.collapsedRows.splice(this.collapsedRows.indexOf(o),1),this.dataManager.hasChildren(i)&&Ai(i.__children,(e=>{const t=this.dataManager.getRowIndex(e);n.push(t)})),a=this.expandRows(n,!0,!1),r&&this.untrimRows(a),t&&this.renderAndAdjust(),a}expandMultipleChildren(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const n=[];Ai(e,(e=>{n.push(...this.expandChildren(e,!1,!1))})),r&&this.untrimRows(n),t&&this.renderAndAdjust()}collapseAll(){const e=this.dataManager.getData(),t=[];Ai(e,(e=>{this.dataManager.hasChildren(e)&&t.push(e)})),this.collapseMultipleChildren(t),this.renderAndAdjust()}expandAll(){const e=this.dataManager.getData(),t=[];Ai(e,(e=>{this.dataManager.hasChildren(e)&&t.push(e)})),this.expandMultipleChildren(t),this.renderAndAdjust()}trimRows(e){this.hot.batchExecution((()=>{Ai(e,(e=>{this.plugin.collapsedRowsMap.setValueAtIndex(e,!0)}))}),!0)}untrimRows(e){this.hot.batchExecution((()=>{Ai(e,(e=>{this.plugin.collapsedRowsMap.setValueAtIndex(e,!1)}))}),!0)}areChildrenCollapsed(e){let t=isNaN(e)?e:this.dataManager.getDataObject(e),r=!0;return null===t&&(t={__children:this.dataManager.data}),this.dataManager.hasChildren(t)&&Ai(t.__children,(e=>{const t=this.dataManager.getRowIndex(e);if(!this.plugin.collapsedRowsMap.getValueAtIndex(t))return r=!1,!1})),r}isAnyParentCollapsed(e){let t=e;for(;null!==t;){t=this.dataManager.getRowParent(t);const e=this.dataManager.getRowIndex(t);if(this.collapsedRows.indexOf(e)>-1)return!0}return!1}toggleState(e,t){if(t.col>=0)return;const r=this.translateTrimmedRow(t.row);Un(e.target,JF.CSS_CLASSES.button)&&(this.areChildrenCollapsed(r)?this.expandChildren(r):this.collapseChildren(r),No(e))}translateTrimmedRow(e){return this.hot.toPhysicalRow(e)}untranslateTrimmedRow(e){return this.hot.toVisualRow(e)}renderAndAdjust(){this.hot.render(),this.hot.view.adjustElementsSize()}};function QF(e,t,r){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,r)}function eL(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function tL(e,t){return e.get(function(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}(e,t))}var rL=new WeakMap;const nL=class extends YF{constructor(){super(...arguments),eL(this,"dataManager",this.plugin.dataManager),QF(this,rL,{row_above:(e,t)=>{const r=t[t.length-1];this.dataManager.addSibling(r.start.row,"above")},row_below:(e,t)=>{const r=t[t.length-1];this.dataManager.addSibling(r.start.row,"below")}})}appendOptions(e){const t=[{key:"add_child",name(){return this.getTranslatedPhrase($d)},callback:()=>{const e=this.dataManager.translateTrimmedRow(this.hot.getSelectedLast()[0]),t=this.dataManager.getDataObject(e);this.dataManager.addChild(t)},disabled:()=>{const e=this.hot.getSelectedLast();return!e||e[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(Kd)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedLast())},disabled:()=>{const e=this.hot.getSelectedLast(),t=this.dataManager.translateTrimmedRow(e[0]);return!this.dataManager.getRowParent(t)||!e||e[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return ja(0,e.items.length-1,(r=>{if(0===r)return Ai(t,((t,n)=>{e.items.splice(r+n,0,t)})),!1})),this.modifyRowInsertingOptions(e)}modifyRowInsertingOptions(e){return ja(0,e.items.length-1,(t=>{const r=tL(rL,this)[e.items[t].key];null!==r&&void 0!==r&&(e.items[t].callback=r)})),e}};function iL(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class oL{constructor(e){iL(this,"plugin",void 0),iL(this,"hot",void 0),iL(this,"dataManager",void 0),iL(this,"collapsingUI",void 0),this.plugin=e,this.hot=e.hot,this.dataManager=e.dataManager,this.collapsingUI=e.collapsingUI}onBeforeRowMove(e,t,r,n){if(this.displayAPICompatibilityWarning({rows:e,finalIndex:t,dropIndex:r,movePossible:n}))return!1;this.movedToCollapsed=!1;const i=r===this.hot.countRows(),o=i?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(r);let a=!0;const s=e.map((e=>{if(!a)return!1;const t=this.dataManager.translateTrimmedRow(e);return a=this.shouldAllowMoving(t,o),t})),l=-1===s.indexOf(o);if(!a||!l)return!1;const c=this.getBaseParent(s),u=this.getTargetParent(i,o),h=c===u;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(u),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(s,o,h),this.moveRows(s,o,u),this.dataManager.rewriteCache(),this.moveCellsMeta(s,o),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",e,t,r,n,n&&this.isRowOrderChanged(e,t)),this.hot.render(),this.selectCells(e,r),!1}displayAPICompatibilityWarning(e){const{rows:t,finalIndex:r,dropIndex:n,movePossible:i}=e;let o=!1;return Di(n)&&(Ho(Ii`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",t,r,n,i,!1),o=!0),o}shouldAllowMoving(e,t){return!(this.dataManager.isParent(e)||this.dataManager.isRowHighestLevel(e)||e===t||0===t)}getBaseParent(e){return this.dataManager.getRowParent(e[0])}getTargetParent(e,t){let r=this.dataManager.getRowParent(e?t-1:t);return null!==r&&void 0!==r||(r=this.dataManager.getRowParent(t-1)),r}shiftCollapsibleParentsLocations(e,t,r){r||(Math.max(...e)<=t?this.collapsingUI.collapsedRowsStash.shiftStash(e[0],t,-1*e.length):this.collapsingUI.collapsedRowsStash.shiftStash(t,e[0],e.length))}moveRows(e,t,r){const n=t===this.dataManager.getRowIndex(r)+this.dataManager.countChildren(r)+1;this.hot.batchRender((()=>{e.forEach((e=>{this.dataManager.moveRow(e,t,this.movedToCollapsed,n)}))}))}moveCellsMeta(e,t){const r=[],n=Math.max(...e)<t;e.forEach((e=>{r.push(this.hot.getCellMetaAtRow(e))})),this.hot.spliceCellsMeta(e[0],e.length),this.hot.spliceCellsMeta(t-(n?r.length:0),0,...r)}selectCells(e,t){const r=e.length;let n=0,i=0,o=null,a=null;if(this.movedToCollapsed){let o=null;o=e[r-1]<t?this.dataManager.translateTrimmedRow(t-r):this.dataManager.translateTrimmedRow(t);const a=this.dataManager.getRowParent(null===o?this.hot.countSourceRows()-1:o-1),s=this.dataManager.getRowIndex(a);n=this.dataManager.untranslateTrimmedRow(s),i=n}else e[r-1]<t?(i=t-1,n=i-r+1):(n=t,i=n+r-1);o=this.hot.selection,a=this.hot.countCols()-1,o.setRangeStart(this.hot._createCellCoords(n,0)),o.setRangeEnd(this.hot._createCellCoords(i,a),!0)}isRowOrderChanged(e,t){return e.some(((e,r)=>e-r!==t))}}function aL(e,t,r){sL(e,t),t.set(e,r)}function sL(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function lL(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function cL(e,t){return e.get(hL(e,t))}function uL(e,t,r){return e.set(hL(e,t),r),r}function hL(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}const dL="nestedRows",fL=dL;var gL=new WeakMap,pL=new WeakMap,mL=new WeakSet;class vL extends Fy{constructor(){super(...arguments),function(e,t){sL(e,t),t.add(e)}(this,mL),lL(this,"dataManager",null),lL(this,"headersUI",null),lL(this,"collapsedRowsMap",null),aL(this,gL,!1),aL(this,pL,!1)}static get PLUGIN_KEY(){return dL}static get PLUGIN_PRIORITY(){return 300}isEnabled(){return!!this.hot.getSettings()[dL]}enablePlugin(){var e=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new Nh),this.dataManager=new $F(this,this.hot),this.collapsingUI=new ZF(this,this.hot),this.headersUI=new JF(this,this.hot),this.contextMenuUI=new nL(this,this.hot),this.rowMoveController=new oL(this),this.addHook("afterInit",(function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return hL(mL,e,ML).call(e,...r)})),this.addHook("beforeViewRender",(function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return hL(mL,e,IL).call(e,...r)})),this.addHook("modifyRowData",(function(){return e.onModifyRowData(...arguments)})),this.addHook("modifySourceLength",(function(){return e.onModifySourceLength(...arguments)})),this.addHook("beforeDataSplice",(function(){return e.onBeforeDataSplice(...arguments)})),this.addHook("filterData",(function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return hL(mL,e,wL).call(e,...r)})),this.addHook("afterContextMenuDefaultOptions",(function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return hL(mL,e,SL).call(e,...r)})),this.addHook("afterGetRowHeader",(function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return hL(mL,e,CL).call(e,...r)})),this.addHook("beforeOnCellMouseDown",(function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return hL(mL,e,yL).call(e,...r)})),this.addHook("beforeRemoveRow",(function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return hL(mL,e,EL).call(e,...r)})),this.addHook("afterRemoveRow",(function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return hL(mL,e,xL).call(e,...r)})),this.addHook("beforeAddChild",(function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return hL(mL,e,TL).call(e,...r)})),this.addHook("afterAddChild",(function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return hL(mL,e,_L).call(e,...r)})),this.addHook("beforeDetachChild",(function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return hL(mL,e,AL).call(e,...r)})),this.addHook("afterDetachChild",(function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return hL(mL,e,RL).call(e,...r)})),this.addHook("modifyRowHeaderWidth",(function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return hL(mL,e,kL).call(e,...r)})),this.addHook("afterCreateRow",(function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return hL(mL,e,OL).call(e,...r)})),this.addHook("beforeRowMove",(function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return hL(mL,e,bL).call(e,...r)})),this.addHook("beforeLoadData",(e=>hL(mL,this,PL).call(this,e))),this.addHook("beforeUpdateData",(e=>hL(mL,this,PL).call(this,e))),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),this.unregisterShortcuts(),super.disablePlugin()}updatePlugin(){this.disablePlugin();const e=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(e),super.updatePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast(),t=this.collapsingUI.translateTrimmedRow(e.row);return this.collapsingUI.areChildrenCollapsed(t)?this.collapsingUI.expandChildren(t):this.collapsingUI.collapseChildren(t),!1},runOnlyIf:()=>{var e,t;const r=null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.highlight;return r&&(null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.isSingle())&&this.hot.selection.isCellVisible(r)&&-1===r.col&&r.row>=0},group:fL,relativeToGroup:zp,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(fL)}disableCoreAPIModifiers(){uL(pL,this,!0)}enableCoreAPIModifiers(){uL(pL,this,!1)}onModifyRowData(e){if(!cL(pL,this))return this.dataManager.getDataObject(e)}onModifySourceLength(){if(!cL(pL,this))return this.dataManager.countAllRows()}onBeforeDataSplice(e,t,r){return!(!cL(pL,this)&&!this.dataManager.isRowHighestLevel(e))||(this.dataManager.spliceData(e,t,r),!1)}destroy(){super.destroy()}}function bL(e,t,r,n){return this.rowMoveController.onBeforeRowMove(e,t,r,n)}function yL(e,t,r){this.collapsingUI.toggleState(e,t,r)}function wL(e,t,r){return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(r[0],t),this.collapsingUI.collapsedRowsStash.shiftStash(r[0],null,-1*t),this.dataManager.filterData(e,t,r),uL(gL,this,!0),this.dataManager.getData().slice()}function SL(e){return this.contextMenuUI.appendOptions(e)}function CL(e,t){this.headersUI.appendLevelIndicators(e,t)}function kL(e){return Math.max(this.headersUI.rowHeaderWidthCache,e)}function xL(e,t,r,n){n!==this.pluginName&&this.hot._registerTimeout((()=>{uL(gL,this,!1),this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()}))}function EL(e,t,r){const n=Array.from(r.reduce(((e,t)=>{if(this.dataManager.isParent(t)){const r=this.dataManager.getDataObject(t).__children;return e.add(t),Array.isArray(r)&&r.forEach((t=>e.add(this.dataManager.getRowIndex(t)))),e}return e.add(t)}),new Set));r.length=0,r.push(...n)}function TL(){this.collapsingUI.collapsedRowsStash.stash()}function _L(e,t){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(t)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function AL(){this.collapsingUI.collapsedRowsStash.stash()}function RL(e,t,r){this.collapsingUI.collapsedRowsStash.shiftStash(r,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function OL(){this.dataManager.rewriteCache()}function ML(){this.headersUI.updateRowHeaderWidth()}function IL(e,t){cL(gL,this)&&(t.skipRender=!0)}function PL(e){if(!function(e){return!!(Array.isArray(e)&&e.length&&e.every((e=>"object"===typeof e&&!Array.isArray(e)&&null!==e)))}(e))return Bo("The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled."),this.hot.getSettings()[dL]=!1,void this.disablePlugin();this.dataManager.setData(e),this.dataManager.rewriteCache()}function NL(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const DL=class{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;NL(this,"rootWindow",void 0),NL(this,"prefix",void 0),NL(this,"savedKeys",[]),this.rootWindow=t,this.prefix=e,this.loadSavedKeys()}saveValue(e,t){this.rootWindow.localStorage.setItem(`${this.prefix}_${e}`,JSON.stringify(t)),-1===this.savedKeys.indexOf(e)&&(this.savedKeys.push(e),this.saveSavedKeys())}loadValue(e,t){const r="undefined"===typeof e?t:e,n=this.rootWindow.localStorage.getItem(`${this.prefix}_${r}`);return null===n?void 0:JSON.parse(n)}reset(e){this.rootWindow.localStorage.removeItem(`${this.prefix}_${e}`)}resetAll(){Ai(this.savedKeys,((e,t)=>{this.rootWindow.localStorage.removeItem(`${this.prefix}_${this.savedKeys[t]}`)})),this.clearSavedKeys()}loadSavedKeys(){const e=this.rootWindow.localStorage.getItem(`${this.prefix}__persistentStateKeys`),t="string"===typeof e?JSON.parse(e):void 0;this.savedKeys=t||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(`${this.prefix}__persistentStateKeys`,JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}};function FL(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Ko.getSingleton().register("persistentStateSave"),Ko.getSingleton().register("persistentStateLoad"),Ko.getSingleton().register("persistentStateReset");const LL="persistentState";class HL extends Fy{constructor(){super(...arguments),FL(this,"storage",void 0)}static get PLUGIN_KEY(){return LL}static get PLUGIN_PRIORITY(){return 0}isEnabled(){return!!this.hot.getSettings()[LL]}enablePlugin(){this.enabled||(this.storage||(this.storage=new DL(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",((e,t)=>this.saveValue(e,t))),this.addHook("persistentStateLoad",((e,t)=>this.loadValue(e,t))),this.addHook("persistentStateReset",(()=>this.resetValue())),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(e,t){t.value=this.storage.loadValue(e)}saveValue(e,t){this.storage.saveValue(e,t)}resetValue(e){"undefined"===typeof e?this.storage.resetAll():this.storage.reset(e)}destroy(){super.destroy()}}function BL(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function UL(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function jL(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}const WL="search",VL=function(e,t,r,n,i){e.getCellMeta(t,r).isSearchResult=i},zL=function(e,t,r){return!(Di(e)||null===e||!e.toLocaleLowerCase||0===e.length)&&(!Di(t)&&null!==t&&-1!==t.toString().toLocaleLowerCase(r.locale).indexOf(e.toLocaleLowerCase(r.locale)))};var qL=new WeakSet;class GL extends Fy{constructor(){super(...arguments),BL(this,qL),UL(this,"callback",VL),UL(this,"queryMethod",zL),UL(this,"searchResultClass","htSearchResult")}static get PLUGIN_KEY(){return WL}static get PLUGIN_PRIORITY(){return 190}isEnabled(){return this.hot.getSettings()[WL]}enablePlugin(){var e=this;if(this.enabled)return;const t=this.hot.getSettings()[WL];this.updatePluginSettings(t),this.addHook("beforeRenderer",(function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return jL(qL,e,$L).call(e,...r)})),super.enablePlugin()}disablePlugin(){var e=this;const t=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return jL(qL,e,$L).call(e,...r)};this.hot.addHook("beforeRenderer",t),this.hot.addHookOnce("afterViewRender",(()=>{this.hot.removeHook("beforeRenderer",t)})),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getCallback(),r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.getQueryMethod();const n=this.hot.countRows(),i=this.hot.countCols(),o=[],a=this.hot;return ja(0,n-1,(n=>{ja(0,i-1,(i=>{const s=this.hot.getDataAtCell(n,i),l=this.hot.getCellMeta(n,i),c=l.search.callback||t,u=(l.search.queryMethod||r)(e,s,l);if(u){const e={row:n,col:i,data:s};o.push(e)}c&&c(a,n,i,s,u)}))})),o}getCallback(){return this.callback}setCallback(e){this.callback=e}getQueryMethod(){return this.queryMethod}setQueryMethod(e){this.queryMethod=e}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(e){this.searchResultClass=e}updatePluginSettings(e){so(e)&&(e.searchResultClass&&this.setSearchResultClass(e.searchResultClass),e.queryMethod&&this.setQueryMethod(e.queryMethod),e.callback&&this.setCallback(e.callback))}destroy(){super.destroy()}}function $L(e,t,r,n,i,o){const a=o.className||[];let s=[];"string"===typeof a?s=a.split(" "):s.push(...a),this.isEnabled()&&o.isSearchResult?s.includes(this.searchResultClass)||s.push(`${this.searchResultClass}`):s.includes(this.searchResultClass)&&s.splice(s.indexOf(this.searchResultClass),1),o.className=s.join(" ")}function KL(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function YL(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function XL(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}var JL=new WeakSet;class ZL extends Fy{constructor(){super(...arguments),KL(this,JL),YL(this,"scrollbars",[]),YL(this,"clones",[]),YL(this,"lockedCollection",!1),YL(this,"freezeOverlays",!1)}static get PLUGIN_KEY(){return"touchScroll"}static get PLUGIN_PRIORITY(){return 200}static get SETTING_KEYS(){return!0}isEnabled(){return vo()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",(()=>XL(JL,this,QL).call(this))),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",(()=>XL(JL,this,eH).call(this))),this.addHook("afterMomentumScroll",(()=>XL(JL,this,tH).call(this)))}}function QL(){if(this.lockedCollection)return;const{topOverlay:e,bottomOverlay:t,inlineStartOverlay:r,topInlineStartCornerOverlay:n,bottomInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(e),t.clone&&this.scrollbars.push(t),this.scrollbars.push(r),n&&this.scrollbars.push(n),i&&i.clone&&this.scrollbars.push(i),this.clones=[],e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),r.needFullRender&&this.clones.push(r.clone.wtTable.holder.parentNode),n&&this.clones.push(n.clone.wtTable.holder.parentNode),i&&i.clone&&this.clones.push(i.clone.wtTable.holder.parentNode)}function eH(){this.freezeOverlays=!0,Ai(this.clones,(e=>{jn(e,"hide-tween")}))}function tH(){this.freezeOverlays=!1,Ai(this.clones,(e=>{Wn(e,"hide-tween"),jn(e,"show-tween")})),this.hot._registerTimeout((()=>{Ai(this.clones,(e=>{Wn(e,"show-tween")}))}),400),Ai(this.scrollbars,(e=>{e.refresh(),e.resetFixedPosition()})),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}function rH(e,t){(function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}function nH(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const iH="trimRows";var oH=new WeakSet;class aH extends Fy{constructor(){super(...arguments),rH(this,oH),nH(this,"trimmedRowsMap",null)}static get PLUGIN_KEY(){return iH}static get PLUGIN_PRIORITY(){return 330}isEnabled(){return!!this.hot.getSettings()[iH]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new Nh),this.trimmedRowsMap.addLocalHook("init",(()=>function(e,t,r){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:r;throw new TypeError("Private element is not present on this object")}(oH,this,sH).call(this))),super.enablePlugin())}updatePlugin(){const e=this.hot.getSettings()[iH];Array.isArray(e)&&this.hot.batchExecution((()=>{this.trimmedRowsMap.clear(),Ai(e,(e=>{this.trimmedRowsMap.setValueAtIndex(e,!0)}))}),!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(e){const t=this.getTrimmedRows(),r=this.isValidConfig(e);let n=t;r&&(n=Array.from(new Set(t.concat(e))));!1!==this.hot.runHooks("beforeTrimRow",t,n,r)&&(r&&this.hot.batchExecution((()=>{Ai(e,(e=>{this.trimmedRowsMap.setValueAtIndex(e,!0)}))}),!0),this.hot.runHooks("afterTrimRow",t,n,r,r&&n.length>t.length))}trimRow(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.trimRows(t)}untrimRows(e){const t=this.getTrimmedRows(),r=this.isValidConfig(e);let n=t;const i=this.trimmedRowsMap.getValues().slice(),o=e.length>0;r&&o&&(Ai(e,(e=>{i[e]=!1})),n=Ei(i,((e,t,r)=>(t&&e.push(r),e)),[]));!1!==this.hot.runHooks("beforeUntrimRow",t,n,r&&o)&&(r&&o&&this.trimmedRowsMap.setValues(i),this.hot.runHooks("afterUntrimRow",t,n,r&&o,r&&n.length<t.length))}untrimRow(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.untrimRows(t)}isTrimmed(e){return this.trimmedRowsMap.getValueAtIndex(e)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(e){const t=this.hot.countSourceRows();return e.every((e=>Number.isInteger(e)&&e>=0&&e<t))}destroy(){super.destroy()}}function sH(){const e=this.hot.getSettings()[iH];Array.isArray(e)&&this.hot.batchExecution((()=>{Ai(e,(e=>{this.trimmedRowsMap.setValueAtIndex(e,!0)}))}),!0)}const lH="undoRedo";function cH(e){const t=this;this.instance=e,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,this.enabled=!1,e.addHook("afterChange",(function(r,n){const i=r&&r.length;if(!i)return;if(!r.find((e=>{const[,,t,r]=e;return t!==r})))return;t.done((()=>{const t=r.reduce(((e,t)=>(e.push([...t]),e)),[]);Ai(t,(t=>{t[1]=e.propToCol(t[1])}));const n=i>1?this.getSelected():[[t[0][0],t[0][1]]];return new cH.ChangeAction(t,n)}),n)})),e.addHook("afterCreateRow",((e,r,n)=>{t.done((()=>new cH.CreateRowAction(e,r)),n)}));const r=(t,r,n,i)=>{const o=["visualRow","visualCol","row","col","prop"],a=o.length,s=[];return ja(n,i,(n=>{ja(t,r,(t=>{const r=e.getCellMeta(t,n);if(Object.keys(r).length!==a){const e=Object.fromEntries(Object.entries(r).filter((e=>{let[t]=e;return!1===o.includes(t)})));s.push([r.visualRow,r.visualCol,e])}}))})),s};e.addHook("beforeRemoveRow",((n,i,o,a)=>{t.done((()=>{const o=e.toPhysicalRow(n),a=o+i-1,s=no(t.instance.getSourceData(o,0,o+i-1,t.instance.countSourceCols()-1));return new cH.RemoveRowAction(o,s,e.getSettings().fixedRowsBottom,e.getSettings().fixedRowsTop,e.rowIndexMapper.getIndexesSequence(),r(o,a,0,e.countCols()-1))}),a)})),e.addHook("afterCreateCol",((e,r,n)=>{t.done((()=>new cH.CreateColumnAction(e,r)),n)})),e.addHook("beforeRemoveCol",((n,i,o,a)=>{t.done((()=>{const o=t.instance.getSourceDataArray(),a=(t.instance.countCols()+n)%t.instance.countCols(),s=a+i-1,l=[],c=[],u=[];ja(o.length-1,(t=>{const r=[],n=o[t];ja(a,s,(t=>{r.push(n[e.toPhysicalColumn(t)])})),l.push(r)})),ja(i-1,(t=>{u.push(e.toPhysicalColumn(a+t))})),Array.isArray(e.getSettings().colHeaders)&&ja(i-1,(t=>{c.push(e.getSettings().colHeaders[e.toPhysicalColumn(a+t)]||null)}));const h=e.columnIndexMapper.getIndexesSequence(),d=e.rowIndexMapper.getIndexesSequence();return new cH.RemoveColumnAction(a,u,l,c,h,d,e.getSettings().fixedColumnsStart,r(0,e.countRows(),a,s))}),a)})),e.addHook("beforeCellAlignment",((e,r,n,i)=>{t.done((()=>new cH.CellAlignmentAction(e,r,n,i)))})),e.addHook("beforeFilter",(e=>{t.done((()=>new cH.FiltersAction(e)))})),e.addHook("beforeRowMove",((e,r)=>{!1!==e&&t.done((()=>new cH.RowMoveAction(e,r)))})),e.addHook("beforeColumnMove",((e,r)=>{!1!==e&&t.done((()=>new cH.ColumnMoveAction(e,r)))})),e.addHook("beforeMergeCells",((r,n)=>{n||t.done((()=>new cH.MergeCellsAction(e,r)))})),e.addHook("afterUnmergeCells",((r,n)=>{n||t.done((()=>new cH.UnmergeCellsAction(e,r)))})),e.addHook("beforeColumnSort",((e,r,n)=>{n&&t.done((()=>new cH.ColumnSortAction(e,r)))})),e.addHook("afterInit",(()=>{t.init()}))}cH.prototype.done=function(e,t){if(this.ignoreNewActions)return;if("UndoRedo.undo"===t||"UndoRedo.redo"===t||"auto"===t)return;const r=this.doneActions.slice();if(!1===this.instance.runHooks("beforeUndoStackChange",r,t))return;const n=e(),i=this.undoneActions.slice();this.doneActions.push(n),this.instance.runHooks("afterUndoStackChange",r,this.doneActions.slice()),this.instance.runHooks("beforeRedoStackChange",i),this.undoneActions.length=0,this.instance.runHooks("afterRedoStackChange",i,this.undoneActions.slice())},cH.prototype.undo=function(){if(this.isUndoAvailable()){const e=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",e);const t=this.doneActions.pop();this.instance.runHooks("afterUndoStackChange",e,this.doneActions.slice());const r=no(t);if(!1===this.instance.runHooks("beforeUndo",r))return;this.ignoreNewActions=!0;const n=this,i=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",i),t.undo(this.instance,(()=>{n.ignoreNewActions=!1,n.undoneActions.push(t)})),this.instance.runHooks("afterRedoStackChange",i,this.undoneActions.slice()),this.instance.runHooks("afterUndo",r)}},cH.prototype.redo=function(){if(this.isRedoAvailable()){const e=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",e);const t=this.undoneActions.pop();this.instance.runHooks("afterRedoStackChange",e,this.undoneActions.slice());const r=no(t);if(!1===this.instance.runHooks("beforeRedo",r))return;this.ignoreNewActions=!0;const n=this,i=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",i),t.redo(this.instance,(()=>{n.ignoreNewActions=!1,n.doneActions.push(t)})),this.instance.runHooks("afterUndoStackChange",i,this.doneActions.slice()),this.instance.runHooks("afterRedo",r)}},cH.prototype.isUndoAvailable=function(){return this.doneActions.length>0},cH.prototype.isRedoAvailable=function(){return this.undoneActions.length>0},cH.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0},cH.prototype.isEnabled=function(){return this.enabled},cH.prototype.enable=function(){if(this.isEnabled())return;const e=this.instance;var t;this.enabled=!0,(t=e).undo=function(){return t.undoRedo.undo()},t.redo=function(){return t.undoRedo.redo()},t.isUndoAvailable=function(){return t.undoRedo.isUndoAvailable()},t.isRedoAvailable=function(){return t.undoRedo.isRedoAvailable()},t.clearUndo=function(){return t.undoRedo.clear()},this.registerShortcuts(),e.addHook("afterChange",dH)},cH.prototype.disable=function(){if(!this.isEnabled())return;const e=this.instance;var t;this.enabled=!1,delete(t=e).undo,delete t.redo,delete t.isUndoAvailable,delete t.isRedoAvailable,delete t.clearUndo,this.unregisterShortcuts(),e.removeHook("afterChange",dH)},cH.prototype.destroy=function(){this.clear(),this.instance=null,this.doneActions=null,this.undoneActions=null},cH.Action=function(){},cH.Action.prototype.undo=function(){},cH.Action.prototype.redo=function(){},cH.ChangeAction=function(e,t){this.changes=e,this.selected=t,this.actionType="change"},eo(cH.ChangeAction,cH.Action),cH.ChangeAction.prototype.undo=function(e,t){const r=no(this.changes),n=e.countEmptyRows(!0),i=e.countEmptyCols(!0);for(let a=0,s=r.length;a<s;a++)r[a].splice(3,1);e.addHookOnce("afterChange",t),e.setDataAtCell(r,null,null,"UndoRedo.undo");for(let a=0,s=r.length;a<s;a++){const[t,o]=r[a];e.getSettings().minSpareRows&&t+1+e.getSettings().minSpareRows===e.countRows()&&n===e.getSettings().minSpareRows&&(e.alter("remove_row",parseInt(t+1,10),e.getSettings().minSpareRows),e.undoRedo.doneActions.pop()),e.getSettings().minSpareCols&&o+1+e.getSettings().minSpareCols===e.countCols()&&i===e.getSettings().minSpareCols&&(e.alter("remove_col",parseInt(o+1,10),e.getSettings().minSpareCols),e.undoRedo.doneActions.pop())}const o=e.getSelectedLast();if(void 0!==o){const[t,n]=r[0],[i,a]=o,s=t>=e.view.getFirstFullyVisibleRow(),l=n>=e.view.getFirstFullyVisibleColumn();if(!1===(s&&l)&&!0===(i!==t||a!==n)){const r={row:t,col:n};!1===s&&(r.verticalSnap="top"),!1===l&&(r.horizontalSnap="start"),e.scrollViewportTo(r)}}e.selectCells(this.selected,!1,!1)},cH.ChangeAction.prototype.redo=function(e,t){const r=no(this.changes);for(let n=0,i=r.length;n<i;n++)r[n].splice(2,1);e.addHookOnce("afterChange",t),e.setDataAtCell(r,null,null,"UndoRedo.redo"),this.selected&&e.selectCells(this.selected,!1,!1)},cH.CreateRowAction=function(e,t){this.index=e,this.amount=t,this.actionType="insert_row"},eo(cH.CreateRowAction,cH.Action),cH.CreateRowAction.prototype.undo=function(e,t){const r=e.countRows(),n=e.getSettings().minSpareRows;this.index>=r&&this.index-n<r&&(this.index-=n),e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.amount,"UndoRedo.undo")},cH.CreateRowAction.prototype.redo=function(e,t){e.addHookOnce("afterCreateRow",t),e.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")},cH.RemoveRowAction=function(e,t,r,n,i,o){this.index=e,this.data=t,this.actionType="remove_row",this.fixedRowsBottom=r,this.fixedRowsTop=n,this.rowIndexesSequence=i,this.removedCellMetas=o},eo(cH.RemoveRowAction,cH.Action),cH.RemoveRowAction.prototype.undo=function(e,t){const r=e.getSettings(),n=[];r.fixedRowsBottom=this.fixedRowsBottom,r.fixedRowsTop=this.fixedRowsTop,this.data.forEach(((e,t)=>{Object.keys(e).forEach((r=>{const i=parseInt(r,10);n.push([this.index+t,isNaN(i)?r:i,e[r]])}))})),e.alter("insert_row_above",this.index,this.data.length,"UndoRedo.undo"),this.removedCellMetas.forEach((t=>{let[r,n,i]=t;e.setCellMetaObject(r,n,i)})),e.addHookOnce("afterViewRender",t),e.setSourceDataAtCell(n,null,null,"UndoRedo.undo"),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence)},cH.RemoveRowAction.prototype.redo=function(e,t){e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")},cH.CreateColumnAction=function(e,t){this.index=e,this.amount=t,this.actionType="insert_col"},eo(cH.CreateColumnAction,cH.Action),cH.CreateColumnAction.prototype.undo=function(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount,"UndoRedo.undo")},cH.CreateColumnAction.prototype.redo=function(e,t){e.addHookOnce("afterCreateCol",t),e.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")},cH.RemoveColumnAction=function(e,t,r,n,i,o,a,s){this.index=e,this.indexes=t,this.data=r,this.amount=this.data[0].length,this.headers=n,this.columnPositions=i.slice(0),this.rowPositions=o.slice(0),this.actionType="remove_col",this.fixedColumnsStart=a,this.removedCellMetas=s},eo(cH.RemoveColumnAction,cH.Action),cH.RemoveColumnAction.prototype.undo=function(e,t){e.getSettings().fixedColumnsStart=this.fixedColumnsStart;const r=this.indexes.slice(0).sort(),n=(e,t,n)=>n[this.indexes.indexOf(r[t])],i=this.data.length,o=[];for(let l=0;l<i;l++)o.push(_i(this.data[l],n));const a=_i(this.headers,n),s=[];e.alter("insert_col_start",this.indexes[0],this.indexes.length,"UndoRedo.undo"),Ai(e.getSourceDataArray(),((e,t)=>{Ai(r,((r,n)=>{e[r]=o[t][n],s.push([t,r,e[r]])}))})),e.setSourceDataAtCell(s,void 0,void 0,"UndoRedo.undo"),"undefined"!==typeof this.headers&&Ai(a,((t,n)=>{e.getSettings().colHeaders[r[n]]=t})),this.removedCellMetas.forEach((t=>{let[r,n,i]=t;e.setCellMetaObject(r,n,i)})),e.batchExecution((()=>{e.rowIndexMapper.setIndexesSequence(this.rowPositions),e.columnIndexMapper.setIndexesSequence(this.columnPositions)}),!0),e.addHookOnce("afterViewRender",t),e.render()},cH.RemoveColumnAction.prototype.redo=function(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount,"UndoRedo.redo")},cH.CellAlignmentAction=function(e,t,r,n){this.stateBefore=e,this.range=t,this.type=r,this.alignment=n},cH.CellAlignmentAction.prototype.undo=function(e,t){Ai(this.range,(t=>{t.forAll(((t,r)=>{t>=0&&r>=0&&e.setCellMeta(t,r,"className",this.stateBefore[t][r]||" htLeft")}))})),e.addHookOnce("afterViewRender",t),e.render()},cH.CellAlignmentAction.prototype.redo=function(e,t){UC(this.range,this.type,this.alignment,((t,r)=>e.getCellMeta(t,r)),((t,r,n,i)=>e.setCellMeta(t,r,n,i))),e.addHookOnce("afterViewRender",t),e.render()},cH.FiltersAction=function(e){this.conditionsStack=e,this.actionType="filter"},eo(cH.FiltersAction,cH.Action),cH.FiltersAction.prototype.undo=function(e,t){const r=e.getPlugin("filters");e.addHookOnce("afterViewRender",t),r.conditionCollection.importAllConditions(this.conditionsStack.slice(0,this.conditionsStack.length-1)),r.filter()},cH.FiltersAction.prototype.redo=function(e,t){const r=e.getPlugin("filters");e.addHookOnce("afterViewRender",t),r.conditionCollection.importAllConditions(this.conditionsStack),r.filter()};class uH extends cH.Action{constructor(e,t){super(),this.cellRange=t;const r=this.cellRange.getTopStartCorner(),n=this.cellRange.getBottomEndCorner();this.rangeData=e.getData(r.row,r.col,n.row,n.col)}undo(e,t){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),r.unmergeRange(this.cellRange,!0);const n=this.cellRange.getTopStartCorner();e.populateFromArray(n.row,n.col,this.rangeData,void 0,void 0,"MergeCells")}redo(e,t){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),r.mergeRange(this.cellRange)}}cH.MergeCellsAction=uH;class hH extends cH.Action{constructor(e,t){super(),this.cellRange=t}undo(e,t){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),r.mergeRange(this.cellRange,!0)}redo(e,t){const r=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),r.unmergeRange(this.cellRange,!0),e.render()}}function dH(e,t){if("loadData"===t)return this.undoRedo.clear()}cH.UnmergeCellsAction=hH,cH.RowMoveAction=function(e,t){this.rows=e.slice(),this.finalRowIndex=t,this.actionType="row_move"},eo(cH.RowMoveAction,cH.Action),cH.RowMoveAction.prototype.undo=function(e,t){const r=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",t);IR(this.rows,this.finalRowIndex,e.rowIndexMapper.getNumberOfIndexes()).reverse().forEach((e=>{let{from:t,to:n}=e;t<n&&(n-=1),r.moveRow(n,t)})),e.render(),e.deselectCell(),e.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)},cH.RowMoveAction.prototype.redo=function(e,t){const r=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",t),r.moveRows(this.rows.slice(),this.finalRowIndex),e.render(),e.deselectCell(),e.selectRows(this.finalRowIndex,this.finalRowIndex+this.rows.length-1)},cH.ColumnMoveAction=function(e,t){this.columns=e.slice(),this.finalColumnIndex=t,this.actionType="col_move"},eo(cH.ColumnMoveAction,cH.Action),cH.ColumnMoveAction.prototype.undo=function(e,t){const r=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",t);IR(this.columns,this.finalColumnIndex,e.columnIndexMapper.getNumberOfIndexes()).reverse().forEach((e=>{let{from:t,to:n}=e;t<n&&(n-=1),r.moveColumn(n,t)})),e.render(),e.deselectCell(),e.selectColumns(this.columns[0],this.columns[0]+this.columns.length-1)},cH.ColumnMoveAction.prototype.redo=function(e,t){const r=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",t),r.moveColumns(this.columns.slice(),this.finalColumnIndex),e.render(),e.deselectCell(),e.selectColumns(this.finalColumnIndex,this.finalColumnIndex+this.columns.length-1)},cH.ColumnSortAction=function(e,t){this.previousSortState=e,this.nextSortState=t},eo(cH.ColumnSortAction,cH.Action),cH.ColumnSortAction.prototype.undo=function(e,t){const r=e.getPlugin("columnSorting"),n=e.getPlugin("multiColumnSorting"),i=n.isEnabled()?n:r;this.previousSortState.length?i.sort(this.previousSortState):i.clearSort(),t()},cH.ColumnSortAction.prototype.redo=function(e,t){const r=e.getPlugin("columnSorting"),n=e.getPlugin("multiColumnSorting");(n.isEnabled()?n:r).sort(this.nextSortState),t()},cH.prototype.init=function(){const e=this.instance.getSettings().undo,t="undefined"===typeof e||e;this.instance.undoRedo||(this.instance.undoRedo=this),t?this.instance.undoRedo.enable():this.instance.undoRedo.disable()},cH.prototype.registerShortcuts=function(){const e=this.instance.getShortcutManager().getContext("grid"),t={runOnlyIf:e=>!e.altKey,group:lH};e.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],t)},cH.prototype.unregisterShortcuts=function(){this.instance.getShortcutManager().getContext("grid").removeShortcutsByGroup(lH)};const fH=Ko.getSingleton();fH.add("afterUpdateSettings",(function(){var e;null===(e=this.getPlugin("undoRedo"))||void 0===e||e.init()})),fH.register("beforeUndo"),fH.register("afterUndo"),fH.register("beforeRedo"),fH.register("afterRedo"),cH.PLUGIN_KEY="undoRedo",cH.SETTING_KEYS=!0;const gH=cH;aa(hm),aa(ab),aa(sb),aa(Lb),aa(Hb),aa(tb),aa(Bb),aa(Ub),aa(Vb),aa(fv),aa(zb),hs(Gb),hs(gv),hs(ty),hs($b),hs(ny),hs(qb),hs(ay),hs(sy),hs(ly),hs(pv),hs(cy),vs(uy),vs(fy),vs(dy),vs(gy),vs(my),up(vy),up(by),up(wy),up(Sy),up(Cy),up(ky),up(xy),up(Ey),up(mv),up(Ty),is(Qy),is(gw),is(_w),is(Kw),is(lS),is($S),is(aC),is(uk),is(Sx),is(lE),is(DE),is(VE),is(eT),is(ST),is(sR),is(mO),is(XO),is(dM),is(TM),is(rI),is(PI),is(hP),is(WP),is($N),is(_D),is(RD),is(_F),is(vL),is(HL),is(GL),is(ZL),is(aH),is(gH);const pH={columns:[{data:"enabled",type:"checkbox",disableVisualSelection:!0,width:20},{data:"value",type:"text"},{data:"abbr",type:"text"}],stretchH:"all",width:500,autoWrapRow:!0,height:500,maxRows:1/0,manualRowResize:!0,manualColumnResize:!0,rowHeaders:!0,colHeaders:["Enabled","Word","Abbreviation"],trimWhitespace:!1,enterBeginsEditing:!1,manualRowMove:!0,manualColumnMove:!0,columnSorting:{indicator:!0},autoColumnSize:!1,minRows:15,contextMenu:!0,licenseKey:"non-commercial-and-evaluation"};const mH=function(e){let{data:r,setData:n}=e;const i=(0,t.useRef)(null);return(0,d.jsx)(Qv,{...pH,data:r,ref:i,beforeChange:(e,t)=>{const i=[...r];return e.forEach((e=>{let[t,r,n,o]=e;i[t][r]=o})),n(i),!1},beforeRemoveRow:(e,t,o,a)=>{const s=[];for(let n=0;n<r.length;n++){let e=!0;for(let t=0;t<o.length;t++)o[t]==n&&(e=!1);e&&s.push(r[n])}n(s);const l=i.current.hotInstance.getPlugin("columnSorting"),c=l.getSortConfig();return l.sort(c),!1}})};var vH={version:"0.18.5"},bH=1200,yH=1252,wH=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],SH={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},CH=function(e){-1!=wH.indexOf(e)&&(yH=SH[0]=e)};var kH=function(e){bH=e,CH(e)};function xH(){kH(1200),CH(1252)}function EH(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function TH(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var _H,AH=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return 255==t&&254==r?function(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}(e.slice(2)):254==t&&255==r?TH(e.slice(2)):65279==t?e.slice(1):e},RH=function(e){return String.fromCharCode(e)},OH=function(e){return String.fromCharCode(e)};var MH=null,IH="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function PH(e){for(var t="",r=0,n=0,i=0,o=0,a=0,s=0,l=0,c=0;c<e.length;)o=(r=e.charCodeAt(c++))>>2,a=(3&r)<<4|(n=e.charCodeAt(c++))>>4,s=(15&n)<<2|(i=e.charCodeAt(c++))>>6,l=63&i,isNaN(n)?s=l=64:isNaN(i)&&(l=64),t+=IH.charAt(o)+IH.charAt(a)+IH.charAt(s)+IH.charAt(l);return t}function NH(e){var t="",r=0,n=0,i=0,o=0,a=0,s=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var l=0;l<e.length;)r=IH.indexOf(e.charAt(l++))<<2|(o=IH.indexOf(e.charAt(l++)))>>4,t+=String.fromCharCode(r),n=(15&o)<<4|(a=IH.indexOf(e.charAt(l++)))>>2,64!==a&&(t+=String.fromCharCode(n)),i=(3&a)<<6|(s=IH.indexOf(e.charAt(l++))),64!==s&&(t+=String.fromCharCode(i));return t}var DH=function(){return"undefined"!==typeof Buffer&&"undefined"!==typeof process&&"undefined"!==typeof process.versions&&!!process.versions.node}(),FH=function(){if("undefined"!==typeof Buffer){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch(oJ){e=!0}return e?function(e,t){return t?new Buffer(e,t):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function LH(e){return DH?Buffer.alloc?Buffer.alloc(e):new Buffer(e):"undefined"!=typeof Uint8Array?new Uint8Array(e):new Array(e)}function HH(e){return DH?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):"undefined"!=typeof Uint8Array?new Uint8Array(e):new Array(e)}var BH=function(e){return DH?FH(e,"binary"):e.split("").map((function(e){return 255&e.charCodeAt(0)}))};function UH(e){if("undefined"===typeof ArrayBuffer)return BH(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=255&e.charCodeAt(n);return t}function jH(e){if(Array.isArray(e))return e.map((function(e){return String.fromCharCode(e)})).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function WH(e){if("undefined"==typeof ArrayBuffer)throw new Error("Unsupported");if(e instanceof ArrayBuffer)return WH(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var VH=DH?function(e){return Buffer.concat(e.map((function(e){return Buffer.isBuffer(e)?e:FH(e)})))}:function(e){if("undefined"!==typeof Uint8Array){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),i=0;for(t=0,r=0;t<e.length;r+=i,++t)if(i=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if("string"==typeof e[t])throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map((function(e){return Array.isArray(e)?e:[].slice.call(e)})))};var zH=/\u0000/g,qH=/[\u0001-\u0006]/g;function GH(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function $H(e,t){var r=""+e;return r.length>=t?r:sU("0",t-r.length)+r}function KH(e,t){var r=""+e;return r.length>=t?r:sU(" ",t-r.length)+r}function YH(e,t){var r=""+e;return r.length>=t?r:r+sU(" ",t-r.length)}var XH=Math.pow(2,32);function JH(e,t){return e>XH||e<-XH?function(e,t){var r=""+Math.round(e);return r.length>=t?r:sU("0",t-r.length)+r}(e,t):function(e,t){var r=""+e;return r.length>=t?r:sU("0",t-r.length)+r}(Math.round(e),t)}function ZH(e,t){return t=t||0,e.length>=7+t&&103===(32|e.charCodeAt(t))&&101===(32|e.charCodeAt(t+1))&&110===(32|e.charCodeAt(t+2))&&101===(32|e.charCodeAt(t+3))&&114===(32|e.charCodeAt(t+4))&&97===(32|e.charCodeAt(t+5))&&108===(32|e.charCodeAt(t+6))}var QH=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],eB=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];var tB={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"\u4e0a\u5348/\u4e0b\u5348 "hh"\u6642"mm"\u5206"ss"\u79d2 "'},rB={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},nB={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function iB(e,t,r){for(var n=e<0?-1:1,i=e*n,o=0,a=1,s=0,l=1,c=0,u=0,h=Math.floor(i);c<t&&(s=(h=Math.floor(i))*a+o,u=h*c+l,!(i-h<5e-8));)i=1/(i-h),o=a,a=s,l=c,c=u;if(u>t&&(c>t?(u=l,s=o):(u=c,s=a)),!r)return[0,n*s,u];var d=Math.floor(n*s/u);return[d,n*s-d*u,u]}function oB(e,t,r){if(e>2958465||e<0)return null;var n=0|e,i=Math.floor(86400*(e-n)),o=0,a=[],s={D:n,T:i,u:86400*(e-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(s.u)<1e-6&&(s.u=0),t&&t.date1904&&(n+=1462),s.u>.9999&&(s.u=0,86400==++i&&(s.T=i=0,++n,++s.D)),60===n)a=r?[1317,10,29]:[1900,2,29],o=3;else if(0===n)a=r?[1317,8,29]:[1900,1,0],o=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),a=[l.getFullYear(),l.getMonth()+1,l.getDate()],o=l.getDay(),n<60&&(o=(o+6)%7),r&&(o=function(e,t){t[0]-=581;var r=e.getDay();e<60&&(r=(r+6)%7);return r}(l,a))}return s.y=a[0],s.m=a[1],s.d=a[2],s.S=i%60,i=Math.floor(i/60),s.M=i%60,i=Math.floor(i/60),s.H=i,s.q=o,s}var aB=new Date(1899,11,31,0,0,0),sB=aB.getTime(),lB=new Date(1900,2,1,0,0,0);function cB(e,t){var r=e.getTime();return t?r-=1262304e5:e>=lB&&(r+=864e5),(r-(sB+6e4*(e.getTimezoneOffset()-aB.getTimezoneOffset())))/864e5}function uB(e){return-1==e.indexOf(".")?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function hB(e){var t,r=Math.floor(Math.log(Math.abs(e))*Math.LOG10E);return t=r>=-4&&r<=-1?e.toPrecision(10+r):Math.abs(r)<=9?function(e){var t=e<0?12:11,r=uB(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10)).length<=t?r:e.toExponential(5)}(e):10===r?e.toFixed(10).substr(0,12):function(e){var t=uB(e.toFixed(11));return t.length>(e<0?12:11)||"0"===t||"-0"===t?e.toPrecision(6):t}(e),uB(function(e){return-1==e.indexOf("E")?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}(t.toUpperCase()))}function dB(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(0|e)===e?e.toString(10):hB(e);case"undefined":return"";case"object":if(null==e)return"";if(e instanceof Date)return PB(14,cB(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function fB(e,t,r,n){var i,o="",a=0,s=0,l=r.y,c=0;switch(e){case 98:l=r.y+543;case 121:switch(t.length){case 1:case 2:i=l%100,c=2;break;default:i=l%1e4,c=4}break;case 109:switch(t.length){case 1:case 2:i=r.m,c=t.length;break;case 3:return eB[r.m-1][1];case 5:return eB[r.m-1][0];default:return eB[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:i=r.d,c=t.length;break;case 3:return QH[r.q][0];default:return QH[r.q][1]}break;case 104:switch(t.length){case 1:case 2:i=1+(r.H+11)%12,c=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:i=r.H,c=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:i=r.M,c=t.length;break;default:throw"bad minute format: "+t}break;case 115:if("s"!=t&&"ss"!=t&&".0"!=t&&".00"!=t&&".000"!=t)throw"bad second format: "+t;return 0!==r.u||"s"!=t&&"ss"!=t?(s=n>=2?3===n?1e3:100:1===n?10:1,(a=Math.round(s*(r.S+r.u)))>=60*s&&(a=0),"s"===t?0===a?"0":""+a/s:(o=$H(a,2+n),"ss"===t?o.substr(0,2):"."+o.substr(2,t.length-1))):$H(r.S,t.length);case 90:switch(t){case"[h]":case"[hh]":i=24*r.D+r.H;break;case"[m]":case"[mm]":i=60*(24*r.D+r.H)+r.M;break;case"[s]":case"[ss]":i=60*(60*(24*r.D+r.H)+r.M)+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}c=3===t.length?1:2;break;case 101:i=l,c=1}return c>0?$H(i,c):""}function gB(e){if(e.length<=3)return e;for(var t=e.length%3,r=e.substr(0,t);t!=e.length;t+=3)r+=(r.length>0?",":"")+e.substr(t,3);return r}var pB=/%/g;function mB(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(0==t)return"0.0E+0";if(t<0)return"-"+mB(e,-t);var i=e.indexOf(".");-1===i&&(i=e.indexOf("E"));var o=Math.floor(Math.log(t)*Math.LOG10E)%i;if(o<0&&(o+=i),-1===(r=(t/Math.pow(10,o)).toPrecision(n+1+(i+o)%i)).indexOf("e")){var a=Math.floor(Math.log(t)*Math.LOG10E);for(-1===r.indexOf(".")?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+o):r+="E+"+(a-o);"0."===r.substr(0,2);)r=(r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i)).replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,(function(e,t,r,n){return t+r+n.substr(0,(i+o)%i)+"."+n.substr(o)+"E"}))}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var vB=/# (\?+)( ?)\/( ?)(\d+)/;var bB=/^#*0*\.([0#]+)/,yB=/\).*[0#]/,wB=/\(###\) ###\\?-####/;function SB(e){for(var t,r="",n=0;n!=e.length;++n)switch(t=e.charCodeAt(n)){case 35:break;case 63:r+=" ";break;case 48:r+="0";break;default:r+=String.fromCharCode(t)}return r}function CB(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function kB(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function xB(e,t,r){if(40===e.charCodeAt(0)&&!t.match(yB)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?xB("n",n,r):"("+xB("n",n,-r)+")"}if(44===t.charCodeAt(t.length-1))return function(e,t,r){for(var n=t.length-1;44===t.charCodeAt(n-1);)--n;return _B(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}(e,t,r);if(-1!==t.indexOf("%"))return function(e,t,r){var n=t.replace(pB,""),i=t.length-n.length;return _B(e,n,r*Math.pow(10,2*i))+sU("%",i)}(e,t,r);if(-1!==t.indexOf("E"))return mB(t,r);if(36===t.charCodeAt(0))return"$"+xB(e,t.substr(" "==t.charAt(1)?2:1),r);var i,o,a,s,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+JH(l,t.length);if(t.match(/^[#?]+$/))return"0"===(i=JH(r,0))&&(i=""),i.length>t.length?i:SB(t.substr(0,t.length-i.length))+i;if(o=t.match(vB))return function(e,t,r){var n=parseInt(e[4],10),i=Math.round(t*n),o=Math.floor(i/n),a=i-o*n,s=n;return r+(0===o?"":""+o)+" "+(0===a?sU(" ",e[1].length+1+e[4].length):KH(a,e[1].length)+e[2]+"/"+e[3]+$H(s,e[4].length))}(o,l,c);if(t.match(/^#+0+$/))return c+JH(l,t.length-t.indexOf("0"));if(o=t.match(bB))return i=CB(r,o[1].length).replace(/^([^\.]+)$/,"$1."+SB(o[1])).replace(/\.$/,"."+SB(o[1])).replace(/\.(\d*)$/,(function(e,t){return"."+t+sU("0",SB(o[1]).length-t.length)})),-1!==t.indexOf("0.")?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),o=t.match(/^(0*)\.(#*)$/))return c+CB(l,o[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=t.match(/^#{1,3},##0(\.?)$/))return c+gB(JH(l,0));if(o=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+xB(e,t,-r):gB(""+(Math.floor(r)+function(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}(r,o[1].length)))+"."+$H(kB(r,o[1].length),o[1].length);if(o=t.match(/^#,#*,#0/))return xB(e,t.replace(/^#,#*,/,""),r);if(o=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=GH(xB(e,t.replace(/[\\-]/g,""),r)),a=0,GH(GH(t.replace(/\\/g,"")).replace(/[0#]/g,(function(e){return a<i.length?i.charAt(a++):"0"===e?"0":""})));if(t.match(wB))return"("+(i=xB(e,"##########",r)).substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var u="";if(o=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(o[4].length,7),s=iB(l,Math.pow(10,a)-1,!1),i=""+c," "==(u=_B("n",o[1],s[1])).charAt(u.length-1)&&(u=u.substr(0,u.length-1)+"0"),i+=u+o[2]+"/"+o[3],(u=YH(s[2],a)).length<o[4].length&&(u=SB(o[4].substr(o[4].length-u.length))+u),i+=u;if(o=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(o[1].length,o[4].length),7),c+((s=iB(l,Math.pow(10,a)-1,!0))[0]||(s[1]?"":"0"))+" "+(s[1]?KH(s[1],a)+o[2]+"/"+o[3]+YH(s[2],a):sU(" ",2*a+1+o[2].length+o[3].length));if(o=t.match(/^[#0?]+$/))return i=JH(r,0),t.length<=i.length?i:SB(t.substr(0,t.length-i.length))+i;if(o=t.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var h=t.indexOf(".")-a,d=t.length-i.length-h;return SB(t.substr(0,h)+i+t.substr(t.length-d))}if(o=t.match(/^00,000\.([#0]*0)$/))return a=kB(r,o[1].length),r<0?"-"+xB(e,t,-r):gB(function(e){return e<2147483647&&e>-2147483648?""+(e>=0?0|e:e-1|0):""+Math.floor(e)}(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,(function(e){return"00,"+(e.length<3?$H(0,3-e.length):"")+e}))+"."+$H(a,o[1].length);switch(t){case"###,##0.00":return xB(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var f=gB(JH(l,0));return"0"!==f?c+f:"";case"###,###.00":return xB(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return xB(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function EB(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(0==t)return"0.0E+0";if(t<0)return"-"+EB(e,-t);var i=e.indexOf(".");-1===i&&(i=e.indexOf("E"));var o=Math.floor(Math.log(t)*Math.LOG10E)%i;if(o<0&&(o+=i),!(r=(t/Math.pow(10,o)).toPrecision(n+1+(i+o)%i)).match(/[Ee]/)){var a=Math.floor(Math.log(t)*Math.LOG10E);-1===r.indexOf(".")?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+o):r+="E+"+(a-o),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,(function(e,t,r,n){return t+r+n.substr(0,(i+o)%i)+"."+n.substr(o)+"E"}))}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function TB(e,t,r){if(40===e.charCodeAt(0)&&!t.match(yB)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?TB("n",n,r):"("+TB("n",n,-r)+")"}if(44===t.charCodeAt(t.length-1))return function(e,t,r){for(var n=t.length-1;44===t.charCodeAt(n-1);)--n;return _B(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}(e,t,r);if(-1!==t.indexOf("%"))return function(e,t,r){var n=t.replace(pB,""),i=t.length-n.length;return _B(e,n,r*Math.pow(10,2*i))+sU("%",i)}(e,t,r);if(-1!==t.indexOf("E"))return EB(t,r);if(36===t.charCodeAt(0))return"$"+TB(e,t.substr(" "==t.charAt(1)?2:1),r);var i,o,a,s,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+$H(l,t.length);if(t.match(/^[#?]+$/))return i=""+r,0===r&&(i=""),i.length>t.length?i:SB(t.substr(0,t.length-i.length))+i;if(o=t.match(vB))return function(e,t,r){return r+(0===t?"":""+t)+sU(" ",e[1].length+2+e[4].length)}(o,l,c);if(t.match(/^#+0+$/))return c+$H(l,t.length-t.indexOf("0"));if(o=t.match(bB))return i=(i=(""+r).replace(/^([^\.]+)$/,"$1."+SB(o[1])).replace(/\.$/,"."+SB(o[1]))).replace(/\.(\d*)$/,(function(e,t){return"."+t+sU("0",SB(o[1]).length-t.length)})),-1!==t.indexOf("0.")?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),o=t.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=t.match(/^#{1,3},##0(\.?)$/))return c+gB(""+l);if(o=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+TB(e,t,-r):gB(""+r)+"."+sU("0",o[1].length);if(o=t.match(/^#,#*,#0/))return TB(e,t.replace(/^#,#*,/,""),r);if(o=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=GH(TB(e,t.replace(/[\\-]/g,""),r)),a=0,GH(GH(t.replace(/\\/g,"")).replace(/[0#]/g,(function(e){return a<i.length?i.charAt(a++):"0"===e?"0":""})));if(t.match(wB))return"("+(i=TB(e,"##########",r)).substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var u="";if(o=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(o[4].length,7),s=iB(l,Math.pow(10,a)-1,!1),i=""+c," "==(u=_B("n",o[1],s[1])).charAt(u.length-1)&&(u=u.substr(0,u.length-1)+"0"),i+=u+o[2]+"/"+o[3],(u=YH(s[2],a)).length<o[4].length&&(u=SB(o[4].substr(o[4].length-u.length))+u),i+=u;if(o=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(o[1].length,o[4].length),7),c+((s=iB(l,Math.pow(10,a)-1,!0))[0]||(s[1]?"":"0"))+" "+(s[1]?KH(s[1],a)+o[2]+"/"+o[3]+YH(s[2],a):sU(" ",2*a+1+o[2].length+o[3].length));if(o=t.match(/^[#0?]+$/))return i=""+r,t.length<=i.length?i:SB(t.substr(0,t.length-i.length))+i;if(o=t.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var h=t.indexOf(".")-a,d=t.length-i.length-h;return SB(t.substr(0,h)+i+t.substr(t.length-d))}if(o=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+TB(e,t,-r):gB(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,(function(e){return"00,"+(e.length<3?$H(0,3-e.length):"")+e}))+"."+$H(0,o[1].length);switch(t){case"###,###":case"##,###":case"#,###":var f=gB(""+l);return"0"!==f?c+f:"";default:if(t.match(/\.[0#?]*$/))return TB(e,t.slice(0,t.lastIndexOf(".")),r)+SB(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function _B(e,t,r){return(0|r)===r?TB(e,t,r):xB(e,t,r)}var AB=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function RB(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":ZH(e,t)&&(t+=6),t++;break;case'"':for(;34!==e.charCodeAt(++t)&&t<e.length;);++t;break;case"\\":case"_":t+=2;break;case"@":++t;break;case"B":case"b":if("1"===e.charAt(t+1)||"2"===e.charAt(t+1))return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"\u4e0a":if("A/P"===e.substr(t,3).toUpperCase())return!0;if("AM/PM"===e.substr(t,5).toUpperCase())return!0;if("\u4e0a\u5348/\u4e0b\u5348"===e.substr(t,5).toUpperCase())return!0;++t;break;case"[":for(n=r;"]"!==e.charAt(t++)&&t<e.length;)n+=e.charAt(t);if(n.match(AB))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||"\\"==r&&"-"==e.charAt(t+1)&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t," "!=e.charAt(t)&&"*"!=e.charAt(t)||++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;default:++t}return!1}var OB=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function MB(e,t){if(null==t)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0}return!1}function IB(e,t){var r=function(e){for(var t=[],r=!1,n=0,i=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(i,n-i),i=n+1}if(t[t.length]=e.substr(i),!0===r)throw new Error("Format |"+e+"| unterminated string ");return t}(e),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if("number"!==typeof t)return[4,4===r.length||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"]}var o=t>0?r[0]:t<0?r[1]:r[2];if(-1===r[0].indexOf("[")&&-1===r[1].indexOf("["))return[n,o];if(null!=r[0].match(/\[[=<>]/)||null!=r[1].match(/\[[=<>]/)){var a=r[0].match(OB),s=r[1].match(OB);return MB(t,a)?[n,r[0]]:MB(t,s)?[n,r[1]]:[n,r[null!=a&&null!=s?2:1]]}return[n,o]}function PB(e,t,r){null==r&&(r={});var n="";switch(typeof e){case"string":n="m/d/yy"==e&&r.dateNF?r.dateNF:e;break;case"number":null==(n=14==e&&r.dateNF?r.dateNF:(null!=r.table?r.table:tB)[e])&&(n=r.table&&r.table[rB[e]]||tB[rB[e]]),null==n&&(n=nB[e]||"General")}if(ZH(n,0))return dB(t,r);t instanceof Date&&(t=cB(t,r.date1904));var i=IB(n,t);if(ZH(i[1]))return dB(t,r);if(!0===t)t="TRUE";else if(!1===t)t="FALSE";else if(""===t||null==t)return"";return function(e,t,r,n){for(var i,o,a,s=[],l="",c=0,u="",h="t",d="H";c<e.length;)switch(u=e.charAt(c)){case"G":if(!ZH(e,c))throw new Error("unrecognized character "+u+" in "+e);s[s.length]={t:"G",v:"General"},c+=7;break;case'"':for(l="";34!==(a=e.charCodeAt(++c))&&c<e.length;)l+=String.fromCharCode(a);s[s.length]={t:"t",v:l},++c;break;case"\\":var f=e.charAt(++c),g="("===f||")"===f?f:"t";s[s.length]={t:g,v:f},++c;break;case"_":s[s.length]={t:"t",v:" "},c+=2;break;case"@":s[s.length]={t:"T",v:t},++c;break;case"B":case"b":if("1"===e.charAt(c+1)||"2"===e.charAt(c+1)){if(null==i&&null==(i=oB(t,r,"2"===e.charAt(c+1))))return"";s[s.length]={t:"X",v:e.substr(c,2)},h=u,c+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":u=u.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0)return"";if(null==i&&null==(i=oB(t,r)))return"";for(l=u;++c<e.length&&e.charAt(c).toLowerCase()===u;)l+=u;"m"===u&&"h"===h.toLowerCase()&&(u="M"),"h"===u&&(u=d),s[s.length]={t:u,v:l},h=u;break;case"A":case"a":case"\u4e0a":var p={t:u,v:u};if(null==i&&(i=oB(t,r)),"A/P"===e.substr(c,3).toUpperCase()?(null!=i&&(p.v=i.H>=12?"P":"A"),p.t="T",d="h",c+=3):"AM/PM"===e.substr(c,5).toUpperCase()?(null!=i&&(p.v=i.H>=12?"PM":"AM"),p.t="T",c+=5,d="h"):"\u4e0a\u5348/\u4e0b\u5348"===e.substr(c,5).toUpperCase()?(null!=i&&(p.v=i.H>=12?"\u4e0b\u5348":"\u4e0a\u5348"),p.t="T",c+=5,d="h"):(p.t="t",++c),null==i&&"T"===p.t)return"";s[s.length]=p,h=u;break;case"[":for(l=u;"]"!==e.charAt(c++)&&c<e.length;)l+=e.charAt(c);if("]"!==l.slice(-1))throw'unterminated "[" block: |'+l+"|";if(l.match(AB)){if(null==i&&null==(i=oB(t,r)))return"";s[s.length]={t:"Z",v:l.toLowerCase()},h=l.charAt(1)}else l.indexOf("$")>-1&&(l=(l.match(/\$([^-\[\]]*)/)||[])[1]||"$",RB(e)||(s[s.length]={t:"t",v:l}));break;case".":if(null!=i){for(l=u;++c<e.length&&"0"===(u=e.charAt(c));)l+=u;s[s.length]={t:"s",v:l};break}case"0":case"#":for(l=u;++c<e.length&&"0#?.,E+-%".indexOf(u=e.charAt(c))>-1;)l+=u;s[s.length]={t:"n",v:l};break;case"?":for(l=u;e.charAt(++c)===u;)l+=u;s[s.length]={t:u,v:l},h=u;break;case"*":++c," "!=e.charAt(c)&&"*"!=e.charAt(c)||++c;break;case"(":case")":s[s.length]={t:1===n?"t":u,v:u},++c;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(l=u;c<e.length&&"0123456789".indexOf(e.charAt(++c))>-1;)l+=e.charAt(c);s[s.length]={t:"D",v:l};break;case" ":s[s.length]={t:u,v:u},++c;break;case"$":s[s.length]={t:"t",v:"$"},++c;break;default:if(-1===",$-+/():!^&'~{}<>=\u20acacfijklopqrtuvwxzP".indexOf(u))throw new Error("unrecognized character "+u+" in "+e);s[s.length]={t:"t",v:u},++c}var m,v=0,b=0;for(c=s.length-1,h="t";c>=0;--c)switch(s[c].t){case"h":case"H":s[c].t=d,h="h",v<1&&(v=1);break;case"s":(m=s[c].v.match(/\.0+$/))&&(b=Math.max(b,m[0].length-1)),v<3&&(v=3);case"d":case"y":case"M":case"e":h=s[c].t;break;case"m":"s"===h&&(s[c].t="M",v<2&&(v=2));break;case"X":break;case"Z":v<1&&s[c].v.match(/[Hh]/)&&(v=1),v<2&&s[c].v.match(/[Mm]/)&&(v=2),v<3&&s[c].v.match(/[Ss]/)&&(v=3)}switch(v){case 0:break;case 1:i.u>=.5&&(i.u=0,++i.S),i.S>=60&&(i.S=0,++i.M),i.M>=60&&(i.M=0,++i.H);break;case 2:i.u>=.5&&(i.u=0,++i.S),i.S>=60&&(i.S=0,++i.M)}var y,w="";for(c=0;c<s.length;++c)switch(s[c].t){case"t":case"T":case" ":case"D":break;case"X":s[c].v="",s[c].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[c].v=fB(s[c].t.charCodeAt(0),s[c].v,i,b),s[c].t="t";break;case"n":case"?":for(y=c+1;null!=s[y]&&("?"===(u=s[y].t)||"D"===u||(" "===u||"t"===u)&&null!=s[y+1]&&("?"===s[y+1].t||"t"===s[y+1].t&&"/"===s[y+1].v)||"("===s[c].t&&(" "===u||"n"===u||")"===u)||"t"===u&&("/"===s[y].v||" "===s[y].v&&null!=s[y+1]&&"?"==s[y+1].t));)s[c].v+=s[y].v,s[y]={v:"",t:";"},++y;w+=s[c].v,c=y-1;break;case"G":s[c].t="t",s[c].v=dB(t,r)}var S,C,k="";if(w.length>0){40==w.charCodeAt(0)?(S=t<0&&45===w.charCodeAt(0)?-t:t,C=_B("n",w,S)):(C=_B("n",w,S=t<0&&n>1?-t:t),S<0&&s[0]&&"t"==s[0].t&&(C=C.substr(1),s[0].v="-"+s[0].v)),y=C.length-1;var x=s.length;for(c=0;c<s.length;++c)if(null!=s[c]&&"t"!=s[c].t&&s[c].v.indexOf(".")>-1){x=c;break}var E=s.length;if(x===s.length&&-1===C.indexOf("E")){for(c=s.length-1;c>=0;--c)null!=s[c]&&-1!=="n?".indexOf(s[c].t)&&(y>=s[c].v.length-1?(y-=s[c].v.length,s[c].v=C.substr(y+1,s[c].v.length)):y<0?s[c].v="":(s[c].v=C.substr(0,y+1),y=-1),s[c].t="t",E=c);y>=0&&E<s.length&&(s[E].v=C.substr(0,y+1)+s[E].v)}else if(x!==s.length&&-1===C.indexOf("E")){for(y=C.indexOf(".")-1,c=x;c>=0;--c)if(null!=s[c]&&-1!=="n?".indexOf(s[c].t)){for(o=s[c].v.indexOf(".")>-1&&c===x?s[c].v.indexOf(".")-1:s[c].v.length-1,k=s[c].v.substr(o+1);o>=0;--o)y>=0&&("0"===s[c].v.charAt(o)||"#"===s[c].v.charAt(o))&&(k=C.charAt(y--)+k);s[c].v=k,s[c].t="t",E=c}for(y>=0&&E<s.length&&(s[E].v=C.substr(0,y+1)+s[E].v),y=C.indexOf(".")+1,c=x;c<s.length;++c)if(null!=s[c]&&(-1!=="n?(".indexOf(s[c].t)||c===x)){for(o=s[c].v.indexOf(".")>-1&&c===x?s[c].v.indexOf(".")+1:0,k=s[c].v.substr(0,o);o<s[c].v.length;++o)y<C.length&&(k+=C.charAt(y++));s[c].v=k,s[c].t="t",E=c}}}for(c=0;c<s.length;++c)null!=s[c]&&"n?".indexOf(s[c].t)>-1&&(S=n>1&&t<0&&c>0&&"-"===s[c-1].v?-t:t,s[c].v=_B(s[c].t,s[c].v,S),s[c].t="t");var T="";for(c=0;c!==s.length;++c)null!=s[c]&&(T+=s[c].v);return T}(i[1],t,r,i[0])}function NB(e,t){if("number"!=typeof t){t=+t||-1;for(var r=0;r<392;++r)if(void 0!=tB[r]){if(tB[r]==e){t=r;break}}else t<0&&(t=r);t<0&&(t=391)}return tB[t]=e,t}function DB(e){for(var t=0;392!=t;++t)void 0!==e[t]&&NB(e[t],t)}function FB(){tB=function(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"\u4e0a\u5348/\u4e0b\u5348 "hh"\u6642"mm"\u5206"ss"\u79d2 "',e}()}var LB={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},HB=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;var BB=function(){var e={};e.version="1.2.0";var t=function(){for(var e=0,t=new Array(256),r=0;256!=r;++r)e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=r)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1,t[r]=e;return"undefined"!==typeof Int32Array?new Int32Array(t):t}();var r=function(e){var t=0,r=0,n=0,i="undefined"!==typeof Int32Array?new Int32Array(4096):new Array(4096);for(n=0;256!=n;++n)i[n]=e[n];for(n=0;256!=n;++n)for(r=e[n],t=256+n;t<4096;t+=256)r=i[t]=r>>>8^e[255&r];var o=[];for(n=1;16!=n;++n)o[n-1]="undefined"!==typeof Int32Array?i.subarray(256*n,256*n+256):i.slice(256*n,256*n+256);return o}(t),n=r[0],i=r[1],o=r[2],a=r[3],s=r[4],l=r[5],c=r[6],u=r[7],h=r[8],d=r[9],f=r[10],g=r[11],p=r[12],m=r[13],v=r[14];return e.table=t,e.bstr=function(e,r){for(var n=~r,i=0,o=e.length;i<o;)n=n>>>8^t[255&(n^e.charCodeAt(i++))];return~n},e.buf=function(e,r){for(var b=~r,y=e.length-15,w=0;w<y;)b=v[e[w++]^255&b]^m[e[w++]^b>>8&255]^p[e[w++]^b>>16&255]^g[e[w++]^b>>>24]^f[e[w++]]^d[e[w++]]^h[e[w++]]^u[e[w++]]^c[e[w++]]^l[e[w++]]^s[e[w++]]^a[e[w++]]^o[e[w++]]^i[e[w++]]^n[e[w++]]^t[e[w++]];for(y+=15;w<y;)b=b>>>8^t[255&(b^e[w++])];return~b},e.str=function(e,r){for(var n=~r,i=0,o=e.length,a=0,s=0;i<o;)(a=e.charCodeAt(i++))<128?n=n>>>8^t[255&(n^a)]:a<2048?n=(n=n>>>8^t[255&(n^(192|a>>6&31))])>>>8^t[255&(n^(128|63&a))]:a>=55296&&a<57344?(a=64+(1023&a),s=1023&e.charCodeAt(i++),n=(n=(n=(n=n>>>8^t[255&(n^(240|a>>8&7))])>>>8^t[255&(n^(128|a>>2&63))])>>>8^t[255&(n^(128|s>>6&15|(3&a)<<4))])>>>8^t[255&(n^(128|63&s))]):n=(n=(n=n>>>8^t[255&(n^(224|a>>12&15))])>>>8^t[255&(n^(128|a>>6&63))])>>>8^t[255&(n^(128|63&a))];return~n},e}(),UB=function(){var e,t={};function r(e){if("/"==e.charAt(e.length-1))return-1===e.slice(0,-1).indexOf("/")?e:r(e.slice(0,-1));var t=e.lastIndexOf("/");return-1===t?e:e.slice(0,t+1)}function n(e){if("/"==e.charAt(e.length-1))return n(e.slice(0,-1));var t=e.lastIndexOf("/");return-1===t?e:e.slice(t+1)}function i(e,t){"string"===typeof t&&(t=new Date(t));var r=t.getHours();r=(r=r<<6|t.getMinutes())<<5|t.getSeconds()>>>1,e.write_shift(2,r);var n=t.getFullYear()-1980;n=(n=n<<4|t.getMonth()+1)<<5|t.getDate(),e.write_shift(2,n)}function o(e){qj(e,0);for(var t={},r=0;e.l<=e.length-4;){var n=e.read_shift(2),i=e.read_shift(2),o=e.l+i,a={};if(21589===n)1&(r=e.read_shift(1))&&(a.mtime=e.read_shift(4)),i>5&&(2&r&&(a.atime=e.read_shift(4)),4&r&&(a.ctime=e.read_shift(4))),a.mtime&&(a.mt=new Date(1e3*a.mtime));e.l=o,t[n]=a}return t}function a(){return e||(e={})}function s(e,t){if(80==e[0]&&75==e[1])return ne(e,t);if(109==(32|e[0])&&105==(32|e[1]))return function(e,t){if("mime-version:"!=C(e.slice(0,13)).toLowerCase())throw new Error("Unsupported MAD header");var r=t&&t.root||"",n=(DH&&Buffer.isBuffer(e)?e.toString("binary"):C(e)).split("\r\n"),i=0,o="";for(i=0;i<n.length;++i)if(o=n[i],/^Content-Location:/i.test(o)&&(o=o.slice(o.indexOf("file")),r||(r=o.slice(0,o.lastIndexOf("/")+1)),o.slice(0,r.length)!=r))for(;r.length>0&&(r=(r=r.slice(0,r.length-1)).slice(0,r.lastIndexOf("/")+1),o.slice(0,r.length)!=r););var a=(n[1]||"").match(/boundary="(.*?)"/);if(!a)throw new Error("MAD cannot find boundary");var s="--"+(a[1]||""),l=[],c=[],u={FileIndex:l,FullPaths:c};d(u);var h,f=0;for(i=0;i<n.length;++i){var g=n[i];g!==s&&g!==s+"--"||(f++&&ce(u,n.slice(h,i),r),h=i)}return u}(e,t);if(e.length<512)throw new Error("CFB file size "+e.length+" < 512");var r,n,i,o,a,s,f=512,g=[],p=e.slice(0,512);qj(p,0);var m=function(e){if(80==e[e.l]&&75==e[e.l+1])return[0,0];e.chk(b,"Header Signature: "),e.l+=16;var t=e.read_shift(2,"u");return[e.read_shift(2,"u"),t]}(p);switch(r=m[0]){case 3:f=512;break;case 4:f=4096;break;case 0:if(0==m[1])return ne(e,t);default:throw new Error("Major Version: Expected 3 or 4 saw "+r)}512!==f&&qj(p=e.slice(0,f),28);var y=e.slice(0,f);!function(e,t){var r=9;switch(e.l+=2,r=e.read_shift(2)){case 9:if(3!=t)throw new Error("Sector Shift: Expected 9 saw "+r);break;case 12:if(4!=t)throw new Error("Sector Shift: Expected 12 saw "+r);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+r)}e.chk("0600","Mini Sector Shift: "),e.chk("000000000000","Reserved: ")}(p,r);var w=p.read_shift(4,"i");if(3===r&&0!==w)throw new Error("# Directory Sectors: Expected 0 saw "+w);p.l+=4,o=p.read_shift(4,"i"),p.l+=4,p.chk("00100000","Mini Stream Cutoff Size: "),a=p.read_shift(4,"i"),n=p.read_shift(4,"i"),s=p.read_shift(4,"i"),i=p.read_shift(4,"i");for(var S=-1,k=0;k<109&&!((S=p.read_shift(4,"i"))<0);++k)g[k]=S;var x=function(e,t){for(var r=Math.ceil(e.length/t)-1,n=[],i=1;i<r;++i)n[i-1]=e.slice(i*t,(i+1)*t);return n[r-1]=e.slice(r*t),n}(e,f);c(s,i,x,f,g);var E=function(e,t,r,n){var i=e.length,o=[],a=[],s=[],l=[],c=n-1,u=0,h=0,d=0,f=0;for(u=0;u<i;++u)if(s=[],(d=u+t)>=i&&(d-=i),!a[d]){l=[];var g=[];for(h=d;h>=0;){g[h]=!0,a[h]=!0,s[s.length]=h,l.push(e[h]);var p=r[Math.floor(4*h/n)];if(n<4+(f=4*h&c))throw new Error("FAT boundary crossed: "+h+" 4 "+n);if(!e[p])break;if(g[h=Lj(e[p],f)])break}o[d]={nodes:s,data:dj([l])}}return o}(x,o,g,f);E[o].name="!Directory",n>0&&a!==v&&(E[a].name="!MiniFAT"),E[g[0]].name="!FAT",E.fat_addrs=g,E.ssz=f;var T=[],_=[],A=[];!function(e,t,r,n,i,o,a,s){for(var c,d=0,f=n.length?2:0,g=t[e].data,p=0,m=0;p<g.length;p+=128){var b=g.slice(p,p+128);qj(b,64),m=b.read_shift(2),c=gj(b,0,m-f),n.push(c);var y={name:c,type:b.read_shift(1),color:b.read_shift(1),L:b.read_shift(4,"i"),R:b.read_shift(4,"i"),C:b.read_shift(4,"i"),clsid:b.read_shift(16),state:b.read_shift(4,"i"),start:0,size:0};0!==b.read_shift(2)+b.read_shift(2)+b.read_shift(2)+b.read_shift(2)&&(y.ct=h(b,b.l-8)),0!==b.read_shift(2)+b.read_shift(2)+b.read_shift(2)+b.read_shift(2)&&(y.mt=h(b,b.l-8)),y.start=b.read_shift(4,"i"),y.size=b.read_shift(4,"i"),y.size<0&&y.start<0&&(y.size=y.type=0,y.start=v,y.name=""),5===y.type?(d=y.start,i>0&&d!==v&&(t[d].name="!StreamData")):y.size>=4096?(y.storage="fat",void 0===t[y.start]&&(t[y.start]=u(r,y.start,t.fat_addrs,t.ssz)),t[y.start].name=y.name,y.content=t[y.start].data.slice(0,y.size)):(y.storage="minifat",y.size<0?y.size=0:d!==v&&y.start!==v&&t[d]&&(y.content=l(y,t[d].data,(t[s]||{}).data))),y.content&&qj(y.content,0),o[c]=y,a.push(y)}}(o,E,x,T,n,{},_,a),function(e,t,r){for(var n=0,i=0,o=0,a=0,s=0,l=r.length,c=[],u=[];n<l;++n)c[n]=u[n]=n,t[n]=r[n];for(;s<u.length;++s)i=e[n=u[s]].L,o=e[n].R,a=e[n].C,c[n]===n&&(-1!==i&&c[i]!==i&&(c[n]=c[i]),-1!==o&&c[o]!==o&&(c[n]=c[o])),-1!==a&&(c[a]=n),-1!==i&&n!=c[n]&&(c[i]=c[n],u.lastIndexOf(i)<s&&u.push(i)),-1!==o&&n!=c[n]&&(c[o]=c[n],u.lastIndexOf(o)<s&&u.push(o));for(n=1;n<l;++n)c[n]===n&&(-1!==o&&c[o]!==o?c[n]=c[o]:-1!==i&&c[i]!==i&&(c[n]=c[i]));for(n=1;n<l;++n)if(0!==e[n].type){if((s=n)!=c[s])do{s=c[s],t[n]=t[s]+"/"+t[n]}while(0!==s&&-1!==c[s]&&s!=c[s]);c[n]=-1}for(t[0]+="/",n=1;n<l;++n)2!==e[n].type&&(t[n]+="/")}(_,A,T),T.shift();var R={FileIndex:_,FullPaths:A};return t&&t.raw&&(R.raw={header:y,sectors:x}),R}function l(e,t,r){for(var n=e.start,i=e.size,o=[],a=n;r&&i>0&&a>=0;)o.push(t.slice(a*m,a*m+m)),i-=m,a=Lj(r,4*a);return 0===o.length?$j(0):VH(o).slice(0,e.size)}function c(e,t,r,n,i){var o=v;if(e===v){if(0!==t)throw new Error("DIFAT chain shorter than expected")}else if(-1!==e){var a=r[e],s=(n>>>2)-1;if(!a)return;for(var l=0;l<s&&(o=Lj(a,4*l))!==v;++l)i.push(o);c(Lj(a,n-4),t-1,r,n,i)}}function u(e,t,r,n,i){var o=[],a=[];i||(i=[]);var s=n-1,l=0,c=0;for(l=t;l>=0;){i[l]=!0,o[o.length]=l,a.push(e[l]);var u=r[Math.floor(4*l/n)];if(n<4+(c=4*l&s))throw new Error("FAT boundary crossed: "+l+" 4 "+n);if(!e[u])break;l=Lj(e[u],c)}return{nodes:o,data:dj([a])}}function h(e,t){return new Date(1e3*(Fj(e,t+4)/1e7*Math.pow(2,32)+Fj(e,t)/1e7-11644473600))}function d(e,t){var r=t||{},n=r.root||"Root Entry";if(e.FullPaths||(e.FullPaths=[]),e.FileIndex||(e.FileIndex=[]),e.FullPaths.length!==e.FileIndex.length)throw new Error("inconsistent CFB structure");0===e.FullPaths.length&&(e.FullPaths[0]=n+"/",e.FileIndex[0]={name:n,type:5}),r.CLSID&&(e.FileIndex[0].clsid=r.CLSID),function(e){var t="\x01Sh33tJ5";if(UB.find(e,"/"+t))return;var r=$j(4);r[0]=55,r[1]=r[3]=50,r[2]=54,e.FileIndex.push({name:t,type:2,content:r,size:4,L:69,R:69,C:69}),e.FullPaths.push(e.FullPaths[0]+t),f(e)}(e)}function f(e,t){d(e);for(var i=!1,o=!1,a=e.FullPaths.length-1;a>=0;--a){var s=e.FileIndex[a];switch(s.type){case 0:o?i=!0:(e.FileIndex.pop(),e.FullPaths.pop());break;case 1:case 2:case 5:o=!0,isNaN(s.R*s.L*s.C)&&(i=!0),s.R>-1&&s.L>-1&&s.R==s.L&&(i=!0);break;default:i=!0}}if(i||t){var l=new Date(1987,1,19),c=0,u=Object.create?Object.create(null):{},h=[];for(a=0;a<e.FullPaths.length;++a)u[e.FullPaths[a]]=!0,0!==e.FileIndex[a].type&&h.push([e.FullPaths[a],e.FileIndex[a]]);for(a=0;a<h.length;++a){var f=r(h[a][0]);(o=u[f])||(h.push([f,{name:n(f).replace("/",""),type:1,clsid:w,ct:l,mt:l,content:null}]),u[f]=!0)}for(h.sort((function(e,t){return function(e,t){for(var r=e.split("/"),n=t.split("/"),i=0,o=0,a=Math.min(r.length,n.length);i<a;++i){if(o=r[i].length-n[i].length)return o;if(r[i]!=n[i])return r[i]<n[i]?-1:1}return r.length-n.length}(e[0],t[0])})),e.FullPaths=[],e.FileIndex=[],a=0;a<h.length;++a)e.FullPaths[a]=h[a][0],e.FileIndex[a]=h[a][1];for(a=0;a<h.length;++a){var g=e.FileIndex[a],p=e.FullPaths[a];if(g.name=n(p).replace("/",""),g.L=g.R=g.C=-(g.color=1),g.size=g.content?g.content.length:0,g.start=0,g.clsid=g.clsid||w,0===a)g.C=h.length>1?1:-1,g.size=0,g.type=5;else if("/"==p.slice(-1)){for(c=a+1;c<h.length&&r(e.FullPaths[c])!=p;++c);for(g.C=c>=h.length?-1:c,c=a+1;c<h.length&&r(e.FullPaths[c])!=r(p);++c);g.R=c>=h.length?-1:c,g.type=1}else r(e.FullPaths[a+1]||"")==r(p)&&(g.R=a+1),g.type=2}}}function g(e,t){var r=t||{};if("mad"==r.fileType)return function(e,t){for(var r=t||{},n=r.boundary||"SheetJS",i=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+(n="------="+n).slice(2)+'"',"","",""],o=e.FullPaths[0],a=o,s=e.FileIndex[0],l=1;l<e.FullPaths.length;++l)if(a=e.FullPaths[l].slice(o.length),(s=e.FileIndex[l]).size&&s.content&&"\x01Sh33tJ5"!=a){a=a.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,(function(e){return"_x"+e.charCodeAt(0).toString(16)+"_"})).replace(/[\u0080-\uFFFF]/g,(function(e){return"_u"+e.charCodeAt(0).toString(16)+"_"}));for(var c=s.content,u=DH&&Buffer.isBuffer(c)?c.toString("binary"):C(c),h=0,d=Math.min(1024,u.length),f=0,g=0;g<=d;++g)(f=u.charCodeAt(g))>=32&&f<128&&++h;var p=h>=4*d/5;i.push(n),i.push("Content-Location: "+(r.root||"file:///C:/SheetJS/")+a),i.push("Content-Transfer-Encoding: "+(p?"quoted-printable":"base64")),i.push("Content-Type: "+ae(s,a)),i.push(""),i.push(p?le(u):se(u))}return i.push(n+"--\r\n"),i.join("\r\n")}(e,r);if(f(e),"zip"===r.fileType)return function(e,t){var r=t||{},n=[],o=[],a=$j(1),s=r.compression?8:0,l=0;0;var c=0,u=0,h=0,d=0,f=e.FullPaths[0],g=f,p=e.FileIndex[0],m=[],v=0;for(c=1;c<e.FullPaths.length;++c)if(g=e.FullPaths[c].slice(f.length),(p=e.FileIndex[c]).size&&p.content&&"\x01Sh33tJ5"!=g){var b=h,y=$j(g.length);for(u=0;u<g.length;++u)y.write_shift(1,127&g.charCodeAt(u));y=y.slice(0,y.l),m[d]=BB.buf(p.content,0);var w=p.content;8==s&&(w=k(w)),(a=$j(30)).write_shift(4,67324752),a.write_shift(2,20),a.write_shift(2,l),a.write_shift(2,s),p.mt?i(a,p.mt):a.write_shift(4,0),a.write_shift(-4,8&l?0:m[d]),a.write_shift(4,8&l?0:w.length),a.write_shift(4,8&l?0:p.content.length),a.write_shift(2,y.length),a.write_shift(2,0),h+=a.length,n.push(a),h+=y.length,n.push(y),h+=w.length,n.push(w),8&l&&((a=$j(12)).write_shift(-4,m[d]),a.write_shift(4,w.length),a.write_shift(4,p.content.length),h+=a.l,n.push(a)),(a=$j(46)).write_shift(4,33639248),a.write_shift(2,0),a.write_shift(2,20),a.write_shift(2,l),a.write_shift(2,s),a.write_shift(4,0),a.write_shift(-4,m[d]),a.write_shift(4,w.length),a.write_shift(4,p.content.length),a.write_shift(2,y.length),a.write_shift(2,0),a.write_shift(2,0),a.write_shift(2,0),a.write_shift(2,0),a.write_shift(4,0),a.write_shift(4,b),v+=a.l,o.push(a),v+=y.length,o.push(y),++d}return a=$j(22),a.write_shift(4,101010256),a.write_shift(2,0),a.write_shift(2,0),a.write_shift(2,d),a.write_shift(2,d),a.write_shift(4,v),a.write_shift(4,h),a.write_shift(2,0),VH([VH(n),VH(o),a])}(e,r);var n=function(e){for(var t=0,r=0,n=0;n<e.FileIndex.length;++n){var i=e.FileIndex[n];if(i.content){var o=i.content.length;o>0&&(o<4096?t+=o+63>>6:r+=o+511>>9)}}for(var a=e.FullPaths.length+3>>2,s=t+127>>7,l=(t+7>>3)+r+a+s,c=l+127>>7,u=c<=109?0:Math.ceil((c-109)/127);l+c+u+127>>7>c;)u=++c<=109?0:Math.ceil((c-109)/127);var h=[1,u,c,s,a,r,t,0];return e.FileIndex[0].size=t<<6,h[7]=(e.FileIndex[0].start=h[0]+h[1]+h[2]+h[3]+h[4]+h[5])+(h[6]+7>>3),h}(e),o=$j(n[7]<<9),a=0,s=0;for(a=0;a<8;++a)o.write_shift(1,y[a]);for(a=0;a<8;++a)o.write_shift(2,0);for(o.write_shift(2,62),o.write_shift(2,3),o.write_shift(2,65534),o.write_shift(2,9),o.write_shift(2,6),a=0;a<3;++a)o.write_shift(2,0);for(o.write_shift(4,0),o.write_shift(4,n[2]),o.write_shift(4,n[0]+n[1]+n[2]+n[3]-1),o.write_shift(4,0),o.write_shift(4,4096),o.write_shift(4,n[3]?n[0]+n[1]+n[2]-1:v),o.write_shift(4,n[3]),o.write_shift(-4,n[1]?n[0]-1:v),o.write_shift(4,n[1]),a=0;a<109;++a)o.write_shift(-4,a<n[2]?n[1]+a:-1);if(n[1])for(s=0;s<n[1];++s){for(;a<236+127*s;++a)o.write_shift(-4,a<n[2]?n[1]+a:-1);o.write_shift(-4,s===n[1]-1?v:s+1)}var l=function(e){for(s+=e;a<s-1;++a)o.write_shift(-4,a+1);e&&(++a,o.write_shift(-4,v))};for(s=a=0,s+=n[1];a<s;++a)o.write_shift(-4,S.DIFSECT);for(s+=n[2];a<s;++a)o.write_shift(-4,S.FATSECT);l(n[3]),l(n[4]);for(var c=0,u=0,h=e.FileIndex[0];c<e.FileIndex.length;++c)(h=e.FileIndex[c]).content&&((u=h.content.length)<4096||(h.start=s,l(u+511>>9)));for(l(n[6]+7>>3);511&o.l;)o.write_shift(-4,S.ENDOFCHAIN);for(s=a=0,c=0;c<e.FileIndex.length;++c)(h=e.FileIndex[c]).content&&(!(u=h.content.length)||u>=4096||(h.start=s,l(u+63>>6)));for(;511&o.l;)o.write_shift(-4,S.ENDOFCHAIN);for(a=0;a<n[4]<<2;++a){var d=e.FullPaths[a];if(d&&0!==d.length){h=e.FileIndex[a],0===a&&(h.start=h.size?h.start-1:v);var g=0===a&&r.root||h.name;if(u=2*(g.length+1),o.write_shift(64,g,"utf16le"),o.write_shift(2,u),o.write_shift(1,h.type),o.write_shift(1,h.color),o.write_shift(-4,h.L),o.write_shift(-4,h.R),o.write_shift(-4,h.C),h.clsid)o.write_shift(16,h.clsid,"hex");else for(c=0;c<4;++c)o.write_shift(4,0);o.write_shift(4,h.state||0),o.write_shift(4,0),o.write_shift(4,0),o.write_shift(4,0),o.write_shift(4,0),o.write_shift(4,h.start),o.write_shift(4,h.size),o.write_shift(4,0)}else{for(c=0;c<17;++c)o.write_shift(4,0);for(c=0;c<3;++c)o.write_shift(4,-1);for(c=0;c<12;++c)o.write_shift(4,0)}}for(a=1;a<e.FileIndex.length;++a)if((h=e.FileIndex[a]).size>=4096)if(o.l=h.start+1<<9,DH&&Buffer.isBuffer(h.content))h.content.copy(o,o.l,0,h.size),o.l+=h.size+511&-512;else{for(c=0;c<h.size;++c)o.write_shift(1,h.content[c]);for(;511&c;++c)o.write_shift(1,0)}for(a=1;a<e.FileIndex.length;++a)if((h=e.FileIndex[a]).size>0&&h.size<4096)if(DH&&Buffer.isBuffer(h.content))h.content.copy(o,o.l,0,h.size),o.l+=h.size+63&-64;else{for(c=0;c<h.size;++c)o.write_shift(1,h.content[c]);for(;63&c;++c)o.write_shift(1,0)}if(DH)o.l=o.length;else for(;o.l<o.length;)o.write_shift(1,0);return o}t.version="1.2.1";var p,m=64,v=-2,b="d0cf11e0a1b11ae1",y=[208,207,17,224,161,177,26,225],w="00000000000000000000000000000000",S={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:v,FREESECT:-1,HEADER_SIGNATURE:b,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:w,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function C(e){for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function k(e){return p?p.deflateRawSync(e):K(e)}var x=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],E=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],T=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function _(e){var t=139536&(e<<1|e<<11)|558144&(e<<5|e<<15);return 255&(t>>16|t>>8|t)}for(var A="undefined"!==typeof Uint8Array,R=A?new Uint8Array(256):[],O=0;O<256;++O)R[O]=_(O);function M(e,t){var r=R[255&e];return t<=8?r>>>8-t:(r=r<<8|R[e>>8&255],t<=16?r>>>16-t:(r=r<<8|R[e>>16&255])>>>24-t)}function I(e,t){var r=7&t,n=t>>>3;return(e[n]|(r<=6?0:e[n+1]<<8))>>>r&3}function P(e,t){var r=7&t,n=t>>>3;return(e[n]|(r<=5?0:e[n+1]<<8))>>>r&7}function N(e,t){var r=7&t,n=t>>>3;return(e[n]|(r<=3?0:e[n+1]<<8))>>>r&31}function D(e,t){var r=7&t,n=t>>>3;return(e[n]|(r<=1?0:e[n+1]<<8))>>>r&127}function F(e,t,r){var n=7&t,i=t>>>3,o=(1<<r)-1,a=e[i]>>>n;return r<8-n?a&o:(a|=e[i+1]<<8-n,r<16-n?a&o:(a|=e[i+2]<<16-n,r<24-n?a&o:(a|=e[i+3]<<24-n)&o))}function L(e,t,r){var n=7&t,i=t>>>3;return n<=5?e[i]|=(7&r)<<n:(e[i]|=r<<n&255,e[i+1]=(7&r)>>8-n),t+3}function H(e,t,r){return r=(1&r)<<(7&t),e[t>>>3]|=r,t+1}function B(e,t,r){var n=t>>>3;return r<<=7&t,e[n]|=255&r,r>>>=8,e[n+1]=r,t+8}function U(e,t,r){var n=t>>>3;return r<<=7&t,e[n]|=255&r,r>>>=8,e[n+1]=255&r,e[n+2]=r>>>8,t+16}function j(e,t){var r=e.length,n=2*r>t?2*r:t+5,i=0;if(r>=t)return e;if(DH){var o=HH(n);if(e.copy)e.copy(o);else for(;i<e.length;++i)o[i]=e[i];return o}if(A){var a=new Uint8Array(n);if(a.set)a.set(e);else for(;i<r;++i)a[i]=e[i];return a}return e.length=n,e}function W(e){for(var t=new Array(e),r=0;r<e;++r)t[r]=0;return t}function V(e,t,r){var n=1,i=0,o=0,a=0,s=0,l=e.length,c=A?new Uint16Array(32):W(32);for(o=0;o<32;++o)c[o]=0;for(o=l;o<r;++o)e[o]=0;l=e.length;var u=A?new Uint16Array(l):W(l);for(o=0;o<l;++o)c[i=e[o]]++,n<i&&(n=i),u[o]=0;for(c[0]=0,o=1;o<=n;++o)c[o+16]=s=s+c[o-1]<<1;for(o=0;o<l;++o)0!=(s=e[o])&&(u[o]=c[s+16]++);var h=0;for(o=0;o<l;++o)if(0!=(h=e[o]))for(s=M(u[o],n)>>n-h,a=(1<<n+4-h)-1;a>=0;--a)t[s|a<<h]=15&h|o<<4;return n}var z=A?new Uint16Array(512):W(512),q=A?new Uint16Array(32):W(32);if(!A){for(var G=0;G<512;++G)z[G]=0;for(G=0;G<32;++G)q[G]=0}!function(){for(var e=[],t=0;t<32;t++)e.push(5);V(e,q,32);var r=[];for(t=0;t<=143;t++)r.push(8);for(;t<=255;t++)r.push(9);for(;t<=279;t++)r.push(7);for(;t<=287;t++)r.push(8);V(r,z,288)}();var $=function(){for(var e=A?new Uint8Array(32768):[],t=0,r=0;t<T.length-1;++t)for(;r<T[t+1];++r)e[r]=t;for(;r<32768;++r)e[r]=29;var n=A?new Uint8Array(259):[];for(t=0,r=0;t<E.length-1;++t)for(;r<E[t+1];++r)n[r]=t;return function(t,r){return t.length<8?function(e,t){for(var r=0;r<e.length;){var n=Math.min(65535,e.length-r),i=r+n==e.length;for(t.write_shift(1,+i),t.write_shift(2,n),t.write_shift(2,65535&~n);n-- >0;)t[t.l++]=e[r++]}return t.l}(t,r):function(t,r){for(var i=0,o=0,a=A?new Uint16Array(32768):[];o<t.length;){var s=Math.min(65535,t.length-o);if(s<10){for(7&(i=L(r,i,+!(o+s!=t.length)))&&(i+=8-(7&i)),r.l=i/8|0,r.write_shift(2,s),r.write_shift(2,65535&~s);s-- >0;)r[r.l++]=t[o++];i=8*r.l}else{i=L(r,i,+!(o+s!=t.length)+2);for(var l=0;s-- >0;){var c=t[o],u=-1,h=0;if((u=a[l=32767&(l<<5^c)])&&((u|=-32768&o)>o&&(u-=32768),u<o))for(;t[u+h]==t[o+h]&&h<250;)++h;if(h>2){(c=n[h])<=22?i=B(r,i,R[c+1]>>1)-1:(B(r,i,3),B(r,i+=5,R[c-23]>>5),i+=3);var d=c<8?0:c-4>>2;d>0&&(U(r,i,h-E[c]),i+=d),c=e[o-u],i=B(r,i,R[c]>>3),i-=3;var f=c<4?0:c-2>>1;f>0&&(U(r,i,o-u-T[c]),i+=f);for(var g=0;g<h;++g)a[l]=32767&o,l=32767&(l<<5^t[o]),++o;s-=h-1}else c<=143?c+=48:i=H(r,i,1),i=B(r,i,R[c]),a[l]=32767&o,++o}i=B(r,i,0)-1}}return r.l=(i+7)/8|0,r.l}(t,r)}}();function K(e){var t=$j(50+Math.floor(1.1*e.length)),r=$(e,t);return t.slice(0,r)}var Y=A?new Uint16Array(32768):W(32768),X=A?new Uint16Array(32768):W(32768),J=A?new Uint16Array(128):W(128),Z=1,Q=1;function ee(e,t){var r=N(e,t)+257,n=N(e,t+=5)+1,i=function(e,t){var r=7&t,n=t>>>3;return(e[n]|(r<=4?0:e[n+1]<<8))>>>r&15}(e,t+=5)+4;t+=4;for(var o=0,a=A?new Uint8Array(19):W(19),s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],l=1,c=A?new Uint8Array(8):W(8),u=A?new Uint8Array(8):W(8),h=a.length,d=0;d<i;++d)a[x[d]]=o=P(e,t),l<o&&(l=o),c[o]++,t+=3;var f=0;for(c[0]=0,d=1;d<=l;++d)u[d]=f=f+c[d-1]<<1;for(d=0;d<h;++d)0!=(f=a[d])&&(s[d]=u[f]++);var g=0;for(d=0;d<h;++d)if(0!=(g=a[d])){f=R[s[d]]>>8-g;for(var p=(1<<7-g)-1;p>=0;--p)J[f|p<<g]=7&g|d<<3}var m=[];for(l=1;m.length<r+n;)switch(t+=7&(f=J[D(e,t)]),f>>>=3){case 16:for(o=3+I(e,t),t+=2,f=m[m.length-1];o-- >0;)m.push(f);break;case 17:for(o=3+P(e,t),t+=3;o-- >0;)m.push(0);break;case 18:for(o=11+D(e,t),t+=7;o-- >0;)m.push(0);break;default:m.push(f),l<f&&(l=f)}var v=m.slice(0,r),b=m.slice(r);for(d=r;d<286;++d)v[d]=0;for(d=n;d<30;++d)b[d]=0;return Z=V(v,Y,286),Q=V(b,X,30),t}function te(e,t){var r=function(e,t){if(3==e[0]&&!(3&e[1]))return[LH(t),2];for(var r=0,n=0,i=HH(t||1<<18),o=0,a=i.length>>>0,s=0,l=0;0==(1&n);)if(n=P(e,r),r+=3,n>>>1!=0)for(n>>1==1?(s=9,l=5):(r=ee(e,r),s=Z,l=Q);;){!t&&a<o+32767&&(a=(i=j(i,o+32767)).length);var c=F(e,r,s),u=n>>>1==1?z[c]:Y[c];if(r+=15&u,0===((u>>>=4)>>>8&255))i[o++]=u;else{if(256==u)break;var h=(u-=257)<8?0:u-4>>2;h>5&&(h=0);var d=o+E[u];h>0&&(d+=F(e,r,h),r+=h),c=F(e,r,l),r+=15&(u=n>>>1==1?q[c]:X[c]);var f=(u>>>=4)<4?0:u-2>>1,g=T[u];for(f>0&&(g+=F(e,r,f),r+=f),!t&&a<d&&(a=(i=j(i,d+100)).length);o<d;)i[o]=i[o-g],++o}}else{7&r&&(r+=8-(7&r));var p=e[r>>>3]|e[1+(r>>>3)]<<8;if(r+=32,p>0)for(!t&&a<o+p&&(a=(i=j(i,o+p)).length);p-- >0;)i[o++]=e[r>>>3],r+=8}return t?[i,r+7>>>3]:[i.slice(0,o),r+7>>>3]}(e.slice(e.l||0),t);return e.l+=r[1],r[0]}function re(e,t){if(!e)throw new Error(t);"undefined"!==typeof console&&console.error(t)}function ne(e,t){var r=e;qj(r,0);var n={FileIndex:[],FullPaths:[]};d(n,{root:t.root});for(var i=r.length-4;(80!=r[i]||75!=r[i+1]||5!=r[i+2]||6!=r[i+3])&&i>=0;)--i;r.l=i+4,r.l+=4;var a=r.read_shift(2);r.l+=6;var s=r.read_shift(4);for(r.l=s,i=0;i<a;++i){r.l+=20;var l=r.read_shift(4),c=r.read_shift(4),u=r.read_shift(2),h=r.read_shift(2),f=r.read_shift(2);r.l+=8;var g=r.read_shift(4),p=o(r.slice(r.l+u,r.l+u+h));r.l+=u+h+f;var m=r.l;r.l=g+4,ie(r,l,c,n,p),r.l=m}return n}function ie(e,t,r,n,i){e.l+=2;var a=e.read_shift(2),s=e.read_shift(2),l=function(e){var t=65535&e.read_shift(2),r=65535&e.read_shift(2),n=new Date,i=31&r,o=15&(r>>>=5);r>>>=4,n.setMilliseconds(0),n.setFullYear(r+1980),n.setMonth(o-1),n.setDate(i);var a=31&t,s=63&(t>>>=5);return t>>>=6,n.setHours(t),n.setMinutes(s),n.setSeconds(a<<1),n}(e);if(8257&a)throw new Error("Unsupported ZIP encryption");e.read_shift(4);for(var c=e.read_shift(4),u=e.read_shift(4),h=e.read_shift(2),d=e.read_shift(2),f="",g=0;g<h;++g)f+=String.fromCharCode(e[e.l++]);if(d){var m=o(e.slice(e.l,e.l+d));(m[21589]||{}).mt&&(l=m[21589].mt),((i||{})[21589]||{}).mt&&(l=i[21589].mt)}e.l+=d;var v=e.slice(e.l,e.l+c);switch(s){case 8:v=function(e,t){if(!p)return te(e,t);var r=new(0,p.InflateRaw),n=r._processChunk(e.slice(e.l),r._finishFlushFlag);return e.l+=r.bytesRead,n}(e,u);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+s)}var b=!1;8&a&&(134695760==e.read_shift(4)&&(e.read_shift(4),b=!0),c=e.read_shift(4),u=e.read_shift(4)),c!=t&&re(b,"Bad compressed size: "+t+" != "+c),u!=r&&re(b,"Bad uncompressed size: "+r+" != "+u),ue(n,f,v,{unsafe:!0,mt:l})}var oe={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function ae(e,t){if(e.ctype)return e.ctype;var r=e.name||"",n=r.match(/\.([^\.]+)$/);return n&&oe[n[1]]||t&&(n=(r=t).match(/[\.\\]([^\.\\])+$/))&&oe[n[1]]?oe[n[1]]:"application/octet-stream"}function se(e){for(var t=PH(e),r=[],n=0;n<t.length;n+=76)r.push(t.slice(n,n+76));return r.join("\r\n")+"\r\n"}function le(e){var t=e.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,(function(e){var t=e.charCodeAt(0).toString(16).toUpperCase();return"="+(1==t.length?"0"+t:t)}));"\n"==(t=t.replace(/ $/gm,"=20").replace(/\t$/gm,"=09")).charAt(0)&&(t="=0D"+t.slice(1));for(var r=[],n=(t=t.replace(/\r(?!\n)/gm,"=0D").replace(/\n\n/gm,"\n=0A").replace(/([^\r\n])\n/gm,"$1=0A")).split("\r\n"),i=0;i<n.length;++i){var o=n[i];if(0!=o.length)for(var a=0;a<o.length;){var s=76,l=o.slice(a,a+s);"="==l.charAt(s-1)?s--:"="==l.charAt(s-2)?s-=2:"="==l.charAt(s-3)&&(s-=3),l=o.slice(a,a+s),(a+=s)<o.length&&(l+="="),r.push(l)}else r.push("")}return r.join("\r\n")}function ce(e,t,r){for(var n,i="",o="",a="",s=0;s<10;++s){var l=t[s];if(!l||l.match(/^\s*$/))break;var c=l.match(/^(.*?):\s*([^\s].*)$/);if(c)switch(c[1].toLowerCase()){case"content-location":i=c[2].trim();break;case"content-type":a=c[2].trim();break;case"content-transfer-encoding":o=c[2].trim()}}switch(++s,o.toLowerCase()){case"base64":n=BH(NH(t.slice(s).join("")));break;case"quoted-printable":n=function(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r];r<=e.length&&"="==n.charAt(n.length-1);)n=n.slice(0,n.length-1)+e[++r];t.push(n)}for(var i=0;i<t.length;++i)t[i]=t[i].replace(/[=][0-9A-Fa-f]{2}/g,(function(e){return String.fromCharCode(parseInt(e.slice(1),16))}));return BH(t.join("\r\n"))}(t.slice(s));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+o)}var u=ue(e,i.slice(r.length),n,{unsafe:!0});a&&(u.ctype=a)}function ue(e,t,r,i){var o=i&&i.unsafe;o||d(e);var a=!o&&UB.find(e,t);if(!a){var s=e.FullPaths[0];t.slice(0,s.length)==s?s=t:("/"!=s.slice(-1)&&(s+="/"),s=(s+t).replace("//","/")),a={name:n(t),type:2},e.FileIndex.push(a),e.FullPaths.push(s),o||UB.utils.cfb_gc(e)}return a.content=r,a.size=r?r.length:0,i&&(i.CLSID&&(a.clsid=i.CLSID),i.mt&&(a.mt=i.mt),i.ct&&(a.ct=i.ct)),a}return t.find=function(e,t){var r=e.FullPaths.map((function(e){return e.toUpperCase()})),n=r.map((function(e){var t=e.split("/");return t[t.length-("/"==e.slice(-1)?2:1)]})),i=!1;47===t.charCodeAt(0)?(i=!0,t=r[0].slice(0,-1)+t):i=-1!==t.indexOf("/");var o=t.toUpperCase(),a=!0===i?r.indexOf(o):n.indexOf(o);if(-1!==a)return e.FileIndex[a];var s=!o.match(qH);for(o=o.replace(zH,""),s&&(o=o.replace(qH,"!")),a=0;a<r.length;++a){if((s?r[a].replace(qH,"!"):r[a]).replace(zH,"")==o)return e.FileIndex[a];if((s?n[a].replace(qH,"!"):n[a]).replace(zH,"")==o)return e.FileIndex[a]}return null},t.read=function(t,r){var n=r&&r.type;switch(n||DH&&Buffer.isBuffer(t)&&(n="buffer"),n||"base64"){case"file":return function(t,r){return a(),s(e.readFileSync(t),r)}(t,r);case"base64":return s(BH(NH(t)),r);case"binary":return s(BH(t),r)}return s(t,r)},t.parse=s,t.write=function(t,r){var n=g(t,r);switch(r&&r.type||"buffer"){case"file":return a(),e.writeFileSync(r.filename,n),n;case"binary":return"string"==typeof n?n:C(n);case"base64":return PH("string"==typeof n?n:C(n));case"buffer":if(DH)return Buffer.isBuffer(n)?n:FH(n);case"array":return"string"==typeof n?BH(n):n}return n},t.writeFile=function(t,r,n){a();var i=g(t,n);e.writeFileSync(r,i)},t.utils={cfb_new:function(e){var t={};return d(t,e),t},cfb_add:ue,cfb_del:function(e,t){d(e);var r=UB.find(e,t);if(r)for(var n=0;n<e.FileIndex.length;++n)if(e.FileIndex[n]==r)return e.FileIndex.splice(n,1),e.FullPaths.splice(n,1),!0;return!1},cfb_mov:function(e,t,r){d(e);var i=UB.find(e,t);if(i)for(var o=0;o<e.FileIndex.length;++o)if(e.FileIndex[o]==i)return e.FileIndex[o].name=n(r),e.FullPaths[o]=r,!0;return!1},cfb_gc:function(e){f(e,!0)},ReadShift:Bj,CheckField:zj,prep_blob:qj,bconcat:VH,use_zlib:function(e){try{var t=new(0,e.InflateRaw);if(t._processChunk(new Uint8Array([3,0]),t._finishFlushFlag),!t.bytesRead)throw new Error("zlib does not expose bytesRead");p=e}catch(oJ){console.error("cannot use native zlib: "+(oJ.message||oJ))}},_deflateRaw:K,_inflateRaw:te,consts:S},t}();let jB;function WB(e){return"string"===typeof e?UH(e):Array.isArray(e)?function(e){if("undefined"===typeof Uint8Array)throw new Error("Unsupported");return new Uint8Array(e)}(e):e}function VB(e,t,r){if("undefined"!==typeof jB&&jB.writeFileSync)return r?jB.writeFileSync(e,t,r):jB.writeFileSync(e,t);if("undefined"!==typeof Deno){if(r&&"string"==typeof t)switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=UH(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n="utf8"==r?KU(t):t;if("undefined"!==typeof IE_SaveFile)return IE_SaveFile(n,e);if("undefined"!==typeof Blob){var i=new Blob([WB(n)],{type:"application/octet-stream"});if("undefined"!==typeof navigator&&navigator.msSaveBlob)return navigator.msSaveBlob(i,e);if("undefined"!==typeof saveAs)return saveAs(i,e);if("undefined"!==typeof URL&&"undefined"!==typeof document&&document.createElement&&URL.createObjectURL){var o=URL.createObjectURL(i);if("object"===typeof chrome&&"function"==typeof(chrome.downloads||{}).download)return URL.revokeObjectURL&&"undefined"!==typeof setTimeout&&setTimeout((function(){URL.revokeObjectURL(o)}),6e4),chrome.downloads.download({url:o,filename:e,saveAs:!0});var a=document.createElement("a");if(null!=a.download)return a.download=e,a.href=o,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL&&"undefined"!==typeof setTimeout&&setTimeout((function(){URL.revokeObjectURL(o)}),6e4),o}}if("undefined"!==typeof $&&"undefined"!==typeof File&&"undefined"!==typeof Folder)try{var s=File(e);return s.open("w"),s.encoding="binary",Array.isArray(t)&&(t=jH(t)),s.write(t),s.close(),t}catch(oJ){if(!oJ.message||!oJ.message.match(/onstruct/))throw oJ}throw new Error("cannot save file "+e)}function zB(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function qB(e,t){for(var r=[],n=zB(e),i=0;i!==n.length;++i)null==r[e[n[i]][t]]&&(r[e[n[i]][t]]=n[i]);return r}function GB(e){for(var t=[],r=zB(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function $B(e){for(var t=[],r=zB(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}var KB=new Date(1899,11,30,0,0,0);function YB(e,t){var r=e.getTime();return t&&(r-=1263168e5),(r-(KB.getTime()+6e4*(e.getTimezoneOffset()-KB.getTimezoneOffset())))/864e5}var XB=new Date,JB=KB.getTime()+6e4*(XB.getTimezoneOffset()-KB.getTimezoneOffset()),ZB=XB.getTimezoneOffset();function QB(e){var t=new Date;return t.setTime(24*e*60*60*1e3+JB),t.getTimezoneOffset()!==ZB&&t.setTime(t.getTime()+6e4*(t.getTimezoneOffset()-ZB)),t}function eU(e){var t=0,r=0,n=!1,i=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var o=1;o!=i.length;++o)if(i[o]){switch(r=1,o>3&&(n=!0),i[o].slice(i[o].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[o].slice(i[o].length-1));case"D":r*=24;case"H":r*=60;case"M":if(!n)throw new Error("Unsupported ISO Duration Field: M");r*=60}t+=r*parseInt(i[o],10)}return t}var tU=new Date("2017-02-19T19:06:09.000Z"),rU=isNaN(tU.getFullYear())?new Date("2/19/17"):tU,nU=2017==rU.getFullYear();function iU(e,t){var r=new Date(e);if(nU)return t>0?r.setTime(r.getTime()+60*r.getTimezoneOffset()*1e3):t<0&&r.setTime(r.getTime()-60*r.getTimezoneOffset()*1e3),r;if(e instanceof Date)return e;if(1917==rU.getFullYear()&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=e.match(/\d+/g)||["2017","2","19","0","0","0"],o=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return e.indexOf("Z")>-1&&(o=new Date(o.getTime()-60*o.getTimezoneOffset()*1e3)),o}function oU(e,t){if(DH&&Buffer.isBuffer(e)){if(t){if(255==e[0]&&254==e[1])return KU(e.slice(2).toString("utf16le"));if(254==e[1]&&255==e[2])return KU(TH(e.slice(2).toString("binary")))}return e.toString("binary")}if("undefined"!==typeof TextDecoder)try{if(t){if(255==e[0]&&254==e[1])return KU(new TextDecoder("utf-16le").decode(e.slice(2)));if(254==e[0]&&255==e[1])return KU(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"\u20ac":"\x80","\u201a":"\x82","\u0192":"\x83","\u201e":"\x84","\u2026":"\x85","\u2020":"\x86","\u2021":"\x87","\u02c6":"\x88","\u2030":"\x89","\u0160":"\x8a","\u2039":"\x8b","\u0152":"\x8c","\u017d":"\x8e","\u2018":"\x91","\u2019":"\x92","\u201c":"\x93","\u201d":"\x94","\u2022":"\x95","\u2013":"\x96","\u2014":"\x97","\u02dc":"\x98","\u2122":"\x99","\u0161":"\x9a","\u203a":"\x9b","\u0153":"\x9c","\u017e":"\x9e","\u0178":"\x9f"};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[\u20ac\u201a\u0192\u201e\u2026\u2020\u2021\u02c6\u2030\u0160\u2039\u0152\u017d\u2018\u2019\u201c\u201d\u2022\u2013\u2014\u02dc\u2122\u0161\u203a\u0153\u017e\u0178]/g,(function(e){return r[e]||e}))}catch(oJ){}for(var n=[],i=0;i!=e.length;++i)n.push(String.fromCharCode(e[i]));return n.join("")}function aU(e){if("undefined"!=typeof JSON&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if("object"!=typeof e||null==e)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=aU(e[r]));return t}function sU(e,t){for(var r="";r.length<t;)r+=e;return r}function lU(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,(function(){return r*=100,""}));return isNaN(t=Number(n))?(n=n.replace(/[(](.*)[)]/,(function(e,t){return r=-r,t})),isNaN(t=Number(n))?t:t/r):t/r}var cU=["january","february","march","april","may","june","july","august","september","october","november","december"];function uU(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),i=t.getMonth(),o=t.getDate();if(isNaN(o))return r;var a=e.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if((a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,"")).length>3&&-1==cU.indexOf(a))return r}else if(a.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||o>1)&&101!=n?t:e.match(/[^-0-9:,\/\\]/)?r:t}var hU=function(){var e=5=="abacaba".split(/(:?b)/i).length;return function(t,r,n){if(e||"string"==typeof r)return t.split(r);for(var i=t.split(r),o=[i[0]],a=1;a<i.length;++a)o.push(n),o.push(i[a]);return o}}();function dU(e){return e?e.content&&e.type?oU(e.content,!0):e.data?AH(e.data):e.asNodeBuffer&&DH?AH(e.asNodeBuffer().toString("binary")):e.asBinary?AH(e.asBinary()):e._data&&e._data.getContent?AH(oU(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function fU(e){if(!e)return null;if(e.data)return EH(e.data);if(e.asNodeBuffer&&DH)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return"string"==typeof t?EH(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function gU(e,t){for(var r=e.FullPaths||zB(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),i=n.replace(/\\/g,"/"),o=0;o<r.length;++o){var a=r[o].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==a||i==a)return e.files?e.files[r[o]]:e.FileIndex[o]}return null}function pU(e,t){var r=gU(e,t);if(null==r)throw new Error("Cannot find file "+t+" in zip");return r}function mU(e,t,r){if(!r)return(n=pU(e,t))&&".bin"===n.name.slice(-4)?fU(n):dU(n);var n;if(!t)return null;try{return mU(e,t)}catch(oJ){return null}}function vU(e,t,r){if(!r)return dU(pU(e,t));if(!t)return null;try{return vU(e,t)}catch(oJ){return null}}function bU(e,t,r){if(!r)return fU(pU(e,t));if(!t)return null;try{return bU(e,t)}catch(oJ){return null}}function yU(e){for(var t=e.FullPaths||zB(e.files),r=[],n=0;n<t.length;++n)"/"!=t[n].slice(-1)&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function wU(e,t,r){if(e.FullPaths){var n;if("string"==typeof r)return n=DH?FH(r):function(e){for(var t=[],r=0,n=e.length+250,i=LH(e.length+255),o=0;o<e.length;++o){var a=e.charCodeAt(o);if(a<128)i[r++]=a;else if(a<2048)i[r++]=192|a>>6&31,i[r++]=128|63&a;else if(a>=55296&&a<57344){a=64+(1023&a);var s=1023&e.charCodeAt(++o);i[r++]=240|a>>8&7,i[r++]=128|a>>2&63,i[r++]=128|s>>6&15|(3&a)<<4,i[r++]=128|63&s}else i[r++]=224|a>>12&15,i[r++]=128|a>>6&63,i[r++]=128|63&a;r>n&&(t.push(i.slice(0,r)),r=0,i=LH(65535),n=65530)}return t.push(i.slice(0,r)),VH(t)}(r),UB.utils.cfb_add(e,t,n);UB.utils.cfb_add(e,t,r)}else e.file(t,r)}function SU(){return UB.utils.cfb_new()}function CU(e,t){switch(t.type){case"base64":return UB.read(e,{type:"base64"});case"binary":return UB.read(e,{type:"binary"});case"buffer":case"array":return UB.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function kU(e,t){if("/"==e.charAt(0))return e.slice(1);var r=t.split("/");"/"!=t.slice(-1)&&r.pop();for(var n=e.split("/");0!==n.length;){var i=n.shift();".."===i?r.pop():"."!==i&&r.push(i)}return r.join("/")}var xU='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r\n',EU=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,TU=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/gm,_U=xU.match(TU)?TU:/<[^>]*>/g,AU=/<\w*:/,RU=/<(\/?)\w+:/;function OU(e,t,r){for(var n={},i=0,o=0;i!==e.length&&(32!==(o=e.charCodeAt(i))&&10!==o&&13!==o);++i);if(t||(n[0]=e.slice(0,i)),i===e.length)return n;var a=e.match(EU),s=0,l="",c=0,u="",h="",d=1;if(a)for(c=0;c!=a.length;++c){for(h=a[c],o=0;o!=h.length&&61!==h.charCodeAt(o);++o);for(u=h.slice(0,o).trim();32==h.charCodeAt(o+1);)++o;for(d=34==(i=h.charCodeAt(o+1))||39==i?1:0,l=h.slice(o+1+d,h.length-d),s=0;s!=u.length&&58!==u.charCodeAt(s);++s);if(s===u.length)u.indexOf("_")>0&&(u=u.slice(0,u.indexOf("_"))),n[u]=l,r||(n[u.toLowerCase()]=l);else{var f=(5===s&&"xmlns"===u.slice(0,5)?"xmlns":"")+u.slice(s+1);if(n[f]&&"ext"==u.slice(s-3,s))continue;n[f]=l,r||(n[f.toLowerCase()]=l)}}return n}function MU(e){return e.replace(RU,"<$1")}var IU={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},PU=GB(IU),NU=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/gi,t=/_x([\da-fA-F]{4})_/gi;return function r(n){var i=n+"",o=i.indexOf("<![CDATA[");if(-1==o)return i.replace(e,(function(e,t){return IU[e]||String.fromCharCode(parseInt(t,e.indexOf("x")>-1?16:10))||e})).replace(t,(function(e,t){return String.fromCharCode(parseInt(t,16))}));var a=i.indexOf("]]>");return r(i.slice(0,o))+i.slice(o+9,a)+r(i.slice(a+3))}}(),DU=/[&<>'"]/g,FU=/[\u0000-\u0008\u000b-\u001f]/g;function LU(e){return(e+"").replace(DU,(function(e){return PU[e]})).replace(FU,(function(e){return"_x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+"_"}))}function HU(e){return LU(e).replace(/ /g,"_x0020_")}var BU=/[\u0000-\u001f]/g;function UU(e){return(e+"").replace(DU,(function(e){return PU[e]})).replace(/\n/g,"<br/>").replace(BU,(function(e){return"&#x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+";"}))}var jU=function(){var e=/&#(\d+);/g;function t(e,t){return String.fromCharCode(parseInt(t,10))}return function(r){return r.replace(e,t)}}();function WU(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function VU(e){for(var t="",r=0,n=0,i=0,o=0,a=0,s=0;r<e.length;)(n=e.charCodeAt(r++))<128?t+=String.fromCharCode(n):(i=e.charCodeAt(r++),n>191&&n<224?(a=(31&n)<<6,a|=63&i,t+=String.fromCharCode(a)):(o=e.charCodeAt(r++),n<240?t+=String.fromCharCode((15&n)<<12|(63&i)<<6|63&o):(s=((7&n)<<18|(63&i)<<12|(63&o)<<6|63&(a=e.charCodeAt(r++)))-65536,t+=String.fromCharCode(55296+(s>>>10&1023)),t+=String.fromCharCode(56320+(1023&s)))));return t}function zU(e){var t,r,n,i=LH(2*e.length),o=1,a=0,s=0;for(r=0;r<e.length;r+=o)o=1,(n=e.charCodeAt(r))<128?t=n:n<224?(t=64*(31&n)+(63&e.charCodeAt(r+1)),o=2):n<240?(t=4096*(15&n)+64*(63&e.charCodeAt(r+1))+(63&e.charCodeAt(r+2)),o=3):(o=4,t=262144*(7&n)+4096*(63&e.charCodeAt(r+1))+64*(63&e.charCodeAt(r+2))+(63&e.charCodeAt(r+3)),s=55296+((t-=65536)>>>10&1023),t=56320+(1023&t)),0!==s&&(i[a++]=255&s,i[a++]=s>>>8,s=0),i[a++]=t%256,i[a++]=t>>>8;return i.slice(0,a).toString("ucs2")}function qU(e){return FH(e,"binary").toString("utf8")}var GU="foo bar baz\xe2\x98\x83\xf0\x9f\x8d\xa3",$U=DH&&(qU(GU)==VU(GU)&&qU||zU(GU)==VU(GU)&&zU)||VU,KU=DH?function(e){return FH(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,i=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(63&n)));break;case n>=55296&&n<57344:n-=55296,i=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(i>>18&7))),t.push(String.fromCharCode(144+(i>>12&63))),t.push(String.fromCharCode(128+(i>>6&63))),t.push(String.fromCharCode(128+(63&i)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(63&n)))}return t.join("")},YU=function(){var e={};return function(t,r){var n=t+"|"+(r||"");return e[n]?e[n]:e[n]=new RegExp("<(?:\\w+:)?"+t+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+t+">",r||"")}}(),XU=function(){var e=[["nbsp"," "],["middot","\xb7"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map((function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]}));return function(t){for(var r=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,"\n").replace(/<[^>]*>/g,""),n=0;n<e.length;++n)r=r.replace(e[n][0],e[n][1]);return r}}(),JU=function(){var e={};return function(t){return void 0!==e[t]?e[t]:e[t]=new RegExp("<(?:vt:)?"+t+">([\\s\\S]*?)</(?:vt:)?"+t+">","g")}}(),ZU=/<\/?(?:vt:)?variant>/g,QU=/<(?:vt:)([^>]*)>([\s\S]*)</;function ej(e,t){var r=OU(e),n=e.match(JU(r.baseType))||[],i=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return i}return n.forEach((function(e){var t=e.replace(ZU,"").match(QU);t&&i.push({v:$U(t[2]),t:t[1]})})),i}var tj=/(^\s|\s$|\n)/;function rj(e,t){return"<"+e+(t.match(tj)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function nj(e){return zB(e).map((function(t){return" "+t+'="'+e[t]+'"'})).join("")}function ij(e,t,r){return"<"+e+(null!=r?nj(r):"")+(null!=t?(t.match(tj)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function oj(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(oJ){if(t)throw oJ}return""}function aj(e){if(DH&&Buffer.isBuffer(e))return e.toString("utf8");if("string"===typeof e)return e;if("undefined"!==typeof Uint8Array&&e instanceof Uint8Array)return $U(jH(WH(e)));throw new Error("Bad input format: expected Buffer or string")}var sj=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/gm,lj={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},cj=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],uj={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};var hj=function(e){for(var t=[],r=0;r<e[0].length;++r)if(e[0][r])for(var n=0,i=e[0][r].length;n<i;n+=10240)t.push.apply(t,e[0][r].slice(n,n+10240));return t},dj=DH?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map((function(e){return Buffer.isBuffer(e)?e:FH(e)}))):hj(e)}:hj,fj=function(e,t,r){for(var n=[],i=t;i<r;i+=2)n.push(String.fromCharCode(Nj(e,i)));return n.join("").replace(zH,"")},gj=DH?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(zH,""):fj(e,t,r)}:fj,pj=function(e,t,r){for(var n=[],i=t;i<t+r;++i)n.push(("0"+e[i].toString(16)).slice(-2));return n.join("")},mj=DH?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):pj(e,t,r)}:pj,vj=function(e,t,r){for(var n=[],i=t;i<r;i++)n.push(String.fromCharCode(Pj(e,i)));return n.join("")},bj=DH?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf8",t,r):vj(e,t,r)}:vj,yj=function(e,t){var r=Fj(e,t);return r>0?bj(e,t+4,t+4+r-1):""},wj=yj,Sj=function(e,t){var r=Fj(e,t);return r>0?bj(e,t+4,t+4+r-1):""},Cj=Sj,kj=function(e,t){var r=2*Fj(e,t);return r>0?bj(e,t+4,t+4+r-1):""},xj=kj,Ej=function(e,t){var r=Fj(e,t);return r>0?gj(e,t+4,t+4+r):""},Tj=Ej,_j=function(e,t){var r=Fj(e,t);return r>0?bj(e,t+4,t+4+r):""},Aj=_j,Rj=function(e,t){return function(e,t){for(var r=1-2*(e[t+7]>>>7),n=((127&e[t+7])<<4)+(e[t+6]>>>4&15),i=15&e[t+6],o=5;o>=0;--o)i=256*i+e[t+o];return 2047==n?0==i?r*(1/0):NaN:(0==n?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}(e,t)},Oj=Rj,Mj=function(e){return Array.isArray(e)||"undefined"!==typeof Uint8Array&&e instanceof Uint8Array};function Ij(){gj=function(e,t,r){return _H.utils.decode(1200,e.slice(t,r)).replace(zH,"")},bj=function(e,t,r){return _H.utils.decode(65001,e.slice(t,r))},wj=function(e,t){var r=Fj(e,t);return r>0?_H.utils.decode(yH,e.slice(t+4,t+4+r-1)):""},Cj=function(e,t){var r=Fj(e,t);return r>0?_H.utils.decode(bH,e.slice(t+4,t+4+r-1)):""},xj=function(e,t){var r=2*Fj(e,t);return r>0?_H.utils.decode(1200,e.slice(t+4,t+4+r-1)):""},Tj=function(e,t){var r=Fj(e,t);return r>0?_H.utils.decode(1200,e.slice(t+4,t+4+r)):""},Aj=function(e,t){var r=Fj(e,t);return r>0?_H.utils.decode(65001,e.slice(t+4,t+4+r)):""}}DH&&(wj=function(e,t){if(!Buffer.isBuffer(e))return yj(e,t);var r=e.readUInt32LE(t);return r>0?e.toString("utf8",t+4,t+4+r-1):""},Cj=function(e,t){if(!Buffer.isBuffer(e))return Sj(e,t);var r=e.readUInt32LE(t);return r>0?e.toString("utf8",t+4,t+4+r-1):""},xj=function(e,t){if(!Buffer.isBuffer(e))return kj(e,t);var r=2*e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+r-1)},Tj=function(e,t){if(!Buffer.isBuffer(e))return Ej(e,t);var r=e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+r)},Aj=function(e,t){if(!Buffer.isBuffer(e))return _j(e,t);var r=e.readUInt32LE(t);return e.toString("utf8",t+4,t+4+r)},Oj=function(e,t){return Buffer.isBuffer(e)?e.readDoubleLE(t):Rj(e,t)},Mj=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||"undefined"!==typeof Uint8Array&&e instanceof Uint8Array}),"undefined"!==typeof _H&&Ij();var Pj=function(e,t){return e[t]},Nj=function(e,t){return 256*e[t+1]+e[t]},Dj=function(e,t){var r=256*e[t+1]+e[t];return r<32768?r:-1*(65535-r+1)},Fj=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Lj=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},Hj=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Bj(e,t){var r,n,i,o,a,s,l="",c=[];switch(t){case"dbcs":if(s=this.l,DH&&Buffer.isBuffer(this))l=this.slice(this.l,this.l+2*e).toString("utf16le");else for(a=0;a<e;++a)l+=String.fromCharCode(Nj(this,s)),s+=2;e*=2;break;case"utf8":l=bj(this,this.l,this.l+e);break;case"utf16le":e*=2,l=gj(this,this.l,this.l+e);break;case"wstr":if("undefined"===typeof _H)return Bj.call(this,e,"dbcs");l=_H.utils.decode(bH,this.slice(this.l,this.l+2*e)),e*=2;break;case"lpstr-ansi":l=wj(this,this.l),e=4+Fj(this,this.l);break;case"lpstr-cp":l=Cj(this,this.l),e=4+Fj(this,this.l);break;case"lpwstr":l=xj(this,this.l),e=4+2*Fj(this,this.l);break;case"lpp4":e=4+Fj(this,this.l),l=Tj(this,this.l),2&e&&(e+=2);break;case"8lpp4":e=4+Fj(this,this.l),l=Aj(this,this.l),3&e&&(e+=4-(3&e));break;case"cstr":for(e=0,l="";0!==(i=Pj(this,this.l+e++));)c.push(RH(i));l=c.join("");break;case"_wstr":for(e=0,l="";0!==(i=Nj(this,this.l+e));)c.push(RH(i)),e+=2;e+=2,l=c.join("");break;case"dbcs-cont":for(l="",s=this.l,a=0;a<e;++a){if(this.lens&&-1!==this.lens.indexOf(s))return i=Pj(this,s),this.l=s+1,o=Bj.call(this,e-a,i?"dbcs-cont":"sbcs-cont"),c.join("")+o;c.push(RH(Nj(this,s))),s+=2}l=c.join(""),e*=2;break;case"cpstr":if("undefined"!==typeof _H){l=_H.utils.decode(bH,this.slice(this.l,this.l+e));break}case"sbcs-cont":for(l="",s=this.l,a=0;a!=e;++a){if(this.lens&&-1!==this.lens.indexOf(s))return i=Pj(this,s),this.l=s+1,o=Bj.call(this,e-a,i?"dbcs-cont":"sbcs-cont"),c.join("")+o;c.push(RH(Pj(this,s))),s+=1}l=c.join("");break;default:switch(e){case 1:return r=Pj(this,this.l),this.l++,r;case 2:return r=("i"===t?Dj:Nj)(this,this.l),this.l+=2,r;case 4:case-4:return"i"===t||0===(128&this[this.l+3])?(r=(e>0?Lj:Hj)(this,this.l),this.l+=4,r):(n=Fj(this,this.l),this.l+=4,n);case 8:case-8:if("f"===t)return n=8==e?Oj(this,this.l):Oj([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,n;e=8;case 16:l=mj(this,this.l,e)}}return this.l+=e,l}var Uj=function(e,t,r){e[r]=255&t,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},jj=function(e,t,r){e[r]=255&t,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},Wj=function(e,t,r){e[r]=255&t,e[r+1]=t>>>8&255};function Vj(e,t,r){var n=0,i=0;if("dbcs"===r){for(i=0;i!=t.length;++i)Wj(this,t.charCodeAt(i),this.l+2*i);n=2*t.length}else if("sbcs"===r){if("undefined"!==typeof _H&&874==yH)for(i=0;i!=t.length;++i){var o=_H.utils.encode(yH,t.charAt(i));this[this.l+i]=o[0]}else for(t=t.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=t.length;++i)this[this.l+i]=255&t.charCodeAt(i);n=t.length}else{if("hex"===r){for(;i<e;++i)this[this.l++]=parseInt(t.slice(2*i,2*i+2),16)||0;return this}if("utf16le"===r){var a=Math.min(this.l+e,this.length);for(i=0;i<Math.min(t.length,e);++i){var s=t.charCodeAt(i);this[this.l++]=255&s,this[this.l++]=s>>8}for(;this.l<a;)this[this.l++]=0;return this}switch(e){case 1:n=1,this[this.l]=255&t;break;case 2:n=2,this[this.l]=255&t,t>>>=8,this[this.l+1]=255&t;break;case 3:n=3,this[this.l]=255&t,t>>>=8,this[this.l+1]=255&t,t>>>=8,this[this.l+2]=255&t;break;case 4:n=4,Uj(this,t,this.l);break;case 8:if(n=8,"f"===r){!function(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,i=0,o=0,a=n?-t:t;isFinite(a)?0==a?i=o=0:(i=Math.floor(Math.log(a)/Math.LN2),o=a*Math.pow(2,52-i),i<=-1023&&(!isFinite(o)||o<Math.pow(2,52))?i=-1022:(o-=Math.pow(2,52),i+=1023)):(i=2047,o=isNaN(t)?26985:0);for(var s=0;s<=5;++s,o/=256)e[r+s]=255&o;e[r+6]=(15&i)<<4|15&o,e[r+7]=i>>4|n}(this,t,this.l);break}case 16:break;case-4:n=4,jj(this,t,this.l)}}return this.l+=n,this}function zj(e,t){var r=mj(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function qj(e,t){e.l=t,e.read_shift=Bj,e.chk=zj,e.write_shift=Vj}function Gj(e,t){e.l+=t}function $j(e){var t=LH(e);return qj(t,0),t}function Kj(e,t,r){if(e){var n,i,o;qj(e,e.l||0);for(var a=e.length,s=0,l=0;e.l<a;){128&(s=e.read_shift(1))&&(s=(127&s)+((127&e.read_shift(1))<<7));var c=sY[s]||sY[65535];for(o=127&(n=e.read_shift(1)),i=1;i<4&&128&n;++i)o+=(127&(n=e.read_shift(1)))<<7*i;l=e.l+o;var u=c.f&&c.f(e,o,r);if(e.l=l,t(u,c,s))return}}}function Yj(){var e=[],t=DH?256:2048,r=function(e){var t=$j(e);return qj(t,0),t},n=r(t),i=function(){n&&(n.length>n.l&&((n=n.slice(0,n.l)).l=n.length),n.length>0&&e.push(n),n=null)},o=function(e){return n&&e<n.length-n.l?n:(i(),n=r(Math.max(e+1,t)))};return{next:o,push:function(e){i(),null==(n=e).l&&(n.l=n.length),o(t)},end:function(){return i(),VH(e)},_bufs:e}}function Xj(e,t,r,n){var i,o=+t;if(!isNaN(o)){n||(n=sY[o].p||(r||[]).length||0),i=1+(o>=128?1:0)+1,n>=128&&++i,n>=16384&&++i,n>=2097152&&++i;var a=e.next(i);o<=127?a.write_shift(1,o):(a.write_shift(1,128+(127&o)),a.write_shift(1,o>>7));for(var s=0;4!=s;++s){if(!(n>=128)){a.write_shift(1,n);break}a.write_shift(1,128+(127&n)),n>>=7}n>0&&Mj(r)&&e.push(r)}}function Jj(e,t,r){var n=aU(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function Zj(e,t,r){var n=aU(e);return n.s=Jj(n.s,t.s,r),n.e=Jj(n.e,t.s,r),n}function Qj(e,t){if(e.cRel&&e.c<0)for(e=aU(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=aU(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=aW(e);return e.cRel||null==e.cRel||(r=r.replace(/^([A-Z])/,"$$$1")),e.rRel||null==e.rRel||(r=function(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}(r)),r}function eW(e,t){return 0!=e.s.r||e.s.rRel||e.e.r!=(t.biff>=12?1048575:t.biff>=8?65536:16384)||e.e.rRel?0!=e.s.c||e.s.cRel||e.e.c!=(t.biff>=12?16383:255)||e.e.cRel?Qj(e.s,t.biff)+":"+Qj(e.e,t.biff):(e.s.rRel?"":"$")+rW(e.s.r)+":"+(e.e.rRel?"":"$")+rW(e.e.r):(e.s.cRel?"":"$")+iW(e.s.c)+":"+(e.e.cRel?"":"$")+iW(e.e.c)}function tW(e){return parseInt(e.replace(/\$(\d+)$/,"$1"),10)-1}function rW(e){return""+(e+1)}function nW(e){for(var t=e.replace(/^\$([A-Z])/,"$1"),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function iW(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function oW(e){for(var t=0,r=0,n=0;n<e.length;++n){var i=e.charCodeAt(n);i>=48&&i<=57?t=10*t+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:t-1}}function aW(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function sW(e){var t=e.indexOf(":");return-1==t?{s:oW(e),e:oW(e)}:{s:oW(e.slice(0,t)),e:oW(e.slice(t+1))}}function lW(e,t){return"undefined"===typeof t||"number"===typeof t?lW(e.s,e.e):("string"!==typeof e&&(e=aW(e)),"string"!==typeof t&&(t=aW(t)),e==t?e:e+":"+t)}function cW(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,o=e.length;for(r=0;n<o&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.s.c=--r,r=0;n<o&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(t.s.r=--r,n===o||10!=i)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=o&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.e.c=--r,r=0;n!=o&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return t.e.r=--r,t}function uW(e,t){var r="d"==e.t&&t instanceof Date;if(null!=e.z)try{return e.w=PB(e.z,r?YB(t):t)}catch(oJ){}try{return e.w=PB((e.XF||{}).numFmtId||(r?14:0),r?YB(t):t)}catch(oJ){return""+t}}function hW(e,t,r){return null==e||null==e.t||"z"==e.t?"":void 0!==e.w?e.w:("d"==e.t&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),"e"==e.t?eV[e.v]||e.v:uW(e,void 0==t?e.v:t))}function dW(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function fW(e,t,r){var n=r||{},i=e?Array.isArray(e):n.dense;null!=MH&&null==i&&(i=MH);var o=e||(i?[]:{}),a=0,s=0;if(o&&null!=n.origin){if("number"==typeof n.origin)a=n.origin;else{var l="string"==typeof n.origin?oW(n.origin):n.origin;a=l.r,s=l.c}o["!ref"]||(o["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(o["!ref"]){var u=cW(o["!ref"]);c.s.c=u.s.c,c.s.r=u.s.r,c.e.c=Math.max(c.e.c,u.e.c),c.e.r=Math.max(c.e.r,u.e.r),-1==a&&(c.e.r=a=u.e.r+1)}for(var h=0;h!=t.length;++h)if(t[h]){if(!Array.isArray(t[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var d=0;d!=t[h].length;++d)if("undefined"!==typeof t[h][d]){var f={v:t[h][d]},g=a+h,p=s+d;if(c.s.r>g&&(c.s.r=g),c.s.c>p&&(c.s.c=p),c.e.r<g&&(c.e.r=g),c.e.c<p&&(c.e.c=p),!t[h][d]||"object"!==typeof t[h][d]||Array.isArray(t[h][d])||t[h][d]instanceof Date)if(Array.isArray(f.v)&&(f.f=t[h][d][1],f.v=f.v[0]),null===f.v)if(f.f)f.t="n";else if(n.nullError)f.t="e",f.v=0;else{if(!n.sheetStubs)continue;f.t="z"}else"number"===typeof f.v?f.t="n":"boolean"===typeof f.v?f.t="b":f.v instanceof Date?(f.z=n.dateNF||tB[14],n.cellDates?(f.t="d",f.w=PB(f.z,YB(f.v))):(f.t="n",f.v=YB(f.v),f.w=PB(f.z,f.v))):f.t="s";else f=t[h][d];if(i)o[g]||(o[g]=[]),o[g][p]&&o[g][p].z&&(f.z=o[g][p].z),o[g][p]=f;else{var m=aW({c:p,r:g});o[m]&&o[m].z&&(f.z=o[m].z),o[m]=f}}}return c.s.c<1e7&&(o["!ref"]=lW(c)),o}function gW(e,t){return fW(null,e,t)}function pW(e,t){return t||(t=$j(4)),t.write_shift(4,e),t}function mW(e){var t=e.read_shift(4);return 0===t?"":e.read_shift(t,"dbcs")}function vW(e,t){var r=!1;return null==t&&(r=!0,t=$j(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function bW(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function yW(e,t){var r=e.l,n=e.read_shift(1),i=mW(e),o=[],a={t:i,h:i};if(0!==(1&n)){for(var s=e.read_shift(4),l=0;l!=s;++l)o.push(bW(e));a.r=o}else a.r=[{ich:0,ifnt:0}];return e.l=r+t,a}var wW=yW;function SW(e,t){var r=!1;return null==t&&(r=!0,t=$j(23+4*e.t.length)),t.write_shift(1,1),vW(e.t,t),t.write_shift(4,1),function(e,t){t||(t=$j(4)),t.write_shift(2,e.ich||0),t.write_shift(2,e.ifnt||0)}({ich:0,ifnt:0},t),r?t.slice(0,t.l):t}function CW(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function kW(e,t){return null==t&&(t=$j(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function xW(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function EW(e,t){return null==t&&(t=$j(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var TW=mW,_W=vW;function AW(e){var t=e.read_shift(4);return 0===t||4294967295===t?"":e.read_shift(t,"dbcs")}function RW(e,t){var r=!1;return null==t&&(r=!0,t=$j(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var OW=mW,MW=AW,IW=RW;function PW(e){var t=e.slice(e.l,e.l+4),r=1&t[0],n=2&t[0];e.l+=4;var i=0===n?Oj([0,0,0,0,252&t[0],t[1],t[2],t[3]],0):Lj(t,0)>>2;return r?i/100:i}function NW(e,t){null==t&&(t=$j(4));var r=0,n=0,i=100*e;if(e==(0|e)&&e>=-(1<<29)&&e<1<<29?n=1:i==(0|i)&&i>=-(1<<29)&&i<1<<29&&(n=1,r=1),!n)throw new Error("unsupported RkNumber "+e);t.write_shift(-4,((r?i:e)<<2)+(r+2))}function DW(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var FW=DW,LW=function(e,t){return t||(t=$j(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t};function HW(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function BW(e,t){return(t||$j(8)).write_shift(8,e,"f")}function UW(e,t){if(t||(t=$j(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;null!=e.index?(t.write_shift(1,2),t.write_shift(1,e.index)):null!=e.theme?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),e.rgb&&null==e.theme){var n=e.rgb||"FFFFFF";"number"==typeof n&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}else t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);return t}function jW(e,t){var r=e.read_shift(4);switch(r){case 0:return"";case 4294967295:case 4294967294:return{2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"}[e.read_shift(4)]||""}if(r>400)throw new Error("Unsupported Clipboard: "+r.toString(16));return e.l-=4,e.read_shift(0,1==t?"lpstr":"lpwstr")}var WW=2,VW=3,zW=12,qW=80,GW=81,$W=[qW,GW],KW={1:{n:"CodePage",t:WW},2:{n:"Category",t:qW},3:{n:"PresentationFormat",t:qW},4:{n:"ByteCount",t:VW},5:{n:"LineCount",t:VW},6:{n:"ParagraphCount",t:VW},7:{n:"SlideCount",t:VW},8:{n:"NoteCount",t:VW},9:{n:"HiddenCount",t:VW},10:{n:"MultimediaClipCount",t:VW},11:{n:"ScaleCrop",t:11},12:{n:"HeadingPairs",t:4108},13:{n:"TitlesOfParts",t:4126},14:{n:"Manager",t:qW},15:{n:"Company",t:qW},16:{n:"LinksUpToDate",t:11},17:{n:"CharacterCount",t:VW},19:{n:"SharedDoc",t:11},22:{n:"HyperlinksChanged",t:11},23:{n:"AppVersion",t:VW,p:"version"},24:{n:"DigSig",t:65},26:{n:"ContentType",t:qW},27:{n:"ContentStatus",t:qW},28:{n:"Language",t:qW},29:{n:"Version",t:qW},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},YW={1:{n:"CodePage",t:WW},2:{n:"Title",t:qW},3:{n:"Subject",t:qW},4:{n:"Author",t:qW},5:{n:"Keywords",t:qW},6:{n:"Comments",t:qW},7:{n:"Template",t:qW},8:{n:"LastAuthor",t:qW},9:{n:"RevNumber",t:qW},10:{n:"EditTime",t:64},11:{n:"LastPrinted",t:64},12:{n:"CreatedDate",t:64},13:{n:"ModifiedDate",t:64},14:{n:"PageCount",t:VW},15:{n:"WordCount",t:VW},16:{n:"CharCount",t:VW},17:{n:"Thumbnail",t:71},18:{n:"Application",t:qW},19:{n:"DocSecurity",t:VW},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},XW={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},JW=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function ZW(e){return e.map((function(e){return[e>>16&255,e>>8&255,255&e]}))}var QW=aU(ZW([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])),eV={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},tV={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},rV={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},nV={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function iV(e,t){var r,n=function(e){for(var t=[],r=zB(e),n=0;n!==r.length;++n)null==t[e[r[n]]]&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}(rV),i=[];i[i.length]=xU,i[i.length]=ij("Types",null,{xmlns:lj.CT,"xmlns:xsd":lj.xsd,"xmlns:xsi":lj.xsi}),i=i.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map((function(e){return ij("Default",null,{Extension:e[0],ContentType:e[1]})})));var o=function(n){e[n]&&e[n].length>0&&(r=e[n][0],i[i.length]=ij("Override",null,{PartName:("/"==r[0]?"":"/")+r,ContentType:nV[n][t.bookType]||nV[n].xlsx}))},a=function(r){(e[r]||[]).forEach((function(e){i[i.length]=ij("Override",null,{PartName:("/"==e[0]?"":"/")+e,ContentType:nV[r][t.bookType]||nV[r].xlsx})}))},s=function(t){(e[t]||[]).forEach((function(e){i[i.length]=ij("Override",null,{PartName:("/"==e[0]?"":"/")+e,ContentType:n[t][0]})}))};return o("workbooks"),a("sheets"),a("charts"),s("themes"),["strs","styles"].forEach(o),["coreprops","extprops","custprops"].forEach(s),s("vba"),s("comments"),s("threadedcomments"),s("drawings"),a("metadata"),s("people"),i.length>2&&(i[i.length]="</Types>",i[1]=i[1].replace("/>",">")),i.join("")}var oV={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function aV(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function sV(e,t){var r={"!id":{}};if(!e)return r;"/"!==t.charAt(0)&&(t="/"+t);var n={};return(e.match(_U)||[]).forEach((function(e){var i=OU(e);if("<Relationship"===i[0]){var o={};o.Type=i.Type,o.Target=i.Target,o.Id=i.Id,i.TargetMode&&(o.TargetMode=i.TargetMode);var a="External"===i.TargetMode?i.Target:kU(i.Target,t);r[a]=o,n[i.Id]=o}})),r["!id"]=n,r}function lV(e){var t=[xU,ij("Relationships",null,{xmlns:lj.RELS})];return zB(e["!id"]).forEach((function(r){t[t.length]=ij("Relationship",null,e["!id"][r])})),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function cV(e,t,r,n,i,o){if(i||(i={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,i.Id="rId"+t,i.Type=n,i.Target=r,o?i.TargetMode=o:[oV.HLINK,oV.XPATH,oV.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),e["!id"][i.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][i.Id]=i,e[("/"+i.Target).replace("//","/")]=i,t}var uV="application/vnd.oasis.opendocument.spreadsheet";function hV(e,t,r){return['  <rdf:Description rdf:about="'+e+'">\n','    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+'"/>\n',"  </rdf:Description>\n"].join("")}function dV(e,t){return['  <rdf:Description rdf:about="'+e+'">\n','    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+'"/>\n',"  </rdf:Description>\n"].join("")}function fV(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+vH.version+"</meta:generator></office:meta></office:document-meta>"}var gV=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],pV=function(){for(var e=new Array(gV.length),t=0;t<gV.length;++t){var r=gV[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function mV(e){var t={};e=$U(e);for(var r=0;r<gV.length;++r){var n=gV[r],i=e.match(pV[r]);null!=i&&i.length>0&&(t[n[1]]=NU(i[1])),"date"===n[2]&&t[n[1]]&&(t[n[1]]=iU(t[n[1]]))}return t}function vV(e,t,r,n,i){null==i[e]&&null!=t&&""!==t&&(i[e]=t,t=LU(t),n[n.length]=r?ij(e,t,r):rj(e,t))}function bV(e,t){var r=t||{},n=[xU,ij("cp:coreProperties",null,{"xmlns:cp":lj.CORE_PROPS,"xmlns:dc":lj.dc,"xmlns:dcterms":lj.dcterms,"xmlns:dcmitype":lj.dcmitype,"xmlns:xsi":lj.xsi})],i={};if(!e&&!r.Props)return n.join("");e&&(null!=e.CreatedDate&&vV("dcterms:created","string"===typeof e.CreatedDate?e.CreatedDate:oj(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i),null!=e.ModifiedDate&&vV("dcterms:modified","string"===typeof e.ModifiedDate?e.ModifiedDate:oj(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i));for(var o=0;o!=gV.length;++o){var a=gV[o],s=r.Props&&null!=r.Props[a[1]]?r.Props[a[1]]:e?e[a[1]]:null;!0===s?s="1":!1===s?s="0":"number"==typeof s&&(s=String(s)),null!=s&&vV(a[0],s,null,n,i)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var yV=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],wV=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function SV(e,t,r,n){var i=[];if("string"==typeof e)i=ej(e,n);else for(var o=0;o<e.length;++o)i=i.concat(e[o].map((function(e){return{v:e}})));var a="string"==typeof t?ej(t,n).map((function(e){return e.v})):t,s=0,l=0;if(a.length>0)for(var c=0;c!==i.length;c+=2){switch(l=+i[c+1].v,i[c].v){case"Worksheets":case"\u5de5\u4f5c\u8868":case"\u041b\u0438\u0441\u0442\u044b":case"\u0623\u0648\u0631\u0627\u0642 \u0627\u0644\u0639\u0645\u0644":case"\u30ef\u30fc\u30af\u30b7\u30fc\u30c8":case"\u05d2\u05dc\u05d9\u05d5\u05e0\u05d5\u05ea \u05e2\u05d1\u05d5\u05d3\u05d4":case"Arbeitsbl\xe4tter":case"\xc7al\u0131\u015fma Sayfalar\u0131":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de c\xe1lculo":case"Planilhas":case"Regneark":case"Hojas de c\xe1lculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=a.slice(s,s+l);break;case"Named Ranges":case"Rangos con nombre":case"\u540d\u524d\u4ed8\u304d\u4e00\u89a7":case"Benannte Bereiche":case"Navngivne omr\xe5der":r.NamedRanges=l,r.DefinedNames=a.slice(s,s+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=a.slice(s,s+l)}s+=l}}function CV(e){var t=[],r=ij;return e||(e={}),e.Application="SheetJS",t[t.length]=xU,t[t.length]=ij("Properties",null,{xmlns:lj.EXT_PROPS,"xmlns:vt":lj.vt}),yV.forEach((function(n){if(void 0!==e[n[1]]){var i;switch(n[2]){case"string":i=LU(String(e[n[1]]));break;case"bool":i=e[n[1]]?"true":"false"}void 0!==i&&(t[t.length]=r(n[0],i))}})),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map((function(e){return"<vt:lpstr>"+LU(e)+"</vt:lpstr>"})).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var kV=/<[^>]+>[^<]*/g;function xV(e){var t=[xU,ij("Properties",null,{xmlns:lj.CUST_PROPS,"xmlns:vt":lj.vt})];if(!e)return t.join("");var r=1;return zB(e).forEach((function(n){++r,t[t.length]=ij("property",function(e,t){switch(typeof e){case"string":var r=ij("vt:lpwstr",LU(e));return t&&(r=r.replace(/&quot;/g,"_x0022_")),r;case"number":return ij((0|e)==e?"vt:i4":"vt:r8",LU(String(e)));case"boolean":return ij("vt:bool",e?"true":"false")}if(e instanceof Date)return ij("vt:filetime",oj(e));throw new Error("Unable to serialize "+e)}(e[n],!0),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:LU(n)})})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var EV,TV={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function _V(e,t,r){EV||(EV=GB(TV)),e[t=EV[t]||t]=r}function AV(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date(1e3*(r/1e7*Math.pow(2,32)+t/1e7-11644473600)).toISOString().replace(/\.000/,"")}function RV(e,t,r){var n=e.l,i=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return i}function OV(e,t,r){var n=e.read_shift(0,"lpwstr");return r&&(e.l+=4-(n.length+1&3)&3),n}function MV(e,t,r){return 31===t?OV(e):RV(e,0,r)}function IV(e,t,r){return MV(e,t,!1===r?0:4)}function PV(e){var t=e.l,r=FV(e,GW);return 0==e[e.l]&&0==e[e.l+1]&&e.l-t&2&&(e.l+=2),[r,FV(e,VW)]}function NV(e,t){for(var r=e.read_shift(4),n={},i=0;i!=r;++i){var o=e.read_shift(4),a=e.read_shift(4);n[o]=e.read_shift(a,1200===t?"utf16le":"utf8").replace(zH,"").replace(qH,"!"),1200===t&&a%2&&(e.l+=2)}return 3&e.l&&(e.l=e.l>>3<<2),n}function DV(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(3&t)>0&&(e.l+=4-(3&t)&3),r}function FV(e,t,r){var n,i=e.read_shift(2),o=r||{};if(e.l+=2,t!==zW&&i!==t&&-1===$W.indexOf(t)&&(4126!=(65534&t)||4126!=(65534&i)))throw new Error("Expected type "+t+" saw "+i);switch(t===zW?i:t){case 2:return n=e.read_shift(2,"i"),o.raw||(e.l+=2),n;case 3:return n=e.read_shift(4,"i");case 11:return 0!==e.read_shift(4);case 19:return n=e.read_shift(4);case 30:return RV(e,0,4).replace(zH,"");case 31:return OV(e);case 64:return AV(e);case 65:return DV(e);case 71:return function(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}(e);case 80:return IV(e,i,!o.raw).replace(zH,"");case 81:return function(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return MV(e,t,0)}(e,i).replace(zH,"");case 4108:return function(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(PV(e));return r}(e);case 4126:case 4127:return 4127==i?function(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var i=e.l;r[n]=e.read_shift(0,"lpwstr").replace(zH,""),e.l-i&2&&(e.l+=2)}return r}(e):function(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(zH,"");return r}(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+i)}}function LV(e,t){var r=$j(4),n=$j(4);switch(r.write_shift(4,80==e?31:e),e){case 3:n.write_shift(-4,t);break;case 5:(n=$j(8)).write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=function(e){var t=("string"==typeof e?new Date(Date.parse(e)):e).getTime()/1e3+11644473600,r=t%Math.pow(2,32),n=(t-r)/Math.pow(2,32);n*=1e7;var i=(r*=1e7)/Math.pow(2,32)|0;i>0&&(r%=Math.pow(2,32),n+=i);var o=$j(8);return o.write_shift(4,r),o.write_shift(4,n),o}(t);break;case 31:case 80:for((n=$j(4+2*(t.length+1)+(t.length%2?0:2))).write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return VH([r,n])}function HV(e,t){var r=e.l,n=e.read_shift(4),i=e.read_shift(4),o=[],a=0,s=0,l=-1,c={};for(a=0;a!=i;++a){var u=e.read_shift(4),h=e.read_shift(4);o[a]=[u,h+r]}o.sort((function(e,t){return e[1]-t[1]}));var d={};for(a=0;a!=i;++a){if(e.l!==o[a][1]){var f=!0;if(a>0&&t)switch(t[o[a-1][0]].t){case 2:e.l+2===o[a][1]&&(e.l+=2,f=!1);break;case 80:case 4108:e.l<=o[a][1]&&(e.l=o[a][1],f=!1)}if((!t||0==a)&&e.l<=o[a][1]&&(f=!1,e.l=o[a][1]),f)throw new Error("Read Error: Expected address "+o[a][1]+" at "+e.l+" :"+a)}if(t){var g=t[o[a][0]];if(d[g.n]=FV(e,g.t,{raw:!0}),"version"===g.p&&(d[g.n]=String(d[g.n]>>16)+"."+("0000"+String(65535&d[g.n])).slice(-4)),"CodePage"==g.n)switch(d[g.n]){case 0:d[g.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:kH(s=d[g.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+d[g.n])}}else if(1===o[a][0]){if(s=d.CodePage=FV(e,WW),kH(s),-1!==l){var p=e.l;e.l=o[l][1],c=NV(e,s),e.l=p}}else if(0===o[a][0]){if(0===s){l=a,e.l=o[a+1][1];continue}c=NV(e,s)}else{var m,v=c[o[a][0]];switch(e[e.l]){case 65:e.l+=4,m=DV(e);break;case 30:case 31:e.l+=4,m=IV(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,m=e.read_shift(4,"i");break;case 19:e.l+=4,m=e.read_shift(4);break;case 5:e.l+=4,m=e.read_shift(8,"f");break;case 11:e.l+=4,m=qV(e,4);break;case 64:e.l+=4,m=iU(AV(e));break;default:throw new Error("unparsed value: "+e[e.l])}d[v]=m}}return e.l=r+n,d}var BV=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function UV(e){switch(typeof e){case"boolean":return 11;case"number":return(0|e)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64}return-1}function jV(e,t,r){var n=$j(8),i=[],o=[],a=8,s=0,l=$j(8),c=$j(8);if(l.write_shift(4,2),l.write_shift(4,1200),c.write_shift(4,1),o.push(l),i.push(c),a+=8+l.length,!t){(c=$j(8)).write_shift(4,0),i.unshift(c);var u=[$j(4)];for(u[0].write_shift(4,e.length),s=0;s<e.length;++s){var h=e[s][0];for((l=$j(8+2*(h.length+1)+(h.length%2?0:2))).write_shift(4,s+2),l.write_shift(4,h.length+1),l.write_shift(0,h,"dbcs");l.l!=l.length;)l.write_shift(1,0);u.push(l)}l=VH(u),o.unshift(l),a+=8+l.length}for(s=0;s<e.length;++s)if((!t||t[e[s][0]])&&!(BV.indexOf(e[s][0])>-1||wV.indexOf(e[s][0])>-1)&&null!=e[s][1]){var d=e[s][1],f=0;if(t){var g=r[f=+t[e[s][0]]];if("version"==g.p&&"string"==typeof d){var p=d.split(".");d=(+p[0]<<16)+(+p[1]||0)}l=LV(g.t,d)}else{var m=UV(d);-1==m&&(m=31,d=String(d)),l=LV(m,d)}o.push(l),(c=$j(8)).write_shift(4,t?f:2+s),i.push(c),a+=8+l.length}var v=8*(o.length+1);for(s=0;s<o.length;++s)i[s].write_shift(4,v),v+=o[s].length;return n.write_shift(4,a),n.write_shift(4,o.length),VH([n].concat(i).concat(o))}function WV(e,t,r){var n=e.content;if(!n)return{};qj(n,0);var i,o,a,s,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var c=n.read_shift(4),u=n.read_shift(16);if(u!==UB.utils.consts.HEADER_CLSID&&u!==r)throw new Error("Bad PropertySet CLSID "+u);if(1!==(i=n.read_shift(4))&&2!==i)throw new Error("Unrecognized #Sets: "+i);if(o=n.read_shift(16),s=n.read_shift(4),1===i&&s!==n.l)throw new Error("Length mismatch: "+s+" !== "+n.l);2===i&&(a=n.read_shift(16),l=n.read_shift(4));var h,d=HV(n,t),f={SystemIdentifier:c};for(var g in d)f[g]=d[g];if(f.FMTID=o,1===i)return f;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);try{h=HV(n,null)}catch(oJ){}for(g in h)f[g]=h[g];return f.FMTID=[o,a],f}function VV(e,t,r,n,i,o){var a=$j(i?68:48),s=[a];a.write_shift(2,65534),a.write_shift(2,0),a.write_shift(4,842412599),a.write_shift(16,UB.utils.consts.HEADER_CLSID,"hex"),a.write_shift(4,i?2:1),a.write_shift(16,t,"hex"),a.write_shift(4,i?68:48);var l=jV(e,r,n);if(s.push(l),i){var c=jV(i,null,null);a.write_shift(16,o,"hex"),a.write_shift(4,68+l.length),s.push(c)}return VH(s)}function zV(e,t){return e.read_shift(t),null}function qV(e,t){return 1===e.read_shift(t)}function GV(e,t){return t||(t=$j(2)),t.write_shift(2,+!!e),t}function $V(e){return e.read_shift(2,"u")}function KV(e,t){return t||(t=$j(2)),t.write_shift(2,e),t}function YV(e,t){return function(e,t,r){for(var n=[],i=e.l+t;e.l<i;)n.push(r(e,i-e.l));if(i!==e.l)throw new Error("Slurp error");return n}(e,t,$V)}function XV(e,t,r){return r||(r=$j(2)),r.write_shift(1,"e"==t?+e:+!!e),r.write_shift(1,"e"==t?1:0),r}function JV(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont",o=bH;(r&&r.biff>=8&&(bH=1200),r&&8!=r.biff)?12==r.biff&&(i="wstr"):e.read_shift(1)&&(i="dbcs-cont");r.biff>=2&&r.biff<=5&&(i="cpstr");var a=n?e.read_shift(n,i):"";return bH=o,a}function ZV(e){var t=bH;bH=1200;var r,n=e.read_shift(2),i=e.read_shift(1),o=4&i,a=8&i,s=1+(1&i),l=0,c={};a&&(l=e.read_shift(2)),o&&(r=e.read_shift(4));var u=2==s?"dbcs-cont":"sbcs-cont",h=0===n?"":e.read_shift(n,u);return a&&(e.l+=4*l),o&&(e.l+=r),c.t=h,a||(c.raw="<t>"+c.t+"</t>",c.r=c.t),bH=t,c}function QV(e){var t=e.t||"",r=$j(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=$j(2*t.length);return n.write_shift(2*t.length,t,"utf16le"),VH([r,n])}function ez(e,t,r){if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}return 0===e.read_shift(1)?e.read_shift(t,"sbcs-cont"):e.read_shift(t,"dbcs-cont")}function tz(e,t,r){var n=e.read_shift(r&&2==r.biff?1:2);return 0===n?(e.l++,""):ez(e,n,r)}function rz(e,t,r){if(r.biff>5)return tz(e,0,r);var n=e.read_shift(1);return 0===n?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function nz(e,t,r){return r||(r=$j(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function iz(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return function(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,"795881f43b1d7f48af2c825dc4852763"===e.read_shift(16)&&(n=!0),e.l=r);var i=e.read_shift((n?t-24:t)>>1,"utf16le").replace(zH,"");return n&&(e.l+=24),i}(e);case"0303000000000000c000000000000046":return function(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,57005!=e.read_shift(2))throw new Error("Bad FileMoniker");if(0===e.read_shift(4))return r+n.replace(/\\/g,"/");var i=e.read_shift(4);if(3!=e.read_shift(2))throw new Error("Bad FileMoniker");return r+e.read_shift(i>>1,"utf16le").replace(zH,"")}(e);default:throw new Error("Unsupported Moniker "+r)}}function oz(e){var t=e.read_shift(4);return t>0?e.read_shift(t,"utf16le").replace(zH,""):""}function az(e,t){t||(t=$j(6+2*e.length)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function sz(e){var t=$j(512),r=0,n=e.Target;"file://"==n.slice(0,7)&&(n=n.slice(7));var i=n.indexOf("#"),o=i>-1?31:23;switch(n.charAt(0)){case"#":o=28;break;case".":o&=-3}t.write_shift(4,2),t.write_shift(4,o);var a=[8,6815827,6619237,4849780,83];for(r=0;r<a.length;++r)t.write_shift(4,a[r]);if(28==o)az(n=n.slice(1),t);else if(2&o){for(a="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<a.length;++r)t.write_shift(1,parseInt(a[r],16));var s=i>-1?n.slice(0,i):n;for(t.write_shift(4,2*(s.length+1)),r=0;r<s.length;++r)t.write_shift(2,s.charCodeAt(r));t.write_shift(2,0),8&o&&az(i>-1?n.slice(i+1):"",t)}else{for(a="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<a.length;++r)t.write_shift(1,parseInt(a[r],16));for(var l=0;"../"==n.slice(3*l,3*l+3)||"..\\"==n.slice(3*l,3*l+3);)++l;for(t.write_shift(2,l),t.write_shift(4,n.length-3*l+1),r=0;r<n.length-3*l;++r)t.write_shift(1,255&n.charCodeAt(r+3*l));for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function lz(e){return[e.read_shift(1),e.read_shift(1),e.read_shift(1),e.read_shift(1)]}function cz(e,t){var r=lz(e);return r[3]=0,r}function uz(e){return{r:e.read_shift(2),c:e.read_shift(2),ixfe:e.read_shift(2)}}function hz(e,t,r,n){return n||(n=$j(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function dz(e,t,r){var n=r.biff>8?4:2;return[e.read_shift(n),e.read_shift(n,"i"),e.read_shift(n,"i")]}function fz(e){return[e.read_shift(2),PW(e)]}function gz(e){var t=e.read_shift(2),r=e.read_shift(2);return{s:{c:e.read_shift(2),r:t},e:{c:e.read_shift(2),r:r}}}function pz(e,t){return t||(t=$j(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function mz(e){var t=e.read_shift(2),r=e.read_shift(2);return{s:{c:e.read_shift(1),r:t},e:{c:e.read_shift(1),r:r}}}var vz=mz;function bz(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function yz(e){e.l+=2,e.l+=e.read_shift(2)}var wz={0:yz,4:yz,5:yz,6:yz,7:function(e){return e.l+=4,e.cf=e.read_shift(2),{}},8:yz,9:yz,10:yz,11:yz,12:yz,13:function(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t},14:yz,15:yz,16:yz,17:yz,18:yz,19:yz,20:yz,21:bz};function Sz(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),(t-=2)>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function Cz(e,t,r){var n=1536,i=16;switch(r.bookType){case"biff8":case"xla":break;case"biff5":n=1280,i=8;break;case"biff4":n=4,i=6;break;case"biff3":n=3,i=6;break;case"biff2":n=2,i=4;break;default:throw new Error("unsupported BIFF version")}var o=$j(i);return o.write_shift(2,n),o.write_shift(2,t),i>4&&o.write_shift(2,29282),i>6&&o.write_shift(2,1997),i>8&&(o.write_shift(2,49161),o.write_shift(2,1),o.write_shift(2,1798),o.write_shift(2,0)),o}function kz(e,t){var r=!t||t.biff>=8?2:1,n=$j(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var i=n.slice(0,n.l);return i.l=n.l,i}function xz(e,t,r){var n=0;r&&2==r.biff||(n=e.read_shift(2));var i=e.read_shift(2);return r&&2==r.biff&&(n=1-(i>>15),i&=32767),[{Unsynced:1&n,DyZero:(2&n)>>1,ExAsc:(4&n)>>2,ExDsc:(8&n)>>3},i]}function Ez(e,t,r,n){var i=r&&5==r.biff;n||(n=$j(i?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(i?1:2,t.length),i||n.write_shift(1,1),n.write_shift((i?1:2)*t.length,t,i?"sbcs":"utf16le");var o=n.length>n.l?n.slice(0,n.l):n;return null==o.l&&(o.l=o.length),o}var Tz=rz;function _z(e,t,r){var n=e.l+t,i=8!=r.biff&&r.biff?2:4,o=e.read_shift(i),a=e.read_shift(i),s=e.read_shift(2),l=e.read_shift(2);return e.l=n,{s:{r:o,c:s},e:{r:a,c:l}}}function Az(e,t,r,n){var i=r&&5==r.biff;n||(n=$j(i?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var o=0;return e.numFmtId>0&&i&&(o|=1024),n.write_shift(4,o),n.write_shift(4,0),i||n.write_shift(4,0),n.write_shift(2,0),n}function Rz(e,t,r){var n=uz(e);2!=r.biff&&9!=t||++e.l;var i=function(e){var t=e.read_shift(1);return 1===e.read_shift(1)?t:1===t}(e);return n.val=i,n.t=!0===i||!1===i?"b":"e",n}var Oz=function(e,t,r){return 0===t?"":rz(e,0,r)};function Mz(e,t,r){var n,i=e.read_shift(2),o={fBuiltIn:1&i,fWantAdvise:i>>>1&1,fWantPict:i>>>2&1,fOle:i>>>3&1,fOleLink:i>>>4&1,cf:i>>>5&1023,fIcon:i>>>15&1};return 14849===r.sbcch&&(n=function(e,t,r){e.l+=4,t-=4;var n=e.l+t,i=JV(e,0,r),o=e.read_shift(2);if(o!==(n-=e.l))throw new Error("Malformed AddinUdf: padding = "+n+" != "+o);return e.l+=o,i}(e,t-2,r)),o.body=n||e.read_shift(t-2),"string"===typeof n&&(o.Name=n),o}var Iz=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function Pz(e,t,r){var n=e.l+t,i=e.read_shift(2),o=e.read_shift(1),a=e.read_shift(1),s=e.read_shift(r&&2==r.biff?1:2),l=0;(!r||r.biff>=5)&&(5!=r.biff&&(e.l+=2),l=e.read_shift(2),5==r.biff&&(e.l+=2),e.l+=4);var c=ez(e,a,r);32&i&&(c=Iz[c.charCodeAt(0)]);var u=n-e.l;r&&2==r.biff&&--u;var h=n!=e.l&&0!==s&&u>0?function(e,t,r,n){var i,o=e.l+t,a=JG(e,n,r);o!==e.l&&(i=XG(e,o-e.l,a,r));return[a,i]}(e,u,r,s):[];return{chKey:o,Name:c,itab:l,rgce:h}}function Nz(e,t,r){if(r.biff<8)return function(e,t,r){3==e[e.l+1]&&e[e.l]++;var n=JV(e,0,r);return 3==n.charCodeAt(0)?n.slice(1):n}(e,0,r);for(var n=[],i=e.l+t,o=e.read_shift(r.biff>8?4:2);0!==o--;)n.push(dz(e,r.biff,r));if(e.l!=i)throw new Error("Bad ExternSheet: "+e.l+" != "+i);return n}function Dz(e,t,r){var n=vz(e,6);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,n$(e,t,r)]}var Fz={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var i=e.read_shift(1);return e.l+=i,e.l=r,{fmt:n}}};function Lz(e){var t=$j(24),r=oW(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)t.write_shift(1,parseInt(n[i],16));return VH([t,sz(e[1])])}function Hz(e){var t=e[1].Tooltip,r=$j(10+2*(t.length+1));r.write_shift(2,2048);var n=oW(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var i=0;i<t.length;++i)r.write_shift(2,t.charCodeAt(i));return r.write_shift(2,0),r}function Bz(e,t,r){if(!r.cellStyles)return Gj(e,t);var n=r&&r.biff>=12?4:2,i=e.read_shift(n),o=e.read_shift(n),a=e.read_shift(n),s=e.read_shift(n),l=e.read_shift(2);2==n&&(e.l+=2);var c={s:i,e:o,w:a,ixfe:s,flags:l};return(r.biff>=5||!r.biff)&&(c.level=l>>8&7),c}var Uz=uz,jz=YV,Wz=tz;var Vz=[2,3,48,49,131,139,140,245],zz=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=GB({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(t,r){var n=r||{};n.dateNF||(n.dateNF="yyyymmdd");var i=gW(function(t,r){var n=[],i=LH(1);switch(r.type){case"base64":i=BH(NH(t));break;case"binary":i=BH(t);break;case"buffer":case"array":i=t}qj(i,0);var o=i.read_shift(1),a=!!(136&o),s=!1,l=!1;switch(o){case 2:case 3:case 131:case 139:case 245:break;case 48:case 49:s=!0,a=!0;break;case 140:l=!0;break;default:throw new Error("DBF Unsupported Version: "+o.toString(16))}var c=0,u=521;2==o&&(c=i.read_shift(2)),i.l+=3,2!=o&&(c=i.read_shift(4)),c>1048576&&(c=1e6),2!=o&&(u=i.read_shift(2));var h=i.read_shift(2),d=r.codepage||1252;2!=o&&(i.l+=16,i.read_shift(1),0!==i[i.l]&&(d=e[i[i.l]]),i.l+=1,i.l+=2),l&&(i.l+=36);for(var f=[],g={},p=Math.min(i.length,2==o?521:u-10-(s?264:0)),m=l?32:11;i.l<p&&13!=i[i.l];)switch((g={}).name=_H.utils.decode(d,i.slice(i.l,i.l+m)).replace(/[\u0000\r\n].*$/g,""),i.l+=m,g.type=String.fromCharCode(i.read_shift(1)),2==o||l||(g.offset=i.read_shift(4)),g.len=i.read_shift(1),2==o&&(g.offset=i.read_shift(2)),g.dec=i.read_shift(1),g.name.length&&f.push(g),2!=o&&(i.l+=l?13:14),g.type){case"B":s&&8==g.len||!r.WTF||console.log("Skipping "+g.name+":"+g.type);break;case"G":case"P":r.WTF&&console.log("Skipping "+g.name+":"+g.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+g.type)}if(13!==i[i.l]&&(i.l=u-1),13!==i.read_shift(1))throw new Error("DBF Terminator not found "+i.l+" "+i[i.l]);i.l=u;var v=0,b=0;for(n[0]=[],b=0;b!=f.length;++b)n[0][b]=f[b].name;for(;c-- >0;)if(42!==i[i.l])for(++i.l,n[++v]=[],b=0,b=0;b!=f.length;++b){var y=i.slice(i.l,i.l+f[b].len);i.l+=f[b].len,qj(y,0);var w=_H.utils.decode(d,y);switch(f[b].type){case"C":w.trim().length&&(n[v][b]=w.replace(/\s+$/,""));break;case"D":8===w.length?n[v][b]=new Date(+w.slice(0,4),+w.slice(4,6)-1,+w.slice(6,8)):n[v][b]=w;break;case"F":n[v][b]=parseFloat(w.trim());break;case"+":case"I":n[v][b]=l?2147483648^y.read_shift(-4,"i"):y.read_shift(4,"i");break;case"L":switch(w.trim().toUpperCase()){case"Y":case"T":n[v][b]=!0;break;case"N":case"F":n[v][b]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+w+"|")}break;case"M":if(!a)throw new Error("DBF Unexpected MEMO for type "+o.toString(16));n[v][b]="##MEMO##"+(l?parseInt(w.trim(),10):y.read_shift(4));break;case"N":(w=w.replace(/\u0000/g,"").trim())&&"."!=w&&(n[v][b]=+w||0);break;case"@":n[v][b]=new Date(y.read_shift(-8,"f")-621356832e5);break;case"T":n[v][b]=new Date(864e5*(y.read_shift(4)-2440588)+y.read_shift(4));break;case"Y":n[v][b]=y.read_shift(4,"i")/1e4+y.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":n[v][b]=-y.read_shift(-8,"f");break;case"B":if(s&&8==f[b].len){n[v][b]=y.read_shift(8,"f");break}case"G":case"P":y.l+=f[b].len;break;case"0":if("_NullFlags"===f[b].name)break;default:throw new Error("DBF Unsupported data type "+f[b].type)}}else i.l+=h;if(2!=o&&i.l<i.length&&26!=i[i.l++])throw new Error("DBF EOF Marker missing "+(i.l-1)+" of "+i.length+" "+i[i.l-1].toString(16));return r&&r.sheetRows&&(n=n.slice(0,r.sheetRows)),r.DBF=f,n}(t,n),n);return i["!cols"]=n.DBF.map((function(e){return{wch:e.len,DBF:e}})),delete n.DBF,i}var n={B:8,C:250,L:1,D:8,"?":0,"":0};return{to_workbook:function(e,t){try{return dW(r(e,t),t)}catch(oJ){if(t&&t.WTF)throw oJ}return{SheetNames:[],Sheets:{}}},to_sheet:r,from_sheet:function(e,r){var i=r||{};if(+i.codepage>=0&&kH(+i.codepage),"string"==i.type)throw new Error("Cannot write DBF to JS string");var o=Yj(),a=RX(e,{header:1,raw:!0,cellDates:!0}),s=a[0],l=a.slice(1),c=e["!cols"]||[],u=0,h=0,d=0,f=1;for(u=0;u<s.length;++u)if(((c[u]||{}).DBF||{}).name)s[u]=c[u].DBF.name,++d;else if(null!=s[u]){if(++d,"number"===typeof s[u]&&(s[u]=s[u].toString(10)),"string"!==typeof s[u])throw new Error("DBF Invalid column name "+s[u]+" |"+typeof s[u]+"|");if(s.indexOf(s[u])!==u)for(h=0;h<1024;++h)if(-1==s.indexOf(s[u]+"_"+h)){s[u]+="_"+h;break}}var g=cW(e["!ref"]),p=[],m=[],v=[];for(u=0;u<=g.e.c-g.s.c;++u){var b="",y="",w=0,S=[];for(h=0;h<l.length;++h)null!=l[h][u]&&S.push(l[h][u]);if(0!=S.length&&null!=s[u]){for(h=0;h<S.length;++h){switch(typeof S[h]){case"number":y="B";break;case"string":default:y="C";break;case"boolean":y="L";break;case"object":y=S[h]instanceof Date?"D":"C"}w=Math.max(w,String(S[h]).length),b=b&&b!=y?"C":y}w>250&&(w=250),"C"==(y=((c[u]||{}).DBF||{}).type)&&c[u].DBF.len>w&&(w=c[u].DBF.len),"B"==b&&"N"==y&&(b="N",v[u]=c[u].DBF.dec,w=c[u].DBF.len),m[u]="C"==b||"N"==y?w:n[b]||0,f+=m[u],p[u]=b}else p[u]="?"}var C=o.next(32);for(C.write_shift(4,318902576),C.write_shift(4,l.length),C.write_shift(2,296+32*d),C.write_shift(2,f),u=0;u<4;++u)C.write_shift(4,0);for(C.write_shift(4,(+t[yH]||3)<<8),u=0,h=0;u<s.length;++u)if(null!=s[u]){var k=o.next(32),x=(s[u].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);k.write_shift(1,x,"sbcs"),k.write_shift(1,"?"==p[u]?"C":p[u],"sbcs"),k.write_shift(4,h),k.write_shift(1,m[u]||n[p[u]]||0),k.write_shift(1,v[u]||0),k.write_shift(1,2),k.write_shift(4,0),k.write_shift(1,0),k.write_shift(4,0),k.write_shift(4,0),h+=m[u]||n[p[u]]||0}var E=o.next(264);for(E.write_shift(4,13),u=0;u<65;++u)E.write_shift(4,0);for(u=0;u<l.length;++u){var T=o.next(f);for(T.write_shift(1,0),h=0;h<s.length;++h)if(null!=s[h])switch(p[h]){case"L":T.write_shift(1,null==l[u][h]?63:l[u][h]?84:70);break;case"B":T.write_shift(8,l[u][h]||0,"f");break;case"N":var _="0";for("number"==typeof l[u][h]&&(_=l[u][h].toFixed(v[h]||0)),d=0;d<m[h]-_.length;++d)T.write_shift(1,32);T.write_shift(1,_,"sbcs");break;case"D":l[u][h]?(T.write_shift(4,("0000"+l[u][h].getFullYear()).slice(-4),"sbcs"),T.write_shift(2,("00"+(l[u][h].getMonth()+1)).slice(-2),"sbcs"),T.write_shift(2,("00"+l[u][h].getDate()).slice(-2),"sbcs")):T.write_shift(8,"00000000","sbcs");break;case"C":var A=String(null!=l[u][h]?l[u][h]:"").slice(0,m[h]);for(T.write_shift(1,A,"sbcs"),d=0;d<m[h]-A.length;++d)T.write_shift(1,32)}}return o.next(1).write_shift(1,26),o.end()}}}(),qz=function(){var e={AA:"\xc0",BA:"\xc1",CA:"\xc2",DA:195,HA:"\xc4",JA:197,AE:"\xc8",BE:"\xc9",CE:"\xca",HE:"\xcb",AI:"\xcc",BI:"\xcd",CI:"\xce",HI:"\xcf",AO:"\xd2",BO:"\xd3",CO:"\xd4",DO:213,HO:"\xd6",AU:"\xd9",BU:"\xda",CU:"\xdb",HU:"\xdc",Aa:"\xe0",Ba:"\xe1",Ca:"\xe2",Da:227,Ha:"\xe4",Ja:229,Ae:"\xe8",Be:"\xe9",Ce:"\xea",He:"\xeb",Ai:"\xec",Bi:"\xed",Ci:"\xee",Hi:"\xef",Ao:"\xf2",Bo:"\xf3",Co:"\xf4",Do:245,Ho:"\xf6",Au:"\xf9",Bu:"\xfa",Cu:"\xfb",Hu:"\xfc",KC:"\xc7",Kc:"\xe7",q:"\xe6",z:"\u0153",a:"\xc6",j:"\u0152",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1bN("+zB(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(t,r){var n=e[r];return"number"==typeof n?OH(n):n},n=function(e,t,r){var n=t.charCodeAt(0)-32<<4|r.charCodeAt(0)-48;return 59==n?e:OH(n)};function i(e,i){var o,a=e.split(/[\n\r]+/),s=-1,l=-1,c=0,u=0,h=[],d=[],f=null,g={},p=[],m=[],v=[],b=0;for(+i.codepage>=0&&kH(+i.codepage);c!==a.length;++c){b=0;var y,w=a[c].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),S=w.replace(/;;/g,"\0").split(";").map((function(e){return e.replace(/\u0000/g,";")})),C=S[0];if(w.length>0)switch(C){case"ID":case"E":case"B":case"O":case"W":break;case"P":"P"==S[1].charAt(0)&&d.push(w.slice(3).replace(/;;/g,";"));break;case"C":var k=!1,x=!1,E=!1,T=!1,_=-1,A=-1;for(u=1;u<S.length;++u)switch(S[u].charAt(0)){case"A":case"G":break;case"X":l=parseInt(S[u].slice(1))-1,x=!0;break;case"Y":for(s=parseInt(S[u].slice(1))-1,x||(l=0),o=h.length;o<=s;++o)h[o]=[];break;case"K":'"'===(y=S[u].slice(1)).charAt(0)?y=y.slice(1,y.length-1):"TRUE"===y?y=!0:"FALSE"===y?y=!1:isNaN(lU(y))?isNaN(uU(y).getDate())||(y=iU(y)):(y=lU(y),null!==f&&RB(f)&&(y=QB(y))),"undefined"!==typeof _H&&"string"==typeof y&&"string"!=(i||{}).type&&(i||{}).codepage&&(y=_H.utils.decode(i.codepage,y)),k=!0;break;case"E":T=!0;var R=EG(S[u].slice(1),{r:s,c:l});h[s][l]=[h[s][l],R];break;case"S":E=!0,h[s][l]=[h[s][l],"S5S"];break;case"R":_=parseInt(S[u].slice(1))-1;break;case"C":A=parseInt(S[u].slice(1))-1;break;default:if(i&&i.WTF)throw new Error("SYLK bad record "+w)}if(k&&(h[s][l]&&2==h[s][l].length?h[s][l][0]=y:h[s][l]=y,f=null),E){if(T)throw new Error("SYLK shared formula cannot have own formula");var O=_>-1&&h[_][A];if(!O||!O[1])throw new Error("SYLK shared formula cannot find base");h[s][l][1]=AG(O[1],{r:s-_,c:l-A})}break;case"F":var M=0;for(u=1;u<S.length;++u)switch(S[u].charAt(0)){case"X":l=parseInt(S[u].slice(1))-1,++M;break;case"Y":for(s=parseInt(S[u].slice(1))-1,o=h.length;o<=s;++o)h[o]=[];break;case"M":b=parseInt(S[u].slice(1))/20;break;case"F":case"G":case"S":case"D":case"N":break;case"P":f=d[parseInt(S[u].slice(1))];break;case"W":for(v=S[u].slice(1).split(" "),o=parseInt(v[0],10);o<=parseInt(v[1],10);++o)b=parseInt(v[2],10),m[o-1]=0===b?{hidden:!0}:{wch:b},Nq(m[o-1]);break;case"C":m[l=parseInt(S[u].slice(1))-1]||(m[l]={});break;case"R":p[s=parseInt(S[u].slice(1))-1]||(p[s]={}),b>0?(p[s].hpt=b,p[s].hpx=Lq(b)):0===b&&(p[s].hidden=!0);break;default:if(i&&i.WTF)throw new Error("SYLK bad record "+w)}M<1&&(f=null);break;default:if(i&&i.WTF)throw new Error("SYLK bad record "+w)}}return p.length>0&&(g["!rows"]=p),m.length>0&&(g["!cols"]=m),i&&i.sheetRows&&(h=h.slice(0,i.sheetRows)),[h,g]}function o(e,t){var r=function(e,t){switch(t.type){case"base64":return i(NH(e),t);case"binary":return i(e,t);case"buffer":return i(DH&&Buffer.isBuffer(e)?e.toString("binary"):jH(e),t);case"array":return i(oU(e),t)}throw new Error("Unrecognized type "+t.type)}(e,t),n=r[0],o=r[1],a=gW(n,t);return zB(o).forEach((function(e){a[e]=o[e]})),a}function a(e,t,r,n){var i="C;Y"+(r+1)+";X"+(n+1)+";K";switch(e.t){case"n":i+=e.v||0,e.f&&!e.F&&(i+=";E"+_G(e.f,{r:r,c:n}));break;case"b":i+=e.v?"TRUE":"FALSE";break;case"e":i+=e.w||e.v;break;case"d":i+='"'+(e.w||e.v)+'"';break;case"s":i+='"'+e.v.replace(/"/g,"").replace(/;/g,";;")+'"'}return i}return e["|"]=254,{to_workbook:function(e,t){return dW(o(e,t),t)},to_sheet:o,from_sheet:function(e,t){var r,n,i=["ID;PWXL;N;E"],o=[],s=cW(e["!ref"]),l=Array.isArray(e),c="\r\n";i.push("P;PGeneral"),i.push("F;P0;DG0G8;M255"),e["!cols"]&&(n=i,e["!cols"].forEach((function(e,t){var r="F;W"+(t+1)+" "+(t+1)+" ";e.hidden?r+="0":("number"!=typeof e.width||e.wpx||(e.wpx=Rq(e.width)),"number"!=typeof e.wpx||e.wch||(e.wch=Oq(e.wpx)),"number"==typeof e.wch&&(r+=Math.round(e.wch)))," "!=r.charAt(r.length-1)&&n.push(r)}))),e["!rows"]&&function(e,t){t.forEach((function(t,r){var n="F;";t.hidden?n+="M0;":t.hpt?n+="M"+20*t.hpt+";":t.hpx&&(n+="M"+20*Fq(t.hpx)+";"),n.length>2&&e.push(n+"R"+(r+1))}))}(i,e["!rows"]),i.push("B;Y"+(s.e.r-s.s.r+1)+";X"+(s.e.c-s.s.c+1)+";D"+[s.s.c,s.s.r,s.e.c,s.e.r].join(" "));for(var u=s.s.r;u<=s.e.r;++u)for(var h=s.s.c;h<=s.e.c;++h){var d=aW({r:u,c:h});(r=l?(e[u]||[])[h]:e[d])&&(null!=r.v||r.f&&!r.F)&&o.push(a(r,0,u,h))}return i.join(c)+c+o.join(c)+c+"E"+c}}}(),Gz=function(){function e(e,t){for(var r=e.split("\n"),n=-1,i=-1,o=0,a=[];o!==r.length;++o)if("BOT"!==r[o].trim()){if(!(n<0)){for(var s=r[o].trim().split(","),l=s[0],c=s[1],u=r[++o]||"";1&(u.match(/["]/g)||[]).length&&o<r.length-1;)u+="\n"+r[++o];switch(u=u.trim(),+l){case-1:if("BOT"===u){a[++n]=[],i=0;continue}if("EOD"!==u)throw new Error("Unrecognized DIF special command "+u);break;case 0:"TRUE"===u?a[n][i]=!0:"FALSE"===u?a[n][i]=!1:isNaN(lU(c))?isNaN(uU(c).getDate())?a[n][i]=c:a[n][i]=iU(c):a[n][i]=lU(c),++i;break;case 1:(u=(u=u.slice(1,u.length-1)).replace(/""/g,'"'))&&u.match(/^=".*"$/)&&(u=u.slice(2,-1)),a[n][i++]=""!==u?u:null}if("EOD"===u)break}}else a[++n]=[],i=0;return t&&t.sheetRows&&(a=a.slice(0,t.sheetRows)),a}function t(t,r){return gW(function(t,r){switch(r.type){case"base64":return e(NH(t),r);case"binary":return e(t,r);case"buffer":return e(DH&&Buffer.isBuffer(t)?t.toString("binary"):jH(t),r);case"array":return e(oU(t),r)}throw new Error("Unrecognized type "+r.type)}(t,r),r)}var r=function(){var e=function(e,t,r,n,i){e.push(t),e.push(r+","+n),e.push('"'+i.replace(/"/g,'""')+'"')},t=function(e,t,r,n){e.push(t+","+r),e.push(1==t?'"'+n.replace(/"/g,'""')+'"':n)};return function(r){var n,i=[],o=cW(r["!ref"]),a=Array.isArray(r);e(i,"TABLE",0,1,"sheetjs"),e(i,"VECTORS",0,o.e.r-o.s.r+1,""),e(i,"TUPLES",0,o.e.c-o.s.c+1,""),e(i,"DATA",0,0,"");for(var s=o.s.r;s<=o.e.r;++s){t(i,-1,0,"BOT");for(var l=o.s.c;l<=o.e.c;++l){var c=aW({r:s,c:l});if(n=a?(r[s]||[])[l]:r[c])switch(n.t){case"n":var u=n.w;u||null==n.v||(u=n.v),null==u?n.f&&!n.F?t(i,1,0,"="+n.f):t(i,1,0,""):t(i,0,u,"V");break;case"b":t(i,0,n.v?1:0,n.v?"TRUE":"FALSE");break;case"s":t(i,1,0,isNaN(n.v)?n.v:'="'+n.v+'"');break;case"d":n.w||(n.w=PB(n.z||tB[14],YB(iU(n.v)))),t(i,0,n.w,"V");break;default:t(i,1,0,"")}else t(i,1,0,"")}}t(i,-1,0,"EOD");return i.join("\r\n")}}();return{to_workbook:function(e,r){return dW(t(e,r),r)},to_sheet:t,from_sheet:r}}(),$z=function(){function e(e){return e.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(e,t){return gW(function(e,t){for(var r=e.split("\n"),n=-1,i=-1,o=0,a=[];o!==r.length;++o){var s=r[o].trim().split(":");if("cell"===s[0]){var l=oW(s[1]);if(a.length<=l.r)for(n=a.length;n<=l.r;++n)a[n]||(a[n]=[]);switch(n=l.r,i=l.c,s[2]){case"t":a[n][i]=s[3].replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,"\n");break;case"v":a[n][i]=+s[3];break;case"vtf":var c=s[s.length-1];case"vtc":"nl"===s[3]?a[n][i]=!!+s[4]:a[n][i]=+s[4],"vtf"==s[2]&&(a[n][i]=[a[n][i],c])}}}return t&&t.sheetRows&&(a=a.slice(0,t.sheetRows)),a}(e,t),t)}var r=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join("\n"),n=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join("\n")+"\n",i=["# SocialCalc Spreadsheet Control Save","part:sheet"].join("\n"),o="--SocialCalcSpreadsheetControlSave--";function a(t){if(!t||!t["!ref"])return"";for(var r,n=[],i=[],o="",a=sW(t["!ref"]),s=Array.isArray(t),l=a.s.r;l<=a.e.r;++l)for(var c=a.s.c;c<=a.e.c;++c)if(o=aW({r:l,c:c}),(r=s?(t[l]||[])[c]:t[o])&&null!=r.v&&"z"!==r.t){switch(i=["cell",o,"t"],r.t){case"s":case"str":i.push(e(r.v));break;case"n":r.f?(i[2]="vtf",i[3]="n",i[4]=r.v,i[5]=e(r.f)):(i[2]="v",i[3]=r.v);break;case"b":i[2]="vt"+(r.f?"f":"c"),i[3]="nl",i[4]=r.v?"1":"0",i[5]=e(r.f||(r.v?"TRUE":"FALSE"));break;case"d":var u=YB(iU(r.v));i[2]="vtc",i[3]="nd",i[4]=""+u,i[5]=r.w||PB(r.z||tB[14],u);break;case"e":continue}n.push(i.join(":"))}return n.push("sheet:c:"+(a.e.c-a.s.c+1)+":r:"+(a.e.r-a.s.r+1)+":tvf:1"),n.push("valueformat:1:text-wiki"),n.join("\n")}return{to_workbook:function(e,r){return dW(t(e,r),r)},to_sheet:t,from_sheet:function(e){return[r,n,i,n,a(e),o].join("\n")}}}(),Kz=function(){function e(e,t,r,n,i){i.raw?t[r][n]=e:""===e||("TRUE"===e?t[r][n]=!0:"FALSE"===e?t[r][n]=!1:isNaN(lU(e))?isNaN(uU(e).getDate())?t[r][n]=e:t[r][n]=iU(e):t[r][n]=lU(e))}var t={44:",",9:"\t",59:";",124:"|"},r={44:3,9:2,59:1,124:0};function n(e){for(var n={},i=!1,o=0,a=0;o<e.length;++o)34==(a=e.charCodeAt(o))?i=!i:!i&&a in t&&(n[a]=(n[a]||0)+1);for(o in a=[],n)Object.prototype.hasOwnProperty.call(n,o)&&a.push([n[o],o]);if(!a.length)for(o in n=r)Object.prototype.hasOwnProperty.call(n,o)&&a.push([n[o],o]);return a.sort((function(e,t){return e[0]-t[0]||r[e[1]]-r[t[1]]})),t[a.pop()[1]]||44}function i(e,t){var r=t||{},i="";null!=MH&&null==r.dense&&(r.dense=MH);var o=r.dense?[]:{},a={s:{c:0,r:0},e:{c:0,r:0}};"sep="==e.slice(0,4)?13==e.charCodeAt(5)&&10==e.charCodeAt(6)?(i=e.charAt(4),e=e.slice(7)):13==e.charCodeAt(5)||10==e.charCodeAt(5)?(i=e.charAt(4),e=e.slice(6)):i=n(e.slice(0,1024)):i=r&&r.FS?r.FS:n(e.slice(0,1024));var s=0,l=0,c=0,u=0,h=0,d=i.charCodeAt(0),f=!1,g=0,p=e.charCodeAt(0);e=e.replace(/\r\n/gm,"\n");var m=null!=r.dateNF?function(e){var t="number"==typeof e?tB[e]:e;return t=t.replace(HB,"(\\d+)"),new RegExp("^"+t+"$")}(r.dateNF):null;function v(){var t=e.slice(u,h),n={};if('"'==t.charAt(0)&&'"'==t.charAt(t.length-1)&&(t=t.slice(1,-1).replace(/""/g,'"')),0===t.length)n.t="z";else if(r.raw)n.t="s",n.v=t;else if(0===t.trim().length)n.t="s",n.v=t;else if(61==t.charCodeAt(0))34==t.charCodeAt(1)&&34==t.charCodeAt(t.length-1)?(n.t="s",n.v=t.slice(2,-1).replace(/""/g,'"')):1!=t.length?(n.t="n",n.f=t.slice(1)):(n.t="s",n.v=t);else if("TRUE"==t)n.t="b",n.v=!0;else if("FALSE"==t)n.t="b",n.v=!1;else if(isNaN(c=lU(t)))if(!isNaN(uU(t).getDate())||m&&t.match(m)){n.z=r.dateNF||tB[14];var i=0;m&&t.match(m)&&(t=function(e,t,r){var n=-1,i=-1,o=-1,a=-1,s=-1,l=-1;(t.match(HB)||[]).forEach((function(e,t){var c=parseInt(r[t+1],10);switch(e.toLowerCase().charAt(0)){case"y":n=c;break;case"d":o=c;break;case"h":a=c;break;case"s":l=c;break;case"m":a>=0?s=c:i=c}})),l>=0&&-1==s&&i>=0&&(s=i,i=-1);var c=(""+(n>=0?n:(new Date).getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(o>=1?o:1)).slice(-2);7==c.length&&(c="0"+c),8==c.length&&(c="20"+c);var u=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return-1==a&&-1==s&&-1==l?c:-1==n&&-1==i&&-1==o?u:c+"T"+u}(0,r.dateNF,t.match(m)||[]),i=1),r.cellDates?(n.t="d",n.v=iU(t,i)):(n.t="n",n.v=YB(iU(t,i))),!1!==r.cellText&&(n.w=PB(n.z,n.v instanceof Date?YB(n.v):n.v)),r.cellNF||delete n.z}else n.t="s",n.v=t;else n.t="n",!1!==r.cellText&&(n.w=t),n.v=c;if("z"==n.t||(r.dense?(o[s]||(o[s]=[]),o[s][l]=n):o[aW({c:l,r:s})]=n),u=h+1,p=e.charCodeAt(u),a.e.c<l&&(a.e.c=l),a.e.r<s&&(a.e.r=s),g==d)++l;else if(l=0,++s,r.sheetRows&&r.sheetRows<=s)return!0}e:for(;h<e.length;++h)switch(g=e.charCodeAt(h)){case 34:34===p&&(f=!f);break;case d:case 10:case 13:if(!f&&v())break e}return h-u>0&&v(),o["!ref"]=lW(a),o}function o(t,r){return r&&r.PRN?r.FS||"sep="==t.slice(0,4)||t.indexOf("\t")>=0||t.indexOf(",")>=0||t.indexOf(";")>=0?i(t,r):gW(function(t,r){var n=r||{},i=[];if(!t||0===t.length)return i;for(var o=t.split(/[\r\n]/),a=o.length-1;a>=0&&0===o[a].length;)--a;for(var s=10,l=0,c=0;c<=a;++c)-1==(l=o[c].indexOf(" "))?l=o[c].length:l++,s=Math.max(s,l);for(c=0;c<=a;++c){i[c]=[];var u=0;for(e(o[c].slice(0,s).trim(),i,c,u,n),u=1;u<=(o[c].length-s)/10+1;++u)e(o[c].slice(s+10*(u-1),s+10*u).trim(),i,c,u,n)}return n.sheetRows&&(i=i.slice(0,n.sheetRows)),i}(t,r),r):i(t,r)}function a(e,t){var r="",n="string"==t.type?[0,0,0,0]:bX(e,t);switch(t.type){case"base64":r=NH(e);break;case"binary":case"string":r=e;break;case"buffer":r=65001==t.codepage?e.toString("utf8"):t.codepage&&"undefined"!==typeof _H?_H.utils.decode(t.codepage,e):DH&&Buffer.isBuffer(e)?e.toString("binary"):jH(e);break;case"array":r=oU(e);break;default:throw new Error("Unrecognized type "+t.type)}return 239==n[0]&&187==n[1]&&191==n[2]?r=$U(r.slice(3)):"string"!=t.type&&"buffer"!=t.type&&65001==t.codepage?r=$U(r):"binary"==t.type&&"undefined"!==typeof _H&&t.codepage&&(r=_H.utils.decode(t.codepage,_H.utils.encode(28591,r))),"socialcalc:version:"==r.slice(0,19)?$z.to_sheet("string"==t.type?r:$U(r),t):o(r,t)}return{to_workbook:function(e,t){return dW(a(e,t),t)},to_sheet:a,from_sheet:function(e){for(var t,r=[],n=cW(e["!ref"]),i=Array.isArray(e),o=n.s.r;o<=n.e.r;++o){for(var a=[],s=n.s.c;s<=n.e.c;++s){var l=aW({r:o,c:s});if((t=i?(e[o]||[])[s]:e[l])&&null!=t.v){for(var c=(t.w||(hW(t),t.w)||"").slice(0,10);c.length<10;)c+=" ";a.push(c+(0===s?" ":""))}else a.push("          ")}r.push(a.join(""))}return r.join("\n")}}}();var Yz=function(){function e(e,t,r){if(e){qj(e,e.l||0);for(var n=r.Enum||v;e.l<e.length;){var i=e.read_shift(2),o=n[i]||n[65535],a=e.read_shift(2),s=e.l+a,l=o.f&&o.f(e,a,r);if(e.l=s,t(l,o,i))return}}}function t(t,r){if(!t)return t;var n=r||{};null!=MH&&null==n.dense&&(n.dense=MH);var i=n.dense?[]:{},o="Sheet1",a="",s=0,l={},c=[],u=[],h={s:{r:0,c:0},e:{r:0,c:0}},d=n.sheetRows||0;if(0==t[2]&&(8==t[3]||9==t[3])&&t.length>=16&&5==t[14]&&108===t[15])throw new Error("Unsupported Works 3 for Mac file");if(2==t[2])n.Enum=v,e(t,(function(e,t,r){switch(r){case 0:n.vers=e,e>=4096&&(n.qpro=!0);break;case 6:h=e;break;case 204:e&&(a=e);break;case 222:a=e;break;case 15:case 51:n.qpro||(e[1].v=e[1].v.slice(1));case 13:case 14:case 16:14==r&&112==(112&e[2])&&(15&e[2])>1&&(15&e[2])<15&&(e[1].z=n.dateNF||tB[14],n.cellDates&&(e[1].t="d",e[1].v=QB(e[1].v))),n.qpro&&e[3]>s&&(i["!ref"]=lW(h),l[o]=i,c.push(o),i=n.dense?[]:{},h={s:{r:0,c:0},e:{r:0,c:0}},s=e[3],o=a||"Sheet"+(s+1),a="");var u=n.dense?(i[e[0].r]||[])[e[0].c]:i[aW(e[0])];if(u){u.t=e[1].t,u.v=e[1].v,null!=e[1].z&&(u.z=e[1].z),null!=e[1].f&&(u.f=e[1].f);break}n.dense?(i[e[0].r]||(i[e[0].r]=[]),i[e[0].r][e[0].c]=e[1]):i[aW(e[0])]=e[1]}}),n);else{if(26!=t[2]&&14!=t[2])throw new Error("Unrecognized LOTUS BOF "+t[2]);n.Enum=b,14==t[2]&&(n.qpro=!0,t.l=0),e(t,(function(e,t,r){switch(r){case 204:o=e;break;case 22:e[1].v=e[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(e[3]>s&&(i["!ref"]=lW(h),l[o]=i,c.push(o),i=n.dense?[]:{},h={s:{r:0,c:0},e:{r:0,c:0}},s=e[3],o="Sheet"+(s+1)),d>0&&e[0].r>=d)break;n.dense?(i[e[0].r]||(i[e[0].r]=[]),i[e[0].r][e[0].c]=e[1]):i[aW(e[0])]=e[1],h.e.c<e[0].c&&(h.e.c=e[0].c),h.e.r<e[0].r&&(h.e.r=e[0].r);break;case 27:e[14e3]&&(u[e[14e3][0]]=e[14e3][1]);break;case 1537:u[e[0]]=e[1],e[0]==s&&(o=e[1])}}),n)}if(i["!ref"]=lW(h),l[a||o]=i,c.push(a||o),!u.length)return{SheetNames:c,Sheets:l};for(var f={},g=[],p=0;p<u.length;++p)l[c[p]]?(g.push(u[p]||c[p]),f[u[p]]=l[u[p]]||l[c[p]]):(g.push(u[p]),f[u[p]]={"!ref":"A1"});return{SheetNames:g,Sheets:f}}function r(e,t,r){var n=[{c:0,r:0},{t:"n",v:0},0,0];return r.qpro&&20768!=r.vers?(n[0].c=e.read_shift(1),n[3]=e.read_shift(1),n[0].r=e.read_shift(2),e.l+=2):(n[2]=e.read_shift(1),n[0].c=e.read_shift(2),n[0].r=e.read_shift(2)),n}function n(e,t,n){var i=e.l+t,o=r(e,0,n);if(o[1].t="s",20768==n.vers){e.l++;var a=e.read_shift(1);return o[1].v=e.read_shift(a,"utf8"),o}return n.qpro&&e.l++,o[1].v=e.read_shift(i-e.l,"cstr"),o}function i(e,t,r){var n=$j(7+r.length);n.write_shift(1,255),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(1,39);for(var i=0;i<n.length;++i){var o=r.charCodeAt(i);n.write_shift(1,o>=128?95:o)}return n.write_shift(1,0),n}function o(e,t,r){var n=$j(7);return n.write_shift(1,255),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(2,r,"i"),n}function a(e,t,r){var n=$j(13);return n.write_shift(1,255),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(8,r,"f"),n}function s(e,t,r){var n=32768&t;return t=(n?e:0)+((t&=-32769)>=8192?t-16384:t),(n?"":"$")+(r?iW(t):rW(t))}var l={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},c=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function u(e){var t=[{c:0,r:0},{t:"n",v:0},0];return t[0].r=e.read_shift(2),t[3]=e[e.l++],t[0].c=e[e.l++],t}function h(e,t,r,n){var i=$j(6+n.length);i.write_shift(2,e),i.write_shift(1,r),i.write_shift(1,t),i.write_shift(1,39);for(var o=0;o<n.length;++o){var a=n.charCodeAt(o);i.write_shift(1,a>=128?95:a)}return i.write_shift(1,0),i}function d(e,t){var r=u(e),n=e.read_shift(4),i=e.read_shift(4),o=e.read_shift(2);if(65535==o)return 0===n&&3221225472===i?(r[1].t="e",r[1].v=15):0===n&&3489660928===i?(r[1].t="e",r[1].v=42):r[1].v=0,r;var a=32768&o;return o=(32767&o)-16446,r[1].v=(1-2*a)*(i*Math.pow(2,o+32)+n*Math.pow(2,o)),r}function f(e,t,r,n){var i=$j(14);if(i.write_shift(2,e),i.write_shift(1,r),i.write_shift(1,t),0==n)return i.write_shift(4,0),i.write_shift(4,0),i.write_shift(2,65535),i;var o,a=0,s=0,l=0;return n<0&&(a=1,n=-n),s=0|Math.log2(n),0==(2147483648&(l=(n/=Math.pow(2,s-31))>>>0))&&(++s,l=(n/=2)>>>0),n-=l,l|=2147483648,l>>>=0,o=(n*=Math.pow(2,32))>>>0,i.write_shift(4,o),i.write_shift(4,l),s+=16383+(a?32768:0),i.write_shift(2,s),i}function g(e,t){var r=u(e),n=e.read_shift(8,"f");return r[1].v=n,r}function p(e,t){return 0==e[e.l+t-1]?e.read_shift(t,"cstr"):""}function m(e,t){var r=$j(5+e.length);r.write_shift(2,14e3),r.write_shift(2,t);for(var n=0;n<e.length;++n){var i=e.charCodeAt(n);r[r.l++]=i>127?95:i}return r[r.l++]=0,r}var v={0:{n:"BOF",f:$V},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:function(e,t,r){var n={s:{c:0,r:0},e:{c:0,r:0}};return 8==t&&r.qpro?(n.s.c=e.read_shift(1),e.l++,n.s.r=e.read_shift(2),n.e.c=e.read_shift(1),e.l++,n.e.r=e.read_shift(2),n):(n.s.c=e.read_shift(2),n.s.r=e.read_shift(2),12==t&&r.qpro&&(e.l+=2),n.e.c=e.read_shift(2),n.e.r=e.read_shift(2),12==t&&r.qpro&&(e.l+=2),65535==n.s.c&&(n.s.c=n.e.c=n.s.r=n.e.r=0),n)}},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:function(e,t,n){var i=r(e,0,n);return i[1].v=e.read_shift(2,"i"),i}},14:{n:"NUMBER",f:function(e,t,n){var i=r(e,0,n);return i[1].v=e.read_shift(8,"f"),i}},15:{n:"LABEL",f:n},16:{n:"FORMULA",f:function(e,t,n){var i=e.l+t,o=r(e,0,n);if(o[1].v=e.read_shift(8,"f"),n.qpro)e.l=i;else{var a=e.read_shift(2);!function(e,t){qj(e,0);var r=[],n=0,i="",o="",a="",u="";for(;e.l<e.length;){var h=e[e.l++];switch(h){case 0:r.push(e.read_shift(8,"f"));break;case 1:o=s(t[0].c,e.read_shift(2),!0),i=s(t[0].r,e.read_shift(2),!1),r.push(o+i);break;case 2:var d=s(t[0].c,e.read_shift(2),!0),f=s(t[0].r,e.read_shift(2),!1);o=s(t[0].c,e.read_shift(2),!0),i=s(t[0].r,e.read_shift(2),!1),r.push(d+f+":"+o+i);break;case 3:if(e.l<e.length)return void console.error("WK1 premature formula end");break;case 4:r.push("("+r.pop()+")");break;case 5:r.push(e.read_shift(2));break;case 6:for(var g="";h=e[e.l++];)g+=String.fromCharCode(h);r.push('"'+g.replace(/"/g,'""')+'"');break;case 8:r.push("-"+r.pop());break;case 23:r.push("+"+r.pop());break;case 22:r.push("NOT("+r.pop()+")");break;case 20:case 21:u=r.pop(),a=r.pop(),r.push(["AND","OR"][h-20]+"("+a+","+u+")");break;default:if(h<32&&c[h])u=r.pop(),a=r.pop(),r.push(a+c[h]+u);else{if(!l[h])return h<=7?console.error("WK1 invalid opcode "+h.toString(16)):h<=24?console.error("WK1 unsupported op "+h.toString(16)):h<=30?console.error("WK1 invalid opcode "+h.toString(16)):h<=115?console.error("WK1 unsupported function opcode "+h.toString(16)):console.error("WK1 unrecognized opcode "+h.toString(16));if(69==(n=l[h][1])&&(n=e[e.l++]),n>r.length)return void console.error("WK1 bad formula parse 0x"+h.toString(16)+":|"+r.join("|")+"|");var p=r.slice(-n);r.length-=n,r.push(l[h][0]+"("+p.join(",")+")")}}}1==r.length?t[1].f=""+r[0]:console.error("WK1 bad formula parse |"+r.join("|")+"|")}(e.slice(e.l,e.l+a),o),e.l+=a}return o}},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:n},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:p},222:{n:"SHEETNAMELP",f:function(e,t){var r=e[e.l++];r>t-1&&(r=t-1);for(var n="";n.length<r;)n+=String.fromCharCode(e[e.l++]);return n}},65535:{n:""}},b={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:function(e,t){var r=u(e);return r[1].t="s",r[1].v=e.read_shift(t-4,"cstr"),r}},23:{n:"NUMBER17",f:d},24:{n:"NUMBER18",f:function(e,t){var r=u(e);r[1].v=e.read_shift(2);var n=r[1].v>>1;if(1&r[1].v)switch(7&n){case 0:n=5e3*(n>>3);break;case 1:n=500*(n>>3);break;case 2:n=(n>>3)/20;break;case 3:n=(n>>3)/200;break;case 4:n=(n>>3)/2e3;break;case 5:n=(n>>3)/2e4;break;case 6:n=(n>>3)/16;break;case 7:n=(n>>3)/64}return r[1].v=n,r}},25:{n:"FORMULA19",f:function(e,t){var r=d(e);return e.l+=t-14,r}},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:function(e,t){for(var r={},n=e.l+t;e.l<n;){var i=e.read_shift(2);if(14e3==i){for(r[i]=[0,""],r[i][0]=e.read_shift(2);e[e.l];)r[i][1]+=String.fromCharCode(e[e.l]),e.l++;e.l++}}return r}},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:function(e,t){var r=u(e),n=e.read_shift(4);return r[1].v=n>>6,r}},38:{n:"??"},39:{n:"NUMBER27",f:g},40:{n:"FORMULA28",f:function(e,t){var r=g(e);return e.l+=t-10,r}},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:p},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:function(e,t,r){if(r.qpro&&!(t<21)){var n=e.read_shift(1);return e.l+=17,e.l+=1,e.l+=2,[n,e.read_shift(t-21,"cstr")]}}},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:function(e,t){var r=t||{};if(+r.codepage>=0&&kH(+r.codepage),"string"==r.type)throw new Error("Cannot write WK1 to JS string");var n=Yj(),s=cW(e["!ref"]),l=Array.isArray(e),c=[];cY(n,0,function(e){var t=$j(2);return t.write_shift(2,e),t}(1030)),cY(n,6,function(e){var t=$j(8);return t.write_shift(2,e.s.c),t.write_shift(2,e.s.r),t.write_shift(2,e.e.c),t.write_shift(2,e.e.r),t}(s));for(var u=Math.min(s.e.r,8191),h=s.s.r;h<=u;++h)for(var d=rW(h),f=s.s.c;f<=s.e.c;++f){h===s.s.r&&(c[f]=iW(f));var g=c[f]+d,p=l?(e[h]||[])[f]:e[g];if(p&&"z"!=p.t)if("n"==p.t)(0|p.v)==p.v&&p.v>=-32768&&p.v<=32767?cY(n,13,o(h,f,p.v)):cY(n,14,a(h,f,p.v));else cY(n,15,i(h,f,hW(p).slice(0,239)))}return cY(n,1),n.end()},book_to_wk3:function(e,t){var r=t||{};if(+r.codepage>=0&&kH(+r.codepage),"string"==r.type)throw new Error("Cannot write WK3 to JS string");var n=Yj();cY(n,0,function(e){var t=$j(26);t.write_shift(2,4096),t.write_shift(2,4),t.write_shift(4,0);for(var r=0,n=0,i=0,o=0;o<e.SheetNames.length;++o){var a=e.SheetNames[o],s=e.Sheets[a];if(s&&s["!ref"]){++i;var l=sW(s["!ref"]);r<l.e.r&&(r=l.e.r),n<l.e.c&&(n=l.e.c)}}r>8191&&(r=8191);return t.write_shift(2,r),t.write_shift(1,i),t.write_shift(1,n),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,1),t.write_shift(1,2),t.write_shift(4,0),t.write_shift(4,0),t}(e));for(var i=0,o=0;i<e.SheetNames.length;++i)(e.Sheets[e.SheetNames[i]]||{})["!ref"]&&cY(n,27,m(e.SheetNames[i],o++));var a=0;for(i=0;i<e.SheetNames.length;++i){var s=e.Sheets[e.SheetNames[i]];if(s&&s["!ref"]){for(var l=cW(s["!ref"]),c=Array.isArray(s),u=[],d=Math.min(l.e.r,8191),g=l.s.r;g<=d;++g)for(var p=rW(g),v=l.s.c;v<=l.e.c;++v){g===l.s.r&&(u[v]=iW(v));var b=u[v]+p,y=c?(s[g]||[])[v]:s[b];if(y&&"z"!=y.t)if("n"==y.t)cY(n,23,f(g,v,a,y.v));else cY(n,22,h(g,v,a,hW(y).slice(0,239)))}++a}}return cY(n,1),n.end()},to_workbook:function(e,r){switch(r.type){case"base64":return t(BH(NH(e)),r);case"binary":return t(BH(e),r);case"buffer":case"array":return t(e,r)}throw"Unsupported type "+r.type}}}();var Xz=function(){var e=YU("t"),t=YU("rPr");function r(r){var n=r.match(e);if(!n)return{t:"s",v:""};var i={t:"s",v:NU(n[1])},o=r.match(t);return o&&(i.s=function(e){var t={},r=e.match(_U),n=0,i=!1;if(r)for(;n!=r.length;++n){var o=OU(r[n]);switch(o[0].replace(/\w*:/g,"")){case"<condense":case"<extend":break;case"<shadow":if(!o.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if("1"==o.val)break;t.cp=SH[parseInt(o.val,10)];break;case"<outline":if(!o.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=o.val;break;case"<sz":t.sz=o.val;break;case"<strike":if(!o.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!o.val)break;switch(o.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting"}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if("0"==o.val)break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if("0"==o.val)break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":o.rgb&&(t.color=o.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=o.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=o.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":case"<scheme":case"<scheme>":case"<scheme/>":case"</scheme>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(47!==o[0].charCodeAt(1)&&!i)throw new Error("Unrecognized rich format "+o[0])}}return t}(o[1])),i}var n=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(e){return e.replace(n,"").split(i).map(r).filter((function(e){return e.v}))}}(),Jz=function(){var e=/(\r\n|\n)/g;function t(t){var r=[[],t.v,[]];return t.v?(t.s&&function(e,t,r){var n=[];e.u&&n.push("text-decoration: underline;"),e.uval&&n.push("text-underline-style:"+e.uval+";"),e.sz&&n.push("font-size:"+e.sz+"pt;"),e.outline&&n.push("text-effect: outline;"),e.shadow&&n.push("text-shadow: auto;"),t.push('<span style="'+n.join("")+'">'),e.b&&(t.push("<b>"),r.push("</b>")),e.i&&(t.push("<i>"),r.push("</i>")),e.strike&&(t.push("<s>"),r.push("</s>"));var i=e.valign||"";"superscript"==i||"super"==i?i="sup":"subscript"==i&&(i="sub"),""!=i&&(t.push("<"+i+">"),r.push("</"+i+">")),r.push("</span>")}(t.s,r[0],r[2]),r[0].join("")+r[1].replace(e,"<br/>")+r[2].join("")):""}return function(e){return e.map(t).join("")}}(),Zz=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,Qz=/<(?:\w+:)?r>/,eq=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function tq(e,t){var r=!t||t.cellHTML,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=NU($U(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=$U(e),r&&(n.h=UU(n.t))):e.match(Qz)&&(n.r=$U(e),n.t=NU($U((e.replace(eq,"").match(Zz)||[]).join("").replace(_U,""))),r&&(n.h=Jz(Xz(n.r)))),n):{t:""}}var rq=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,nq=/<(?:\w+:)?(?:si|sstItem)>/g,iq=/<\/(?:\w+:)?(?:si|sstItem)>/;var oq=/^\s|\s$|[\t\n\r]/;function aq(e,t){if(!t.bookSST)return"";var r=[xU];r[r.length]=ij("sst",null,{xmlns:cj[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(null!=e[n]){var i=e[n],o="<si>";i.r?o+=i.r:(o+="<t",i.t||(i.t=""),i.t.match(oq)&&(o+=' xml:space="preserve"'),o+=">"+LU(i.t)+"</t>"),o+="</si>",r[r.length]=o}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}var sq=function(e,t){var r=!1;return null==t&&(r=!0,t=$j(15+4*e.t.length)),t.write_shift(1,0),vW(e.t,t),r?t.slice(0,t.l):t};function lq(e){var t=Yj();Xj(t,159,function(e,t){return t||(t=$j(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}(e));for(var r=0;r<e.length;++r)Xj(t,19,sq(e[r]));return Xj(t,160),t.end()}function cq(e){if("undefined"!==typeof _H)return _H.utils.encode(yH,e);for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function uq(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function hq(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},i=e.read_shift(4),o=[];i-- >0;)o.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=o,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function dq(e){var t=function(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=uq(e,4),t.U=uq(e,4),t.W=uq(e,4),t}(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),4!=e.read_shift(4))throw new Error("Bad !Primary record");return t}function fq(e,t){var r=e.l+t,n={};n.Flags=63&e.read_shift(4),e.l+=4,n.AlgID=e.read_shift(4);var i=!1;switch(n.AlgID){case 26126:case 26127:case 26128:i=36==n.Flags;break;case 26625:i=4==n.Flags;break;case 0:i=16==n.Flags||4==n.Flags||36==n.Flags;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function gq(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function pq(e){if(36!=(63&e.read_shift(4)))throw new Error("EncryptionInfo mismatch");var t=e.read_shift(4);return{t:"Std",h:fq(e,t),v:gq(e,e.length-e.l)}}function mq(){throw new Error("File is password-protected: ECMA-376 Extensible")}function vq(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(_U,(function(e){var r=OU(e);switch(MU(r[0])){case"<?xml":case"<encryption":case"</encryption>":case"</keyEncryptors>":case"</keyEncryptor>":break;case"<keyData":t.forEach((function(e){n[e]=r[e]}));break;case"<dataIntegrity":n.encryptedHmacKey=r.encryptedHmacKey,n.encryptedHmacValue=r.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"<keyEncryptor":n.uri=r.uri;break;case"<encryptedKey":n.encs.push(r);break;default:throw r[0]}})),n}function bq(e){var t,r,n=0,i=cq(e),o=i.length+1;for((t=LH(o))[0]=i.length,r=1;r!=o;++r)t[r]=i[r-1];for(r=o-1;r>=0;--r)n=((0===(16384&n)?0:1)|n<<1&32767)^t[r];return 52811^n}var yq=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(e,t){return 255&((r=e^t)/2|128*r);var r};return function(i){for(var o,a,s,l=cq(i),c=function(e){for(var n=t[e.length-1],i=104,o=e.length-1;o>=0;--o)for(var a=e[o],s=0;7!=s;++s)64&a&&(n^=r[i]),a*=2,--i;return n}(l),u=l.length,h=LH(16),d=0;16!=d;++d)h[d]=0;for(1===(1&u)&&(o=c>>8,h[u]=n(e[0],o),--u,o=255&c,a=l[l.length-1],h[u]=n(a,o));u>0;)o=c>>8,h[--u]=n(l[u],o),o=255&c,h[--u]=n(l[u],o);for(u=15,s=15-l.length;s>0;)o=c>>8,h[u]=n(e[s],o),--s,o=255&c,h[--u]=n(l[u],o),--u,--s;return h}}(),wq=function(e){var t=0,r=yq(e);return function(e){var n=function(e,t,r,n,i){var o,a;for(i||(i=t),n||(n=yq(e)),o=0;o!=t.length;++o)a=t[o],a=255&((a^=n[r])>>5|a<<3),i[o]=a,++r;return[i,r,n]}("",e,t,r);return t=n[1],n[0]}};function Sq(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,1===n.Info?n.Data=function(e){var t={},r=t.EncryptionVersionInfo=uq(e,4);if(1!=r.Major||1!=r.Minor)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}(e):n.Data=function(e,t){var r={},n=r.EncryptionVersionInfo=uq(e,4);if(t-=4,2!=n.Minor)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var i=e.read_shift(4);return t-=4,r.EncryptionHeader=fq(e,i),t-=i,r.EncryptionVerifier=gq(e,t),r}(e,t),n}var Cq=function(){function e(e,r){switch(r.type){case"base64":return t(NH(e),r);case"binary":return t(e,r);case"buffer":return t(DH&&Buffer.isBuffer(e)?e.toString("binary"):jH(e),r);case"array":return t(oU(e),r)}throw new Error("Unrecognized type "+r.type)}function t(e,t){var r=(t||{}).dense?[]:{},n=e.match(/\\trowd.*?\\row\b/g);if(!n.length)throw new Error("RTF missing table");var i={s:{c:0,r:0},e:{c:0,r:n.length-1}};return n.forEach((function(e,t){Array.isArray(r)&&(r[t]=[]);for(var n,o=/\\\w+\b/g,a=0,s=-1;n=o.exec(e);){if("\\cell"===n[0]){var l=e.slice(a,o.lastIndex-n[0].length);if(" "==l[0]&&(l=l.slice(1)),++s,l.length){var c={v:l,t:"s"};Array.isArray(r)?r[t][s]=c:r[aW({r:t,c:s})]=c}}a=o.lastIndex}s>i.e.c&&(i.e.c=s)})),r["!ref"]=lW(i),r}return{to_workbook:function(t,r){return dW(e(t,r),r)},to_sheet:e,from_sheet:function(e){for(var t,r=["{\\rtf1\\ansi"],n=cW(e["!ref"]),i=Array.isArray(e),o=n.s.r;o<=n.e.r;++o){r.push("\\trowd\\trautofit1");for(var a=n.s.c;a<=n.e.c;++a)r.push("\\cellx"+(a+1));for(r.push("\\pard\\intbl"),a=n.s.c;a<=n.e.c;++a){var s=aW({r:o,c:a});(t=i?(e[o]||[])[a]:e[s])&&(null!=t.v||t.f&&!t.F)&&(r.push(" "+(t.w||(hW(t),t.w))),r.push("\\cell"))}r.push("\\pard\\intbl\\row")}return r.join("")+"}"}}}();function kq(e){for(var t=0,r=1;3!=t;++t)r=256*r+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function xq(e,t){if(0===t)return e;var r=function(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,i=Math.max(t,r,n),o=Math.min(t,r,n),a=i-o;if(0===a)return[0,0,t];var s,l=0,c=i+o;switch(s=a/(c>1?2-c:c),i){case t:l=((r-n)/a+6)%6;break;case r:l=(n-t)/a+2;break;case n:l=(t-r)/a+4}return[l/6,s,c/2]}(function(e){var t=e.slice("#"===e[0]?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}(e));return r[2]=t<0?r[2]*(1+t):1-(1-r[2])*(1-t),kq(function(e){var t,r=e[0],n=e[1],i=e[2],o=2*n*(i<.5?i:1-i),a=i-o/2,s=[a,a,a],l=6*r;if(0!==n)switch(0|l){case 0:case 6:t=o*l,s[0]+=o,s[1]+=t;break;case 1:t=o*(2-l),s[0]+=t,s[1]+=o;break;case 2:t=o*(l-2),s[1]+=o,s[2]+=t;break;case 3:t=o*(4-l),s[1]+=t,s[2]+=o;break;case 4:t=o*(l-4),s[2]+=o,s[0]+=t;break;case 5:t=o*(6-l),s[2]+=t,s[0]+=o}for(var c=0;3!=c;++c)s[c]=Math.round(255*s[c]);return s}(r))}var Eq=6,Tq=15,_q=1,Aq=Eq;function Rq(e){return Math.floor((e+Math.round(128/Aq)/256)*Aq)}function Oq(e){return Math.floor((e-5)/Aq*100+.5)/100}function Mq(e){return Math.round((e*Aq+5)/Aq*256)/256}function Iq(e){return Mq(Oq(Rq(e)))}function Pq(e){var t=Math.abs(e-Iq(e)),r=Aq;if(t>.005)for(Aq=_q;Aq<Tq;++Aq)Math.abs(e-Iq(e))<=t&&(t=Math.abs(e-Iq(e)),r=Aq);Aq=r}function Nq(e){e.width?(e.wpx=Rq(e.width),e.wch=Oq(e.wpx),e.MDW=Aq):e.wpx?(e.wch=Oq(e.wpx),e.width=Mq(e.wch),e.MDW=Aq):"number"==typeof e.wch&&(e.width=Mq(e.wch),e.wpx=Rq(e.width),e.MDW=Aq),e.customWidth&&delete e.customWidth}var Dq=96;function Fq(e){return 96*e/Dq}function Lq(e){return e*Dq/96}var Hq={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};var Bq=["numFmtId","fillId","fontId","borderId","xfId"],Uq=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];var jq=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,t=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,r=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,n=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,a,s){var l,c={};return o?((l=(o=o.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"")).match(e))&&function(e,t,r){t.NumberFmt=[];for(var n=zB(tB),i=0;i<n.length;++i)t.NumberFmt[n[i]]=tB[n[i]];var o=e[0].match(_U);if(o)for(i=0;i<o.length;++i){var a=OU(o[i]);switch(MU(a[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":case"</numFmt>":break;case"<numFmt":var s=NU($U(a.formatCode)),l=parseInt(a.numFmtId,10);if(t.NumberFmt[l]=s,l>0){if(l>392){for(l=392;l>60&&null!=t.NumberFmt[l];--l);t.NumberFmt[l]=s}NB(s,l)}break;default:if(r.WTF)throw new Error("unrecognized "+a[0]+" in numFmts")}}}(l,c,s),(l=o.match(n))&&function(e,t,r,n){t.Fonts=[];var i={},o=!1;(e[0].match(_U)||[]).forEach((function(e){var a=OU(e);switch(MU(a[0])){case"<fonts":case"<fonts>":case"</fonts>":case"<font":case"<font>":case"<name/>":case"</name>":case"<sz/>":case"</sz>":case"<vertAlign/>":case"</vertAlign>":case"<family/>":case"</family>":case"<scheme/>":case"</scheme>":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"</font>":case"<font/>":t.Fonts.push(i),i={};break;case"<name":a.val&&(i.name=$U(a.val));break;case"<b":i.bold=a.val?WU(a.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=a.val?WU(a.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(a.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=a.val?WU(a.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=a.val?WU(a.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=a.val?WU(a.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=a.val?WU(a.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=a.val?WU(a.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":a.val&&(i.sz=+a.val);break;case"<vertAlign":a.val&&(i.vertAlign=a.val);break;case"<family":a.val&&(i.family=parseInt(a.val,10));break;case"<scheme":a.val&&(i.scheme=a.val);break;case"<charset":if("1"==a.val)break;a.codepage=SH[parseInt(a.val,10)];break;case"<color":if(i.color||(i.color={}),a.auto&&(i.color.auto=WU(a.auto)),a.rgb)i.color.rgb=a.rgb.slice(-6);else if(a.indexed){i.color.index=parseInt(a.indexed,10);var s=QW[i.color.index];81==i.color.index&&(s=QW[1]),s||(s=QW[1]),i.color.rgb=s[0].toString(16)+s[1].toString(16)+s[2].toString(16)}else a.theme&&(i.color.theme=parseInt(a.theme,10),a.tint&&(i.color.tint=parseFloat(a.tint)),a.theme&&r.themeElements&&r.themeElements.clrScheme&&(i.color.rgb=xq(r.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<AlternateContent":case"<ext":o=!0;break;case"</AlternateContent>":case"</ext>":o=!1;break;default:if(n&&n.WTF&&!o)throw new Error("unrecognized "+a[0]+" in fonts")}}))}(l,c,a,s),(l=o.match(r))&&function(e,t,r,n){t.Fills=[];var i={},o=!1;(e[0].match(_U)||[]).forEach((function(e){var r=OU(e);switch(MU(r[0])){case"<fills":case"<fills>":case"</fills>":case"</fill>":case"<gradientFill>":case"<patternFill/>":case"</patternFill>":case"<bgColor/>":case"</bgColor>":case"<fgColor/>":case"</fgColor>":case"<stop":case"<stop/>":case"</stop>":case"<color":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<fill>":case"<fill":case"<fill/>":i={},t.Fills.push(i);break;case"<gradientFill":case"</gradientFill>":t.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":r.patternType&&(i.patternType=r.patternType);break;case"<bgColor":i.bgColor||(i.bgColor={}),r.indexed&&(i.bgColor.indexed=parseInt(r.indexed,10)),r.theme&&(i.bgColor.theme=parseInt(r.theme,10)),r.tint&&(i.bgColor.tint=parseFloat(r.tint)),r.rgb&&(i.bgColor.rgb=r.rgb.slice(-6));break;case"<fgColor":i.fgColor||(i.fgColor={}),r.theme&&(i.fgColor.theme=parseInt(r.theme,10)),r.tint&&(i.fgColor.tint=parseFloat(r.tint)),null!=r.rgb&&(i.fgColor.rgb=r.rgb.slice(-6));break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(n&&n.WTF&&!o)throw new Error("unrecognized "+r[0]+" in fills")}}))}(l,c,0,s),(l=o.match(i))&&function(e,t,r,n){t.Borders=[];var i={},o=!1;(e[0].match(_U)||[]).forEach((function(e){var r=OU(e);switch(MU(r[0])){case"<borders":case"<borders>":case"</borders>":case"</border>":case"<left/>":case"<left":case"<left>":case"</left>":case"<right/>":case"<right":case"<right>":case"</right>":case"<top/>":case"<top":case"<top>":case"</top>":case"<bottom/>":case"<bottom":case"<bottom>":case"</bottom>":case"<diagonal":case"<diagonal>":case"<diagonal/>":case"</diagonal>":case"<horizontal":case"<horizontal>":case"<horizontal/>":case"</horizontal>":case"<vertical":case"<vertical>":case"<vertical/>":case"</vertical>":case"<start":case"<start>":case"<start/>":case"</start>":case"<end":case"<end>":case"<end/>":case"</end>":case"<color":case"<color>":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<border":case"<border>":case"<border/>":i={},r.diagonalUp&&(i.diagonalUp=WU(r.diagonalUp)),r.diagonalDown&&(i.diagonalDown=WU(r.diagonalDown)),t.Borders.push(i);break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(n&&n.WTF&&!o)throw new Error("unrecognized "+r[0]+" in borders")}}))}(l,c,0,s),(l=o.match(t))&&function(e,t,r){var n;t.CellXf=[];var i=!1;(e[0].match(_U)||[]).forEach((function(e){var o=OU(e),a=0;switch(MU(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":case"</xf>":case"</alignment>":case"<protection":case"</protection>":case"<protection/>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<xf":case"<xf/>":for(delete(n=o)[0],a=0;a<Bq.length;++a)n[Bq[a]]&&(n[Bq[a]]=parseInt(n[Bq[a]],10));for(a=0;a<Uq.length;++a)n[Uq[a]]&&(n[Uq[a]]=WU(n[Uq[a]]));if(t.NumberFmt&&n.numFmtId>392)for(a=392;a>60;--a)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[a]){n.numFmtId=a;break}t.CellXf.push(n);break;case"<alignment":case"<alignment/>":var s={};o.vertical&&(s.vertical=o.vertical),o.horizontal&&(s.horizontal=o.horizontal),null!=o.textRotation&&(s.textRotation=o.textRotation),o.indent&&(s.indent=o.indent),o.wrapText&&(s.wrapText=WU(o.wrapText)),n.alignment=s;break;case"<AlternateContent":case"<ext":i=!0;break;case"</AlternateContent>":case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+o[0]+" in cellXfs")}}))}(l,c,s),c):c}}();function Wq(e,t){var r,n=[xU,ij("styleSheet",null,{xmlns:cj[0],"xmlns:vt":lj.vt})];return e.SSF&&null!=(r=function(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach((function(r){for(var n=r[0];n<=r[1];++n)null!=e[n]&&(t[t.length]=ij("numFmt",null,{numFmtId:n,formatCode:LU(e[n])}))})),1===t.length?"":(t[t.length]="</numFmts>",t[0]=ij("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}(e.SSF))&&(n[n.length]=r),n[n.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',n[n.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',n[n.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',n[n.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(r=function(e){var t=[];return t[t.length]=ij("cellXfs",null),e.forEach((function(e){t[t.length]=ij("xf",null,e)})),t[t.length]="</cellXfs>",2===t.length?"":(t[0]=ij("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}(t.cellXfs))&&(n[n.length]=r),n[n.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',n[n.length]='<dxfs count="0"/>',n[n.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',n.length>2&&(n[n.length]="</styleSheet>",n[1]=n[1].replace("/>",">")),n.join("")}function Vq(e,t,r){r||(r=$j(6+4*t.length)),r.write_shift(2,e),vW(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return null==r.l&&(r.l=r.length),n}function zq(e,t){t||(t=$j(153)),t.write_shift(2,20*e.sz),function(e,t){t||(t=$j(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);t.write_shift(1,r),t.write_shift(1,0)}(e,t),t.write_shift(2,e.bold?700:400);var r=0;"superscript"==e.vertAlign?r=1:"subscript"==e.vertAlign&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),UW(e.color,t);var n=0;return"major"==e.scheme&&(n=1),"minor"==e.scheme&&(n=2),t.write_shift(1,n),vW(e.name,t),t.length>t.l?t.slice(0,t.l):t}var qq,Gq=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],$q=Gj;function Kq(e,t){t||(t=$j(84)),qq||(qq=GB(Gq));var r=qq[e.patternType];null==r&&(r=40),t.write_shift(4,r);var n=0;if(40!=r)for(UW({auto:1},t),UW({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function Yq(e,t,r){r||(r=$j(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);return r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Xq(e,t){return t||(t=$j(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var Jq=Gj;function Zq(e){Xj(e,613,pW(1)),Xj(e,46,function(e,t){return t||(t=$j(51)),t.write_shift(1,0),Xq(0,t),Xq(0,t),Xq(0,t),Xq(0,t),Xq(0,t),t.length>t.l?t.slice(0,t.l):t}()),Xj(e,614)}function Qq(e){Xj(e,619,pW(1)),Xj(e,48,function(e,t){return t||(t=$j(52)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,+e.builtinId),t.write_shift(1,0),RW(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}({xfId:0,builtinId:0,name:"Normal"})),Xj(e,620)}function eG(e){Xj(e,508,function(e,t,r){var n=$j(2052);return n.write_shift(4,e),RW(t,n),RW(r,n),n.length>n.l?n.slice(0,n.l):n}(0,"TableStyleMedium9","PivotStyleMedium4")),Xj(e,509)}function tG(e,t){var r=Yj();return Xj(r,278),function(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach((function(e){for(var n=e[0];n<=e[1];++n)null!=t[n]&&++r})),0!=r&&(Xj(e,615,pW(r)),[[5,8],[23,26],[41,44],[50,392]].forEach((function(r){for(var n=r[0];n<=r[1];++n)null!=t[n]&&Xj(e,44,Vq(n,t[n]))})),Xj(e,616))}}(r,e.SSF),function(e){Xj(e,611,pW(1)),Xj(e,43,zq({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),Xj(e,612)}(r),function(e){Xj(e,603,pW(2)),Xj(e,45,Kq({patternType:"none"})),Xj(e,45,Kq({patternType:"gray125"})),Xj(e,604)}(r),Zq(r),function(e){Xj(e,626,pW(1)),Xj(e,47,Yq({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),Xj(e,627)}(r),function(e,t){Xj(e,617,pW(t.length)),t.forEach((function(t){Xj(e,47,Yq(t,0))})),Xj(e,618)}(r,t.cellXfs),Qq(r),function(e){Xj(e,505,pW(0)),Xj(e,506)}(r),eG(r),Xj(r,279),r.end()}var rG=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function nG(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(_U)||[]).forEach((function(e){var i=OU(e);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=i.val;break;case"<a:sysClr":n.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":"/"===i[0].charAt(1)?(t.themeElements.clrScheme[rG.indexOf(i[0])]=n,n={}):n.name=i[0].slice(3,i[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}}))}function iG(){}function oG(){}var aG=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,sG=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,lG=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;var cG=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function uG(e,t){var r;e&&0!==e.length||(e=hG());var n={};if(!(r=e.match(cG)))throw new Error("themeElements not found in theme");return function(e,t,r){var n;t.themeElements={},[["clrScheme",aG,nG],["fontScheme",sG,iG],["fmtScheme",lG,oG]].forEach((function(i){if(!(n=e.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](n,t,r)}))}(r[0],n,t),n.raw=e,n}function hG(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&"string"==typeof e.raw)return e.raw;var r=[xU];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"/>',r[r.length]='<a:font script="Hang" typeface="\ub9d1\uc740 \uace0\ub515"/>',r[r.length]='<a:font script="Hans" typeface="\u5b8b\u4f53"/>',r[r.length]='<a:font script="Hant" typeface="\u65b0\u7d30\u660e\u9ad4"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"/>',r[r.length]='<a:font script="Hang" typeface="\ub9d1\uc740 \uace0\ub515"/>',r[r.length]='<a:font script="Hans" typeface="\u5b8b\u4f53"/>',r[r.length]='<a:font script="Hant" typeface="\u65b0\u7d30\u660e\u9ad4"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function dG(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:case 4:e.l+=4;break;case 1:t.xclrValue=function(e,t){return Gj(e,t)}(e,4);break;case 2:t.xclrValue=lz(e);break;case 3:t.xclrValue=function(e){return e.read_shift(4)}(e)}return e.l+=8,t}function fG(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=dG(e);break;case 6:n[1]=function(e,t){return Gj(e,t)}(e,r);break;case 14:case 15:n[1]=e.read_shift(1===r?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function gG(){var e=Yj();return Xj(e,332),Xj(e,334,pW(1)),Xj(e,335,function(e){var t=$j(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),vW(e.name,t),t.slice(0,t.l)}({name:"XLDAPR",version:12e4,flags:3496657072})),Xj(e,336),Xj(e,339,function(e,t){var r=$j(8+2*t.length);return r.write_shift(4,e),vW(t,r),r.slice(0,r.l)}(1,"XLDAPR")),Xj(e,52),Xj(e,35,pW(514)),Xj(e,4096,pW(0)),Xj(e,4097,KV(1)),Xj(e,36),Xj(e,53),Xj(e,340),Xj(e,337,function(e,t){var r=$j(8);return r.write_shift(4,e),r.write_shift(4,t?1:0),r}(1,!0)),Xj(e,51,function(e){var t=$j(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}([[1,0]])),Xj(e,338),Xj(e,333),e.end()}function pG(){var e=[xU];return e.push('<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">\n  <metadataTypes count="1">\n    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>\n  </metadataTypes>\n  <futureMetadata name="XLDAPR" count="1">\n    <bk>\n      <extLst>\n        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">\n          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>\n        </ext>\n      </extLst>\n    </bk>\n  </futureMetadata>\n  <cellMetadata count="1">\n    <bk>\n      <rc t="1" v="0"/>\n    </bk>\n  </cellMetadata>\n</metadata>'),e.join("")}var mG=1024;function vG(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),i=[ij("xml",null,{"xmlns:v":uj.v,"xmlns:o":uj.o,"xmlns:x":uj.x,"xmlns:mv":uj.mv}).replace(/\/>/,">"),ij("o:shapelayout",ij("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),ij("v:shapetype",[ij("v:stroke",null,{joinstyle:"miter"}),ij("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];mG<1e3*e;)mG+=1e3;return t.forEach((function(e){var t=oW(e[0]),r={color2:"#BEFF82",type:"gradient"};"gradient"==r.type&&(r.angle="-180");var n="gradient"==r.type?ij("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,o=ij("v:fill",n,r);++mG,i=i.concat(["<v:shape"+nj({id:"_x0000_s"+mG,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(e[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",o,ij("v:shadow",null,{on:"t",obscured:"t"}),ij("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",rj("x:Anchor",[t.c+1,0,t.r+1,0,t.c+3,20,t.r+5,20].join(",")),rj("x:AutoFill","False"),rj("x:Row",String(t.r)),rj("x:Column",String(t.c)),e[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])})),i.push("</xml>"),i.join("")}function bG(e,t,r,n){var i,o=Array.isArray(e);t.forEach((function(t){var a=oW(t.ref);if(o?(e[a.r]||(e[a.r]=[]),i=e[a.r][a.c]):i=e[t.ref],!i){i={t:"z"},o?e[a.r][a.c]=i:e[t.ref]=i;var s=cW(e["!ref"]||"BDWGO1000001:A1");s.s.r>a.r&&(s.s.r=a.r),s.e.r<a.r&&(s.e.r=a.r),s.s.c>a.c&&(s.s.c=a.c),s.e.c<a.c&&(s.e.c=a.c);var l=lW(s);l!==e["!ref"]&&(e["!ref"]=l)}i.c||(i.c=[]);var c={a:t.author,t:t.t,r:t.r,T:r};t.h&&(c.h=t.h);for(var u=i.c.length-1;u>=0;--u){if(!r&&i.c[u].T)return;r&&!i.c[u].T&&i.c.splice(u,1)}if(r&&n)for(u=0;u<n.length;++u)if(c.a==n[u].id){c.a=n[u].name||c.a;break}i.c.push(c)}))}function yG(e){var t=[xU,ij("comments",null,{xmlns:cj[0]})],r=[];return t.push("<authors>"),e.forEach((function(e){e[1].forEach((function(e){var n=LU(e.a);-1==r.indexOf(n)&&(r.push(n),t.push("<author>"+n+"</author>")),e.T&&e.ID&&-1==r.indexOf("tc="+e.ID)&&(r.push("tc="+e.ID),t.push("<author>tc="+e.ID+"</author>"))}))})),0==r.length&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach((function(e){var n=0,i=[];if(e[1][0]&&e[1][0].T&&e[1][0].ID?n=r.indexOf("tc="+e[1][0].ID):e[1].forEach((function(e){e.a&&(n=r.indexOf(LU(e.a))),i.push(e.t||"")})),t.push('<comment ref="'+e[0]+'" authorId="'+n+'"><text>'),i.length<=1)t.push(rj("t",LU(i[0]||"")));else{for(var o="Comment:\n    "+i[0]+"\n",a=1;a<i.length;++a)o+="Reply:\n    "+i[a]+"\n";t.push(rj("t",LU(o)))}t.push("</text></comment>")})),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function wG(e,t,r){var n=[xU,ij("ThreadedComments",null,{xmlns:lj.TCMNT}).replace(/[\/]>/,">")];return e.forEach((function(e){var i="";(e[1]||[]).forEach((function(o,a){if(o.T){o.a&&-1==t.indexOf(o.a)&&t.push(o.a);var s={ref:e[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};0==a?i=s.id:s.parentId=i,o.ID=s.id,o.a&&(s.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(o.a)).slice(-12)+"}"),n.push(ij("threadedComment",rj("text",o.t||""),s))}else delete o.ID}))})),n.push("</ThreadedComments>"),n.join("")}var SG=mW;function CG(e){var t=Yj(),r=[];return Xj(t,628),Xj(t,630),e.forEach((function(e){e[1].forEach((function(e){r.indexOf(e.a)>-1||(r.push(e.a.slice(0,54)),Xj(t,632,function(e){return vW(e.slice(0,54))}(e.a)))}))})),Xj(t,631),Xj(t,633),e.forEach((function(e){e[1].forEach((function(n){n.iauthor=r.indexOf(n.a);var i={s:oW(e[0]),e:oW(e[0])};Xj(t,635,function(e,t){return null==t&&(t=$j(36)),t.write_shift(4,e[1].iauthor),LW(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}([i,n])),n.t&&n.t.length>0&&Xj(t,637,SW(n)),Xj(t,636),delete n.iauthor}))})),Xj(t,634),Xj(t,629),t.end()}var kG="application/vnd.ms-office.vbaProject";var xG=["xlsb","xlsm","xlam","biff8","xla"];var EG=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(e,r,n,i){var o=!1,a=!1;0==n.length?a=!0:"["==n.charAt(0)&&(a=!0,n=n.slice(1,-1)),0==i.length?o=!0:"["==i.charAt(0)&&(o=!0,i=i.slice(1,-1));var s=n.length>0?0|parseInt(n,10):0,l=i.length>0?0|parseInt(i,10):0;return o?l+=t.c:--l,a?s+=t.r:--s,r+(o?"":"$")+iW(l)+(a?"":"$")+rW(s)}return function(n,i){return t=i,n.replace(e,r)}}(),TG=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,_G=function(){return function(e,t){return e.replace(TG,(function(e,r,n,i,o,a){var s=nW(i)-(n?0:t.c),l=tW(a)-(o?0:t.r);return r+"R"+(0==l?"":o?l+1:"["+l+"]")+"C"+(0==s?"":n?s+1:"["+s+"]")}))}}();function AG(e,t){return e.replace(TG,(function(e,r,n,i,o,a){return r+("$"==n?n+i:iW(nW(i)+t.c))+("$"==o?o+a:rW(tW(a)+t.r))}))}function RG(e,t,r){var n=sW(t).s,i=oW(r);return AG(e,{r:i.r-n.r,c:i.c-n.c})}function OG(e){return e.replace(/_xlfn\./g,"")}function MG(e){e.l+=1}function IG(e,t){var r=e.read_shift(1==t?1:2);return[16383&r,r>>14&1,r>>15&1]}function PG(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return NG(e);12==r.biff&&(n=4)}var i=e.read_shift(n),o=e.read_shift(n),a=IG(e,2),s=IG(e,2);return{s:{r:i,c:a[0],cRel:a[1],rRel:a[2]},e:{r:o,c:s[0],cRel:s[1],rRel:s[2]}}}function NG(e){var t=IG(e,2),r=IG(e,2),n=e.read_shift(1),i=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function DG(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return function(e){var t=IG(e,2),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}(e);var n=e.read_shift(r&&12==r.biff?4:2),i=IG(e,2);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function FG(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:255&r,fQuoted:!!(16384&r),cRel:r>>15,rRel:r>>15}}function LG(e){var t=1&e[e.l+1];return e.l+=4,[t,1]}function HG(e){return[e.read_shift(1),e.read_shift(1)]}function BG(e,t){var r=[e.read_shift(1)];if(12==t)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2}switch(r[0]){case 4:r[1]=qV(e,1)?"TRUE":"FALSE",12!=t&&(e.l+=7);break;case 37:case 16:r[1]=eV[e[e.l]],e.l+=12==t?4:8;break;case 0:e.l+=8;break;case 1:r[1]=HW(e);break;case 2:r[1]=rz(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function UG(e,t,r){for(var n=e.read_shift(12==r.biff?4:2),i=[],o=0;o!=n;++o)i.push((12==r.biff?FW:gz)(e,8));return i}function jG(e,t,r){var n=0,i=0;12==r.biff?(n=e.read_shift(4),i=e.read_shift(4)):(i=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,0==--i&&(i=256));for(var o=0,a=[];o!=n&&(a[o]=[]);++o)for(var s=0;s!=i;++s)a[o][s]=BG(e,r.biff);return a}function WG(e,t,r){return e.l+=2,[FG(e)]}function VG(e){return e.l+=6,[]}function zG(e){return e.l+=2,[$V(e),1&e.read_shift(2)]}var qG=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];var GG={1:{n:"PtgExp",f:function(e,t,r){return e.l++,r&&12==r.biff?[e.read_shift(4,"i"),0]:[e.read_shift(2),e.read_shift(r&&2==r.biff?1:2)]}},2:{n:"PtgTbl",f:Gj},3:{n:"PtgAdd",f:MG},4:{n:"PtgSub",f:MG},5:{n:"PtgMul",f:MG},6:{n:"PtgDiv",f:MG},7:{n:"PtgPower",f:MG},8:{n:"PtgConcat",f:MG},9:{n:"PtgLt",f:MG},10:{n:"PtgLe",f:MG},11:{n:"PtgEq",f:MG},12:{n:"PtgGe",f:MG},13:{n:"PtgGt",f:MG},14:{n:"PtgNe",f:MG},15:{n:"PtgIsect",f:MG},16:{n:"PtgUnion",f:MG},17:{n:"PtgRange",f:MG},18:{n:"PtgUplus",f:MG},19:{n:"PtgUminus",f:MG},20:{n:"PtgPercent",f:MG},21:{n:"PtgParen",f:MG},22:{n:"PtgMissArg",f:MG},23:{n:"PtgStr",f:function(e,t,r){return e.l++,JV(e,0,r)}},26:{n:"PtgSheet",f:function(e,t,r){return e.l+=5,e.l+=2,e.l+=2==r.biff?1:4,["PTGSHEET"]}},27:{n:"PtgEndSheet",f:function(e,t,r){return e.l+=2==r.biff?4:5,["PTGENDSHEET"]}},28:{n:"PtgErr",f:function(e){return e.l++,eV[e.read_shift(1)]}},29:{n:"PtgBool",f:function(e){return e.l++,0!==e.read_shift(1)}},30:{n:"PtgInt",f:function(e){return e.l++,e.read_shift(2)}},31:{n:"PtgNum",f:function(e){return e.l++,HW(e)}},32:{n:"PtgArray",f:function(e,t,r){var n=(96&e[e.l++])>>5;return e.l+=2==r.biff?6:12==r.biff?14:7,[n]}},33:{n:"PtgFunc",f:function(e,t,r){var n=(96&e[e.l])>>5;e.l+=1;var i=e.read_shift(r&&r.biff<=3?1:2);return[g$[i],f$[i],n]}},34:{n:"PtgFuncVar",f:function(e,t,r){var n=e[e.l++],i=e.read_shift(1),o=r&&r.biff<=3?[88==n?-1:0,e.read_shift(1)]:function(e){return[e[e.l+1]>>7,32767&e.read_shift(2)]}(e);return[i,(0===o[0]?f$:d$)[o[1]]]}},35:{n:"PtgName",f:function(e,t,r){var n=e.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,o=e.read_shift(i);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12}return[n,0,o]}},36:{n:"PtgRef",f:function(e,t,r){var n=(96&e[e.l])>>5;return e.l+=1,[n,DG(e,0,r)]}},37:{n:"PtgArea",f:function(e,t,r){return[(96&e[e.l++])>>5,PG(e,r.biff>=2&&r.biff,r)]}},38:{n:"PtgMemArea",f:function(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=r&&2==r.biff?3:4,[n,e.read_shift(r&&2==r.biff?1:2)]}},39:{n:"PtgMemErr",f:Gj},40:{n:"PtgMemNoMem",f:Gj},41:{n:"PtgMemFunc",f:function(e,t,r){return[e.read_shift(1)>>>5&3,e.read_shift(r&&2==r.biff?1:2)]}},42:{n:"PtgRefErr",f:function(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,12==r.biff&&(e.l+=2),[n]}},43:{n:"PtgAreaErr",f:function(e,t,r){var n=(96&e[e.l++])>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}},44:{n:"PtgRefN",f:function(e,t,r){var n=(96&e[e.l])>>5;e.l+=1;var i=function(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return function(e){var t=e.read_shift(2),r=e.read_shift(1),n=(32768&t)>>15,i=(16384&t)>>14;return t&=16383,1==n&&t>=8192&&(t-=16384),1==i&&r>=128&&(r-=256),{r:t,c:r,cRel:i,rRel:n}}(e);var i=e.read_shift(n>=12?4:2),o=e.read_shift(2),a=(16384&o)>>14,s=(32768&o)>>15;if(o&=16383,1==s)for(;i>524287;)i-=1048576;if(1==a)for(;o>8191;)o-=16384;return{r:i,c:o,cRel:a,rRel:s}}(e,0,r);return[n,i]}},45:{n:"PtgAreaN",f:function(e,t,r){var n=(96&e[e.l++])>>5,i=function(e,t,r){if(r.biff<8)return NG(e);var n=e.read_shift(12==r.biff?4:2),i=e.read_shift(12==r.biff?4:2),o=IG(e,2),a=IG(e,2);return{s:{r:n,c:o[0],cRel:o[1],rRel:o[2]},e:{r:i,c:a[0],cRel:a[1],rRel:a[2]}}}(e,0,r);return[n,i]}},46:{n:"PtgMemAreaN",f:function(e){return[e.read_shift(1)>>>5&3,e.read_shift(2)]}},47:{n:"PtgMemNoMemN",f:function(e){return[e.read_shift(1)>>>5&3,e.read_shift(2)]}},57:{n:"PtgNameX",f:function(e,t,r){return 5==r.biff?function(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}(e):[e.read_shift(1)>>>5&3,e.read_shift(2),e.read_shift(4)]}},58:{n:"PtgRef3d",f:function(e,t,r){var n=(96&e[e.l])>>5;e.l+=1;var i=e.read_shift(2);return r&&5==r.biff&&(e.l+=12),[n,i,DG(e,0,r)]}},59:{n:"PtgArea3d",f:function(e,t,r){var n=(96&e[e.l++])>>5,i=e.read_shift(2,"i");if(r)switch(r.biff){case 5:e.l+=12,6;break;case 12:12}return[n,i,PG(e,0,r)]}},60:{n:"PtgRefErr3d",f:function(e,t,r){var n=(96&e[e.l++])>>5,i=e.read_shift(2),o=4;if(r)switch(r.biff){case 5:o=15;break;case 12:o=6}return e.l+=o,[n,i]}},61:{n:"PtgAreaErr3d",f:function(e,t,r){var n=(96&e[e.l++])>>5,i=e.read_shift(2),o=8;if(r)switch(r.biff){case 5:e.l+=12,o=6;break;case 12:o=12}return e.l+=o,[n,i]}},255:{}},$G={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},KG={1:{n:"PtgElfLel",f:zG},2:{n:"PtgElfRw",f:WG},3:{n:"PtgElfCol",f:WG},6:{n:"PtgElfRwV",f:WG},7:{n:"PtgElfColV",f:WG},10:{n:"PtgElfRadical",f:WG},11:{n:"PtgElfRadicalS",f:VG},13:{n:"PtgElfColS",f:VG},15:{n:"PtgElfColSV",f:VG},16:{n:"PtgElfRadicalLel",f:zG},25:{n:"PtgList",f:function(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),i=e.read_shift(2),o=e.read_shift(2);return{ixti:t,coltype:3&r,rt:qG[r>>2&31],idx:n,c:i,C:o}}},29:{n:"PtgSxName",f:function(e){return e.l+=2,[e.read_shift(4)]}},255:{}},YG={0:{n:"PtgAttrNoop",f:function(e){return e.l+=4,[0,0]}},1:{n:"PtgAttrSemi",f:function(e,t,r){var n=255&e[e.l+1]?1:0;return e.l+=r&&2==r.biff?3:4,[n]}},2:{n:"PtgAttrIf",f:function(e,t,r){var n=255&e[e.l+1]?1:0;return e.l+=2,[n,e.read_shift(r&&2==r.biff?1:2)]}},4:{n:"PtgAttrChoose",f:function(e,t,r){e.l+=2;for(var n=e.read_shift(r&&2==r.biff?1:2),i=[],o=0;o<=n;++o)i.push(e.read_shift(r&&2==r.biff?1:2));return i}},8:{n:"PtgAttrGoto",f:function(e,t,r){var n=255&e[e.l+1]?1:0;return e.l+=2,[n,e.read_shift(r&&2==r.biff?1:2)]}},16:{n:"PtgAttrSum",f:function(e,t,r){e.l+=r&&2==r.biff?3:4}},32:{n:"PtgAttrBaxcel",f:LG},33:{n:"PtgAttrBaxcel",f:LG},64:{n:"PtgAttrSpace",f:function(e){return e.read_shift(2),HG(e)}},65:{n:"PtgAttrSpaceSemi",f:function(e){return e.read_shift(2),HG(e)}},128:{n:"PtgAttrIfError",f:function(e){var t=255&e[e.l+1]?1:0;return e.l+=2,[t,e.read_shift(2)]}},255:{}};function XG(e,t,r,n){if(n.biff<8)return Gj(e,t);for(var i=e.l+t,o=[],a=0;a!==r.length;++a)switch(r[a][0]){case"PtgArray":r[a][1]=jG(e,0,n),o.push(r[a][1]);break;case"PtgMemArea":r[a][2]=UG(e,r[a][1],n),o.push(r[a][2]);break;case"PtgExp":n&&12==n.biff&&(r[a][1][1]=e.read_shift(4),o.push(r[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[a][0]}return 0!==(t=i-e.l)&&o.push(Gj(e,t)),o}function JG(e,t,r){for(var n,i,o=e.l+t,a=[];o!=e.l;)t=o-e.l,i=e[e.l],n=GG[i]||GG[$G[i]],24!==i&&25!==i||(n=(24===i?KG:YG)[e[e.l+1]]),n&&n.f?a.push([n.n,n.f(e,t,r)]):Gj(e,t);return a}function ZG(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],i=[],o=0;o<n.length;++o){var a=n[o];if(a)if(2===a[0])i.push('"'+a[1].replace(/"/g,'""')+'"');else i.push(a[1]);else i.push("")}t.push(i.join(","))}return t.join(";")}var QG={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function e$(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),0==t?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(e[n[0]][0]){case 357:return i=-1==n[1]?"#REF":e.SheetNames[n[1]],n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 358:return null!=r.SID?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return i=-1==n[1]?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map((function(e){return e.Name})).join(";;");default:return e[n[0]][0][3]?(i=-1==n[1]?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function t$(e,t,r){var n=e$(e,t,r);return"#REF"==n?n:function(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}(n,r)}function r$(e,t,r,n,i){var o,a,s,l,c=i&&i.biff||8,u={s:{c:0,r:0},e:{c:0,r:0}},h=[],d=0,f=0,g="";if(!e[0]||!e[0][0])return"";for(var p=-1,m="",v=0,b=e[0].length;v<b;++v){var y=e[0][v];switch(y[0]){case"PtgUminus":h.push("-"+h.pop());break;case"PtgUplus":h.push("+"+h.pop());break;case"PtgPercent":h.push(h.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(o=h.pop(),a=h.pop(),p>=0){switch(e[0][p][1][0]){case 0:m=sU(" ",e[0][p][1][1]);break;case 1:m=sU("\r",e[0][p][1][1]);break;default:if(m="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}a+=m,p=-1}h.push(a+QG[y[0]]+o);break;case"PtgIsect":o=h.pop(),a=h.pop(),h.push(a+" "+o);break;case"PtgUnion":o=h.pop(),a=h.pop(),h.push(a+","+o);break;case"PtgRange":o=h.pop(),a=h.pop(),h.push(a+":"+o);break;case"PtgAttrChoose":case"PtgAttrGoto":case"PtgAttrIf":case"PtgAttrIfError":case"PtgAttrBaxcel":case"PtgAttrSemi":case"PtgMemArea":case"PtgTbl":case"PtgMemErr":case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":case"PtgMemFunc":case"PtgMemNoMem":break;case"PtgRef":s=Jj(y[1][1],u,i),h.push(Qj(s,c));break;case"PtgRefN":s=r?Jj(y[1][1],r,i):y[1][1],h.push(Qj(s,c));break;case"PtgRef3d":d=y[1][1],s=Jj(y[1][2],u,i);g=t$(n,d,i);h.push(g+"!"+Qj(s,c));break;case"PtgFunc":case"PtgFuncVar":var w=y[1][0],S=y[1][1];w||(w=0);var C=0==(w&=127)?[]:h.slice(-w);h.length-=w,"User"===S&&(S=C.shift()),h.push(S+"("+C.join(",")+")");break;case"PtgBool":h.push(y[1]?"TRUE":"FALSE");break;case"PtgInt":case"PtgErr":h.push(y[1]);break;case"PtgNum":h.push(String(y[1]));break;case"PtgStr":h.push('"'+y[1].replace(/"/g,'""')+'"');break;case"PtgAreaN":l=Zj(y[1][1],r?{s:r}:u,i),h.push(eW(l,i));break;case"PtgArea":l=Zj(y[1][1],u,i),h.push(eW(l,i));break;case"PtgArea3d":d=y[1][1],l=y[1][2],g=t$(n,d,i),h.push(g+"!"+eW(l,i));break;case"PtgAttrSum":h.push("SUM("+h.pop()+")");break;case"PtgName":f=y[1][2];var k=(n.names||[])[f-1]||(n[0]||[])[f],x=k?k.Name:"SH33TJSNAME"+String(f);x&&"_xlfn."==x.slice(0,6)&&!i.xlfn&&(x=x.slice(6)),h.push(x);break;case"PtgNameX":var E,T=y[1][1];if(f=y[1][2],!(i.biff<=5)){var _="";if(14849==((n[T]||[])[0]||[])[0]||(1025==((n[T]||[])[0]||[])[0]?n[T][f]&&n[T][f].itab>0&&(_=n.SheetNames[n[T][f].itab-1]+"!"):_=n.SheetNames[f-1]+"!"),n[T]&&n[T][f])_+=n[T][f].Name;else if(n[0]&&n[0][f])_+=n[0][f].Name;else{var A=(e$(n,T,i)||"").split(";;");A[f-1]?_=A[f-1]:_+="SH33TJSERRX"}h.push(_);break}T<0&&(T=-T),n[T]&&(E=n[T][f]),E||(E={Name:"SH33TJSERRY"}),h.push(E.Name);break;case"PtgParen":var R="(",O=")";if(p>=0){switch(m="",e[0][p][1][0]){case 2:R=sU(" ",e[0][p][1][1])+R;break;case 3:R=sU("\r",e[0][p][1][1])+R;break;case 4:O=sU(" ",e[0][p][1][1])+O;break;case 5:O=sU("\r",e[0][p][1][1])+O;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}p=-1}h.push(R+h.pop()+O);break;case"PtgRefErr":case"PtgRefErr3d":case"PtgAreaErr":case"PtgAreaErr3d":h.push("#REF!");break;case"PtgExp":s={c:y[1][1],r:y[1][0]};var M={c:r.c,r:r.r};if(n.sharedf[aW(s)]){var I=n.sharedf[aW(s)];h.push(r$(I,u,M,n,i))}else{var P=!1;for(o=0;o!=n.arrayf.length;++o)if(a=n.arrayf[o],!(s.c<a[0].s.c||s.c>a[0].e.c)&&!(s.r<a[0].s.r||s.r>a[0].e.r)){h.push(r$(a[1],u,M,n,i)),P=!0;break}P||h.push(y[1])}break;case"PtgArray":h.push("{"+ZG(y[1])+"}");break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":p=v;break;case"PtgMissArg":h.push("");break;case"PtgList":h.push("Table"+y[1].idx+"[#"+y[1].rt+"]");break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");default:throw new Error("Unrecognized Formula Token: "+String(y))}if(3!=i.biff&&p>=0&&-1==["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"].indexOf(e[0][v][0])){var N=!0;switch((y=e[0][p])[1][0]){case 4:N=!1;case 0:m=sU(" ",y[1][1]);break;case 5:N=!1;case 1:m=sU("\r",y[1][1]);break;default:if(m="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+y[1][0])}h.push((N?m:"")+h.pop()+(N?"":m)),p=-1}}if(h.length>1&&i.WTF)throw new Error("bad formula stack");return h[0]}function n$(e,t,r){var n,i=e.l+t,o=2==r.biff?1:2,a=e.read_shift(o);if(65535==a)return[[],Gj(e,t-2)];var s=JG(e,a,r);return t!==a+o&&(n=XG(e,t-a-o,s,r)),e.l=i,[s,n]}function i$(e,t,r){var n,i=e.l+t,o=e.read_shift(2),a=JG(e,o,r);return 65535==o?[[],Gj(e,t-2)]:(t!==o+2&&(n=XG(e,i-o-2,a,r)),[a,n])}function o$(e,t,r){var n=e.l+t,i=uz(e);2==r.biff&&++e.l;var o=function(e){var t;if(65535!==Nj(e,e.l+6))return[HW(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=1===e[e.l+2],e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}(e),a=e.read_shift(1);2!=r.biff&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var s=function(e,t,r){var n,i=e.l+t,o=2==r.biff?1:2,a=e.read_shift(o);if(65535==a)return[[],Gj(e,t-2)];var s=JG(e,a,r);return t!==a+o&&(n=XG(e,t-a-o,s,r)),e.l=i,[s,n]}(e,n-e.l,r);return{cell:i,val:o[0],formula:s,shared:a>>3&1,tt:o[1]}}function a$(e,t,r,n,i){var o=hz(t,r,i),a=function(e){if(null==e){var t=$j(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}return BW("number"==typeof e?e:0)}(e.v),s=$j(6);s.write_shift(2,33),s.write_shift(4,0);for(var l=$j(e.bf.length),c=0;c<e.bf.length;++c)l[c]=e.bf[c];return VH([o,a,s,l])}function s$(e,t,r){var n=e.read_shift(4),i=JG(e,n,r),o=e.read_shift(4);return[i,o>0?XG(e,o,i,r):null]}var l$=s$,c$=s$,u$=s$,h$=s$,d$={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},f$={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},g$={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function p$(e){return"of:"==e.slice(0,3)&&(e=e.slice(3)),61==e.charCodeAt(0)&&61==(e=e.slice(1)).charCodeAt(0)&&(e=e.slice(1)),(e=(e=(e=e.replace(/COM\.MICROSOFT\./g,"")).replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,(function(e,t){return t.replace(/\./g,"")}))).replace(/\[.(#[A-Z]*[?!])\]/g,"$1")).replace(/[;~]/g,",").replace(/\|/g,";")}function m$(e){var t=e.split(":");return[t[0].split(".")[0],t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function v$(e){return e.replace(/\./,"!")}var b$={},y$={},w$="undefined"!==typeof Map;function S$(e,t,r){var n=0,i=e.length;if(r){if(w$?r.has(t):Object.prototype.hasOwnProperty.call(r,t))for(var o=w$?r.get(t):r[t];n<o.length;++n)if(e[o[n]].t===t)return e.Count++,o[n]}else for(;n<i;++n)if(e[n].t===t)return e.Count++,n;return e[i]={t:t},e.Count++,e.Unique++,r&&(w$?(r.has(t)||r.set(t,[]),r.get(t).push(i)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(i))),i}function C$(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(Aq=t.MDW),null!=t.width?r.customWidth=1:null!=t.wpx?n=Oq(t.wpx):null!=t.wch&&(n=t.wch),n>-1?(r.width=Mq(n),r.customWidth=1):null!=t.width&&(r.width=t.width),t.hidden&&(r.hidden=!0),null!=t.level&&(r.outlineLevel=r.level=t.level),r}function k$(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];"xlml"==t&&(r=[1,1,1,1,.5,.5]),null==e.left&&(e.left=r[0]),null==e.right&&(e.right=r[1]),null==e.top&&(e.top=r[2]),null==e.bottom&&(e.bottom=r[3]),null==e.header&&(e.header=r[4]),null==e.footer&&(e.footer=r[5])}}function x$(e,t,r){var n=r.revssf[null!=t.z?t.z:"General"],i=60,o=e.length;if(null==n&&r.ssf)for(;i<392;++i)if(null==r.ssf[i]){NB(t.z,i),r.ssf[i]=t.z,r.revssf[t.z]=n=i;break}for(i=0;i!=o;++i)if(e[i].numFmtId===n)return i;return e[o]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},o}function E$(e,t,r,n,i,o){try{n.cellNF&&(e.z=tB[t])}catch(oJ){if(n.WTF)throw oJ}if("z"!==e.t||n.cellStyles){if("d"===e.t&&"string"===typeof e.v&&(e.v=iU(e.v)),(!n||!1!==n.cellText)&&"z"!==e.t)try{if(null==tB[t]&&NB(LB[t]||"General",t),"e"===e.t)e.w=e.w||eV[e.v];else if(0===t)if("n"===e.t)(0|e.v)===e.v?e.w=e.v.toString(10):e.w=hB(e.v);else if("d"===e.t){var a=YB(e.v);e.w=(0|a)===a?a.toString(10):hB(a)}else{if(void 0===e.v)return"";e.w=dB(e.v,y$)}else"d"===e.t?e.w=PB(t,YB(e.v),y$):e.w=PB(t,e.v,y$)}catch(oJ){if(n.WTF)throw oJ}if(n.cellStyles&&null!=r)try{e.s=o.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=xq(i.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=i.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=xq(i.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=i.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(oJ){if(n.WTF&&o.Fills)throw oJ}}}function T$(e,t,r){if(e&&e["!ref"]){var n=cW(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}var _$=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,A$=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,R$=/<(?:\w:)?hyperlink [^>]*>/gm,O$=/"(\w*:\w*)"/,M$=/<(?:\w:)?col\b[^>]*[\/]?>/g,I$=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,P$=/<(?:\w:)?pageMargins[^>]*\/>/g,N$=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,D$=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,F$=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function L$(e,t,r,n,i,o,a){if(!e)return e;n||(n={"!id":{}}),null!=MH&&null==t.dense&&(t.dense=MH);var s=t.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",u="",h=e.match(A$);h?(c=e.slice(0,h.index),u=e.slice(h.index+h[0].length)):c=u=e;var d=c.match(N$);d?H$(d[0],s,i,r):(d=c.match(D$))&&function(e,t,r,n,i){H$(e.slice(0,e.indexOf(">")),r,n,i)}(d[0],d[1],s,i,r);var f=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(f>0){var g=c.slice(f,f+50).match(O$);g&&function(e,t){var r=cW(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=lW(r))}(s,g[1])}var p=c.match(F$);p&&p[1]&&function(e,t){t.Views||(t.Views=[{}]);(e.match(j$)||[]).forEach((function(e,r){var n=OU(e);t.Views[r]||(t.Views[r]={}),+n.zoomScale&&(t.Views[r].zoom=+n.zoomScale),WU(n.rightToLeft)&&(t.Views[r].RTL=!0)}))}(p[1],i);var m=[];if(t.cellStyles){var v=c.match(M$);v&&function(e,t){for(var r=!1,n=0;n!=t.length;++n){var i=OU(t[n],!0);i.hidden&&(i.hidden=WU(i.hidden));var o=parseInt(i.min,10)-1,a=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!r&&i.width&&(r=!0,Pq(i.width)),Nq(i);o<=a;)e[o++]=aU(i)}}(m,v)}h&&V$(h[1],s,t,l,o,a);var b=u.match(I$);b&&(s["!autofilter"]=function(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}(b[0]));var y=[],w=u.match(_$);if(w)for(f=0;f!=w.length;++f)y[f]=cW(w[f].slice(w[f].indexOf('"')+1));var S=u.match(R$);S&&function(e,t,r){for(var n=Array.isArray(e),i=0;i!=t.length;++i){var o=OU($U(t[i]),!0);if(!o.ref)return;var a=((r||{})["!id"]||[])[o.id];a?(o.Target=a.Target,o.location&&(o.Target+="#"+NU(o.location))):(o.Target="#"+NU(o.location),a={Target:o.Target,TargetMode:"Internal"}),o.Rel=a,o.tooltip&&(o.Tooltip=o.tooltip,delete o.tooltip);for(var s=cW(o.ref),l=s.s.r;l<=s.e.r;++l)for(var c=s.s.c;c<=s.e.c;++c){var u=aW({c:c,r:l});n?(e[l]||(e[l]=[]),e[l][c]||(e[l][c]={t:"z",v:void 0}),e[l][c].l=o):(e[u]||(e[u]={t:"z",v:void 0}),e[u].l=o)}}}(s,S,n);var C=u.match(P$);if(C&&(s["!margins"]=function(e){var t={};return["left","right","top","bottom","header","footer"].forEach((function(r){e[r]&&(t[r]=parseFloat(e[r]))})),t}(OU(C[0]))),!s["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(s["!ref"]=lW(l)),t.sheetRows>0&&s["!ref"]){var k=cW(s["!ref"]);t.sheetRows<=+k.e.r&&(k.e.r=t.sheetRows-1,k.e.r>l.e.r&&(k.e.r=l.e.r),k.e.r<k.s.r&&(k.s.r=k.e.r),k.e.c>l.e.c&&(k.e.c=l.e.c),k.e.c<k.s.c&&(k.s.c=k.e.c),s["!fullref"]=s["!ref"],s["!ref"]=lW(k))}return m.length>0&&(s["!cols"]=m),y.length>0&&(s["!merges"]=y),s}function H$(e,t,r,n){var i=OU(e);r.Sheets[n]||(r.Sheets[n]={}),i.codeName&&(r.Sheets[n].CodeName=NU($U(i.codeName)))}var B$=["objects","scenarios","selectLockedCells","selectUnlockedCells"],U$=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];var j$=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function W$(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),void 0===e.v&&"string"!==typeof e.f||"z"===e.t&&!e.f)return"";var i="",o=e.t,a=e.v;if("z"!==e.t)switch(e.t){case"b":i=e.v?"1":"0";break;case"n":i=""+e.v;break;case"e":i=eV[e.v];break;case"d":n&&n.cellDates?i=iU(e.v,-1).toISOString():((e=aU(e)).t="n",i=""+(e.v=YB(iU(e.v)))),"undefined"===typeof e.z&&(e.z=tB[14]);break;default:i=e.v}var s=rj("v",LU(i)),l={r:t},c=x$(n.cellXfs,e,n);switch(0!==c&&(l.s=c),e.t){case"n":case"z":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;default:if(null==e.v){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){s=rj("v",""+S$(n.Strings,e.v,n.revStrings)),l.t="s";break}l.t="str"}if(e.t!=o&&(e.t=o,e.v=a),"string"==typeof e.f&&e.f){var u=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;s=ij("f",LU(e.f),u)+(null!=e.v?s:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(l.cm=1),ij("c",s,l)}var V$=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,o=YU("v"),a=YU("f");return function(s,l,c,u,h,d){for(var f,g,p,m,v,b=0,y="",w=[],S=[],C=0,k=0,x=0,E="",T=0,_=0,A=0,R=0,O=Array.isArray(d.CellXf),M=[],I=[],P=Array.isArray(l),N=[],D={},F=!1,L=!!c.sheetStubs,H=s.split(t),B=0,U=H.length;B!=U;++B){var j=(y=H[B].trim()).length;if(0!==j){var W=0;e:for(b=0;b<j;++b)switch(y[b]){case">":if("/"!=y[b-1]){++b;break e}if(c&&c.cellStyles){if(T=null!=(g=OU(y.slice(W,b),!0)).r?parseInt(g.r,10):T+1,_=-1,c.sheetRows&&c.sheetRows<T)continue;D={},F=!1,g.ht&&(F=!0,D.hpt=parseFloat(g.ht),D.hpx=Lq(D.hpt)),"1"==g.hidden&&(F=!0,D.hidden=!0),null!=g.outlineLevel&&(F=!0,D.level=+g.outlineLevel),F&&(N[T-1]=D)}break;case"<":W=b}if(W>=b)break;if(T=null!=(g=OU(y.slice(W,b),!0)).r?parseInt(g.r,10):T+1,_=-1,!(c.sheetRows&&c.sheetRows<T)){u.s.r>T-1&&(u.s.r=T-1),u.e.r<T-1&&(u.e.r=T-1),c&&c.cellStyles&&(D={},F=!1,g.ht&&(F=!0,D.hpt=parseFloat(g.ht),D.hpx=Lq(D.hpt)),"1"==g.hidden&&(F=!0,D.hidden=!0),null!=g.outlineLevel&&(F=!0,D.level=+g.outlineLevel),F&&(N[T-1]=D)),w=y.slice(b).split(e);for(var V=0;V!=w.length&&"<"==w[V].trim().charAt(0);++V);for(w=w.slice(V),b=0;b!=w.length;++b)if(0!==(y=w[b].trim()).length){if(S=y.match(r),C=b,k=0,x=0,y="<c "+("<"==y.slice(0,1)?">":"")+y,null!=S&&2===S.length){for(C=0,E=S[1],k=0;k!=E.length&&!((x=E.charCodeAt(k)-64)<1||x>26);++k)C=26*C+x;_=--C}else++_;for(k=0;k!=y.length&&62!==y.charCodeAt(k);++k);if(++k,(g=OU(y.slice(0,k),!0)).r||(g.r=aW({r:T-1,c:_})),f={t:""},null!=(S=(E=y.slice(k)).match(o))&&""!==S[1]&&(f.v=NU(S[1])),c.cellFormula){if(null!=(S=E.match(a))&&""!==S[1]){if(f.f=NU($U(S[1])).replace(/\r\n/g,"\n"),c.xlfn||(f.f=OG(f.f)),S[0].indexOf('t="array"')>-1)f.F=(E.match(i)||[])[1],f.F.indexOf(":")>-1&&M.push([cW(f.F),f.F]);else if(S[0].indexOf('t="shared"')>-1){m=OU(S[0]);var z=NU($U(S[1]));c.xlfn||(z=OG(z)),I[parseInt(m.si,10)]=[m,z,g.r]}}else(S=E.match(/<f[^>]*\/>/))&&I[(m=OU(S[0])).si]&&(f.f=RG(I[m.si][1],I[m.si][2],g.r));var q=oW(g.r);for(k=0;k<M.length;++k)q.r>=M[k][0].s.r&&q.r<=M[k][0].e.r&&q.c>=M[k][0].s.c&&q.c<=M[k][0].e.c&&(f.F=M[k][1])}if(null==g.t&&void 0===f.v)if(f.f||f.F)f.v=0,f.t="n";else{if(!L)continue;f.t="z"}else f.t=g.t||"n";switch(u.s.c>_&&(u.s.c=_),u.e.c<_&&(u.e.c=_),f.t){case"n":if(""==f.v||null==f.v){if(!L)continue;f.t="z"}else f.v=parseFloat(f.v);break;case"s":if("undefined"==typeof f.v){if(!L)continue;f.t="z"}else p=b$[parseInt(f.v,10)],f.v=p.t,f.r=p.r,c.cellHTML&&(f.h=p.h);break;case"str":f.t="s",f.v=null!=f.v?$U(f.v):"",c.cellHTML&&(f.h=UU(f.v));break;case"inlineStr":S=E.match(n),f.t="s",null!=S&&(p=tq(S[1]))?(f.v=p.t,c.cellHTML&&(f.h=p.h)):f.v="";break;case"b":f.v=WU(f.v);break;case"d":c.cellDates?f.v=iU(f.v,1):(f.v=YB(iU(f.v,1)),f.t="n");break;case"e":c&&!1===c.cellText||(f.w=f.v),f.v=tV[f.v]}if(A=R=0,v=null,O&&void 0!==g.s&&null!=(v=d.CellXf[g.s])&&(null!=v.numFmtId&&(A=v.numFmtId),c.cellStyles&&null!=v.fillId&&(R=v.fillId)),E$(f,A,R,c,h,d),c.cellDates&&O&&"n"==f.t&&RB(tB[A])&&(f.t="d",f.v=QB(f.v)),g.cm&&c.xlmeta){var G=(c.xlmeta.Cell||[])[+g.cm-1];G&&"XLDAPR"==G.type&&(f.D=!0)}if(P){var $=oW(g.r);l[$.r]||(l[$.r]=[]),l[$.r][$.c]=f}else l[g.r]=f}}}}N.length>0&&(l["!rows"]=N)}}();function z$(e,t,r,n){var i,o=[xU,ij("worksheet",null,{xmlns:cj[0],"xmlns:r":lj.r})],a=r.SheetNames[e],s="",l=r.Sheets[a];null==l&&(l={});var c=l["!ref"]||"A1",u=cW(c);if(u.e.c>16383||u.e.r>1048575){if(t.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575),c=lW(u)}n||(n={}),l["!comments"]=[];var h=[];!function(e,t,r,n,i){var o=!1,a={},s=null;if("xlsx"!==n.bookType&&t.vbaraw){var l=t.SheetNames[r];try{t.Workbook&&(l=t.Workbook.Sheets[r].CodeName||l)}catch(oJ){}o=!0,a.codeName=KU(LU(l))}if(e&&e["!outline"]){var c={summaryBelow:1,summaryRight:1};e["!outline"].above&&(c.summaryBelow=0),e["!outline"].left&&(c.summaryRight=0),s=(s||"")+ij("outlinePr",null,c)}(o||s)&&(i[i.length]=ij("sheetPr",s,a))}(l,r,e,t,o),o[o.length]=ij("dimension",null,{ref:c}),o[o.length]=function(e,t,r,n){var i={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),ij("sheetViews",ij("sheetView",null,i),{})}(0,0,0,r),t.sheetFormat&&(o[o.length]=ij("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),null!=l["!cols"]&&l["!cols"].length>0&&(o[o.length]=function(e,t){for(var r,n=["<cols>"],i=0;i!=t.length;++i)(r=t[i])&&(n[n.length]=ij("col",null,C$(i,r)));return n[n.length]="</cols>",n.join("")}(0,l["!cols"])),o[i=o.length]="<sheetData/>",l["!links"]=[],null!=l["!ref"]&&(s=function(e,t){var r,n,i=[],o=[],a=cW(e["!ref"]),s="",l="",c=[],u=0,h=0,d=e["!rows"],f=Array.isArray(e),g={r:l},p=-1;for(h=a.s.c;h<=a.e.c;++h)c[h]=iW(h);for(u=a.s.r;u<=a.e.r;++u){for(o=[],l=rW(u),h=a.s.c;h<=a.e.c;++h){r=c[h]+l;var m=f?(e[u]||[])[h]:e[r];void 0!==m&&null!=(s=W$(m,r,e,t))&&o.push(s)}(o.length>0||d&&d[u])&&(g={r:l},d&&d[u]&&((n=d[u]).hidden&&(g.hidden=1),p=-1,n.hpx?p=Fq(n.hpx):n.hpt&&(p=n.hpt),p>-1&&(g.ht=p,g.customHeight=1),n.level&&(g.outlineLevel=n.level)),i[i.length]=ij("row",o.join(""),g))}if(d)for(;u<d.length;++u)d&&d[u]&&(g={r:u+1},(n=d[u]).hidden&&(g.hidden=1),p=-1,n.hpx?p=Fq(n.hpx):n.hpt&&(p=n.hpt),p>-1&&(g.ht=p,g.customHeight=1),n.level&&(g.outlineLevel=n.level),i[i.length]=ij("row","",g));return i.join("")}(l,t,0,0),s.length>0&&(o[o.length]=s)),o.length>i+1&&(o[o.length]="</sheetData>",o[i]=o[i].replace("/>",">")),l["!protect"]&&(o[o.length]=function(e){var t={sheet:1};return B$.forEach((function(r){null!=e[r]&&e[r]&&(t[r]="1")})),U$.forEach((function(r){null==e[r]||e[r]||(t[r]="0")})),e.password&&(t.password=bq(e.password).toString(16).toUpperCase()),ij("sheetProtection",null,t)}(l["!protect"])),null!=l["!autofilter"]&&(o[o.length]=function(e,t,r,n){var i="string"==typeof e.ref?e.ref:lW(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var o=r.Workbook.Names,a=sW(i);a.s.r==a.e.r&&(a.e.r=sW(t["!ref"]).e.r,i=lW(a));for(var s=0;s<o.length;++s){var l=o[s];if("_xlnm._FilterDatabase"==l.Name&&l.Sheet==n){l.Ref="'"+r.SheetNames[n]+"'!"+i;break}}return s==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),ij("autoFilter",null,{ref:i})}(l["!autofilter"],l,r,e)),null!=l["!merges"]&&l["!merges"].length>0&&(o[o.length]=function(e){if(0===e.length)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+lW(e[r])+'"/>';return t+"</mergeCells>"}(l["!merges"]));var d,f,g=-1,p=-1;return l["!links"].length>0&&(o[o.length]="<hyperlinks>",l["!links"].forEach((function(e){e[1].Target&&(d={ref:e[0]},"#"!=e[1].Target.charAt(0)&&(p=cV(n,-1,LU(e[1].Target).replace(/#.*$/,""),oV.HLINK),d["r:id"]="rId"+p),(g=e[1].Target.indexOf("#"))>-1&&(d.location=LU(e[1].Target.slice(g+1))),e[1].Tooltip&&(d.tooltip=LU(e[1].Tooltip)),o[o.length]=ij("hyperlink",null,d))})),o[o.length]="</hyperlinks>"),delete l["!links"],null!=l["!margins"]&&(o[o.length]=(k$(f=l["!margins"]),ij("pageMargins",null,f))),t&&!t.ignoreEC&&void 0!=t.ignoreEC||(o[o.length]=rj("ignoredErrors",ij("ignoredError",null,{numberStoredAsText:1,sqref:c}))),h.length>0&&(p=cV(n,-1,"../drawings/drawing"+(e+1)+".xml",oV.DRAW),o[o.length]=ij("drawing",null,{"r:id":"rId"+p}),l["!drawing"]=h),l["!comments"].length>0&&(p=cV(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",oV.VML),o[o.length]=ij("legacyDrawing",null,{"r:id":"rId"+p}),l["!legacy"]=p),o.length>1&&(o[o.length]="</worksheet>",o[1]=o[1].replace("/>",">")),o.join("")}function q$(e,t,r,n){var i=function(e,t,r){var n=$j(145),i=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var o=320;i.hpx?o=20*Fq(i.hpx):i.hpt&&(o=20*i.hpt),n.write_shift(2,o),n.write_shift(1,0);var a=0;i.level&&(a|=i.level),i.hidden&&(a|=16),(i.hpx||i.hpt)&&(a|=32),n.write_shift(1,a),n.write_shift(1,0);var s=0,l=n.l;n.l+=4;for(var c={r:e,c:0},u=0;u<16;++u)if(!(t.s.c>u+1<<10||t.e.c<u<<10)){for(var h=-1,d=-1,f=u<<10;f<u+1<<10;++f)c.c=f,(Array.isArray(r)?(r[c.r]||[])[c.c]:r[aW(c)])&&(h<0&&(h=f),d=f);h<0||(++s,n.write_shift(4,h),n.write_shift(4,d))}var g=n.l;return n.l=l,n.write_shift(4,s),n.l=g,n.length>n.l?n.slice(0,n.l):n}(n,r,t);(i.length>17||(t["!rows"]||[])[n])&&Xj(e,0,i)}var G$=FW,$$=LW;function K$(e){return[xW(e),HW(e),"n"]}var Y$=FW,X$=LW;var J$=["left","right","top","bottom","header","footer"];function Z$(e,t,r,n,i,o,a){if(void 0===t.v)return!1;var s="";switch(t.t){case"b":s=t.v?"1":"0";break;case"d":(t=aU(t)).z=t.z||tB[14],t.v=YB(iU(t.v)),t.t="n";break;case"n":case"e":s=""+t.v;break;default:s=t.v}var l={r:r,c:n};switch(l.s=x$(i.cellXfs,t,i),t.l&&o["!links"].push([aW(l),t.l]),t.c&&o["!comments"].push([aW(l),t.c]),t.t){case"s":case"str":return i.bookSST?(s=S$(i.Strings,t.v,i.revStrings),l.t="s",l.v=s,a?Xj(e,18,function(e,t,r){return null==r&&(r=$j(8)),EW(t,r),r.write_shift(4,t.v),r}(0,l)):Xj(e,7,function(e,t,r){return null==r&&(r=$j(12)),kW(t,r),r.write_shift(4,t.v),r}(0,l))):(l.t="str",a?Xj(e,17,function(e,t,r){return null==r&&(r=$j(8+4*e.v.length)),EW(t,r),vW(e.v,r),r.length>r.l?r.slice(0,r.l):r}(t,l)):Xj(e,6,function(e,t,r){return null==r&&(r=$j(12+4*e.v.length)),kW(t,r),vW(e.v,r),r.length>r.l?r.slice(0,r.l):r}(t,l))),!0;case"n":return t.v==(0|t.v)&&t.v>-1e3&&t.v<1e3?a?Xj(e,13,function(e,t,r){return null==r&&(r=$j(8)),EW(t,r),NW(e.v,r),r}(t,l)):Xj(e,2,function(e,t,r){return null==r&&(r=$j(12)),kW(t,r),NW(e.v,r),r}(t,l)):a?Xj(e,16,function(e,t,r){return null==r&&(r=$j(12)),EW(t,r),BW(e.v,r),r}(t,l)):Xj(e,5,function(e,t,r){return null==r&&(r=$j(16)),kW(t,r),BW(e.v,r),r}(t,l)),!0;case"b":return l.t="b",a?Xj(e,15,function(e,t,r){return null==r&&(r=$j(5)),EW(t,r),r.write_shift(1,e.v?1:0),r}(t,l)):Xj(e,4,function(e,t,r){return null==r&&(r=$j(9)),kW(t,r),r.write_shift(1,e.v?1:0),r}(t,l)),!0;case"e":return l.t="e",a?Xj(e,14,function(e,t,r){return null==r&&(r=$j(8)),EW(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}(t,l)):Xj(e,3,function(e,t,r){return null==r&&(r=$j(9)),kW(t,r),r.write_shift(1,e.v),r}(t,l)),!0}return a?Xj(e,12,function(e,t,r){return null==r&&(r=$j(4)),EW(t,r)}(0,l)):Xj(e,1,function(e,t,r){return null==r&&(r=$j(8)),kW(t,r)}(0,l)),!0}function Q$(e,t){t&&t["!merges"]&&(Xj(e,177,function(e,t){return null==t&&(t=$j(4)),t.write_shift(4,e),t}(t["!merges"].length)),t["!merges"].forEach((function(t){Xj(e,176,X$(t))})),Xj(e,178))}function eK(e,t){t&&t["!cols"]&&(Xj(e,390),t["!cols"].forEach((function(t,r){t&&Xj(e,60,function(e,t,r){null==r&&(r=$j(18));var n=C$(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,256*(n.width||10)),r.write_shift(4,0);var i=0;return t.hidden&&(i|=1),"number"==typeof n.width&&(i|=2),t.level&&(i|=t.level<<8),r.write_shift(2,i),r}(r,t))})),Xj(e,391))}function tK(e,t){t&&t["!ref"]&&(Xj(e,648),Xj(e,649,function(e){var t=$j(24);return t.write_shift(4,4),t.write_shift(4,1),LW(e,t),t}(cW(t["!ref"]))),Xj(e,650))}function rK(e,t,r){t["!links"].forEach((function(t){if(t[1].Target){var n=cV(r,-1,t[1].Target.replace(/#.*$/,""),oV.HLINK);Xj(e,494,function(e,t){var r=$j(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));LW({s:oW(e[0]),e:oW(e[0])},r),IW("rId"+t,r);var n=e[1].Target.indexOf("#");return vW((-1==n?"":e[1].Target.slice(n+1))||"",r),vW(e[1].Tooltip||"",r),vW("",r),r.slice(0,r.l)}(t,n))}})),delete t["!links"]}function nK(e,t,r){Xj(e,133),Xj(e,137,function(e,t,r){null==r&&(r=$j(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}(0,r)),Xj(e,138),Xj(e,134)}function iK(e,t){t["!protect"]&&Xj(e,535,function(e,t){return null==t&&(t=$j(66)),t.write_shift(2,e.password?bq(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach((function(r){r[1]?t.write_shift(4,null==e[r[0]]||e[r[0]]?0:1):t.write_shift(4,null!=e[r[0]]&&e[r[0]]?0:1)})),t}(t["!protect"]))}function oK(e,t,r,n){var i=Yj(),o=r.SheetNames[e],a=r.Sheets[o]||{},s=o;try{r&&r.Workbook&&(s=r.Workbook.Sheets[e].CodeName||s)}catch(oJ){}var l=cW(a["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(t.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return a["!links"]=[],a["!comments"]=[],Xj(i,129),(r.vbaraw||a["!outline"])&&Xj(i,147,function(e,t,r){null==r&&(r=$j(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var i=1;i<3;++i)r.write_shift(1,0);return UW({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),_W(e,r),r.slice(0,r.l)}(s,a["!outline"])),Xj(i,148,$$(l)),nK(i,0,r.Workbook),eK(i,a),function(e,t,r,n){var i,o=cW(t["!ref"]||"A1"),a="",s=[];Xj(e,145);var l=Array.isArray(t),c=o.e.r;t["!rows"]&&(c=Math.max(o.e.r,t["!rows"].length-1));for(var u=o.s.r;u<=c;++u){a=rW(u),q$(e,t,o,u);var h=!1;if(u<=o.e.r)for(var d=o.s.c;d<=o.e.c;++d){u===o.s.r&&(s[d]=iW(d)),i=s[d]+a;var f=l?(t[u]||[])[d]:t[i];h=!!f&&Z$(e,f,u,d,n,t,h)}}Xj(e,146)}(i,a,0,t),iK(i,a),function(e,t,r,n){if(t["!autofilter"]){var i=t["!autofilter"],o="string"===typeof i.ref?i.ref:lW(i.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var a=r.Workbook.Names,s=sW(o);s.s.r==s.e.r&&(s.e.r=sW(t["!ref"]).e.r,o=lW(s));for(var l=0;l<a.length;++l){var c=a[l];if("_xlnm._FilterDatabase"==c.Name&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+o;break}}l==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+o}),Xj(e,161,LW(cW(o))),Xj(e,162)}}(i,a,r,e),Q$(i,a),rK(i,a,n),a["!margins"]&&Xj(i,476,function(e,t){return null==t&&(t=$j(48)),k$(e),J$.forEach((function(r){BW(e[r],t)})),t}(a["!margins"])),t&&!t.ignoreEC&&void 0!=t.ignoreEC||tK(i,a),function(e,t,r,n){if(t["!comments"].length>0){var i=cV(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",oV.VML);Xj(e,551,IW("rId"+i)),t["!legacy"]=i}}(i,a,e,n),Xj(i,130),i.end()}function aK(e,t,r,n,i,o){var a=o||{"!type":"chart"};if(!e)return o;var s=0,l=0,c="A",u={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach((function(e){var t=function(e){var t,r=[],n=e.match(/^<c:numCache>/);(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/gm)||[]).forEach((function(e){var t=e.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);t&&(r[+t[1]]=n?+t[2]:t[2])}));var i=NU((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/gm)||[]).forEach((function(e){t=e.replace(/<.*?>/g,"")})),[r,i,t]}(e);u.s.r=u.s.c=0,u.e.c=s,c=iW(s),t[0].forEach((function(e,r){a[c+rW(r)]={t:"n",v:e,z:t[1]},l=r})),u.e.r<l&&(u.e.r=l),++s})),s>0&&(a["!ref"]=lW(u)),a}var sK=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],lK=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],cK=[],uK=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function hK(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],i=0;i!=t.length;++i){var o=t[i];if(null==n[o[0]])n[o[0]]=o[1];else switch(o[2]){case"bool":"string"==typeof n[o[0]]&&(n[o[0]]=WU(n[o[0]]));break;case"int":"string"==typeof n[o[0]]&&(n[o[0]]=parseInt(n[o[0]],10))}}}function dK(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(null==e[n[0]])e[n[0]]=n[1];else switch(n[2]){case"bool":"string"==typeof e[n[0]]&&(e[n[0]]=WU(e[n[0]]));break;case"int":"string"==typeof e[n[0]]&&(e[n[0]]=parseInt(e[n[0]],10))}}}function fK(e){dK(e.WBProps,sK),dK(e.CalcPr,uK),hK(e.WBView,lK),hK(e.Sheets,cK),y$.date1904=WU(e.WBProps.date1904)}var gK="][*?/\\".split("");function pK(e,t){if(e.length>31){if(t)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var r=!0;return gK.forEach((function(n){if(-1!=e.indexOf(n)){if(!t)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");r=!1}})),r}function mK(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t,r,n,i=e.Workbook&&e.Workbook.Sheets||[];t=e.SheetNames,r=i,n=!!e.vbaraw,t.forEach((function(e,i){pK(e);for(var o=0;o<i;++o)if(e==t[o])throw new Error("Duplicate Sheet Name: "+e);if(n){var a=r&&r[i]&&r[i].CodeName||e;if(95==a.charCodeAt(0)&&a.length>22)throw new Error("Bad Code Name: Worksheet"+a)}}));for(var o=0;o<e.SheetNames.length;++o)T$(e.Sheets[e.SheetNames[o]],e.SheetNames[o],o)}var vK=/<\w+:workbook/;function bK(e){var t=[xU];t[t.length]=ij("workbook",null,{xmlns:cj[0],"xmlns:r":lj.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(sK.forEach((function(t){null!=e.Workbook.WBProps[t[0]]&&e.Workbook.WBProps[t[0]]!=t[1]&&(n[t[0]]=e.Workbook.WBProps[t[0]])})),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=ij("workbookPr",null,n);var i=e.Workbook&&e.Workbook.Sheets||[],o=0;if(i&&i[0]&&i[0].Hidden){for(t[t.length]="<bookViews>",o=0;o!=e.SheetNames.length&&i[o]&&i[o].Hidden;++o);o==e.SheetNames.length&&(o=0),t[t.length]='<workbookView firstSheet="'+o+'" activeTab="'+o+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",o=0;o!=e.SheetNames.length;++o){var a={name:LU(e.SheetNames[o].slice(0,31))};if(a.sheetId=""+(o+1),a["r:id"]="rId"+(o+1),i[o])switch(i[o].Hidden){case 1:a.state="hidden";break;case 2:a.state="veryHidden"}t[t.length]=ij("sheet",null,a)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach((function(e){var r={name:e.Name};e.Comment&&(r.comment=e.Comment),null!=e.Sheet&&(r.localSheetId=""+e.Sheet),e.Hidden&&(r.hidden="1"),e.Ref&&(t[t.length]=ij("definedName",LU(e.Ref),r))})),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function yK(e,t){return t||(t=$j(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),IW(e.strRelID,t),vW(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function wK(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function SK(e,t){if(t.Workbook&&t.Workbook.Sheets){for(var r=t.Workbook.Sheets,n=0,i=-1,o=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&-1==i?i=n:1==r[n].Hidden&&-1==o&&(o=n);o>i||(Xj(e,135),Xj(e,158,function(e,t){return t||(t=$j(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e),t.write_shift(1,120),t.length>t.l?t.slice(0,t.l):t}(i)),Xj(e,136))}}function CK(e,t){var r=Yj();return Xj(r,131),Xj(r,128,function(e,t){t||(t=$j(127));for(var r=0;4!=r;++r)t.write_shift(4,0);return vW("SheetJS",t),vW(vH.version,t),vW(vH.version,t),vW("7262",t),t.length>t.l?t.slice(0,t.l):t}()),Xj(r,153,function(e,t){t||(t=$j(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),_W(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}(e.Workbook&&e.Workbook.WBProps||null)),SK(r,e),function(e,t){Xj(e,143);for(var r=0;r!=t.SheetNames.length;++r)Xj(e,156,yK({Hidden:t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]}));Xj(e,144)}(r,e),Xj(r,132),r.end()}function kK(e,t,r){return".bin"===t.slice(-4)?function(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],i=!1;t||(t={}),t.biff=12;var o=[],a=[[]];return a.SheetNames=[],a.XTI=[],sY[16]={n:"BrtFRTArchID$",f:wK},Kj(e,(function(e,s,l){switch(l){case 156:a.SheetNames.push(e.name),r.Sheets.push(e);break;case 153:r.WBProps=e;break;case 39:null!=e.Sheet&&(t.SID=e.Sheet),e.Ref=r$(e.Ptg,0,null,a,t),delete t.SID,delete e.Ptg,o.push(e);break;case 1036:case 361:case 2071:case 158:case 143:case 664:case 353:case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:case 16:break;case 357:case 358:case 355:case 667:a[0].length?a.push([l,e]):a[0]=[l,e],a[a.length-1].XTI=[];break;case 362:0===a.length&&(a[0]=[],a[0].XTI=[]),a[a.length-1].XTI=a[a.length-1].XTI.concat(e),a.XTI=a.XTI.concat(e);break;case 35:case 37:n.push(l),i=!0;break;case 36:case 38:n.pop(),i=!1;break;default:if(s.T);else if(!i||t.WTF&&37!=n[n.length-1]&&35!=n[n.length-1])throw new Error("Unexpected record 0x"+l.toString(16))}}),t),fK(r),r.Names=o,r.supbooks=a,r}(e,r):function(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,i="xmlns",o={},a=0;if(e.replace(_U,(function(s,l){var c=OU(s);switch(MU(c[0])){case"<?xml":case"</workbook>":case"<fileVersion/>":case"</fileVersion>":case"<fileSharing":case"<fileSharing/>":case"</workbookPr>":case"<workbookProtection":case"<workbookProtection/>":case"<bookViews":case"<bookViews>":case"</bookViews>":case"</workbookView>":case"<sheets":case"<sheets>":case"</sheets>":case"</sheet>":case"<functionGroups":case"<functionGroups/>":case"<functionGroup":case"<externalReferences":case"</externalReferences>":case"<externalReferences>":case"<externalReference":case"<definedNames/>":case"<definedName/>":case"</calcPr>":case"<oleSize":case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":case"<customWorkbookView":case"</customWorkbookView>":case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":case"<pivotCache":case"<smartTagPr":case"<smartTagPr/>":case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":case"<smartTagType":case"<webPublishing":case"<webPublishing/>":case"<fileRecoveryPr":case"<fileRecoveryPr/>":case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":case"<webPublishObject":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":case"<ArchID":case"<revisionPtr":break;case"<workbook":s.match(vK)&&(i="xmlns"+s.match(/<(\w+):/)[1]),r.xmlns=c[i];break;case"<fileVersion":delete c[0],r.AppVersion=c;break;case"<workbookPr":case"<workbookPr/>":sK.forEach((function(e){if(null!=c[e[0]])switch(e[2]){case"bool":r.WBProps[e[0]]=WU(c[e[0]]);break;case"int":r.WBProps[e[0]]=parseInt(c[e[0]],10);break;default:r.WBProps[e[0]]=c[e[0]]}})),c.codeName&&(r.WBProps.CodeName=$U(c.codeName));break;case"<workbookView":case"<workbookView/>":delete c[0],r.WBView.push(c);break;case"<sheet":switch(c.state){case"hidden":c.Hidden=1;break;case"veryHidden":c.Hidden=2;break;default:c.Hidden=0}delete c.state,c.name=NU($U(c.name)),delete c[0],r.Sheets.push(c);break;case"<definedNames>":case"<definedNames":case"<ext":case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</definedNames>":case"</ext>":case"</AlternateContent>":n=!1;break;case"<definedName":(o={}).Name=$U(c.name),c.comment&&(o.Comment=c.comment),c.localSheetId&&(o.Sheet=+c.localSheetId),WU(c.hidden||"0")&&(o.Hidden=!0),a=l+s.length;break;case"</definedName>":o.Ref=NU($U(e.slice(a,l))),r.Names.push(o);break;case"<calcPr":case"<calcPr/>":delete c[0],r.CalcPr=c;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+c[0]+" in workbook")}return s})),-1===cj.indexOf(r.xmlns))throw new Error("Unknown Namespace: "+r.xmlns);return fK(r),r}(e,r)}function xK(e,t,r,n,i,o,a,s){return".bin"===t.slice(-4)?function(e,t,r,n,i,o,a){if(!e)return e;var s=t||{};n||(n={"!id":{}}),null!=MH&&null==s.dense&&(s.dense=MH);var l,c,u,h,d,f,g,p,m,v,b=s.dense?[]:{},y={s:{r:2e6,c:2e6},e:{r:0,c:0}},w=[],S=!1,C=!1,k=[];s.biff=12,s["!row"]=0;var x=0,E=!1,T=[],_={},A=s.supbooks||i.supbooks||[[]];if(A.sharedf=_,A.arrayf=T,A.SheetNames=i.SheetNames||i.Sheets.map((function(e){return e.name})),!s.supbooks&&(s.supbooks=A,i.Names))for(var R=0;R<i.Names.length;++R)A[0][R+1]=i.Names[R];var O,M,I=[],P=[],N=!1;if(sY[16]={n:"BrtShortReal",f:K$},Kj(e,(function(e,t,R){if(!C)switch(R){case 148:l=e;break;case 0:c=e,s.sheetRows&&s.sheetRows<=c.r&&(C=!0),m=rW(d=c.r),s["!row"]=c.r,(e.hidden||e.hpt||null!=e.level)&&(e.hpt&&(e.hpx=Lq(e.hpt)),P[e.r]=e);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(u={t:e[2]},e[2]){case"n":u.v=e[1];break;case"s":p=b$[e[1]],u.v=p.t,u.r=p.r;break;case"b":u.v=!!e[1];break;case"e":u.v=e[1],!1!==s.cellText&&(u.w=eV[u.v]);break;case"str":u.t="s",u.v=e[1];break;case"is":u.t="s",u.v=e[1].t}if((h=a.CellXf[e[0].iStyleRef])&&E$(u,h.numFmtId,null,s,o,a),f=-1==e[0].c?f+1:e[0].c,s.dense?(b[d]||(b[d]=[]),b[d][f]=u):b[iW(f)+m]=u,s.cellFormula){for(E=!1,x=0;x<T.length;++x){var D=T[x];c.r>=D[0].s.r&&c.r<=D[0].e.r&&f>=D[0].s.c&&f<=D[0].e.c&&(u.F=lW(D[0]),E=!0)}!E&&e.length>3&&(u.f=e[3])}if(y.s.r>c.r&&(y.s.r=c.r),y.s.c>f&&(y.s.c=f),y.e.r<c.r&&(y.e.r=c.r),y.e.c<f&&(y.e.c=f),s.cellDates&&h&&"n"==u.t&&RB(tB[h.numFmtId])){var F=oB(u.v);F&&(u.t="d",u.v=new Date(F.y,F.m-1,F.d,F.H,F.M,F.S,F.u))}O&&("XLDAPR"==O.type&&(u.D=!0),O=void 0),M&&(M=void 0);break;case 1:case 12:if(!s.sheetStubs||S)break;u={t:"z",v:void 0},f=-1==e[0].c?f+1:e[0].c,s.dense?(b[d]||(b[d]=[]),b[d][f]=u):b[iW(f)+m]=u,y.s.r>c.r&&(y.s.r=c.r),y.s.c>f&&(y.s.c=f),y.e.r<c.r&&(y.e.r=c.r),y.e.c<f&&(y.e.c=f),O&&("XLDAPR"==O.type&&(u.D=!0),O=void 0),M&&(M=void 0);break;case 176:k.push(e);break;case 49:O=((s.xlmeta||{}).Cell||[])[e-1];break;case 494:var L=n["!id"][e.relId];for(L?(e.Target=L.Target,e.loc&&(e.Target+="#"+e.loc),e.Rel=L):""==e.relId&&(e.Target="#"+e.loc),d=e.rfx.s.r;d<=e.rfx.e.r;++d)for(f=e.rfx.s.c;f<=e.rfx.e.c;++f)s.dense?(b[d]||(b[d]=[]),b[d][f]||(b[d][f]={t:"z",v:void 0}),b[d][f].l=e):(g=aW({c:f,r:d}),b[g]||(b[g]={t:"z",v:void 0}),b[g].l=e);break;case 426:if(!s.cellFormula)break;T.push(e),(v=s.dense?b[d][f]:b[iW(f)+m]).f=r$(e[1],0,{r:c.r,c:f},A,s),v.F=lW(e[0]);break;case 427:if(!s.cellFormula)break;_[aW(e[0].s)]=e[1],(v=s.dense?b[d][f]:b[iW(f)+m]).f=r$(e[1],0,{r:c.r,c:f},A,s);break;case 60:if(!s.cellStyles)break;for(;e.e>=e.s;)I[e.e--]={width:e.w/256,hidden:!!(1&e.flags),level:e.level},N||(N=!0,Pq(e.w/256)),Nq(I[e.e+1]);break;case 161:b["!autofilter"]={ref:lW(e)};break;case 476:b["!margins"]=e;break;case 147:i.Sheets[r]||(i.Sheets[r]={}),e.name&&(i.Sheets[r].CodeName=e.name),(e.above||e.left)&&(b["!outline"]={above:e.above,left:e.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),e.RTL&&(i.Views[0].RTL=!0);break;case 485:case 64:case 1053:case 151:case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:S=!0;break;case 36:S=!1;break;case 37:w.push(R),S=!0;break;case 38:w.pop(),S=!1;break;default:if(t.T);else if(!S||s.WTF)throw new Error("Unexpected record 0x"+R.toString(16))}}),s),delete s.supbooks,delete s["!row"],!b["!ref"]&&(y.s.r<2e6||l&&(l.e.r>0||l.e.c>0||l.s.r>0||l.s.c>0))&&(b["!ref"]=lW(l||y)),s.sheetRows&&b["!ref"]){var D=cW(b["!ref"]);s.sheetRows<=+D.e.r&&(D.e.r=s.sheetRows-1,D.e.r>y.e.r&&(D.e.r=y.e.r),D.e.r<D.s.r&&(D.s.r=D.e.r),D.e.c>y.e.c&&(D.e.c=y.e.c),D.e.c<D.s.c&&(D.s.c=D.e.c),b["!fullref"]=b["!ref"],b["!ref"]=lW(D))}return k.length>0&&(b["!merges"]=k),I.length>0&&(b["!cols"]=I),P.length>0&&(b["!rows"]=P),b}(e,n,r,i,o,a,s):L$(e,n,r,i,o,a,s)}function EK(e,t,r,n,i,o,a,s){return".bin"===t.slice(-4)?function(e,t,r,n,i){if(!e)return e;n||(n={"!id":{}});var o={"!type":"chart","!drawel":null,"!rel":""},a=[],s=!1;return Kj(e,(function(e,n,l){switch(l){case 550:o["!rel"]=e;break;case 651:i.Sheets[r]||(i.Sheets[r]={}),e.name&&(i.Sheets[r].CodeName=e.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:a.push(l);break;case 38:a.pop();break;default:if(n.T>0)a.push(l);else if(n.T<0)a.pop();else if(!s||t.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}),t),n["!id"][o["!rel"]]&&(o["!drawel"]=n["!id"][o["!rel"]]),o}(e,n,r,i,o):function(e,t,r,n,i){if(!e)return e;n||(n={"!id":{}});var o,a={"!type":"chart","!drawel":null,"!rel":""},s=e.match(N$);return s&&H$(s[0],0,i,r),(o=e.match(/drawing r:id="(.*?)"/))&&(a["!rel"]=o[1]),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}(e,0,r,i,o)}function TK(e,t,r,n){return".bin"===t.slice(-4)?function(e,t,r){var n={NumberFmt:[]};for(var i in tB)n.NumberFmt[i]=tB[i];n.CellXf=[],n.Fonts=[];var o=[],a=!1;return Kj(e,(function(e,i,s){switch(s){case 44:n.NumberFmt[e[0]]=e[1],NB(e[1],e[0]);break;case 43:n.Fonts.push(e),null!=e.color.theme&&t&&t.themeElements&&t.themeElements.clrScheme&&(e.color.rgb=xq(t.themeElements.clrScheme[e.color.theme].rgb,e.color.tint||0));break;case 1025:case 45:case 46:case 48:case 507:case 572:case 475:case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 47:617==o[o.length-1]&&n.CellXf.push(e);break;case 35:a=!0;break;case 36:a=!1;break;case 37:o.push(s),a=!0;break;case 38:o.pop(),a=!1;break;default:if(i.T>0)o.push(s);else if(i.T<0)o.pop();else if(!a||r.WTF&&37!=o[o.length-1])throw new Error("Unexpected record 0x"+s.toString(16))}})),n}(e,r,n):jq(e,r,n)}function _K(e,t,r){return".bin"===t.slice(-4)?function(e,t){var r=[],n=!1;return Kj(e,(function(e,i,o){switch(o){case 159:r.Count=e[0],r.Unique=e[1];break;case 19:r.push(e);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(i.T,!n||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}})),r}(e,r):function(e,t){var r=[],n="";if(!e)return r;var i=e.match(rq);if(i){n=i[2].replace(nq,"").split(iq);for(var o=0;o!=n.length;++o){var a=tq(n[o].trim(),t);null!=a&&(r[r.length]=a)}i=OU(i[1]),r.Count=i.count,r.Unique=i.uniqueCount}return r}(e,r)}function AK(e,t,r){return".bin"===t.slice(-4)?function(e,t){var r=[],n=[],i={},o=!1;return Kj(e,(function(e,a,s){switch(s){case 632:n.push(e);break;case 635:i=e;break;case 637:i.t=e.t,i.h=e.h,i.r=e.r;break;case 636:if(i.author=n[i.iauthor],delete i.iauthor,t.sheetRows&&i.rfx&&t.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,r.push(i);break;case 3072:case 37:case 38:break;case 35:o=!0;break;case 36:o=!1;break;default:if(a.T);else if(!o||t.WTF)throw new Error("Unexpected record 0x"+s.toString(16))}})),r}(e,r):function(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],i=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach((function(e){if(""!==e&&""!==e.trim()){var t=e.match(/<(?:\w+:)?author[^>]*>(.*)/);t&&r.push(t[1])}}));var o=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return o&&o[1]&&o[1].split(/<\/\w*:?comment>/).forEach((function(e){if(""!==e&&""!==e.trim()){var i=e.match(/<(?:\w+:)?comment[^>]*>/);if(i){var o=OU(i[0]),a={author:o.authorId&&r[o.authorId]||"sheetjsghost",ref:o.ref,guid:o.guid},s=oW(o.ref);if(!(t.sheetRows&&t.sheetRows<=s.r)){var l=e.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),c=!!l&&!!l[1]&&tq(l[1])||{r:"",t:"",h:""};a.r=c.r,"<t></t>"==c.r&&(c.t=c.h=""),a.t=(c.t||"").replace(/\r\n/g,"\n").replace(/\r/g,"\n"),t.cellHTML&&(a.h=c.h),n.push(a)}}}})),n}(e,r)}function RK(e,t,r){return".bin"===t.slice(-4)?function(e){var t=[];return Kj(e,(function(e,r,n){if(63===n)t.push(e);else if(!r.T)throw new Error("Unexpected record 0x"+n.toString(16))})),t}(e):function(e){var t=[];if(!e)return t;var r=1;return(e.match(_U)||[]).forEach((function(e){var n=OU(e);switch(n[0]){case"<?xml":case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete n[0],n.i?r=n.i:n.i=r,t.push(n)}})),t}(e)}function OK(e,t,r,n){if(".bin"===r.slice(-4))return function(e,t,r,n){if(!e)return e;var i=n||{},o=!1;Kj(e,(function(e,t,r){switch(r){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:o=!0;break;case 36:o=!1;break;default:if(t.T);else if(!o||i.WTF)throw new Error("Unexpected record 0x"+r.toString(16))}}),i)}(e,0,0,n)}function MK(e,t,r){return".bin"===t.slice(-4)?function(e,t,r){var n={Types:[],Cell:[],Value:[]},i=r||{},o=[],a=!1,s=2;return Kj(e,(function(e,t,r){switch(r){case 335:n.Types.push({name:e.name});break;case 51:e.forEach((function(e){1==s?n.Cell.push({type:n.Types[e[0]-1].name,index:e[1]}):0==s&&n.Value.push({type:n.Types[e[0]-1].name,index:e[1]})}));break;case 337:s=e?1:0;break;case 338:s=2;break;case 35:o.push(r),a=!0;break;case 36:o.pop(),a=!1;break;default:if(t.T);else if(!a||i.WTF&&35!=o[o.length-1])throw new Error("Unexpected record 0x"+r.toString(16))}})),n}(e,0,r):function(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var i,o=!1,a=2;return e.replace(_U,(function(e){var t=OU(e);switch(MU(t[0])){case"<?xml":case"<metadata":case"</metadata>":case"<metadataTypes":case"</metadataTypes>":case"</metadataType>":case"</futureMetadata>":case"<bk>":case"</bk>":case"</rc>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<metadataType":n.Types.push({name:t.name});break;case"<futureMetadata":for(var s=0;s<n.Types.length;++s)n.Types[s].name==t.name&&(i=n.Types[s]);break;case"<rc":1==a?n.Cell.push({type:n.Types[t.t-1].name,index:+t.v}):0==a&&n.Value.push({type:n.Types[t.t-1].name,index:+t.v});break;case"<cellMetadata":a=1;break;case"</cellMetadata>":case"</valueMetadata>":a=2;break;case"<valueMetadata":a=0;break;case"<ext":o=!0;break;case"</ext>":o=!1;break;case"<rvb":if(!i)break;i.offsets||(i.offsets=[]),i.offsets.push(+t.i);break;default:if(!o&&r.WTF)throw new Error("unrecognized "+t[0]+" in metadata")}return e})),n}(e,0,r)}function IK(e,t,r,n,i){return(".bin"===t.slice(-4)?oK:z$)(e,r,n,i)}function PK(e,t,r){return(".bin"===t.slice(-4)?CG:yG)(e,r)}var NK,DK=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,FK=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function LK(e,t){var r=e.split(/\s+/),n=[];if(t||(n[0]=r[0]),1===r.length)return n;var i,o,a,s=e.match(DK);if(s)for(a=0;a!=s.length;++a)-1===(o=(i=s[a].match(FK))[1].indexOf(":"))?n[i[1]]=i[2].slice(1,i[2].length-1):n["xmlns:"===i[1].slice(0,6)?"xmlns"+i[1].slice(6):i[1].slice(o+1)]=i[2].slice(1,i[2].length-1);return n}function HK(e){var t={};if(1===e.split(/\s+/).length)return t;var r,n,i,o=e.match(DK);if(o)for(i=0;i!=o.length;++i)-1===(n=(r=o[i].match(FK))[1].indexOf(":"))?t[r[1]]=r[2].slice(1,r[2].length-1):t["xmlns:"===r[1].slice(0,6)?"xmlns"+r[1].slice(6):r[1].slice(n+1)]=r[2].slice(1,r[2].length-1);return t}function BK(e,t,r,n){var i=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=WU(n);break;case"i2":case"int":i=parseInt(n,10);break;case"r4":case"float":i=parseFloat(n);break;case"date":case"dateTime.tz":i=iU(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[NU(t)]=i}function UK(e,t,r){if("z"!==e.t){if(!r||!1!==r.cellText)try{"e"===e.t?e.w=e.w||eV[e.v]:"General"===t?"n"===e.t?(0|e.v)===e.v?e.w=e.v.toString(10):e.w=hB(e.v):e.w=dB(e.v):e.w=function(e,t){var r=NK[e]||NU(e);return"General"===r?dB(t):PB(r,t)}(t||"General",e.v)}catch(oJ){if(r.WTF)throw oJ}try{var n=NK[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&"n"==e.t&&RB(n)){var i=oB(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(oJ){if(r.WTF)throw oJ}}}function jK(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=Hq[n.Pattern]||n.Pattern)}e[t.ID]=t}function WK(e,t,r,n,i,o,a,s,l,c){var u="General",h=n.StyleID,d={};c=c||{};var f=[],g=0;for(void 0===h&&s&&(h=s.StyleID),void 0===h&&a&&(h=a.StyleID);void 0!==o[h]&&(o[h].nf&&(u=o[h].nf),o[h].Interior&&f.push(o[h].Interior),o[h].Parent);)h=o[h].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=WU(e);break;case"String":n.t="s",n.r=jU(NU(e)),n.v=e.indexOf("<")>-1?NU(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":"Z"!=e.slice(-1)&&(e+="Z"),n.v=(iU(e)-new Date(Date.UTC(1899,11,30)))/864e5,n.v!==n.v?n.v=NU(e):n.v<60&&(n.v=n.v-1),u&&"General"!=u||(u="yyyy-mm-dd");case"Number":void 0===n.v&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=tV[e],!1!==c.cellText&&(n.w=e);break;default:""==e&&""==t?n.t="z":(n.t="s",n.v=jU(t||e))}if(UK(n,u,c),!1!==c.cellFormula)if(n.Formula){var p=NU(n.Formula);61==p.charCodeAt(0)&&(p=p.slice(1)),n.f=EG(p,i),delete n.Formula,"RC"==n.ArrayRange?n.F=EG("RC:RC",i):n.ArrayRange&&(n.F=EG(n.ArrayRange,i),l.push([cW(n.F),n.F]))}else for(g=0;g<l.length;++g)i.r>=l[g][0].s.r&&i.r<=l[g][0].e.r&&i.c>=l[g][0].s.c&&i.c<=l[g][0].e.c&&(n.F=l[g][1]);c.cellStyles&&(f.forEach((function(e){!d.patternType&&e.patternType&&(d.patternType=e.patternType)})),n.s=d),void 0!==n.StyleID&&(n.ixfe=n.StyleID)}function VK(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,"\n").replace(/\r/g,"\n"),e.v=e.w=e.ixfe=void 0}function zK(e,t){var r=t||{};FB();var n=AH(aj(e));"binary"!=r.type&&"array"!=r.type&&"base64"!=r.type||(n="undefined"!==typeof _H?_H.utils.decode(65001,EH(n)):$U(n));var i,o=n.slice(0,1024).toLowerCase(),a=!1;if((1023&(o=o.replace(/".*?"/g,"")).indexOf(">"))>Math.min(1023&o.indexOf(","),1023&o.indexOf(";"))){var s=aU(r);return s.type="string",Kz.to_workbook(n,s)}if(-1==o.indexOf("<?xml")&&["html","table","head","meta","script","style","div"].forEach((function(e){o.indexOf("<"+e)>=0&&(a=!0)})),a)return function(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||0==r.length)throw new Error("Invalid HTML: could not find <table>");if(1==r.length)return dW(yY(r[0],t),t);var n={SheetNames:[],Sheets:{}};return r.forEach((function(e,r){LX(n,yY(e,t),"Sheet"+(r+1))})),n}(n,r);NK={"General Number":"General","General Date":tB[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":tB[15],"Short Date":tB[14],"Long Time":tB[19],"Medium Time":tB[18],"Short Time":tB[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:tB[2],Standard:tB[4],Percent:tB[10],Scientific:tB[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var l,c=[];null!=MH&&null==r.dense&&(r.dense=MH);var u,h={},d=[],f=r.dense?[]:{},g="",p={},m={},v=LK('<Data ss:Type="String">'),b=0,y=0,w=0,S={s:{r:2e6,c:2e6},e:{r:0,c:0}},C={},k={},x="",E=0,T=[],_={},A={},R=0,O=[],M=[],I={},P=[],N=!1,D=[],F=[],L={},H=0,B=0,U={Sheets:[],WBProps:{date1904:!1}},j={};sj.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/gm,"");for(var W="";i=sj.exec(n);)switch(i[3]=(W=i[3]).toLowerCase()){case"data":if("data"==W){if("/"===i[1]){if((l=c.pop())[0]!==i[3])throw new Error("Bad state: "+l.join("|"))}else"/"!==i[0].charAt(i[0].length-2)&&c.push([i[3],!0]);break}if(c[c.length-1][1])break;"/"===i[1]?WK(n.slice(b,i.index),x,v,"comment"==c[c.length-1][0]?I:p,{c:y,r:w},C,P[y],m,D,r):(x="",v=LK(i[0]),b=i.index+i[0].length);break;case"cell":if("/"===i[1])if(M.length>0&&(p.c=M),(!r.sheetRows||r.sheetRows>w)&&void 0!==p.v&&(r.dense?(f[w]||(f[w]=[]),f[w][y]=p):f[iW(y)+rW(w)]=p),p.HRef&&(p.l={Target:NU(p.HRef)},p.HRefScreenTip&&(p.l.Tooltip=p.HRefScreenTip),delete p.HRef,delete p.HRefScreenTip),(p.MergeAcross||p.MergeDown)&&(H=y+(0|parseInt(p.MergeAcross,10)),B=w+(0|parseInt(p.MergeDown,10)),T.push({s:{c:y,r:w},e:{c:H,r:B}})),r.sheetStubs)if(p.MergeAcross||p.MergeDown){for(var V=y;V<=H;++V)for(var z=w;z<=B;++z)(V>y||z>w)&&(r.dense?(f[z]||(f[z]=[]),f[z][V]={t:"z"}):f[iW(V)+rW(z)]={t:"z"});y=H+1}else++y;else p.MergeAcross?y=H+1:++y;else(p=HK(i[0])).Index&&(y=+p.Index-1),y<S.s.c&&(S.s.c=y),y>S.e.c&&(S.e.c=y),"/>"===i[0].slice(-2)&&++y,M=[];break;case"row":"/"===i[1]||"/>"===i[0].slice(-2)?(w<S.s.r&&(S.s.r=w),w>S.e.r&&(S.e.r=w),"/>"===i[0].slice(-2)&&(m=LK(i[0])).Index&&(w=+m.Index-1),y=0,++w):((m=LK(i[0])).Index&&(w=+m.Index-1),L={},("0"==m.AutoFitHeight||m.Height)&&(L.hpx=parseInt(m.Height,10),L.hpt=Fq(L.hpx),F[w]=L),"1"==m.Hidden&&(L.hidden=!0,F[w]=L));break;case"worksheet":if("/"===i[1]){if((l=c.pop())[0]!==i[3])throw new Error("Bad state: "+l.join("|"));d.push(g),S.s.r<=S.e.r&&S.s.c<=S.e.c&&(f["!ref"]=lW(S),r.sheetRows&&r.sheetRows<=S.e.r&&(f["!fullref"]=f["!ref"],S.e.r=r.sheetRows-1,f["!ref"]=lW(S))),T.length&&(f["!merges"]=T),P.length>0&&(f["!cols"]=P),F.length>0&&(f["!rows"]=F),h[g]=f}else S={s:{r:2e6,c:2e6},e:{r:0,c:0}},w=y=0,c.push([i[3],!1]),l=LK(i[0]),g=NU(l.Name),f=r.dense?[]:{},T=[],D=[],F=[],j={name:g,Hidden:0},U.Sheets.push(j);break;case"table":if("/"===i[1]){if((l=c.pop())[0]!==i[3])throw new Error("Bad state: "+l.join("|"))}else{if("/>"==i[0].slice(-2))break;c.push([i[3],!1]),P=[],N=!1}break;case"style":"/"===i[1]?jK(C,k,r):k=LK(i[0]);break;case"numberformat":k.nf=NU(LK(i[0]).Format||"General"),NK[k.nf]&&(k.nf=NK[k.nf]);for(var q=0;392!=q&&tB[q]!=k.nf;++q);if(392==q)for(q=57;392!=q;++q)if(null==tB[q]){NB(k.nf,q);break}break;case"column":if("table"!==c[c.length-1][0])break;if((u=LK(i[0])).Hidden&&(u.hidden=!0,delete u.Hidden),u.Width&&(u.wpx=parseInt(u.Width,10)),!N&&u.wpx>10){N=!0,Aq=Eq;for(var G=0;G<P.length;++G)P[G]&&Nq(P[G])}N&&Nq(u),P[u.Index-1||P.length]=u;for(var $=0;$<+u.Span;++$)P[P.length]=aU(u);break;case"namedrange":if("/"===i[1])break;U.Names||(U.Names=[]);var K=OU(i[0]),Y={Name:K.Name,Ref:EG(K.RefersTo.slice(1),{r:0,c:0})};U.Sheets.length>0&&(Y.Sheet=U.Sheets.length-1),U.Names.push(Y);break;case"namedcell":case"b":case"i":case"u":case"s":case"em":case"h2":case"h3":case"sub":case"sup":case"span":case"alignment":case"borders":case"border":case"protection":case"paragraphs":case"name":case"pixelsperinch":case"null":break;case"font":if("/>"===i[0].slice(-2))break;"/"===i[1]?x+=n.slice(E,i.index):E=i.index+i[0].length;break;case"interior":if(!r.cellStyles)break;k.Interior=LK(i[0]);break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if("/>"===i[0].slice(-2))break;"/"===i[1]?_V(_,W,n.slice(R,i.index)):R=i.index+i[0].length;break;case"styles":case"workbook":if("/"===i[1]){if((l=c.pop())[0]!==i[3])throw new Error("Bad state: "+l.join("|"))}else c.push([i[3],!1]);break;case"comment":if("/"===i[1]){if((l=c.pop())[0]!==i[3])throw new Error("Bad state: "+l.join("|"));VK(I),M.push(I)}else c.push([i[3],!1]),I={a:(l=LK(i[0])).Author};break;case"autofilter":if("/"===i[1]){if((l=c.pop())[0]!==i[3])throw new Error("Bad state: "+l.join("|"))}else if("/"!==i[0].charAt(i[0].length-2)){var X=LK(i[0]);f["!autofilter"]={ref:EG(X.Range).replace(/\$/g,"")},c.push([i[3],!0])}break;case"datavalidation":if("/"===i[1]){if((l=c.pop())[0]!==i[3])throw new Error("Bad state: "+l.join("|"))}else"/"!==i[0].charAt(i[0].length-2)&&c.push([i[3],!0]);break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if("/"===i[1]){if((l=c.pop())[0]!==i[3])throw new Error("Bad state: "+l.join("|"))}else"/"!==i[0].charAt(i[0].length-2)&&c.push([i[3],!0]);break;default:if(0==c.length&&"document"==i[3])return IY(n,r);if(0==c.length&&"uof"==i[3])return IY(n,r);var J=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(i[3]){case"allowpng":case"removepersonalinformation":case"downloadcomponents":case"locationofcomponents":case"colors":case"color":case"index":case"rgb":case"targetscreensize":case"readonlyrecommended":break;default:J=!1}break;case"componentoptions":switch(i[3]){case"toolbar":case"hideofficelogo":case"spreadsheetautofit":case"label":case"caption":case"maxheight":case"maxwidth":case"nextsheetnumber":break;default:J=!1}break;case"excelworkbook":switch(i[3]){case"date1904":U.WBProps.date1904=!0;break;case"windowheight":case"windowwidth":case"windowtopx":case"windowtopy":case"tabratio":case"protectstructure":case"protectwindow":case"protectwindows":case"activesheet":case"displayinknotes":case"firstvisiblesheet":case"supbook":case"sheetname":case"sheetindex":case"sheetindexfirst":case"sheetindexlast":case"dll":case"acceptlabelsinformulas":case"donotsavelinkvalues":case"iteration":case"maxiterations":case"maxchange":case"path":case"xct":case"count":case"selectedsheets":case"calculation":case"uncalced":case"startupprompt":case"crn":case"externname":case"formula":case"colfirst":case"collast":case"wantadvise":case"boolean":case"error":case"text":case"ole":case"noautorecover":case"publishobjects":case"donotcalculatebeforesave":case"number":case"refmoder1c1":case"embedsavesmarttags":break;default:J=!1}break;case"workbookoptions":switch(i[3]){case"owcversion":case"height":case"width":break;default:J=!1}break;case"worksheetoptions":switch(i[3]){case"visible":if("/>"===i[0].slice(-2));else if("/"===i[1])switch(n.slice(R,i.index)){case"SheetHidden":j.Hidden=1;break;case"SheetVeryHidden":j.Hidden=2}else R=i.index+i[0].length;break;case"header":f["!margins"]||k$(f["!margins"]={},"xlml"),isNaN(+OU(i[0]).Margin)||(f["!margins"].header=+OU(i[0]).Margin);break;case"footer":f["!margins"]||k$(f["!margins"]={},"xlml"),isNaN(+OU(i[0]).Margin)||(f["!margins"].footer=+OU(i[0]).Margin);break;case"pagemargins":var Z=OU(i[0]);f["!margins"]||k$(f["!margins"]={},"xlml"),isNaN(+Z.Top)||(f["!margins"].top=+Z.Top),isNaN(+Z.Left)||(f["!margins"].left=+Z.Left),isNaN(+Z.Right)||(f["!margins"].right=+Z.Right),isNaN(+Z.Bottom)||(f["!margins"].bottom=+Z.Bottom);break;case"displayrighttoleft":U.Views||(U.Views=[]),U.Views[0]||(U.Views[0]={}),U.Views[0].RTL=!0;break;case"freezepanes":case"frozennosplit":case"splithorizontal":case"splitvertical":case"donotdisplaygridlines":case"activerow":case"activecol":case"toprowbottompane":case"leftcolumnrightpane":case"unsynced":case"print":case"printerrors":case"panes":case"scale":case"pane":case"number":case"layout":case"pagesetup":case"selected":case"protectobjects":case"enableselection":case"protectscenarios":case"validprinterinfo":case"horizontalresolution":case"verticalresolution":case"numberofcopies":case"activepane":case"toprowvisible":case"leftcolumnvisible":case"fittopage":case"rangeselection":case"papersizeindex":case"pagelayoutzoom":case"pagebreakzoom":case"filteron":case"fitwidth":case"fitheight":case"commentslayout":case"zoom":case"lefttoright":case"gridlines":case"allowsort":case"allowfilter":case"allowinsertrows":case"allowdeleterows":case"allowinsertcols":case"allowdeletecols":case"allowinserthyperlinks":case"allowformatcells":case"allowsizecols":case"allowsizerows":case"tabcolorindex":case"donotdisplayheadings":case"showpagelayoutzoom":case"blackandwhite":case"donotdisplayzeros":case"displaypagebreak":case"rowcolheadings":case"donotdisplayoutline":case"noorientation":case"allowusepivottables":case"zeroheight":case"viewablerange":case"selection":case"protectcontents":break;case"nosummaryrowsbelowdetail":f["!outline"]||(f["!outline"]={}),f["!outline"].above=!0;break;case"nosummarycolumnsrightdetail":f["!outline"]||(f["!outline"]={}),f["!outline"].left=!0;break;default:J=!1}break;case"pivottable":case"pivotcache":switch(i[3]){case"immediateitemsondrop":case"showpagemultipleitemlabel":case"compactrowindent":case"location":case"pivotfield":case"orientation":case"layoutform":case"layoutsubtotallocation":case"layoutcompactrow":case"position":case"pivotitem":case"datatype":case"datafield":case"sourcename":case"parentfield":case"ptlineitems":case"ptlineitem":case"countofsameitems":case"item":case"itemtype":case"ptsource":case"cacheindex":case"consolidationreference":case"filename":case"reference":case"nocolumngrand":case"norowgrand":case"blanklineafteritems":case"hidden":case"subtotal":case"basefield":case"mapchilditems":case"function":case"refreshonfileopen":case"printsettitles":case"mergelabels":case"defaultversion":case"refreshname":case"refreshdate":case"refreshdatecopy":case"versionlastrefresh":case"versionlastupdate":case"versionupdateablemin":case"versionrefreshablemin":case"calculation":break;default:J=!1}break;case"pagebreaks":switch(i[3]){case"colbreaks":case"colbreak":case"rowbreaks":case"rowbreak":case"colstart":case"colend":case"rowend":break;default:J=!1}break;case"autofilter":switch(i[3]){case"autofiltercolumn":case"autofiltercondition":case"autofilterand":case"autofilteror":break;default:J=!1}break;case"querytable":switch(i[3]){case"id":case"autoformatfont":case"autoformatpattern":case"querysource":case"querytype":case"enableredirections":case"refreshedinxl9":case"urlstring":case"htmltables":case"connection":case"commandtext":case"refreshinfo":case"notitles":case"nextid":case"columninfo":case"overwritecells":case"donotpromptforfile":case"textwizardsettings":case"source":case"number":case"decimal":case"thousandseparator":case"trailingminusnumbers":case"formatsettings":case"fieldtype":case"delimiters":case"tab":case"comma":case"autoformatname":case"versionlastedit":case"versionlastrefresh":break;default:J=!1}break;case"datavalidation":switch(i[3]){case"range":case"type":case"min":case"max":case"sort":case"descending":case"order":case"casesensitive":case"value":case"errorstyle":case"errormessage":case"errortitle":case"inputmessage":case"inputtitle":case"combohide":case"inputhide":case"condition":case"qualifier":case"useblank":case"value1":case"value2":case"format":case"cellrangelist":break;default:J=!1}break;case"sorting":case"conditionalformatting":switch(i[3]){case"range":case"type":case"min":case"max":case"sort":case"descending":case"order":case"casesensitive":case"value":case"errorstyle":case"errormessage":case"errortitle":case"cellrangelist":case"inputmessage":case"inputtitle":case"combohide":case"inputhide":case"condition":case"qualifier":case"useblank":case"value1":case"value2":case"format":break;default:J=!1}break;case"mapinfo":case"schema":case"data":switch(i[3]){case"map":case"entry":case"range":case"xpath":case"field":case"xsdtype":case"filteron":case"aggregate":case"elementtype":case"attributetype":case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":case"row":break;default:J=!1}break;case"smarttags":break;default:J=!1}if(J)break;if(i[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+i[3]+"|"+c.join("|");if("customdocumentproperties"===c[c.length-1][0]){if("/>"===i[0].slice(-2))break;"/"===i[1]?BK(A,W,O,n.slice(R,i.index)):(O=i,R=i.index+i[0].length);break}if(r.WTF)throw"Unrecognized tag: "+i[3]+"|"+c.join("|")}var Q={};return r.bookSheets||r.bookProps||(Q.Sheets=h),Q.SheetNames=d,Q.Workbook=U,Q.SSF=aU(tB),Q.Props=_,Q.Custprops=A,Q}function qK(e,t){switch(uX(t=t||{}),t.type||"base64"){case"base64":return zK(NH(e),t);case"binary":case"buffer":case"file":return zK(e,t);case"array":return zK(jH(e),t)}}function GK(e,t){var r=[];return e.Props&&r.push(function(e,t){var r=[];return zB(TV).map((function(e){for(var t=0;t<gV.length;++t)if(gV[t][1]==e)return gV[t];for(t=0;t<yV.length;++t)if(yV[t][1]==e)return yV[t];throw e})).forEach((function(n){if(null!=e[n[1]]){var i=t&&t.Props&&null!=t.Props[n[1]]?t.Props[n[1]]:e[n[1]];"date"===n[2]&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"Z")),"number"==typeof i?i=String(i):!0===i||!1===i?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),r.push(rj(TV[n[1]]||n[1],i))}})),ij("DocumentProperties",r.join(""),{xmlns:uj.o})}(e.Props,t)),e.Custprops&&r.push(function(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",i=[];return e&&zB(e).forEach((function(t){if(Object.prototype.hasOwnProperty.call(e,t)){for(var n=0;n<gV.length;++n)if(t==gV[n][1])return;for(n=0;n<yV.length;++n)if(t==yV[n][1])return;for(n=0;n<r.length;++n)if(t==r[n])return;var o=e[t],a="string";"number"==typeof o?(a="float",o=String(o)):!0===o||!1===o?(a="boolean",o=o?"1":"0"):o=String(o),i.push(ij(HU(t),o,{"dt:dt":a}))}})),t&&zB(t).forEach((function(r){if(Object.prototype.hasOwnProperty.call(t,r)&&(!e||!Object.prototype.hasOwnProperty.call(e,r))){var n=t[r],o="string";"number"==typeof n?(o="float",n=String(n)):!0===n||!1===n?(o="boolean",n=n?"1":"0"):n instanceof Date?(o="dateTime.tz",n=n.toISOString()):n=String(n),i.push(ij(HU(r),n,{"dt:dt":o}))}})),"<"+n+' xmlns="'+uj.o+'">'+i.join("")+"</"+n+">"}(e.Props,e.Custprops)),r.join("")}function $K(e){return ij("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+_G(e.Ref,{r:0,c:0})})}function KK(e,t,r,n,i,o,a){if(!e||void 0==e.v&&void 0==e.f)return"";var s={};if(e.f&&(s["ss:Formula"]="="+LU(_G(e.f,a))),e.F&&e.F.slice(0,t.length)==t){var l=oW(e.F.slice(t.length+1));s["ss:ArrayRange"]="RC:R"+(l.r==a.r?"":"["+(l.r-a.r)+"]")+"C"+(l.c==a.c?"":"["+(l.c-a.c)+"]")}if(e.l&&e.l.Target&&(s["ss:HRef"]=LU(e.l.Target),e.l.Tooltip&&(s["x:HRefScreenTip"]=LU(e.l.Tooltip))),r["!merges"])for(var c=r["!merges"],u=0;u!=c.length;++u)c[u].s.c==a.c&&c[u].s.r==a.r&&(c[u].e.c>c[u].s.c&&(s["ss:MergeAcross"]=c[u].e.c-c[u].s.c),c[u].e.r>c[u].s.r&&(s["ss:MergeDown"]=c[u].e.r-c[u].s.r));var h="",d="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":h="Number",d=String(e.v);break;case"b":h="Boolean",d=e.v?"1":"0";break;case"e":h="Error",d=eV[e.v];break;case"d":h="DateTime",d=new Date(e.v).toISOString(),null==e.z&&(e.z=e.z||tB[14]);break;case"s":h="String",d=((e.v||"")+"").replace(DU,(function(e){return PU[e]})).replace(BU,(function(e){return"&#x"+e.charCodeAt(0).toString(16).toUpperCase()+";"}))}var f=x$(n.cellXfs,e,n);s["ss:StyleID"]="s"+(21+f),s["ss:Index"]=a.c+1;var g=null!=e.v?d:"",p="z"==e.t?"":'<Data ss:Type="'+h+'">'+g+"</Data>";return(e.c||[]).length>0&&(p+=e.c.map((function(e){var t=ij("ss:Data",(e.t||"").replace(/(\r\n|[\r\n])/g,"&#10;"),{xmlns:"http://www.w3.org/TR/REC-html40"});return ij("Comment",t,{"ss:Author":e.a})})).join("")),ij("Cell",p,s)}function YK(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=Lq(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function XK(e,t,r){var n=[],i=r.SheetNames[e],o=r.Sheets[i],a=o?function(e,t,r,n){if(!e)return"";if(!((n||{}).Workbook||{}).Names)return"";for(var i=n.Workbook.Names,o=[],a=0;a<i.length;++a){var s=i[a];s.Sheet==r&&(s.Name.match(/^_xlfn\./)||o.push($K(s)))}return o.join("")}(o,0,e,r):"";return a.length>0&&n.push("<Names>"+a+"</Names>"),a=o?function(e,t){if(!e["!ref"])return"";var r=cW(e["!ref"]),n=e["!merges"]||[],i=0,o=[];e["!cols"]&&e["!cols"].forEach((function(e,t){Nq(e);var r=!!e.width,n=C$(t,e),i={"ss:Index":t+1};r&&(i["ss:Width"]=Rq(n.width)),e.hidden&&(i["ss:Hidden"]="1"),o.push(ij("Column",null,i))}));for(var a=Array.isArray(e),s=r.s.r;s<=r.e.r;++s){for(var l=[YK(s,(e["!rows"]||[])[s])],c=r.s.c;c<=r.e.c;++c){var u=!1;for(i=0;i!=n.length;++i)if(!(n[i].s.c>c)&&!(n[i].s.r>s)&&!(n[i].e.c<c)&&!(n[i].e.r<s)){n[i].s.c==c&&n[i].s.r==s||(u=!0);break}if(!u){var h={r:s,c:c},d=aW(h),f=a?(e[s]||[])[c]:e[d];l.push(KK(f,d,e,t,0,0,h))}}l.push("</Row>"),l.length>2&&o.push(l.join(""))}return o.join("")}(o,t):"",a.length>0&&n.push("<Table>"+a+"</Table>"),n.push(function(e,t,r,n){if(!e)return"";var i=[];if(e["!margins"]&&(i.push("<PageSetup>"),e["!margins"].header&&i.push(ij("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&i.push(ij("Footer",null,{"x:Margin":e["!margins"].footer})),i.push(ij("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),i.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)i.push(ij("Visible",1==n.Workbook.Sheets[r].Hidden?"SheetHidden":"SheetVeryHidden",{}));else{for(var o=0;o<r&&(!n.Workbook.Sheets[o]||n.Workbook.Sheets[o].Hidden);++o);o==r&&i.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),e["!protect"]&&(i.push(rj("ProtectContents","True")),e["!protect"].objects&&i.push(rj("ProtectObjects","True")),e["!protect"].scenarios&&i.push(rj("ProtectScenarios","True")),null==e["!protect"].selectLockedCells||e["!protect"].selectLockedCells?null==e["!protect"].selectUnlockedCells||e["!protect"].selectUnlockedCells||i.push(rj("EnableSelection","UnlockedCells")):i.push(rj("EnableSelection","NoSelection")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach((function(t){e["!protect"][t[0]]&&i.push("<"+t[1]+"/>")}))),0==i.length?"":ij("WorksheetOptions",i.join(""),{xmlns:uj.x})}(o,0,e,r)),n.join("")}function JK(e,t){t||(t={}),e.SSF||(e.SSF=aU(tB)),e.SSF&&(FB(),DB(e.SSF),t.revssf=$B(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],x$(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(GK(e,t)),r.push(""),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(ij("Worksheet",XK(n,t,e),{"ss:Name":LU(e.SheetNames[n])}));return r[2]=function(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach((function(e,t){var n=[];n.push(ij("NumberFormat",null,{"ss:Format":LU(tB[e.numFmtId])}));var i={"ss:ID":"s"+(21+t)};r.push(ij("Style",n.join(""),i))})),ij("Styles",r.join(""))}(0,t),r[3]=function(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var i=t[n];null==i.Sheet&&(i.Name.match(/^_xlfn\./)||r.push($K(i)))}return ij("Names",r.join(""))}(e),xU+ij("Workbook",r.join(""),{xmlns:uj.ss,"xmlns:o":uj.o,"xmlns:x":uj.x,"xmlns:ss":uj.ss,"xmlns:dt":uj.dt,"xmlns:html":uj.html})}function ZK(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=function(e){return jW(e,1)}(r),r.length-r.l<=4)return t;var n=r.read_shift(4);return 0==n||n>40?t:(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4||1907505652!==(n=r.read_shift(4))?t:(t.UnicodeClipboardFormat=function(e){return jW(e,2)}(r),0==(n=r.read_shift(4))||n>40?t:(r.l-=4,void(t.Reserved2=r.read_shift(0,"lpwstr")))))}var QK=[60,1084,2066,2165,2175];function eY(e,t,r,n,i){var o=n,a=[],s=r.slice(r.l,r.l+o);if(i&&i.enc&&i.enc.insitu&&s.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:case 133:break;default:i.enc.insitu(s)}a.push(s),r.l+=o;for(var l=Nj(r,r.l),c=lY[l],u=0;null!=c&&QK.indexOf(l)>-1;)o=Nj(r,r.l+2),u=r.l+4,2066==l?u+=4:2165!=l&&2175!=l||(u+=12),s=r.slice(u,r.l+4+o),a.push(s),r.l+=4+o,c=lY[l=Nj(r,r.l)];var h=VH(a);qj(h,0);var d=0;h.lens=[];for(var f=0;f<a.length;++f)h.lens.push(d),d+=a[f].length;if(h.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+h.length+" < "+n;return t.f(h,h.length,i)}function tY(e,t,r){if("z"!==e.t&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=tB[n])}catch(oJ){if(t.WTF)throw oJ}if(!t||!1!==t.cellText)try{"e"===e.t?e.w=e.w||eV[e.v]:0===n||"General"==n?"n"===e.t?(0|e.v)===e.v?e.w=e.v.toString(10):e.w=hB(e.v):e.w=dB(e.v):e.w=PB(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(oJ){if(t.WTF)throw oJ}if(t.cellDates&&n&&"n"==e.t&&RB(tB[n]||String(n))){var i=oB(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function rY(e,t,r){return{v:e,ixfe:t,t:r}}function nY(e,t){var r={opts:{}},n={};null!=MH&&null==t.dense&&(t.dense=MH);var i,o,a,s,l,c,u,h,d=t.dense?[]:{},f={},g={},p=null,m=[],v="",b={},y="",w={},S=[],C=[],k=[],x={Sheets:[],WBProps:{date1904:!1},Views:[{}]},E={},T=function(e){return e<8?QW[e]:e<64&&k[e-8]||QW[e]},_=function(e,t,r){if(!(L>1)&&!(r.sheetRows&&e.r>=r.sheetRows)){if(r.cellStyles&&t.XF&&t.XF.data&&function(e,t,r){var n,i=t.XF.data;i&&i.patternType&&r&&r.cellStyles&&(t.s={},t.s.patternType=i.patternType,(n=kq(T(i.icvFore)))&&(t.s.fgColor={rgb:n}),(n=kq(T(i.icvBack)))&&(t.s.bgColor={rgb:n}))}(0,t,r),delete t.ixfe,delete t.XF,i=e,y=aW(e),g&&g.s&&g.e||(g={s:{r:0,c:0},e:{r:0,c:0}}),e.r<g.s.r&&(g.s.r=e.r),e.c<g.s.c&&(g.s.c=e.c),e.r+1>g.e.r&&(g.e.r=e.r+1),e.c+1>g.e.c&&(g.e.c=e.c+1),r.cellFormula&&t.f)for(var n=0;n<S.length;++n)if(!(S[n][0].s.c>e.c||S[n][0].s.r>e.r)&&!(S[n][0].e.c<e.c||S[n][0].e.r<e.r)){t.F=lW(S[n][0]),S[n][0].s.c==e.c&&S[n][0].s.r==e.r||delete t.f,t.f&&(t.f=""+r$(S[n][1],0,e,N,A));break}r.dense?(d[e.r]||(d[e.r]=[]),d[e.r][e.c]=t):d[y]=t}},A={enc:!1,sbcch:0,snames:[],sharedf:w,arrayf:S,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(A.password=t.password);var R=[],O=[],M=[],I=[],P=!1,N=[];N.SheetNames=A.snames,N.sharedf=A.sharedf,N.arrayf=A.arrayf,N.names=[],N.XTI=[];var D,F=0,L=0,H=0,B=[],U=[];A.codepage=1200,kH(1200);for(var j=!1;e.l<e.length-1;){var W=e.l,V=e.read_shift(2);if(0===V&&10===F)break;var z=e.l===e.length?0:e.read_shift(2),q=lY[V];if(q&&q.f){if(t.bookSheets&&133===F&&133!==V)break;if(F=V,2===q.r||12==q.r){var G=e.read_shift(2);if(z-=2,!A.enc&&G!==V&&((255&G)<<8|G>>8)!==V)throw new Error("rt mismatch: "+G+"!="+V);12==q.r&&(e.l+=10,z-=10)}var $={};if($=10===V?q.f(e,z,A):eY(V,q,e,z,A),0==L&&-1===[9,521,1033,2057].indexOf(F))continue;switch(V){case 34:r.opts.Date1904=x.WBProps.date1904=$;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(A.enc||(e.l=0),A.enc=$,!t.password)throw new Error("File is password-protected");if(null==$.valid)throw new Error("Encryption scheme unsupported");if(!$.valid)throw new Error("Password is incorrect");break;case 92:A.lastuser=$;break;case 66:var K=Number($);switch(K){case 21010:K=1200;break;case 32768:K=1e4;break;case 32769:K=1252}kH(A.codepage=K),j=!0;break;case 317:A.rrtabid=$;break;case 25:A.winlocked=$;break;case 439:r.opts.RefreshAll=$;break;case 12:r.opts.CalcCount=$;break;case 16:r.opts.CalcDelta=$;break;case 17:r.opts.CalcIter=$;break;case 13:r.opts.CalcMode=$;break;case 14:r.opts.CalcPrecision=$;break;case 95:r.opts.CalcSaveRecalc=$;break;case 15:A.CalcRefMode=$;break;case 2211:r.opts.FullCalc=$;break;case 129:$.fDialog&&(d["!type"]="dialog"),$.fBelow||((d["!outline"]||(d["!outline"]={})).above=!0),$.fRight||((d["!outline"]||(d["!outline"]={})).left=!0);break;case 224:C.push($);break;case 430:N.push([$]),N[N.length-1].XTI=[];break;case 35:case 547:N[N.length-1].push($);break;case 24:case 536:D={Name:$.Name,Ref:r$($.rgce,0,null,N,A)},$.itab>0&&(D.Sheet=$.itab-1),N.names.push(D),N[0]||(N[0]=[],N[0].XTI=[]),N[N.length-1].push($),"_xlnm._FilterDatabase"==$.Name&&$.itab>0&&$.rgce&&$.rgce[0]&&$.rgce[0][0]&&"PtgArea3d"==$.rgce[0][0][0]&&(U[$.itab-1]={ref:lW($.rgce[0][0][1][2])});break;case 22:A.ExternCount=$;break;case 23:0==N.length&&(N[0]=[],N[0].XTI=[]),N[N.length-1].XTI=N[N.length-1].XTI.concat($),N.XTI=N.XTI.concat($);break;case 2196:if(A.biff<8)break;null!=D&&(D.Comment=$[1]);break;case 18:d["!protect"]=$;break;case 19:0!==$&&A.WTF&&console.error("Password verifier: "+$);break;case 133:f[$.pos]=$,A.snames.push($.name);break;case 10:if(--L)break;if(g.e){if(g.e.r>0&&g.e.c>0){if(g.e.r--,g.e.c--,d["!ref"]=lW(g),t.sheetRows&&t.sheetRows<=g.e.r){var Y=g.e.r;g.e.r=t.sheetRows-1,d["!fullref"]=d["!ref"],d["!ref"]=lW(g),g.e.r=Y}g.e.r++,g.e.c++}R.length>0&&(d["!merges"]=R),O.length>0&&(d["!objects"]=O),M.length>0&&(d["!cols"]=M),I.length>0&&(d["!rows"]=I),x.Sheets.push(E)}""===v?b=d:n[v]=d,d=t.dense?[]:{};break;case 9:case 521:case 1033:case 2057:if(8===A.biff&&(A.biff={9:2,521:3,1033:4}[V]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[$.BIFFVer]||8),A.biffguess=0==$.BIFFVer,0==$.BIFFVer&&4096==$.dt&&(A.biff=5,j=!0,kH(A.codepage=28591)),8==A.biff&&0==$.BIFFVer&&16==$.dt&&(A.biff=2),L++)break;if(d=t.dense?[]:{},A.biff<8&&!j&&(j=!0,kH(A.codepage=t.codepage||1252)),A.biff<5||0==$.BIFFVer&&4096==$.dt){""===v&&(v="Sheet1"),g={s:{r:0,c:0},e:{r:0,c:0}};var X={pos:e.l-z,name:v};f[X.pos]=X,A.snames.push(v)}else v=(f[W]||{name:""}).name;32==$.dt&&(d["!type"]="chart"),64==$.dt&&(d["!type"]="macro"),R=[],O=[],A.arrayf=S=[],M=[],I=[],P=!1,E={Hidden:(f[W]||{hs:0}).hs,name:v};break;case 515:case 3:case 2:"chart"==d["!type"]&&(t.dense?(d[$.r]||[])[$.c]:d[aW({c:$.c,r:$.r})])&&++$.c,c={ixfe:$.ixfe,XF:C[$.ixfe]||{},v:$.val,t:"n"},H>0&&(c.z=B[c.ixfe>>8&63]),tY(c,t,r.opts.Date1904),_({c:$.c,r:$.r},c,t);break;case 5:case 517:c={ixfe:$.ixfe,XF:C[$.ixfe],v:$.val,t:$.t},H>0&&(c.z=B[c.ixfe>>8&63]),tY(c,t,r.opts.Date1904),_({c:$.c,r:$.r},c,t);break;case 638:c={ixfe:$.ixfe,XF:C[$.ixfe],v:$.rknum,t:"n"},H>0&&(c.z=B[c.ixfe>>8&63]),tY(c,t,r.opts.Date1904),_({c:$.c,r:$.r},c,t);break;case 189:for(var J=$.c;J<=$.C;++J){var Z=$.rkrec[J-$.c][0];c={ixfe:Z,XF:C[Z],v:$.rkrec[J-$.c][1],t:"n"},H>0&&(c.z=B[c.ixfe>>8&63]),tY(c,t,r.opts.Date1904),_({c:J,r:$.r},c,t)}break;case 6:case 518:case 1030:if("String"==$.val){p=$;break}if((c=rY($.val,$.cell.ixfe,$.tt)).XF=C[c.ixfe],t.cellFormula){var Q=$.formula;if(Q&&Q[0]&&Q[0][0]&&"PtgExp"==Q[0][0][0]){var ee=Q[0][0][1][0],te=Q[0][0][1][1],re=aW({r:ee,c:te});w[re]?c.f=""+r$($.formula,0,$.cell,N,A):c.F=((t.dense?(d[ee]||[])[te]:d[re])||{}).F}else c.f=""+r$($.formula,0,$.cell,N,A)}H>0&&(c.z=B[c.ixfe>>8&63]),tY(c,t,r.opts.Date1904),_($.cell,c,t),p=$;break;case 7:case 519:if(!p)throw new Error("String record expects Formula");p.val=$,(c=rY($,p.cell.ixfe,"s")).XF=C[c.ixfe],t.cellFormula&&(c.f=""+r$(p.formula,0,p.cell,N,A)),H>0&&(c.z=B[c.ixfe>>8&63]),tY(c,t,r.opts.Date1904),_(p.cell,c,t),p=null;break;case 33:case 545:S.push($);var ne=aW($[0].s);if(o=t.dense?(d[$[0].s.r]||[])[$[0].s.c]:d[ne],t.cellFormula&&o){if(!p)break;if(!ne||!o)break;o.f=""+r$($[1],0,$[0],N,A),o.F=lW($[0])}break;case 1212:if(!t.cellFormula)break;if(y){if(!p)break;w[aW(p.cell)]=$[0],((o=t.dense?(d[p.cell.r]||[])[p.cell.c]:d[aW(p.cell)])||{}).f=""+r$($[0],0,i,N,A)}break;case 253:c=rY(m[$.isst].t,$.ixfe,"s"),m[$.isst].h&&(c.h=m[$.isst].h),c.XF=C[c.ixfe],H>0&&(c.z=B[c.ixfe>>8&63]),tY(c,t,r.opts.Date1904),_({c:$.c,r:$.r},c,t);break;case 513:t.sheetStubs&&(c={ixfe:$.ixfe,XF:C[$.ixfe],t:"z"},H>0&&(c.z=B[c.ixfe>>8&63]),tY(c,t,r.opts.Date1904),_({c:$.c,r:$.r},c,t));break;case 190:if(t.sheetStubs)for(var ie=$.c;ie<=$.C;++ie){var oe=$.ixfe[ie-$.c];c={ixfe:oe,XF:C[oe],t:"z"},H>0&&(c.z=B[c.ixfe>>8&63]),tY(c,t,r.opts.Date1904),_({c:ie,r:$.r},c,t)}break;case 214:case 516:case 4:(c=rY($.val,$.ixfe,"s")).XF=C[c.ixfe],H>0&&(c.z=B[c.ixfe>>8&63]),tY(c,t,r.opts.Date1904),_({c:$.c,r:$.r},c,t);break;case 0:case 512:1===L&&(g=$);break;case 252:m=$;break;case 1054:if(4==A.biff){B[H++]=$[1];for(var ae=0;ae<H+163&&tB[ae]!=$[1];++ae);ae>=163&&NB($[1],H+163)}else NB($[1],$[0]);break;case 30:B[H++]=$;for(var se=0;se<H+163&&tB[se]!=$;++se);se>=163&&NB($,H+163);break;case 229:R=R.concat($);break;case 93:O[$.cmo[0]]=A.lastobj=$;break;case 438:A.lastobj.TxO=$;break;case 127:A.lastobj.ImData=$;break;case 440:for(l=$[0].s.r;l<=$[0].e.r;++l)for(s=$[0].s.c;s<=$[0].e.c;++s)(o=t.dense?(d[l]||[])[s]:d[aW({c:s,r:l})])&&(o.l=$[1]);break;case 2048:for(l=$[0].s.r;l<=$[0].e.r;++l)for(s=$[0].s.c;s<=$[0].e.c;++s)(o=t.dense?(d[l]||[])[s]:d[aW({c:s,r:l})])&&o.l&&(o.l.Tooltip=$[1]);break;case 28:if(A.biff<=5&&A.biff>=2)break;o=t.dense?(d[$[0].r]||[])[$[0].c]:d[aW($[0])];var le=O[$[2]];o||(t.dense?(d[$[0].r]||(d[$[0].r]=[]),o=d[$[0].r][$[0].c]={t:"z"}):o=d[aW($[0])]={t:"z"},g.e.r=Math.max(g.e.r,$[0].r),g.s.r=Math.min(g.s.r,$[0].r),g.e.c=Math.max(g.e.c,$[0].c),g.s.c=Math.min(g.s.c,$[0].c)),o.c||(o.c=[]),a={a:$[1],t:le.TxO.t},o.c.push(a);break;case 2173:C[$.ixfe],$.ext.forEach((function(e){e[0]}));break;case 125:if(!A.cellStyles)break;for(;$.e>=$.s;)M[$.e--]={width:$.w/256,level:$.level||0,hidden:!!(1&$.flags)},P||(P=!0,Pq($.w/256)),Nq(M[$.e+1]);break;case 520:var ce={};null!=$.level&&(I[$.r]=ce,ce.level=$.level),$.hidden&&(I[$.r]=ce,ce.hidden=!0),$.hpt&&(I[$.r]=ce,ce.hpt=$.hpt,ce.hpx=Lq($.hpt));break;case 38:case 39:case 40:case 41:d["!margins"]||k$(d["!margins"]={}),d["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[V]]=$;break;case 161:d["!margins"]||k$(d["!margins"]={}),d["!margins"].header=$.header,d["!margins"].footer=$.footer;break;case 574:$.RTL&&(x.Views[0].RTL=!0);break;case 146:k=$;break;case 2198:h=$;break;case 140:u=$;break;case 442:v?E.CodeName=$||E.name:x.WBProps.CodeName=$||"ThisWorkbook"}}else q||console.error("Missing Info for XLS Record 0x"+V.toString(16)),e.l+=z}return r.SheetNames=zB(f).sort((function(e,t){return Number(e)-Number(t)})).map((function(e){return f[e].name})),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&b["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=b)):r.Preamble=b,r.Sheets&&U.forEach((function(e,t){r.Sheets[r.SheetNames[t]]["!autofilter"]=e})),r.Strings=m,r.SSF=aU(tB),A.enc&&(r.Encryption=A.enc),h&&(r.Themes=h),r.Metadata={},void 0!==u&&(r.Metadata.Country=u),N.names.length>0&&(x.Names=N.names),r.Workbook=x,r}var iY={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function oY(e,t){var r,n,i,o;if(t||(t={}),uX(t),xH(),t.codepage&&CH(t.codepage),e.FullPaths){if(UB.find(e,"/encryption"))throw new Error("File is password-protected");r=UB.find(e,"!CompObj"),n=UB.find(e,"/Workbook")||UB.find(e,"/Book")}else{switch(t.type){case"base64":e=BH(NH(e));break;case"binary":e=BH(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e))}qj(e,0),n={content:e}}if(r&&ZK(r),t.bookProps&&!t.bookSheets)i={};else{var a=DH?"buffer":"array";if(n&&n.content)i=nY(n.content,t);else if((o=UB.find(e,"PerfectOffice_MAIN"))&&o.content)i=Yz.to_workbook(o.content,(t.type=a,t));else{if(!(o=UB.find(e,"NativeContent_MAIN"))||!o.content)throw(o=UB.find(e,"MN0"))&&o.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");i=Yz.to_workbook(o.content,(t.type=a,t))}t.bookVBA&&e.FullPaths&&UB.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=function(e){var t=UB.utils.cfb_new({root:"R"});return e.FullPaths.forEach((function(r,n){if("/"!==r.slice(-1)&&r.match(/_VBA_PROJECT_CUR/)){var i=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");UB.utils.cfb_add(t,i,e.FileIndex[n].content)}})),UB.write(t)}(e))}var s={};return e.FullPaths&&function(e,t,r){var n=UB.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var i=WV(n,KW,iY.DSI);for(var o in i)t[o]=i[o]}catch(oJ){if(r.WTF)throw oJ}var a=UB.find(e,"/!SummaryInformation");if(a&&a.size>0)try{var s=WV(a,YW,iY.SI);for(var l in s)null==t[l]&&(t[l]=s[l])}catch(oJ){if(r.WTF)throw oJ}t.HeadingPairs&&t.TitlesOfParts&&(SV(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}(e,s,t),i.Props=i.Custprops=s,t.bookFiles&&(i.cfb=e),i}function aY(e,t){var r=t||{},n=UB.utils.cfb_new({root:"R"}),i="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":i="/Workbook",r.biff=8;break;case"biff5":i="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return UB.utils.cfb_add(n,i,bY(e,r)),8==r.biff&&(e.Props||e.Custprops)&&function(e,t){var r,n=[],i=[],o=[],a=0,s=qB(KW,"n"),l=qB(YW,"n");if(e.Props)for(r=zB(e.Props),a=0;a<r.length;++a)(Object.prototype.hasOwnProperty.call(s,r[a])?n:Object.prototype.hasOwnProperty.call(l,r[a])?i:o).push([r[a],e.Props[r[a]]]);if(e.Custprops)for(r=zB(e.Custprops),a=0;a<r.length;++a)Object.prototype.hasOwnProperty.call(e.Props||{},r[a])||(Object.prototype.hasOwnProperty.call(s,r[a])?n:Object.prototype.hasOwnProperty.call(l,r[a])?i:o).push([r[a],e.Custprops[r[a]]]);var c=[];for(a=0;a<o.length;++a)BV.indexOf(o[a][0])>-1||wV.indexOf(o[a][0])>-1||null!=o[a][1]&&c.push(o[a]);i.length&&UB.utils.cfb_add(t,"/\x05SummaryInformation",VV(i,iY.SI,l,YW)),(n.length||c.length)&&UB.utils.cfb_add(t,"/\x05DocumentSummaryInformation",VV(n,iY.DSI,s,KW,c.length?c:null,iY.UDI))}(e,n),8==r.biff&&e.vbaraw&&function(e,t){t.FullPaths.forEach((function(r,n){if(0!=n){var i=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");"/"!==i.slice(-1)&&UB.utils.cfb_add(e,i,t.FileIndex[n].content)}}))}(n,UB.read(e.vbaraw,{type:"string"==typeof e.vbaraw?"binary":"buffer"})),n}var sY={0:{f:function(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var i=e.read_shift(2);e.l+=1;var o=e.read_shift(1);return e.l=n,7&o&&(r.level=7&o),16&o&&(r.hidden=!0),32&o&&(r.hpt=i/20),r}},1:{f:function(e){return[CW(e)]}},2:{f:function(e){return[CW(e),PW(e),"n"]}},3:{f:function(e){return[CW(e),e.read_shift(1),"e"]}},4:{f:function(e){return[CW(e),e.read_shift(1),"b"]}},5:{f:function(e){return[CW(e),HW(e),"n"]}},6:{f:function(e){return[CW(e),mW(e),"str"]}},7:{f:function(e){return[CW(e),e.read_shift(4),"s"]}},8:{f:function(e,t,r){var n=e.l+t,i=CW(e);i.r=r["!row"];var o=[i,mW(e),"str"];if(r.cellFormula){e.l+=2;var a=c$(e,n-e.l,r);o[3]=r$(a,0,i,r.supbooks,r)}else e.l=n;return o}},9:{f:function(e,t,r){var n=e.l+t,i=CW(e);i.r=r["!row"];var o=[i,HW(e),"n"];if(r.cellFormula){e.l+=2;var a=c$(e,n-e.l,r);o[3]=r$(a,0,i,r.supbooks,r)}else e.l=n;return o}},10:{f:function(e,t,r){var n=e.l+t,i=CW(e);i.r=r["!row"];var o=[i,e.read_shift(1),"b"];if(r.cellFormula){e.l+=2;var a=c$(e,n-e.l,r);o[3]=r$(a,0,i,r.supbooks,r)}else e.l=n;return o}},11:{f:function(e,t,r){var n=e.l+t,i=CW(e);i.r=r["!row"];var o=[i,e.read_shift(1),"e"];if(r.cellFormula){e.l+=2;var a=c$(e,n-e.l,r);o[3]=r$(a,0,i,r.supbooks,r)}else e.l=n;return o}},12:{f:function(e){return[xW(e)]}},13:{f:function(e){return[xW(e),PW(e),"n"]}},14:{f:function(e){return[xW(e),e.read_shift(1),"e"]}},15:{f:function(e){return[xW(e),e.read_shift(1),"b"]}},16:{f:K$},17:{f:function(e){return[xW(e),mW(e),"str"]}},18:{f:function(e){return[xW(e),e.read_shift(4),"s"]}},19:{f:yW},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:function(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var i=e.read_shift(4),o=OW(e),a=u$(e,0,r),s=AW(e);e.l=n;var l={Name:o,Ptg:a};return i<268435455&&(l.Sheet=i),s&&(l.Comment=s),l}},40:{},42:{},43:{f:function(e,t,r){var n={};n.sz=e.read_shift(2)/20;var i=function(e){var t=e.read_shift(1);return e.l++,{fBold:1&t,fItalic:2&t,fUnderline:4&t,fStrikeout:8&t,fOutline:16&t,fShadow:32&t,fCondense:64&t,fExtend:128&t}}(e);switch(i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1),700===e.read_shift(2)&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript"}var o=e.read_shift(1);0!=o&&(n.underline=o);var a=e.read_shift(1);a>0&&(n.family=a);var s=e.read_shift(1);switch(s>0&&(n.charset=s),e.l++,n.color=function(e){var t={},r=e.read_shift(1)>>>1,n=e.read_shift(1),i=e.read_shift(2,"i"),o=e.read_shift(1),a=e.read_shift(1),s=e.read_shift(1);switch(e.l++,r){case 0:t.auto=1;break;case 1:t.index=n;var l=QW[n];l&&(t.rgb=kq(l));break;case 2:t.rgb=kq([o,a,s]);break;case 3:t.theme=n}return 0!=i&&(t.tint=i>0?i/32767:i/32768),t}(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor"}return n.name=mW(e),n}},44:{f:function(e,t){return[e.read_shift(2),mW(e)]}},45:{f:$q},46:{f:Jq},47:{f:function(e,t){var r=e.l+t,n=e.read_shift(2),i=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:i}}},48:{},49:{f:function(e){return e.read_shift(4,"i")}},50:{},51:{f:function(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Bz},62:{f:function(e){return[CW(e),yW(e),"is"]}},63:{f:function(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=aW(r);var n=e.read_shift(1);return 2&n&&(t.l="1"),8&n&&(t.a="1"),t}},64:{f:function(){}},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Gj,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:function(e){var t=e.read_shift(2);return e.l+=28,{RTL:32&t}}},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:function(e,t){var r={},n=e[e.l];return++e.l,r.above=!(64&n),r.left=!(128&n),e.l+=18,r.name=TW(e,t-19),r}},148:{f:G$,p:16},151:{f:function(){}},152:{},153:{f:function(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var i=t>8?mW(e):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(65536&n),r.backupFile=!!(64&n),r.checkCompatibility=!!(4096&n),r.date1904=!!(1&n),r.filterPrivacy=!!(8&n),r.hidePivotFieldList=!!(1024&n),r.promptedSolutions=!!(16&n),r.publishItems=!!(2048&n),r.refreshAllConnections=!!(262144&n),r.saveExternalLinkValues=!!(128&n),r.showBorderUnselectedTables=!!(4&n),r.showInkAnnotation=!!(32&n),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(32768&n),r.updateLinks=["userSet","never","always"][n>>8&3],r}},154:{},155:{},156:{f:function(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=MW(e,t-8),r.name=mW(e),r}},157:{},158:{},159:{T:1,f:function(e){return[e.read_shift(4),e.read_shift(4)]}},160:{T:-1},161:{T:1,f:FW},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:Y$},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:function(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:mW(e)}}},336:{T:-1},337:{f:function(e){return e.l+=4,0!=e.read_shift(4)},T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:MW},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Nz},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:function(e,t,r){var n=e.l+t,i=DW(e),o=e.read_shift(1),a=[i];if(a[2]=o,r.cellFormula){var s=l$(e,n-e.l,r);a[1]=s}else e.l=n;return a}},427:{f:function(e,t,r){var n=e.l+t,i=[FW(e,16)];if(r.cellFormula){var o=h$(e,n-e.l,r);i[1]=o,e.l=n}else e.l=n;return i}},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:function(e){var t={};return J$.forEach((function(r){t[r]=HW(e)})),t}},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:function(){}},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:function(e,t){var r=e.l+t,n=FW(e,16),i=AW(e),o=mW(e),a=mW(e),s=mW(e);e.l=r;var l={rfx:n,relId:i,loc:o,display:s};return a&&(l.Tooltip=a),l}},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:MW},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:SG},633:{T:1},634:{T:-1},635:{T:1,f:function(e){var t={};t.iauthor=e.read_shift(4);var r=FW(e,16);return t.rfx=r.s,t.ref=aW(r.s),e.l+=16,t}},636:{T:-1},637:{f:wW},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:function(e,t){return e.l+=10,{name:mW(e)}}},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:function(){}},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},lY={6:{f:o$},10:{f:zV},12:{f:$V},13:{f:$V},14:{f:qV},15:{f:qV},16:{f:HW},17:{f:qV},18:{f:qV},19:{f:$V},20:{f:Oz},21:{f:Oz},23:{f:Nz},24:{f:Pz},25:{f:qV},26:{},27:{},28:{f:function(e,t,r){return function(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),a=e.read_shift(2),s=rz(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:i},s,a,o]}}(e,0,r)}},29:{},34:{f:qV},35:{f:Mz},38:{f:HW},39:{f:HW},40:{f:HW},41:{f:HW},42:{f:qV},43:{f:qV},47:{f:function(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?Sq(e,t-2,n):function(e,t,r,n){var i={key:$V(e),verificationBytes:$V(e)};r.password&&(i.verifier=bq(r.password)),n.valid=i.verificationBytes===i.verifier,n.valid&&(n.insitu=wq(r.password))}(e,r.biff,r,n),n}},49:{f:function(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10}return n.name=JV(e,0,r),n}},51:{f:$V},60:{},61:{f:function(e){return{Pos:[e.read_shift(2),e.read_shift(2)],Dim:[e.read_shift(2),e.read_shift(2)],Flags:e.read_shift(2),CurTab:e.read_shift(2),FirstTab:e.read_shift(2),Selected:e.read_shift(2),TabRatio:e.read_shift(2)}}},64:{f:qV},65:{f:function(){}},66:{f:$V},77:{},80:{},81:{},82:{},85:{f:$V},89:{},90:{},91:{},92:{f:function(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,i=rz(e,0,r);return e.read_shift(t+n-e.l),i}},93:{f:function(e,t,r){if(r&&r.biff<8)return function(e,t,r){e.l+=4;var n=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var a=[];return a.push((Fz[n]||Gj)(e,t,r)),{cmo:[i,n,o],ft:a}}(e,t,r);var n=bz(e),i=function(e,t){for(var r=e.l+t,n=[];e.l<r;){var i=e.read_shift(2);e.l-=2;try{n.push(wz[i](e,r-e.l))}catch(oJ){return e.l=r,n}}return e.l!=r&&(e.l=r),n}(e,t-22,n[1]);return{cmo:n,ft:i}}},94:{},95:{f:qV},96:{},97:{},99:{f:qV},125:{f:Bz},128:{f:function(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(0!==t[0]&&t[0]--,0!==t[1]&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}},129:{f:function(e,t,r){var n=r&&8==r.biff||2==t?e.read_shift(2):(e.l+=t,0);return{fDialog:16&n,fBelow:64&n,fRight:128&n}}},130:{f:$V},131:{f:qV},132:{f:qV},133:{f:function(e,t,r){var n=e.read_shift(4),i=3&e.read_shift(1),o=e.read_shift(1);switch(o){case 0:o="Worksheet";break;case 1:o="Macrosheet";break;case 2:o="Chartsheet";break;case 6:o="VBAModule"}var a=JV(e,0,r);return 0===a.length&&(a="Sheet1"),{pos:n,hs:i,dt:o,name:a}}},134:{},140:{f:function(e){var t,r=[0,0];return t=e.read_shift(2),r[0]=XW[t]||t,t=e.read_shift(2),r[1]=XW[t]||t,r}},141:{f:$V},144:{},146:{f:function(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(cz(e));return r}},151:{},152:{},153:{},154:{},155:{},156:{f:$V},157:{},158:{},160:{f:jz},161:{f:function(e,t){var r={};return t<32||(e.l+=16,r.header=HW(e),r.footer=HW(e),e.l+=2),r}},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:function(e,t){for(var r=e.l+t-2,n=e.read_shift(2),i=e.read_shift(2),o=[];e.l<r;)o.push(fz(e));if(e.l!==r)throw new Error("MulRK read error");var a=e.read_shift(2);if(o.length!=a-i+1)throw new Error("MulRK length mismatch");return{r:n,c:i,C:a,rkrec:o}}},190:{f:function(e,t){for(var r=e.l+t-2,n=e.read_shift(2),i=e.read_shift(2),o=[];e.l<r;)o.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var a=e.read_shift(2);if(o.length!=a-i+1)throw new Error("MulBlank length mismatch");return{r:n,c:i,C:a,ixfe:o}}},193:{f:zV},197:{},198:{},199:{},200:{},201:{},202:{f:qV},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:$V},220:{},221:{f:qV},222:{},224:{f:function(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,n.data=function(e,t,r,n){var i={},o=e.read_shift(4),a=e.read_shift(4),s=e.read_shift(4),l=e.read_shift(2);return i.patternType=JW[s>>26],n.cellStyles?(i.alc=7&o,i.fWrap=o>>3&1,i.alcV=o>>4&7,i.fJustLast=o>>7&1,i.trot=o>>8&255,i.cIndent=o>>16&15,i.fShrinkToFit=o>>20&1,i.iReadOrder=o>>22&2,i.fAtrNum=o>>26&1,i.fAtrFnt=o>>27&1,i.fAtrAlc=o>>28&1,i.fAtrBdr=o>>29&1,i.fAtrPat=o>>30&1,i.fAtrProt=o>>31&1,i.dgLeft=15&a,i.dgRight=a>>4&15,i.dgTop=a>>8&15,i.dgBottom=a>>12&15,i.icvLeft=a>>16&127,i.icvRight=a>>23&127,i.grbitDiag=a>>30&3,i.icvTop=127&s,i.icvBottom=s>>7&127,i.icvDiag=s>>14&127,i.dgDiag=s>>21&15,i.icvFore=127&l,i.icvBack=l>>7&127,i.fsxButton=l>>14&1,i):i}(e,0,n.fStyle,r),n}},225:{f:function(e,t){return 0===t||e.read_shift(2),1200}},226:{f:zV},227:{},229:{f:function(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(gz(e));return r}},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:function(e,t){for(var r=e.l+t,n=e.read_shift(4),i=e.read_shift(4),o=[],a=0;a!=i&&e.l<r;++a)o.push(ZV(e));return o.Count=n,o.Unique=i,o}},253:{f:function(e){var t=uz(e);return t.isst=e.read_shift(4),t}},255:{f:function(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:YV},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:qV},353:{f:zV},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:function(e,t,r){var n=e.l+t,i=e.read_shift(2),o=e.read_shift(2);if(r.sbcch=o,1025==o||14849==o)return[o,i];if(o<1||o>255)throw new Error("Unexpected SupBook type: "+o);for(var a=ez(e,o),s=[];n>e.l;)s.push(tz(e));return[o,i,a,s]}},431:{f:qV},432:{},433:{},434:{},437:{},438:{f:function(e,t,r){var n=e.l,i="";try{e.l+=4;var o=(r.lastobj||{cmo:[0,0]}).cmo[1];-1==[0,5,7,11,12,14].indexOf(o)?e.l+=6:function(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}(e);var a=e.read_shift(2);e.read_shift(2),$V(e);var s=e.read_shift(2);e.l+=s;for(var l=1;l<e.lens.length-1;++l){if(e.l-n!=e.lens[l])throw new Error("TxO: bad continue record");var c=e[e.l];if((i+=ez(e,e.lens[l+1]-e.lens[l]-1)).length>=(c?a:2*a))break}if(i.length!==a&&i.length!==2*a)throw new Error("cchText: "+a+" != "+i.length);return e.l=n+t,{t:i}}catch(oJ){return e.l=n+t,{t:i}}}},439:{f:qV},440:{f:function(e,t){var r=gz(e);e.l+=16;var n=function(e,t){var r=e.l+t,n=e.read_shift(4);if(2!==n)throw new Error("Unrecognized streamVersion: "+n);var i=e.read_shift(2);e.l+=2;var o,a,s,l,c,u,h="";16&i&&(o=oz(e,e.l)),128&i&&(a=oz(e,e.l)),257===(257&i)&&(s=oz(e,e.l)),1===(257&i)&&(l=iz(e,e.l)),8&i&&(h=oz(e,e.l)),32&i&&(c=e.read_shift(16)),64&i&&(u=AV(e)),e.l=r;var d=a||s||l||"";d&&h&&(d+="#"+h),d||(d="#"+h),2&i&&"/"==d.charAt(0)&&"/"!=d.charAt(1)&&(d="file://"+d);var f={Target:d};return c&&(f.guid=c),u&&(f.time=u),o&&(f.Tooltip=o),f}(e,t-24);return[r,n]}},441:{},442:{f:tz},443:{},444:{f:$V},445:{},446:{},448:{f:zV},449:{f:function(e){return e.read_shift(2),e.read_shift(4)},r:2},450:{f:zV},512:{f:_z},513:{f:Uz},515:{f:function(e,t,r){r.biffguess&&2==r.biff&&(r.biff=5);var n=uz(e),i=HW(e);return n.val=i,n}},516:{f:function(e,t,r){r.biffguess&&2==r.biff&&(r.biff=5),e.l;var n=uz(e);2==r.biff&&e.l++;var i=tz(e,e.l,r);return n.val=i,n}},517:{f:Rz},519:{f:Wz},520:{f:function(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,7&n&&(t.level=7&n),32&n&&(t.hidden=!0),64&n&&(t.hpt=r/20),t}},523:{},545:{f:Dz},549:{f:xz},566:{},574:{f:function(e,t,r){return r&&r.biff>=2&&r.biff<5?{}:{RTL:64&e.read_shift(2)}}},638:{f:function(e){var t=e.read_shift(2),r=e.read_shift(2),n=fz(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}},659:{},1048:{},1054:{f:function(e,t,r){return[e.read_shift(2),rz(e,0,r)]}},1084:{},1212:{f:function(e,t,r){var n=mz(e);e.l++;var i=e.read_shift(1);return[i$(e,t-=8,r),i,n]}},2048:{f:function(e,t){e.read_shift(2);var r=gz(e),n=e.read_shift((t-10)/2,"dbcs-cont");return[r,n=n.replace(zH,"")]}},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Sz},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:zV},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:function(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t},r:12},2173:{f:function(e,t){e.l,e.l+=2;var r=e.read_shift(2);e.l+=2;for(var n=e.read_shift(2),i=[];n-- >0;)i.push(fG(e,e.l));return{ixfe:r,ext:i}},r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:qV,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:function(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),i=e.read_shift(2);return[ez(e,n,r),ez(e,i,r)]}e.l+=t},r:12},2197:{},2198:{f:function(e,t,r){var n=e.l+t;if(124226!==e.read_shift(4))if(r.cellStyles){var i,o=e.slice(e.l);e.l=n;try{i=CU(o,{type:"array"})}catch(oJ){return}var a=vU(i,"theme/theme/theme1.xml",!0);if(a)return uG(a,r)}else e.l=n},r:12},2199:{},2200:{},2201:{},2202:{f:function(e){return[0!==e.read_shift(4),0!==e.read_shift(4),e.read_shift(4)]},r:12},2203:{f:zV},2204:{},2205:{},2206:{},2207:{},2211:{f:function(e){var t=function(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}(e);if(2211!=t.type)throw new Error("Invalid Future Record "+t.type);return 0!==e.read_shift(4)}},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:$V},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:function(e,t,r){var n={area:!1};if(5!=r.biff)return e.l+=t,n;var i=e.read_shift(1);return e.l+=3,16&i&&(n.area=!0),n}},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:function(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(cz(e));return r}},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:_z},1:{},2:{f:function(e){var t=uz(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}},3:{f:function(e){var t=uz(e);++e.l;var r=HW(e);return t.t="n",t.val=r,t}},4:{f:function(e,t,r){r.biffguess&&5==r.biff&&(r.biff=2);var n=uz(e);++e.l;var i=rz(e,0,r);return n.t="str",n.val=i,n}},5:{f:Rz},7:{f:function(e){var t=e.read_shift(1);return 0===t?(e.l++,""):e.read_shift(t,"sbcs-cont")}},8:{},9:{f:Sz},11:{},22:{f:$V},30:{f:Tz},31:{},32:{},33:{f:Dz},36:{},37:{f:xz},50:{f:function(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}},62:{},52:{},67:{},68:{f:$V},69:{},86:{},126:{},127:{f:function(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),i={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,i}},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:function(e,t,r){var n=e.l+t,i=uz(e),o=e.read_shift(2),a=ez(e,o,r);return e.l=n,i.t="str",i.val=a,i}},223:{},234:{},354:{},421:{},518:{f:o$},521:{f:Sz},536:{f:Pz},547:{f:Mz},561:{},579:{},1030:{f:o$},1033:{f:Sz},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function cY(e,t,r,n){var i=t;if(!isNaN(i)){var o=n||(r||[]).length||0,a=e.next(4);a.write_shift(2,i),a.write_shift(2,o),o>0&&Mj(r)&&e.push(r)}}function uY(e,t,r){return e||(e=$j(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function hY(e,t,r,n){if(null!=t.v)switch(t.t){case"d":case"n":var i="d"==t.t?YB(iU(t.v)):t.v;return void(i==(0|i)&&i>=0&&i<65536?cY(e,2,function(e,t,r){var n=$j(9);return uY(n,e,t),n.write_shift(2,r),n}(r,n,i)):cY(e,3,function(e,t,r){var n=$j(15);return uY(n,e,t),n.write_shift(8,r,"f"),n}(r,n,i)));case"b":case"e":return void cY(e,5,function(e,t,r,n){var i=$j(9);return uY(i,e,t),XV(r,n||"b",i),i}(r,n,t.v,t.t));case"s":case"str":return void cY(e,4,function(e,t,r){var n=$j(8+2*r.length);return uY(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}(r,n,(t.v||"").slice(0,255)))}cY(e,1,uY(null,r,n))}function dY(e,t){var r=t||{};null!=MH&&null==r.dense&&(r.dense=MH);for(var n=Yj(),i=0,o=0;o<e.SheetNames.length;++o)e.SheetNames[o]==r.sheet&&(i=o);if(0==i&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return cY(n,4==r.biff?1033:3==r.biff?521:9,Cz(0,16,r)),function(e,t,r,n){var i,o=Array.isArray(t),a=cW(t["!ref"]||"A1"),s="",l=[];if(a.e.c>255||a.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");a.e.c=Math.min(a.e.c,255),a.e.r=Math.min(a.e.c,16383),i=lW(a)}for(var c=a.s.r;c<=a.e.r;++c){s=rW(c);for(var u=a.s.c;u<=a.e.c;++u){c===a.s.r&&(l[u]=iW(u)),i=l[u]+s;var h=o?(t[c]||[])[u]:t[i];h&&hY(e,h,c,u)}}}(n,e.Sheets[e.SheetNames[i]],0,r),cY(n,10),n.end()}function fY(e,t,r){cY(e,49,function(e,t){var r=e.name||"Arial",n=t&&5==t.biff,i=$j(n?15+r.length:16+2*r.length);return i.write_shift(2,20*(e.sz||12)),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,r.length),n||i.write_shift(1,1),i.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),i}({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},r))}function gY(e,t){if(t){var r=0;t.forEach((function(t,n){++r<=256&&t&&cY(e,125,function(e,t){var r=$j(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,256*e.width),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}(C$(n,t),n))}))}}function pY(e,t,r,n,i){var o=16+x$(i.cellXfs,t,i);if(null!=t.v||t.bf)if(t.bf)cY(e,6,a$(t,r,n,0,o));else switch(t.t){case"d":case"n":cY(e,515,function(e,t,r,n){var i=$j(14);return hz(e,t,n,i),BW(r,i),i}(r,n,"d"==t.t?YB(iU(t.v)):t.v,o));break;case"b":case"e":cY(e,517,function(e,t,r,n,i,o){var a=$j(8);return hz(e,t,n,a),XV(r,o,a),a}(r,n,t.v,o,0,t.t));break;case"s":case"str":if(i.bookSST)cY(e,253,function(e,t,r,n){var i=$j(10);return hz(e,t,n,i),i.write_shift(4,r),i}(r,n,S$(i.Strings,t.v,i.revStrings),o));else cY(e,516,function(e,t,r,n,i){var o=!i||8==i.biff,a=$j(+o+8+(1+o)*r.length);return hz(e,t,n,a),a.write_shift(2,r.length),o&&a.write_shift(1,1),a.write_shift((1+o)*r.length,r,o?"utf16le":"sbcs"),a}(r,n,(t.v||"").slice(0,255),o,i));break;default:cY(e,513,hz(r,n,o))}else cY(e,513,hz(r,n,o))}function mY(e,t,r){var n,i=Yj(),o=r.SheetNames[e],a=r.Sheets[o]||{},s=(r||{}).Workbook||{},l=(s.Sheets||[])[e]||{},c=Array.isArray(a),u=8==t.biff,h="",d=[],f=cW(a["!ref"]||"A1"),g=u?65536:16384;if(f.e.c>255||f.e.r>=g){if(t.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:IV16384");f.e.c=Math.min(f.e.c,255),f.e.r=Math.min(f.e.c,g-1)}cY(i,2057,Cz(0,16,t)),cY(i,13,KV(1)),cY(i,12,KV(100)),cY(i,15,GV(!0)),cY(i,17,GV(!1)),cY(i,16,BW(.001)),cY(i,95,GV(!0)),cY(i,42,GV(!1)),cY(i,43,GV(!1)),cY(i,130,KV(1)),cY(i,128,function(e){var t=$j(8);return t.write_shift(4,0),t.write_shift(2,e[0]?e[0]+1:0),t.write_shift(2,e[1]?e[1]+1:0),t}([0,0])),cY(i,131,GV(!1)),cY(i,132,GV(!1)),u&&gY(i,a["!cols"]),cY(i,512,function(e,t){var r=8!=t.biff&&t.biff?2:4,n=$j(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}(f,t)),u&&(a["!links"]=[]);for(var p=f.s.r;p<=f.e.r;++p){h=rW(p);for(var m=f.s.c;m<=f.e.c;++m){p===f.s.r&&(d[m]=iW(m)),n=d[m]+h;var v=c?(a[p]||[])[m]:a[n];v&&(pY(i,v,p,m,t),u&&v.l&&a["!links"].push([n,v.l]))}}var b=l.CodeName||l.name||o;return u&&cY(i,574,function(e){var t=$j(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}((s.Views||[])[0])),u&&(a["!merges"]||[]).length&&cY(i,229,function(e){var t=$j(2+8*e.length);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)pz(e[r],t);return t}(a["!merges"])),u&&function(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];cY(e,440,Lz(n)),n[1].Tooltip&&cY(e,2048,Hz(n))}delete t["!links"]}(i,a),cY(i,442,nz(b)),u&&function(e,t){var r=$j(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),cY(e,2151,r),(r=$j(39)).write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),pz(cW(t["!ref"]||"A1"),r),r.write_shift(4,4),cY(e,2152,r)}(i,a),cY(i,10),i.end()}function vY(e,t,r){var n=Yj(),i=(e||{}).Workbook||{},o=i.Sheets||[],a=i.WBProps||{},s=8==r.biff,l=5==r.biff;(cY(n,2057,Cz(0,5,r)),"xla"==r.bookType&&cY(n,135),cY(n,225,s?KV(1200):null),cY(n,193,function(e,t){t||(t=$j(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}(2)),l&&cY(n,191),l&&cY(n,192),cY(n,226),cY(n,92,function(e,t){var r=!t||8==t.biff,n=$j(r?112:54);for(n.write_shift(8==t.biff?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}(0,r)),cY(n,66,KV(s?1200:1252)),s&&cY(n,353,KV(0)),s&&cY(n,448),cY(n,317,function(e){for(var t=$j(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}(e.SheetNames.length)),s&&e.vbaraw&&cY(n,211),s&&e.vbaraw)&&cY(n,442,nz(a.CodeName||"ThisWorkbook"));cY(n,156,KV(17)),cY(n,25,GV(!1)),cY(n,18,GV(!1)),cY(n,19,KV(0)),s&&cY(n,431,GV(!1)),s&&cY(n,444,KV(0)),cY(n,61,function(){var e=$j(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}()),cY(n,64,GV(!1)),cY(n,141,KV(0)),cY(n,34,GV("true"==function(e){return e.Workbook&&e.Workbook.WBProps&&WU(e.Workbook.WBProps.date1904)?"true":"false"}(e))),cY(n,14,GV(!0)),s&&cY(n,439,GV(!1)),cY(n,218,KV(0)),fY(n,0,r),function(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach((function(n){for(var i=n[0];i<=n[1];++i)null!=t[i]&&cY(e,1054,Ez(i,t[i],r))}))}(n,e.SSF,r),function(e,t){for(var r=0;r<16;++r)cY(e,224,Az({numFmtId:0,style:!0},0,t));t.cellXfs.forEach((function(r){cY(e,224,Az(r,0,t))}))}(n,r),s&&cY(n,352,GV(!1));var c=n.end(),u=Yj();s&&cY(u,140,function(e){return e||(e=$j(4)),e.write_shift(2,1),e.write_shift(2,1),e}()),s&&r.Strings&&function(e,t,r,n){var i=n||(r||[]).length||0;if(i<=8224)return cY(e,t,r,i);var o=t;if(!isNaN(o)){for(var a=r.parts||[],s=0,l=0,c=0;c+(a[s]||8224)<=8224;)c+=a[s]||8224,s++;var u=e.next(4);for(u.write_shift(2,o),u.write_shift(2,c),e.push(r.slice(l,l+c)),l+=c;l<i;){for((u=e.next(4)).write_shift(2,60),c=0;c+(a[s]||8224)<=8224;)c+=a[s]||8224,s++;u.write_shift(2,c),e.push(r.slice(l,l+c)),l+=c}}}(u,252,function(e){var t=$j(8);t.write_shift(4,e.Count),t.write_shift(4,e.Unique);for(var r=[],n=0;n<e.length;++n)r[n]=QV(e[n]);var i=VH([t].concat(r));return i.parts=[t.length].concat(r.map((function(e){return e.length}))),i}(r.Strings)),cY(u,10);var h=u.end(),d=Yj(),f=0,g=0;for(g=0;g<e.SheetNames.length;++g)f+=(s?12:11)+(s?2:1)*e.SheetNames[g].length;var p=c.length+f+h.length;for(g=0;g<e.SheetNames.length;++g){cY(d,133,kz({pos:p,hs:(o[g]||{}).Hidden||0,dt:0,name:e.SheetNames[g]},r)),p+=t[g].length}var m=d.end();if(f!=m.length)throw new Error("BS8 "+f+" != "+m.length);var v=[];return c.length&&v.push(c),m.length&&v.push(m),h.length&&v.push(h),VH(v)}function bY(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(n&&n["!ref"])sW(n["!ref"]).e.c>255&&"undefined"!=typeof console&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}var i=t||{};switch(i.biff||2){case 8:case 5:return function(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=aU(tB)),e&&e.SSF&&(FB(),DB(e.SSF),r.revssf=$B(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,hX(r),r.cellXfs=[],x$(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var i=0;i<e.SheetNames.length;++i)n[n.length]=mY(i,r,e);return n.unshift(vY(e,n,r)),VH(n)}(e,t);case 4:case 3:case 2:return dY(e,t)}throw new Error("invalid type "+i.bookType+" for BIFF")}function yY(e,t){var r=t||{};null!=MH&&null==r.dense&&(r.dense=MH);var n=r.dense?[]:{},i=(e=e.replace(/<!--.*?-->/g,"")).match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var o=e.match(/<\/table/i),a=i.index,s=o&&o.index||e.length,l=hU(e.slice(a,s),/(:?<tr[^>]*>)/i,"<tr>"),c=-1,u=0,h=0,d=0,f={s:{r:1e7,c:1e7},e:{r:0,c:0}},g=[];for(a=0;a<l.length;++a){var p=l[a].trim(),m=p.slice(0,3).toLowerCase();if("<tr"!=m){if("<td"==m||"<th"==m){var v=p.split(/<\/t[dh]>/i);for(s=0;s<v.length;++s){var b=v[s].trim();if(b.match(/<t[dh]/i)){for(var y=b,w=0;"<"==y.charAt(0)&&(w=y.indexOf(">"))>-1;)y=y.slice(w+1);for(var S=0;S<g.length;++S){var C=g[S];C.s.c==u&&C.s.r<c&&c<=C.e.r&&(u=C.e.c+1,S=-1)}var k=OU(b.slice(0,b.indexOf(">")));d=k.colspan?+k.colspan:1,((h=+k.rowspan)>1||d>1)&&g.push({s:{r:c,c:u},e:{r:c+(h||1)-1,c:u+d-1}});var x=k.t||k["data-t"]||"";if(y.length)if(y=XU(y),f.s.r>c&&(f.s.r=c),f.e.r<c&&(f.e.r=c),f.s.c>u&&(f.s.c=u),f.e.c<u&&(f.e.c=u),y.length){var E={t:"s",v:y};r.raw||!y.trim().length||"s"==x||("TRUE"===y?E={t:"b",v:!0}:"FALSE"===y?E={t:"b",v:!1}:isNaN(lU(y))?isNaN(uU(y).getDate())||(E={t:"d",v:iU(y)},r.cellDates||(E={t:"n",v:YB(E.v)}),E.z=r.dateNF||tB[14]):E={t:"n",v:lU(y)}),r.dense?(n[c]||(n[c]=[]),n[c][u]=E):n[aW({r:c,c:u})]=E,u+=d}else u+=d;else u+=d}}}}else{if(++c,r.sheetRows&&r.sheetRows<=c){--c;break}u=0}}return n["!ref"]=lW(f),g.length&&(n["!merges"]=g),n}function wY(e,t,r,n){for(var i=e["!merges"]||[],o=[],a=t.s.c;a<=t.e.c;++a){for(var s=0,l=0,c=0;c<i.length;++c)if(!(i[c].s.r>r||i[c].s.c>a)&&!(i[c].e.r<r||i[c].e.c<a)){if(i[c].s.r<r||i[c].s.c<a){s=-1;break}s=i[c].e.r-i[c].s.r+1,l=i[c].e.c-i[c].s.c+1;break}if(!(s<0)){var u=aW({r:r,c:a}),h=n.dense?(e[r]||[])[a]:e[u],d=h&&null!=h.v&&(h.h||UU(h.w||(hW(h),h.w)||""))||"",f={};s>1&&(f.rowspan=s),l>1&&(f.colspan=l),n.editable?d='<span contenteditable="true">'+d+"</span>":h&&(f["data-t"]=h&&h.t||"z",null!=h.v&&(f["data-v"]=h.v),null!=h.z&&(f["data-z"]=h.z),h.l&&"#"!=(h.l.Target||"#").charAt(0)&&(d='<a href="'+h.l.Target+'">'+d+"</a>")),f.id=(n.id||"sjs")+"-"+u,o.push(ij("td",d,f))}}return"<tr>"+o.join("")+"</tr>"}var SY='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',CY="</body></html>";function kY(e,t,r){return[].join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function xY(e,t){var r=t||{},n=null!=r.header?r.header:SY,i=null!=r.footer?r.footer:CY,o=[n],a=sW(e["!ref"]);r.dense=Array.isArray(e),o.push(kY(0,0,r));for(var s=a.s.r;s<=a.e.r;++s)o.push(wY(e,a,s,r));return o.push("</table>"+i),o.join("")}function EY(e,t,r){var n=r||{};null!=MH&&(n.dense=MH);var i=0,o=0;if(null!=n.origin)if("number"==typeof n.origin)i=n.origin;else{var a="string"==typeof n.origin?oW(n.origin):n.origin;i=a.r,o=a.c}var s=t.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,s.length),c={s:{r:0,c:0},e:{r:i,c:o}};if(e["!ref"]){var u=sW(e["!ref"]);c.s.r=Math.min(c.s.r,u.s.r),c.s.c=Math.min(c.s.c,u.s.c),c.e.r=Math.max(c.e.r,u.e.r),c.e.c=Math.max(c.e.c,u.e.c),-1==i&&(c.e.r=i=u.e.r+1)}var h=[],d=0,f=e["!rows"]||(e["!rows"]=[]),g=0,p=0,m=0,v=0,b=0,y=0;for(e["!cols"]||(e["!cols"]=[]);g<s.length&&p<l;++g){var w=s[g];if(_Y(w)){if(n.display)continue;f[p]={hidden:!0}}var S=w.children;for(m=v=0;m<S.length;++m){var C=S[m];if(!n.display||!_Y(C)){var k=C.hasAttribute("data-v")?C.getAttribute("data-v"):C.hasAttribute("v")?C.getAttribute("v"):XU(C.innerHTML),x=C.getAttribute("data-z")||C.getAttribute("z");for(d=0;d<h.length;++d){var E=h[d];E.s.c==v+o&&E.s.r<p+i&&p+i<=E.e.r&&(v=E.e.c+1-o,d=-1)}y=+C.getAttribute("colspan")||1,((b=+C.getAttribute("rowspan")||1)>1||y>1)&&h.push({s:{r:p+i,c:v+o},e:{r:p+i+(b||1)-1,c:v+o+(y||1)-1}});var T={t:"s",v:k},_=C.getAttribute("data-t")||C.getAttribute("t")||"";null!=k&&(0==k.length?T.t=_||"z":n.raw||0==k.trim().length||"s"==_||("TRUE"===k?T={t:"b",v:!0}:"FALSE"===k?T={t:"b",v:!1}:isNaN(lU(k))?isNaN(uU(k).getDate())||(T={t:"d",v:iU(k)},n.cellDates||(T={t:"n",v:YB(T.v)}),T.z=n.dateNF||tB[14]):T={t:"n",v:lU(k)})),void 0===T.z&&null!=x&&(T.z=x);var A="",R=C.getElementsByTagName("A");if(R&&R.length)for(var O=0;O<R.length&&(!R[O].hasAttribute("href")||"#"==(A=R[O].getAttribute("href")).charAt(0));++O);A&&"#"!=A.charAt(0)&&(T.l={Target:A}),n.dense?(e[p+i]||(e[p+i]=[]),e[p+i][v+o]=T):e[aW({c:v+o,r:p+i})]=T,c.e.c<v+o&&(c.e.c=v+o),v+=y}}++p}return h.length&&(e["!merges"]=(e["!merges"]||[]).concat(h)),c.e.r=Math.max(c.e.r,p-1+i),e["!ref"]=lW(c),p>=l&&(e["!fullref"]=lW((c.e.r=s.length-g+p-1+i,c))),e}function TY(e,t){return EY((t||{}).dense?[]:{},e,t)}function _Y(e){var t="",r=function(e){return e.ownerDocument.defaultView&&"function"===typeof e.ownerDocument.defaultView.getComputedStyle?e.ownerDocument.defaultView.getComputedStyle:"function"===typeof getComputedStyle?getComputedStyle:null}(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),"none"===t}function AY(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,(function(e,t){return Array(parseInt(t,10)+1).join(" ")})).replace(/<text:tab[^>]*\/>/g,"\t").replace(/<text:line-break\/>/g,"\n");return[NU(t.replace(/<[^>]*>/g,""))]}var RY={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function OY(e,t){var r=t||{};null!=MH&&null==r.dense&&(r.dense=MH);var n,i,o,a,s,l,c=aj(e),u=[],h={name:""},d="",f=0,g={},p=[],m=r.dense?[]:{},v={value:""},b="",y=0,w=[],S=-1,C=-1,k={s:{r:1e6,c:1e7},e:{r:0,c:0}},x=0,E={},T=[],_={},A=[],R=1,O=1,M=[],I={Names:[]},P={},N=["",""],D=[],F={},L="",H=0,B=!1,U=!1,j=0;for(sj.lastIndex=0,c=c.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");s=sj.exec(c);)switch(s[3]=s[3].replace(/_.*$/,"")){case"table":case"\u5de5\u4f5c\u8868":"/"===s[1]?(k.e.c>=k.s.c&&k.e.r>=k.s.r?m["!ref"]=lW(k):m["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=k.e.r&&(m["!fullref"]=m["!ref"],k.e.r=r.sheetRows-1,m["!ref"]=lW(k)),T.length&&(m["!merges"]=T),A.length&&(m["!rows"]=A),o.name=o["\u540d\u79f0"]||o.name,"undefined"!==typeof JSON&&JSON.stringify(o),p.push(o.name),g[o.name]=m,U=!1):"/"!==s[0].charAt(s[0].length-2)&&(o=OU(s[0],!1),S=C=-1,k.s.r=k.s.c=1e7,k.e.r=k.e.c=0,m=r.dense?[]:{},T=[],A=[],U=!0);break;case"table-row-group":"/"===s[1]?--x:++x;break;case"table-row":case"\u884c":if("/"===s[1]){S+=R,R=1;break}if((a=OU(s[0],!1))["\u884c\u53f7"]?S=a["\u884c\u53f7"]-1:-1==S&&(S=0),(R=+a["number-rows-repeated"]||1)<10)for(j=0;j<R;++j)x>0&&(A[S+j]={level:x});C=-1;break;case"covered-table-cell":"/"!==s[1]&&++C,r.sheetStubs&&(r.dense?(m[S]||(m[S]=[]),m[S][C]={t:"z"}):m[aW({r:S,c:C})]={t:"z"}),b="",w=[];break;case"table-cell":case"\u6570\u636e":if("/"===s[0].charAt(s[0].length-2))++C,v=OU(s[0],!1),O=parseInt(v["number-columns-repeated"]||"1",10),l={t:"z",v:null},v.formula&&0!=r.cellFormula&&(l.f=p$(NU(v.formula))),"string"==(v["\u6570\u636e\u7c7b\u578b"]||v["value-type"])&&(l.t="s",l.v=NU(v["string-value"]||""),r.dense?(m[S]||(m[S]=[]),m[S][C]=l):m[aW({r:S,c:C})]=l),C+=O-1;else if("/"!==s[1]){b="",y=0,w=[],O=1;var W=R?S+R-1:S;if(++C>k.e.c&&(k.e.c=C),C<k.s.c&&(k.s.c=C),S<k.s.r&&(k.s.r=S),W>k.e.r&&(k.e.r=W),D=[],F={},l={t:(v=OU(s[0],!1))["\u6570\u636e\u7c7b\u578b"]||v["value-type"],v:null},r.cellFormula)if(v.formula&&(v.formula=NU(v.formula)),v["number-matrix-columns-spanned"]&&v["number-matrix-rows-spanned"]&&(_={s:{r:S,c:C},e:{r:S+(parseInt(v["number-matrix-rows-spanned"],10)||0)-1,c:C+(parseInt(v["number-matrix-columns-spanned"],10)||0)-1}},l.F=lW(_),M.push([_,l.F])),v.formula)l.f=p$(v.formula);else for(j=0;j<M.length;++j)S>=M[j][0].s.r&&S<=M[j][0].e.r&&C>=M[j][0].s.c&&C<=M[j][0].e.c&&(l.F=M[j][1]);switch((v["number-columns-spanned"]||v["number-rows-spanned"])&&(_={s:{r:S,c:C},e:{r:S+(parseInt(v["number-rows-spanned"],10)||0)-1,c:C+(parseInt(v["number-columns-spanned"],10)||0)-1}},T.push(_)),v["number-columns-repeated"]&&(O=parseInt(v["number-columns-repeated"],10)),l.t){case"boolean":l.t="b",l.v=WU(v["boolean-value"]);break;case"float":case"percentage":case"currency":l.t="n",l.v=parseFloat(v.value);break;case"date":l.t="d",l.v=iU(v["date-value"]),r.cellDates||(l.t="n",l.v=YB(l.v)),l.z="m/d/yy";break;case"time":l.t="n",l.v=eU(v["time-value"])/86400,r.cellDates&&(l.t="d",l.v=QB(l.v)),l.z="HH:MM:SS";break;case"number":l.t="n",l.v=parseFloat(v["\u6570\u636e\u6570\u503c"]);break;default:if("string"!==l.t&&"text"!==l.t&&l.t)throw new Error("Unsupported value type "+l.t);l.t="s",null!=v["string-value"]&&(b=NU(v["string-value"]),w=[])}}else{if(B=!1,"s"===l.t&&(l.v=b||"",w.length&&(l.R=w),B=0==y),P.Target&&(l.l=P),D.length>0&&(l.c=D,D=[]),b&&!1!==r.cellText&&(l.w=b),B&&(l.t="z",delete l.v),(!B||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=S))for(var V=0;V<R;++V){if(O=parseInt(v["number-columns-repeated"]||"1",10),r.dense)for(m[S+V]||(m[S+V]=[]),m[S+V][C]=0==V?l:aU(l);--O>0;)m[S+V][C+O]=aU(l);else for(m[aW({r:S+V,c:C})]=l;--O>0;)m[aW({r:S+V,c:C+O})]=aU(l);k.e.c<=C&&(k.e.c=C)}C+=(O=parseInt(v["number-columns-repeated"]||"1",10))-1,O=0,l={},b="",w=[]}P={};break;case"document":case"document-content":case"\u7535\u5b50\u8868\u683c\u6587\u6863":case"spreadsheet":case"\u4e3b\u4f53":case"scripts":case"styles":case"font-face-decls":case"master-styles":if("/"===s[1]){if((n=u.pop())[0]!==s[3])throw"Bad state: "+n}else"/"!==s[0].charAt(s[0].length-2)&&u.push([s[3],!0]);break;case"annotation":if("/"===s[1]){if((n=u.pop())[0]!==s[3])throw"Bad state: "+n;F.t=b,w.length&&(F.R=w),F.a=L,D.push(F)}else"/"!==s[0].charAt(s[0].length-2)&&u.push([s[3],!1]);L="",H=0,b="",y=0,w=[];break;case"creator":"/"===s[1]?L=c.slice(H,s.index):H=s.index+s[0].length;break;case"meta":case"\u5143\u6570\u636e":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if("/"===s[1]){if((n=u.pop())[0]!==s[3])throw"Bad state: "+n}else"/"!==s[0].charAt(s[0].length-2)&&u.push([s[3],!1]);b="",y=0,w=[];break;case"scientific-number":case"currency-symbol":case"currency-style":case"script":case"libraries":case"automatic-styles":case"default-style":case"page-layout":case"style":case"map":case"font-face":case"paragraph-properties":case"table-properties":case"table-column-properties":case"table-row-properties":case"table-cell-properties":case"fraction":case"boolean-style":case"boolean":case"text-style":case"text-content":case"text-properties":case"embedded-text":case"body":case"\u7535\u5b50\u8868\u683c":case"forms":case"table-column":case"table-header-rows":case"table-rows":case"table-column-group":case"table-header-columns":case"table-columns":case"null-date":case"graphic-properties":case"calculation-settings":case"named-expressions":case"label-range":case"label-ranges":case"named-expression":case"sort":case"sort-by":case"sort-groups":case"tab":case"line-break":case"span":case"s":case"date":case"object":case"title":case"\u6807\u9898":case"desc":case"binary-data":case"table-source":case"scenario":case"iteration":case"content-validations":case"content-validation":case"help-message":case"error-message":case"database-ranges":case"filter":case"filter-and":case"filter-or":case"filter-condition":case"list-level-style-bullet":case"list-level-style-number":case"list-level-properties":case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":case"event-listener":case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":case"config-item":case"page-number":case"page-count":case"time":case"cell-range-source":case"detective":case"operation":case"highlighted-range":case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":case"rect":case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":case"properties":case"property":case"table-protection":case"data-pilot-grand-total":case"office-document-common-attrs":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if("/"===s[1]){if(E[h.name]=d,(n=u.pop())[0]!==s[3])throw"Bad state: "+n}else"/"!==s[0].charAt(s[0].length-2)&&(d="",h=OU(s[0],!1),u.push([s[3],!0]));break;case"number":case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(u[u.length-1][0]){case"time-style":case"date-style":i=OU(s[0],!1),d+=RY[s[3]]["long"===i.style?1:0]}break;case"text":if("/>"===s[0].slice(-2))break;if("/"===s[1])switch(u[u.length-1][0]){case"number-style":case"date-style":case"time-style":d+=c.slice(f,s.index)}else f=s.index+s[0].length;break;case"named-range":N=m$((i=OU(s[0],!1))["cell-range-address"]);var z={Name:i.name,Ref:N[0]+"!"+N[1]};U&&(z.Sheet=p.length),I.Names.push(z);break;case"p":case"\u6587\u672c\u4e32":if(["master-styles"].indexOf(u[u.length-1][0])>-1)break;if("/"!==s[1]||v&&v["string-value"])OU(s[0],!1),y=s.index+s[0].length;else{var q=AY(c.slice(y,s.index));b=(b.length>0?b+"\n":"")+q[0]}break;case"database-range":if("/"===s[1])break;try{g[(N=m$(OU(s[0])["target-range-address"]))[0]]["!autofilter"]={ref:N[1]}}catch(oJ){}break;case"a":if("/"!==s[1]){if(!(P=OU(s[0],!1)).href)break;P.Target=NU(P.href),delete P.href,"#"==P.Target.charAt(0)&&P.Target.indexOf(".")>-1?(N=m$(P.Target.slice(1)),P.Target="#"+N[0]+"!"+N[1]):P.Target.match(/^\.\.[\\\/]/)&&(P.Target=P.Target.slice(3))}break;default:switch(s[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"\u8868:":case"\u5b57:":break;default:if(r.WTF)throw new Error(s)}}var G={Sheets:g,SheetNames:p,Workbook:I};return r.bookSheets&&delete G.Sheets,G}function MY(e,t){t=t||{},gU(e,"META-INF/manifest.xml")&&function(e,t){for(var r,n,i=aj(e);r=sj.exec(i);)switch(r[3]){case"manifest":break;case"file-entry":if("/"==(n=OU(r[0],!1)).path&&n.type!==uV)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw r}}(mU(e,"META-INF/manifest.xml"),t);var r=vU(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=OY($U(r),t);return gU(e,"meta.xml")&&(n.Props=mV(mU(e,"meta.xml"))),n}function IY(e,t){return OY(e,t)}var PY=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+nj({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return xU+t}}(),NY=function(){var e="          <table:table-cell />\n",t=function(t,r,n){var i=[];i.push('      <table:table table:name="'+LU(r.SheetNames[n])+'" table:style-name="ta1">\n');var o=0,a=0,s=sW(t["!ref"]||"A1"),l=t["!merges"]||[],c=0,u=Array.isArray(t);if(t["!cols"])for(a=0;a<=s.e.c;++a)i.push("        <table:table-column"+(t["!cols"][a]?' table:style-name="co'+t["!cols"][a].ods+'"':"")+"></table:table-column>\n");var h="",d=t["!rows"]||[];for(o=0;o<s.s.r;++o)h=d[o]?' table:style-name="ro'+d[o].ods+'"':"",i.push("        <table:table-row"+h+"></table:table-row>\n");for(;o<=s.e.r;++o){for(h=d[o]?' table:style-name="ro'+d[o].ods+'"':"",i.push("        <table:table-row"+h+">\n"),a=0;a<s.s.c;++a)i.push(e);for(;a<=s.e.c;++a){var f=!1,g={},p="";for(c=0;c!=l.length;++c)if(!(l[c].s.c>a)&&!(l[c].s.r>o)&&!(l[c].e.c<a)&&!(l[c].e.r<o)){l[c].s.c==a&&l[c].s.r==o||(f=!0),g["table:number-columns-spanned"]=l[c].e.c-l[c].s.c+1,g["table:number-rows-spanned"]=l[c].e.r-l[c].s.r+1;break}if(f)i.push("          <table:covered-table-cell/>\n");else{var m=aW({r:o,c:a}),v=u?(t[o]||[])[a]:t[m];if(v&&v.f&&(g["table:formula"]=LU(("of:="+v.f.replace(TG,"$1[.$2$3$4$5]").replace(/\]:\[/g,":")).replace(/;/g,"|").replace(/,/g,";")),v.F&&v.F.slice(0,m.length)==m)){var b=sW(v.F);g["table:number-matrix-columns-spanned"]=b.e.c-b.s.c+1,g["table:number-matrix-rows-spanned"]=b.e.r-b.s.r+1}if(v){switch(v.t){case"b":p=v.v?"TRUE":"FALSE",g["office:value-type"]="boolean",g["office:boolean-value"]=v.v?"true":"false";break;case"n":p=v.w||String(v.v||0),g["office:value-type"]="float",g["office:value"]=v.v||0;break;case"s":case"str":p=null==v.v?"":v.v,g["office:value-type"]="string";break;case"d":p=v.w||iU(v.v).toISOString(),g["office:value-type"]="date",g["office:date-value"]=iU(v.v).toISOString(),g["table:style-name"]="ce1";break;default:i.push(e);continue}var y=LU(p).replace(/  +/g,(function(e){return'<text:s text:c="'+e.length+'"/>'})).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>");if(v.l&&v.l.Target){var w=v.l.Target;"#"==(w="#"==w.charAt(0)?"#"+v$(w.slice(1)):w).charAt(0)||w.match(/^\w+:/)||(w="../"+w),y=ij("text:a",y,{"xlink:href":w.replace(/&/g,"&amp;")})}i.push("          "+ij("table:table-cell",ij("text:p",y,{}),g)+"\n")}else i.push(e)}}i.push("        </table:table-row>\n")}return i.push("      </table:table>\n"),i.join("")};return function(e,r){var n=[xU],i=nj({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),o=nj({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});"fods"==r.bookType?(n.push("<office:document"+i+o+">\n"),n.push(fV().replace(/office:document-meta/g,"office:meta"))):n.push("<office:document-content"+i+">\n"),function(e,t){e.push(" <office:automatic-styles>\n"),e.push('  <number:date-style style:name="N37" number:automatic-order="true">\n'),e.push('   <number:month number:style="long"/>\n'),e.push("   <number:text>/</number:text>\n"),e.push('   <number:day number:style="long"/>\n'),e.push("   <number:text>/</number:text>\n"),e.push("   <number:year/>\n"),e.push("  </number:date-style>\n");var r=0;t.SheetNames.map((function(e){return t.Sheets[e]})).forEach((function(t){if(t&&t["!cols"])for(var n=0;n<t["!cols"].length;++n)if(t["!cols"][n]){var i=t["!cols"][n];if(null==i.width&&null==i.wpx&&null==i.wch)continue;Nq(i),i.ods=r;var o=t["!cols"][n].wpx+"px";e.push('  <style:style style:name="co'+r+'" style:family="table-column">\n'),e.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+o+'"/>\n'),e.push("  </style:style>\n"),++r}}));var n=0;t.SheetNames.map((function(e){return t.Sheets[e]})).forEach((function(t){if(t&&t["!rows"])for(var r=0;r<t["!rows"].length;++r)if(t["!rows"][r]){t["!rows"][r].ods=n;var i=t["!rows"][r].hpx+"px";e.push('  <style:style style:name="ro'+n+'" style:family="table-row">\n'),e.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+i+'"/>\n'),e.push("  </style:style>\n"),++n}})),e.push('  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">\n'),e.push('   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>\n'),e.push("  </style:style>\n"),e.push('  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>\n'),e.push(" </office:automatic-styles>\n")}(n,e),n.push("  <office:body>\n"),n.push("    <office:spreadsheet>\n");for(var a=0;a!=e.SheetNames.length;++a)n.push(t(e.Sheets[e.SheetNames[a]],e,a));return n.push("    </office:spreadsheet>\n"),n.push("  </office:body>\n"),"fods"==r.bookType?n.push("</office:document>"):n.push("</office:document-content>"),n.join("")}}();function DY(e,t){if("fods"==t.bookType)return NY(e,t);var r=SU(),n="",i=[],o=[];return wU(r,n="mimetype","application/vnd.oasis.opendocument.spreadsheet"),wU(r,n="content.xml",NY(e,t)),i.push([n,"text/xml"]),o.push([n,"ContentFile"]),wU(r,n="styles.xml",PY(e,t)),i.push([n,"text/xml"]),o.push([n,"StylesFile"]),wU(r,n="meta.xml",xU+fV()),i.push([n,"text/xml"]),o.push([n,"MetadataFile"]),wU(r,n="manifest.rdf",function(e){var t=[xU];t.push('<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">\n');for(var r=0;r!=e.length;++r)t.push(hV(e[r][0],e[r][1])),t.push(dV("",e[r][0]));return t.push(hV("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}(o)),i.push([n,"application/rdf+xml"]),wU(r,n="META-INF/manifest.xml",function(e){var t=[xU];t.push('<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">\n'),t.push('  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>\n');for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+'"/>\n');return t.push("</manifest:manifest>"),t.join("")}(i)),r}function FY(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function LY(e){return"undefined"!=typeof TextDecoder?(new TextDecoder).decode(e):$U(jH(e))}function HY(e){return"undefined"!=typeof TextEncoder?(new TextEncoder).encode(e):BH(KU(e))}function BY(e){var t=e.reduce((function(e,t){return e+t.length}),0),r=new Uint8Array(t),n=0;return e.forEach((function(e){r.set(e,n),n+=e.length})),r}function UY(e){return 16843009*((e=(858993459&(e-=e>>1&1431655765))+(e>>2&858993459))+(e>>4)&252645135)>>>24}function jY(e,t){var r=t?t[0]:0,n=127&e[r];e:if(e[r++]>=128){if(n|=(127&e[r])<<7,e[r++]<128)break e;if(n|=(127&e[r])<<14,e[r++]<128)break e;if(n|=(127&e[r])<<21,e[r++]<128)break e;if(n+=(127&e[r])*Math.pow(2,28),++r,e[r++]<128)break e;if(n+=(127&e[r])*Math.pow(2,35),++r,e[r++]<128)break e;if(n+=(127&e[r])*Math.pow(2,42),++r,e[r++]<128)break e}return t&&(t[0]=r),n}function WY(e){var t=new Uint8Array(7);t[0]=127&e;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383)break e;if(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)break e;if(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)break e;if(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)break e;if(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103)break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function VY(e){var t=0,r=127&e[t];e:if(e[t++]>=128){if(r|=(127&e[t])<<7,e[t++]<128)break e;if(r|=(127&e[t])<<14,e[t++]<128)break e;if(r|=(127&e[t])<<21,e[t++]<128)break e;r|=(127&e[t])<<28}return r}function zY(e){for(var t=[],r=[0];r[0]<e.length;){var n,i=r[0],o=jY(e,r),a=7&o,s=0;if(0==(o=Math.floor(o/8)))break;switch(a){case 0:for(var l=r[0];e[r[0]++]>=128;);n=e.slice(l,r[0]);break;case 5:s=4,n=e.slice(r[0],r[0]+s),r[0]+=s;break;case 1:s=8,n=e.slice(r[0],r[0]+s),r[0]+=s;break;case 2:s=jY(e,r),n=e.slice(r[0],r[0]+s),r[0]+=s;break;default:throw new Error("PB Type ".concat(a," for Field ").concat(o," at offset ").concat(i))}var c={data:n,type:a};null==t[o]?t[o]=[c]:t[o].push(c)}return t}function qY(e){var t=[];return e.forEach((function(e,r){e.forEach((function(e){e.data&&(t.push(WY(8*r+e.type)),2==e.type&&t.push(WY(e.data.length)),t.push(e.data))}))})),BY(t)}function GY(e,t){return(null==e?void 0:e.map((function(e){return t(e.data)})))||[]}function $Y(e){for(var t,r=[],n=[0];n[0]<e.length;){var i=jY(e,n),o=zY(e.slice(n[0],n[0]+i));n[0]+=i;var a={id:VY(o[1][0].data),messages:[]};o[2].forEach((function(t){var r=zY(t.data),i=VY(r[3][0].data);a.messages.push({meta:r,data:e.slice(n[0],n[0]+i)}),n[0]+=i})),(null==(t=o[3])?void 0:t[0])&&(a.merge=VY(o[3][0].data)>>>0>0),r.push(a)}return r}function KY(e){var t=[];return e.forEach((function(e){var r=[];r[1]=[{data:WY(e.id),type:0}],r[2]=[],null!=e.merge&&(r[3]=[{data:WY(+!!e.merge),type:0}]);var n=[];e.messages.forEach((function(e){n.push(e.data),e.meta[3]=[{type:0,data:WY(e.data.length)}],r[2].push({data:qY(e.meta),type:2})}));var i=qY(r);t.push(WY(i.length)),t.push(i),n.forEach((function(e){return t.push(e)}))})),BY(t)}function YY(e,t){if(0!=e)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=jY(t,r),i=[];r[0]<t.length;){var o=3&t[r[0]];if(0!=o){var a=0,s=0;if(1==o?(s=4+(t[r[0]]>>2&7),a=(224&t[r[0]++])<<3,a|=t[r[0]++]):(s=1+(t[r[0]++]>>2),2==o?(a=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(a=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),i=[BY(i)],0==a)throw new Error("Invalid offset 0");if(a>i[0].length)throw new Error("Invalid offset beyond length");if(s>=a)for(i.push(i[0].slice(-a)),s-=a;s>=i[i.length-1].length;)i.push(i[i.length-1]),s-=i[i.length-1].length;i.push(i[0].slice(-a,-a+s))}else{var l=t[r[0]++]>>2;if(l<60)++l;else{var c=l-59;l=t[r[0]],c>1&&(l|=t[r[0]+1]<<8),c>2&&(l|=t[r[0]+2]<<16),c>3&&(l|=t[r[0]+3]<<24),l>>>=0,l++,r[0]+=c}i.push(t.slice(r[0],r[0]+l)),r[0]+=l}}var u=BY(i);if(u.length!=n)throw new Error("Unexpected length: ".concat(u.length," != ").concat(n));return u}function XY(e){for(var t=[],r=0;r<e.length;){var n=e[r++],i=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(YY(n,e.slice(r,r+i))),r+=i}if(r!==e.length)throw new Error("data is not a valid framed stream!");return BY(t)}function JY(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),i=new Uint8Array(4);t.push(i);var o=WY(n),a=o.length;t.push(o),n<=60?(a++,t.push(new Uint8Array([n-1<<2]))):n<=256?(a+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(a+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(a+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(a+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),a+=n,i[0]=0,i[1]=255&a,i[2]=a>>8&255,i[3]=a>>16&255,r+=n}return BY(t)}function ZY(e,t,r){var n,i=FY(e),o=i.getUint32(8,!0),a=12,s=-1,l=-1,c=NaN,u=NaN,h=new Date(2001,0,1);switch(1&o&&(c=function(e,t){for(var r=(127&e[t+15])<<7|e[t+14]>>1,n=1&e[t+14],i=t+13;i>=t;--i)n=256*n+e[i];return(128&e[t+15]?-n:n)*Math.pow(10,r-6176)}(e,a),a+=16),2&o&&(u=i.getFloat64(a,!0),a+=8),4&o&&(h.setTime(h.getTime()+1e3*i.getFloat64(a,!0)),a+=8),8&o&&(l=i.getUint32(a,!0),a+=4),16&o&&(s=i.getUint32(a,!0),a+=4),e[1]){case 0:break;case 2:case 10:n={t:"n",v:c};break;case 3:n={t:"s",v:t[l]};break;case 5:n={t:"d",v:h};break;case 6:n={t:"b",v:u>0};break;case 7:n={t:"n",v:u/86400};break;case 8:n={t:"e",v:0};break;case 9:if(!(s>-1))throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(31&o," : ").concat(e.slice(0,4)));n={t:"s",v:r[s]};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(31&o," : ").concat(e.slice(0,4)))}return n}function QY(e,t){var r=new Uint8Array(32),n=FY(r),i=12,o=0;switch(r[0]=5,e.t){case"n":r[1]=2,function(e,t,r){var n=Math.floor(0==r?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,i=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(127&n)<<1;for(var o=0;i>=1;++o,i/=256)e[t+o]=255&i;e[t+15]|=r>=0?0:128}(r,i,e.v),o|=1,i+=16;break;case"b":r[1]=6,n.setFloat64(i,e.v?1:0,!0),o|=2,i+=8;break;case"s":if(-1==t.indexOf(e.v))throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(i,t.indexOf(e.v),!0),o|=8,i+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,o,!0),r.slice(0,i)}function eX(e,t){var r=new Uint8Array(32),n=FY(r),i=12,o=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(i,e.v,!0),o|=32,i+=8;break;case"b":r[2]=6,n.setFloat64(i,e.v?1:0,!0),o|=32,i+=8;break;case"s":if(-1==t.indexOf(e.v))throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(i,t.indexOf(e.v),!0),o|=16,i+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,o,!0),r.slice(0,i)}function tX(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return function(e,t,r,n){var i,o=FY(e),a=o.getUint32(4,!0),s=(n>1?12:8)+4*UY(a&(n>1?3470:398)),l=-1,c=-1,u=NaN,h=new Date(2001,0,1);switch(512&a&&(l=o.getUint32(s,!0),s+=4),s+=4*UY(a&(n>1?12288:4096)),16&a&&(c=o.getUint32(s,!0),s+=4),32&a&&(u=o.getFloat64(s,!0),s+=8),64&a&&(h.setTime(h.getTime()+1e3*o.getFloat64(s,!0)),s+=8),e[2]){case 0:break;case 2:i={t:"n",v:u};break;case 3:i={t:"s",v:t[c]};break;case 5:i={t:"d",v:h};break;case 6:i={t:"b",v:u>0};break;case 7:i={t:"n",v:u/86400};break;case 8:i={t:"e",v:0};break;case 9:if(l>-1)i={t:"s",v:r[l]};else if(c>-1)i={t:"s",v:t[c]};else{if(isNaN(u))throw new Error("Unsupported cell type ".concat(e.slice(0,4)));i={t:"n",v:u}}break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return i}(e,t,r,e[0]);case 5:return ZY(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function rX(e){return jY(zY(e)[1][0].data)}function nX(e,t){var r=zY(t.data),n=VY(r[1][0].data),i=r[3],o=[];return(i||[]).forEach((function(t){var r=zY(t.data),i=VY(r[1][0].data)>>>0;switch(n){case 1:o[i]=LY(r[3][0].data);break;case 8:var a=zY(e[rX(r[9][0].data)][0].data),s=e[rX(a[1][0].data)][0],l=VY(s.meta[1][0].data);if(2001!=l)throw new Error("2000 unexpected reference to ".concat(l));var c=zY(s.data);o[i]=c[3].map((function(e){return LY(e.data)})).join("")}})),o}function iX(e,t){var r,n=zY(t.data),i=(null==(r=null==n?void 0:n[7])?void 0:r[0])?VY(n[7][0].data)>>>0>0?1:0:-1,o=GY(n[5],(function(e){return function(e,t){var r,n,i,o,a,s,l,c,u,h,d,f,g,p,m,v,b=zY(e),y=VY(b[1][0].data)>>>0,w=VY(b[2][0].data)>>>0,S=(null==(n=null==(r=b[8])?void 0:r[0])?void 0:n.data)&&VY(b[8][0].data)>0||!1;if((null==(o=null==(i=b[7])?void 0:i[0])?void 0:o.data)&&0!=t)m=null==(s=null==(a=b[7])?void 0:a[0])?void 0:s.data,v=null==(c=null==(l=b[6])?void 0:l[0])?void 0:c.data;else{if(!(null==(h=null==(u=b[4])?void 0:u[0])?void 0:h.data)||1==t)throw"NUMBERS Tile missing ".concat(t," cell storage");m=null==(f=null==(d=b[4])?void 0:d[0])?void 0:f.data,v=null==(p=null==(g=b[3])?void 0:g[0])?void 0:p.data}for(var C=S?4:1,k=FY(m),x=[],E=0;E<m.length/2;++E){var T=k.getUint16(2*E,!0);T<65535&&x.push([E,T])}if(x.length!=w)throw"Expected ".concat(w," cells, found ").concat(x.length);var _=[];for(E=0;E<x.length-1;++E)_[x[E][0]]=v.subarray(x[E][1]*C,x[E+1][1]*C);return x.length>=1&&(_[x[x.length-1][0]]=v.subarray(x[x.length-1][1]*C)),{R:y,cells:_}}(e,i)}));return{nrows:VY(n[4][0].data)>>>0,data:o.reduce((function(e,t){return e[t.R]||(e[t.R]=[]),t.cells.forEach((function(r,n){if(e[t.R][n])throw new Error("Duplicate cell r=".concat(t.R," c=").concat(n));e[t.R][n]=r})),e}),[])}}function oX(e,t){var r={"!ref":"A1"},n=e[rX(zY(t.data)[2][0].data)],i=VY(n[0].meta[1][0].data);if(6001!=i)throw new Error("6000 unexpected reference to ".concat(i));return function(e,t,r){var n,i=zY(t.data),o={s:{r:0,c:0},e:{r:0,c:0}};if(o.e.r=(VY(i[6][0].data)>>>0)-1,o.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(o.e.c=(VY(i[7][0].data)>>>0)-1,o.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));r["!ref"]=lW(o);var a=zY(i[4][0].data),s=nX(e,e[rX(a[4][0].data)][0]),l=(null==(n=a[17])?void 0:n[0])?nX(e,e[rX(a[17][0].data)][0]):[],c=zY(a[3][0].data),u=0;c[1].forEach((function(t){var n=zY(t.data),i=e[rX(n[2][0].data)][0],o=VY(i.meta[1][0].data);if(6002!=o)throw new Error("6001 unexpected reference to ".concat(o));var a=iX(0,i);a.data.forEach((function(e,t){e.forEach((function(e,n){var i=aW({r:u+t,c:n}),o=tX(e,s,l);o&&(r[i]=o)}))})),u+=a.nrows}))}(e,n[0],r),r}function aX(e,t){var r={SheetNames:[],Sheets:{}};if(GY(zY(t.data)[1],rX).forEach((function(t){e[t].forEach((function(t){if(2==VY(t.meta[1][0].data)){var n=function(e,t){var r,n=zY(t.data),i={name:(null==(r=n[1])?void 0:r[0])?LY(n[1][0].data):"",sheets:[]};return GY(n[2],rX).forEach((function(t){e[t].forEach((function(t){6e3==VY(t.meta[1][0].data)&&i.sheets.push(oX(e,t))}))})),i}(e,t);n.sheets.forEach((function(e,t){LX(r,e,0==t?n.name:n.name+"_"+t,!0)}))}}))})),0==r.SheetNames.length)throw new Error("Empty NUMBERS file");return r}function sX(e){var t,r,n,i,o={},a=[];if(e.FullPaths.forEach((function(e){if(e.match(/\.iwpv2/))throw new Error("Unsupported password protection")})),e.FileIndex.forEach((function(e){if(e.name.match(/\.iwa$/)){var t,r;try{t=XY(e.content)}catch(oJ){return console.log("?? "+e.content.length+" "+(oJ.message||oJ))}try{r=$Y(t)}catch(oJ){return console.log("## "+(oJ.message||oJ))}r.forEach((function(e){o[e.id]=e.messages,a.push(e.id)}))}})),!a.length)throw new Error("File has no messages");var s=(null==(i=null==(n=null==(r=null==(t=null==o?void 0:o[1])?void 0:t[0])?void 0:r.meta)?void 0:n[1])?void 0:i[0].data)&&1==VY(o[1][0].meta[1][0].data)&&o[1][0];if(s||a.forEach((function(e){o[e].forEach((function(e){if(1==VY(e.meta[1][0].data)>>>0){if(s)throw new Error("Document has multiple roots");s=e}}))})),!s)throw new Error("Cannot find Document root");return aX(o,s)}function lX(e,t,r){var n,i,o,a;if(!(null==(n=e[6])?void 0:n[0])||!(null==(i=e[7])?void 0:i[0]))throw"Mutation only works on post-BNC storages!";if((null==(a=null==(o=e[8])?void 0:o[0])?void 0:a.data)&&VY(e[8][0].data)>0||!1)throw"Math only works with normal offsets";for(var s=0,l=FY(e[7][0].data),c=0,u=[],h=FY(e[4][0].data),d=0,f=[],g=0;g<t.length;++g)if(null!=t[g]){var p,m;switch(l.setUint16(2*g,c,!0),h.setUint16(2*g,d,!0),typeof t[g]){case"string":p=QY({t:"s",v:t[g]},r),m=eX({t:"s",v:t[g]},r);break;case"number":p=QY({t:"n",v:t[g]},r),m=eX({t:"n",v:t[g]},r);break;case"boolean":p=QY({t:"b",v:t[g]},r),m=eX({t:"b",v:t[g]},r);break;default:throw new Error("Unsupported value "+t[g])}u.push(p),c+=p.length,f.push(m),d+=m.length,++s}else l.setUint16(2*g,65535,!0),h.setUint16(2*g,65535);for(e[2][0].data=WY(s);g<e[7][0].data.length/2;++g)l.setUint16(2*g,65535,!0),h.setUint16(2*g,65535,!0);return e[6][0].data=BY(u),e[3][0].data=BY(f),s}function cX(e){return function(t){for(var r=0;r!=e.length;++r){var n=e[r];void 0===t[n[0]]&&(t[n[0]]=n[1]),"n"===n[2]&&(t[n[0]]=Number(t[n[0]]))}}}function uX(e){cX([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function hX(e){cX([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function dX(e,t,r,n,i,o,a,s,l,c,u,h){try{o[n]=sV(vU(e,r,!0),t);var d,f=mU(e,t);switch(s){case"sheet":d=xK(f,t,i,l,o[n],c,u,h);break;case"chart":if(!(d=EK(f,t,i,l,o[n],c))||!d["!drawel"])break;var g=kU(d["!drawel"].Target,t),p=aV(g),m=function(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}(vU(e,g,!0),sV(vU(e,p,!0),g)),v=kU(m,g),b=aV(v);d=aK(vU(e,v,!0),0,0,sV(vU(e,b,!0),v),0,d);break;case"macro":d=function(e,t){return t.slice(-4),{"!type":"macro"}}(0,t,0,0,o[n]);break;case"dialog":d=function(e,t){return t.slice(-4),{"!type":"dialog"}}(0,t,0,0,o[n]);break;default:throw new Error("Unrecognized sheet type "+s)}a[n]=d;var y=[];o&&o[n]&&zB(o[n]).forEach((function(r){var i="";if(o[n][r].Type==oV.CMNT){i=kU(o[n][r].Target,t);var a=AK(mU(e,i,!0),i,l);if(!a||!a.length)return;bG(d,a,!1)}o[n][r].Type==oV.TCMNT&&(i=kU(o[n][r].Target,t),y=y.concat(function(e,t){var r=[],n=!1,i={},o=0;return e.replace(_U,(function(a,s){var l=OU(a);switch(MU(l[0])){case"<?xml":case"<ThreadedComments":case"</ThreadedComments>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<threadedComment":i={author:l.personId,guid:l.id,ref:l.ref,T:1};break;case"</threadedComment>":null!=i.t&&r.push(i);break;case"<text>":case"<text":o=s+a.length;break;case"</text>":i.t=e.slice(o,s).replace(/\r\n/g,"\n").replace(/\r/g,"\n");break;case"<mentions":case"<mentions>":case"<ext":n=!0;break;case"</mentions>":case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return a})),r}(mU(e,i,!0),l)))})),y&&y.length&&bG(d,y,!0,l.people||[])}catch(oJ){if(l.WTF)throw oJ}}function fX(e){return"/"==e.charAt(0)?e.slice(1):e}function gX(e,t){if(FB(),uX(t=t||{}),gU(e,"META-INF/manifest.xml"))return MY(e,t);if(gU(e,"objectdata.xml"))return MY(e,t);if(gU(e,"Index/Document.iwa")){if("undefined"==typeof Uint8Array)throw new Error("NUMBERS file parsing requires Uint8Array support");if(e.FileIndex)return sX(e);var r=UB.utils.cfb_new();return yU(e).forEach((function(t){wU(r,t,bU(e,t))})),sX(r)}if(!gU(e,"[Content_Types].xml")){if(gU(e,"index.xml.gz"))throw new Error("Unsupported NUMBERS 08 file");if(gU(e,"index.xml"))throw new Error("Unsupported NUMBERS 09 file");throw new Error("Unsupported ZIP file")}var n,i,o=yU(e),a=function(e){var t={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""};if(!e||!e.match)return t;var r={};if((e.match(_U)||[]).forEach((function(e){var n=OU(e);switch(n[0].replace(AU,"<")){case"<?xml":break;case"<Types":t.xmlns=n["xmlns"+(n[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[n.Extension]=n.ContentType;break;case"<Override":void 0!==t[rV[n.ContentType]]&&t[rV[n.ContentType]].push(n.PartName)}})),t.xmlns!==lj.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}(vU(e,"[Content_Types].xml")),s=!1;if(0===a.workbooks.length&&mU(e,i="xl/workbook.xml",!0)&&a.workbooks.push(i),0===a.workbooks.length){if(!mU(e,i="xl/workbook.bin",!0))throw new Error("Could not find workbook");a.workbooks.push(i),s=!0}"bin"==a.workbooks[0].slice(-3)&&(s=!0);var l={},c={};if(!t.bookSheets&&!t.bookProps){if(b$=[],a.sst)try{b$=_K(mU(e,fX(a.sst)),a.sst,t)}catch(oJ){if(t.WTF)throw oJ}t.cellStyles&&a.themes.length&&(l=function(e,t,r){return uG(e,r)}(vU(e,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],t)),a.style&&(c=TK(mU(e,fX(a.style)),a.style,l,t))}a.links.map((function(r){try{sV(vU(e,aV(fX(r))),r);return OK(mU(e,fX(r)),0,r,t)}catch(oJ){}}));var u=kK(mU(e,fX(a.workbooks[0])),a.workbooks[0],t),h={},d="";a.coreprops.length&&((d=mU(e,fX(a.coreprops[0]),!0))&&(h=mV(d)),0!==a.extprops.length&&(d=mU(e,fX(a.extprops[0]),!0))&&function(e,t,r){var n={};t||(t={}),e=$U(e),yV.forEach((function(r){var i=(e.match(YU(r[0]))||[])[1];switch(r[2]){case"string":i&&(t[r[1]]=NU(i));break;case"bool":t[r[1]]="true"===i;break;case"raw":var o=e.match(new RegExp("<"+r[0]+"[^>]*>([\\s\\S]*?)</"+r[0]+">"));o&&o.length>0&&(n[r[1]]=o[1])}})),n.HeadingPairs&&n.TitlesOfParts&&SV(n.HeadingPairs,n.TitlesOfParts,t,r)}(d,h,t));var f={};t.bookSheets&&!t.bookProps||0!==a.custprops.length&&(d=vU(e,fX(a.custprops[0]),!0))&&(f=function(e,t){var r={},n="",i=e.match(kV);if(i)for(var o=0;o!=i.length;++o){var a=i[o],s=OU(a);switch(s[0]){case"<?xml":case"<Properties":break;case"<property":n=NU(s.name);break;case"</property>":n=null;break;default:if(0===a.indexOf("<vt:")){var l=a.split(">"),c=l[0].slice(4),u=l[1];switch(c){case"lpstr":case"bstr":case"lpwstr":case"cy":case"error":r[n]=NU(u);break;case"bool":r[n]=WU(u);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(u,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(u);break;case"filetime":case"date":r[n]=iU(u);break;default:if("/"==c.slice(-1))break;t.WTF&&"undefined"!==typeof console&&console.warn("Unexpected",a,c,l)}}else if("</"===a.slice(0,2));else if(t.WTF)throw new Error(a)}}return r}(d,t));var g={};if((t.bookSheets||t.bookProps)&&(u.Sheets?n=u.Sheets.map((function(e){return e.name})):h.Worksheets&&h.SheetNames.length>0&&(n=h.SheetNames),t.bookProps&&(g.Props=h,g.Custprops=f),t.bookSheets&&"undefined"!==typeof n&&(g.SheetNames=n),t.bookSheets?g.SheetNames:t.bookProps))return g;n={};var p={};t.bookDeps&&a.calcchain&&(p=RK(mU(e,fX(a.calcchain)),a.calcchain));var m,v,b=0,y={},w=u.Sheets;h.Worksheets=w.length,h.SheetNames=[];for(var S=0;S!=w.length;++S)h.SheetNames[S]=w[S].name;var C=s?"bin":"xml",k=a.workbooks[0].lastIndexOf("/"),x=(a.workbooks[0].slice(0,k+1)+"_rels/"+a.workbooks[0].slice(k+1)+".rels").replace(/^\//,"");gU(e,x)||(x="xl/_rels/workbook."+C+".rels");var E=sV(vU(e,x,!0),x.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(t.xlmeta=MK(mU(e,fX(a.metadata[0])),a.metadata[0],t)),(a.people||[]).length>=1&&(t.people=function(e,t){var r=[],n=!1;return e.replace(_U,(function(e){var i=OU(e);switch(MU(i[0])){case"<?xml":case"<personList":case"</personList>":case"</person>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<person":r.push({name:i.displayname,id:i.id});break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+i[0]+" in threaded comments")}return e})),r}(mU(e,fX(a.people[0])),t)),E&&(E=function(e,t){if(!e)return 0;try{e=t.map((function(t){return t.id||(t.id=t.strRelID),[t.name,e["!id"][t.id].Target,(r=e["!id"][t.id].Type,oV.WS.indexOf(r)>-1?"sheet":oV.CS&&r==oV.CS?"chart":oV.DS&&r==oV.DS?"dialog":oV.MS&&r==oV.MS?"macro":r&&r.length?r:"sheet")];var r}))}catch(oJ){return null}return e&&0!==e.length?e:null}(E,u.Sheets));var T=mU(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(b=0;b!=h.Worksheets;++b){var _="sheet";if(E&&E[b]?(m="xl/"+E[b][1].replace(/[\/]?xl\//,""),gU(e,m)||(m=E[b][1]),gU(e,m)||(m=x.replace(/_rels\/.*$/,"")+E[b][1]),_=E[b][2]):m=(m="xl/worksheets/sheet"+(b+1-T)+"."+C).replace(/sheet0\./,"sheet."),v=m.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&null!=t.sheets)switch(typeof t.sheets){case"number":if(b!=t.sheets)continue e;break;case"string":if(h.SheetNames[b].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var A=!1,R=0;R!=t.sheets.length;++R)"number"==typeof t.sheets[R]&&t.sheets[R]==b&&(A=1),"string"==typeof t.sheets[R]&&t.sheets[R].toLowerCase()==h.SheetNames[b].toLowerCase()&&(A=1);if(!A)continue e}}dX(e,m,v,h.SheetNames[b],b,y,n,_,t,u,l,c)}return g={Directory:a,Workbook:u,Props:h,Custprops:f,Deps:p,Sheets:n,SheetNames:h.SheetNames,Strings:b$,Styles:c,Themes:l,SSF:aU(tB)},t&&t.bookFiles&&(e.files?(g.keys=o,g.files=e.files):(g.keys=[],g.files={},e.FullPaths.forEach((function(t,r){t=t.replace(/^Root Entry[\/]/,""),g.keys.push(t),g.files[t]=e.FileIndex[r]})))),t&&t.bookVBA&&(a.vba.length>0?g.vbaraw=mU(e,fX(a.vba[0]),!0):a.defaults&&a.defaults.bin===kG&&(g.vbaraw=mU(e,"xl/vbaProject.bin",!0))),g}function pX(e,t){var r=t||{},n="Workbook",i=UB.find(e,n);try{if(n="/!DataSpaces/Version",!(i=UB.find(e,n))||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(function(e){var t={};t.id=e.read_shift(0,"lpp4"),t.R=uq(e,4),t.U=uq(e,4),t.W=uq(e,4)}(i.content),n="/!DataSpaces/DataSpaceMap",!(i=UB.find(e,n))||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=function(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(hq(e));return t}(i.content);if(1!==o.length||1!==o[0].comps.length||0!==o[0].comps[0].t||"StrongEncryptionDataSpace"!==o[0].name||"EncryptedPackage"!==o[0].comps[0].v)throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",!(i=UB.find(e,n))||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=function(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}(i.content);if(1!=a.length||"StrongEncryptionTransform"!=a[0])throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",!(i=UB.find(e,n))||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);dq(i.content)}catch(oJ){}if(n="/EncryptionInfo",!(i=UB.find(e,n))||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=function(e){var t=uq(e);switch(t.Minor){case 2:return[t.Minor,pq(e)];case 3:return[t.Minor,mq()];case 4:return[t.Minor,vq(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}(i.content);if(n="/EncryptedPackage",!(i=UB.find(e,n))||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(4==s[0]&&"undefined"!==typeof decrypt_agile)return decrypt_agile(s[1],i.content,r.password||"",r);if(2==s[0]&&"undefined"!==typeof decrypt_std76)return decrypt_std76(s[1],i.content,r.password||"",r);throw new Error("File is password-protected")}function mX(e,t){return"ods"==t.bookType?DY(e,t):"numbers"==t.bookType?function(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=sW(r["!ref"]);n.s.r=n.s.c=0;var i=!1;n.e.c>9&&(i=!0,n.e.c=9),n.e.r>49&&(i=!0,n.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(lW(n)));var o=RX(r,{range:n,header:1}),a=["~Sh33tJ5~"];o.forEach((function(e){return e.forEach((function(e){"string"==typeof e&&a.push(e)}))}));var s={},l=[],c=UB.read(t.numbers,{type:"base64"});c.FileIndex.map((function(e,t){return[e,c.FullPaths[t]]})).forEach((function(e){var t=e[0],r=e[1];2==t.type&&t.name.match(/\.iwa/)&&$Y(XY(t.content)).forEach((function(e){l.push(e.id),s[e.id]={deps:[],location:r,type:VY(e.messages[0].meta[1][0].data)}}))})),l.sort((function(e,t){return e-t}));var u=l.filter((function(e){return e>1})).map((function(e){return[e,WY(e)]}));c.FileIndex.map((function(e,t){return[e,c.FullPaths[t]]})).forEach((function(e){var t=e[0];e[1],t.name.match(/\.iwa/)&&$Y(XY(t.content)).forEach((function(e){e.messages.forEach((function(t){u.forEach((function(t){e.messages.some((function(e){return 11006!=VY(e.meta[1][0].data)&&function(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}(e.data,t[1])}))&&s[t[0]].deps.push(e.id)}))}))}))}));for(var h,d=UB.find(c,s[1].location),f=$Y(XY(d.content)),g=0;g<f.length;++g){var p=f[g];1==p.id&&(h=p)}var m=rX(zY(h.messages[0].data)[1][0].data);for(f=$Y(XY((d=UB.find(c,s[m].location)).content)),g=0;g<f.length;++g)(p=f[g]).id==m&&(h=p);for(m=rX(zY(h.messages[0].data)[2][0].data),f=$Y(XY((d=UB.find(c,s[m].location)).content)),g=0;g<f.length;++g)(p=f[g]).id==m&&(h=p);for(m=rX(zY(h.messages[0].data)[2][0].data),f=$Y(XY((d=UB.find(c,s[m].location)).content)),g=0;g<f.length;++g)(p=f[g]).id==m&&(h=p);var v=zY(h.messages[0].data);v[6][0].data=WY(n.e.r+1),v[7][0].data=WY(n.e.c+1);for(var b=rX(v[46][0].data),y=UB.find(c,s[b].location),w=$Y(XY(y.content)),S=0;S<w.length&&w[S].id!=b;++S);if(w[S].id!=b)throw"Bad ColumnRowUIDMapArchive";var C=zY(w[S].messages[0].data);C[1]=[],C[2]=[],C[3]=[];for(var k=0;k<=n.e.c;++k){var x=[];x[1]=x[2]=[{type:0,data:WY(k+420690)}],C[1].push({type:2,data:qY(x)}),C[2].push({type:0,data:WY(k)}),C[3].push({type:0,data:WY(k)})}C[4]=[],C[5]=[],C[6]=[];for(var E=0;E<=n.e.r;++E)(x=[])[1]=x[2]=[{type:0,data:WY(E+726270)}],C[4].push({type:2,data:qY(x)}),C[5].push({type:0,data:WY(E)}),C[6].push({type:0,data:WY(E)});w[S].messages[0].data=qY(C),y.content=JY(KY(w)),y.size=y.content.length,delete v[46];var T=zY(v[4][0].data);T[7][0].data=WY(n.e.r+1);var _=rX(zY(T[1][0].data)[2][0].data);if((w=$Y(XY((y=UB.find(c,s[_].location)).content)))[0].id!=_)throw"Bad HeaderStorageBucket";var A=zY(w[0].messages[0].data);for(E=0;E<o.length;++E){var R=zY(A[2][0].data);R[1][0].data=WY(E),R[4][0].data=WY(o[E].length),A[2][E]={type:A[2][0].type,data:qY(R)}}w[0].messages[0].data=qY(A),y.content=JY(KY(w)),y.size=y.content.length;var O=rX(T[2][0].data);if((w=$Y(XY((y=UB.find(c,s[O].location)).content)))[0].id!=O)throw"Bad HeaderStorageBucket";for(A=zY(w[0].messages[0].data),k=0;k<=n.e.c;++k)(R=zY(A[2][0].data))[1][0].data=WY(k),R[4][0].data=WY(n.e.r+1),A[2][k]={type:A[2][0].type,data:qY(R)};w[0].messages[0].data=qY(A),y.content=JY(KY(w)),y.size=y.content.length;var M=rX(T[4][0].data);!function(){for(var e,t=UB.find(c,s[M].location),r=$Y(XY(t.content)),n=0;n<r.length;++n){var i=r[n];i.id==M&&(e=i)}var o=zY(e.messages[0].data);o[3]=[];var l=[];a.forEach((function(e,t){l[1]=[{type:0,data:WY(t)}],l[2]=[{type:0,data:WY(1)}],l[3]=[{type:2,data:HY(e)}],o[3].push({type:2,data:qY(l)})})),e.messages[0].data=qY(o);var u=JY(KY(r));t.content=u,t.size=t.content.length}();var I=zY(T[3][0].data),P=I[1][0];delete I[2];var N=zY(P.data),D=rX(N[2][0].data);!function(){for(var e,t=UB.find(c,s[D].location),r=$Y(XY(t.content)),i=0;i<r.length;++i){var l=r[i];l.id==D&&(e=l)}var u=zY(e.messages[0].data);delete u[6],delete I[7];var h=new Uint8Array(u[5][0].data);u[5]=[];for(var d=0,f=0;f<=n.e.r;++f){var g=zY(h);d+=lX(g,o[f],a),g[1][0].data=WY(f),u[5].push({data:qY(g),type:2})}u[1]=[{type:0,data:WY(n.e.c+1)}],u[2]=[{type:0,data:WY(n.e.r+1)}],u[3]=[{type:0,data:WY(d)}],u[4]=[{type:0,data:WY(n.e.r+1)}],e.messages[0].data=qY(u);var p=JY(KY(r));t.content=p,t.size=t.content.length}(),P.data=qY(N),T[3][0].data=qY(I),v[4][0].data=qY(T),h.messages[0].data=qY(v);var F=JY(KY(f));return d.content=F,d.size=d.content.length,c}(e,t):"xlsb"==t.bookType?function(e,t){mG=1024,e&&!e.SSF&&(e.SSF=aU(tB));e&&e.SSF&&(FB(),DB(e.SSF),t.revssf=$B(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF);t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,w$?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xlsb"==t.bookType?"bin":"xml",n=xG.indexOf(t.bookType)>-1,i={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""};hX(t=t||{});var o=SU(),a="",s=0;t.cellXfs=[],x$(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});if(wU(o,a="docProps/core.xml",bV(e.Props,t)),i.coreprops.push(a),cV(t.rels,2,a,oV.CORE_PROPS),a="docProps/app.xml",e.Props&&e.Props.SheetNames);else if(e.Workbook&&e.Workbook.Sheets){for(var l=[],c=0;c<e.SheetNames.length;++c)2!=(e.Workbook.Sheets[c]||{}).Hidden&&l.push(e.SheetNames[c]);e.Props.SheetNames=l}else e.Props.SheetNames=e.SheetNames;e.Props.Worksheets=e.Props.SheetNames.length,wU(o,a,CV(e.Props)),i.extprops.push(a),cV(t.rels,3,a,oV.EXT_PROPS),e.Custprops!==e.Props&&zB(e.Custprops||{}).length>0&&(wU(o,a="docProps/custom.xml",xV(e.Custprops)),i.custprops.push(a),cV(t.rels,4,a,oV.CUST_PROPS));for(s=1;s<=e.SheetNames.length;++s){var u={"!id":{}},h=e.Sheets[e.SheetNames[s-1]];(h||{})["!type"];if(wU(o,a="xl/worksheets/sheet"+s+"."+r,IK(s-1,a,t,e,u)),i.sheets.push(a),cV(t.wbrels,-1,"worksheets/sheet"+s+"."+r,oV.WS[0]),h){var d=h["!comments"],f=!1,g="";d&&d.length>0&&(wU(o,g="xl/comments"+s+"."+r,PK(d,g,t)),i.comments.push(g),cV(u,-1,"../comments"+s+"."+r,oV.CMNT),f=!0),h["!legacy"]&&f&&wU(o,"xl/drawings/vmlDrawing"+s+".vml",vG(s,h["!comments"])),delete h["!comments"],delete h["!legacy"]}u["!id"].rId1&&wU(o,aV(a),lV(u))}null!=t.Strings&&t.Strings.length>0&&(wU(o,a="xl/sharedStrings."+r,function(e,t,r){return(".bin"===t.slice(-4)?lq:aq)(e,r)}(t.Strings,a,t)),i.strs.push(a),cV(t.wbrels,-1,"sharedStrings."+r,oV.SST));wU(o,a="xl/workbook."+r,function(e,t,r){return(".bin"===t.slice(-4)?CK:bK)(e,r)}(e,a,t)),i.workbooks.push(a),cV(t.rels,1,a,oV.WB),wU(o,a="xl/theme/theme1.xml",hG(e.Themes,t)),i.themes.push(a),cV(t.wbrels,-1,"theme/theme1.xml",oV.THEME),wU(o,a="xl/styles."+r,function(e,t,r){return(".bin"===t.slice(-4)?tG:Wq)(e,r)}(e,a,t)),i.styles.push(a),cV(t.wbrels,-1,"styles."+r,oV.STY),e.vbaraw&&n&&(wU(o,a="xl/vbaProject.bin",e.vbaraw),i.vba.push(a),cV(t.wbrels,-1,"vbaProject.bin",oV.VBA));return wU(o,a="xl/metadata."+r,function(e){return(".bin"===e.slice(-4)?gG:pG)()}(a)),i.metadata.push(a),cV(t.wbrels,-1,"metadata."+r,oV.XLMETA),wU(o,"[Content_Types].xml",iV(i,t)),wU(o,"_rels/.rels",lV(t.rels)),wU(o,"xl/_rels/workbook."+r+".rels",lV(t.wbrels)),delete t.revssf,delete t.ssf,o}(e,t):vX(e,t)}function vX(e,t){mG=1024,e&&!e.SSF&&(e.SSF=aU(tB)),e&&e.SSF&&(FB(),DB(e.SSF),t.revssf=$B(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,w$?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=xG.indexOf(t.bookType)>-1,i={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""};hX(t=t||{});var o=SU(),a="",s=0;if(t.cellXfs=[],x$(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),wU(o,a="docProps/core.xml",bV(e.Props,t)),i.coreprops.push(a),cV(t.rels,2,a,oV.CORE_PROPS),a="docProps/app.xml",e.Props&&e.Props.SheetNames);else if(e.Workbook&&e.Workbook.Sheets){for(var l=[],c=0;c<e.SheetNames.length;++c)2!=(e.Workbook.Sheets[c]||{}).Hidden&&l.push(e.SheetNames[c]);e.Props.SheetNames=l}else e.Props.SheetNames=e.SheetNames;e.Props.Worksheets=e.Props.SheetNames.length,wU(o,a,CV(e.Props)),i.extprops.push(a),cV(t.rels,3,a,oV.EXT_PROPS),e.Custprops!==e.Props&&zB(e.Custprops||{}).length>0&&(wU(o,a="docProps/custom.xml",xV(e.Custprops)),i.custprops.push(a),cV(t.rels,4,a,oV.CUST_PROPS));var u=["SheetJ5"];for(t.tcid=0,s=1;s<=e.SheetNames.length;++s){var h={"!id":{}},d=e.Sheets[e.SheetNames[s-1]];(d||{})["!type"];if(wU(o,a="xl/worksheets/sheet"+s+"."+r,z$(s-1,t,e,h)),i.sheets.push(a),cV(t.wbrels,-1,"worksheets/sheet"+s+"."+r,oV.WS[0]),d){var f=d["!comments"],g=!1,p="";if(f&&f.length>0){var m=!1;f.forEach((function(e){e[1].forEach((function(e){1==e.T&&(m=!0)}))})),m&&(wU(o,p="xl/threadedComments/threadedComment"+s+"."+r,wG(f,u,t)),i.threadedcomments.push(p),cV(h,-1,"../threadedComments/threadedComment"+s+"."+r,oV.TCMNT)),wU(o,p="xl/comments"+s+"."+r,yG(f)),i.comments.push(p),cV(h,-1,"../comments"+s+"."+r,oV.CMNT),g=!0}d["!legacy"]&&g&&wU(o,"xl/drawings/vmlDrawing"+s+".vml",vG(s,d["!comments"])),delete d["!comments"],delete d["!legacy"]}h["!id"].rId1&&wU(o,aV(a),lV(h))}return null!=t.Strings&&t.Strings.length>0&&(wU(o,a="xl/sharedStrings."+r,aq(t.Strings,t)),i.strs.push(a),cV(t.wbrels,-1,"sharedStrings."+r,oV.SST)),wU(o,a="xl/workbook."+r,bK(e)),i.workbooks.push(a),cV(t.rels,1,a,oV.WB),wU(o,a="xl/theme/theme1.xml",hG(e.Themes,t)),i.themes.push(a),cV(t.wbrels,-1,"theme/theme1.xml",oV.THEME),wU(o,a="xl/styles."+r,Wq(e,t)),i.styles.push(a),cV(t.wbrels,-1,"styles."+r,oV.STY),e.vbaraw&&n&&(wU(o,a="xl/vbaProject.bin",e.vbaraw),i.vba.push(a),cV(t.wbrels,-1,"vbaProject.bin",oV.VBA)),wU(o,a="xl/metadata."+r,pG()),i.metadata.push(a),cV(t.wbrels,-1,"metadata."+r,oV.XLMETA),u.length>1&&(wU(o,a="xl/persons/person.xml",function(e){var t=[xU,ij("personList",null,{xmlns:lj.TCMNT,"xmlns:x":cj[0]}).replace(/[\/]>/,">")];return e.forEach((function(e,r){t.push(ij("person",null,{displayName:e,id:"{54EE7950-7262-4200-6969-"+("000000000000"+r).slice(-12)+"}",userId:e,providerId:"None"}))})),t.push("</personList>"),t.join("")}(u)),i.people.push(a),cV(t.wbrels,-1,"persons/person.xml",oV.PEOPLE)),wU(o,"[Content_Types].xml",iV(i,t)),wU(o,"_rels/.rels",lV(t.rels)),wU(o,"xl/_rels/workbook.xml.rels",lV(t.wbrels)),delete t.revssf,delete t.ssf,o}function bX(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=NH(e.slice(0,12));break;case"binary":r=e;break;default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function yX(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return qK(e.slice(r),t);default:break e}return Kz.to_workbook(e,t)}function wX(e,t,r,n){return n?(r.type="string",Kz.to_workbook(e,r)):Kz.to_workbook(t,r)}function SX(e,t){xH();var r=t||{};if("undefined"!==typeof ArrayBuffer&&e instanceof ArrayBuffer)return SX(new Uint8Array(e),((r=aU(r)).type="array",r));"undefined"!==typeof Uint8Array&&e instanceof Uint8Array&&!r.type&&(r.type="undefined"!==typeof Deno?"buffer":"array");var n,i=e,o=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),y$={},r.dateNF&&(y$.dateNF=r.dateNF),r.type||(r.type=DH&&Buffer.isBuffer(e)?"buffer":"base64"),"file"==r.type&&(r.type=DH?"buffer":"binary",i=function(e){if("undefined"!==typeof jB)return jB.readFileSync(e);if("undefined"!==typeof Deno)return Deno.readFileSync(e);if("undefined"!==typeof $&&"undefined"!==typeof File&&"undefined"!==typeof Folder)try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(oJ){if(!oJ.message||!oJ.message.match(/onstruct/))throw oJ}throw new Error("Cannot access file "+e)}(e),"undefined"===typeof Uint8Array||DH||(r.type="array")),"string"==r.type&&(o=!0,r.type="binary",r.codepage=65001,i=function(e){return e.match(/[^\x00-\x7F]/)?KU(e):e}(e)),"array"==r.type&&"undefined"!==typeof Uint8Array&&e instanceof Uint8Array&&"undefined"!==typeof ArrayBuffer){var a=new ArrayBuffer(3),s=new Uint8Array(a);if(s.foo="bar",!s.foo)return(r=aU(r)).type="array",SX(WH(i),r)}switch((n=bX(i,r))[0]){case 208:if(207===n[1]&&17===n[2]&&224===n[3]&&161===n[4]&&177===n[5]&&26===n[6]&&225===n[7])return function(e,t){return UB.find(e,"EncryptedPackage")?pX(e,t):oY(e,t)}(UB.read(i,r),r);break;case 9:if(n[1]<=8)return oY(i,r);break;case 60:return qK(i,r);case 73:if(73===n[1]&&42===n[2]&&0===n[3])throw new Error("TIFF Image File is not a spreadsheet");if(68===n[1])return function(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var i=qz.to_workbook(e,r);return r.WTF=n,i}catch(oJ){if(r.WTF=n,!oJ.message.match(/SYLK bad record ID/)&&n)throw oJ;return Kz.to_workbook(e,t)}}(i,r);break;case 84:if(65===n[1]&&66===n[2]&&76===n[3])return Gz.to_workbook(i,r);break;case 80:return 75===n[1]&&n[2]<9&&n[3]<9?function(e,t){var r=e,n=t||{};return n.type||(n.type=DH&&Buffer.isBuffer(e)?"buffer":"base64"),gX(CU(r,n),n)}(i,r):wX(e,i,r,o);case 239:return 60===n[3]?qK(i,r):wX(e,i,r,o);case 255:if(254===n[1])return function(e,t){var r=e;return"base64"==t.type&&(r=NH(r)),r=_H.utils.decode(1200,r.slice(2),"str"),t.type="binary",yX(r,t)}(i,r);if(0===n[1]&&2===n[2]&&0===n[3])return Yz.to_workbook(i,r);break;case 0:if(0===n[1]){if(n[2]>=2&&0===n[3])return Yz.to_workbook(i,r);if(0===n[2]&&(8===n[3]||9===n[3]))return Yz.to_workbook(i,r)}break;case 3:case 131:case 139:case 140:return zz.to_workbook(i,r);case 123:if(92===n[1]&&114===n[2]&&116===n[3])return Cq.to_workbook(i,r);break;case 10:case 13:case 32:return function(e,t){var r="",n=bX(e,t);switch(t.type){case"base64":r=NH(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=oU(e);break;default:throw new Error("Unrecognized type "+t.type)}return 239==n[0]&&187==n[1]&&191==n[2]&&(r=$U(r)),t.type="binary",yX(r,t)}(i,r);case 137:if(80===n[1]&&78===n[2]&&71===n[3])throw new Error("PNG Image File is not a spreadsheet")}return Vz.indexOf(n[0])>-1&&n[2]<=12&&n[3]<=31?zz.to_workbook(i,r):wX(e,i,r,o)}function CX(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return VB(t.file,UB.write(e,{type:DH?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return UB.write(e,t)}function kX(e,t){var r={},n=DH?"nodebuffer":"undefined"!==typeof Uint8Array?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var i=e.FullPaths?UB.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if("undefined"!==typeof Deno&&"string"==typeof i){if("binary"==t.type||"base64"==t.type)return i;i=new Uint8Array(UH(i))}return t.password&&"undefined"!==typeof encrypt_agile?CX(encrypt_agile(i,t.password),t):"file"===t.type?VB(t.file,i):"string"==t.type?$U(i):i}function xX(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return PH(KU(n));case"binary":return KU(n);case"string":return e;case"file":return VB(t.file,n,"utf8");case"buffer":return DH?FH(n,"utf8"):"undefined"!==typeof TextEncoder?(new TextEncoder).encode(n):xX(n,{type:"binary"}).split("").map((function(e){return e.charCodeAt(0)}))}throw new Error("Unrecognized type "+t.type)}function EX(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return"base64"==t.type?PH(r):"string"==t.type?$U(r):r;case"file":return VB(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function TX(e,t){xH(),mK(e);var r=aU(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),"array"==r.type){r.type="binary";var n=TX(e,r);return r.type="array",UH(n)}var i=0;if(r.sheet&&(i="number"==typeof r.sheet?r.sheet:e.SheetNames.indexOf(r.sheet),!e.SheetNames[i]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return xX(JK(e,r),r);case"slk":case"sylk":return xX(qz.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"htm":case"html":return xX(xY(e.Sheets[e.SheetNames[i]],r),r);case"txt":return function(e,t){switch(t.type){case"base64":return PH(e);case"binary":case"string":return e;case"file":return VB(t.file,e,"binary");case"buffer":return DH?FH(e,"binary"):e.split("").map((function(e){return e.charCodeAt(0)}))}throw new Error("Unrecognized type "+t.type)}(PX(e.Sheets[e.SheetNames[i]],r),r);case"csv":return xX(IX(e.Sheets[e.SheetNames[i]],r),r,"\ufeff");case"dif":return xX(Gz.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"dbf":return EX(zz.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"prn":return xX(Kz.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"rtf":return xX(Cq.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"eth":return xX($z.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"fods":return xX(DY(e,r),r);case"wk1":return EX(Yz.sheet_to_wk1(e.Sheets[e.SheetNames[i]],r),r);case"wk3":return EX(Yz.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),EX(bY(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),function(e,t){var r=t||{};return CX(aY(e,r),r)}(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return function(e,t){var r=aU(t||{});return kX(mX(e,r),r)}(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function _X(e){if(!e.bookType){var t=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();t.match(/^\.[a-z]+$/)&&(e.bookType=t.slice(1)),e.bookType={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"}[e.bookType]||e.bookType}}function AX(e,t,r,n,i,o,a,s){var l=rW(r),c=s.defval,u=s.raw||!Object.prototype.hasOwnProperty.call(s,"raw"),h=!0,d=1===i?[]:{};if(1!==i)if(Object.defineProperty)try{Object.defineProperty(d,"__rowNum__",{value:r,enumerable:!1})}catch(oJ){d.__rowNum__=r}else d.__rowNum__=r;if(!a||e[r])for(var f=t.s.c;f<=t.e.c;++f){var g=a?e[r][f]:e[n[f]+l];if(void 0!==g&&void 0!==g.t){var p=g.v;switch(g.t){case"z":if(null==p)break;continue;case"e":p=0==p?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+g.t)}if(null!=o[f]){if(null==p)if("e"==g.t&&null===p)d[o[f]]=null;else if(void 0!==c)d[o[f]]=c;else{if(!u||null!==p)continue;d[o[f]]=null}else d[o[f]]=u&&("n"!==g.t||"n"===g.t&&!1!==s.rawNumbers)?p:hW(g,p,s);null!=p&&(h=!1)}}else{if(void 0===c)continue;null!=o[f]&&(d[o[f]]=c)}}return{row:d,isempty:h}}function RX(e,t){if(null==e||null==e["!ref"])return[];var r={t:"n",v:0},n=0,i=1,o=[],a=0,s="",l={s:{r:0,c:0},e:{r:0,c:0}},c=t||{},u=null!=c.range?c.range:e["!ref"];switch(1===c.header?n=1:"A"===c.header?n=2:Array.isArray(c.header)?n=3:null==c.header&&(n=0),typeof u){case"string":l=cW(u);break;case"number":(l=cW(e["!ref"])).s.r=u;break;default:l=u}n>0&&(i=0);var h=rW(l.s.r),d=[],f=[],g=0,p=0,m=Array.isArray(e),v=l.s.r,b=0,y={};m&&!e[v]&&(e[v]=[]);var w=c.skipHidden&&e["!cols"]||[],S=c.skipHidden&&e["!rows"]||[];for(b=l.s.c;b<=l.e.c;++b)if(!(w[b]||{}).hidden)switch(d[b]=iW(b),r=m?e[v][b]:e[d[b]+h],n){case 1:o[b]=b-l.s.c;break;case 2:o[b]=d[b];break;case 3:o[b]=c.header[b-l.s.c];break;default:if(null==r&&(r={w:"__EMPTY",t:"s"}),s=a=hW(r,null,c),p=y[a]||0){do{s=a+"_"+p++}while(y[s]);y[a]=p,y[s]=1}else y[a]=1;o[b]=s}for(v=l.s.r+i;v<=l.e.r;++v)if(!(S[v]||{}).hidden){var C=AX(e,l,v,d,n,o,m,c);(!1===C.isempty||(1===n?!1!==c.blankrows:c.blankrows))&&(f[g++]=C.row)}return f.length=g,f}var OX=/"/g;function MX(e,t,r,n,i,o,a,s){for(var l=!0,c=[],u="",h=rW(r),d=t.s.c;d<=t.e.c;++d)if(n[d]){var f=s.dense?(e[r]||[])[d]:e[n[d]+h];if(null==f)u="";else if(null!=f.v){l=!1,u=""+(s.rawNumbers&&"n"==f.t?f.v:hW(f,null,s));for(var g=0,p=0;g!==u.length;++g)if((p=u.charCodeAt(g))===i||p===o||34===p||s.forceQuotes){u='"'+u.replace(OX,'""')+'"';break}"ID"==u&&(u='"ID"')}else null==f.f||f.F?u="":(l=!1,(u="="+f.f).indexOf(",")>=0&&(u='"'+u.replace(OX,'""')+'"'));c.push(u)}return!1===s.blankrows&&l?null:c.join(a)}function IX(e,t){var r=[],n=null==t?{}:t;if(null==e||null==e["!ref"])return"";var i=cW(e["!ref"]),o=void 0!==n.FS?n.FS:",",a=o.charCodeAt(0),s=void 0!==n.RS?n.RS:"\n",l=s.charCodeAt(0),c=new RegExp(("|"==o?"\\|":o)+"+$"),u="",h=[];n.dense=Array.isArray(e);for(var d=n.skipHidden&&e["!cols"]||[],f=n.skipHidden&&e["!rows"]||[],g=i.s.c;g<=i.e.c;++g)(d[g]||{}).hidden||(h[g]=iW(g));for(var p=0,m=i.s.r;m<=i.e.r;++m)(f[m]||{}).hidden||null!=(u=MX(e,i,m,h,a,l,o,n))&&(n.strip&&(u=u.replace(c,"")),(u||!1!==n.blankrows)&&r.push((p++?s:"")+u));return delete n.dense,r.join("")}function PX(e,t){t||(t={}),t.FS="\t",t.RS="\n";var r=IX(e,t);if("undefined"==typeof _H||"string"==t.type)return r;var n=_H.utils.encode(1200,r,"str");return String.fromCharCode(255)+String.fromCharCode(254)+n}function NX(e,t,r){var n,i=r||{},o=+!i.skipHeader,a=e||{},s=0,l=0;if(a&&null!=i.origin)if("number"==typeof i.origin)s=i.origin;else{var c="string"==typeof i.origin?oW(i.origin):i.origin;s=c.r,l=c.c}var u={s:{c:0,r:0},e:{c:l,r:s+t.length-1+o}};if(a["!ref"]){var h=cW(a["!ref"]);u.e.c=Math.max(u.e.c,h.e.c),u.e.r=Math.max(u.e.r,h.e.r),-1==s&&(s=h.e.r+1,u.e.r=s+t.length-1+o)}else-1==s&&(s=0,u.e.r=t.length-1+o);var d=i.header||[],f=0;t.forEach((function(e,t){zB(e).forEach((function(r){-1==(f=d.indexOf(r))&&(d[f=d.length]=r);var c=e[r],u="z",h="",g=aW({c:l+f,r:s+t+o});n=DX(a,g),!c||"object"!==typeof c||c instanceof Date?("number"==typeof c?u="n":"boolean"==typeof c?u="b":"string"==typeof c?u="s":c instanceof Date?(u="d",i.cellDates||(u="n",c=YB(c)),h=i.dateNF||tB[14]):null===c&&i.nullError&&(u="e",c=0),n?(n.t=u,n.v=c,delete n.w,delete n.R,h&&(n.z=h)):a[g]=n={t:u,v:c},h&&(n.z=h)):a[g]=c}))})),u.e.c=Math.max(u.e.c,l+d.length-1);var g=rW(s);if(o)for(f=0;f<d.length;++f)a[iW(f+l)+g]={t:"s",v:d[f]};return a["!ref"]=lW(u),a}function DX(e,t,r){if("string"==typeof t){if(Array.isArray(e)){var n=oW(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return DX(e,aW("number"!=typeof t?t:{r:t,c:r||0}))}function FX(){return{SheetNames:[],Sheets:{}}}function LX(e,t,r,n){var i=1;if(!r)for(;i<=65535&&-1!=e.SheetNames.indexOf(r="Sheet"+i);++i,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var o=r.match(/(^.*?)(\d+)$/);i=o&&+o[2]||0;var a=o&&o[1]||r;for(++i;i<=65535&&-1!=e.SheetNames.indexOf(r=a+i);++i);}if(pK(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function HX(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}var BX={encode_col:iW,encode_row:rW,encode_cell:aW,encode_range:lW,decode_col:nW,decode_row:tW,split_cell:function(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")},decode_cell:oW,decode_range:sW,format_cell:hW,sheet_add_aoa:fW,sheet_add_json:NX,sheet_add_dom:EY,aoa_to_sheet:gW,json_to_sheet:function(e,t){return NX(null,e,t)},table_to_sheet:TY,table_to_book:function(e,t){return dW(TY(e,t),t)},sheet_to_csv:IX,sheet_to_txt:PX,sheet_to_json:RX,sheet_to_html:xY,sheet_to_formulae:function(e){var t,r="",n="";if(null==e||null==e["!ref"])return[];var i,o=cW(e["!ref"]),a="",s=[],l=[],c=Array.isArray(e);for(i=o.s.c;i<=o.e.c;++i)s[i]=iW(i);for(var u=o.s.r;u<=o.e.r;++u)for(a=rW(u),i=o.s.c;i<=o.e.c;++i)if(r=s[i]+a,n="",void 0!==(t=c?(e[u]||[])[i]:e[r])){if(null!=t.F){if(r=t.F,!t.f)continue;n=t.f,-1==r.indexOf(":")&&(r=r+":"+r)}if(null!=t.f)n=t.f;else{if("z"==t.t)continue;if("n"==t.t&&null!=t.v)n=""+t.v;else if("b"==t.t)n=t.v?"TRUE":"FALSE";else if(void 0!==t.w)n="'"+t.w;else{if(void 0===t.v)continue;n="s"==t.t?"'"+t.v:""+t.v}}l[l.length]=r+"="+n}return l},sheet_to_row_object_array:RX,sheet_get_cell:DX,book_new:FX,book_append_sheet:LX,book_set_sheet_visibility:function(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=function(e,t){if("number"==typeof t){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}if("string"==typeof t){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}throw new Error("Cannot find sheet |"+t+"|")}(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r},cell_set_number_format:function(e,t){return e.z=t,e},cell_set_hyperlink:HX,cell_set_internal_link:function(e,t,r){return HX(e,"#"+t,r)},cell_add_comment:function(e,t,r){e.c||(e.c=[]),e.c.push({t:t,a:r||"SheetJS"})},sheet_set_array_formula:function(e,t,r,n){for(var i="string"!=typeof t?t:cW(t),o="string"==typeof t?t:lW(t),a=i.s.r;a<=i.e.r;++a)for(var s=i.s.c;s<=i.e.c;++s){var l=DX(e,a,s);l.t="n",l.F=o,delete l.v,a==i.s.r&&s==i.s.c&&(l.f=r,n&&(l.D=!0))}return e},consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};vH.version;const UX=__webpack_require__.p+"static/media/abbrs.ebd0e99b743c4acac912.xlsx",jX=e=>new Promise((t=>{const r=new FileReader;r.onload=e=>{const r=SX(e.target.result,{type:"binary",raw:!0}),n=BX.sheet_to_json(r.Sheets[r.SheetNames[0]],{header:["enabled","value","abbr"]}).map((e=>{let{enabled:t,value:r,abbr:n}=e;return{enabled:t,value:r,abbr:n}}));n[0].enabled.toString().match(/enabled/i)?t(n.slice(1)):t(n)},r.readAsBinaryString(e)})),WX=(e,t)=>{const r=BX.book_new(),n=BX.json_to_sheet(e);BX.book_append_sheet(r,n,"abbrs"),function(e,t,r){var n=r||{};n.type="file",n.file=t,_X(n),TX(e,n)}(r,t)},VX=()=>fetch(UX).then((e=>e.blob()));function zX(e){let{data:r,setData:n,...i}=e;const o=(0,t.useRef)(),[a,s]=(0,t.useState)({name:"",size:0,lastModified:0});return(0,t.useEffect)((()=>{""!==a.name&&jX(a).then((e=>n(e)))}),[a]),(0,d.jsxs)("div",{className:"toolbox",children:[(0,d.jsx)("input",{type:"file","data-testid":"uploader",onChange:function(e){const t=o.current.files[0];void 0!==t&&(a.lastModified==t.lastModified&&a.name===t.name&&a.size===t.size||s(t))},ref:o,style:{display:"none"}}),(0,d.jsx)("button",{className:"button",onClick:()=>{o.current.click()},children:"Import Abbrs"}),(0,d.jsx)("button",{className:"button",onClick:()=>WX(r,"abbrs.xlsx"),children:"Export Abbrs"}),(0,d.jsx)("button",{className:"button",onClick:()=>{window.confirm("Are you sure you want to remove all existing acronyms and replace with a common list?")&&VX().then((e=>jX(e))).then((e=>n(e)))},children:"Load Common Abbrs"})]})}const qX=function(e){let{data:t,setData:r}=e;return(0,d.jsxs)("div",{children:[(0,d.jsx)(zX,{setData:r,data:t}),(0,d.jsx)(mH,{data:t,setData:r})]})},GX=(e,t)=>r=>{r.preventDefault(),t.props.onSelReplace(e)};class $X extends t.PureComponent{constructor(e){super(e),this.getSynonyms=e=>{const t=new XMLHttpRequest;t.onreadystatechange=()=>{if(4===t.readyState&&200===t.status){const e=JSON.parse(t.responseText);0!==e.length?this.setState({synonyms:e.map((e=>e.word))}):this.setState({synonyms:[]})}};t.open("GET","https://api.datamuse.com/words?max=75&ml="+e,!0),t.send()},this.state={synonyms:[],hidden:!0}}componentDidMount(){this.getSynonyms(this.props.word)}componentDidUpdate(e){e.word!==this.props.word&&this.getSynonyms(this.props.word)}render(){const e=this.props.abbrReplacer(this.props.word),t=this.props.abbrDict[this.props.word],r=(0,d.jsxs)("span",{className:"tag is-medium",children:[(0,d.jsx)(YX,{word:this.props.word,abbr:e===this.props.word?"":e,otherAbbrs:t},this.props.word),(0,d.jsx)("a",{className:"icon is-small",onMouseDown:GX(this.props.word,this),children:(0,d.jsx)(Kr,{icon:Jr,size:"xs",color:"#51cf66"})})]}),n=(0,d.jsx)(KX,{onSelReplace:this.props.onSelReplace,synonyms:this.state.synonyms,abbrDict:this.props.abbrDict,abbrReplacer:this.props.abbrReplacer},this.state.synonyms.join("")),i=(0,d.jsx)("span",{className:"panel-block",children:"Auto-thesaurus box - highlight a word or phrase below to show synonyms in this box"},"init"),o=(0,d.jsx)("span",{className:"panel-block",children:"no results found"},"none");let a;return a=""===this.props.word?i:0===this.state.synonyms.length?o:n,(0,d.jsxs)("div",{className:"card",children:[(0,d.jsxs)("header",{className:"card-header has-background-light\tis-shadowless",children:[(0,d.jsxs)("div",{className:"card-header-title",children:[(0,d.jsxs)("span",{children:["Thesaurus",this.props.word?":":""]}),this.props.word?r:""]}),(0,d.jsx)("a",{className:"card-header-icon",onClick:this.props.onHide,children:(0,d.jsx)("span",{className:"delete"})})]}),(0,d.jsx)("div",{className:"card-content",style:{height:"290px",overflow:"auto"},children:a})]})}}class KX extends t.PureComponent{render(){return(0,d.jsx)("div",{children:(0,d.jsx)("div",{className:"tags are-medium ",children:this.props.synonyms.map(((e,t)=>{const r=this.props.abbrReplacer(e),n=this.props.abbrDict[e];return(0,d.jsxs)("span",{className:"tag",children:[(0,d.jsx)(YX,{word:e,abbr:r===e?"":r,otherAbbrs:n}),(0,d.jsx)("a",{className:"icon",onMouseDown:GX(e,this),children:(0,d.jsx)(Kr,{icon:Jr,size:"xs",color:"#51cf66"})})]},t)}))})})}}class YX extends t.PureComponent{render(){let e="";this.props.abbr&&(e=(0,d.jsx)("span",{style:{fontWeight:"bold"},children:" ("+this.props.abbr+")"}));let t="",r="";if(this.props.otherAbbrs){if(this.props.otherAbbrs.enabled){let e=this.props.otherAbbrs.enabled.filter((e=>e!==this.props.abbr));e.length>0&&(t=(0,d.jsx)("span",{style:{fontStyle:"italic"},children:" ("+e.join(",")+")"}))}if(this.props.otherAbbrs.disabled){let e=this.props.otherAbbrs.disabled;e.length>0&&(r=(0,d.jsx)("span",{style:{fontStyle:"italic"},children:" ("+e.join(",")+")"}))}}return(0,d.jsxs)("span",{children:[(0,d.jsx)("span",{children:this.props.word}),e,t,r]})}}const XX=$X,JX=[{enabled:!0,value:"abbreviations",abbr:"abbrs"},{enabled:!0,value:"table",abbr:"tbl"},{enabled:!0,value:"optimize",abbr:"optim"},{enabled:!0,value:"with ",abbr:"w/"},{enabled:!0,value:"parentheses",abbr:"parens"}],ZX=i.EditorState.createWithContent(i.ContentState.createFromText("- This is a custom built bullet writing tool; abbreviations will be replaced according to table in the abbreviations tab--you will see output on the right\n- This tool can optimize spacing; output will be red if the optimizer could not fix spacing with 2004 or 2006 Unicode spaces\n- Click the thesaurus button to show one; select a word in this or the output box to view synonyms--words in parentheses are abbreviations that are configured"));const QX=function(e){let{enableHighlight:r,onHighlightChange:n}=e;const[o,a]=(0,t.useState)(!0),[s,l]=(0,t.useState)(202.321),[c,h]=(0,t.useState)(JX),[f,g]=(0,t.useState)({}),[v,b]=(0,t.useState)(""),[y,w]=(0,t.useState)(0),[S,C]=(0,t.useState)(!1),[k,x]=(0,t.useState)(ZX);function E(e){var t,r;const n=e[0];var u;(a(null!==(t=n.enableOptim)&&void 0!==t?t:o),l(parseFloat(null!==(r=n.width)&&void 0!==r?r:s)),Array.isArray(n.abbrData[0]))?h(n.abbrData.map((e=>({enabled:e[0],value:e[1],abbr:e[2]})))):h(null!==(u=n.abbrData)&&void 0!==u?u:c);x(n.editorState?i.EditorState.fromJS(n.editorState):i.EditorState.createWithContent(i.ContentState.createFromText(n.text)))}(0,t.useEffect)((()=>{let e;try{localStorage.getItem("bullet-settings")&&(e=JSON.parse(localStorage.getItem("bullet-settings")),E(e))}catch(t){if("SecurityError"!==t.name)throw t;console.log("Was not able to get localstorage bullets due to use of file interface and browser privacy settings")}}),[]),(0,t.useEffect)((()=>{const e={};c.filter((e=>null!==e.value&&null!==e.abbr)).forEach((t=>{let r=String(t.value).replace(/\s/g," "),n=t.abbr,i=t.enabled;e[r]=e[r]||[],i?(e[r].enabled=e[r].enabled||[],e[r].enabled.push(n)):(e[r].disabled=e[r].disabled||[],e[r].disabled.push(n))})),g(e)}),[c]);const T=(0,t.useCallback)((e=>{const t={};Object.keys(f).forEach((e=>{const r=f[e];r.enabled&&(t[e]=r.enabled[r.enabled.length-1])}));const r=Object.keys(t).map((function(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")})).join("|"),n=new RegExp("(^|\\W|\\b)("+r+")(\\W|\\b|$)","g");return e.replace(n,((e,r,n,i)=>{let o=t[n];return o||(o=""),r+o+i}))}),[f]);function _(){const e=k.getCurrentContent();if(!1===r){let t=e=>e.filter(((t,r)=>e.indexOf(t)!==r&&t.length>1)),n=t(e.getPlainText().split(/\s|;|--|\//));function o(e){let t=document.getElementsByClassName("yellow-highlight");for(let r of t)e.target.innerText==r.outerText&&("yellow"==r.style.background?r.style.background="LawnGreen":r.style.background="yellow")}n=[...new Set(n)];const a=e=>{let{children:t}=e;return(0,d.jsx)("span",{className:"yellow-highlight",onClick:o,style:{background:"yellow",cursor:"pointer"},children:t})};function s(e,t,r){const n=t.getText();e.forEach((e=>{[...n.matchAll(e)].forEach((e=>r(e.index,e.index+e[0].length)))}))}function l(e,t){s(n,e,t)}const c=()=>new i.CompositeDecorator([{strategy:l,component:a}]);x(i.EditorState.set(k,{decorator:c()}))}else x(i.EditorState.set(k,{decorator:null}))}function A(){C(!S)}const R=[(0,d.jsx)(p,{editorState:k,setEditorState:x,abbrReplacer:T,width:s,onSelect:function(e){""!==e.trim()&&b(u(e.trim()).slice(0,8).join(" "))},enableOptim:o,enableHighlight:r,onHighlightChange:n,handleEnableHighlight:_}),(0,d.jsx)(qX,{data:c,setData:h})];return(0,d.jsx)("div",{className:"container is-fluid",children:(0,d.jsxs)("div",{className:"columns is-multiline",children:[(0,d.jsxs)("div",{className:"column is-full",children:[(0,d.jsx)(an,{}),(0,d.jsx)(ln,{enableOptim:o,enableHighlight:r,onOptimChange:function(){a(!o)},onHighlightChange:n,handleEnableHighlight:_,width:s,onWidthUpdate:l,onTextNorm:function(){const e=[],t=k.getCurrentContent();t.getBlockMap().forEach(((t,r)=>{((e,t,r)=>{const n=t.getText();let i,o,a;for(;null!==(i=e.exec(n));)o=i.index,a=o+i[0].length,r(o,a)})(/\s+/g,t,((t,n)=>{const o=i.SelectionState.createEmpty(r).merge({anchorOffset:t,focusOffset:n});e.push(o)}))}));let r=t;e.reverse().forEach((e=>{r=i.Modifier.replaceText(r,e," ")})),x(i.EditorState.createWithContent(r))},onTextUpdate:function(e){x(i.EditorState.createWithContent(i.ContentState.createFromText(e)))},getSavedSettings:function(){return{width:s,text:k.getCurrentContent().getPlainText("\n"),editorState:k.toJS(),abbrData:c,enableOptim:o}},onJSONImport:E,onThesaurusHide:A})]}),(0,d.jsx)("div",{className:"column is-full "+(S?"":"is-hidden"),children:(0,d.jsx)(XX,{word:v,onSelReplace:function(e){if(document.activeElement.className.match(/public-DraftEditor-content/)){const{selectedText:t,start:n,anchorKey:o,selectionState:a}=m(k),s=t.match(/\s*$/)[0],l=n+e.length+s.length,c=i.SelectionState.createEmpty(o).merge({anchorOffset:n,focusOffset:l}),u=i.Modifier.replaceText(k.getCurrentContent(),a,e+s),h=i.EditorState.push(k,u,"insert-characters"),f=i.EditorState.forceSelection(h,c);x(f);const g=f.getCurrentContent();if(!0===r){let p=e=>e.filter(((t,r)=>e.indexOf(t)!==r&&t.length>1)),v=p(g.getPlainText().split(/\s|;|--|\//));function b(e){let t=document.getElementsByClassName("yellow-highlight");for(let r of t)e.target.innerText==r.outerText&&("yellow"==r.style.background?r.style.background="LawnGreen":r.style.background="yellow")}v=[...new Set(v)];const y=e=>{let{children:t}=e;return(0,d.jsx)("span",{className:"yellow-highlight",onClick:b,style:{background:"yellow",cursor:"pointer"},children:t})};function w(e,t,r){const n=t.getText();e.forEach((e=>{[...n.matchAll(e)].forEach((e=>r(e.index,e.index+e[0].length)))}))}function S(e,t){w(v,e,t)}const C=()=>new i.CompositeDecorator([{strategy:S,component:y}]);x(i.EditorState.set(f,{decorator:C()}))}else x(i.EditorState.set(f,{decorator:null}))}},abbrDict:f,abbrReplacer:T,onHide:A})}),(0,d.jsx)("div",{className:"column is-full",children:(0,d.jsx)("div",{className:"tabs",children:(0,d.jsx)("ul",{children:["Bullets","Abbreviations"].map(((e,t)=>{return(0,d.jsx)("li",{className:y===t?"is-active":"",children:(0,d.jsx)("a",{onClick:(r=t,()=>w(r)),children:e})},t);var r}))})})}),(0,d.jsx)("div",{className:"column is-full",children:R[y]})]})})};function eJ(){const[e,r]=(0,t.useState)(!1);return(0,d.jsx)(QX,{enableHighlight:e,onHighlightChange:function(){r(!e),console.log("enableHighlight state changed")}})}const tJ=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function rJ(e,t){navigator.serviceWorker.register(e).then((e=>{e.onupdatefound=()=>{const r=e.installing;null!=r&&(r.onstatechange=()=>{"installed"===r.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((e=>{console.error("Error during service worker registration:",e)}))}var nJ=__webpack_require__(1672);__webpack_require__.n(nJ)().load({custom:{families:["AdobeTimes"]}});const iJ=document.getElementById("root");(0,n.H)(iJ).render((0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("div",{className:"section",id:"stuff",children:(0,d.jsx)(eJ,{})}),(0,d.jsxs)("div",{className:"container",id:"footer",children:[(0,d.jsx)("div",{className:"is-size-6 mb-2",children:(0,d.jsx)("a",{href:"https://github.com/AF-VCD/pdf-bullets#exclamation-august-2024-update",children:"ANNOUNCEMENT (August 2024)"})}),(0,d.jsxs)("div",{children:["If you have feedback, submit an",(0,d.jsx)("a",{href:"https://github.com/AF-VCD/pdf-bullets/issues",children:" issue "}),"or a",(0,d.jsx)("a",{href:"https://github.com/AF-VCD/pdf-bullets/pulls",children:" pull request"})]}),(0,d.jsx)("div",{children:"This site utilizes PDF.JS (pdf import), react-table (spreadsheet), draft-js (editor), the DataMuse API (thesaurus), and Bulma (CSS)."}),(0,d.jsxs)("div",{children:["Maintained by ",(0,d.jsx)("a",{href:"https://www.xoid.net",children:"Christopher Kodama"})]})]})]})),function(e){if("serviceWorker"in navigator){if(new URL(".",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(()=>{const t="./service-worker.js";tJ?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((r=>{const n=r.headers.get("content-type");404===r.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then((e=>{e.unregister().then((()=>{window.location.reload()}))})):rJ(e,t)})).catch((()=>{console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((()=>{console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):rJ(t,e)}))}}()})()})();
//# sourceMappingURL=main.52aad488.js.map